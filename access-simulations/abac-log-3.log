2022-01-16 11:06:51.347  INFO 16 --- [main] .a.a.a.s.AuthorizationServiceApplication : Starting AuthorizationServiceApplication v3.0.4 using Java 1.8.0_212 on b5110022a533 with PID 16 (/abac-server/abac-authorization-server-exec.jar started by root in /abac-server)
2022-01-16 11:06:51.363  INFO 16 --- [main] .a.a.a.s.AuthorizationServiceApplication : No active profile set, falling back to default profiles: default
2022-01-16 11:06:55.254  INFO 16 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2022-01-16 11:06:55.529  INFO 16 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 229 ms. Found 3 JPA repository interfaces.
2022-01-16 11:06:58.081  INFO 16 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port(s): 7071 (https)
2022-01-16 11:06:58.127  INFO 16 --- [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2022-01-16 11:06:58.137  INFO 16 --- [main] org.apache.catalina.core.StandardEngine  : Starting Servlet engine: [Apache Tomcat/9.0.56]
2022-01-16 11:06:58.628  INFO 16 --- [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2022-01-16 11:06:58.629  INFO 16 --- [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 6990 ms
2022-01-16 11:06:58.852  INFO 16 --- [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
2022-01-16 11:06:58.877  WARN 16 --- [main] com.zaxxer.hikari.util.DriverDataSource  : Registered driver with driverClassName=com.mysql.jdbc.Driver was not found, trying direct instantiation.
2022-01-16 11:06:59.542  INFO 16 --- [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
2022-01-16 11:06:59.553  INFO 16 --- [main] o.s.b.a.h2.H2ConsoleAutoConfiguration    : H2 console available at '/h2-console'. Database available at 'jdbc:mysql://mysql:3306/apam_db?createDatabaseIfNotExist=true'
2022-01-16 11:07:00.294  INFO 16 --- [main] o.hibernate.jpa.internal.util.LogHelper  : HHH000204: Processing PersistenceUnitInfo [name: default]
2022-01-16 11:07:00.547  INFO 16 --- [main] org.hibernate.Version                    : HHH000412: Hibernate ORM core version 5.6.3.Final
2022-01-16 11:07:01.234  INFO 16 --- [main] o.hibernate.annotations.common.Version   : HCANN000001: Hibernate Commons Annotations {5.1.2.Final}
2022-01-16 11:07:01.710  INFO 16 --- [main] org.hibernate.dialect.Dialect            : HHH000400: Using dialect: org.hibernate.dialect.MySQL5InnoDBDialect
2022-01-16 11:07:03.446  INFO 16 --- [main] o.h.e.t.j.p.i.JtaPlatformInitiator       : HHH000490: Using JtaPlatform implementation: [org.hibernate.engine.transaction.jta.platform.internal.NoJtaPlatform]
2022-01-16 11:07:03.462  INFO 16 --- [main] j.LocalContainerEntityManagerFactoryBean : Initialized JPA EntityManagerFactory for persistence unit 'default'
2022-01-16 11:07:04.004  INFO 16 --- [main] e.a.a.abac.server.pap.PapProperties      : ABAC Policies directory: ./config/../policies
2022-01-16 11:07:04.004  INFO 16 --- [main] e.a.a.abac.server.pap.PapProperties      : ABE Policies directory: ./config/../policies
2022-01-16 11:07:05.557  INFO 16 --- [main] e.a.a.abac.server.pdp.DirectoryWatcher   : Policy dir. watcher initialized
2022-01-16 11:07:05.558  INFO 16 --- [main] e.a.a.a.s.pdp.AuthorizationServicePDP    : Initializing PDP...
2022-01-16 11:07:05.559  INFO 16 --- [main] e.a.a.a.s.pdp.AuthorizationServicePDP    : Getting policy files from: ./config/../policies
2022-01-16 11:07:05.587  INFO 16 --- [main] e.a.a.a.s.pdp.AuthorizationServicePDP    : Policy files found: 5
2022-01-16 11:07:06.254  INFO 16 --- [main] org.wso2.balana.ConfigurationStore       : Loading runtime configuration
2022-01-16 11:07:06.521  INFO 16 --- [main] e.a.a.a.s.pdp.AuthorizationServicePDP    : Configured attribute finder module classes: [eu.asclepios.authorization.abac.server.pdp.finder.LoggingAttributeFinderModule, eu.asclepios.authorization.abac.server.pdp.finder.WeekdayAttributeFinderModule, eu.asclepios.authorization.abac.server.pdp.finder.IpAddressAttributeFinderModule, eu.asclepios.authorization.abac.server.pdp.finder.DeviceAttributeFinderModule, eu.asclepios.authorization.abac.server.pdp.finder.GeolocationAttributeFinderModule, eu.asclepios.authorization.abac.server.pdp.finder.KeycloackAttributeFinderModule, eu.asclepios.authorization.abac.server.pdp.finder.NoopAttributeFinderModule, eu.asclepios.example.contexthandlers.CustomDbAttributeFinder, eu.asclepios.example.contexthandlers.CustomRestAttrFinder]
2022-01-16 11:07:06.523  INFO 16 --- [main] e.a.a.a.s.pdp.AuthorizationServicePDP    :   Instantiating attribute finder module: eu.asclepios.authorization.abac.server.pdp.finder.LoggingAttributeFinderModule@b6b1987
2022-01-16 11:07:06.525  INFO 16 --- [main] e.a.a.a.s.pdp.AuthorizationServicePDP    :   Instantiating attribute finder module: eu.asclepios.authorization.abac.server.pdp.finder.WeekdayAttributeFinderModule@6b44435b
2022-01-16 11:07:06.526  INFO 16 --- [main] e.a.a.a.s.pdp.AuthorizationServicePDP    :   Instantiating attribute finder module: eu.asclepios.authorization.abac.server.pdp.finder.IpAddressAttributeFinderModule@2ccca26f
2022-01-16 11:07:06.527  INFO 16 --- [main] e.a.a.a.s.pdp.AuthorizationServicePDP    :   Instantiating attribute finder module: eu.asclepios.authorization.abac.server.pdp.finder.DeviceAttributeFinderModule@66b7550d
2022-01-16 11:07:06.551  INFO 16 --- [main] e.a.a.a.s.pdp.AuthorizationServicePDP    :   Instantiating attribute finder module: eu.asclepios.authorization.abac.server.pdp.finder.GeolocationAttributeFinderModule@3543df7d
2022-01-16 11:07:06.556  INFO 16 --- [main] e.a.a.a.s.pdp.AuthorizationServicePDP    :   Instantiating attribute finder module: eu.asclepios.authorization.abac.server.pdp.finder.KeycloackAttributeFinderModule@7c541c15
2022-01-16 11:07:06.557  INFO 16 --- [main] e.a.a.a.s.pdp.AuthorizationServicePDP    :   Instantiating attribute finder module: eu.asclepios.authorization.abac.server.pdp.finder.NoopAttributeFinderModule@3542162a
2022-01-16 11:07:06.559  INFO 16 --- [main] e.a.e.c.CustomDbAttributeFinder          : CustomDbAttributeFinder: DB settings: url=jdbc:mysql://mysql:3306/keycloak, driver=com.mysql.jdbc.Driver, username=keycloak
2022-01-16 11:07:06.571  INFO 16 --- [main] e.a.e.c.CustomDbAttributeFinder          : CustomDbAttributeFinder: Processing entry: 12345:600000:ambulance-crew-id-1234
2022-01-16 11:07:06.573  INFO 16 --- [main] e.a.e.c.CustomDbAttributeFinder          : CustomDbAttributeFinder: Processing entry:  23456:600000:ambulance-crew-id-2345
2022-01-16 11:07:06.575  INFO 16 --- [main] e.a.e.c.CustomDbAttributeFinder          : CustomDbAttributeFinder: Processing entry:  34567:600000:ambulance-crew-id-3456
2022-01-16 11:07:06.576  INFO 16 --- [main] e.a.e.c.CustomDbAttributeFinder          : CustomDbAttributeFinder: Added 3 entries in DB
2022-01-16 11:07:06.577  INFO 16 --- [main] e.a.a.a.s.pdp.AuthorizationServicePDP    :   Instantiating attribute finder module: eu.asclepios.example.contexthandlers.CustomDbAttributeFinder@3b2c0e88
2022-01-16 11:07:06.582  INFO 16 --- [main] e.a.e.c.CustomRestAttrFinder             : CustomRestAttrFinder: REST URL template: http://django-rest:8000/attribute-provider/getinfov2?ES-ID={{es-id}}&format=json&patient-ID={{patient-id}}&user-ID={{user-id}}
2022-01-16 11:07:06.654  INFO 16 --- [main] e.a.a.a.s.pdp.AuthorizationServicePDP    :   Instantiating attribute finder module: eu.asclepios.example.contexthandlers.CustomRestAttrFinder@5b07730f
2022-01-16 11:07:06.703  INFO 16 --- [main] e.a.a.a.s.pdp.AuthorizationServicePDP    : PDP initialized
2022-01-16 11:07:06.709  INFO 16 --- [main] e.a.a.abac.server.PdpServerController    : Authorization Service configuration: AuthorizationServiceProperties(pdp=AuthorizationServiceProperties.PdpConfig(enable=true, balanaConfigFile=./config/balana.cfg.xml, policiesDir=./config/../policies, policiesExtension=.xml, restartPollingInterval=1000, accessKey=7235687126587231675321756752657236156321765723, attributeFinderClasses=[eu.asclepios.authorization.abac.server.pdp.finder.LoggingAttributeFinderModule, eu.asclepios.authorization.abac.server.pdp.finder.WeekdayAttributeFinderModule, eu.asclepios.authorization.abac.server.pdp.finder.IpAddressAttributeFinderModule, eu.asclepios.authorization.abac.server.pdp.finder.DeviceAttributeFinderModule, eu.asclepios.authorization.abac.server.pdp.finder.GeolocationAttributeFinderModule, eu.asclepios.authorization.abac.server.pdp.finder.KeycloackAttributeFinderModule, eu.asclepios.authorization.abac.server.pdp.finder.NoopAttributeFinderModule, eu.asclepios.example.contexthandlers.CustomDbAttributeFinder, eu.asclepios.example.contexthandlers.CustomRestAttrFinder]), context=null, pip=[], requestContext=null)
2022-01-16 11:07:06.711  INFO 16 --- [main] e.a.a.abac.server.PdpServerController    : Server-side request context extraction: false
2022-01-16 11:07:06.779  WARN 16 --- [main] JpaBaseConfiguration$JpaWebConfiguration : spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2022-01-16 11:07:07.212  INFO 16 --- [main] e.a.a.abac.server.util.WebMvcConfig      : Using API Key authentication in PDP
2022-01-16 11:07:07.214  INFO 16 --- [main] e.a.a.abac.server.util.WebMvcConfig      : Using API Key authentication in PAP
2022-01-16 11:07:08.751  INFO 16 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port(s): 7071 (https) with context path ''
2022-01-16 11:07:08.787  INFO 16 --- [main] .a.a.a.s.AuthorizationServiceApplication : Started AuthorizationServiceApplication in 19.34 seconds (JVM running for 20.716)
2022-01-16 11:07:49.645  INFO 16 --- [https-jsse-nio-7071-exec-6] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring DispatcherServlet 'dispatcherServlet'
2022-01-16 11:07:49.646  INFO 16 --- [https-jsse-nio-7071-exec-6] o.s.web.servlet.DispatcherServlet        : Initializing Servlet 'dispatcherServlet'
2022-01-16 11:07:49.651  INFO 16 --- [https-jsse-nio-7071-exec-6] o.s.web.servlet.DispatcherServlet        : Completed initialization in 4 ms
2022-01-16 11:07:49.733  INFO 16 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=74200ad5-eb0b-45f0-8a4c-785accc6ca1e, content=null, timestamp=1642331269324, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=50250, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=5fb2fe03fb5a, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=7187b2ea-af71-4106-9885-90a594c75da9, http-req-server-port=80, http-header-accept=*/*, kc-id=6b662965-9581-452d-9a8e-efb17f194ea0, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642331269295, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeP9sHNxAH4AEQAAAABh4/yEdAAkNmI2NjI5NjUtOTU4MS00NTJkLTlhOGUtZWZiMTdmMTk0ZWEwdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ3MTg3YjJlYS1hZjcxLTQxMDYtOTg4NS05MGE1OTRjNzVkYTlwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICI2cGUwZ2U1ck0zU2E2SUt5WXBsLTVkQTZrVXVleWo3X1psV2c1aDU4MmFvIn0.eyJleHAiOjE2NDIzMzE1NjgsImlhdCI6MTY0MjMzMTI2OCwianRpIjoiNmI2NjI5NjUtOTU4MS00NTJkLTlhOGUtZWZiMTdmMTk0ZWEwIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiI3MTg3YjJlYS1hZjcxLTQxMDYtOTg4NS05MGE1OTRjNzVkYTkiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.omg8lBi8aYXNKFtyz-59LVSg2a2tCMxJ-pijDZk_PJuP3t0KLP9mK065sgr18j9RRLlhB5Gz2kgicFArxHtivEl0gUXu61vDMI1JwNX-iJP3IW1nOuz1niWS06XTsBAs3FLboN9JCzCrlyLSB7kFOSKNyr9gnqXqesWQU1H_s6k9aowpZ2V4aNEsojTx4jRXH2wCNB77m23zlaTQfbhQx_Hi4ZBiiOFCmRXadXaP0PC2LKecdNH4x8WAIIR9Jxwe-mzphLjj5_er637GhiPlR7lUQk9Yn4L72NWb6IEYvcz5_B5E73AFiU_xFR5kcOBPp-wTl_8-LRcBhxSaV9WLrA, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642331568, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.48.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=B7848D9ECB7373A5838FDA830CE957C5, http-session-last-accessed-time=1642331269295, kc-category-name=ACCESS, kc-iat=1642331268, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:50250 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:07:49.734  INFO 16 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:07:49.739  INFO 16 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.util.AttributeUtil     : XACML Attribute Categories:
{urn:oasis:names:tc:xacml:1.0:environment:current-date=urn:oasis:names:tc:xacml:3.0:attribute-category:environment, urn:oasis:names:tc:xacml:1.0:environment:current-dateTime=urn:oasis:names:tc:xacml:3.0:attribute-category:environment, actionId=urn:oasis:names:tc:xacml:3.0:attribute-category:action, user.identifier=urn:oasis:names:tc:xacml:1.0:subject-category:access-subject, urn:oasis:names:tc:xacml:1.0:environment:current-time=urn:oasis:names:tc:xacml:3.0:attribute-category:environment, request-id=urn:oasis:names:tc:xacml:3.0:attribute-category:environment, resource-id=urn:oasis:names:tc:xacml:3.0:attribute-category:resource}
2022-01-16 11:07:49.739  INFO 16 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.util.AttributeUtil     : XACML Attribute Data Types:
{urn:oasis:names:tc:xacml:1.0:environment:current-date=http://www.w3.org/2001/XMLSchema#date, urn:oasis:names:tc:xacml:1.0:environment:current-dateTime=http://www.w3.org/2001/XMLSchema#dateTime, actionId=http://www.w3.org/2001/XMLSchema#string, user.identifier=http://www.w3.org/2001/XMLSchema#string, urn:oasis:names:tc:xacml:1.0:environment:current-time=http://www.w3.org/2001/XMLSchema#time, request-id=http://www.w3.org/2001/XMLSchema#string, resource-id=http://www.w3.org/2001/XMLSchema#string}
2022-01-16 11:07:49.754  INFO 16 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@21367e7b
2022-01-16 11:07:49.754  INFO 16 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@21367e7b
2022-01-16 11:07:49.830  INFO 16 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@21367e7b
2022-01-16 11:07:49.830  INFO 16 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@21367e7b
2022-01-16 11:07:49.845  INFO 16 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@21367e7b
2022-01-16 11:07:49.845  WARN 16 --- [https-jsse-nio-7071-exec-6] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:07:49.845  WARN 16 --- [https-jsse-nio-7071-exec-6] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:07:49.846  INFO 16 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@21367e7b
2022-01-16 11:07:49.848  INFO 16 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@21367e7b
2022-01-16 11:07:49.848  WARN 16 --- [https-jsse-nio-7071-exec-6] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:07:49.848  WARN 16 --- [https-jsse-nio-7071-exec-6] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:07:49.848  INFO 16 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@21367e7b
2022-01-16 11:07:49.862  INFO 16 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: emergency-active, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@21367e7b
2022-01-16 11:07:49.917  INFO 16 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@21367e7b
2022-01-16 11:07:49.918  INFO 16 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@21367e7b
2022-01-16 11:07:49.927  INFO 16 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@21367e7b
2022-01-16 11:07:49.927  INFO 16 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-revoke-extra, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@21367e7b
2022-01-16 11:07:49.945  INFO 16 --- [https-jsse-nio-7071-exec-6] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18909720835581908-654801, decision=PERMIT, pdp-result=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}})
2022-01-16 11:07:49.947  INFO 16 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=74200ad5-eb0b-45f0-8a4c-785accc6ca1e, content=PERMIT, timestamp=1642331269946, pdpResult=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}}))
2022-01-16 11:07:49.966  INFO 16 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=212ms, Total=258ms
2022-01-16 11:07:50.114  INFO 16 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=66373fc4-3081-46a2-aa88-9170074cc539, content=null, timestamp=1642331270094, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=50262, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=5fb2fe03fb5a, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=7187b2ea-af71-4106-9885-90a594c75da9, http-req-server-port=80, http-header-accept=*/*, kc-id=6b662965-9581-452d-9a8e-efb17f194ea0, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642331270092, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeP9sHNxAH4AEQAAAABh4/yEdAAkNmI2NjI5NjUtOTU4MS00NTJkLTlhOGUtZWZiMTdmMTk0ZWEwdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ3MTg3YjJlYS1hZjcxLTQxMDYtOTg4NS05MGE1OTRjNzVkYTlwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICI2cGUwZ2U1ck0zU2E2SUt5WXBsLTVkQTZrVXVleWo3X1psV2c1aDU4MmFvIn0.eyJleHAiOjE2NDIzMzE1NjgsImlhdCI6MTY0MjMzMTI2OCwianRpIjoiNmI2NjI5NjUtOTU4MS00NTJkLTlhOGUtZWZiMTdmMTk0ZWEwIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiI3MTg3YjJlYS1hZjcxLTQxMDYtOTg4NS05MGE1OTRjNzVkYTkiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.omg8lBi8aYXNKFtyz-59LVSg2a2tCMxJ-pijDZk_PJuP3t0KLP9mK065sgr18j9RRLlhB5Gz2kgicFArxHtivEl0gUXu61vDMI1JwNX-iJP3IW1nOuz1niWS06XTsBAs3FLboN9JCzCrlyLSB7kFOSKNyr9gnqXqesWQU1H_s6k9aowpZ2V4aNEsojTx4jRXH2wCNB77m23zlaTQfbhQx_Hi4ZBiiOFCmRXadXaP0PC2LKecdNH4x8WAIIR9Jxwe-mzphLjj5_er637GhiPlR7lUQk9Yn4L72NWb6IEYvcz5_B5E73AFiU_xFR5kcOBPp-wTl_8-LRcBhxSaV9WLrA, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642331568, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.48.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=941D76C148D3EEFC9023C98559934B20, http-session-last-accessed-time=1642331270092, kc-category-name=ACCESS, kc-iat=1642331268, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:50262 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:07:50.115  INFO 16 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:07:50.116  INFO 16 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@31debfea
2022-01-16 11:07:50.116  INFO 16 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@31debfea
2022-01-16 11:07:50.131  INFO 16 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@31debfea
2022-01-16 11:07:50.132  INFO 16 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@31debfea
2022-01-16 11:07:50.181  INFO 16 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@31debfea
2022-01-16 11:07:50.182  WARN 16 --- [https-jsse-nio-7071-exec-7] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:07:50.182  WARN 16 --- [https-jsse-nio-7071-exec-7] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:07:50.183  INFO 16 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@31debfea
2022-01-16 11:07:50.184  INFO 16 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@31debfea
2022-01-16 11:07:50.184  WARN 16 --- [https-jsse-nio-7071-exec-7] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:07:50.184  WARN 16 --- [https-jsse-nio-7071-exec-7] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:07:50.185  INFO 16 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@31debfea
2022-01-16 11:07:50.195  INFO 16 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: emergency-active, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@31debfea
2022-01-16 11:07:50.204  INFO 16 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@31debfea
2022-01-16 11:07:50.205  INFO 16 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@31debfea
2022-01-16 11:07:50.257  INFO 16 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@31debfea
2022-01-16 11:07:50.258  INFO 16 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-revoke-extra, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@31debfea
2022-01-16 11:07:50.268  INFO 16 --- [https-jsse-nio-7071-exec-7] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18909721216283909-485653, decision=PERMIT, pdp-result=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}})
2022-01-16 11:07:50.269  INFO 16 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=66373fc4-3081-46a2-aa88-9170074cc539, content=PERMIT, timestamp=1642331270269, pdpResult=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}}))
2022-01-16 11:07:50.270  INFO 16 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=154ms, Total=159ms
2022-01-16 11:07:50.304  INFO 16 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=48365bb5-bf48-4ffa-9883-c1d74654dab9, content=null, timestamp=1642331270294, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=50264, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=5fb2fe03fb5a, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=7187b2ea-af71-4106-9885-90a594c75da9, http-req-server-port=80, http-header-accept=*/*, kc-id=6b662965-9581-452d-9a8e-efb17f194ea0, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642331270292, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeP9sHNxAH4AEQAAAABh4/yEdAAkNmI2NjI5NjUtOTU4MS00NTJkLTlhOGUtZWZiMTdmMTk0ZWEwdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ3MTg3YjJlYS1hZjcxLTQxMDYtOTg4NS05MGE1OTRjNzVkYTlwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICI2cGUwZ2U1ck0zU2E2SUt5WXBsLTVkQTZrVXVleWo3X1psV2c1aDU4MmFvIn0.eyJleHAiOjE2NDIzMzE1NjgsImlhdCI6MTY0MjMzMTI2OCwianRpIjoiNmI2NjI5NjUtOTU4MS00NTJkLTlhOGUtZWZiMTdmMTk0ZWEwIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiI3MTg3YjJlYS1hZjcxLTQxMDYtOTg4NS05MGE1OTRjNzVkYTkiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.omg8lBi8aYXNKFtyz-59LVSg2a2tCMxJ-pijDZk_PJuP3t0KLP9mK065sgr18j9RRLlhB5Gz2kgicFArxHtivEl0gUXu61vDMI1JwNX-iJP3IW1nOuz1niWS06XTsBAs3FLboN9JCzCrlyLSB7kFOSKNyr9gnqXqesWQU1H_s6k9aowpZ2V4aNEsojTx4jRXH2wCNB77m23zlaTQfbhQx_Hi4ZBiiOFCmRXadXaP0PC2LKecdNH4x8WAIIR9Jxwe-mzphLjj5_er637GhiPlR7lUQk9Yn4L72NWb6IEYvcz5_B5E73AFiU_xFR5kcOBPp-wTl_8-LRcBhxSaV9WLrA, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642331568, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.48.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=6994A066EEE3660D2B0F494585F16640, http-session-last-accessed-time=1642331270292, kc-category-name=ACCESS, kc-iat=1642331268, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:50264 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:07:50.304  INFO 16 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:07:50.306  INFO 16 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@b87938f
2022-01-16 11:07:50.306  INFO 16 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@b87938f
2022-01-16 11:07:50.321  INFO 16 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@b87938f
2022-01-16 11:07:50.321  INFO 16 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@b87938f
2022-01-16 11:07:50.333  INFO 16 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@b87938f
2022-01-16 11:07:50.334  WARN 16 --- [https-jsse-nio-7071-exec-8] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:07:50.334  WARN 16 --- [https-jsse-nio-7071-exec-8] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:07:50.334  INFO 16 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@b87938f
2022-01-16 11:07:50.335  INFO 16 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@b87938f
2022-01-16 11:07:50.335  WARN 16 --- [https-jsse-nio-7071-exec-8] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:07:50.336  WARN 16 --- [https-jsse-nio-7071-exec-8] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:07:50.336  INFO 16 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@b87938f
2022-01-16 11:07:50.390  INFO 16 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: emergency-active, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@b87938f
2022-01-16 11:07:50.401  INFO 16 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@b87938f
2022-01-16 11:07:50.402  INFO 16 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@b87938f
2022-01-16 11:07:50.411  INFO 16 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@b87938f
2022-01-16 11:07:50.412  INFO 16 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-revoke-extra, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@b87938f
2022-01-16 11:07:50.463  INFO 16 --- [https-jsse-nio-7071-exec-8] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18909721405789527-735746, decision=PERMIT, pdp-result=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}})
2022-01-16 11:07:50.464  INFO 16 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=48365bb5-bf48-4ffa-9883-c1d74654dab9, content=PERMIT, timestamp=1642331270464, pdpResult=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}}))
2022-01-16 11:07:50.465  INFO 16 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=160ms, Total=163ms
2022-01-16 11:07:50.503  INFO 16 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=a4e1c71d-1df8-4951-b32f-88102c6db705, content=null, timestamp=1642331270486, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=50266, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=5fb2fe03fb5a, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=7187b2ea-af71-4106-9885-90a594c75da9, http-req-server-port=80, http-header-accept=*/*, kc-id=6b662965-9581-452d-9a8e-efb17f194ea0, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642331270484, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeP9sHNxAH4AEQAAAABh4/yEdAAkNmI2NjI5NjUtOTU4MS00NTJkLTlhOGUtZWZiMTdmMTk0ZWEwdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ3MTg3YjJlYS1hZjcxLTQxMDYtOTg4NS05MGE1OTRjNzVkYTlwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICI2cGUwZ2U1ck0zU2E2SUt5WXBsLTVkQTZrVXVleWo3X1psV2c1aDU4MmFvIn0.eyJleHAiOjE2NDIzMzE1NjgsImlhdCI6MTY0MjMzMTI2OCwianRpIjoiNmI2NjI5NjUtOTU4MS00NTJkLTlhOGUtZWZiMTdmMTk0ZWEwIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiI3MTg3YjJlYS1hZjcxLTQxMDYtOTg4NS05MGE1OTRjNzVkYTkiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.omg8lBi8aYXNKFtyz-59LVSg2a2tCMxJ-pijDZk_PJuP3t0KLP9mK065sgr18j9RRLlhB5Gz2kgicFArxHtivEl0gUXu61vDMI1JwNX-iJP3IW1nOuz1niWS06XTsBAs3FLboN9JCzCrlyLSB7kFOSKNyr9gnqXqesWQU1H_s6k9aowpZ2V4aNEsojTx4jRXH2wCNB77m23zlaTQfbhQx_Hi4ZBiiOFCmRXadXaP0PC2LKecdNH4x8WAIIR9Jxwe-mzphLjj5_er637GhiPlR7lUQk9Yn4L72NWb6IEYvcz5_B5E73AFiU_xFR5kcOBPp-wTl_8-LRcBhxSaV9WLrA, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642331568, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.48.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=9C34EC0B68AF683DD1AB066B8E0018BE, http-session-last-accessed-time=1642331270484, kc-category-name=ACCESS, kc-iat=1642331268, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:50266 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:07:50.503  INFO 16 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:07:50.505  INFO 16 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3086530c
2022-01-16 11:07:50.506  INFO 16 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3086530c
2022-01-16 11:07:50.517  INFO 16 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3086530c
2022-01-16 11:07:50.518  INFO 16 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3086530c
2022-01-16 11:07:50.527  INFO 16 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3086530c
2022-01-16 11:07:50.528  WARN 16 --- [https-jsse-nio-7071-exec-9] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:07:50.528  WARN 16 --- [https-jsse-nio-7071-exec-9] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:07:50.529  INFO 16 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3086530c
2022-01-16 11:07:50.529  INFO 16 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3086530c
2022-01-16 11:07:50.530  WARN 16 --- [https-jsse-nio-7071-exec-9] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:07:50.530  WARN 16 --- [https-jsse-nio-7071-exec-9] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:07:50.530  INFO 16 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3086530c
2022-01-16 11:07:50.540  INFO 16 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: emergency-active, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3086530c
2022-01-16 11:07:50.594  INFO 16 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3086530c
2022-01-16 11:07:50.594  INFO 16 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3086530c
2022-01-16 11:07:50.605  INFO 16 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3086530c
2022-01-16 11:07:50.605  INFO 16 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-revoke-extra, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3086530c
2022-01-16 11:07:50.615  INFO 16 --- [https-jsse-nio-7071-exec-9] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18909721605014777-948240, decision=PERMIT, pdp-result=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}})
2022-01-16 11:07:50.615  INFO 16 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=a4e1c71d-1df8-4951-b32f-88102c6db705, content=PERMIT, timestamp=1642331270615, pdpResult=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}}))
2022-01-16 11:07:50.615  INFO 16 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=111ms, Total=115ms
2022-01-16 11:07:50.661  INFO 16 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=6f269bf2-481a-42cb-8013-accf9958c9b7, content=null, timestamp=1642331270637, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=50268, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=5fb2fe03fb5a, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=7187b2ea-af71-4106-9885-90a594c75da9, http-req-server-port=80, http-header-accept=*/*, kc-id=6b662965-9581-452d-9a8e-efb17f194ea0, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642331270634, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeP9sHNxAH4AEQAAAABh4/yEdAAkNmI2NjI5NjUtOTU4MS00NTJkLTlhOGUtZWZiMTdmMTk0ZWEwdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ3MTg3YjJlYS1hZjcxLTQxMDYtOTg4NS05MGE1OTRjNzVkYTlwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICI2cGUwZ2U1ck0zU2E2SUt5WXBsLTVkQTZrVXVleWo3X1psV2c1aDU4MmFvIn0.eyJleHAiOjE2NDIzMzE1NjgsImlhdCI6MTY0MjMzMTI2OCwianRpIjoiNmI2NjI5NjUtOTU4MS00NTJkLTlhOGUtZWZiMTdmMTk0ZWEwIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiI3MTg3YjJlYS1hZjcxLTQxMDYtOTg4NS05MGE1OTRjNzVkYTkiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.omg8lBi8aYXNKFtyz-59LVSg2a2tCMxJ-pijDZk_PJuP3t0KLP9mK065sgr18j9RRLlhB5Gz2kgicFArxHtivEl0gUXu61vDMI1JwNX-iJP3IW1nOuz1niWS06XTsBAs3FLboN9JCzCrlyLSB7kFOSKNyr9gnqXqesWQU1H_s6k9aowpZ2V4aNEsojTx4jRXH2wCNB77m23zlaTQfbhQx_Hi4ZBiiOFCmRXadXaP0PC2LKecdNH4x8WAIIR9Jxwe-mzphLjj5_er637GhiPlR7lUQk9Yn4L72NWb6IEYvcz5_B5E73AFiU_xFR5kcOBPp-wTl_8-LRcBhxSaV9WLrA, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642331568, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.48.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=7535BDCABB91246D8F7D2BFD7A70BB5F, http-session-last-accessed-time=1642331270634, kc-category-name=ACCESS, kc-iat=1642331268, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:50268 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:07:50.662  INFO 16 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:07:50.664  INFO 16 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@78a0a01e
2022-01-16 11:07:50.666  INFO 16 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@78a0a01e
2022-01-16 11:07:50.677  INFO 16 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@78a0a01e
2022-01-16 11:07:50.678  INFO 16 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@78a0a01e
2022-01-16 11:07:50.730  INFO 16 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@78a0a01e
2022-01-16 11:07:50.730  WARN 16 --- [https-jsse-nio-7071-exec-10] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:07:50.730  WARN 16 --- [https-jsse-nio-7071-exec-10] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:07:50.731  INFO 16 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@78a0a01e
2022-01-16 11:07:50.731  INFO 16 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@78a0a01e
2022-01-16 11:07:50.731  WARN 16 --- [https-jsse-nio-7071-exec-10] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:07:50.732  WARN 16 --- [https-jsse-nio-7071-exec-10] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:07:50.732  INFO 16 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@78a0a01e
2022-01-16 11:07:50.742  INFO 16 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: emergency-active, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@78a0a01e
2022-01-16 11:07:50.752  INFO 16 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@78a0a01e
2022-01-16 11:07:50.752  INFO 16 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@78a0a01e
2022-01-16 11:07:50.802  INFO 16 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@78a0a01e
2022-01-16 11:07:50.803  INFO 16 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-revoke-extra, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@78a0a01e
2022-01-16 11:07:50.816  INFO 16 --- [https-jsse-nio-7071-exec-10] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18909721763492408-879340, decision=PERMIT, pdp-result=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}})
2022-01-16 11:07:50.817  INFO 16 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=6f269bf2-481a-42cb-8013-accf9958c9b7, content=PERMIT, timestamp=1642331270817, pdpResult=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}}))
2022-01-16 11:07:50.818  INFO 16 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=155ms, Total=164ms
2022-01-16 11:07:50.852  INFO 16 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=e9f0faab-4d15-414a-8258-e086fef1805a, content=null, timestamp=1642331270844, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=50270, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=5fb2fe03fb5a, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=7187b2ea-af71-4106-9885-90a594c75da9, http-req-server-port=80, http-header-accept=*/*, kc-id=6b662965-9581-452d-9a8e-efb17f194ea0, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642331270842, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeP9sHNxAH4AEQAAAABh4/yEdAAkNmI2NjI5NjUtOTU4MS00NTJkLTlhOGUtZWZiMTdmMTk0ZWEwdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ3MTg3YjJlYS1hZjcxLTQxMDYtOTg4NS05MGE1OTRjNzVkYTlwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICI2cGUwZ2U1ck0zU2E2SUt5WXBsLTVkQTZrVXVleWo3X1psV2c1aDU4MmFvIn0.eyJleHAiOjE2NDIzMzE1NjgsImlhdCI6MTY0MjMzMTI2OCwianRpIjoiNmI2NjI5NjUtOTU4MS00NTJkLTlhOGUtZWZiMTdmMTk0ZWEwIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiI3MTg3YjJlYS1hZjcxLTQxMDYtOTg4NS05MGE1OTRjNzVkYTkiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.omg8lBi8aYXNKFtyz-59LVSg2a2tCMxJ-pijDZk_PJuP3t0KLP9mK065sgr18j9RRLlhB5Gz2kgicFArxHtivEl0gUXu61vDMI1JwNX-iJP3IW1nOuz1niWS06XTsBAs3FLboN9JCzCrlyLSB7kFOSKNyr9gnqXqesWQU1H_s6k9aowpZ2V4aNEsojTx4jRXH2wCNB77m23zlaTQfbhQx_Hi4ZBiiOFCmRXadXaP0PC2LKecdNH4x8WAIIR9Jxwe-mzphLjj5_er637GhiPlR7lUQk9Yn4L72NWb6IEYvcz5_B5E73AFiU_xFR5kcOBPp-wTl_8-LRcBhxSaV9WLrA, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642331568, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.48.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=B28CFEE199CF0F884DD4092773EFBCA4, http-session-last-accessed-time=1642331270842, kc-category-name=ACCESS, kc-iat=1642331268, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:50270 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:07:50.853  INFO 16 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:07:50.854  INFO 16 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@500541f6
2022-01-16 11:07:50.855  INFO 16 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@500541f6
2022-01-16 11:07:50.865  INFO 16 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@500541f6
2022-01-16 11:07:50.866  INFO 16 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@500541f6
2022-01-16 11:07:50.878  INFO 16 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@500541f6
2022-01-16 11:07:50.878  WARN 16 --- [https-jsse-nio-7071-exec-1] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:07:50.878  WARN 16 --- [https-jsse-nio-7071-exec-1] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:07:50.879  INFO 16 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@500541f6
2022-01-16 11:07:50.879  INFO 16 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@500541f6
2022-01-16 11:07:50.879  WARN 16 --- [https-jsse-nio-7071-exec-1] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:07:50.880  WARN 16 --- [https-jsse-nio-7071-exec-1] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:07:50.880  INFO 16 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@500541f6
2022-01-16 11:07:50.933  INFO 16 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: emergency-active, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@500541f6
2022-01-16 11:07:50.946  INFO 16 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@500541f6
2022-01-16 11:07:50.946  INFO 16 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@500541f6
2022-01-16 11:07:50.954  INFO 16 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@500541f6
2022-01-16 11:07:50.955  INFO 16 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-revoke-extra, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@500541f6
2022-01-16 11:07:51.006  INFO 16 --- [https-jsse-nio-7071-exec-1] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18909721954503757-953001, decision=PERMIT, pdp-result=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}})
2022-01-16 11:07:51.007  INFO 16 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=e9f0faab-4d15-414a-8258-e086fef1805a, content=PERMIT, timestamp=1642331271007, pdpResult=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}}))
2022-01-16 11:07:51.008  INFO 16 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=154ms, Total=157ms
2022-01-16 11:07:51.051  INFO 16 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=adda1f3b-78cb-4080-91d1-553c70a476ea, content=null, timestamp=1642331271040, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=50272, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=5fb2fe03fb5a, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=7187b2ea-af71-4106-9885-90a594c75da9, http-req-server-port=80, http-header-accept=*/*, kc-id=6b662965-9581-452d-9a8e-efb17f194ea0, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642331271037, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeP9sHNxAH4AEQAAAABh4/yEdAAkNmI2NjI5NjUtOTU4MS00NTJkLTlhOGUtZWZiMTdmMTk0ZWEwdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ3MTg3YjJlYS1hZjcxLTQxMDYtOTg4NS05MGE1OTRjNzVkYTlwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICI2cGUwZ2U1ck0zU2E2SUt5WXBsLTVkQTZrVXVleWo3X1psV2c1aDU4MmFvIn0.eyJleHAiOjE2NDIzMzE1NjgsImlhdCI6MTY0MjMzMTI2OCwianRpIjoiNmI2NjI5NjUtOTU4MS00NTJkLTlhOGUtZWZiMTdmMTk0ZWEwIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiI3MTg3YjJlYS1hZjcxLTQxMDYtOTg4NS05MGE1OTRjNzVkYTkiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.omg8lBi8aYXNKFtyz-59LVSg2a2tCMxJ-pijDZk_PJuP3t0KLP9mK065sgr18j9RRLlhB5Gz2kgicFArxHtivEl0gUXu61vDMI1JwNX-iJP3IW1nOuz1niWS06XTsBAs3FLboN9JCzCrlyLSB7kFOSKNyr9gnqXqesWQU1H_s6k9aowpZ2V4aNEsojTx4jRXH2wCNB77m23zlaTQfbhQx_Hi4ZBiiOFCmRXadXaP0PC2LKecdNH4x8WAIIR9Jxwe-mzphLjj5_er637GhiPlR7lUQk9Yn4L72NWb6IEYvcz5_B5E73AFiU_xFR5kcOBPp-wTl_8-LRcBhxSaV9WLrA, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642331568, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.48.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=F32BC381D058D991D452EC50512D822B, http-session-last-accessed-time=1642331271037, kc-category-name=ACCESS, kc-iat=1642331268, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:50272 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:07:51.052  INFO 16 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:07:51.054  INFO 16 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@bb73f9b
2022-01-16 11:07:51.055  INFO 16 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@bb73f9b
2022-01-16 11:07:51.068  INFO 16 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@bb73f9b
2022-01-16 11:07:51.068  INFO 16 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@bb73f9b
2022-01-16 11:07:51.090  INFO 16 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@bb73f9b
2022-01-16 11:07:51.094  WARN 16 --- [https-jsse-nio-7071-exec-2] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:07:51.094  WARN 16 --- [https-jsse-nio-7071-exec-2] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:07:51.097  INFO 16 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@bb73f9b
2022-01-16 11:07:51.097  INFO 16 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@bb73f9b
2022-01-16 11:07:51.098  WARN 16 --- [https-jsse-nio-7071-exec-2] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:07:51.100  WARN 16 --- [https-jsse-nio-7071-exec-2] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:07:51.101  INFO 16 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@bb73f9b
2022-01-16 11:07:51.161  INFO 16 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: emergency-active, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@bb73f9b
2022-01-16 11:07:51.177  INFO 16 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@bb73f9b
2022-01-16 11:07:51.178  INFO 16 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@bb73f9b
2022-01-16 11:07:51.187  INFO 16 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@bb73f9b
2022-01-16 11:07:51.188  INFO 16 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-revoke-extra, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@bb73f9b
2022-01-16 11:07:51.238  INFO 16 --- [https-jsse-nio-7071-exec-2] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18909722154203334-886150, decision=PERMIT, pdp-result=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}})
2022-01-16 11:07:51.238  INFO 16 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=adda1f3b-78cb-4080-91d1-553c70a476ea, content=PERMIT, timestamp=1642331271238, pdpResult=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}}))
2022-01-16 11:07:51.239  INFO 16 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=185ms, Total=190ms
2022-01-16 11:07:51.268  INFO 16 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=3e9e8360-4f1b-4be6-a245-52b8d6c8a1e5, content=null, timestamp=1642331271261, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=50274, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=5fb2fe03fb5a, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=7187b2ea-af71-4106-9885-90a594c75da9, http-req-server-port=80, http-header-accept=*/*, kc-id=6b662965-9581-452d-9a8e-efb17f194ea0, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642331271259, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeP9sHNxAH4AEQAAAABh4/yEdAAkNmI2NjI5NjUtOTU4MS00NTJkLTlhOGUtZWZiMTdmMTk0ZWEwdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ3MTg3YjJlYS1hZjcxLTQxMDYtOTg4NS05MGE1OTRjNzVkYTlwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICI2cGUwZ2U1ck0zU2E2SUt5WXBsLTVkQTZrVXVleWo3X1psV2c1aDU4MmFvIn0.eyJleHAiOjE2NDIzMzE1NjgsImlhdCI6MTY0MjMzMTI2OCwianRpIjoiNmI2NjI5NjUtOTU4MS00NTJkLTlhOGUtZWZiMTdmMTk0ZWEwIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiI3MTg3YjJlYS1hZjcxLTQxMDYtOTg4NS05MGE1OTRjNzVkYTkiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.omg8lBi8aYXNKFtyz-59LVSg2a2tCMxJ-pijDZk_PJuP3t0KLP9mK065sgr18j9RRLlhB5Gz2kgicFArxHtivEl0gUXu61vDMI1JwNX-iJP3IW1nOuz1niWS06XTsBAs3FLboN9JCzCrlyLSB7kFOSKNyr9gnqXqesWQU1H_s6k9aowpZ2V4aNEsojTx4jRXH2wCNB77m23zlaTQfbhQx_Hi4ZBiiOFCmRXadXaP0PC2LKecdNH4x8WAIIR9Jxwe-mzphLjj5_er637GhiPlR7lUQk9Yn4L72NWb6IEYvcz5_B5E73AFiU_xFR5kcOBPp-wTl_8-LRcBhxSaV9WLrA, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642331568, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.48.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=BDF7E4D1119547027F681D05ED79595A, http-session-last-accessed-time=1642331271259, kc-category-name=ACCESS, kc-iat=1642331268, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:50274 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:07:51.269  INFO 16 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:07:51.271  INFO 16 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@58b8d485
2022-01-16 11:07:51.271  INFO 16 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@58b8d485
2022-01-16 11:07:51.287  INFO 16 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@58b8d485
2022-01-16 11:07:51.287  INFO 16 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@58b8d485
2022-01-16 11:07:51.299  INFO 16 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@58b8d485
2022-01-16 11:07:51.299  WARN 16 --- [https-jsse-nio-7071-exec-3] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:07:51.299  WARN 16 --- [https-jsse-nio-7071-exec-3] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:07:51.299  INFO 16 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@58b8d485
2022-01-16 11:07:51.300  INFO 16 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@58b8d485
2022-01-16 11:07:51.300  WARN 16 --- [https-jsse-nio-7071-exec-3] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:07:51.300  WARN 16 --- [https-jsse-nio-7071-exec-3] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:07:51.301  INFO 16 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@58b8d485
2022-01-16 11:07:51.353  INFO 16 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: emergency-active, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@58b8d485
2022-01-16 11:07:51.367  INFO 16 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@58b8d485
2022-01-16 11:07:51.367  INFO 16 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@58b8d485
2022-01-16 11:07:51.376  INFO 16 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@58b8d485
2022-01-16 11:07:51.376  INFO 16 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-revoke-extra, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@58b8d485
2022-01-16 11:07:51.435  INFO 16 --- [https-jsse-nio-7071-exec-3] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18909722371204638-702520, decision=PERMIT, pdp-result=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}})
2022-01-16 11:07:51.436  INFO 16 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=3e9e8360-4f1b-4be6-a245-52b8d6c8a1e5, content=PERMIT, timestamp=1642331271436, pdpResult=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}}))
2022-01-16 11:07:51.438  INFO 16 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=166ms, Total=171ms
2022-01-16 11:07:51.480  INFO 16 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=cc2455e1-6afb-4135-b4f8-7d7444f9c340, content=null, timestamp=1642331271471, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=50276, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=5fb2fe03fb5a, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=7187b2ea-af71-4106-9885-90a594c75da9, http-req-server-port=80, http-header-accept=*/*, kc-id=6b662965-9581-452d-9a8e-efb17f194ea0, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642331271469, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeP9sHNxAH4AEQAAAABh4/yEdAAkNmI2NjI5NjUtOTU4MS00NTJkLTlhOGUtZWZiMTdmMTk0ZWEwdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ3MTg3YjJlYS1hZjcxLTQxMDYtOTg4NS05MGE1OTRjNzVkYTlwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICI2cGUwZ2U1ck0zU2E2SUt5WXBsLTVkQTZrVXVleWo3X1psV2c1aDU4MmFvIn0.eyJleHAiOjE2NDIzMzE1NjgsImlhdCI6MTY0MjMzMTI2OCwianRpIjoiNmI2NjI5NjUtOTU4MS00NTJkLTlhOGUtZWZiMTdmMTk0ZWEwIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiI3MTg3YjJlYS1hZjcxLTQxMDYtOTg4NS05MGE1OTRjNzVkYTkiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.omg8lBi8aYXNKFtyz-59LVSg2a2tCMxJ-pijDZk_PJuP3t0KLP9mK065sgr18j9RRLlhB5Gz2kgicFArxHtivEl0gUXu61vDMI1JwNX-iJP3IW1nOuz1niWS06XTsBAs3FLboN9JCzCrlyLSB7kFOSKNyr9gnqXqesWQU1H_s6k9aowpZ2V4aNEsojTx4jRXH2wCNB77m23zlaTQfbhQx_Hi4ZBiiOFCmRXadXaP0PC2LKecdNH4x8WAIIR9Jxwe-mzphLjj5_er637GhiPlR7lUQk9Yn4L72NWb6IEYvcz5_B5E73AFiU_xFR5kcOBPp-wTl_8-LRcBhxSaV9WLrA, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642331568, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.48.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=54F728C0010FEBF4D7CA6576EDA17447, http-session-last-accessed-time=1642331271469, kc-category-name=ACCESS, kc-iat=1642331268, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:50276 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:07:51.481  INFO 16 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:07:51.482  INFO 16 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7fd3437e
2022-01-16 11:07:51.483  INFO 16 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7fd3437e
2022-01-16 11:07:51.498  INFO 16 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7fd3437e
2022-01-16 11:07:51.501  INFO 16 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7fd3437e
2022-01-16 11:07:51.510  INFO 16 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7fd3437e
2022-01-16 11:07:51.511  WARN 16 --- [https-jsse-nio-7071-exec-4] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:07:51.511  WARN 16 --- [https-jsse-nio-7071-exec-4] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:07:51.511  INFO 16 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7fd3437e
2022-01-16 11:07:51.512  INFO 16 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7fd3437e
2022-01-16 11:07:51.512  WARN 16 --- [https-jsse-nio-7071-exec-4] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:07:51.513  WARN 16 --- [https-jsse-nio-7071-exec-4] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:07:51.513  INFO 16 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7fd3437e
2022-01-16 11:07:51.565  INFO 16 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: emergency-active, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7fd3437e
2022-01-16 11:07:51.574  INFO 16 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7fd3437e
2022-01-16 11:07:51.574  INFO 16 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7fd3437e
2022-01-16 11:07:51.583  INFO 16 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7fd3437e
2022-01-16 11:07:51.584  INFO 16 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-revoke-extra, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7fd3437e
2022-01-16 11:07:51.638  INFO 16 --- [https-jsse-nio-7071-exec-4] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18909722582826904-348082, decision=PERMIT, pdp-result=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}})
2022-01-16 11:07:51.638  INFO 16 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=cc2455e1-6afb-4135-b4f8-7d7444f9c340, content=PERMIT, timestamp=1642331271638, pdpResult=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}}))
2022-01-16 11:07:51.639  INFO 16 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=157ms, Total=160ms
2022-01-16 11:07:51.669  INFO 16 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=598eac29-b689-47ef-b431-48a73513db61, content=null, timestamp=1642331271662, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=50278, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=5fb2fe03fb5a, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=7187b2ea-af71-4106-9885-90a594c75da9, http-req-server-port=80, http-header-accept=*/*, kc-id=6b662965-9581-452d-9a8e-efb17f194ea0, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642331271661, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeP9sHNxAH4AEQAAAABh4/yEdAAkNmI2NjI5NjUtOTU4MS00NTJkLTlhOGUtZWZiMTdmMTk0ZWEwdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ3MTg3YjJlYS1hZjcxLTQxMDYtOTg4NS05MGE1OTRjNzVkYTlwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICI2cGUwZ2U1ck0zU2E2SUt5WXBsLTVkQTZrVXVleWo3X1psV2c1aDU4MmFvIn0.eyJleHAiOjE2NDIzMzE1NjgsImlhdCI6MTY0MjMzMTI2OCwianRpIjoiNmI2NjI5NjUtOTU4MS00NTJkLTlhOGUtZWZiMTdmMTk0ZWEwIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiI3MTg3YjJlYS1hZjcxLTQxMDYtOTg4NS05MGE1OTRjNzVkYTkiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.omg8lBi8aYXNKFtyz-59LVSg2a2tCMxJ-pijDZk_PJuP3t0KLP9mK065sgr18j9RRLlhB5Gz2kgicFArxHtivEl0gUXu61vDMI1JwNX-iJP3IW1nOuz1niWS06XTsBAs3FLboN9JCzCrlyLSB7kFOSKNyr9gnqXqesWQU1H_s6k9aowpZ2V4aNEsojTx4jRXH2wCNB77m23zlaTQfbhQx_Hi4ZBiiOFCmRXadXaP0PC2LKecdNH4x8WAIIR9Jxwe-mzphLjj5_er637GhiPlR7lUQk9Yn4L72NWb6IEYvcz5_B5E73AFiU_xFR5kcOBPp-wTl_8-LRcBhxSaV9WLrA, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642331568, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.48.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=A524E0693AE5BDCF51A4443E33EC02F5, http-session-last-accessed-time=1642331271661, kc-category-name=ACCESS, kc-iat=1642331268, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:50278 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:07:51.670  INFO 16 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:07:51.672  INFO 16 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7722c6f6
2022-01-16 11:07:51.673  INFO 16 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7722c6f6
2022-01-16 11:07:51.687  INFO 16 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7722c6f6
2022-01-16 11:07:51.687  INFO 16 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7722c6f6
2022-01-16 11:07:51.696  INFO 16 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7722c6f6
2022-01-16 11:07:51.696  WARN 16 --- [https-jsse-nio-7071-exec-5] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:07:51.696  WARN 16 --- [https-jsse-nio-7071-exec-5] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:07:51.697  INFO 16 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7722c6f6
2022-01-16 11:07:51.697  INFO 16 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7722c6f6
2022-01-16 11:07:51.698  WARN 16 --- [https-jsse-nio-7071-exec-5] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:07:51.698  WARN 16 --- [https-jsse-nio-7071-exec-5] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:07:51.699  INFO 16 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7722c6f6
2022-01-16 11:07:51.707  INFO 16 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: emergency-active, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7722c6f6
2022-01-16 11:07:51.758  INFO 16 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7722c6f6
2022-01-16 11:07:51.758  INFO 16 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7722c6f6
2022-01-16 11:07:51.771  INFO 16 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7722c6f6
2022-01-16 11:07:51.772  INFO 16 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-revoke-extra, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7722c6f6
2022-01-16 11:07:51.784  INFO 16 --- [https-jsse-nio-7071-exec-5] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18909722772356165-757064, decision=PERMIT, pdp-result=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}})
2022-01-16 11:07:51.785  INFO 16 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=598eac29-b689-47ef-b431-48a73513db61, content=PERMIT, timestamp=1642331271785, pdpResult=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}}))
2022-01-16 11:07:51.786  INFO 16 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=114ms, Total=119ms
2022-01-16 11:07:51.812  INFO 16 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=09043222-0059-46ec-b2a9-0216dd57f308, content=null, timestamp=1642331271805, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=50280, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=5fb2fe03fb5a, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=7187b2ea-af71-4106-9885-90a594c75da9, http-req-server-port=80, http-header-accept=*/*, kc-id=6b662965-9581-452d-9a8e-efb17f194ea0, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642331271804, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeP9sHNxAH4AEQAAAABh4/yEdAAkNmI2NjI5NjUtOTU4MS00NTJkLTlhOGUtZWZiMTdmMTk0ZWEwdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ3MTg3YjJlYS1hZjcxLTQxMDYtOTg4NS05MGE1OTRjNzVkYTlwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICI2cGUwZ2U1ck0zU2E2SUt5WXBsLTVkQTZrVXVleWo3X1psV2c1aDU4MmFvIn0.eyJleHAiOjE2NDIzMzE1NjgsImlhdCI6MTY0MjMzMTI2OCwianRpIjoiNmI2NjI5NjUtOTU4MS00NTJkLTlhOGUtZWZiMTdmMTk0ZWEwIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiI3MTg3YjJlYS1hZjcxLTQxMDYtOTg4NS05MGE1OTRjNzVkYTkiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.omg8lBi8aYXNKFtyz-59LVSg2a2tCMxJ-pijDZk_PJuP3t0KLP9mK065sgr18j9RRLlhB5Gz2kgicFArxHtivEl0gUXu61vDMI1JwNX-iJP3IW1nOuz1niWS06XTsBAs3FLboN9JCzCrlyLSB7kFOSKNyr9gnqXqesWQU1H_s6k9aowpZ2V4aNEsojTx4jRXH2wCNB77m23zlaTQfbhQx_Hi4ZBiiOFCmRXadXaP0PC2LKecdNH4x8WAIIR9Jxwe-mzphLjj5_er637GhiPlR7lUQk9Yn4L72NWb6IEYvcz5_B5E73AFiU_xFR5kcOBPp-wTl_8-LRcBhxSaV9WLrA, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642331568, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.48.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=A5FBA0639710742FCE447058CC21927C, http-session-last-accessed-time=1642331271804, kc-category-name=ACCESS, kc-iat=1642331268, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:50280 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:07:51.813  INFO 16 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:07:51.814  INFO 16 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@138b0b6b
2022-01-16 11:07:51.814  INFO 16 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@138b0b6b
2022-01-16 11:07:51.865  INFO 16 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@138b0b6b
2022-01-16 11:07:51.866  INFO 16 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@138b0b6b
2022-01-16 11:07:51.881  INFO 16 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@138b0b6b
2022-01-16 11:07:51.882  WARN 16 --- [https-jsse-nio-7071-exec-6] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:07:51.882  WARN 16 --- [https-jsse-nio-7071-exec-6] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:07:51.882  INFO 16 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@138b0b6b
2022-01-16 11:07:51.883  INFO 16 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@138b0b6b
2022-01-16 11:07:51.883  WARN 16 --- [https-jsse-nio-7071-exec-6] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:07:51.883  WARN 16 --- [https-jsse-nio-7071-exec-6] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:07:51.884  INFO 16 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@138b0b6b
2022-01-16 11:07:51.895  INFO 16 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: emergency-active, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@138b0b6b
2022-01-16 11:07:51.946  INFO 16 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@138b0b6b
2022-01-16 11:07:51.947  INFO 16 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@138b0b6b
2022-01-16 11:07:51.965  INFO 16 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@138b0b6b
2022-01-16 11:07:51.966  INFO 16 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-revoke-extra, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@138b0b6b
2022-01-16 11:07:51.981  INFO 16 --- [https-jsse-nio-7071-exec-6] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18909722914283849-112288, decision=PERMIT, pdp-result=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}})
2022-01-16 11:07:51.982  INFO 16 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=09043222-0059-46ec-b2a9-0216dd57f308, content=PERMIT, timestamp=1642331271982, pdpResult=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}}))
2022-01-16 11:07:51.983  INFO 16 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=169ms, Total=172ms
2022-01-16 11:07:52.010  INFO 16 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=39dc4dbd-7c9e-48a8-9830-e5aeefd44900, content=null, timestamp=1642331272004, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=50282, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=5fb2fe03fb5a, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=7187b2ea-af71-4106-9885-90a594c75da9, http-req-server-port=80, http-header-accept=*/*, kc-id=6b662965-9581-452d-9a8e-efb17f194ea0, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642331272002, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeP9sHNxAH4AEQAAAABh4/yEdAAkNmI2NjI5NjUtOTU4MS00NTJkLTlhOGUtZWZiMTdmMTk0ZWEwdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ3MTg3YjJlYS1hZjcxLTQxMDYtOTg4NS05MGE1OTRjNzVkYTlwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICI2cGUwZ2U1ck0zU2E2SUt5WXBsLTVkQTZrVXVleWo3X1psV2c1aDU4MmFvIn0.eyJleHAiOjE2NDIzMzE1NjgsImlhdCI6MTY0MjMzMTI2OCwianRpIjoiNmI2NjI5NjUtOTU4MS00NTJkLTlhOGUtZWZiMTdmMTk0ZWEwIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiI3MTg3YjJlYS1hZjcxLTQxMDYtOTg4NS05MGE1OTRjNzVkYTkiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.omg8lBi8aYXNKFtyz-59LVSg2a2tCMxJ-pijDZk_PJuP3t0KLP9mK065sgr18j9RRLlhB5Gz2kgicFArxHtivEl0gUXu61vDMI1JwNX-iJP3IW1nOuz1niWS06XTsBAs3FLboN9JCzCrlyLSB7kFOSKNyr9gnqXqesWQU1H_s6k9aowpZ2V4aNEsojTx4jRXH2wCNB77m23zlaTQfbhQx_Hi4ZBiiOFCmRXadXaP0PC2LKecdNH4x8WAIIR9Jxwe-mzphLjj5_er637GhiPlR7lUQk9Yn4L72NWb6IEYvcz5_B5E73AFiU_xFR5kcOBPp-wTl_8-LRcBhxSaV9WLrA, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642331568, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.48.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=8227450C7C7E21CC71A876ADB588CA26, http-session-last-accessed-time=1642331272002, kc-category-name=ACCESS, kc-iat=1642331268, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:50282 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:07:52.011  INFO 16 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:07:52.012  INFO 16 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@68d74042
2022-01-16 11:07:52.013  INFO 16 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@68d74042
2022-01-16 11:07:52.070  INFO 16 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@68d74042
2022-01-16 11:07:52.071  INFO 16 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@68d74042
2022-01-16 11:07:52.082  INFO 16 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@68d74042
2022-01-16 11:07:52.082  WARN 16 --- [https-jsse-nio-7071-exec-7] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:07:52.082  WARN 16 --- [https-jsse-nio-7071-exec-7] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:07:52.083  INFO 16 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@68d74042
2022-01-16 11:07:52.083  INFO 16 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@68d74042
2022-01-16 11:07:52.083  WARN 16 --- [https-jsse-nio-7071-exec-7] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:07:52.084  WARN 16 --- [https-jsse-nio-7071-exec-7] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:07:52.084  INFO 16 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@68d74042
2022-01-16 11:07:52.093  INFO 16 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: emergency-active, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@68d74042
2022-01-16 11:07:52.145  INFO 16 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@68d74042
2022-01-16 11:07:52.145  INFO 16 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@68d74042
2022-01-16 11:07:52.163  INFO 16 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@68d74042
2022-01-16 11:07:52.164  INFO 16 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-revoke-extra, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@68d74042
2022-01-16 11:07:52.175  INFO 16 --- [https-jsse-nio-7071-exec-7] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18909723112690655-275077, decision=PERMIT, pdp-result=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}})
2022-01-16 11:07:52.175  INFO 16 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=39dc4dbd-7c9e-48a8-9830-e5aeefd44900, content=PERMIT, timestamp=1642331272175, pdpResult=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}}))
2022-01-16 11:07:52.176  INFO 16 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=164ms, Total=167ms
2022-01-16 11:07:52.212  INFO 16 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=8752dc62-b731-4c90-b6af-8f4f21419adb, content=null, timestamp=1642331272195, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=50284, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=5fb2fe03fb5a, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=7187b2ea-af71-4106-9885-90a594c75da9, http-req-server-port=80, http-header-accept=*/*, kc-id=6b662965-9581-452d-9a8e-efb17f194ea0, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642331272194, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeP9sHNxAH4AEQAAAABh4/yEdAAkNmI2NjI5NjUtOTU4MS00NTJkLTlhOGUtZWZiMTdmMTk0ZWEwdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ3MTg3YjJlYS1hZjcxLTQxMDYtOTg4NS05MGE1OTRjNzVkYTlwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICI2cGUwZ2U1ck0zU2E2SUt5WXBsLTVkQTZrVXVleWo3X1psV2c1aDU4MmFvIn0.eyJleHAiOjE2NDIzMzE1NjgsImlhdCI6MTY0MjMzMTI2OCwianRpIjoiNmI2NjI5NjUtOTU4MS00NTJkLTlhOGUtZWZiMTdmMTk0ZWEwIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiI3MTg3YjJlYS1hZjcxLTQxMDYtOTg4NS05MGE1OTRjNzVkYTkiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.omg8lBi8aYXNKFtyz-59LVSg2a2tCMxJ-pijDZk_PJuP3t0KLP9mK065sgr18j9RRLlhB5Gz2kgicFArxHtivEl0gUXu61vDMI1JwNX-iJP3IW1nOuz1niWS06XTsBAs3FLboN9JCzCrlyLSB7kFOSKNyr9gnqXqesWQU1H_s6k9aowpZ2V4aNEsojTx4jRXH2wCNB77m23zlaTQfbhQx_Hi4ZBiiOFCmRXadXaP0PC2LKecdNH4x8WAIIR9Jxwe-mzphLjj5_er637GhiPlR7lUQk9Yn4L72NWb6IEYvcz5_B5E73AFiU_xFR5kcOBPp-wTl_8-LRcBhxSaV9WLrA, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642331568, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.48.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=4FA2C66187998E9D05D874499B935EE7, http-session-last-accessed-time=1642331272194, kc-category-name=ACCESS, kc-iat=1642331268, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:50284 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:07:52.212  INFO 16 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:07:52.214  INFO 16 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@cf1f83
2022-01-16 11:07:52.215  INFO 16 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@cf1f83
2022-01-16 11:07:52.226  INFO 16 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@cf1f83
2022-01-16 11:07:52.226  INFO 16 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@cf1f83
2022-01-16 11:07:52.277  INFO 16 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@cf1f83
2022-01-16 11:07:52.278  WARN 16 --- [https-jsse-nio-7071-exec-8] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:07:52.278  WARN 16 --- [https-jsse-nio-7071-exec-8] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:07:52.278  INFO 16 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@cf1f83
2022-01-16 11:07:52.279  INFO 16 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@cf1f83
2022-01-16 11:07:52.279  WARN 16 --- [https-jsse-nio-7071-exec-8] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:07:52.279  WARN 16 --- [https-jsse-nio-7071-exec-8] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:07:52.279  INFO 16 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@cf1f83
2022-01-16 11:07:52.295  INFO 16 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: emergency-active, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@cf1f83
2022-01-16 11:07:52.305  INFO 16 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@cf1f83
2022-01-16 11:07:52.306  INFO 16 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@cf1f83
2022-01-16 11:07:52.365  INFO 16 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@cf1f83
2022-01-16 11:07:52.366  INFO 16 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-revoke-extra, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@cf1f83
2022-01-16 11:07:52.386  INFO 16 --- [https-jsse-nio-7071-exec-8] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18909723314307122-798415, decision=PERMIT, pdp-result=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}})
2022-01-16 11:07:52.386  INFO 16 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=8752dc62-b731-4c90-b6af-8f4f21419adb, content=PERMIT, timestamp=1642331272386, pdpResult=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}}))
2022-01-16 11:07:52.387  INFO 16 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=173ms, Total=176ms
2022-01-16 11:07:52.422  INFO 16 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=62ef7b88-ab84-4e39-8eaf-3b1e6824d9dc, content=null, timestamp=1642331272413, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=50286, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=5fb2fe03fb5a, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=7187b2ea-af71-4106-9885-90a594c75da9, http-req-server-port=80, http-header-accept=*/*, kc-id=6b662965-9581-452d-9a8e-efb17f194ea0, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642331272411, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeP9sHNxAH4AEQAAAABh4/yEdAAkNmI2NjI5NjUtOTU4MS00NTJkLTlhOGUtZWZiMTdmMTk0ZWEwdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ3MTg3YjJlYS1hZjcxLTQxMDYtOTg4NS05MGE1OTRjNzVkYTlwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICI2cGUwZ2U1ck0zU2E2SUt5WXBsLTVkQTZrVXVleWo3X1psV2c1aDU4MmFvIn0.eyJleHAiOjE2NDIzMzE1NjgsImlhdCI6MTY0MjMzMTI2OCwianRpIjoiNmI2NjI5NjUtOTU4MS00NTJkLTlhOGUtZWZiMTdmMTk0ZWEwIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiI3MTg3YjJlYS1hZjcxLTQxMDYtOTg4NS05MGE1OTRjNzVkYTkiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.omg8lBi8aYXNKFtyz-59LVSg2a2tCMxJ-pijDZk_PJuP3t0KLP9mK065sgr18j9RRLlhB5Gz2kgicFArxHtivEl0gUXu61vDMI1JwNX-iJP3IW1nOuz1niWS06XTsBAs3FLboN9JCzCrlyLSB7kFOSKNyr9gnqXqesWQU1H_s6k9aowpZ2V4aNEsojTx4jRXH2wCNB77m23zlaTQfbhQx_Hi4ZBiiOFCmRXadXaP0PC2LKecdNH4x8WAIIR9Jxwe-mzphLjj5_er637GhiPlR7lUQk9Yn4L72NWb6IEYvcz5_B5E73AFiU_xFR5kcOBPp-wTl_8-LRcBhxSaV9WLrA, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642331568, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.48.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=5B166E0863E464048E686CE9D6AA5B47, http-session-last-accessed-time=1642331272411, kc-category-name=ACCESS, kc-iat=1642331268, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:50286 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:07:52.422  INFO 16 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:07:52.423  INFO 16 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@58e629cd
2022-01-16 11:07:52.423  INFO 16 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@58e629cd
2022-01-16 11:07:52.435  INFO 16 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@58e629cd
2022-01-16 11:07:52.435  INFO 16 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@58e629cd
2022-01-16 11:07:52.443  INFO 16 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@58e629cd
2022-01-16 11:07:52.443  WARN 16 --- [https-jsse-nio-7071-exec-9] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:07:52.443  WARN 16 --- [https-jsse-nio-7071-exec-9] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:07:52.443  INFO 16 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@58e629cd
2022-01-16 11:07:52.443  INFO 16 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@58e629cd
2022-01-16 11:07:52.444  WARN 16 --- [https-jsse-nio-7071-exec-9] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:07:52.444  WARN 16 --- [https-jsse-nio-7071-exec-9] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:07:52.444  INFO 16 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@58e629cd
2022-01-16 11:07:52.497  INFO 16 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: emergency-active, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@58e629cd
2022-01-16 11:07:52.513  INFO 16 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@58e629cd
2022-01-16 11:07:52.513  INFO 16 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@58e629cd
2022-01-16 11:07:52.521  INFO 16 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@58e629cd
2022-01-16 11:07:52.521  INFO 16 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-revoke-extra, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@58e629cd
2022-01-16 11:07:52.570  INFO 16 --- [https-jsse-nio-7071-exec-9] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18909723523784929-620122, decision=PERMIT, pdp-result=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}})
2022-01-16 11:07:52.570  INFO 16 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=62ef7b88-ab84-4e39-8eaf-3b1e6824d9dc, content=PERMIT, timestamp=1642331272570, pdpResult=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}}))
2022-01-16 11:07:52.571  INFO 16 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=148ms, Total=151ms
2022-01-16 11:07:52.598  INFO 16 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=e673fbd2-038a-4481-9b82-549155a9569f, content=null, timestamp=1642331272594, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=50288, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=5fb2fe03fb5a, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=7187b2ea-af71-4106-9885-90a594c75da9, http-req-server-port=80, http-header-accept=*/*, kc-id=6b662965-9581-452d-9a8e-efb17f194ea0, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642331272592, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeP9sHNxAH4AEQAAAABh4/yEdAAkNmI2NjI5NjUtOTU4MS00NTJkLTlhOGUtZWZiMTdmMTk0ZWEwdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ3MTg3YjJlYS1hZjcxLTQxMDYtOTg4NS05MGE1OTRjNzVkYTlwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICI2cGUwZ2U1ck0zU2E2SUt5WXBsLTVkQTZrVXVleWo3X1psV2c1aDU4MmFvIn0.eyJleHAiOjE2NDIzMzE1NjgsImlhdCI6MTY0MjMzMTI2OCwianRpIjoiNmI2NjI5NjUtOTU4MS00NTJkLTlhOGUtZWZiMTdmMTk0ZWEwIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiI3MTg3YjJlYS1hZjcxLTQxMDYtOTg4NS05MGE1OTRjNzVkYTkiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.omg8lBi8aYXNKFtyz-59LVSg2a2tCMxJ-pijDZk_PJuP3t0KLP9mK065sgr18j9RRLlhB5Gz2kgicFArxHtivEl0gUXu61vDMI1JwNX-iJP3IW1nOuz1niWS06XTsBAs3FLboN9JCzCrlyLSB7kFOSKNyr9gnqXqesWQU1H_s6k9aowpZ2V4aNEsojTx4jRXH2wCNB77m23zlaTQfbhQx_Hi4ZBiiOFCmRXadXaP0PC2LKecdNH4x8WAIIR9Jxwe-mzphLjj5_er637GhiPlR7lUQk9Yn4L72NWb6IEYvcz5_B5E73AFiU_xFR5kcOBPp-wTl_8-LRcBhxSaV9WLrA, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642331568, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.48.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=4A67850118906441A5E71C7030EFCEE1, http-session-last-accessed-time=1642331272592, kc-category-name=ACCESS, kc-iat=1642331268, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:50288 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:07:52.598  INFO 16 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:07:52.599  INFO 16 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@79ecea9f
2022-01-16 11:07:52.599  INFO 16 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@79ecea9f
2022-01-16 11:07:52.610  INFO 16 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@79ecea9f
2022-01-16 11:07:52.610  INFO 16 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@79ecea9f
2022-01-16 11:07:52.619  INFO 16 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@79ecea9f
2022-01-16 11:07:52.619  WARN 16 --- [https-jsse-nio-7071-exec-10] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:07:52.620  WARN 16 --- [https-jsse-nio-7071-exec-10] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:07:52.620  INFO 16 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@79ecea9f
2022-01-16 11:07:52.620  INFO 16 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@79ecea9f
2022-01-16 11:07:52.620  WARN 16 --- [https-jsse-nio-7071-exec-10] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:07:52.620  WARN 16 --- [https-jsse-nio-7071-exec-10] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:07:52.621  INFO 16 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@79ecea9f
2022-01-16 11:07:52.669  INFO 16 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: emergency-active, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@79ecea9f
2022-01-16 11:07:52.680  INFO 16 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@79ecea9f
2022-01-16 11:07:52.681  INFO 16 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@79ecea9f
2022-01-16 11:07:52.691  INFO 16 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@79ecea9f
2022-01-16 11:07:52.691  INFO 16 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-revoke-extra, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@79ecea9f
2022-01-16 11:07:52.746  INFO 16 --- [https-jsse-nio-7071-exec-10] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18909723699777804-853910, decision=PERMIT, pdp-result=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}})
2022-01-16 11:07:52.747  INFO 16 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=e673fbd2-038a-4481-9b82-549155a9569f, content=PERMIT, timestamp=1642331272747, pdpResult=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}}))
2022-01-16 11:07:52.748  INFO 16 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=149ms, Total=151ms
2022-01-16 11:07:52.785  INFO 16 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=02857cfc-6c24-4af1-b4f8-f2d71884d2da, content=null, timestamp=1642331272775, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=50290, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=5fb2fe03fb5a, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=7187b2ea-af71-4106-9885-90a594c75da9, http-req-server-port=80, http-header-accept=*/*, kc-id=6b662965-9581-452d-9a8e-efb17f194ea0, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642331272773, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeP9sHNxAH4AEQAAAABh4/yEdAAkNmI2NjI5NjUtOTU4MS00NTJkLTlhOGUtZWZiMTdmMTk0ZWEwdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ3MTg3YjJlYS1hZjcxLTQxMDYtOTg4NS05MGE1OTRjNzVkYTlwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICI2cGUwZ2U1ck0zU2E2SUt5WXBsLTVkQTZrVXVleWo3X1psV2c1aDU4MmFvIn0.eyJleHAiOjE2NDIzMzE1NjgsImlhdCI6MTY0MjMzMTI2OCwianRpIjoiNmI2NjI5NjUtOTU4MS00NTJkLTlhOGUtZWZiMTdmMTk0ZWEwIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiI3MTg3YjJlYS1hZjcxLTQxMDYtOTg4NS05MGE1OTRjNzVkYTkiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.omg8lBi8aYXNKFtyz-59LVSg2a2tCMxJ-pijDZk_PJuP3t0KLP9mK065sgr18j9RRLlhB5Gz2kgicFArxHtivEl0gUXu61vDMI1JwNX-iJP3IW1nOuz1niWS06XTsBAs3FLboN9JCzCrlyLSB7kFOSKNyr9gnqXqesWQU1H_s6k9aowpZ2V4aNEsojTx4jRXH2wCNB77m23zlaTQfbhQx_Hi4ZBiiOFCmRXadXaP0PC2LKecdNH4x8WAIIR9Jxwe-mzphLjj5_er637GhiPlR7lUQk9Yn4L72NWb6IEYvcz5_B5E73AFiU_xFR5kcOBPp-wTl_8-LRcBhxSaV9WLrA, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642331568, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.48.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=9F6B677B15E04B652B659E04736203A9, http-session-last-accessed-time=1642331272773, kc-category-name=ACCESS, kc-iat=1642331268, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:50290 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:07:52.786  INFO 16 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:07:52.787  INFO 16 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1972708f
2022-01-16 11:07:52.787  INFO 16 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1972708f
2022-01-16 11:07:52.797  INFO 16 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1972708f
2022-01-16 11:07:52.798  INFO 16 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1972708f
2022-01-16 11:07:52.810  INFO 16 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1972708f
2022-01-16 11:07:52.811  WARN 16 --- [https-jsse-nio-7071-exec-1] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:07:52.811  WARN 16 --- [https-jsse-nio-7071-exec-1] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:07:52.811  INFO 16 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1972708f
2022-01-16 11:07:52.812  INFO 16 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1972708f
2022-01-16 11:07:52.812  WARN 16 --- [https-jsse-nio-7071-exec-1] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:07:52.813  WARN 16 --- [https-jsse-nio-7071-exec-1] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:07:52.813  INFO 16 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1972708f
2022-01-16 11:07:52.838  INFO 16 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: emergency-active, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1972708f
2022-01-16 11:07:52.893  INFO 16 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1972708f
2022-01-16 11:07:52.894  INFO 16 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1972708f
2022-01-16 11:07:52.905  INFO 16 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1972708f
2022-01-16 11:07:52.906  INFO 16 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-revoke-extra, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1972708f
2022-01-16 11:07:52.915  INFO 16 --- [https-jsse-nio-7071-exec-1] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18909723887290040-606686, decision=PERMIT, pdp-result=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}})
2022-01-16 11:07:52.915  INFO 16 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=02857cfc-6c24-4af1-b4f8-f2d71884d2da, content=PERMIT, timestamp=1642331272915, pdpResult=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}}))
2022-01-16 11:07:52.916  INFO 16 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=129ms, Total=137ms
2022-01-16 11:07:52.947  INFO 16 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=7fdd1a9a-740e-4cf7-b1b9-713b3d02071e, content=null, timestamp=1642331272940, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=50292, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=5fb2fe03fb5a, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=7187b2ea-af71-4106-9885-90a594c75da9, http-req-server-port=80, http-header-accept=*/*, kc-id=6b662965-9581-452d-9a8e-efb17f194ea0, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642331272938, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeP9sHNxAH4AEQAAAABh4/yEdAAkNmI2NjI5NjUtOTU4MS00NTJkLTlhOGUtZWZiMTdmMTk0ZWEwdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ3MTg3YjJlYS1hZjcxLTQxMDYtOTg4NS05MGE1OTRjNzVkYTlwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICI2cGUwZ2U1ck0zU2E2SUt5WXBsLTVkQTZrVXVleWo3X1psV2c1aDU4MmFvIn0.eyJleHAiOjE2NDIzMzE1NjgsImlhdCI6MTY0MjMzMTI2OCwianRpIjoiNmI2NjI5NjUtOTU4MS00NTJkLTlhOGUtZWZiMTdmMTk0ZWEwIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiI3MTg3YjJlYS1hZjcxLTQxMDYtOTg4NS05MGE1OTRjNzVkYTkiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.omg8lBi8aYXNKFtyz-59LVSg2a2tCMxJ-pijDZk_PJuP3t0KLP9mK065sgr18j9RRLlhB5Gz2kgicFArxHtivEl0gUXu61vDMI1JwNX-iJP3IW1nOuz1niWS06XTsBAs3FLboN9JCzCrlyLSB7kFOSKNyr9gnqXqesWQU1H_s6k9aowpZ2V4aNEsojTx4jRXH2wCNB77m23zlaTQfbhQx_Hi4ZBiiOFCmRXadXaP0PC2LKecdNH4x8WAIIR9Jxwe-mzphLjj5_er637GhiPlR7lUQk9Yn4L72NWb6IEYvcz5_B5E73AFiU_xFR5kcOBPp-wTl_8-LRcBhxSaV9WLrA, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642331568, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.48.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=707733720BA6678E5FD030B36D67A6EE, http-session-last-accessed-time=1642331272938, kc-category-name=ACCESS, kc-iat=1642331268, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:50292 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:07:52.949  INFO 16 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:07:52.950  INFO 16 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@218f5217
2022-01-16 11:07:52.950  INFO 16 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@218f5217
2022-01-16 11:07:53.006  INFO 16 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@218f5217
2022-01-16 11:07:53.007  INFO 16 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@218f5217
2022-01-16 11:07:53.019  INFO 16 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@218f5217
2022-01-16 11:07:53.020  WARN 16 --- [https-jsse-nio-7071-exec-2] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:07:53.020  WARN 16 --- [https-jsse-nio-7071-exec-2] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:07:53.020  INFO 16 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@218f5217
2022-01-16 11:07:53.020  INFO 16 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@218f5217
2022-01-16 11:07:53.020  WARN 16 --- [https-jsse-nio-7071-exec-2] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:07:53.020  WARN 16 --- [https-jsse-nio-7071-exec-2] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:07:53.020  INFO 16 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@218f5217
2022-01-16 11:07:53.032  INFO 16 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: emergency-active, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@218f5217
2022-01-16 11:07:53.086  INFO 16 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@218f5217
2022-01-16 11:07:53.086  INFO 16 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@218f5217
2022-01-16 11:07:53.096  INFO 16 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@218f5217
2022-01-16 11:07:53.097  INFO 16 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-revoke-extra, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@218f5217
2022-01-16 11:07:53.108  INFO 16 --- [https-jsse-nio-7071-exec-2] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18909724050278085-657298, decision=PERMIT, pdp-result=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}})
2022-01-16 11:07:53.108  INFO 16 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=7fdd1a9a-740e-4cf7-b1b9-713b3d02071e, content=PERMIT, timestamp=1642331273108, pdpResult=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}}))
2022-01-16 11:07:53.109  INFO 16 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=159ms, Total=164ms
2022-01-16 11:07:53.149  INFO 16 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=e06547f8-78bd-4f96-84f9-c630607767f4, content=null, timestamp=1642331273137, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=50294, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=5fb2fe03fb5a, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=7187b2ea-af71-4106-9885-90a594c75da9, http-req-server-port=80, http-header-accept=*/*, kc-id=6b662965-9581-452d-9a8e-efb17f194ea0, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642331273135, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeP9sHNxAH4AEQAAAABh4/yEdAAkNmI2NjI5NjUtOTU4MS00NTJkLTlhOGUtZWZiMTdmMTk0ZWEwdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ3MTg3YjJlYS1hZjcxLTQxMDYtOTg4NS05MGE1OTRjNzVkYTlwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICI2cGUwZ2U1ck0zU2E2SUt5WXBsLTVkQTZrVXVleWo3X1psV2c1aDU4MmFvIn0.eyJleHAiOjE2NDIzMzE1NjgsImlhdCI6MTY0MjMzMTI2OCwianRpIjoiNmI2NjI5NjUtOTU4MS00NTJkLTlhOGUtZWZiMTdmMTk0ZWEwIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiI3MTg3YjJlYS1hZjcxLTQxMDYtOTg4NS05MGE1OTRjNzVkYTkiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.omg8lBi8aYXNKFtyz-59LVSg2a2tCMxJ-pijDZk_PJuP3t0KLP9mK065sgr18j9RRLlhB5Gz2kgicFArxHtivEl0gUXu61vDMI1JwNX-iJP3IW1nOuz1niWS06XTsBAs3FLboN9JCzCrlyLSB7kFOSKNyr9gnqXqesWQU1H_s6k9aowpZ2V4aNEsojTx4jRXH2wCNB77m23zlaTQfbhQx_Hi4ZBiiOFCmRXadXaP0PC2LKecdNH4x8WAIIR9Jxwe-mzphLjj5_er637GhiPlR7lUQk9Yn4L72NWb6IEYvcz5_B5E73AFiU_xFR5kcOBPp-wTl_8-LRcBhxSaV9WLrA, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642331568, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.48.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=03BC94047338EB78398F5B7E0267AA31, http-session-last-accessed-time=1642331273135, kc-category-name=ACCESS, kc-iat=1642331268, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:50294 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:07:53.150  INFO 16 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:07:53.152  INFO 16 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3abeffb
2022-01-16 11:07:53.152  INFO 16 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3abeffb
2022-01-16 11:07:53.163  INFO 16 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3abeffb
2022-01-16 11:07:53.164  INFO 16 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3abeffb
2022-01-16 11:07:53.218  INFO 16 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3abeffb
2022-01-16 11:07:53.218  WARN 16 --- [https-jsse-nio-7071-exec-3] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:07:53.218  WARN 16 --- [https-jsse-nio-7071-exec-3] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:07:53.218  INFO 16 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3abeffb
2022-01-16 11:07:53.219  INFO 16 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3abeffb
2022-01-16 11:07:53.220  WARN 16 --- [https-jsse-nio-7071-exec-3] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:07:53.220  WARN 16 --- [https-jsse-nio-7071-exec-3] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:07:53.221  INFO 16 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3abeffb
2022-01-16 11:07:53.231  INFO 16 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: emergency-active, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3abeffb
2022-01-16 11:07:53.240  INFO 16 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3abeffb
2022-01-16 11:07:53.240  INFO 16 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3abeffb
2022-01-16 11:07:53.294  INFO 16 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3abeffb
2022-01-16 11:07:53.295  INFO 16 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-revoke-extra, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3abeffb
2022-01-16 11:07:53.309  INFO 16 --- [https-jsse-nio-7071-exec-3] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18909724252169445-804820, decision=PERMIT, pdp-result=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}})
2022-01-16 11:07:53.311  INFO 16 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=e06547f8-78bd-4f96-84f9-c630607767f4, content=PERMIT, timestamp=1642331273311, pdpResult=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}}))
2022-01-16 11:07:53.312  INFO 16 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=160ms, Total=165ms
2022-01-16 11:07:53.339  INFO 16 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=d80bc223-2ec1-4b0e-b910-dc5f1a1ab088, content=null, timestamp=1642331273331, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=50296, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=5fb2fe03fb5a, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=7187b2ea-af71-4106-9885-90a594c75da9, http-req-server-port=80, http-header-accept=*/*, kc-id=6b662965-9581-452d-9a8e-efb17f194ea0, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642331273330, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeP9sHNxAH4AEQAAAABh4/yEdAAkNmI2NjI5NjUtOTU4MS00NTJkLTlhOGUtZWZiMTdmMTk0ZWEwdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ3MTg3YjJlYS1hZjcxLTQxMDYtOTg4NS05MGE1OTRjNzVkYTlwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICI2cGUwZ2U1ck0zU2E2SUt5WXBsLTVkQTZrVXVleWo3X1psV2c1aDU4MmFvIn0.eyJleHAiOjE2NDIzMzE1NjgsImlhdCI6MTY0MjMzMTI2OCwianRpIjoiNmI2NjI5NjUtOTU4MS00NTJkLTlhOGUtZWZiMTdmMTk0ZWEwIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiI3MTg3YjJlYS1hZjcxLTQxMDYtOTg4NS05MGE1OTRjNzVkYTkiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.omg8lBi8aYXNKFtyz-59LVSg2a2tCMxJ-pijDZk_PJuP3t0KLP9mK065sgr18j9RRLlhB5Gz2kgicFArxHtivEl0gUXu61vDMI1JwNX-iJP3IW1nOuz1niWS06XTsBAs3FLboN9JCzCrlyLSB7kFOSKNyr9gnqXqesWQU1H_s6k9aowpZ2V4aNEsojTx4jRXH2wCNB77m23zlaTQfbhQx_Hi4ZBiiOFCmRXadXaP0PC2LKecdNH4x8WAIIR9Jxwe-mzphLjj5_er637GhiPlR7lUQk9Yn4L72NWb6IEYvcz5_B5E73AFiU_xFR5kcOBPp-wTl_8-LRcBhxSaV9WLrA, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642331568, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.48.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=6D6F63EBB6175154700F51476C940266, http-session-last-accessed-time=1642331273330, kc-category-name=ACCESS, kc-iat=1642331268, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:50296 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:07:53.340  INFO 16 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:07:53.341  INFO 16 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@73d31fbc
2022-01-16 11:07:53.341  INFO 16 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@73d31fbc
2022-01-16 11:07:53.353  INFO 16 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@73d31fbc
2022-01-16 11:07:53.354  INFO 16 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@73d31fbc
2022-01-16 11:07:53.406  INFO 16 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@73d31fbc
2022-01-16 11:07:53.406  WARN 16 --- [https-jsse-nio-7071-exec-4] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:07:53.407  WARN 16 --- [https-jsse-nio-7071-exec-4] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:07:53.407  INFO 16 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@73d31fbc
2022-01-16 11:07:53.407  INFO 16 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@73d31fbc
2022-01-16 11:07:53.407  WARN 16 --- [https-jsse-nio-7071-exec-4] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:07:53.417  WARN 16 --- [https-jsse-nio-7071-exec-4] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:07:53.418  INFO 16 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@73d31fbc
2022-01-16 11:07:53.432  INFO 16 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: emergency-active, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@73d31fbc
2022-01-16 11:07:53.441  INFO 16 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@73d31fbc
2022-01-16 11:07:53.441  INFO 16 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@73d31fbc
2022-01-16 11:07:53.493  INFO 16 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@73d31fbc
2022-01-16 11:07:53.494  INFO 16 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-revoke-extra, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@73d31fbc
2022-01-16 11:07:53.509  INFO 16 --- [https-jsse-nio-7071-exec-4] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18909724441684385-376224, decision=PERMIT, pdp-result=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}})
2022-01-16 11:07:53.510  INFO 16 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=d80bc223-2ec1-4b0e-b910-dc5f1a1ab088, content=PERMIT, timestamp=1642331273510, pdpResult=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}}))
2022-01-16 11:07:53.510  INFO 16 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=170ms, Total=172ms
2022-01-16 11:07:53.534  INFO 16 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=76347050-91c5-4f83-847f-6fc5e811df98, content=null, timestamp=1642331273529, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=50298, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=5fb2fe03fb5a, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=7187b2ea-af71-4106-9885-90a594c75da9, http-req-server-port=80, http-header-accept=*/*, kc-id=6b662965-9581-452d-9a8e-efb17f194ea0, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642331273527, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeP9sHNxAH4AEQAAAABh4/yEdAAkNmI2NjI5NjUtOTU4MS00NTJkLTlhOGUtZWZiMTdmMTk0ZWEwdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ3MTg3YjJlYS1hZjcxLTQxMDYtOTg4NS05MGE1OTRjNzVkYTlwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICI2cGUwZ2U1ck0zU2E2SUt5WXBsLTVkQTZrVXVleWo3X1psV2c1aDU4MmFvIn0.eyJleHAiOjE2NDIzMzE1NjgsImlhdCI6MTY0MjMzMTI2OCwianRpIjoiNmI2NjI5NjUtOTU4MS00NTJkLTlhOGUtZWZiMTdmMTk0ZWEwIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiI3MTg3YjJlYS1hZjcxLTQxMDYtOTg4NS05MGE1OTRjNzVkYTkiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.omg8lBi8aYXNKFtyz-59LVSg2a2tCMxJ-pijDZk_PJuP3t0KLP9mK065sgr18j9RRLlhB5Gz2kgicFArxHtivEl0gUXu61vDMI1JwNX-iJP3IW1nOuz1niWS06XTsBAs3FLboN9JCzCrlyLSB7kFOSKNyr9gnqXqesWQU1H_s6k9aowpZ2V4aNEsojTx4jRXH2wCNB77m23zlaTQfbhQx_Hi4ZBiiOFCmRXadXaP0PC2LKecdNH4x8WAIIR9Jxwe-mzphLjj5_er637GhiPlR7lUQk9Yn4L72NWb6IEYvcz5_B5E73AFiU_xFR5kcOBPp-wTl_8-LRcBhxSaV9WLrA, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642331568, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.48.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=9098D04E23E310BBAF16A1D5C3D1A5D3, http-session-last-accessed-time=1642331273527, kc-category-name=ACCESS, kc-iat=1642331268, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:50298 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:07:53.535  INFO 16 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:07:53.536  INFO 16 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@51c49359
2022-01-16 11:07:53.536  INFO 16 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@51c49359
2022-01-16 11:07:53.552  INFO 16 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@51c49359
2022-01-16 11:07:53.552  INFO 16 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@51c49359
2022-01-16 11:07:53.605  INFO 16 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@51c49359
2022-01-16 11:07:53.606  WARN 16 --- [https-jsse-nio-7071-exec-5] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:07:53.606  WARN 16 --- [https-jsse-nio-7071-exec-5] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:07:53.606  INFO 16 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@51c49359
2022-01-16 11:07:53.606  INFO 16 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@51c49359
2022-01-16 11:07:53.606  WARN 16 --- [https-jsse-nio-7071-exec-5] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:07:53.606  WARN 16 --- [https-jsse-nio-7071-exec-5] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:07:53.607  INFO 16 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@51c49359
2022-01-16 11:07:53.618  INFO 16 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: emergency-active, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@51c49359
2022-01-16 11:07:53.628  INFO 16 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@51c49359
2022-01-16 11:07:53.629  INFO 16 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@51c49359
2022-01-16 11:07:53.681  INFO 16 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@51c49359
2022-01-16 11:07:53.681  INFO 16 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-revoke-extra, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@51c49359
2022-01-16 11:07:53.697  INFO 16 --- [https-jsse-nio-7071-exec-5] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18909724636102162-30010, decision=PERMIT, pdp-result=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}})
2022-01-16 11:07:53.698  INFO 16 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=76347050-91c5-4f83-847f-6fc5e811df98, content=PERMIT, timestamp=1642331273698, pdpResult=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}}))
2022-01-16 11:07:53.699  INFO 16 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=163ms, Total=166ms
2022-01-16 11:07:53.725  INFO 16 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=dcfa2dbc-4ed7-47c1-b7ac-d2b64296b326, content=null, timestamp=1642331273720, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=50300, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=5fb2fe03fb5a, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=7187b2ea-af71-4106-9885-90a594c75da9, http-req-server-port=80, http-header-accept=*/*, kc-id=6b662965-9581-452d-9a8e-efb17f194ea0, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642331273718, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeP9sHNxAH4AEQAAAABh4/yEdAAkNmI2NjI5NjUtOTU4MS00NTJkLTlhOGUtZWZiMTdmMTk0ZWEwdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ3MTg3YjJlYS1hZjcxLTQxMDYtOTg4NS05MGE1OTRjNzVkYTlwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICI2cGUwZ2U1ck0zU2E2SUt5WXBsLTVkQTZrVXVleWo3X1psV2c1aDU4MmFvIn0.eyJleHAiOjE2NDIzMzE1NjgsImlhdCI6MTY0MjMzMTI2OCwianRpIjoiNmI2NjI5NjUtOTU4MS00NTJkLTlhOGUtZWZiMTdmMTk0ZWEwIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiI3MTg3YjJlYS1hZjcxLTQxMDYtOTg4NS05MGE1OTRjNzVkYTkiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.omg8lBi8aYXNKFtyz-59LVSg2a2tCMxJ-pijDZk_PJuP3t0KLP9mK065sgr18j9RRLlhB5Gz2kgicFArxHtivEl0gUXu61vDMI1JwNX-iJP3IW1nOuz1niWS06XTsBAs3FLboN9JCzCrlyLSB7kFOSKNyr9gnqXqesWQU1H_s6k9aowpZ2V4aNEsojTx4jRXH2wCNB77m23zlaTQfbhQx_Hi4ZBiiOFCmRXadXaP0PC2LKecdNH4x8WAIIR9Jxwe-mzphLjj5_er637GhiPlR7lUQk9Yn4L72NWb6IEYvcz5_B5E73AFiU_xFR5kcOBPp-wTl_8-LRcBhxSaV9WLrA, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642331568, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.48.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=732F241723E2BC2CC93AC821EED5A2FA, http-session-last-accessed-time=1642331273718, kc-category-name=ACCESS, kc-iat=1642331268, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:50300 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:07:53.726  INFO 16 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:07:53.727  INFO 16 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@69d057c8
2022-01-16 11:07:53.727  INFO 16 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@69d057c8
2022-01-16 11:07:53.741  INFO 16 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@69d057c8
2022-01-16 11:07:53.742  INFO 16 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@69d057c8
2022-01-16 11:07:53.793  INFO 16 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@69d057c8
2022-01-16 11:07:53.794  WARN 16 --- [https-jsse-nio-7071-exec-6] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:07:53.794  WARN 16 --- [https-jsse-nio-7071-exec-6] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:07:53.794  INFO 16 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@69d057c8
2022-01-16 11:07:53.795  INFO 16 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@69d057c8
2022-01-16 11:07:53.796  WARN 16 --- [https-jsse-nio-7071-exec-6] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:07:53.796  WARN 16 --- [https-jsse-nio-7071-exec-6] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:07:53.796  INFO 16 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@69d057c8
2022-01-16 11:07:53.808  INFO 16 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: emergency-active, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@69d057c8
2022-01-16 11:07:53.820  INFO 16 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@69d057c8
2022-01-16 11:07:53.821  INFO 16 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@69d057c8
2022-01-16 11:07:53.874  INFO 16 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@69d057c8
2022-01-16 11:07:53.874  INFO 16 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-revoke-extra, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@69d057c8
2022-01-16 11:07:53.889  INFO 16 --- [https-jsse-nio-7071-exec-6] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18909724827320764-949603, decision=PERMIT, pdp-result=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}})
2022-01-16 11:07:53.890  INFO 16 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=dcfa2dbc-4ed7-47c1-b7ac-d2b64296b326, content=PERMIT, timestamp=1642331273890, pdpResult=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}}))
2022-01-16 11:07:53.891  INFO 16 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=164ms, Total=167ms
2022-01-16 11:07:53.917  INFO 16 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=7274d0a4-333f-4232-aa6d-f3f35e97557c, content=null, timestamp=1642331273911, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=50302, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=5fb2fe03fb5a, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=7187b2ea-af71-4106-9885-90a594c75da9, http-req-server-port=80, http-header-accept=*/*, kc-id=6b662965-9581-452d-9a8e-efb17f194ea0, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642331273910, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeP9sHNxAH4AEQAAAABh4/yEdAAkNmI2NjI5NjUtOTU4MS00NTJkLTlhOGUtZWZiMTdmMTk0ZWEwdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ3MTg3YjJlYS1hZjcxLTQxMDYtOTg4NS05MGE1OTRjNzVkYTlwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICI2cGUwZ2U1ck0zU2E2SUt5WXBsLTVkQTZrVXVleWo3X1psV2c1aDU4MmFvIn0.eyJleHAiOjE2NDIzMzE1NjgsImlhdCI6MTY0MjMzMTI2OCwianRpIjoiNmI2NjI5NjUtOTU4MS00NTJkLTlhOGUtZWZiMTdmMTk0ZWEwIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiI3MTg3YjJlYS1hZjcxLTQxMDYtOTg4NS05MGE1OTRjNzVkYTkiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.omg8lBi8aYXNKFtyz-59LVSg2a2tCMxJ-pijDZk_PJuP3t0KLP9mK065sgr18j9RRLlhB5Gz2kgicFArxHtivEl0gUXu61vDMI1JwNX-iJP3IW1nOuz1niWS06XTsBAs3FLboN9JCzCrlyLSB7kFOSKNyr9gnqXqesWQU1H_s6k9aowpZ2V4aNEsojTx4jRXH2wCNB77m23zlaTQfbhQx_Hi4ZBiiOFCmRXadXaP0PC2LKecdNH4x8WAIIR9Jxwe-mzphLjj5_er637GhiPlR7lUQk9Yn4L72NWb6IEYvcz5_B5E73AFiU_xFR5kcOBPp-wTl_8-LRcBhxSaV9WLrA, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642331568, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.48.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=9400B3EFC028EB0A44CC9EF8AE41ACA0, http-session-last-accessed-time=1642331273910, kc-category-name=ACCESS, kc-iat=1642331268, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:50302 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:07:53.918  INFO 16 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:07:53.919  INFO 16 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7a43ceac
2022-01-16 11:07:53.919  INFO 16 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7a43ceac
2022-01-16 11:07:53.932  INFO 16 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7a43ceac
2022-01-16 11:07:53.933  INFO 16 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7a43ceac
2022-01-16 11:07:53.986  INFO 16 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7a43ceac
2022-01-16 11:07:53.986  WARN 16 --- [https-jsse-nio-7071-exec-7] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:07:53.986  WARN 16 --- [https-jsse-nio-7071-exec-7] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:07:53.986  INFO 16 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7a43ceac
2022-01-16 11:07:53.987  INFO 16 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7a43ceac
2022-01-16 11:07:53.988  WARN 16 --- [https-jsse-nio-7071-exec-7] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:07:53.988  WARN 16 --- [https-jsse-nio-7071-exec-7] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:07:53.989  INFO 16 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7a43ceac
2022-01-16 11:07:54.001  INFO 16 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: emergency-active, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7a43ceac
2022-01-16 11:07:54.010  INFO 16 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7a43ceac
2022-01-16 11:07:54.011  INFO 16 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7a43ceac
2022-01-16 11:07:54.061  INFO 16 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7a43ceac
2022-01-16 11:07:54.061  INFO 16 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-revoke-extra, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7a43ceac
2022-01-16 11:07:54.078  INFO 16 --- [https-jsse-nio-7071-exec-7] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18909725019243683-774295, decision=PERMIT, pdp-result=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}})
2022-01-16 11:07:54.079  INFO 16 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=7274d0a4-333f-4232-aa6d-f3f35e97557c, content=PERMIT, timestamp=1642331274079, pdpResult=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}}))
2022-01-16 11:07:54.081  INFO 16 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=161ms, Total=165ms
2022-01-16 11:07:54.123  INFO 16 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=d38f1434-b661-4075-8504-a9b603b733ce, content=null, timestamp=1642331274100, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=50304, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=5fb2fe03fb5a, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=7187b2ea-af71-4106-9885-90a594c75da9, http-req-server-port=80, http-header-accept=*/*, kc-id=6b662965-9581-452d-9a8e-efb17f194ea0, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642331274099, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeP9sHNxAH4AEQAAAABh4/yEdAAkNmI2NjI5NjUtOTU4MS00NTJkLTlhOGUtZWZiMTdmMTk0ZWEwdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ3MTg3YjJlYS1hZjcxLTQxMDYtOTg4NS05MGE1OTRjNzVkYTlwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICI2cGUwZ2U1ck0zU2E2SUt5WXBsLTVkQTZrVXVleWo3X1psV2c1aDU4MmFvIn0.eyJleHAiOjE2NDIzMzE1NjgsImlhdCI6MTY0MjMzMTI2OCwianRpIjoiNmI2NjI5NjUtOTU4MS00NTJkLTlhOGUtZWZiMTdmMTk0ZWEwIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiI3MTg3YjJlYS1hZjcxLTQxMDYtOTg4NS05MGE1OTRjNzVkYTkiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.omg8lBi8aYXNKFtyz-59LVSg2a2tCMxJ-pijDZk_PJuP3t0KLP9mK065sgr18j9RRLlhB5Gz2kgicFArxHtivEl0gUXu61vDMI1JwNX-iJP3IW1nOuz1niWS06XTsBAs3FLboN9JCzCrlyLSB7kFOSKNyr9gnqXqesWQU1H_s6k9aowpZ2V4aNEsojTx4jRXH2wCNB77m23zlaTQfbhQx_Hi4ZBiiOFCmRXadXaP0PC2LKecdNH4x8WAIIR9Jxwe-mzphLjj5_er637GhiPlR7lUQk9Yn4L72NWb6IEYvcz5_B5E73AFiU_xFR5kcOBPp-wTl_8-LRcBhxSaV9WLrA, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642331568, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.48.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=9657B06F756E63BCD754499C1DA3339D, http-session-last-accessed-time=1642331274099, kc-category-name=ACCESS, kc-iat=1642331268, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:50304 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:07:54.124  INFO 16 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:07:54.124  INFO 16 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@549ecc94
2022-01-16 11:07:54.125  INFO 16 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@549ecc94
2022-01-16 11:07:54.135  INFO 16 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@549ecc94
2022-01-16 11:07:54.135  INFO 16 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@549ecc94
2022-01-16 11:07:54.143  INFO 16 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@549ecc94
2022-01-16 11:07:54.143  WARN 16 --- [https-jsse-nio-7071-exec-8] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:07:54.143  WARN 16 --- [https-jsse-nio-7071-exec-8] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:07:54.143  INFO 16 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@549ecc94
2022-01-16 11:07:54.144  INFO 16 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@549ecc94
2022-01-16 11:07:54.144  WARN 16 --- [https-jsse-nio-7071-exec-8] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:07:54.144  WARN 16 --- [https-jsse-nio-7071-exec-8] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:07:54.144  INFO 16 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@549ecc94
2022-01-16 11:07:54.193  INFO 16 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: emergency-active, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@549ecc94
2022-01-16 11:07:54.201  INFO 16 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@549ecc94
2022-01-16 11:07:54.202  INFO 16 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@549ecc94
2022-01-16 11:07:54.209  INFO 16 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@549ecc94
2022-01-16 11:07:54.209  INFO 16 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-revoke-extra, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@549ecc94
2022-01-16 11:07:54.257  INFO 16 --- [https-jsse-nio-7071-exec-8] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18909725225177014-438422, decision=PERMIT, pdp-result=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}})
2022-01-16 11:07:54.258  INFO 16 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=d38f1434-b661-4075-8504-a9b603b733ce, content=PERMIT, timestamp=1642331274258, pdpResult=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}}))
2022-01-16 11:07:54.258  INFO 16 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=134ms, Total=136ms
2022-01-16 11:07:54.281  INFO 16 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=8acf4100-bec7-4274-a36a-e10275b4c1f5, content=null, timestamp=1642331274275, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=50306, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=5fb2fe03fb5a, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=7187b2ea-af71-4106-9885-90a594c75da9, http-req-server-port=80, http-header-accept=*/*, kc-id=6b662965-9581-452d-9a8e-efb17f194ea0, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642331274273, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeP9sHNxAH4AEQAAAABh4/yEdAAkNmI2NjI5NjUtOTU4MS00NTJkLTlhOGUtZWZiMTdmMTk0ZWEwdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ3MTg3YjJlYS1hZjcxLTQxMDYtOTg4NS05MGE1OTRjNzVkYTlwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICI2cGUwZ2U1ck0zU2E2SUt5WXBsLTVkQTZrVXVleWo3X1psV2c1aDU4MmFvIn0.eyJleHAiOjE2NDIzMzE1NjgsImlhdCI6MTY0MjMzMTI2OCwianRpIjoiNmI2NjI5NjUtOTU4MS00NTJkLTlhOGUtZWZiMTdmMTk0ZWEwIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiI3MTg3YjJlYS1hZjcxLTQxMDYtOTg4NS05MGE1OTRjNzVkYTkiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.omg8lBi8aYXNKFtyz-59LVSg2a2tCMxJ-pijDZk_PJuP3t0KLP9mK065sgr18j9RRLlhB5Gz2kgicFArxHtivEl0gUXu61vDMI1JwNX-iJP3IW1nOuz1niWS06XTsBAs3FLboN9JCzCrlyLSB7kFOSKNyr9gnqXqesWQU1H_s6k9aowpZ2V4aNEsojTx4jRXH2wCNB77m23zlaTQfbhQx_Hi4ZBiiOFCmRXadXaP0PC2LKecdNH4x8WAIIR9Jxwe-mzphLjj5_er637GhiPlR7lUQk9Yn4L72NWb6IEYvcz5_B5E73AFiU_xFR5kcOBPp-wTl_8-LRcBhxSaV9WLrA, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642331568, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.48.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=5D11C137748EF7523E60E77ED9955608, http-session-last-accessed-time=1642331274273, kc-category-name=ACCESS, kc-iat=1642331268, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:50306 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:07:54.282  INFO 16 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:07:54.283  INFO 16 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6bde8d4b
2022-01-16 11:07:54.283  INFO 16 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6bde8d4b
2022-01-16 11:07:54.293  INFO 16 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6bde8d4b
2022-01-16 11:07:54.293  INFO 16 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6bde8d4b
2022-01-16 11:07:54.301  INFO 16 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6bde8d4b
2022-01-16 11:07:54.301  WARN 16 --- [https-jsse-nio-7071-exec-9] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:07:54.302  WARN 16 --- [https-jsse-nio-7071-exec-9] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:07:54.302  INFO 16 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6bde8d4b
2022-01-16 11:07:54.303  INFO 16 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6bde8d4b
2022-01-16 11:07:54.303  WARN 16 --- [https-jsse-nio-7071-exec-9] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:07:54.303  WARN 16 --- [https-jsse-nio-7071-exec-9] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:07:54.303  INFO 16 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6bde8d4b
2022-01-16 11:07:54.353  INFO 16 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: emergency-active, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6bde8d4b
2022-01-16 11:07:54.373  INFO 16 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6bde8d4b
2022-01-16 11:07:54.374  INFO 16 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6bde8d4b
2022-01-16 11:07:54.391  INFO 16 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6bde8d4b
2022-01-16 11:07:54.391  INFO 16 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-revoke-extra, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6bde8d4b
2022-01-16 11:07:54.447  INFO 16 --- [https-jsse-nio-7071-exec-9] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18909725383222173-829749, decision=PERMIT, pdp-result=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}})
2022-01-16 11:07:54.448  INFO 16 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=8acf4100-bec7-4274-a36a-e10275b4c1f5, content=PERMIT, timestamp=1642331274448, pdpResult=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}}))
2022-01-16 11:07:54.450  INFO 16 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=166ms, Total=170ms
2022-01-16 11:07:54.476  INFO 16 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=437f448e-de82-48cb-a0c8-41ebce863466, content=null, timestamp=1642331274470, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=50308, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=5fb2fe03fb5a, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=7187b2ea-af71-4106-9885-90a594c75da9, http-req-server-port=80, http-header-accept=*/*, kc-id=6b662965-9581-452d-9a8e-efb17f194ea0, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642331274468, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeP9sHNxAH4AEQAAAABh4/yEdAAkNmI2NjI5NjUtOTU4MS00NTJkLTlhOGUtZWZiMTdmMTk0ZWEwdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ3MTg3YjJlYS1hZjcxLTQxMDYtOTg4NS05MGE1OTRjNzVkYTlwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICI2cGUwZ2U1ck0zU2E2SUt5WXBsLTVkQTZrVXVleWo3X1psV2c1aDU4MmFvIn0.eyJleHAiOjE2NDIzMzE1NjgsImlhdCI6MTY0MjMzMTI2OCwianRpIjoiNmI2NjI5NjUtOTU4MS00NTJkLTlhOGUtZWZiMTdmMTk0ZWEwIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiI3MTg3YjJlYS1hZjcxLTQxMDYtOTg4NS05MGE1OTRjNzVkYTkiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.omg8lBi8aYXNKFtyz-59LVSg2a2tCMxJ-pijDZk_PJuP3t0KLP9mK065sgr18j9RRLlhB5Gz2kgicFArxHtivEl0gUXu61vDMI1JwNX-iJP3IW1nOuz1niWS06XTsBAs3FLboN9JCzCrlyLSB7kFOSKNyr9gnqXqesWQU1H_s6k9aowpZ2V4aNEsojTx4jRXH2wCNB77m23zlaTQfbhQx_Hi4ZBiiOFCmRXadXaP0PC2LKecdNH4x8WAIIR9Jxwe-mzphLjj5_er637GhiPlR7lUQk9Yn4L72NWb6IEYvcz5_B5E73AFiU_xFR5kcOBPp-wTl_8-LRcBhxSaV9WLrA, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642331568, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.48.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=BDD066B43E51540288DAA673CFD780EF, http-session-last-accessed-time=1642331274468, kc-category-name=ACCESS, kc-iat=1642331268, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:50308 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:07:54.478  INFO 16 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:07:54.479  INFO 16 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@647319cf
2022-01-16 11:07:54.479  INFO 16 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@647319cf
2022-01-16 11:07:54.489  INFO 16 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@647319cf
2022-01-16 11:07:54.489  INFO 16 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@647319cf
2022-01-16 11:07:54.498  INFO 16 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@647319cf
2022-01-16 11:07:54.498  WARN 16 --- [https-jsse-nio-7071-exec-10] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:07:54.498  WARN 16 --- [https-jsse-nio-7071-exec-10] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:07:54.498  INFO 16 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@647319cf
2022-01-16 11:07:54.499  INFO 16 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@647319cf
2022-01-16 11:07:54.499  WARN 16 --- [https-jsse-nio-7071-exec-10] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:07:54.499  WARN 16 --- [https-jsse-nio-7071-exec-10] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:07:54.499  INFO 16 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@647319cf
2022-01-16 11:07:54.549  INFO 16 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: emergency-active, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@647319cf
2022-01-16 11:07:54.559  INFO 16 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@647319cf
2022-01-16 11:07:54.559  INFO 16 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@647319cf
2022-01-16 11:07:54.570  INFO 16 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@647319cf
2022-01-16 11:07:54.570  INFO 16 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-revoke-extra, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@647319cf
2022-01-16 11:07:54.622  INFO 16 --- [https-jsse-nio-7071-exec-10] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18909725579194029-527894, decision=PERMIT, pdp-result=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}})
2022-01-16 11:07:54.622  INFO 16 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=437f448e-de82-48cb-a0c8-41ebce863466, content=PERMIT, timestamp=1642331274622, pdpResult=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}}))
2022-01-16 11:07:54.623  INFO 16 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=144ms, Total=149ms
2022-01-16 11:07:54.646  INFO 16 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=0b6640be-449b-4fda-881c-de0e79f04c3f, content=null, timestamp=1642331274641, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=50310, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=5fb2fe03fb5a, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=7187b2ea-af71-4106-9885-90a594c75da9, http-req-server-port=80, http-header-accept=*/*, kc-id=6b662965-9581-452d-9a8e-efb17f194ea0, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642331274639, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeP9sHNxAH4AEQAAAABh4/yEdAAkNmI2NjI5NjUtOTU4MS00NTJkLTlhOGUtZWZiMTdmMTk0ZWEwdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ3MTg3YjJlYS1hZjcxLTQxMDYtOTg4NS05MGE1OTRjNzVkYTlwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICI2cGUwZ2U1ck0zU2E2SUt5WXBsLTVkQTZrVXVleWo3X1psV2c1aDU4MmFvIn0.eyJleHAiOjE2NDIzMzE1NjgsImlhdCI6MTY0MjMzMTI2OCwianRpIjoiNmI2NjI5NjUtOTU4MS00NTJkLTlhOGUtZWZiMTdmMTk0ZWEwIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiI3MTg3YjJlYS1hZjcxLTQxMDYtOTg4NS05MGE1OTRjNzVkYTkiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.omg8lBi8aYXNKFtyz-59LVSg2a2tCMxJ-pijDZk_PJuP3t0KLP9mK065sgr18j9RRLlhB5Gz2kgicFArxHtivEl0gUXu61vDMI1JwNX-iJP3IW1nOuz1niWS06XTsBAs3FLboN9JCzCrlyLSB7kFOSKNyr9gnqXqesWQU1H_s6k9aowpZ2V4aNEsojTx4jRXH2wCNB77m23zlaTQfbhQx_Hi4ZBiiOFCmRXadXaP0PC2LKecdNH4x8WAIIR9Jxwe-mzphLjj5_er637GhiPlR7lUQk9Yn4L72NWb6IEYvcz5_B5E73AFiU_xFR5kcOBPp-wTl_8-LRcBhxSaV9WLrA, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642331568, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.48.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=A779FDD71C66BBCFD95DD380E7107A47, http-session-last-accessed-time=1642331274639, kc-category-name=ACCESS, kc-iat=1642331268, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:50310 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:07:54.647  INFO 16 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:07:54.649  INFO 16 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@524ec611
2022-01-16 11:07:54.649  INFO 16 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@524ec611
2022-01-16 11:07:54.663  INFO 16 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@524ec611
2022-01-16 11:07:54.663  INFO 16 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@524ec611
2022-01-16 11:07:54.674  INFO 16 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@524ec611
2022-01-16 11:07:54.674  WARN 16 --- [https-jsse-nio-7071-exec-1] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:07:54.675  WARN 16 --- [https-jsse-nio-7071-exec-1] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:07:54.675  INFO 16 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@524ec611
2022-01-16 11:07:54.675  INFO 16 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@524ec611
2022-01-16 11:07:54.675  WARN 16 --- [https-jsse-nio-7071-exec-1] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:07:54.675  WARN 16 --- [https-jsse-nio-7071-exec-1] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:07:54.675  INFO 16 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@524ec611
2022-01-16 11:07:54.729  INFO 16 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: emergency-active, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@524ec611
2022-01-16 11:07:54.739  INFO 16 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@524ec611
2022-01-16 11:07:54.739  INFO 16 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@524ec611
2022-01-16 11:07:54.748  INFO 16 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@524ec611
2022-01-16 11:07:54.748  INFO 16 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-revoke-extra, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@524ec611
2022-01-16 11:07:54.802  INFO 16 --- [https-jsse-nio-7071-exec-1] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18909725748574214-486673, decision=PERMIT, pdp-result=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}})
2022-01-16 11:07:54.803  INFO 16 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=0b6640be-449b-4fda-881c-de0e79f04c3f, content=PERMIT, timestamp=1642331274803, pdpResult=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}}))
2022-01-16 11:07:54.803  INFO 16 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=156ms, Total=158ms
2022-01-16 11:07:54.826  INFO 16 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=baed9648-a5f4-4c18-8347-2f3c5b499ccb, content=null, timestamp=1642331274821, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=50312, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=5fb2fe03fb5a, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=7187b2ea-af71-4106-9885-90a594c75da9, http-req-server-port=80, http-header-accept=*/*, kc-id=6b662965-9581-452d-9a8e-efb17f194ea0, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642331274820, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeP9sHNxAH4AEQAAAABh4/yEdAAkNmI2NjI5NjUtOTU4MS00NTJkLTlhOGUtZWZiMTdmMTk0ZWEwdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ3MTg3YjJlYS1hZjcxLTQxMDYtOTg4NS05MGE1OTRjNzVkYTlwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICI2cGUwZ2U1ck0zU2E2SUt5WXBsLTVkQTZrVXVleWo3X1psV2c1aDU4MmFvIn0.eyJleHAiOjE2NDIzMzE1NjgsImlhdCI6MTY0MjMzMTI2OCwianRpIjoiNmI2NjI5NjUtOTU4MS00NTJkLTlhOGUtZWZiMTdmMTk0ZWEwIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiI3MTg3YjJlYS1hZjcxLTQxMDYtOTg4NS05MGE1OTRjNzVkYTkiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.omg8lBi8aYXNKFtyz-59LVSg2a2tCMxJ-pijDZk_PJuP3t0KLP9mK065sgr18j9RRLlhB5Gz2kgicFArxHtivEl0gUXu61vDMI1JwNX-iJP3IW1nOuz1niWS06XTsBAs3FLboN9JCzCrlyLSB7kFOSKNyr9gnqXqesWQU1H_s6k9aowpZ2V4aNEsojTx4jRXH2wCNB77m23zlaTQfbhQx_Hi4ZBiiOFCmRXadXaP0PC2LKecdNH4x8WAIIR9Jxwe-mzphLjj5_er637GhiPlR7lUQk9Yn4L72NWb6IEYvcz5_B5E73AFiU_xFR5kcOBPp-wTl_8-LRcBhxSaV9WLrA, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642331568, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.48.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=D956AE5C20604B242763CB2ED8DE97AE, http-session-last-accessed-time=1642331274820, kc-category-name=ACCESS, kc-iat=1642331268, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:50312 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:07:54.826  INFO 16 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:07:54.827  INFO 16 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@20d4e02e
2022-01-16 11:07:54.827  INFO 16 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@20d4e02e
2022-01-16 11:07:54.858  INFO 16 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@20d4e02e
2022-01-16 11:07:54.858  INFO 16 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@20d4e02e
2022-01-16 11:07:54.870  INFO 16 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@20d4e02e
2022-01-16 11:07:54.870  WARN 16 --- [https-jsse-nio-7071-exec-2] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:07:54.870  WARN 16 --- [https-jsse-nio-7071-exec-2] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:07:54.870  INFO 16 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@20d4e02e
2022-01-16 11:07:54.870  INFO 16 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@20d4e02e
2022-01-16 11:07:54.870  WARN 16 --- [https-jsse-nio-7071-exec-2] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:07:54.870  WARN 16 --- [https-jsse-nio-7071-exec-2] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:07:54.870  INFO 16 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@20d4e02e
2022-01-16 11:07:54.925  INFO 16 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: emergency-active, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@20d4e02e
2022-01-16 11:07:54.942  INFO 16 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@20d4e02e
2022-01-16 11:07:54.942  INFO 16 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@20d4e02e
2022-01-16 11:07:54.954  INFO 16 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@20d4e02e
2022-01-16 11:07:54.955  INFO 16 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-revoke-extra, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@20d4e02e
2022-01-16 11:07:55.014  INFO 16 --- [https-jsse-nio-7071-exec-2] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18909725927722196-568025, decision=PERMIT, pdp-result=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}})
2022-01-16 11:07:55.014  INFO 16 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=baed9648-a5f4-4c18-8347-2f3c5b499ccb, content=PERMIT, timestamp=1642331275014, pdpResult=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}}))
2022-01-16 11:07:55.014  INFO 16 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=188ms, Total=189ms
2022-01-16 11:07:55.048  INFO 16 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=b093c633-581c-4eb8-955f-7a61d6c7d362, content=null, timestamp=1642331275040, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=50314, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=5fb2fe03fb5a, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=7187b2ea-af71-4106-9885-90a594c75da9, http-req-server-port=80, http-header-accept=*/*, kc-id=6b662965-9581-452d-9a8e-efb17f194ea0, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642331275037, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeP9sHNxAH4AEQAAAABh4/yEdAAkNmI2NjI5NjUtOTU4MS00NTJkLTlhOGUtZWZiMTdmMTk0ZWEwdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ3MTg3YjJlYS1hZjcxLTQxMDYtOTg4NS05MGE1OTRjNzVkYTlwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICI2cGUwZ2U1ck0zU2E2SUt5WXBsLTVkQTZrVXVleWo3X1psV2c1aDU4MmFvIn0.eyJleHAiOjE2NDIzMzE1NjgsImlhdCI6MTY0MjMzMTI2OCwianRpIjoiNmI2NjI5NjUtOTU4MS00NTJkLTlhOGUtZWZiMTdmMTk0ZWEwIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiI3MTg3YjJlYS1hZjcxLTQxMDYtOTg4NS05MGE1OTRjNzVkYTkiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.omg8lBi8aYXNKFtyz-59LVSg2a2tCMxJ-pijDZk_PJuP3t0KLP9mK065sgr18j9RRLlhB5Gz2kgicFArxHtivEl0gUXu61vDMI1JwNX-iJP3IW1nOuz1niWS06XTsBAs3FLboN9JCzCrlyLSB7kFOSKNyr9gnqXqesWQU1H_s6k9aowpZ2V4aNEsojTx4jRXH2wCNB77m23zlaTQfbhQx_Hi4ZBiiOFCmRXadXaP0PC2LKecdNH4x8WAIIR9Jxwe-mzphLjj5_er637GhiPlR7lUQk9Yn4L72NWb6IEYvcz5_B5E73AFiU_xFR5kcOBPp-wTl_8-LRcBhxSaV9WLrA, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642331568, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.48.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=57326100DC202665190F37E8E2E670A4, http-session-last-accessed-time=1642331275037, kc-category-name=ACCESS, kc-iat=1642331268, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:50314 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:07:55.049  INFO 16 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:07:55.050  INFO 16 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3831cccf
2022-01-16 11:07:55.051  INFO 16 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3831cccf
2022-01-16 11:07:55.063  INFO 16 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3831cccf
2022-01-16 11:07:55.063  INFO 16 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3831cccf
2022-01-16 11:07:55.073  INFO 16 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3831cccf
2022-01-16 11:07:55.074  WARN 16 --- [https-jsse-nio-7071-exec-3] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:07:55.074  WARN 16 --- [https-jsse-nio-7071-exec-3] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:07:55.075  INFO 16 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3831cccf
2022-01-16 11:07:55.075  INFO 16 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3831cccf
2022-01-16 11:07:55.076  WARN 16 --- [https-jsse-nio-7071-exec-3] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:07:55.076  WARN 16 --- [https-jsse-nio-7071-exec-3] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:07:55.077  INFO 16 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3831cccf
2022-01-16 11:07:55.129  INFO 16 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: emergency-active, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3831cccf
2022-01-16 11:07:55.150  INFO 16 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3831cccf
2022-01-16 11:07:55.151  INFO 16 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3831cccf
2022-01-16 11:07:55.164  INFO 16 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3831cccf
2022-01-16 11:07:55.165  INFO 16 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-revoke-extra, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3831cccf
2022-01-16 11:07:55.227  INFO 16 --- [https-jsse-nio-7071-exec-3] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18909726150704436-304663, decision=PERMIT, pdp-result=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}})
2022-01-16 11:07:55.229  INFO 16 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=b093c633-581c-4eb8-955f-7a61d6c7d362, content=PERMIT, timestamp=1642331275228, pdpResult=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}}))
2022-01-16 11:07:55.231  INFO 16 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=179ms, Total=184ms
2022-01-16 11:07:55.269  INFO 16 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=2ebb73fd-608f-46d1-977f-c06e60f933ae, content=null, timestamp=1642331275263, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=50316, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=5fb2fe03fb5a, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=7187b2ea-af71-4106-9885-90a594c75da9, http-req-server-port=80, http-header-accept=*/*, kc-id=6b662965-9581-452d-9a8e-efb17f194ea0, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642331275258, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeP9sHNxAH4AEQAAAABh4/yEdAAkNmI2NjI5NjUtOTU4MS00NTJkLTlhOGUtZWZiMTdmMTk0ZWEwdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ3MTg3YjJlYS1hZjcxLTQxMDYtOTg4NS05MGE1OTRjNzVkYTlwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICI2cGUwZ2U1ck0zU2E2SUt5WXBsLTVkQTZrVXVleWo3X1psV2c1aDU4MmFvIn0.eyJleHAiOjE2NDIzMzE1NjgsImlhdCI6MTY0MjMzMTI2OCwianRpIjoiNmI2NjI5NjUtOTU4MS00NTJkLTlhOGUtZWZiMTdmMTk0ZWEwIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiI3MTg3YjJlYS1hZjcxLTQxMDYtOTg4NS05MGE1OTRjNzVkYTkiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.omg8lBi8aYXNKFtyz-59LVSg2a2tCMxJ-pijDZk_PJuP3t0KLP9mK065sgr18j9RRLlhB5Gz2kgicFArxHtivEl0gUXu61vDMI1JwNX-iJP3IW1nOuz1niWS06XTsBAs3FLboN9JCzCrlyLSB7kFOSKNyr9gnqXqesWQU1H_s6k9aowpZ2V4aNEsojTx4jRXH2wCNB77m23zlaTQfbhQx_Hi4ZBiiOFCmRXadXaP0PC2LKecdNH4x8WAIIR9Jxwe-mzphLjj5_er637GhiPlR7lUQk9Yn4L72NWb6IEYvcz5_B5E73AFiU_xFR5kcOBPp-wTl_8-LRcBhxSaV9WLrA, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642331568, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.48.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=EDCA847AA64ECC6CF85145449DE0DEA5, http-session-last-accessed-time=1642331275258, kc-category-name=ACCESS, kc-iat=1642331268, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:50316 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:07:55.271  INFO 16 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:07:55.273  INFO 16 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3b7c16d1
2022-01-16 11:07:55.273  INFO 16 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3b7c16d1
2022-01-16 11:07:55.287  INFO 16 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3b7c16d1
2022-01-16 11:07:55.288  INFO 16 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3b7c16d1
2022-01-16 11:07:55.344  INFO 16 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3b7c16d1
2022-01-16 11:07:55.345  WARN 16 --- [https-jsse-nio-7071-exec-4] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:07:55.346  WARN 16 --- [https-jsse-nio-7071-exec-4] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:07:55.346  INFO 16 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3b7c16d1
2022-01-16 11:07:55.347  INFO 16 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3b7c16d1
2022-01-16 11:07:55.347  WARN 16 --- [https-jsse-nio-7071-exec-4] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:07:55.348  WARN 16 --- [https-jsse-nio-7071-exec-4] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:07:55.348  INFO 16 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3b7c16d1
2022-01-16 11:07:55.405  INFO 16 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: emergency-active, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3b7c16d1
2022-01-16 11:07:55.423  INFO 16 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3b7c16d1
2022-01-16 11:07:55.424  INFO 16 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3b7c16d1
2022-01-16 11:07:55.437  INFO 16 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3b7c16d1
2022-01-16 11:07:55.438  INFO 16 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-revoke-extra, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3b7c16d1
2022-01-16 11:07:55.490  INFO 16 --- [https-jsse-nio-7071-exec-4] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18909726373122925-816662, decision=PERMIT, pdp-result=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}})
2022-01-16 11:07:55.490  INFO 16 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=2ebb73fd-608f-46d1-977f-c06e60f933ae, content=PERMIT, timestamp=1642331275490, pdpResult=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}}))
2022-01-16 11:07:55.491  INFO 16 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=218ms, Total=223ms
2022-01-16 11:07:55.516  INFO 16 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=1636d76f-3550-43ff-8343-fa0064754567, content=null, timestamp=1642331275511, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=50318, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=5fb2fe03fb5a, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=7187b2ea-af71-4106-9885-90a594c75da9, http-req-server-port=80, http-header-accept=*/*, kc-id=6b662965-9581-452d-9a8e-efb17f194ea0, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642331275510, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeP9sHNxAH4AEQAAAABh4/yEdAAkNmI2NjI5NjUtOTU4MS00NTJkLTlhOGUtZWZiMTdmMTk0ZWEwdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ3MTg3YjJlYS1hZjcxLTQxMDYtOTg4NS05MGE1OTRjNzVkYTlwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICI2cGUwZ2U1ck0zU2E2SUt5WXBsLTVkQTZrVXVleWo3X1psV2c1aDU4MmFvIn0.eyJleHAiOjE2NDIzMzE1NjgsImlhdCI6MTY0MjMzMTI2OCwianRpIjoiNmI2NjI5NjUtOTU4MS00NTJkLTlhOGUtZWZiMTdmMTk0ZWEwIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiI3MTg3YjJlYS1hZjcxLTQxMDYtOTg4NS05MGE1OTRjNzVkYTkiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.omg8lBi8aYXNKFtyz-59LVSg2a2tCMxJ-pijDZk_PJuP3t0KLP9mK065sgr18j9RRLlhB5Gz2kgicFArxHtivEl0gUXu61vDMI1JwNX-iJP3IW1nOuz1niWS06XTsBAs3FLboN9JCzCrlyLSB7kFOSKNyr9gnqXqesWQU1H_s6k9aowpZ2V4aNEsojTx4jRXH2wCNB77m23zlaTQfbhQx_Hi4ZBiiOFCmRXadXaP0PC2LKecdNH4x8WAIIR9Jxwe-mzphLjj5_er637GhiPlR7lUQk9Yn4L72NWb6IEYvcz5_B5E73AFiU_xFR5kcOBPp-wTl_8-LRcBhxSaV9WLrA, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642331568, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.48.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=3851554EC351949DEDFD36BECD9EC33C, http-session-last-accessed-time=1642331275510, kc-category-name=ACCESS, kc-iat=1642331268, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:50318 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:07:55.517  INFO 16 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:07:55.518  INFO 16 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4c929f71
2022-01-16 11:07:55.518  INFO 16 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4c929f71
2022-01-16 11:07:55.532  INFO 16 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4c929f71
2022-01-16 11:07:55.532  INFO 16 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4c929f71
2022-01-16 11:07:55.545  INFO 16 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4c929f71
2022-01-16 11:07:55.546  WARN 16 --- [https-jsse-nio-7071-exec-5] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:07:55.546  WARN 16 --- [https-jsse-nio-7071-exec-5] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:07:55.546  INFO 16 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4c929f71
2022-01-16 11:07:55.547  INFO 16 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4c929f71
2022-01-16 11:07:55.547  WARN 16 --- [https-jsse-nio-7071-exec-5] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:07:55.547  WARN 16 --- [https-jsse-nio-7071-exec-5] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:07:55.548  INFO 16 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4c929f71
2022-01-16 11:07:55.601  INFO 16 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: emergency-active, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4c929f71
2022-01-16 11:07:55.618  INFO 16 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4c929f71
2022-01-16 11:07:55.618  INFO 16 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4c929f71
2022-01-16 11:07:55.635  INFO 16 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4c929f71
2022-01-16 11:07:55.636  INFO 16 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-revoke-extra, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4c929f71
2022-01-16 11:07:55.690  INFO 16 --- [https-jsse-nio-7071-exec-5] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18909726618097025-732051, decision=PERMIT, pdp-result=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}})
2022-01-16 11:07:55.691  INFO 16 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=1636d76f-3550-43ff-8343-fa0064754567, content=PERMIT, timestamp=1642331275691, pdpResult=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}}))
2022-01-16 11:07:55.691  INFO 16 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=174ms, Total=176ms
2022-01-16 11:07:55.726  INFO 16 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=1b655399-0c77-4f34-a6dd-3ea105e2dbe0, content=null, timestamp=1642331275713, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=50320, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=5fb2fe03fb5a, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=7187b2ea-af71-4106-9885-90a594c75da9, http-req-server-port=80, http-header-accept=*/*, kc-id=6b662965-9581-452d-9a8e-efb17f194ea0, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642331275711, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeP9sHNxAH4AEQAAAABh4/yEdAAkNmI2NjI5NjUtOTU4MS00NTJkLTlhOGUtZWZiMTdmMTk0ZWEwdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ3MTg3YjJlYS1hZjcxLTQxMDYtOTg4NS05MGE1OTRjNzVkYTlwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICI2cGUwZ2U1ck0zU2E2SUt5WXBsLTVkQTZrVXVleWo3X1psV2c1aDU4MmFvIn0.eyJleHAiOjE2NDIzMzE1NjgsImlhdCI6MTY0MjMzMTI2OCwianRpIjoiNmI2NjI5NjUtOTU4MS00NTJkLTlhOGUtZWZiMTdmMTk0ZWEwIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiI3MTg3YjJlYS1hZjcxLTQxMDYtOTg4NS05MGE1OTRjNzVkYTkiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.omg8lBi8aYXNKFtyz-59LVSg2a2tCMxJ-pijDZk_PJuP3t0KLP9mK065sgr18j9RRLlhB5Gz2kgicFArxHtivEl0gUXu61vDMI1JwNX-iJP3IW1nOuz1niWS06XTsBAs3FLboN9JCzCrlyLSB7kFOSKNyr9gnqXqesWQU1H_s6k9aowpZ2V4aNEsojTx4jRXH2wCNB77m23zlaTQfbhQx_Hi4ZBiiOFCmRXadXaP0PC2LKecdNH4x8WAIIR9Jxwe-mzphLjj5_er637GhiPlR7lUQk9Yn4L72NWb6IEYvcz5_B5E73AFiU_xFR5kcOBPp-wTl_8-LRcBhxSaV9WLrA, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642331568, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.48.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=883CB09A7A87EAA222C4DA6322FA76A8, http-session-last-accessed-time=1642331275711, kc-category-name=ACCESS, kc-iat=1642331268, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:50320 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:07:55.727  INFO 16 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:07:55.728  INFO 16 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@d43aaa7
2022-01-16 11:07:55.728  INFO 16 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@d43aaa7
2022-01-16 11:07:55.740  INFO 16 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@d43aaa7
2022-01-16 11:07:55.741  INFO 16 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@d43aaa7
2022-01-16 11:07:55.750  INFO 16 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@d43aaa7
2022-01-16 11:07:55.751  WARN 16 --- [https-jsse-nio-7071-exec-6] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:07:55.751  WARN 16 --- [https-jsse-nio-7071-exec-6] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:07:55.751  INFO 16 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@d43aaa7
2022-01-16 11:07:55.751  INFO 16 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@d43aaa7
2022-01-16 11:07:55.751  WARN 16 --- [https-jsse-nio-7071-exec-6] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:07:55.751  WARN 16 --- [https-jsse-nio-7071-exec-6] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:07:55.751  INFO 16 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@d43aaa7
2022-01-16 11:07:55.767  INFO 16 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: emergency-active, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@d43aaa7
2022-01-16 11:07:55.817  INFO 16 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@d43aaa7
2022-01-16 11:07:55.818  INFO 16 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@d43aaa7
2022-01-16 11:07:55.833  INFO 16 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@d43aaa7
2022-01-16 11:07:55.833  INFO 16 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-revoke-extra, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@d43aaa7
2022-01-16 11:07:55.849  INFO 16 --- [https-jsse-nio-7071-exec-6] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18909726828226536-558382, decision=PERMIT, pdp-result=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}})
2022-01-16 11:07:55.850  INFO 16 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=1b655399-0c77-4f34-a6dd-3ea105e2dbe0, content=PERMIT, timestamp=1642331275850, pdpResult=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}}))
2022-01-16 11:07:55.857  INFO 16 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=123ms, Total=132ms
2022-01-16 11:07:55.882  INFO 16 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=41bb53f8-5784-4f73-851a-4f1d7abe5e30, content=null, timestamp=1642331275877, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=50322, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=5fb2fe03fb5a, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=7187b2ea-af71-4106-9885-90a594c75da9, http-req-server-port=80, http-header-accept=*/*, kc-id=6b662965-9581-452d-9a8e-efb17f194ea0, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642331275875, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeP9sHNxAH4AEQAAAABh4/yEdAAkNmI2NjI5NjUtOTU4MS00NTJkLTlhOGUtZWZiMTdmMTk0ZWEwdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ3MTg3YjJlYS1hZjcxLTQxMDYtOTg4NS05MGE1OTRjNzVkYTlwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICI2cGUwZ2U1ck0zU2E2SUt5WXBsLTVkQTZrVXVleWo3X1psV2c1aDU4MmFvIn0.eyJleHAiOjE2NDIzMzE1NjgsImlhdCI6MTY0MjMzMTI2OCwianRpIjoiNmI2NjI5NjUtOTU4MS00NTJkLTlhOGUtZWZiMTdmMTk0ZWEwIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiI3MTg3YjJlYS1hZjcxLTQxMDYtOTg4NS05MGE1OTRjNzVkYTkiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.omg8lBi8aYXNKFtyz-59LVSg2a2tCMxJ-pijDZk_PJuP3t0KLP9mK065sgr18j9RRLlhB5Gz2kgicFArxHtivEl0gUXu61vDMI1JwNX-iJP3IW1nOuz1niWS06XTsBAs3FLboN9JCzCrlyLSB7kFOSKNyr9gnqXqesWQU1H_s6k9aowpZ2V4aNEsojTx4jRXH2wCNB77m23zlaTQfbhQx_Hi4ZBiiOFCmRXadXaP0PC2LKecdNH4x8WAIIR9Jxwe-mzphLjj5_er637GhiPlR7lUQk9Yn4L72NWb6IEYvcz5_B5E73AFiU_xFR5kcOBPp-wTl_8-LRcBhxSaV9WLrA, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642331568, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.48.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=F77FECF8D715FE12EFB8F53667A3997F, http-session-last-accessed-time=1642331275875, kc-category-name=ACCESS, kc-iat=1642331268, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:50322 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:07:55.882  INFO 16 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:07:55.883  INFO 16 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1d91dfcc
2022-01-16 11:07:55.884  INFO 16 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1d91dfcc
2022-01-16 11:07:55.894  INFO 16 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1d91dfcc
2022-01-16 11:07:55.895  INFO 16 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1d91dfcc
2022-01-16 11:07:55.946  INFO 16 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1d91dfcc
2022-01-16 11:07:55.947  WARN 16 --- [https-jsse-nio-7071-exec-7] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:07:55.947  WARN 16 --- [https-jsse-nio-7071-exec-7] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:07:55.948  INFO 16 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1d91dfcc
2022-01-16 11:07:55.948  INFO 16 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1d91dfcc
2022-01-16 11:07:55.949  WARN 16 --- [https-jsse-nio-7071-exec-7] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:07:55.949  WARN 16 --- [https-jsse-nio-7071-exec-7] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:07:55.950  INFO 16 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1d91dfcc
2022-01-16 11:07:55.966  INFO 16 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: emergency-active, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1d91dfcc
2022-01-16 11:07:55.975  INFO 16 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1d91dfcc
2022-01-16 11:07:55.975  INFO 16 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1d91dfcc
2022-01-16 11:07:56.026  INFO 16 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1d91dfcc
2022-01-16 11:07:56.026  INFO 16 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-revoke-extra, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1d91dfcc
2022-01-16 11:07:56.041  INFO 16 --- [https-jsse-nio-7071-exec-7] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18909726983905506-542824, decision=PERMIT, pdp-result=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}})
2022-01-16 11:07:56.041  INFO 16 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=41bb53f8-5784-4f73-851a-4f1d7abe5e30, content=PERMIT, timestamp=1642331276041, pdpResult=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}}))
2022-01-16 11:07:56.043  INFO 16 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=159ms, Total=162ms
2022-01-16 11:07:56.083  INFO 16 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=43fe75f7-95d0-43b4-9d01-3635f86af6d2, content=null, timestamp=1642331276071, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=50324, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=5fb2fe03fb5a, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=7187b2ea-af71-4106-9885-90a594c75da9, http-req-server-port=80, http-header-accept=*/*, kc-id=6b662965-9581-452d-9a8e-efb17f194ea0, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642331276069, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeP9sHNxAH4AEQAAAABh4/yEdAAkNmI2NjI5NjUtOTU4MS00NTJkLTlhOGUtZWZiMTdmMTk0ZWEwdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ3MTg3YjJlYS1hZjcxLTQxMDYtOTg4NS05MGE1OTRjNzVkYTlwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICI2cGUwZ2U1ck0zU2E2SUt5WXBsLTVkQTZrVXVleWo3X1psV2c1aDU4MmFvIn0.eyJleHAiOjE2NDIzMzE1NjgsImlhdCI6MTY0MjMzMTI2OCwianRpIjoiNmI2NjI5NjUtOTU4MS00NTJkLTlhOGUtZWZiMTdmMTk0ZWEwIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiI3MTg3YjJlYS1hZjcxLTQxMDYtOTg4NS05MGE1OTRjNzVkYTkiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.omg8lBi8aYXNKFtyz-59LVSg2a2tCMxJ-pijDZk_PJuP3t0KLP9mK065sgr18j9RRLlhB5Gz2kgicFArxHtivEl0gUXu61vDMI1JwNX-iJP3IW1nOuz1niWS06XTsBAs3FLboN9JCzCrlyLSB7kFOSKNyr9gnqXqesWQU1H_s6k9aowpZ2V4aNEsojTx4jRXH2wCNB77m23zlaTQfbhQx_Hi4ZBiiOFCmRXadXaP0PC2LKecdNH4x8WAIIR9Jxwe-mzphLjj5_er637GhiPlR7lUQk9Yn4L72NWb6IEYvcz5_B5E73AFiU_xFR5kcOBPp-wTl_8-LRcBhxSaV9WLrA, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642331568, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.48.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=629646817891E7AF84243508EADB1699, http-session-last-accessed-time=1642331276069, kc-category-name=ACCESS, kc-iat=1642331268, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:50324 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:07:56.084  INFO 16 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:07:56.086  INFO 16 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5419defd
2022-01-16 11:07:56.086  INFO 16 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5419defd
2022-01-16 11:07:56.096  INFO 16 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5419defd
2022-01-16 11:07:56.097  INFO 16 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5419defd
2022-01-16 11:07:56.145  INFO 16 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5419defd
2022-01-16 11:07:56.146  WARN 16 --- [https-jsse-nio-7071-exec-8] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:07:56.146  WARN 16 --- [https-jsse-nio-7071-exec-8] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:07:56.147  INFO 16 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5419defd
2022-01-16 11:07:56.151  INFO 16 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5419defd
2022-01-16 11:07:56.151  WARN 16 --- [https-jsse-nio-7071-exec-8] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:07:56.151  WARN 16 --- [https-jsse-nio-7071-exec-8] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:07:56.151  INFO 16 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5419defd
2022-01-16 11:07:56.167  INFO 16 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: emergency-active, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5419defd
2022-01-16 11:07:56.176  INFO 16 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5419defd
2022-01-16 11:07:56.176  INFO 16 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5419defd
2022-01-16 11:07:56.225  INFO 16 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5419defd
2022-01-16 11:07:56.226  INFO 16 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-revoke-extra, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5419defd
2022-01-16 11:07:56.239  INFO 16 --- [https-jsse-nio-7071-exec-8] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18909727185537475-276752, decision=PERMIT, pdp-result=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}})
2022-01-16 11:07:56.239  INFO 16 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=43fe75f7-95d0-43b4-9d01-3635f86af6d2, content=PERMIT, timestamp=1642331276239, pdpResult=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}}))
2022-01-16 11:07:56.239  INFO 16 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=155ms, Total=162ms
2022-01-16 11:07:56.263  INFO 16 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=60e10155-62c2-46e0-ae93-1646af24b623, content=null, timestamp=1642331276257, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=50326, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=5fb2fe03fb5a, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=7187b2ea-af71-4106-9885-90a594c75da9, http-req-server-port=80, http-header-accept=*/*, kc-id=6b662965-9581-452d-9a8e-efb17f194ea0, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642331276255, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeP9sHNxAH4AEQAAAABh4/yEdAAkNmI2NjI5NjUtOTU4MS00NTJkLTlhOGUtZWZiMTdmMTk0ZWEwdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ3MTg3YjJlYS1hZjcxLTQxMDYtOTg4NS05MGE1OTRjNzVkYTlwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICI2cGUwZ2U1ck0zU2E2SUt5WXBsLTVkQTZrVXVleWo3X1psV2c1aDU4MmFvIn0.eyJleHAiOjE2NDIzMzE1NjgsImlhdCI6MTY0MjMzMTI2OCwianRpIjoiNmI2NjI5NjUtOTU4MS00NTJkLTlhOGUtZWZiMTdmMTk0ZWEwIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiI3MTg3YjJlYS1hZjcxLTQxMDYtOTg4NS05MGE1OTRjNzVkYTkiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.omg8lBi8aYXNKFtyz-59LVSg2a2tCMxJ-pijDZk_PJuP3t0KLP9mK065sgr18j9RRLlhB5Gz2kgicFArxHtivEl0gUXu61vDMI1JwNX-iJP3IW1nOuz1niWS06XTsBAs3FLboN9JCzCrlyLSB7kFOSKNyr9gnqXqesWQU1H_s6k9aowpZ2V4aNEsojTx4jRXH2wCNB77m23zlaTQfbhQx_Hi4ZBiiOFCmRXadXaP0PC2LKecdNH4x8WAIIR9Jxwe-mzphLjj5_er637GhiPlR7lUQk9Yn4L72NWb6IEYvcz5_B5E73AFiU_xFR5kcOBPp-wTl_8-LRcBhxSaV9WLrA, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642331568, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.48.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=F8B6983266A42EA02942FD81FB6A718D, http-session-last-accessed-time=1642331276255, kc-category-name=ACCESS, kc-iat=1642331268, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:50326 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:07:56.265  INFO 16 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:07:56.266  INFO 16 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1761943c
2022-01-16 11:07:56.270  INFO 16 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1761943c
2022-01-16 11:07:56.281  INFO 16 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1761943c
2022-01-16 11:07:56.282  INFO 16 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1761943c
2022-01-16 11:07:56.333  INFO 16 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1761943c
2022-01-16 11:07:56.333  WARN 16 --- [https-jsse-nio-7071-exec-9] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:07:56.334  WARN 16 --- [https-jsse-nio-7071-exec-9] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:07:56.334  INFO 16 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1761943c
2022-01-16 11:07:56.334  INFO 16 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1761943c
2022-01-16 11:07:56.334  WARN 16 --- [https-jsse-nio-7071-exec-9] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:07:56.334  WARN 16 --- [https-jsse-nio-7071-exec-9] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:07:56.335  INFO 16 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1761943c
2022-01-16 11:07:56.350  INFO 16 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: emergency-active, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1761943c
2022-01-16 11:07:56.361  INFO 16 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1761943c
2022-01-16 11:07:56.361  INFO 16 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1761943c
2022-01-16 11:07:56.413  INFO 16 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1761943c
2022-01-16 11:07:56.414  INFO 16 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-revoke-extra, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1761943c
2022-01-16 11:07:56.431  INFO 16 --- [https-jsse-nio-7071-exec-9] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18909727366201894-753087, decision=PERMIT, pdp-result=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}})
2022-01-16 11:07:56.431  INFO 16 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=60e10155-62c2-46e0-ae93-1646af24b623, content=PERMIT, timestamp=1642331276431, pdpResult=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}}))
2022-01-16 11:07:56.432  INFO 16 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=166ms, Total=170ms
2022-01-16 11:07:56.454  INFO 16 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=f88e649e-9e19-45c0-b1a4-2bb36940177b, content=null, timestamp=1642331276449, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=50328, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=5fb2fe03fb5a, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=7187b2ea-af71-4106-9885-90a594c75da9, http-req-server-port=80, http-header-accept=*/*, kc-id=6b662965-9581-452d-9a8e-efb17f194ea0, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642331276448, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeP9sHNxAH4AEQAAAABh4/yEdAAkNmI2NjI5NjUtOTU4MS00NTJkLTlhOGUtZWZiMTdmMTk0ZWEwdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ3MTg3YjJlYS1hZjcxLTQxMDYtOTg4NS05MGE1OTRjNzVkYTlwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICI2cGUwZ2U1ck0zU2E2SUt5WXBsLTVkQTZrVXVleWo3X1psV2c1aDU4MmFvIn0.eyJleHAiOjE2NDIzMzE1NjgsImlhdCI6MTY0MjMzMTI2OCwianRpIjoiNmI2NjI5NjUtOTU4MS00NTJkLTlhOGUtZWZiMTdmMTk0ZWEwIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiI3MTg3YjJlYS1hZjcxLTQxMDYtOTg4NS05MGE1OTRjNzVkYTkiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.omg8lBi8aYXNKFtyz-59LVSg2a2tCMxJ-pijDZk_PJuP3t0KLP9mK065sgr18j9RRLlhB5Gz2kgicFArxHtivEl0gUXu61vDMI1JwNX-iJP3IW1nOuz1niWS06XTsBAs3FLboN9JCzCrlyLSB7kFOSKNyr9gnqXqesWQU1H_s6k9aowpZ2V4aNEsojTx4jRXH2wCNB77m23zlaTQfbhQx_Hi4ZBiiOFCmRXadXaP0PC2LKecdNH4x8WAIIR9Jxwe-mzphLjj5_er637GhiPlR7lUQk9Yn4L72NWb6IEYvcz5_B5E73AFiU_xFR5kcOBPp-wTl_8-LRcBhxSaV9WLrA, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642331568, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.48.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=4B8281EA2C251EAF706E5429F19ED741, http-session-last-accessed-time=1642331276448, kc-category-name=ACCESS, kc-iat=1642331268, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:50328 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:07:56.454  INFO 16 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:07:56.455  INFO 16 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5ffde127
2022-01-16 11:07:56.455  INFO 16 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5ffde127
2022-01-16 11:07:56.465  INFO 16 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5ffde127
2022-01-16 11:07:56.465  INFO 16 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5ffde127
2022-01-16 11:07:56.517  INFO 16 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5ffde127
2022-01-16 11:07:56.518  WARN 16 --- [https-jsse-nio-7071-exec-10] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:07:56.518  WARN 16 --- [https-jsse-nio-7071-exec-10] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:07:56.518  INFO 16 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5ffde127
2022-01-16 11:07:56.519  INFO 16 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5ffde127
2022-01-16 11:07:56.519  WARN 16 --- [https-jsse-nio-7071-exec-10] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:07:56.519  WARN 16 --- [https-jsse-nio-7071-exec-10] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:07:56.520  INFO 16 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5ffde127
2022-01-16 11:07:56.534  INFO 16 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: emergency-active, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5ffde127
2022-01-16 11:07:56.544  INFO 16 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5ffde127
2022-01-16 11:07:56.544  INFO 16 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5ffde127
2022-01-16 11:07:56.594  INFO 16 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5ffde127
2022-01-16 11:07:56.594  INFO 16 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-revoke-extra, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5ffde127
2022-01-16 11:07:56.609  INFO 16 --- [https-jsse-nio-7071-exec-10] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18909727555899805-772487, decision=PERMIT, pdp-result=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}})
2022-01-16 11:07:56.610  INFO 16 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=f88e649e-9e19-45c0-b1a4-2bb36940177b, content=PERMIT, timestamp=1642331276610, pdpResult=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}}))
2022-01-16 11:07:56.611  INFO 16 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=156ms, Total=158ms
2022-01-16 11:07:56.633  INFO 16 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=da0947ed-f276-49e6-9a96-bd6e2181bbc6, content=null, timestamp=1642331276629, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=50330, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=5fb2fe03fb5a, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=7187b2ea-af71-4106-9885-90a594c75da9, http-req-server-port=80, http-header-accept=*/*, kc-id=6b662965-9581-452d-9a8e-efb17f194ea0, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642331276628, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeP9sHNxAH4AEQAAAABh4/yEdAAkNmI2NjI5NjUtOTU4MS00NTJkLTlhOGUtZWZiMTdmMTk0ZWEwdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ3MTg3YjJlYS1hZjcxLTQxMDYtOTg4NS05MGE1OTRjNzVkYTlwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICI2cGUwZ2U1ck0zU2E2SUt5WXBsLTVkQTZrVXVleWo3X1psV2c1aDU4MmFvIn0.eyJleHAiOjE2NDIzMzE1NjgsImlhdCI6MTY0MjMzMTI2OCwianRpIjoiNmI2NjI5NjUtOTU4MS00NTJkLTlhOGUtZWZiMTdmMTk0ZWEwIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiI3MTg3YjJlYS1hZjcxLTQxMDYtOTg4NS05MGE1OTRjNzVkYTkiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.omg8lBi8aYXNKFtyz-59LVSg2a2tCMxJ-pijDZk_PJuP3t0KLP9mK065sgr18j9RRLlhB5Gz2kgicFArxHtivEl0gUXu61vDMI1JwNX-iJP3IW1nOuz1niWS06XTsBAs3FLboN9JCzCrlyLSB7kFOSKNyr9gnqXqesWQU1H_s6k9aowpZ2V4aNEsojTx4jRXH2wCNB77m23zlaTQfbhQx_Hi4ZBiiOFCmRXadXaP0PC2LKecdNH4x8WAIIR9Jxwe-mzphLjj5_er637GhiPlR7lUQk9Yn4L72NWb6IEYvcz5_B5E73AFiU_xFR5kcOBPp-wTl_8-LRcBhxSaV9WLrA, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642331568, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.48.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=4014F72509C140544797F4A46568B9ED, http-session-last-accessed-time=1642331276628, kc-category-name=ACCESS, kc-iat=1642331268, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:50330 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:07:56.634  INFO 16 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:07:56.635  INFO 16 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@72bc6a83
2022-01-16 11:07:56.635  INFO 16 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@72bc6a83
2022-01-16 11:07:56.647  INFO 16 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@72bc6a83
2022-01-16 11:07:56.647  INFO 16 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@72bc6a83
2022-01-16 11:07:56.697  INFO 16 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@72bc6a83
2022-01-16 11:07:56.698  WARN 16 --- [https-jsse-nio-7071-exec-1] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:07:56.699  WARN 16 --- [https-jsse-nio-7071-exec-1] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:07:56.699  INFO 16 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@72bc6a83
2022-01-16 11:07:56.700  INFO 16 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@72bc6a83
2022-01-16 11:07:56.700  WARN 16 --- [https-jsse-nio-7071-exec-1] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:07:56.700  WARN 16 --- [https-jsse-nio-7071-exec-1] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:07:56.701  INFO 16 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@72bc6a83
2022-01-16 11:07:56.716  INFO 16 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: emergency-active, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@72bc6a83
2022-01-16 11:07:56.726  INFO 16 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@72bc6a83
2022-01-16 11:07:56.726  INFO 16 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@72bc6a83
2022-01-16 11:07:56.781  INFO 16 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@72bc6a83
2022-01-16 11:07:56.782  INFO 16 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-revoke-extra, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@72bc6a83
2022-01-16 11:07:56.796  INFO 16 --- [https-jsse-nio-7071-exec-1] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18909727735208077-32538, decision=PERMIT, pdp-result=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}})
2022-01-16 11:07:56.797  INFO 16 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=da0947ed-f276-49e6-9a96-bd6e2181bbc6, content=PERMIT, timestamp=1642331276797, pdpResult=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}}))
2022-01-16 11:07:56.798  INFO 16 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=163ms, Total=166ms
2022-01-16 11:07:56.824  INFO 16 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=b6ffef58-1d55-41d7-bb48-b67de7bd25fa, content=null, timestamp=1642331276820, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=50332, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=5fb2fe03fb5a, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=7187b2ea-af71-4106-9885-90a594c75da9, http-req-server-port=80, http-header-accept=*/*, kc-id=6b662965-9581-452d-9a8e-efb17f194ea0, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642331276818, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeP9sHNxAH4AEQAAAABh4/yEdAAkNmI2NjI5NjUtOTU4MS00NTJkLTlhOGUtZWZiMTdmMTk0ZWEwdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ3MTg3YjJlYS1hZjcxLTQxMDYtOTg4NS05MGE1OTRjNzVkYTlwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICI2cGUwZ2U1ck0zU2E2SUt5WXBsLTVkQTZrVXVleWo3X1psV2c1aDU4MmFvIn0.eyJleHAiOjE2NDIzMzE1NjgsImlhdCI6MTY0MjMzMTI2OCwianRpIjoiNmI2NjI5NjUtOTU4MS00NTJkLTlhOGUtZWZiMTdmMTk0ZWEwIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiI3MTg3YjJlYS1hZjcxLTQxMDYtOTg4NS05MGE1OTRjNzVkYTkiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.omg8lBi8aYXNKFtyz-59LVSg2a2tCMxJ-pijDZk_PJuP3t0KLP9mK065sgr18j9RRLlhB5Gz2kgicFArxHtivEl0gUXu61vDMI1JwNX-iJP3IW1nOuz1niWS06XTsBAs3FLboN9JCzCrlyLSB7kFOSKNyr9gnqXqesWQU1H_s6k9aowpZ2V4aNEsojTx4jRXH2wCNB77m23zlaTQfbhQx_Hi4ZBiiOFCmRXadXaP0PC2LKecdNH4x8WAIIR9Jxwe-mzphLjj5_er637GhiPlR7lUQk9Yn4L72NWb6IEYvcz5_B5E73AFiU_xFR5kcOBPp-wTl_8-LRcBhxSaV9WLrA, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642331568, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.48.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=061080C861801EF07D905F9615D17681, http-session-last-accessed-time=1642331276818, kc-category-name=ACCESS, kc-iat=1642331268, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:50332 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:07:56.824  INFO 16 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:07:56.825  INFO 16 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1d45d79a
2022-01-16 11:07:56.825  INFO 16 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1d45d79a
2022-01-16 11:07:56.843  INFO 16 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1d45d79a
2022-01-16 11:07:56.843  INFO 16 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1d45d79a
2022-01-16 11:07:56.901  INFO 16 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1d45d79a
2022-01-16 11:07:56.902  WARN 16 --- [https-jsse-nio-7071-exec-2] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:07:56.902  WARN 16 --- [https-jsse-nio-7071-exec-2] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:07:56.902  INFO 16 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1d45d79a
2022-01-16 11:07:56.902  INFO 16 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1d45d79a
2022-01-16 11:07:56.902  WARN 16 --- [https-jsse-nio-7071-exec-2] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:07:56.903  WARN 16 --- [https-jsse-nio-7071-exec-2] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:07:56.903  INFO 16 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1d45d79a
2022-01-16 11:07:56.920  INFO 16 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: emergency-active, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1d45d79a
2022-01-16 11:07:56.931  INFO 16 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1d45d79a
2022-01-16 11:07:56.931  INFO 16 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1d45d79a
2022-01-16 11:07:56.981  INFO 16 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1d45d79a
2022-01-16 11:07:56.982  INFO 16 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-revoke-extra, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1d45d79a
2022-01-16 11:07:57.004  INFO 16 --- [https-jsse-nio-7071-exec-2] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18909727925816731-964627, decision=PERMIT, pdp-result=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}})
2022-01-16 11:07:57.009  INFO 16 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=b6ffef58-1d55-41d7-bb48-b67de7bd25fa, content=PERMIT, timestamp=1642331277009, pdpResult=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}}))
2022-01-16 11:07:57.011  INFO 16 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=185ms, Total=188ms
2022-01-16 11:07:57.042  INFO 16 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=c6c26f5e-7266-4c1d-8ee2-0a2e3d36199a, content=null, timestamp=1642331277036, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=50334, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=5fb2fe03fb5a, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=7187b2ea-af71-4106-9885-90a594c75da9, http-req-server-port=80, http-header-accept=*/*, kc-id=6b662965-9581-452d-9a8e-efb17f194ea0, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642331277035, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeP9sHNxAH4AEQAAAABh4/yEdAAkNmI2NjI5NjUtOTU4MS00NTJkLTlhOGUtZWZiMTdmMTk0ZWEwdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ3MTg3YjJlYS1hZjcxLTQxMDYtOTg4NS05MGE1OTRjNzVkYTlwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICI2cGUwZ2U1ck0zU2E2SUt5WXBsLTVkQTZrVXVleWo3X1psV2c1aDU4MmFvIn0.eyJleHAiOjE2NDIzMzE1NjgsImlhdCI6MTY0MjMzMTI2OCwianRpIjoiNmI2NjI5NjUtOTU4MS00NTJkLTlhOGUtZWZiMTdmMTk0ZWEwIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiI3MTg3YjJlYS1hZjcxLTQxMDYtOTg4NS05MGE1OTRjNzVkYTkiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.omg8lBi8aYXNKFtyz-59LVSg2a2tCMxJ-pijDZk_PJuP3t0KLP9mK065sgr18j9RRLlhB5Gz2kgicFArxHtivEl0gUXu61vDMI1JwNX-iJP3IW1nOuz1niWS06XTsBAs3FLboN9JCzCrlyLSB7kFOSKNyr9gnqXqesWQU1H_s6k9aowpZ2V4aNEsojTx4jRXH2wCNB77m23zlaTQfbhQx_Hi4ZBiiOFCmRXadXaP0PC2LKecdNH4x8WAIIR9Jxwe-mzphLjj5_er637GhiPlR7lUQk9Yn4L72NWb6IEYvcz5_B5E73AFiU_xFR5kcOBPp-wTl_8-LRcBhxSaV9WLrA, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642331568, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.48.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=72195654B65F4505B00A39701A7770AE, http-session-last-accessed-time=1642331277035, kc-category-name=ACCESS, kc-iat=1642331268, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:50334 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:07:57.042  INFO 16 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:07:57.043  INFO 16 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@80dff86
2022-01-16 11:07:57.044  INFO 16 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@80dff86
2022-01-16 11:07:57.056  INFO 16 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@80dff86
2022-01-16 11:07:57.056  INFO 16 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@80dff86
2022-01-16 11:07:57.065  INFO 16 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@80dff86
2022-01-16 11:07:57.065  WARN 16 --- [https-jsse-nio-7071-exec-3] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:07:57.065  WARN 16 --- [https-jsse-nio-7071-exec-3] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:07:57.066  INFO 16 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@80dff86
2022-01-16 11:07:57.066  INFO 16 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@80dff86
2022-01-16 11:07:57.067  WARN 16 --- [https-jsse-nio-7071-exec-3] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:07:57.067  WARN 16 --- [https-jsse-nio-7071-exec-3] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:07:57.067  INFO 16 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@80dff86
2022-01-16 11:07:57.117  INFO 16 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: emergency-active, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@80dff86
2022-01-16 11:07:57.135  INFO 16 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@80dff86
2022-01-16 11:07:57.135  INFO 16 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@80dff86
2022-01-16 11:07:57.146  INFO 16 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@80dff86
2022-01-16 11:07:57.146  INFO 16 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-revoke-extra, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@80dff86
2022-01-16 11:07:57.202  INFO 16 --- [https-jsse-nio-7071-exec-3] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18909728144060767-629567, decision=PERMIT, pdp-result=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}})
2022-01-16 11:07:57.202  INFO 16 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=c6c26f5e-7266-4c1d-8ee2-0a2e3d36199a, content=PERMIT, timestamp=1642331277202, pdpResult=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}}))
2022-01-16 11:07:57.204  INFO 16 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=159ms, Total=164ms
2022-01-16 11:07:57.228  INFO 16 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=a95959b0-14fe-4333-92ba-4f781dc205c6, content=null, timestamp=1642331277222, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=50336, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=5fb2fe03fb5a, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=7187b2ea-af71-4106-9885-90a594c75da9, http-req-server-port=80, http-header-accept=*/*, kc-id=6b662965-9581-452d-9a8e-efb17f194ea0, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642331277221, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeP9sHNxAH4AEQAAAABh4/yEdAAkNmI2NjI5NjUtOTU4MS00NTJkLTlhOGUtZWZiMTdmMTk0ZWEwdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ3MTg3YjJlYS1hZjcxLTQxMDYtOTg4NS05MGE1OTRjNzVkYTlwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICI2cGUwZ2U1ck0zU2E2SUt5WXBsLTVkQTZrVXVleWo3X1psV2c1aDU4MmFvIn0.eyJleHAiOjE2NDIzMzE1NjgsImlhdCI6MTY0MjMzMTI2OCwianRpIjoiNmI2NjI5NjUtOTU4MS00NTJkLTlhOGUtZWZiMTdmMTk0ZWEwIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiI3MTg3YjJlYS1hZjcxLTQxMDYtOTg4NS05MGE1OTRjNzVkYTkiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.omg8lBi8aYXNKFtyz-59LVSg2a2tCMxJ-pijDZk_PJuP3t0KLP9mK065sgr18j9RRLlhB5Gz2kgicFArxHtivEl0gUXu61vDMI1JwNX-iJP3IW1nOuz1niWS06XTsBAs3FLboN9JCzCrlyLSB7kFOSKNyr9gnqXqesWQU1H_s6k9aowpZ2V4aNEsojTx4jRXH2wCNB77m23zlaTQfbhQx_Hi4ZBiiOFCmRXadXaP0PC2LKecdNH4x8WAIIR9Jxwe-mzphLjj5_er637GhiPlR7lUQk9Yn4L72NWb6IEYvcz5_B5E73AFiU_xFR5kcOBPp-wTl_8-LRcBhxSaV9WLrA, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642331568, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.48.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=06D874D115ADBC71AC9ED61669686501, http-session-last-accessed-time=1642331277221, kc-category-name=ACCESS, kc-iat=1642331268, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:50336 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:07:57.228  INFO 16 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:07:57.229  INFO 16 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1781dbb5
2022-01-16 11:07:57.230  INFO 16 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1781dbb5
2022-01-16 11:07:57.241  INFO 16 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1781dbb5
2022-01-16 11:07:57.242  INFO 16 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1781dbb5
2022-01-16 11:07:57.253  INFO 16 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1781dbb5
2022-01-16 11:07:57.253  WARN 16 --- [https-jsse-nio-7071-exec-4] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:07:57.253  WARN 16 --- [https-jsse-nio-7071-exec-4] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:07:57.254  INFO 16 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1781dbb5
2022-01-16 11:07:57.254  INFO 16 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1781dbb5
2022-01-16 11:07:57.254  WARN 16 --- [https-jsse-nio-7071-exec-4] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:07:57.255  WARN 16 --- [https-jsse-nio-7071-exec-4] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:07:57.255  INFO 16 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1781dbb5
2022-01-16 11:07:57.305  INFO 16 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: emergency-active, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1781dbb5
2022-01-16 11:07:57.314  INFO 16 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1781dbb5
2022-01-16 11:07:57.315  INFO 16 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1781dbb5
2022-01-16 11:07:57.324  INFO 16 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1781dbb5
2022-01-16 11:07:57.324  INFO 16 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-revoke-extra, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1781dbb5
2022-01-16 11:07:57.373  INFO 16 --- [https-jsse-nio-7071-exec-4] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18909728330002196-458346, decision=PERMIT, pdp-result=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}})
2022-01-16 11:07:57.373  INFO 16 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=a95959b0-14fe-4333-92ba-4f781dc205c6, content=PERMIT, timestamp=1642331277373, pdpResult=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}}))
2022-01-16 11:07:57.374  INFO 16 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=144ms, Total=148ms
2022-01-16 11:07:57.401  INFO 16 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=b4514322-8b95-406f-8a76-e8a823e75954, content=null, timestamp=1642331277394, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=50338, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=5fb2fe03fb5a, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=7187b2ea-af71-4106-9885-90a594c75da9, http-req-server-port=80, http-header-accept=*/*, kc-id=6b662965-9581-452d-9a8e-efb17f194ea0, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642331277393, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeP9sHNxAH4AEQAAAABh4/yEdAAkNmI2NjI5NjUtOTU4MS00NTJkLTlhOGUtZWZiMTdmMTk0ZWEwdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ3MTg3YjJlYS1hZjcxLTQxMDYtOTg4NS05MGE1OTRjNzVkYTlwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICI2cGUwZ2U1ck0zU2E2SUt5WXBsLTVkQTZrVXVleWo3X1psV2c1aDU4MmFvIn0.eyJleHAiOjE2NDIzMzE1NjgsImlhdCI6MTY0MjMzMTI2OCwianRpIjoiNmI2NjI5NjUtOTU4MS00NTJkLTlhOGUtZWZiMTdmMTk0ZWEwIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiI3MTg3YjJlYS1hZjcxLTQxMDYtOTg4NS05MGE1OTRjNzVkYTkiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.omg8lBi8aYXNKFtyz-59LVSg2a2tCMxJ-pijDZk_PJuP3t0KLP9mK065sgr18j9RRLlhB5Gz2kgicFArxHtivEl0gUXu61vDMI1JwNX-iJP3IW1nOuz1niWS06XTsBAs3FLboN9JCzCrlyLSB7kFOSKNyr9gnqXqesWQU1H_s6k9aowpZ2V4aNEsojTx4jRXH2wCNB77m23zlaTQfbhQx_Hi4ZBiiOFCmRXadXaP0PC2LKecdNH4x8WAIIR9Jxwe-mzphLjj5_er637GhiPlR7lUQk9Yn4L72NWb6IEYvcz5_B5E73AFiU_xFR5kcOBPp-wTl_8-LRcBhxSaV9WLrA, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642331568, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.48.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=2DD74EFFD00C8D2487BF371FB8490192, http-session-last-accessed-time=1642331277393, kc-category-name=ACCESS, kc-iat=1642331268, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:50338 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:07:57.401  INFO 16 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:07:57.403  INFO 16 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7c8e4e1a
2022-01-16 11:07:57.403  INFO 16 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7c8e4e1a
2022-01-16 11:07:57.414  INFO 16 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7c8e4e1a
2022-01-16 11:07:57.414  INFO 16 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7c8e4e1a
2022-01-16 11:07:57.423  INFO 16 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7c8e4e1a
2022-01-16 11:07:57.423  WARN 16 --- [https-jsse-nio-7071-exec-5] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:07:57.423  WARN 16 --- [https-jsse-nio-7071-exec-5] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:07:57.423  INFO 16 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7c8e4e1a
2022-01-16 11:07:57.424  INFO 16 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7c8e4e1a
2022-01-16 11:07:57.424  WARN 16 --- [https-jsse-nio-7071-exec-5] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:07:57.424  WARN 16 --- [https-jsse-nio-7071-exec-5] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:07:57.424  INFO 16 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7c8e4e1a
2022-01-16 11:07:57.473  INFO 16 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: emergency-active, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7c8e4e1a
2022-01-16 11:07:57.487  INFO 16 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7c8e4e1a
2022-01-16 11:07:57.487  INFO 16 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7c8e4e1a
2022-01-16 11:07:57.496  INFO 16 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7c8e4e1a
2022-01-16 11:07:57.496  INFO 16 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-revoke-extra, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7c8e4e1a
2022-01-16 11:07:57.550  INFO 16 --- [https-jsse-nio-7071-exec-5] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18909728502753677-48809, decision=PERMIT, pdp-result=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}})
2022-01-16 11:07:57.550  INFO 16 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=b4514322-8b95-406f-8a76-e8a823e75954, content=PERMIT, timestamp=1642331277550, pdpResult=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}}))
2022-01-16 11:07:57.550  INFO 16 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=149ms, Total=151ms
2022-01-16 11:07:57.572  INFO 16 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=81797f41-5887-406b-81d2-dd914e305760, content=null, timestamp=1642331277567, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=50340, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=5fb2fe03fb5a, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=7187b2ea-af71-4106-9885-90a594c75da9, http-req-server-port=80, http-header-accept=*/*, kc-id=6b662965-9581-452d-9a8e-efb17f194ea0, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642331277566, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeP9sHNxAH4AEQAAAABh4/yEdAAkNmI2NjI5NjUtOTU4MS00NTJkLTlhOGUtZWZiMTdmMTk0ZWEwdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ3MTg3YjJlYS1hZjcxLTQxMDYtOTg4NS05MGE1OTRjNzVkYTlwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICI2cGUwZ2U1ck0zU2E2SUt5WXBsLTVkQTZrVXVleWo3X1psV2c1aDU4MmFvIn0.eyJleHAiOjE2NDIzMzE1NjgsImlhdCI6MTY0MjMzMTI2OCwianRpIjoiNmI2NjI5NjUtOTU4MS00NTJkLTlhOGUtZWZiMTdmMTk0ZWEwIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiI3MTg3YjJlYS1hZjcxLTQxMDYtOTg4NS05MGE1OTRjNzVkYTkiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.omg8lBi8aYXNKFtyz-59LVSg2a2tCMxJ-pijDZk_PJuP3t0KLP9mK065sgr18j9RRLlhB5Gz2kgicFArxHtivEl0gUXu61vDMI1JwNX-iJP3IW1nOuz1niWS06XTsBAs3FLboN9JCzCrlyLSB7kFOSKNyr9gnqXqesWQU1H_s6k9aowpZ2V4aNEsojTx4jRXH2wCNB77m23zlaTQfbhQx_Hi4ZBiiOFCmRXadXaP0PC2LKecdNH4x8WAIIR9Jxwe-mzphLjj5_er637GhiPlR7lUQk9Yn4L72NWb6IEYvcz5_B5E73AFiU_xFR5kcOBPp-wTl_8-LRcBhxSaV9WLrA, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642331568, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.48.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=46F31CF8B285FC00C757A1963A9C90BE, http-session-last-accessed-time=1642331277566, kc-category-name=ACCESS, kc-iat=1642331268, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:50340 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:07:57.572  INFO 16 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:07:57.573  INFO 16 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7ffd75fb
2022-01-16 11:07:57.574  INFO 16 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7ffd75fb
2022-01-16 11:07:57.585  INFO 16 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7ffd75fb
2022-01-16 11:07:57.585  INFO 16 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7ffd75fb
2022-01-16 11:07:57.597  INFO 16 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7ffd75fb
2022-01-16 11:07:57.597  WARN 16 --- [https-jsse-nio-7071-exec-6] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:07:57.598  WARN 16 --- [https-jsse-nio-7071-exec-6] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:07:57.598  INFO 16 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7ffd75fb
2022-01-16 11:07:57.599  INFO 16 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7ffd75fb
2022-01-16 11:07:57.599  WARN 16 --- [https-jsse-nio-7071-exec-6] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:07:57.599  WARN 16 --- [https-jsse-nio-7071-exec-6] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:07:57.600  INFO 16 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7ffd75fb
2022-01-16 11:07:57.657  INFO 16 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: emergency-active, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7ffd75fb
2022-01-16 11:07:57.670  INFO 16 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7ffd75fb
2022-01-16 11:07:57.670  INFO 16 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7ffd75fb
2022-01-16 11:07:57.678  INFO 16 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7ffd75fb
2022-01-16 11:07:57.678  INFO 16 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-revoke-extra, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7ffd75fb
2022-01-16 11:07:57.730  INFO 16 --- [https-jsse-nio-7071-exec-6] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18909728674029259-886339, decision=PERMIT, pdp-result=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}})
2022-01-16 11:07:57.730  INFO 16 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=81797f41-5887-406b-81d2-dd914e305760, content=PERMIT, timestamp=1642331277730, pdpResult=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}}))
2022-01-16 11:07:57.731  INFO 16 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=157ms, Total=160ms
2022-01-16 11:07:57.757  INFO 16 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=0c40b5a5-0b5b-4312-9cf6-01202b9d5d46, content=null, timestamp=1642331277750, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=50342, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=5fb2fe03fb5a, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=7187b2ea-af71-4106-9885-90a594c75da9, http-req-server-port=80, http-header-accept=*/*, kc-id=6b662965-9581-452d-9a8e-efb17f194ea0, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642331277748, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeP9sHNxAH4AEQAAAABh4/yEdAAkNmI2NjI5NjUtOTU4MS00NTJkLTlhOGUtZWZiMTdmMTk0ZWEwdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ3MTg3YjJlYS1hZjcxLTQxMDYtOTg4NS05MGE1OTRjNzVkYTlwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICI2cGUwZ2U1ck0zU2E2SUt5WXBsLTVkQTZrVXVleWo3X1psV2c1aDU4MmFvIn0.eyJleHAiOjE2NDIzMzE1NjgsImlhdCI6MTY0MjMzMTI2OCwianRpIjoiNmI2NjI5NjUtOTU4MS00NTJkLTlhOGUtZWZiMTdmMTk0ZWEwIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiI3MTg3YjJlYS1hZjcxLTQxMDYtOTg4NS05MGE1OTRjNzVkYTkiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.omg8lBi8aYXNKFtyz-59LVSg2a2tCMxJ-pijDZk_PJuP3t0KLP9mK065sgr18j9RRLlhB5Gz2kgicFArxHtivEl0gUXu61vDMI1JwNX-iJP3IW1nOuz1niWS06XTsBAs3FLboN9JCzCrlyLSB7kFOSKNyr9gnqXqesWQU1H_s6k9aowpZ2V4aNEsojTx4jRXH2wCNB77m23zlaTQfbhQx_Hi4ZBiiOFCmRXadXaP0PC2LKecdNH4x8WAIIR9Jxwe-mzphLjj5_er637GhiPlR7lUQk9Yn4L72NWb6IEYvcz5_B5E73AFiU_xFR5kcOBPp-wTl_8-LRcBhxSaV9WLrA, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642331568, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.48.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=C66D9BBDC2792AB0CC4FB78332568395, http-session-last-accessed-time=1642331277748, kc-category-name=ACCESS, kc-iat=1642331268, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:50342 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:07:57.759  INFO 16 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:07:57.760  INFO 16 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@46c55a1c
2022-01-16 11:07:57.760  INFO 16 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@46c55a1c
2022-01-16 11:07:57.771  INFO 16 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@46c55a1c
2022-01-16 11:07:57.771  INFO 16 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@46c55a1c
2022-01-16 11:07:57.779  INFO 16 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@46c55a1c
2022-01-16 11:07:57.779  WARN 16 --- [https-jsse-nio-7071-exec-7] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:07:57.779  WARN 16 --- [https-jsse-nio-7071-exec-7] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:07:57.779  INFO 16 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@46c55a1c
2022-01-16 11:07:57.780  INFO 16 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@46c55a1c
2022-01-16 11:07:57.780  WARN 16 --- [https-jsse-nio-7071-exec-7] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:07:57.780  WARN 16 --- [https-jsse-nio-7071-exec-7] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:07:57.780  INFO 16 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@46c55a1c
2022-01-16 11:07:57.829  INFO 16 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: emergency-active, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@46c55a1c
2022-01-16 11:07:57.847  INFO 16 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@46c55a1c
2022-01-16 11:07:57.847  INFO 16 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@46c55a1c
2022-01-16 11:07:57.858  INFO 16 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@46c55a1c
2022-01-16 11:07:57.858  INFO 16 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-revoke-extra, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@46c55a1c
2022-01-16 11:07:57.910  INFO 16 --- [https-jsse-nio-7071-exec-7] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18909728860146575-552844, decision=PERMIT, pdp-result=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}})
2022-01-16 11:07:57.910  INFO 16 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=0c40b5a5-0b5b-4312-9cf6-01202b9d5d46, content=PERMIT, timestamp=1642331277910, pdpResult=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}}))
2022-01-16 11:07:57.911  INFO 16 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=151ms, Total=157ms
2022-01-16 11:07:57.934  INFO 16 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=e3aea77f-56c3-4867-8525-203131ff1101, content=null, timestamp=1642331277930, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=50344, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=5fb2fe03fb5a, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=7187b2ea-af71-4106-9885-90a594c75da9, http-req-server-port=80, http-header-accept=*/*, kc-id=6b662965-9581-452d-9a8e-efb17f194ea0, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642331277929, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeP9sHNxAH4AEQAAAABh4/yEdAAkNmI2NjI5NjUtOTU4MS00NTJkLTlhOGUtZWZiMTdmMTk0ZWEwdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ3MTg3YjJlYS1hZjcxLTQxMDYtOTg4NS05MGE1OTRjNzVkYTlwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICI2cGUwZ2U1ck0zU2E2SUt5WXBsLTVkQTZrVXVleWo3X1psV2c1aDU4MmFvIn0.eyJleHAiOjE2NDIzMzE1NjgsImlhdCI6MTY0MjMzMTI2OCwianRpIjoiNmI2NjI5NjUtOTU4MS00NTJkLTlhOGUtZWZiMTdmMTk0ZWEwIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiI3MTg3YjJlYS1hZjcxLTQxMDYtOTg4NS05MGE1OTRjNzVkYTkiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.omg8lBi8aYXNKFtyz-59LVSg2a2tCMxJ-pijDZk_PJuP3t0KLP9mK065sgr18j9RRLlhB5Gz2kgicFArxHtivEl0gUXu61vDMI1JwNX-iJP3IW1nOuz1niWS06XTsBAs3FLboN9JCzCrlyLSB7kFOSKNyr9gnqXqesWQU1H_s6k9aowpZ2V4aNEsojTx4jRXH2wCNB77m23zlaTQfbhQx_Hi4ZBiiOFCmRXadXaP0PC2LKecdNH4x8WAIIR9Jxwe-mzphLjj5_er637GhiPlR7lUQk9Yn4L72NWb6IEYvcz5_B5E73AFiU_xFR5kcOBPp-wTl_8-LRcBhxSaV9WLrA, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642331568, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.48.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=0C799CF4915FC711ECC7744688DF8CD1, http-session-last-accessed-time=1642331277929, kc-category-name=ACCESS, kc-iat=1642331268, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:50344 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:07:57.935  INFO 16 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:07:57.936  INFO 16 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4c3df1ad
2022-01-16 11:07:57.936  INFO 16 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4c3df1ad
2022-01-16 11:07:57.950  INFO 16 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4c3df1ad
2022-01-16 11:07:57.950  INFO 16 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4c3df1ad
2022-01-16 11:07:57.964  INFO 16 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4c3df1ad
2022-01-16 11:07:57.964  WARN 16 --- [https-jsse-nio-7071-exec-8] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:07:57.964  WARN 16 --- [https-jsse-nio-7071-exec-8] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:07:57.964  INFO 16 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4c3df1ad
2022-01-16 11:07:57.965  INFO 16 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4c3df1ad
2022-01-16 11:07:57.965  WARN 16 --- [https-jsse-nio-7071-exec-8] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:07:57.965  WARN 16 --- [https-jsse-nio-7071-exec-8] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:07:57.966  INFO 16 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4c3df1ad
2022-01-16 11:07:58.021  INFO 16 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: emergency-active, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4c3df1ad
2022-01-16 11:07:58.036  INFO 16 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4c3df1ad
2022-01-16 11:07:58.036  INFO 16 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4c3df1ad
2022-01-16 11:07:58.051  INFO 16 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4c3df1ad
2022-01-16 11:07:58.051  INFO 16 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-revoke-extra, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4c3df1ad
2022-01-16 11:07:58.106  INFO 16 --- [https-jsse-nio-7071-exec-8] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18909729036338187-559439, decision=PERMIT, pdp-result=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}})
2022-01-16 11:07:58.106  INFO 16 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=e3aea77f-56c3-4867-8525-203131ff1101, content=PERMIT, timestamp=1642331278106, pdpResult=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}}))
2022-01-16 11:07:58.106  INFO 16 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=171ms, Total=173ms
2022-01-16 11:07:58.131  INFO 16 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=07f28216-cee5-41fa-8cfb-1dd46645ab57, content=null, timestamp=1642331278126, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=50346, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=5fb2fe03fb5a, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=7187b2ea-af71-4106-9885-90a594c75da9, http-req-server-port=80, http-header-accept=*/*, kc-id=6b662965-9581-452d-9a8e-efb17f194ea0, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642331278125, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeP9sHNxAH4AEQAAAABh4/yEdAAkNmI2NjI5NjUtOTU4MS00NTJkLTlhOGUtZWZiMTdmMTk0ZWEwdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ3MTg3YjJlYS1hZjcxLTQxMDYtOTg4NS05MGE1OTRjNzVkYTlwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICI2cGUwZ2U1ck0zU2E2SUt5WXBsLTVkQTZrVXVleWo3X1psV2c1aDU4MmFvIn0.eyJleHAiOjE2NDIzMzE1NjgsImlhdCI6MTY0MjMzMTI2OCwianRpIjoiNmI2NjI5NjUtOTU4MS00NTJkLTlhOGUtZWZiMTdmMTk0ZWEwIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiI3MTg3YjJlYS1hZjcxLTQxMDYtOTg4NS05MGE1OTRjNzVkYTkiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.omg8lBi8aYXNKFtyz-59LVSg2a2tCMxJ-pijDZk_PJuP3t0KLP9mK065sgr18j9RRLlhB5Gz2kgicFArxHtivEl0gUXu61vDMI1JwNX-iJP3IW1nOuz1niWS06XTsBAs3FLboN9JCzCrlyLSB7kFOSKNyr9gnqXqesWQU1H_s6k9aowpZ2V4aNEsojTx4jRXH2wCNB77m23zlaTQfbhQx_Hi4ZBiiOFCmRXadXaP0PC2LKecdNH4x8WAIIR9Jxwe-mzphLjj5_er637GhiPlR7lUQk9Yn4L72NWb6IEYvcz5_B5E73AFiU_xFR5kcOBPp-wTl_8-LRcBhxSaV9WLrA, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642331568, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.48.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=E05FBF0E6CD32349298B332B95BC8044, http-session-last-accessed-time=1642331278125, kc-category-name=ACCESS, kc-iat=1642331268, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:50346 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:07:58.132  INFO 16 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:07:58.133  INFO 16 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5665c110
2022-01-16 11:07:58.133  INFO 16 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5665c110
2022-01-16 11:07:58.144  INFO 16 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5665c110
2022-01-16 11:07:58.144  INFO 16 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5665c110
2022-01-16 11:07:58.153  INFO 16 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5665c110
2022-01-16 11:07:58.153  WARN 16 --- [https-jsse-nio-7071-exec-9] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:07:58.153  WARN 16 --- [https-jsse-nio-7071-exec-9] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:07:58.153  INFO 16 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5665c110
2022-01-16 11:07:58.153  INFO 16 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5665c110
2022-01-16 11:07:58.153  WARN 16 --- [https-jsse-nio-7071-exec-9] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:07:58.153  WARN 16 --- [https-jsse-nio-7071-exec-9] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:07:58.153  INFO 16 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5665c110
2022-01-16 11:07:58.209  INFO 16 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: emergency-active, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5665c110
2022-01-16 11:07:58.222  INFO 16 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5665c110
2022-01-16 11:07:58.222  INFO 16 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5665c110
2022-01-16 11:07:58.232  INFO 16 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5665c110
2022-01-16 11:07:58.232  INFO 16 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-revoke-extra, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5665c110
2022-01-16 11:07:58.282  INFO 16 --- [https-jsse-nio-7071-exec-9] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18909729233183648-478811, decision=PERMIT, pdp-result=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}})
2022-01-16 11:07:58.283  INFO 16 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=07f28216-cee5-41fa-8cfb-1dd46645ab57, content=PERMIT, timestamp=1642331278283, pdpResult=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}}))
2022-01-16 11:07:58.283  INFO 16 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=151ms, Total=153ms
2022-01-16 11:07:58.314  INFO 16 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=e0bc4696-c70d-4392-a17b-ee39d8223fe2, content=null, timestamp=1642331278309, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=50348, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=5fb2fe03fb5a, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=7187b2ea-af71-4106-9885-90a594c75da9, http-req-server-port=80, http-header-accept=*/*, kc-id=6b662965-9581-452d-9a8e-efb17f194ea0, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642331278307, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeP9sHNxAH4AEQAAAABh4/yEdAAkNmI2NjI5NjUtOTU4MS00NTJkLTlhOGUtZWZiMTdmMTk0ZWEwdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ3MTg3YjJlYS1hZjcxLTQxMDYtOTg4NS05MGE1OTRjNzVkYTlwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICI2cGUwZ2U1ck0zU2E2SUt5WXBsLTVkQTZrVXVleWo3X1psV2c1aDU4MmFvIn0.eyJleHAiOjE2NDIzMzE1NjgsImlhdCI6MTY0MjMzMTI2OCwianRpIjoiNmI2NjI5NjUtOTU4MS00NTJkLTlhOGUtZWZiMTdmMTk0ZWEwIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiI3MTg3YjJlYS1hZjcxLTQxMDYtOTg4NS05MGE1OTRjNzVkYTkiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.omg8lBi8aYXNKFtyz-59LVSg2a2tCMxJ-pijDZk_PJuP3t0KLP9mK065sgr18j9RRLlhB5Gz2kgicFArxHtivEl0gUXu61vDMI1JwNX-iJP3IW1nOuz1niWS06XTsBAs3FLboN9JCzCrlyLSB7kFOSKNyr9gnqXqesWQU1H_s6k9aowpZ2V4aNEsojTx4jRXH2wCNB77m23zlaTQfbhQx_Hi4ZBiiOFCmRXadXaP0PC2LKecdNH4x8WAIIR9Jxwe-mzphLjj5_er637GhiPlR7lUQk9Yn4L72NWb6IEYvcz5_B5E73AFiU_xFR5kcOBPp-wTl_8-LRcBhxSaV9WLrA, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642331568, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.48.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=78632D8950DE4328AA909C0CE702AB3C, http-session-last-accessed-time=1642331278307, kc-category-name=ACCESS, kc-iat=1642331268, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:50348 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:07:58.314  INFO 16 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:07:58.315  INFO 16 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3b5127e1
2022-01-16 11:07:58.315  INFO 16 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3b5127e1
2022-01-16 11:07:58.325  INFO 16 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3b5127e1
2022-01-16 11:07:58.326  INFO 16 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3b5127e1
2022-01-16 11:07:58.335  INFO 16 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3b5127e1
2022-01-16 11:07:58.335  WARN 16 --- [https-jsse-nio-7071-exec-10] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:07:58.335  WARN 16 --- [https-jsse-nio-7071-exec-10] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:07:58.335  INFO 16 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3b5127e1
2022-01-16 11:07:58.336  INFO 16 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3b5127e1
2022-01-16 11:07:58.336  WARN 16 --- [https-jsse-nio-7071-exec-10] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:07:58.337  WARN 16 --- [https-jsse-nio-7071-exec-10] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:07:58.337  INFO 16 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3b5127e1
2022-01-16 11:07:58.389  INFO 16 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: emergency-active, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3b5127e1
2022-01-16 11:07:58.407  INFO 16 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3b5127e1
2022-01-16 11:07:58.407  INFO 16 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3b5127e1
2022-01-16 11:07:58.423  INFO 16 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3b5127e1
2022-01-16 11:07:58.423  INFO 16 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-revoke-extra, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3b5127e1
2022-01-16 11:07:58.486  INFO 16 --- [https-jsse-nio-7071-exec-10] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18909729415522745-327516, decision=PERMIT, pdp-result=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}})
2022-01-16 11:07:58.487  INFO 16 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=e0bc4696-c70d-4392-a17b-ee39d8223fe2, content=PERMIT, timestamp=1642331278487, pdpResult=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}}))
2022-01-16 11:07:58.488  INFO 16 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=173ms, Total=176ms
2022-01-16 11:07:58.513  INFO 16 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=2a5156df-4a70-48b2-924d-8bc357257711, content=null, timestamp=1642331278507, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=50350, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=5fb2fe03fb5a, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=7187b2ea-af71-4106-9885-90a594c75da9, http-req-server-port=80, http-header-accept=*/*, kc-id=6b662965-9581-452d-9a8e-efb17f194ea0, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642331278505, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeP9sHNxAH4AEQAAAABh4/yEdAAkNmI2NjI5NjUtOTU4MS00NTJkLTlhOGUtZWZiMTdmMTk0ZWEwdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ3MTg3YjJlYS1hZjcxLTQxMDYtOTg4NS05MGE1OTRjNzVkYTlwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICI2cGUwZ2U1ck0zU2E2SUt5WXBsLTVkQTZrVXVleWo3X1psV2c1aDU4MmFvIn0.eyJleHAiOjE2NDIzMzE1NjgsImlhdCI6MTY0MjMzMTI2OCwianRpIjoiNmI2NjI5NjUtOTU4MS00NTJkLTlhOGUtZWZiMTdmMTk0ZWEwIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiI3MTg3YjJlYS1hZjcxLTQxMDYtOTg4NS05MGE1OTRjNzVkYTkiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.omg8lBi8aYXNKFtyz-59LVSg2a2tCMxJ-pijDZk_PJuP3t0KLP9mK065sgr18j9RRLlhB5Gz2kgicFArxHtivEl0gUXu61vDMI1JwNX-iJP3IW1nOuz1niWS06XTsBAs3FLboN9JCzCrlyLSB7kFOSKNyr9gnqXqesWQU1H_s6k9aowpZ2V4aNEsojTx4jRXH2wCNB77m23zlaTQfbhQx_Hi4ZBiiOFCmRXadXaP0PC2LKecdNH4x8WAIIR9Jxwe-mzphLjj5_er637GhiPlR7lUQk9Yn4L72NWb6IEYvcz5_B5E73AFiU_xFR5kcOBPp-wTl_8-LRcBhxSaV9WLrA, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642331568, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.48.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=0A057F2894E606AC2EA267DBB3F07F9A, http-session-last-accessed-time=1642331278505, kc-category-name=ACCESS, kc-iat=1642331268, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:50350 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:07:58.515  INFO 16 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:07:58.515  INFO 16 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@553b85c8
2022-01-16 11:07:58.516  INFO 16 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@553b85c8
2022-01-16 11:07:58.531  INFO 16 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@553b85c8
2022-01-16 11:07:58.531  INFO 16 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@553b85c8
2022-01-16 11:07:58.541  INFO 16 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@553b85c8
2022-01-16 11:07:58.542  WARN 16 --- [https-jsse-nio-7071-exec-1] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:07:58.542  WARN 16 --- [https-jsse-nio-7071-exec-1] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:07:58.542  INFO 16 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@553b85c8
2022-01-16 11:07:58.543  INFO 16 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@553b85c8
2022-01-16 11:07:58.543  WARN 16 --- [https-jsse-nio-7071-exec-1] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:07:58.543  WARN 16 --- [https-jsse-nio-7071-exec-1] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:07:58.543  INFO 16 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@553b85c8
2022-01-16 11:07:58.593  INFO 16 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: emergency-active, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@553b85c8
2022-01-16 11:07:58.602  INFO 16 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@553b85c8
2022-01-16 11:07:58.602  INFO 16 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@553b85c8
2022-01-16 11:07:58.612  INFO 16 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@553b85c8
2022-01-16 11:07:58.612  INFO 16 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-revoke-extra, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@553b85c8
2022-01-16 11:07:58.666  INFO 16 --- [https-jsse-nio-7071-exec-1] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18909729616207620-167782, decision=PERMIT, pdp-result=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}})
2022-01-16 11:07:58.667  INFO 16 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=2a5156df-4a70-48b2-924d-8bc357257711, content=PERMIT, timestamp=1642331278667, pdpResult=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}}))
2022-01-16 11:07:58.668  INFO 16 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=152ms, Total=156ms
2022-01-16 11:07:58.692  INFO 16 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=d913b597-71f9-469e-bc82-fdf36a412829, content=null, timestamp=1642331278686, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=50352, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=5fb2fe03fb5a, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=7187b2ea-af71-4106-9885-90a594c75da9, http-req-server-port=80, http-header-accept=*/*, kc-id=6b662965-9581-452d-9a8e-efb17f194ea0, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642331278684, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeP9sHNxAH4AEQAAAABh4/yEdAAkNmI2NjI5NjUtOTU4MS00NTJkLTlhOGUtZWZiMTdmMTk0ZWEwdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ3MTg3YjJlYS1hZjcxLTQxMDYtOTg4NS05MGE1OTRjNzVkYTlwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICI2cGUwZ2U1ck0zU2E2SUt5WXBsLTVkQTZrVXVleWo3X1psV2c1aDU4MmFvIn0.eyJleHAiOjE2NDIzMzE1NjgsImlhdCI6MTY0MjMzMTI2OCwianRpIjoiNmI2NjI5NjUtOTU4MS00NTJkLTlhOGUtZWZiMTdmMTk0ZWEwIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiI3MTg3YjJlYS1hZjcxLTQxMDYtOTg4NS05MGE1OTRjNzVkYTkiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.omg8lBi8aYXNKFtyz-59LVSg2a2tCMxJ-pijDZk_PJuP3t0KLP9mK065sgr18j9RRLlhB5Gz2kgicFArxHtivEl0gUXu61vDMI1JwNX-iJP3IW1nOuz1niWS06XTsBAs3FLboN9JCzCrlyLSB7kFOSKNyr9gnqXqesWQU1H_s6k9aowpZ2V4aNEsojTx4jRXH2wCNB77m23zlaTQfbhQx_Hi4ZBiiOFCmRXadXaP0PC2LKecdNH4x8WAIIR9Jxwe-mzphLjj5_er637GhiPlR7lUQk9Yn4L72NWb6IEYvcz5_B5E73AFiU_xFR5kcOBPp-wTl_8-LRcBhxSaV9WLrA, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642331568, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.48.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=DBCBFCDB4684CDFE39804B626156346D, http-session-last-accessed-time=1642331278684, kc-category-name=ACCESS, kc-iat=1642331268, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:50352 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:07:58.692  INFO 16 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:07:58.694  INFO 16 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6a4df33d
2022-01-16 11:07:58.694  INFO 16 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6a4df33d
2022-01-16 11:07:58.704  INFO 16 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6a4df33d
2022-01-16 11:07:58.704  INFO 16 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6a4df33d
2022-01-16 11:07:58.713  INFO 16 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6a4df33d
2022-01-16 11:07:58.713  WARN 16 --- [https-jsse-nio-7071-exec-2] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:07:58.713  WARN 16 --- [https-jsse-nio-7071-exec-2] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:07:58.713  INFO 16 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6a4df33d
2022-01-16 11:07:58.714  INFO 16 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6a4df33d
2022-01-16 11:07:58.714  WARN 16 --- [https-jsse-nio-7071-exec-2] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:07:58.715  WARN 16 --- [https-jsse-nio-7071-exec-2] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:07:58.715  INFO 16 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6a4df33d
2022-01-16 11:07:58.769  INFO 16 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: emergency-active, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6a4df33d
2022-01-16 11:07:58.783  INFO 16 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6a4df33d
2022-01-16 11:07:58.783  INFO 16 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6a4df33d
2022-01-16 11:07:58.795  INFO 16 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6a4df33d
2022-01-16 11:07:58.795  INFO 16 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-revoke-extra, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6a4df33d
2022-01-16 11:07:58.846  INFO 16 --- [https-jsse-nio-7071-exec-2] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18909729793945971-438408, decision=PERMIT, pdp-result=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}})
2022-01-16 11:07:58.846  INFO 16 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=d913b597-71f9-469e-bc82-fdf36a412829, content=PERMIT, timestamp=1642331278846, pdpResult=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}}))
2022-01-16 11:07:58.848  INFO 16 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=154ms, Total=158ms
2022-01-16 11:07:58.876  INFO 16 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=8adf97e5-5870-40d2-b4ca-fc0dcd198c33, content=null, timestamp=1642331278869, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=50354, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=5fb2fe03fb5a, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=7187b2ea-af71-4106-9885-90a594c75da9, http-req-server-port=80, http-header-accept=*/*, kc-id=6b662965-9581-452d-9a8e-efb17f194ea0, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642331278866, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeP9sHNxAH4AEQAAAABh4/yEdAAkNmI2NjI5NjUtOTU4MS00NTJkLTlhOGUtZWZiMTdmMTk0ZWEwdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ3MTg3YjJlYS1hZjcxLTQxMDYtOTg4NS05MGE1OTRjNzVkYTlwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICI2cGUwZ2U1ck0zU2E2SUt5WXBsLTVkQTZrVXVleWo3X1psV2c1aDU4MmFvIn0.eyJleHAiOjE2NDIzMzE1NjgsImlhdCI6MTY0MjMzMTI2OCwianRpIjoiNmI2NjI5NjUtOTU4MS00NTJkLTlhOGUtZWZiMTdmMTk0ZWEwIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiI3MTg3YjJlYS1hZjcxLTQxMDYtOTg4NS05MGE1OTRjNzVkYTkiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.omg8lBi8aYXNKFtyz-59LVSg2a2tCMxJ-pijDZk_PJuP3t0KLP9mK065sgr18j9RRLlhB5Gz2kgicFArxHtivEl0gUXu61vDMI1JwNX-iJP3IW1nOuz1niWS06XTsBAs3FLboN9JCzCrlyLSB7kFOSKNyr9gnqXqesWQU1H_s6k9aowpZ2V4aNEsojTx4jRXH2wCNB77m23zlaTQfbhQx_Hi4ZBiiOFCmRXadXaP0PC2LKecdNH4x8WAIIR9Jxwe-mzphLjj5_er637GhiPlR7lUQk9Yn4L72NWb6IEYvcz5_B5E73AFiU_xFR5kcOBPp-wTl_8-LRcBhxSaV9WLrA, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642331568, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.48.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=4DDA2099E4204CD6B4B69C78C3562DA3, http-session-last-accessed-time=1642331278866, kc-category-name=ACCESS, kc-iat=1642331268, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:50354 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:07:58.876  INFO 16 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:07:58.878  INFO 16 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2a456678
2022-01-16 11:07:58.878  INFO 16 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2a456678
2022-01-16 11:07:58.889  INFO 16 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2a456678
2022-01-16 11:07:58.889  INFO 16 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2a456678
2022-01-16 11:07:58.900  INFO 16 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2a456678
2022-01-16 11:07:58.900  WARN 16 --- [https-jsse-nio-7071-exec-3] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:07:58.900  WARN 16 --- [https-jsse-nio-7071-exec-3] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:07:58.900  INFO 16 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2a456678
2022-01-16 11:07:58.900  INFO 16 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2a456678
2022-01-16 11:07:58.901  WARN 16 --- [https-jsse-nio-7071-exec-3] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:07:58.915  WARN 16 --- [https-jsse-nio-7071-exec-3] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:07:58.916  INFO 16 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2a456678
2022-01-16 11:07:58.974  INFO 16 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: emergency-active, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2a456678
2022-01-16 11:07:58.987  INFO 16 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2a456678
2022-01-16 11:07:58.988  INFO 16 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2a456678
2022-01-16 11:07:59.001  INFO 16 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2a456678
2022-01-16 11:07:59.001  INFO 16 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-revoke-extra, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2a456678
2022-01-16 11:07:59.054  INFO 16 --- [https-jsse-nio-7071-exec-3] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18909729978603776-379746, decision=PERMIT, pdp-result=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}})
2022-01-16 11:07:59.054  INFO 16 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=8adf97e5-5870-40d2-b4ca-fc0dcd198c33, content=PERMIT, timestamp=1642331279054, pdpResult=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}}))
2022-01-16 11:07:59.055  INFO 16 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=177ms, Total=180ms
2022-01-16 11:07:59.082  INFO 16 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=ff138418-e9a5-4e4c-90ba-b3e1b7d52a27, content=null, timestamp=1642331279076, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=50356, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=5fb2fe03fb5a, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=7187b2ea-af71-4106-9885-90a594c75da9, http-req-server-port=80, http-header-accept=*/*, kc-id=6b662965-9581-452d-9a8e-efb17f194ea0, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642331279074, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeP9sHNxAH4AEQAAAABh4/yEdAAkNmI2NjI5NjUtOTU4MS00NTJkLTlhOGUtZWZiMTdmMTk0ZWEwdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ3MTg3YjJlYS1hZjcxLTQxMDYtOTg4NS05MGE1OTRjNzVkYTlwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICI2cGUwZ2U1ck0zU2E2SUt5WXBsLTVkQTZrVXVleWo3X1psV2c1aDU4MmFvIn0.eyJleHAiOjE2NDIzMzE1NjgsImlhdCI6MTY0MjMzMTI2OCwianRpIjoiNmI2NjI5NjUtOTU4MS00NTJkLTlhOGUtZWZiMTdmMTk0ZWEwIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiI3MTg3YjJlYS1hZjcxLTQxMDYtOTg4NS05MGE1OTRjNzVkYTkiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.omg8lBi8aYXNKFtyz-59LVSg2a2tCMxJ-pijDZk_PJuP3t0KLP9mK065sgr18j9RRLlhB5Gz2kgicFArxHtivEl0gUXu61vDMI1JwNX-iJP3IW1nOuz1niWS06XTsBAs3FLboN9JCzCrlyLSB7kFOSKNyr9gnqXqesWQU1H_s6k9aowpZ2V4aNEsojTx4jRXH2wCNB77m23zlaTQfbhQx_Hi4ZBiiOFCmRXadXaP0PC2LKecdNH4x8WAIIR9Jxwe-mzphLjj5_er637GhiPlR7lUQk9Yn4L72NWb6IEYvcz5_B5E73AFiU_xFR5kcOBPp-wTl_8-LRcBhxSaV9WLrA, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642331568, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.48.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=CB9F1CBD977A04FC792C163431FCD03D, http-session-last-accessed-time=1642331279074, kc-category-name=ACCESS, kc-iat=1642331268, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:50356 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:07:59.082  INFO 16 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:07:59.083  INFO 16 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1048109e
2022-01-16 11:07:59.083  INFO 16 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1048109e
2022-01-16 11:07:59.097  INFO 16 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1048109e
2022-01-16 11:07:59.097  INFO 16 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1048109e
2022-01-16 11:07:59.110  INFO 16 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1048109e
2022-01-16 11:07:59.110  WARN 16 --- [https-jsse-nio-7071-exec-4] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:07:59.111  WARN 16 --- [https-jsse-nio-7071-exec-4] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:07:59.112  INFO 16 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1048109e
2022-01-16 11:07:59.112  INFO 16 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1048109e
2022-01-16 11:07:59.113  WARN 16 --- [https-jsse-nio-7071-exec-4] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:07:59.113  WARN 16 --- [https-jsse-nio-7071-exec-4] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:07:59.114  INFO 16 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1048109e
2022-01-16 11:07:59.173  INFO 16 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: emergency-active, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1048109e
2022-01-16 11:07:59.190  INFO 16 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1048109e
2022-01-16 11:07:59.190  INFO 16 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1048109e
2022-01-16 11:07:59.198  INFO 16 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1048109e
2022-01-16 11:07:59.199  INFO 16 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-revoke-extra, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1048109e
2022-01-16 11:07:59.254  INFO 16 --- [https-jsse-nio-7071-exec-4] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18909730183540437-978354, decision=PERMIT, pdp-result=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}})
2022-01-16 11:07:59.255  INFO 16 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=ff138418-e9a5-4e4c-90ba-b3e1b7d52a27, content=PERMIT, timestamp=1642331279255, pdpResult=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}}))
2022-01-16 11:07:59.255  INFO 16 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=173ms, Total=175ms
2022-01-16 11:07:59.276  INFO 16 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=7674eb3f-a3f6-40c5-8ff9-0799e13e342a, content=null, timestamp=1642331279270, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=50358, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=5fb2fe03fb5a, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=7187b2ea-af71-4106-9885-90a594c75da9, http-req-server-port=80, http-header-accept=*/*, kc-id=6b662965-9581-452d-9a8e-efb17f194ea0, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642331279269, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeP9sHNxAH4AEQAAAABh4/yEdAAkNmI2NjI5NjUtOTU4MS00NTJkLTlhOGUtZWZiMTdmMTk0ZWEwdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ3MTg3YjJlYS1hZjcxLTQxMDYtOTg4NS05MGE1OTRjNzVkYTlwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICI2cGUwZ2U1ck0zU2E2SUt5WXBsLTVkQTZrVXVleWo3X1psV2c1aDU4MmFvIn0.eyJleHAiOjE2NDIzMzE1NjgsImlhdCI6MTY0MjMzMTI2OCwianRpIjoiNmI2NjI5NjUtOTU4MS00NTJkLTlhOGUtZWZiMTdmMTk0ZWEwIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiI3MTg3YjJlYS1hZjcxLTQxMDYtOTg4NS05MGE1OTRjNzVkYTkiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.omg8lBi8aYXNKFtyz-59LVSg2a2tCMxJ-pijDZk_PJuP3t0KLP9mK065sgr18j9RRLlhB5Gz2kgicFArxHtivEl0gUXu61vDMI1JwNX-iJP3IW1nOuz1niWS06XTsBAs3FLboN9JCzCrlyLSB7kFOSKNyr9gnqXqesWQU1H_s6k9aowpZ2V4aNEsojTx4jRXH2wCNB77m23zlaTQfbhQx_Hi4ZBiiOFCmRXadXaP0PC2LKecdNH4x8WAIIR9Jxwe-mzphLjj5_er637GhiPlR7lUQk9Yn4L72NWb6IEYvcz5_B5E73AFiU_xFR5kcOBPp-wTl_8-LRcBhxSaV9WLrA, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642331568, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.48.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=1F69C149E9C4D4D9F0A2CE33293A013E, http-session-last-accessed-time=1642331279269, kc-category-name=ACCESS, kc-iat=1642331268, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:50358 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:07:59.277  INFO 16 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:07:59.279  INFO 16 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@20e2ef85
2022-01-16 11:07:59.279  INFO 16 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@20e2ef85
2022-01-16 11:07:59.291  INFO 16 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@20e2ef85
2022-01-16 11:07:59.291  INFO 16 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@20e2ef85
2022-01-16 11:07:59.300  INFO 16 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@20e2ef85
2022-01-16 11:07:59.301  WARN 16 --- [https-jsse-nio-7071-exec-5] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:07:59.301  WARN 16 --- [https-jsse-nio-7071-exec-5] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:07:59.301  INFO 16 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@20e2ef85
2022-01-16 11:07:59.302  INFO 16 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@20e2ef85
2022-01-16 11:07:59.302  WARN 16 --- [https-jsse-nio-7071-exec-5] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:07:59.302  WARN 16 --- [https-jsse-nio-7071-exec-5] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:07:59.302  INFO 16 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@20e2ef85
2022-01-16 11:07:59.353  INFO 16 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: emergency-active, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@20e2ef85
2022-01-16 11:07:59.369  INFO 16 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@20e2ef85
2022-01-16 11:07:59.370  INFO 16 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@20e2ef85
2022-01-16 11:07:59.378  INFO 16 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@20e2ef85
2022-01-16 11:07:59.378  INFO 16 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-revoke-extra, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@20e2ef85
2022-01-16 11:07:59.426  INFO 16 --- [https-jsse-nio-7071-exec-5] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18909730379154359-617862, decision=PERMIT, pdp-result=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}})
2022-01-16 11:07:59.426  INFO 16 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=7674eb3f-a3f6-40c5-8ff9-0799e13e342a, content=PERMIT, timestamp=1642331279426, pdpResult=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}}))
2022-01-16 11:07:59.428  INFO 16 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=148ms, Total=154ms
2022-01-16 11:07:59.450  INFO 16 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=005b297d-84c8-4456-87d6-f31f9c2289b6, content=null, timestamp=1642331279445, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=50360, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=5fb2fe03fb5a, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=7187b2ea-af71-4106-9885-90a594c75da9, http-req-server-port=80, http-header-accept=*/*, kc-id=6b662965-9581-452d-9a8e-efb17f194ea0, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642331279444, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeP9sHNxAH4AEQAAAABh4/yEdAAkNmI2NjI5NjUtOTU4MS00NTJkLTlhOGUtZWZiMTdmMTk0ZWEwdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ3MTg3YjJlYS1hZjcxLTQxMDYtOTg4NS05MGE1OTRjNzVkYTlwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICI2cGUwZ2U1ck0zU2E2SUt5WXBsLTVkQTZrVXVleWo3X1psV2c1aDU4MmFvIn0.eyJleHAiOjE2NDIzMzE1NjgsImlhdCI6MTY0MjMzMTI2OCwianRpIjoiNmI2NjI5NjUtOTU4MS00NTJkLTlhOGUtZWZiMTdmMTk0ZWEwIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiI3MTg3YjJlYS1hZjcxLTQxMDYtOTg4NS05MGE1OTRjNzVkYTkiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.omg8lBi8aYXNKFtyz-59LVSg2a2tCMxJ-pijDZk_PJuP3t0KLP9mK065sgr18j9RRLlhB5Gz2kgicFArxHtivEl0gUXu61vDMI1JwNX-iJP3IW1nOuz1niWS06XTsBAs3FLboN9JCzCrlyLSB7kFOSKNyr9gnqXqesWQU1H_s6k9aowpZ2V4aNEsojTx4jRXH2wCNB77m23zlaTQfbhQx_Hi4ZBiiOFCmRXadXaP0PC2LKecdNH4x8WAIIR9Jxwe-mzphLjj5_er637GhiPlR7lUQk9Yn4L72NWb6IEYvcz5_B5E73AFiU_xFR5kcOBPp-wTl_8-LRcBhxSaV9WLrA, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642331568, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.48.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=C1972706F597895E49E1AF3D49F071E0, http-session-last-accessed-time=1642331279444, kc-category-name=ACCESS, kc-iat=1642331268, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:50360 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:07:59.450  INFO 16 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:07:59.451  INFO 16 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@647ba69c
2022-01-16 11:07:59.451  INFO 16 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@647ba69c
2022-01-16 11:07:59.461  INFO 16 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@647ba69c
2022-01-16 11:07:59.462  INFO 16 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@647ba69c
2022-01-16 11:07:59.469  INFO 16 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@647ba69c
2022-01-16 11:07:59.469  WARN 16 --- [https-jsse-nio-7071-exec-6] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:07:59.469  WARN 16 --- [https-jsse-nio-7071-exec-6] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:07:59.469  INFO 16 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@647ba69c
2022-01-16 11:07:59.470  INFO 16 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@647ba69c
2022-01-16 11:07:59.470  WARN 16 --- [https-jsse-nio-7071-exec-6] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:07:59.470  WARN 16 --- [https-jsse-nio-7071-exec-6] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:07:59.470  INFO 16 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@647ba69c
2022-01-16 11:07:59.521  INFO 16 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: emergency-active, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@647ba69c
2022-01-16 11:07:59.531  INFO 16 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@647ba69c
2022-01-16 11:07:59.531  INFO 16 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@647ba69c
2022-01-16 11:07:59.540  INFO 16 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@647ba69c
2022-01-16 11:07:59.540  INFO 16 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-revoke-extra, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@647ba69c
2022-01-16 11:07:59.589  INFO 16 --- [https-jsse-nio-7071-exec-6] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18909730551708661-522902, decision=PERMIT, pdp-result=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}})
2022-01-16 11:07:59.590  INFO 16 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=005b297d-84c8-4456-87d6-f31f9c2289b6, content=PERMIT, timestamp=1642331279590, pdpResult=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}}))
2022-01-16 11:07:59.591  INFO 16 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=140ms, Total=143ms
2022-01-16 11:07:59.610  INFO 16 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=09938658-6101-4bf5-9f29-223c2a932a41, content=null, timestamp=1642331279605, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=50362, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=5fb2fe03fb5a, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=7187b2ea-af71-4106-9885-90a594c75da9, http-req-server-port=80, http-header-accept=*/*, kc-id=6b662965-9581-452d-9a8e-efb17f194ea0, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642331279604, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeP9sHNxAH4AEQAAAABh4/yEdAAkNmI2NjI5NjUtOTU4MS00NTJkLTlhOGUtZWZiMTdmMTk0ZWEwdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ3MTg3YjJlYS1hZjcxLTQxMDYtOTg4NS05MGE1OTRjNzVkYTlwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICI2cGUwZ2U1ck0zU2E2SUt5WXBsLTVkQTZrVXVleWo3X1psV2c1aDU4MmFvIn0.eyJleHAiOjE2NDIzMzE1NjgsImlhdCI6MTY0MjMzMTI2OCwianRpIjoiNmI2NjI5NjUtOTU4MS00NTJkLTlhOGUtZWZiMTdmMTk0ZWEwIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiI3MTg3YjJlYS1hZjcxLTQxMDYtOTg4NS05MGE1OTRjNzVkYTkiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.omg8lBi8aYXNKFtyz-59LVSg2a2tCMxJ-pijDZk_PJuP3t0KLP9mK065sgr18j9RRLlhB5Gz2kgicFArxHtivEl0gUXu61vDMI1JwNX-iJP3IW1nOuz1niWS06XTsBAs3FLboN9JCzCrlyLSB7kFOSKNyr9gnqXqesWQU1H_s6k9aowpZ2V4aNEsojTx4jRXH2wCNB77m23zlaTQfbhQx_Hi4ZBiiOFCmRXadXaP0PC2LKecdNH4x8WAIIR9Jxwe-mzphLjj5_er637GhiPlR7lUQk9Yn4L72NWb6IEYvcz5_B5E73AFiU_xFR5kcOBPp-wTl_8-LRcBhxSaV9WLrA, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642331568, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.48.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=E948527A1A4E8B182EB0C33CC1905722, http-session-last-accessed-time=1642331279604, kc-category-name=ACCESS, kc-iat=1642331268, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:50362 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:07:59.610  INFO 16 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:07:59.611  INFO 16 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@26070e64
2022-01-16 11:07:59.611  INFO 16 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@26070e64
2022-01-16 11:07:59.623  INFO 16 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@26070e64
2022-01-16 11:07:59.623  INFO 16 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@26070e64
2022-01-16 11:07:59.632  INFO 16 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@26070e64
2022-01-16 11:07:59.633  WARN 16 --- [https-jsse-nio-7071-exec-7] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:07:59.633  WARN 16 --- [https-jsse-nio-7071-exec-7] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:07:59.633  INFO 16 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@26070e64
2022-01-16 11:07:59.633  INFO 16 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@26070e64
2022-01-16 11:07:59.633  WARN 16 --- [https-jsse-nio-7071-exec-7] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:07:59.633  WARN 16 --- [https-jsse-nio-7071-exec-7] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:07:59.633  INFO 16 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@26070e64
2022-01-16 11:07:59.685  INFO 16 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: emergency-active, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@26070e64
2022-01-16 11:07:59.695  INFO 16 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@26070e64
2022-01-16 11:07:59.696  INFO 16 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@26070e64
2022-01-16 11:07:59.705  INFO 16 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@26070e64
2022-01-16 11:07:59.705  INFO 16 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-revoke-extra, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@26070e64
2022-01-16 11:07:59.758  INFO 16 --- [https-jsse-nio-7071-exec-7] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18909730711909122-98582, decision=PERMIT, pdp-result=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}})
2022-01-16 11:07:59.758  INFO 16 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=09938658-6101-4bf5-9f29-223c2a932a41, content=PERMIT, timestamp=1642331279758, pdpResult=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}}))
2022-01-16 11:07:59.758  INFO 16 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=148ms, Total=149ms
2022-01-16 11:07:59.780  INFO 16 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=b6742361-cc36-42cf-a66c-35f9941c825f, content=null, timestamp=1642331279775, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=50364, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=5fb2fe03fb5a, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=7187b2ea-af71-4106-9885-90a594c75da9, http-req-server-port=80, http-header-accept=*/*, kc-id=6b662965-9581-452d-9a8e-efb17f194ea0, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642331279774, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeP9sHNxAH4AEQAAAABh4/yEdAAkNmI2NjI5NjUtOTU4MS00NTJkLTlhOGUtZWZiMTdmMTk0ZWEwdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ3MTg3YjJlYS1hZjcxLTQxMDYtOTg4NS05MGE1OTRjNzVkYTlwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICI2cGUwZ2U1ck0zU2E2SUt5WXBsLTVkQTZrVXVleWo3X1psV2c1aDU4MmFvIn0.eyJleHAiOjE2NDIzMzE1NjgsImlhdCI6MTY0MjMzMTI2OCwianRpIjoiNmI2NjI5NjUtOTU4MS00NTJkLTlhOGUtZWZiMTdmMTk0ZWEwIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiI3MTg3YjJlYS1hZjcxLTQxMDYtOTg4NS05MGE1OTRjNzVkYTkiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.omg8lBi8aYXNKFtyz-59LVSg2a2tCMxJ-pijDZk_PJuP3t0KLP9mK065sgr18j9RRLlhB5Gz2kgicFArxHtivEl0gUXu61vDMI1JwNX-iJP3IW1nOuz1niWS06XTsBAs3FLboN9JCzCrlyLSB7kFOSKNyr9gnqXqesWQU1H_s6k9aowpZ2V4aNEsojTx4jRXH2wCNB77m23zlaTQfbhQx_Hi4ZBiiOFCmRXadXaP0PC2LKecdNH4x8WAIIR9Jxwe-mzphLjj5_er637GhiPlR7lUQk9Yn4L72NWb6IEYvcz5_B5E73AFiU_xFR5kcOBPp-wTl_8-LRcBhxSaV9WLrA, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642331568, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.48.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=341019AB8F0B6A2FBAE9039977F9403A, http-session-last-accessed-time=1642331279774, kc-category-name=ACCESS, kc-iat=1642331268, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:50364 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:07:59.780  INFO 16 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:07:59.781  INFO 16 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3a5abc93
2022-01-16 11:07:59.781  INFO 16 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3a5abc93
2022-01-16 11:07:59.791  INFO 16 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3a5abc93
2022-01-16 11:07:59.791  INFO 16 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3a5abc93
2022-01-16 11:07:59.799  INFO 16 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3a5abc93
2022-01-16 11:07:59.799  WARN 16 --- [https-jsse-nio-7071-exec-8] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:07:59.799  WARN 16 --- [https-jsse-nio-7071-exec-8] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:07:59.799  INFO 16 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3a5abc93
2022-01-16 11:07:59.800  INFO 16 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3a5abc93
2022-01-16 11:07:59.800  WARN 16 --- [https-jsse-nio-7071-exec-8] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:07:59.800  WARN 16 --- [https-jsse-nio-7071-exec-8] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:07:59.800  INFO 16 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3a5abc93
2022-01-16 11:07:59.850  INFO 16 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: emergency-active, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3a5abc93
2022-01-16 11:07:59.867  INFO 16 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3a5abc93
2022-01-16 11:07:59.867  INFO 16 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3a5abc93
2022-01-16 11:07:59.876  INFO 16 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3a5abc93
2022-01-16 11:07:59.876  INFO 16 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-revoke-extra, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3a5abc93
2022-01-16 11:07:59.926  INFO 16 --- [https-jsse-nio-7071-exec-8] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18909730881534802-466564, decision=PERMIT, pdp-result=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}})
2022-01-16 11:07:59.926  INFO 16 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=b6742361-cc36-42cf-a66c-35f9941c825f, content=PERMIT, timestamp=1642331279926, pdpResult=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}}))
2022-01-16 11:07:59.928  INFO 16 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=146ms, Total=149ms
2022-01-16 11:07:59.953  INFO 16 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=8a6c590e-3397-467a-bc7d-1a28656dfc93, content=null, timestamp=1642331279948, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=50366, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=5fb2fe03fb5a, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=7187b2ea-af71-4106-9885-90a594c75da9, http-req-server-port=80, http-header-accept=*/*, kc-id=6b662965-9581-452d-9a8e-efb17f194ea0, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642331279946, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeP9sHNxAH4AEQAAAABh4/yEdAAkNmI2NjI5NjUtOTU4MS00NTJkLTlhOGUtZWZiMTdmMTk0ZWEwdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ3MTg3YjJlYS1hZjcxLTQxMDYtOTg4NS05MGE1OTRjNzVkYTlwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICI2cGUwZ2U1ck0zU2E2SUt5WXBsLTVkQTZrVXVleWo3X1psV2c1aDU4MmFvIn0.eyJleHAiOjE2NDIzMzE1NjgsImlhdCI6MTY0MjMzMTI2OCwianRpIjoiNmI2NjI5NjUtOTU4MS00NTJkLTlhOGUtZWZiMTdmMTk0ZWEwIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiI3MTg3YjJlYS1hZjcxLTQxMDYtOTg4NS05MGE1OTRjNzVkYTkiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.omg8lBi8aYXNKFtyz-59LVSg2a2tCMxJ-pijDZk_PJuP3t0KLP9mK065sgr18j9RRLlhB5Gz2kgicFArxHtivEl0gUXu61vDMI1JwNX-iJP3IW1nOuz1niWS06XTsBAs3FLboN9JCzCrlyLSB7kFOSKNyr9gnqXqesWQU1H_s6k9aowpZ2V4aNEsojTx4jRXH2wCNB77m23zlaTQfbhQx_Hi4ZBiiOFCmRXadXaP0PC2LKecdNH4x8WAIIR9Jxwe-mzphLjj5_er637GhiPlR7lUQk9Yn4L72NWb6IEYvcz5_B5E73AFiU_xFR5kcOBPp-wTl_8-LRcBhxSaV9WLrA, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642331568, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.48.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=48E58FEF4CA02D2DE969B1A6BB84C96A, http-session-last-accessed-time=1642331279946, kc-category-name=ACCESS, kc-iat=1642331268, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:50366 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:07:59.954  INFO 16 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:07:59.955  INFO 16 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@20af05e0
2022-01-16 11:07:59.955  INFO 16 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@20af05e0
2022-01-16 11:07:59.965  INFO 16 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@20af05e0
2022-01-16 11:07:59.965  INFO 16 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@20af05e0
2022-01-16 11:07:59.973  INFO 16 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@20af05e0
2022-01-16 11:07:59.973  WARN 16 --- [https-jsse-nio-7071-exec-9] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:07:59.973  WARN 16 --- [https-jsse-nio-7071-exec-9] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:07:59.973  INFO 16 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@20af05e0
2022-01-16 11:07:59.973  INFO 16 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@20af05e0
2022-01-16 11:07:59.974  WARN 16 --- [https-jsse-nio-7071-exec-9] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:07:59.974  WARN 16 --- [https-jsse-nio-7071-exec-9] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:07:59.974  INFO 16 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@20af05e0
2022-01-16 11:08:00.025  INFO 16 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: emergency-active, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@20af05e0
2022-01-16 11:08:00.034  INFO 16 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@20af05e0
2022-01-16 11:08:00.034  INFO 16 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@20af05e0
2022-01-16 11:08:00.043  INFO 16 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@20af05e0
2022-01-16 11:08:00.043  INFO 16 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-revoke-extra, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@20af05e0
2022-01-16 11:08:00.094  INFO 16 --- [https-jsse-nio-7071-exec-9] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18909731055541281-793360, decision=PERMIT, pdp-result=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}})
2022-01-16 11:08:00.094  INFO 16 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=8a6c590e-3397-467a-bc7d-1a28656dfc93, content=PERMIT, timestamp=1642331280094, pdpResult=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}}))
2022-01-16 11:08:00.094  INFO 16 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=140ms, Total=142ms
2022-01-16 11:08:00.118  INFO 16 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=a22d0b6b-667a-4d23-9cf1-16c8fe9721c2, content=null, timestamp=1642331280112, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=50368, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=5fb2fe03fb5a, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=7187b2ea-af71-4106-9885-90a594c75da9, http-req-server-port=80, http-header-accept=*/*, kc-id=6b662965-9581-452d-9a8e-efb17f194ea0, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642331280111, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeP9sHNxAH4AEQAAAABh4/yEdAAkNmI2NjI5NjUtOTU4MS00NTJkLTlhOGUtZWZiMTdmMTk0ZWEwdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ3MTg3YjJlYS1hZjcxLTQxMDYtOTg4NS05MGE1OTRjNzVkYTlwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICI2cGUwZ2U1ck0zU2E2SUt5WXBsLTVkQTZrVXVleWo3X1psV2c1aDU4MmFvIn0.eyJleHAiOjE2NDIzMzE1NjgsImlhdCI6MTY0MjMzMTI2OCwianRpIjoiNmI2NjI5NjUtOTU4MS00NTJkLTlhOGUtZWZiMTdmMTk0ZWEwIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiI3MTg3YjJlYS1hZjcxLTQxMDYtOTg4NS05MGE1OTRjNzVkYTkiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.omg8lBi8aYXNKFtyz-59LVSg2a2tCMxJ-pijDZk_PJuP3t0KLP9mK065sgr18j9RRLlhB5Gz2kgicFArxHtivEl0gUXu61vDMI1JwNX-iJP3IW1nOuz1niWS06XTsBAs3FLboN9JCzCrlyLSB7kFOSKNyr9gnqXqesWQU1H_s6k9aowpZ2V4aNEsojTx4jRXH2wCNB77m23zlaTQfbhQx_Hi4ZBiiOFCmRXadXaP0PC2LKecdNH4x8WAIIR9Jxwe-mzphLjj5_er637GhiPlR7lUQk9Yn4L72NWb6IEYvcz5_B5E73AFiU_xFR5kcOBPp-wTl_8-LRcBhxSaV9WLrA, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642331568, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.48.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=9986274FC945EF5FCD460E4B2BD17B80, http-session-last-accessed-time=1642331280111, kc-category-name=ACCESS, kc-iat=1642331268, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:50368 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:08:00.118  INFO 16 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:08:00.119  INFO 16 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4de23503
2022-01-16 11:08:00.119  INFO 16 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4de23503
2022-01-16 11:08:00.133  INFO 16 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4de23503
2022-01-16 11:08:00.134  INFO 16 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4de23503
2022-01-16 11:08:00.144  INFO 16 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4de23503
2022-01-16 11:08:00.144  WARN 16 --- [https-jsse-nio-7071-exec-10] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:08:00.144  WARN 16 --- [https-jsse-nio-7071-exec-10] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:08:00.144  INFO 16 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4de23503
2022-01-16 11:08:00.144  INFO 16 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4de23503
2022-01-16 11:08:00.144  WARN 16 --- [https-jsse-nio-7071-exec-10] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:08:00.144  WARN 16 --- [https-jsse-nio-7071-exec-10] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:08:00.144  INFO 16 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4de23503
2022-01-16 11:08:00.193  INFO 16 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: emergency-active, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4de23503
2022-01-16 11:08:00.208  INFO 16 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4de23503
2022-01-16 11:08:00.209  INFO 16 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4de23503
2022-01-16 11:08:00.221  INFO 16 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4de23503
2022-01-16 11:08:00.221  INFO 16 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-revoke-extra, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4de23503
2022-01-16 11:08:00.274  INFO 16 --- [https-jsse-nio-7071-exec-10] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18909731219564539-129597, decision=PERMIT, pdp-result=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}})
2022-01-16 11:08:00.274  INFO 16 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=a22d0b6b-667a-4d23-9cf1-16c8fe9721c2, content=PERMIT, timestamp=1642331280274, pdpResult=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}}))
2022-01-16 11:08:00.274  INFO 16 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=156ms, Total=157ms
2022-01-16 11:08:00.300  INFO 16 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=bc61e96e-db49-4361-af99-3d47f82b355f, content=null, timestamp=1642331280289, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=50370, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=5fb2fe03fb5a, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=7187b2ea-af71-4106-9885-90a594c75da9, http-req-server-port=80, http-header-accept=*/*, kc-id=6b662965-9581-452d-9a8e-efb17f194ea0, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642331280287, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeP9sHNxAH4AEQAAAABh4/yEdAAkNmI2NjI5NjUtOTU4MS00NTJkLTlhOGUtZWZiMTdmMTk0ZWEwdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ3MTg3YjJlYS1hZjcxLTQxMDYtOTg4NS05MGE1OTRjNzVkYTlwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICI2cGUwZ2U1ck0zU2E2SUt5WXBsLTVkQTZrVXVleWo3X1psV2c1aDU4MmFvIn0.eyJleHAiOjE2NDIzMzE1NjgsImlhdCI6MTY0MjMzMTI2OCwianRpIjoiNmI2NjI5NjUtOTU4MS00NTJkLTlhOGUtZWZiMTdmMTk0ZWEwIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiI3MTg3YjJlYS1hZjcxLTQxMDYtOTg4NS05MGE1OTRjNzVkYTkiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.omg8lBi8aYXNKFtyz-59LVSg2a2tCMxJ-pijDZk_PJuP3t0KLP9mK065sgr18j9RRLlhB5Gz2kgicFArxHtivEl0gUXu61vDMI1JwNX-iJP3IW1nOuz1niWS06XTsBAs3FLboN9JCzCrlyLSB7kFOSKNyr9gnqXqesWQU1H_s6k9aowpZ2V4aNEsojTx4jRXH2wCNB77m23zlaTQfbhQx_Hi4ZBiiOFCmRXadXaP0PC2LKecdNH4x8WAIIR9Jxwe-mzphLjj5_er637GhiPlR7lUQk9Yn4L72NWb6IEYvcz5_B5E73AFiU_xFR5kcOBPp-wTl_8-LRcBhxSaV9WLrA, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642331568, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.48.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=A8DA9E4D9EB86D6E85E851AB05390D84, http-session-last-accessed-time=1642331280287, kc-category-name=ACCESS, kc-iat=1642331268, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:50370 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:08:00.305  INFO 16 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:08:00.305  INFO 16 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@679f636c
2022-01-16 11:08:00.306  INFO 16 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@679f636c
2022-01-16 11:08:00.316  INFO 16 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@679f636c
2022-01-16 11:08:00.317  INFO 16 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@679f636c
2022-01-16 11:08:00.326  INFO 16 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@679f636c
2022-01-16 11:08:00.326  WARN 16 --- [https-jsse-nio-7071-exec-1] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:08:00.326  WARN 16 --- [https-jsse-nio-7071-exec-1] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:08:00.327  INFO 16 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@679f636c
2022-01-16 11:08:00.327  INFO 16 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@679f636c
2022-01-16 11:08:00.327  WARN 16 --- [https-jsse-nio-7071-exec-1] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:08:00.328  WARN 16 --- [https-jsse-nio-7071-exec-1] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:08:00.328  INFO 16 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@679f636c
2022-01-16 11:08:00.381  INFO 16 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: emergency-active, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@679f636c
2022-01-16 11:08:00.397  INFO 16 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@679f636c
2022-01-16 11:08:00.398  INFO 16 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@679f636c
2022-01-16 11:08:00.413  INFO 16 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@679f636c
2022-01-16 11:08:00.413  INFO 16 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-revoke-extra, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@679f636c
2022-01-16 11:08:00.461  INFO 16 --- [https-jsse-nio-7071-exec-1] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18909731406387309-225545, decision=PERMIT, pdp-result=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}})
2022-01-16 11:08:00.462  INFO 16 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=bc61e96e-db49-4361-af99-3d47f82b355f, content=PERMIT, timestamp=1642331280462, pdpResult=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}}))
2022-01-16 11:08:00.462  INFO 16 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=157ms, Total=163ms
2022-01-16 11:08:00.486  INFO 16 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=78ab5155-9ea2-420e-af6c-9a19fb69e411, content=null, timestamp=1642331280479, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=50372, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=5fb2fe03fb5a, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=7187b2ea-af71-4106-9885-90a594c75da9, http-req-server-port=80, http-header-accept=*/*, kc-id=6b662965-9581-452d-9a8e-efb17f194ea0, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642331280478, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeP9sHNxAH4AEQAAAABh4/yEdAAkNmI2NjI5NjUtOTU4MS00NTJkLTlhOGUtZWZiMTdmMTk0ZWEwdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ3MTg3YjJlYS1hZjcxLTQxMDYtOTg4NS05MGE1OTRjNzVkYTlwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICI2cGUwZ2U1ck0zU2E2SUt5WXBsLTVkQTZrVXVleWo3X1psV2c1aDU4MmFvIn0.eyJleHAiOjE2NDIzMzE1NjgsImlhdCI6MTY0MjMzMTI2OCwianRpIjoiNmI2NjI5NjUtOTU4MS00NTJkLTlhOGUtZWZiMTdmMTk0ZWEwIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiI3MTg3YjJlYS1hZjcxLTQxMDYtOTg4NS05MGE1OTRjNzVkYTkiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.omg8lBi8aYXNKFtyz-59LVSg2a2tCMxJ-pijDZk_PJuP3t0KLP9mK065sgr18j9RRLlhB5Gz2kgicFArxHtivEl0gUXu61vDMI1JwNX-iJP3IW1nOuz1niWS06XTsBAs3FLboN9JCzCrlyLSB7kFOSKNyr9gnqXqesWQU1H_s6k9aowpZ2V4aNEsojTx4jRXH2wCNB77m23zlaTQfbhQx_Hi4ZBiiOFCmRXadXaP0PC2LKecdNH4x8WAIIR9Jxwe-mzphLjj5_er637GhiPlR7lUQk9Yn4L72NWb6IEYvcz5_B5E73AFiU_xFR5kcOBPp-wTl_8-LRcBhxSaV9WLrA, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642331568, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.48.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=7B659113B419F771D7F1FBF3DF1AB084, http-session-last-accessed-time=1642331280478, kc-category-name=ACCESS, kc-iat=1642331268, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:50372 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:08:00.486  INFO 16 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:08:00.487  INFO 16 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2dea805b
2022-01-16 11:08:00.487  INFO 16 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2dea805b
2022-01-16 11:08:00.499  INFO 16 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2dea805b
2022-01-16 11:08:00.499  INFO 16 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2dea805b
2022-01-16 11:08:00.510  INFO 16 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2dea805b
2022-01-16 11:08:00.511  WARN 16 --- [https-jsse-nio-7071-exec-2] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:08:00.511  WARN 16 --- [https-jsse-nio-7071-exec-2] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:08:00.511  INFO 16 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2dea805b
2022-01-16 11:08:00.511  INFO 16 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2dea805b
2022-01-16 11:08:00.512  WARN 16 --- [https-jsse-nio-7071-exec-2] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:08:00.512  WARN 16 --- [https-jsse-nio-7071-exec-2] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:08:00.512  INFO 16 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2dea805b
2022-01-16 11:08:00.561  INFO 16 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: emergency-active, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2dea805b
2022-01-16 11:08:00.575  INFO 16 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2dea805b
2022-01-16 11:08:00.575  INFO 16 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2dea805b
2022-01-16 11:08:00.583  INFO 16 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2dea805b
2022-01-16 11:08:00.583  INFO 16 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-revoke-extra, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2dea805b
2022-01-16 11:08:00.634  INFO 16 --- [https-jsse-nio-7071-exec-2] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18909731587930502-861424, decision=PERMIT, pdp-result=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}})
2022-01-16 11:08:00.634  INFO 16 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=78ab5155-9ea2-420e-af6c-9a19fb69e411, content=PERMIT, timestamp=1642331280634, pdpResult=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}}))
2022-01-16 11:08:00.636  INFO 16 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=148ms, Total=151ms
2022-01-16 11:08:00.659  INFO 16 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=db23f285-0bd6-4ae3-8523-7f1b7c2a21cf, content=null, timestamp=1642331280655, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=50374, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=5fb2fe03fb5a, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=7187b2ea-af71-4106-9885-90a594c75da9, http-req-server-port=80, http-header-accept=*/*, kc-id=6b662965-9581-452d-9a8e-efb17f194ea0, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642331280653, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeP9sHNxAH4AEQAAAABh4/yEdAAkNmI2NjI5NjUtOTU4MS00NTJkLTlhOGUtZWZiMTdmMTk0ZWEwdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ3MTg3YjJlYS1hZjcxLTQxMDYtOTg4NS05MGE1OTRjNzVkYTlwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICI2cGUwZ2U1ck0zU2E2SUt5WXBsLTVkQTZrVXVleWo3X1psV2c1aDU4MmFvIn0.eyJleHAiOjE2NDIzMzE1NjgsImlhdCI6MTY0MjMzMTI2OCwianRpIjoiNmI2NjI5NjUtOTU4MS00NTJkLTlhOGUtZWZiMTdmMTk0ZWEwIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiI3MTg3YjJlYS1hZjcxLTQxMDYtOTg4NS05MGE1OTRjNzVkYTkiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.omg8lBi8aYXNKFtyz-59LVSg2a2tCMxJ-pijDZk_PJuP3t0KLP9mK065sgr18j9RRLlhB5Gz2kgicFArxHtivEl0gUXu61vDMI1JwNX-iJP3IW1nOuz1niWS06XTsBAs3FLboN9JCzCrlyLSB7kFOSKNyr9gnqXqesWQU1H_s6k9aowpZ2V4aNEsojTx4jRXH2wCNB77m23zlaTQfbhQx_Hi4ZBiiOFCmRXadXaP0PC2LKecdNH4x8WAIIR9Jxwe-mzphLjj5_er637GhiPlR7lUQk9Yn4L72NWb6IEYvcz5_B5E73AFiU_xFR5kcOBPp-wTl_8-LRcBhxSaV9WLrA, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642331568, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.48.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=095F5F9743276ADA27C58393AA47507A, http-session-last-accessed-time=1642331280653, kc-category-name=ACCESS, kc-iat=1642331268, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:50374 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:08:00.660  INFO 16 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:08:00.661  INFO 16 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@64b56d4c
2022-01-16 11:08:00.661  INFO 16 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@64b56d4c
2022-01-16 11:08:00.685  INFO 16 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@64b56d4c
2022-01-16 11:08:00.686  INFO 16 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@64b56d4c
2022-01-16 11:08:00.707  INFO 16 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@64b56d4c
2022-01-16 11:08:00.707  WARN 16 --- [https-jsse-nio-7071-exec-3] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:08:00.707  WARN 16 --- [https-jsse-nio-7071-exec-3] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:08:00.707  INFO 16 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@64b56d4c
2022-01-16 11:08:00.708  INFO 16 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@64b56d4c
2022-01-16 11:08:00.708  WARN 16 --- [https-jsse-nio-7071-exec-3] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:08:00.708  WARN 16 --- [https-jsse-nio-7071-exec-3] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:08:00.709  INFO 16 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@64b56d4c
2022-01-16 11:08:00.761  INFO 16 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: emergency-active, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@64b56d4c
2022-01-16 11:08:00.777  INFO 16 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@64b56d4c
2022-01-16 11:08:00.777  INFO 16 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@64b56d4c
2022-01-16 11:08:00.784  INFO 16 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@64b56d4c
2022-01-16 11:08:00.785  INFO 16 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-revoke-extra, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@64b56d4c
2022-01-16 11:08:00.834  INFO 16 --- [https-jsse-nio-7071-exec-3] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18909731761339579-553004, decision=PERMIT, pdp-result=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}})
2022-01-16 11:08:00.834  INFO 16 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=db23f285-0bd6-4ae3-8523-7f1b7c2a21cf, content=PERMIT, timestamp=1642331280834, pdpResult=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}}))
2022-01-16 11:08:00.835  INFO 16 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=174ms, Total=177ms
2022-01-16 11:08:00.854  INFO 16 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=27322339-ce94-44dc-9b2b-9897d5b3226d, content=null, timestamp=1642331280849, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=50376, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=5fb2fe03fb5a, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=7187b2ea-af71-4106-9885-90a594c75da9, http-req-server-port=80, http-header-accept=*/*, kc-id=6b662965-9581-452d-9a8e-efb17f194ea0, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642331280848, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeP9sHNxAH4AEQAAAABh4/yEdAAkNmI2NjI5NjUtOTU4MS00NTJkLTlhOGUtZWZiMTdmMTk0ZWEwdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ3MTg3YjJlYS1hZjcxLTQxMDYtOTg4NS05MGE1OTRjNzVkYTlwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICI2cGUwZ2U1ck0zU2E2SUt5WXBsLTVkQTZrVXVleWo3X1psV2c1aDU4MmFvIn0.eyJleHAiOjE2NDIzMzE1NjgsImlhdCI6MTY0MjMzMTI2OCwianRpIjoiNmI2NjI5NjUtOTU4MS00NTJkLTlhOGUtZWZiMTdmMTk0ZWEwIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiI3MTg3YjJlYS1hZjcxLTQxMDYtOTg4NS05MGE1OTRjNzVkYTkiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.omg8lBi8aYXNKFtyz-59LVSg2a2tCMxJ-pijDZk_PJuP3t0KLP9mK065sgr18j9RRLlhB5Gz2kgicFArxHtivEl0gUXu61vDMI1JwNX-iJP3IW1nOuz1niWS06XTsBAs3FLboN9JCzCrlyLSB7kFOSKNyr9gnqXqesWQU1H_s6k9aowpZ2V4aNEsojTx4jRXH2wCNB77m23zlaTQfbhQx_Hi4ZBiiOFCmRXadXaP0PC2LKecdNH4x8WAIIR9Jxwe-mzphLjj5_er637GhiPlR7lUQk9Yn4L72NWb6IEYvcz5_B5E73AFiU_xFR5kcOBPp-wTl_8-LRcBhxSaV9WLrA, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642331568, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.48.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=358BA3B00693C95710EF5552F147AAF8, http-session-last-accessed-time=1642331280848, kc-category-name=ACCESS, kc-iat=1642331268, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:50376 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:08:00.854  INFO 16 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:08:00.855  INFO 16 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@69b7bbad
2022-01-16 11:08:00.855  INFO 16 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@69b7bbad
2022-01-16 11:08:00.864  INFO 16 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@69b7bbad
2022-01-16 11:08:00.864  INFO 16 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@69b7bbad
2022-01-16 11:08:00.871  INFO 16 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@69b7bbad
2022-01-16 11:08:00.871  WARN 16 --- [https-jsse-nio-7071-exec-4] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:08:00.871  WARN 16 --- [https-jsse-nio-7071-exec-4] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:08:00.872  INFO 16 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@69b7bbad
2022-01-16 11:08:00.872  INFO 16 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@69b7bbad
2022-01-16 11:08:00.872  WARN 16 --- [https-jsse-nio-7071-exec-4] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:08:00.872  WARN 16 --- [https-jsse-nio-7071-exec-4] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:08:00.873  INFO 16 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@69b7bbad
2022-01-16 11:08:00.921  INFO 16 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: emergency-active, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@69b7bbad
2022-01-16 11:08:00.934  INFO 16 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@69b7bbad
2022-01-16 11:08:00.934  INFO 16 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@69b7bbad
2022-01-16 11:08:00.944  INFO 16 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@69b7bbad
2022-01-16 11:08:00.944  INFO 16 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-revoke-extra, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@69b7bbad
2022-01-16 11:08:01.007  INFO 16 --- [https-jsse-nio-7071-exec-4] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18909731955752016-625727, decision=PERMIT, pdp-result=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}})
2022-01-16 11:08:01.007  INFO 16 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=27322339-ce94-44dc-9b2b-9897d5b3226d, content=PERMIT, timestamp=1642331281007, pdpResult=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}}))
2022-01-16 11:08:01.008  INFO 16 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=153ms, Total=156ms
2022-01-16 11:08:01.041  INFO 16 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=15dee324-c1b9-4659-9650-dec4b3e6e635, content=null, timestamp=1642331281034, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=50378, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=5fb2fe03fb5a, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=7187b2ea-af71-4106-9885-90a594c75da9, http-req-server-port=80, http-header-accept=*/*, kc-id=6b662965-9581-452d-9a8e-efb17f194ea0, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642331281032, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeP9sHNxAH4AEQAAAABh4/yEdAAkNmI2NjI5NjUtOTU4MS00NTJkLTlhOGUtZWZiMTdmMTk0ZWEwdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ3MTg3YjJlYS1hZjcxLTQxMDYtOTg4NS05MGE1OTRjNzVkYTlwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICI2cGUwZ2U1ck0zU2E2SUt5WXBsLTVkQTZrVXVleWo3X1psV2c1aDU4MmFvIn0.eyJleHAiOjE2NDIzMzE1NjgsImlhdCI6MTY0MjMzMTI2OCwianRpIjoiNmI2NjI5NjUtOTU4MS00NTJkLTlhOGUtZWZiMTdmMTk0ZWEwIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiI3MTg3YjJlYS1hZjcxLTQxMDYtOTg4NS05MGE1OTRjNzVkYTkiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.omg8lBi8aYXNKFtyz-59LVSg2a2tCMxJ-pijDZk_PJuP3t0KLP9mK065sgr18j9RRLlhB5Gz2kgicFArxHtivEl0gUXu61vDMI1JwNX-iJP3IW1nOuz1niWS06XTsBAs3FLboN9JCzCrlyLSB7kFOSKNyr9gnqXqesWQU1H_s6k9aowpZ2V4aNEsojTx4jRXH2wCNB77m23zlaTQfbhQx_Hi4ZBiiOFCmRXadXaP0PC2LKecdNH4x8WAIIR9Jxwe-mzphLjj5_er637GhiPlR7lUQk9Yn4L72NWb6IEYvcz5_B5E73AFiU_xFR5kcOBPp-wTl_8-LRcBhxSaV9WLrA, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642331568, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.48.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=1CEC91937F9CD840290864D011E932B9, http-session-last-accessed-time=1642331281032, kc-category-name=ACCESS, kc-iat=1642331268, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:50378 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:08:01.042  INFO 16 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:08:01.044  INFO 16 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7c555f2e
2022-01-16 11:08:01.044  INFO 16 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7c555f2e
2022-01-16 11:08:01.057  INFO 16 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7c555f2e
2022-01-16 11:08:01.057  INFO 16 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7c555f2e
2022-01-16 11:08:01.066  INFO 16 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7c555f2e
2022-01-16 11:08:01.066  WARN 16 --- [https-jsse-nio-7071-exec-5] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:08:01.066  WARN 16 --- [https-jsse-nio-7071-exec-5] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:08:01.067  INFO 16 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7c555f2e
2022-01-16 11:08:01.067  INFO 16 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7c555f2e
2022-01-16 11:08:01.068  WARN 16 --- [https-jsse-nio-7071-exec-5] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:08:01.068  WARN 16 --- [https-jsse-nio-7071-exec-5] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:08:01.068  INFO 16 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7c555f2e
2022-01-16 11:08:01.078  INFO 16 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: emergency-active, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7c555f2e
2022-01-16 11:08:01.129  INFO 16 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7c555f2e
2022-01-16 11:08:01.129  INFO 16 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7c555f2e
2022-01-16 11:08:01.143  INFO 16 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7c555f2e
2022-01-16 11:08:01.143  INFO 16 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-revoke-extra, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7c555f2e
2022-01-16 11:08:01.153  INFO 16 --- [https-jsse-nio-7071-exec-5] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18909732144477338-1891, decision=PERMIT, pdp-result=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}})
2022-01-16 11:08:01.153  INFO 16 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=15dee324-c1b9-4659-9650-dec4b3e6e635, content=PERMIT, timestamp=1642331281153, pdpResult=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}}))
2022-01-16 11:08:01.154  INFO 16 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=110ms, Total=115ms
2022-01-16 11:08:01.177  INFO 16 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=16cfe079-d9b7-4d95-9a57-74da6120f98e, content=null, timestamp=1642331281172, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=50380, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=5fb2fe03fb5a, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=7187b2ea-af71-4106-9885-90a594c75da9, http-req-server-port=80, http-header-accept=*/*, kc-id=6b662965-9581-452d-9a8e-efb17f194ea0, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642331281170, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeP9sHNxAH4AEQAAAABh4/yEdAAkNmI2NjI5NjUtOTU4MS00NTJkLTlhOGUtZWZiMTdmMTk0ZWEwdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ3MTg3YjJlYS1hZjcxLTQxMDYtOTg4NS05MGE1OTRjNzVkYTlwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICI2cGUwZ2U1ck0zU2E2SUt5WXBsLTVkQTZrVXVleWo3X1psV2c1aDU4MmFvIn0.eyJleHAiOjE2NDIzMzE1NjgsImlhdCI6MTY0MjMzMTI2OCwianRpIjoiNmI2NjI5NjUtOTU4MS00NTJkLTlhOGUtZWZiMTdmMTk0ZWEwIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiI3MTg3YjJlYS1hZjcxLTQxMDYtOTg4NS05MGE1OTRjNzVkYTkiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.omg8lBi8aYXNKFtyz-59LVSg2a2tCMxJ-pijDZk_PJuP3t0KLP9mK065sgr18j9RRLlhB5Gz2kgicFArxHtivEl0gUXu61vDMI1JwNX-iJP3IW1nOuz1niWS06XTsBAs3FLboN9JCzCrlyLSB7kFOSKNyr9gnqXqesWQU1H_s6k9aowpZ2V4aNEsojTx4jRXH2wCNB77m23zlaTQfbhQx_Hi4ZBiiOFCmRXadXaP0PC2LKecdNH4x8WAIIR9Jxwe-mzphLjj5_er637GhiPlR7lUQk9Yn4L72NWb6IEYvcz5_B5E73AFiU_xFR5kcOBPp-wTl_8-LRcBhxSaV9WLrA, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642331568, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.48.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=D7744CC628D227EDC42EE8F2978540BD, http-session-last-accessed-time=1642331281170, kc-category-name=ACCESS, kc-iat=1642331268, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:50380 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:08:01.178  INFO 16 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:08:01.179  INFO 16 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7b25dc0d
2022-01-16 11:08:01.179  INFO 16 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7b25dc0d
2022-01-16 11:08:01.234  INFO 16 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7b25dc0d
2022-01-16 11:08:01.234  INFO 16 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7b25dc0d
2022-01-16 11:08:01.245  INFO 16 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7b25dc0d
2022-01-16 11:08:01.246  WARN 16 --- [https-jsse-nio-7071-exec-6] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:08:01.246  WARN 16 --- [https-jsse-nio-7071-exec-6] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:08:01.246  INFO 16 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7b25dc0d
2022-01-16 11:08:01.246  INFO 16 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7b25dc0d
2022-01-16 11:08:01.246  WARN 16 --- [https-jsse-nio-7071-exec-6] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:08:01.246  WARN 16 --- [https-jsse-nio-7071-exec-6] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:08:01.246  INFO 16 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7b25dc0d
2022-01-16 11:08:01.257  INFO 16 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: emergency-active, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7b25dc0d
2022-01-16 11:08:01.309  INFO 16 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7b25dc0d
2022-01-16 11:08:01.309  INFO 16 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7b25dc0d
2022-01-16 11:08:01.320  INFO 16 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7b25dc0d
2022-01-16 11:08:01.320  INFO 16 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-revoke-extra, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7b25dc0d
2022-01-16 11:08:01.331  INFO 16 --- [https-jsse-nio-7071-exec-6] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18909732279625582-818501, decision=PERMIT, pdp-result=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}})
2022-01-16 11:08:01.331  INFO 16 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=16cfe079-d9b7-4d95-9a57-74da6120f98e, content=PERMIT, timestamp=1642331281331, pdpResult=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}}))
2022-01-16 11:08:01.331  INFO 16 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=153ms, Total=155ms
2022-01-16 11:08:01.355  INFO 16 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=7b0f231a-4376-4c73-9a26-0ff7e3957602, content=null, timestamp=1642331281345, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=50382, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=5fb2fe03fb5a, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=7187b2ea-af71-4106-9885-90a594c75da9, http-req-server-port=80, http-header-accept=*/*, kc-id=6b662965-9581-452d-9a8e-efb17f194ea0, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642331281344, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeP9sHNxAH4AEQAAAABh4/yEdAAkNmI2NjI5NjUtOTU4MS00NTJkLTlhOGUtZWZiMTdmMTk0ZWEwdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ3MTg3YjJlYS1hZjcxLTQxMDYtOTg4NS05MGE1OTRjNzVkYTlwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICI2cGUwZ2U1ck0zU2E2SUt5WXBsLTVkQTZrVXVleWo3X1psV2c1aDU4MmFvIn0.eyJleHAiOjE2NDIzMzE1NjgsImlhdCI6MTY0MjMzMTI2OCwianRpIjoiNmI2NjI5NjUtOTU4MS00NTJkLTlhOGUtZWZiMTdmMTk0ZWEwIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiI3MTg3YjJlYS1hZjcxLTQxMDYtOTg4NS05MGE1OTRjNzVkYTkiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.omg8lBi8aYXNKFtyz-59LVSg2a2tCMxJ-pijDZk_PJuP3t0KLP9mK065sgr18j9RRLlhB5Gz2kgicFArxHtivEl0gUXu61vDMI1JwNX-iJP3IW1nOuz1niWS06XTsBAs3FLboN9JCzCrlyLSB7kFOSKNyr9gnqXqesWQU1H_s6k9aowpZ2V4aNEsojTx4jRXH2wCNB77m23zlaTQfbhQx_Hi4ZBiiOFCmRXadXaP0PC2LKecdNH4x8WAIIR9Jxwe-mzphLjj5_er637GhiPlR7lUQk9Yn4L72NWb6IEYvcz5_B5E73AFiU_xFR5kcOBPp-wTl_8-LRcBhxSaV9WLrA, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642331568, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.48.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=8712AACDA713F991E1D51B85AF3C9F16, http-session-last-accessed-time=1642331281344, kc-category-name=ACCESS, kc-iat=1642331268, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:50382 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:08:01.355  INFO 16 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:08:01.357  INFO 16 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@53514cd9
2022-01-16 11:08:01.357  INFO 16 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@53514cd9
2022-01-16 11:08:01.417  INFO 16 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@53514cd9
2022-01-16 11:08:01.418  INFO 16 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@53514cd9
2022-01-16 11:08:01.431  INFO 16 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@53514cd9
2022-01-16 11:08:01.431  WARN 16 --- [https-jsse-nio-7071-exec-7] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:08:01.431  WARN 16 --- [https-jsse-nio-7071-exec-7] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:08:01.431  INFO 16 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@53514cd9
2022-01-16 11:08:01.432  INFO 16 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@53514cd9
2022-01-16 11:08:01.432  WARN 16 --- [https-jsse-nio-7071-exec-7] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:08:01.432  WARN 16 --- [https-jsse-nio-7071-exec-7] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:08:01.432  INFO 16 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@53514cd9
2022-01-16 11:08:01.443  INFO 16 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: emergency-active, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@53514cd9
2022-01-16 11:08:01.493  INFO 16 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@53514cd9
2022-01-16 11:08:01.494  INFO 16 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@53514cd9
2022-01-16 11:08:01.508  INFO 16 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@53514cd9
2022-01-16 11:08:01.508  INFO 16 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-revoke-extra, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@53514cd9
2022-01-16 11:08:01.520  INFO 16 --- [https-jsse-nio-7071-exec-7] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18909732456815517-366294, decision=PERMIT, pdp-result=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}})
2022-01-16 11:08:01.520  INFO 16 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=7b0f231a-4376-4c73-9a26-0ff7e3957602, content=PERMIT, timestamp=1642331281520, pdpResult=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}}))
2022-01-16 11:08:01.521  INFO 16 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=165ms, Total=171ms
2022-01-16 11:08:01.542  INFO 16 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=e8d50bdd-e715-4223-b206-01eedb3480d4, content=null, timestamp=1642331281537, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=50384, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=5fb2fe03fb5a, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=7187b2ea-af71-4106-9885-90a594c75da9, http-req-server-port=80, http-header-accept=*/*, kc-id=6b662965-9581-452d-9a8e-efb17f194ea0, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642331281536, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeP9sHNxAH4AEQAAAABh4/yEdAAkNmI2NjI5NjUtOTU4MS00NTJkLTlhOGUtZWZiMTdmMTk0ZWEwdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ3MTg3YjJlYS1hZjcxLTQxMDYtOTg4NS05MGE1OTRjNzVkYTlwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICI2cGUwZ2U1ck0zU2E2SUt5WXBsLTVkQTZrVXVleWo3X1psV2c1aDU4MmFvIn0.eyJleHAiOjE2NDIzMzE1NjgsImlhdCI6MTY0MjMzMTI2OCwianRpIjoiNmI2NjI5NjUtOTU4MS00NTJkLTlhOGUtZWZiMTdmMTk0ZWEwIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiI3MTg3YjJlYS1hZjcxLTQxMDYtOTg4NS05MGE1OTRjNzVkYTkiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.omg8lBi8aYXNKFtyz-59LVSg2a2tCMxJ-pijDZk_PJuP3t0KLP9mK065sgr18j9RRLlhB5Gz2kgicFArxHtivEl0gUXu61vDMI1JwNX-iJP3IW1nOuz1niWS06XTsBAs3FLboN9JCzCrlyLSB7kFOSKNyr9gnqXqesWQU1H_s6k9aowpZ2V4aNEsojTx4jRXH2wCNB77m23zlaTQfbhQx_Hi4ZBiiOFCmRXadXaP0PC2LKecdNH4x8WAIIR9Jxwe-mzphLjj5_er637GhiPlR7lUQk9Yn4L72NWb6IEYvcz5_B5E73AFiU_xFR5kcOBPp-wTl_8-LRcBhxSaV9WLrA, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642331568, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.48.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=3B3B69D6564BC164CE79DDAE57A8D218, http-session-last-accessed-time=1642331281536, kc-category-name=ACCESS, kc-iat=1642331268, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:50384 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:08:01.542  INFO 16 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:08:01.543  INFO 16 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@d737326
2022-01-16 11:08:01.543  INFO 16 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@d737326
2022-01-16 11:08:01.597  INFO 16 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@d737326
2022-01-16 11:08:01.597  INFO 16 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@d737326
2022-01-16 11:08:01.612  INFO 16 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@d737326
2022-01-16 11:08:01.612  WARN 16 --- [https-jsse-nio-7071-exec-8] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:08:01.612  WARN 16 --- [https-jsse-nio-7071-exec-8] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:08:01.612  INFO 16 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@d737326
2022-01-16 11:08:01.613  INFO 16 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@d737326
2022-01-16 11:08:01.614  WARN 16 --- [https-jsse-nio-7071-exec-8] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:08:01.614  WARN 16 --- [https-jsse-nio-7071-exec-8] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:08:01.614  INFO 16 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@d737326
2022-01-16 11:08:01.626  INFO 16 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: emergency-active, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@d737326
2022-01-16 11:08:01.677  INFO 16 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@d737326
2022-01-16 11:08:01.678  INFO 16 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@d737326
2022-01-16 11:08:01.692  INFO 16 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@d737326
2022-01-16 11:08:01.692  INFO 16 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-revoke-extra, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@d737326
2022-01-16 11:08:01.703  INFO 16 --- [https-jsse-nio-7071-exec-8] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18909732643630124-647017, decision=PERMIT, pdp-result=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}})
2022-01-16 11:08:01.703  INFO 16 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=e8d50bdd-e715-4223-b206-01eedb3480d4, content=PERMIT, timestamp=1642331281703, pdpResult=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}}))
2022-01-16 11:08:01.704  INFO 16 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=161ms, Total=164ms
2022-01-16 11:08:01.732  INFO 16 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=a753f3cb-c225-4590-af95-57d91c93dfae, content=null, timestamp=1642331281725, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=50386, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=5fb2fe03fb5a, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=7187b2ea-af71-4106-9885-90a594c75da9, http-req-server-port=80, http-header-accept=*/*, kc-id=6b662965-9581-452d-9a8e-efb17f194ea0, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642331281723, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeP9sHNxAH4AEQAAAABh4/yEdAAkNmI2NjI5NjUtOTU4MS00NTJkLTlhOGUtZWZiMTdmMTk0ZWEwdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ3MTg3YjJlYS1hZjcxLTQxMDYtOTg4NS05MGE1OTRjNzVkYTlwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICI2cGUwZ2U1ck0zU2E2SUt5WXBsLTVkQTZrVXVleWo3X1psV2c1aDU4MmFvIn0.eyJleHAiOjE2NDIzMzE1NjgsImlhdCI6MTY0MjMzMTI2OCwianRpIjoiNmI2NjI5NjUtOTU4MS00NTJkLTlhOGUtZWZiMTdmMTk0ZWEwIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiI3MTg3YjJlYS1hZjcxLTQxMDYtOTg4NS05MGE1OTRjNzVkYTkiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.omg8lBi8aYXNKFtyz-59LVSg2a2tCMxJ-pijDZk_PJuP3t0KLP9mK065sgr18j9RRLlhB5Gz2kgicFArxHtivEl0gUXu61vDMI1JwNX-iJP3IW1nOuz1niWS06XTsBAs3FLboN9JCzCrlyLSB7kFOSKNyr9gnqXqesWQU1H_s6k9aowpZ2V4aNEsojTx4jRXH2wCNB77m23zlaTQfbhQx_Hi4ZBiiOFCmRXadXaP0PC2LKecdNH4x8WAIIR9Jxwe-mzphLjj5_er637GhiPlR7lUQk9Yn4L72NWb6IEYvcz5_B5E73AFiU_xFR5kcOBPp-wTl_8-LRcBhxSaV9WLrA, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642331568, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.48.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=68EA1C20CE70DD8B04DA616A35192B38, http-session-last-accessed-time=1642331281723, kc-category-name=ACCESS, kc-iat=1642331268, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:50386 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:08:01.733  INFO 16 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:08:01.735  INFO 16 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@9abe367
2022-01-16 11:08:01.735  INFO 16 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@9abe367
2022-01-16 11:08:01.789  INFO 16 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@9abe367
2022-01-16 11:08:01.790  INFO 16 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@9abe367
2022-01-16 11:08:01.804  INFO 16 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@9abe367
2022-01-16 11:08:01.804  WARN 16 --- [https-jsse-nio-7071-exec-9] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:08:01.804  WARN 16 --- [https-jsse-nio-7071-exec-9] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:08:01.804  INFO 16 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@9abe367
2022-01-16 11:08:01.804  INFO 16 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@9abe367
2022-01-16 11:08:01.804  WARN 16 --- [https-jsse-nio-7071-exec-9] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:08:01.805  WARN 16 --- [https-jsse-nio-7071-exec-9] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:08:01.805  INFO 16 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@9abe367
2022-01-16 11:08:01.819  INFO 16 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: emergency-active, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@9abe367
2022-01-16 11:08:01.874  INFO 16 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@9abe367
2022-01-16 11:08:01.874  INFO 16 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@9abe367
2022-01-16 11:08:01.890  INFO 16 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@9abe367
2022-01-16 11:08:01.891  INFO 16 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-revoke-extra, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@9abe367
2022-01-16 11:08:01.901  INFO 16 --- [https-jsse-nio-7071-exec-9] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18909732835407247-57348, decision=PERMIT, pdp-result=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}})
2022-01-16 11:08:01.901  INFO 16 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=a753f3cb-c225-4590-af95-57d91c93dfae, content=PERMIT, timestamp=1642331281901, pdpResult=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}}))
2022-01-16 11:08:01.902  INFO 16 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=167ms, Total=172ms
2022-01-16 11:08:01.922  INFO 16 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=d6a42f31-6e6a-4ef9-8492-1695d9e4a19f, content=null, timestamp=1642331281917, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=50388, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=5fb2fe03fb5a, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=7187b2ea-af71-4106-9885-90a594c75da9, http-req-server-port=80, http-header-accept=*/*, kc-id=6b662965-9581-452d-9a8e-efb17f194ea0, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642331281916, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeP9sHNxAH4AEQAAAABh4/yEdAAkNmI2NjI5NjUtOTU4MS00NTJkLTlhOGUtZWZiMTdmMTk0ZWEwdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ3MTg3YjJlYS1hZjcxLTQxMDYtOTg4NS05MGE1OTRjNzVkYTlwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICI2cGUwZ2U1ck0zU2E2SUt5WXBsLTVkQTZrVXVleWo3X1psV2c1aDU4MmFvIn0.eyJleHAiOjE2NDIzMzE1NjgsImlhdCI6MTY0MjMzMTI2OCwianRpIjoiNmI2NjI5NjUtOTU4MS00NTJkLTlhOGUtZWZiMTdmMTk0ZWEwIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiI3MTg3YjJlYS1hZjcxLTQxMDYtOTg4NS05MGE1OTRjNzVkYTkiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.omg8lBi8aYXNKFtyz-59LVSg2a2tCMxJ-pijDZk_PJuP3t0KLP9mK065sgr18j9RRLlhB5Gz2kgicFArxHtivEl0gUXu61vDMI1JwNX-iJP3IW1nOuz1niWS06XTsBAs3FLboN9JCzCrlyLSB7kFOSKNyr9gnqXqesWQU1H_s6k9aowpZ2V4aNEsojTx4jRXH2wCNB77m23zlaTQfbhQx_Hi4ZBiiOFCmRXadXaP0PC2LKecdNH4x8WAIIR9Jxwe-mzphLjj5_er637GhiPlR7lUQk9Yn4L72NWb6IEYvcz5_B5E73AFiU_xFR5kcOBPp-wTl_8-LRcBhxSaV9WLrA, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642331568, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.48.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=8F7C96F2C2B52EC4D65E89FCEC315819, http-session-last-accessed-time=1642331281916, kc-category-name=ACCESS, kc-iat=1642331268, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:50388 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:08:01.923  INFO 16 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:08:01.923  INFO 16 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@31bf1d04
2022-01-16 11:08:01.924  INFO 16 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@31bf1d04
2022-01-16 11:08:01.978  INFO 16 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@31bf1d04
2022-01-16 11:08:01.978  INFO 16 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@31bf1d04
2022-01-16 11:08:01.995  INFO 16 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@31bf1d04
2022-01-16 11:08:01.995  WARN 16 --- [https-jsse-nio-7071-exec-10] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:08:01.995  WARN 16 --- [https-jsse-nio-7071-exec-10] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:08:01.995  INFO 16 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@31bf1d04
2022-01-16 11:08:01.996  INFO 16 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@31bf1d04
2022-01-16 11:08:01.996  WARN 16 --- [https-jsse-nio-7071-exec-10] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:08:01.996  WARN 16 --- [https-jsse-nio-7071-exec-10] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:08:01.996  INFO 16 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@31bf1d04
2022-01-16 11:08:02.004  INFO 16 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: emergency-active, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@31bf1d04
2022-01-16 11:08:02.053  INFO 16 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@31bf1d04
2022-01-16 11:08:02.054  INFO 16 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@31bf1d04
2022-01-16 11:08:02.068  INFO 16 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@31bf1d04
2022-01-16 11:08:02.068  INFO 16 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-revoke-extra, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@31bf1d04
2022-01-16 11:08:02.077  INFO 16 --- [https-jsse-nio-7071-exec-10] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18909733024210188-297354, decision=PERMIT, pdp-result=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}})
2022-01-16 11:08:02.078  INFO 16 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=d6a42f31-6e6a-4ef9-8492-1695d9e4a19f, content=PERMIT, timestamp=1642331282078, pdpResult=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}}))
2022-01-16 11:08:02.079  INFO 16 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=155ms, Total=159ms
2022-01-16 11:08:02.099  INFO 16 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=b8a5c1c2-4e08-414c-b81d-cf363ffde892, content=null, timestamp=1642331282094, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=50390, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=5fb2fe03fb5a, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=7187b2ea-af71-4106-9885-90a594c75da9, http-req-server-port=80, http-header-accept=*/*, kc-id=6b662965-9581-452d-9a8e-efb17f194ea0, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642331282093, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeP9sHNxAH4AEQAAAABh4/yEdAAkNmI2NjI5NjUtOTU4MS00NTJkLTlhOGUtZWZiMTdmMTk0ZWEwdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ3MTg3YjJlYS1hZjcxLTQxMDYtOTg4NS05MGE1OTRjNzVkYTlwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICI2cGUwZ2U1ck0zU2E2SUt5WXBsLTVkQTZrVXVleWo3X1psV2c1aDU4MmFvIn0.eyJleHAiOjE2NDIzMzE1NjgsImlhdCI6MTY0MjMzMTI2OCwianRpIjoiNmI2NjI5NjUtOTU4MS00NTJkLTlhOGUtZWZiMTdmMTk0ZWEwIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiI3MTg3YjJlYS1hZjcxLTQxMDYtOTg4NS05MGE1OTRjNzVkYTkiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.omg8lBi8aYXNKFtyz-59LVSg2a2tCMxJ-pijDZk_PJuP3t0KLP9mK065sgr18j9RRLlhB5Gz2kgicFArxHtivEl0gUXu61vDMI1JwNX-iJP3IW1nOuz1niWS06XTsBAs3FLboN9JCzCrlyLSB7kFOSKNyr9gnqXqesWQU1H_s6k9aowpZ2V4aNEsojTx4jRXH2wCNB77m23zlaTQfbhQx_Hi4ZBiiOFCmRXadXaP0PC2LKecdNH4x8WAIIR9Jxwe-mzphLjj5_er637GhiPlR7lUQk9Yn4L72NWb6IEYvcz5_B5E73AFiU_xFR5kcOBPp-wTl_8-LRcBhxSaV9WLrA, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642331568, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.48.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=1EA5AED573081A4D0F05027B4CD40887, http-session-last-accessed-time=1642331282093, kc-category-name=ACCESS, kc-iat=1642331268, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:50390 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:08:02.101  INFO 16 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:08:02.102  INFO 16 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@611b3b49
2022-01-16 11:08:02.102  INFO 16 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@611b3b49
2022-01-16 11:08:02.154  INFO 16 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@611b3b49
2022-01-16 11:08:02.155  INFO 16 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@611b3b49
2022-01-16 11:08:02.172  INFO 16 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@611b3b49
2022-01-16 11:08:02.173  WARN 16 --- [https-jsse-nio-7071-exec-1] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:08:02.174  WARN 16 --- [https-jsse-nio-7071-exec-1] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:08:02.175  INFO 16 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@611b3b49
2022-01-16 11:08:02.176  INFO 16 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@611b3b49
2022-01-16 11:08:02.177  WARN 16 --- [https-jsse-nio-7071-exec-1] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:08:02.177  WARN 16 --- [https-jsse-nio-7071-exec-1] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:08:02.178  INFO 16 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@611b3b49
2022-01-16 11:08:02.186  INFO 16 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: emergency-active, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@611b3b49
2022-01-16 11:08:02.237  INFO 16 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@611b3b49
2022-01-16 11:08:02.238  INFO 16 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@611b3b49
2022-01-16 11:08:02.247  INFO 16 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@611b3b49
2022-01-16 11:08:02.248  INFO 16 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-revoke-extra, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@611b3b49
2022-01-16 11:08:02.258  INFO 16 --- [https-jsse-nio-7071-exec-1] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18909733202949822-906662, decision=PERMIT, pdp-result=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}})
2022-01-16 11:08:02.258  INFO 16 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=b8a5c1c2-4e08-414c-b81d-cf363ffde892, content=PERMIT, timestamp=1642331282258, pdpResult=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}}))
2022-01-16 11:08:02.258  INFO 16 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=157ms, Total=161ms
2022-01-16 11:08:02.276  INFO 16 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=7d3c765e-afe2-4d64-b875-2942cd79bdfc, content=null, timestamp=1642331282272, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=50392, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=5fb2fe03fb5a, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=7187b2ea-af71-4106-9885-90a594c75da9, http-req-server-port=80, http-header-accept=*/*, kc-id=6b662965-9581-452d-9a8e-efb17f194ea0, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642331282271, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeP9sHNxAH4AEQAAAABh4/yEdAAkNmI2NjI5NjUtOTU4MS00NTJkLTlhOGUtZWZiMTdmMTk0ZWEwdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ3MTg3YjJlYS1hZjcxLTQxMDYtOTg4NS05MGE1OTRjNzVkYTlwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICI2cGUwZ2U1ck0zU2E2SUt5WXBsLTVkQTZrVXVleWo3X1psV2c1aDU4MmFvIn0.eyJleHAiOjE2NDIzMzE1NjgsImlhdCI6MTY0MjMzMTI2OCwianRpIjoiNmI2NjI5NjUtOTU4MS00NTJkLTlhOGUtZWZiMTdmMTk0ZWEwIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiI3MTg3YjJlYS1hZjcxLTQxMDYtOTg4NS05MGE1OTRjNzVkYTkiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.omg8lBi8aYXNKFtyz-59LVSg2a2tCMxJ-pijDZk_PJuP3t0KLP9mK065sgr18j9RRLlhB5Gz2kgicFArxHtivEl0gUXu61vDMI1JwNX-iJP3IW1nOuz1niWS06XTsBAs3FLboN9JCzCrlyLSB7kFOSKNyr9gnqXqesWQU1H_s6k9aowpZ2V4aNEsojTx4jRXH2wCNB77m23zlaTQfbhQx_Hi4ZBiiOFCmRXadXaP0PC2LKecdNH4x8WAIIR9Jxwe-mzphLjj5_er637GhiPlR7lUQk9Yn4L72NWb6IEYvcz5_B5E73AFiU_xFR5kcOBPp-wTl_8-LRcBhxSaV9WLrA, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642331568, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.48.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=C256BFFC6B78DFCD362FD504A623D1C7, http-session-last-accessed-time=1642331282271, kc-category-name=ACCESS, kc-iat=1642331268, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:50392 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:08:02.277  INFO 16 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:08:02.278  INFO 16 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1181a6c8
2022-01-16 11:08:02.278  INFO 16 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1181a6c8
2022-01-16 11:08:02.338  INFO 16 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1181a6c8
2022-01-16 11:08:02.338  INFO 16 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1181a6c8
2022-01-16 11:08:02.352  INFO 16 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1181a6c8
2022-01-16 11:08:02.352  WARN 16 --- [https-jsse-nio-7071-exec-2] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:08:02.352  WARN 16 --- [https-jsse-nio-7071-exec-2] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:08:02.353  INFO 16 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1181a6c8
2022-01-16 11:08:02.353  INFO 16 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1181a6c8
2022-01-16 11:08:02.353  WARN 16 --- [https-jsse-nio-7071-exec-2] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:08:02.353  WARN 16 --- [https-jsse-nio-7071-exec-2] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:08:02.353  INFO 16 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1181a6c8
2022-01-16 11:08:02.363  INFO 16 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: emergency-active, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1181a6c8
2022-01-16 11:08:02.413  INFO 16 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1181a6c8
2022-01-16 11:08:02.414  INFO 16 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1181a6c8
2022-01-16 11:08:02.438  INFO 16 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1181a6c8
2022-01-16 11:08:02.438  INFO 16 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-revoke-extra, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1181a6c8
2022-01-16 11:08:02.453  INFO 16 --- [https-jsse-nio-7071-exec-2] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18909733378726666-306751, decision=PERMIT, pdp-result=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}})
2022-01-16 11:08:02.454  INFO 16 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=7d3c765e-afe2-4d64-b875-2942cd79bdfc, content=PERMIT, timestamp=1642331282454, pdpResult=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}}))
2022-01-16 11:08:02.454  INFO 16 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=177ms, Total=179ms
2022-01-16 11:08:02.477  INFO 16 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=25b0689f-9d75-4b88-80c7-a089860b2a74, content=null, timestamp=1642331282471, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=50394, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=5fb2fe03fb5a, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=7187b2ea-af71-4106-9885-90a594c75da9, http-req-server-port=80, http-header-accept=*/*, kc-id=6b662965-9581-452d-9a8e-efb17f194ea0, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642331282470, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeP9sHNxAH4AEQAAAABh4/yEdAAkNmI2NjI5NjUtOTU4MS00NTJkLTlhOGUtZWZiMTdmMTk0ZWEwdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ3MTg3YjJlYS1hZjcxLTQxMDYtOTg4NS05MGE1OTRjNzVkYTlwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICI2cGUwZ2U1ck0zU2E2SUt5WXBsLTVkQTZrVXVleWo3X1psV2c1aDU4MmFvIn0.eyJleHAiOjE2NDIzMzE1NjgsImlhdCI6MTY0MjMzMTI2OCwianRpIjoiNmI2NjI5NjUtOTU4MS00NTJkLTlhOGUtZWZiMTdmMTk0ZWEwIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiI3MTg3YjJlYS1hZjcxLTQxMDYtOTg4NS05MGE1OTRjNzVkYTkiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.omg8lBi8aYXNKFtyz-59LVSg2a2tCMxJ-pijDZk_PJuP3t0KLP9mK065sgr18j9RRLlhB5Gz2kgicFArxHtivEl0gUXu61vDMI1JwNX-iJP3IW1nOuz1niWS06XTsBAs3FLboN9JCzCrlyLSB7kFOSKNyr9gnqXqesWQU1H_s6k9aowpZ2V4aNEsojTx4jRXH2wCNB77m23zlaTQfbhQx_Hi4ZBiiOFCmRXadXaP0PC2LKecdNH4x8WAIIR9Jxwe-mzphLjj5_er637GhiPlR7lUQk9Yn4L72NWb6IEYvcz5_B5E73AFiU_xFR5kcOBPp-wTl_8-LRcBhxSaV9WLrA, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642331568, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.48.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=22449DED96B34AD5AB0ADDC87F7041C5, http-session-last-accessed-time=1642331282470, kc-category-name=ACCESS, kc-iat=1642331268, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:50394 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:08:02.480  INFO 16 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:08:02.481  INFO 16 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5ee60ccf
2022-01-16 11:08:02.482  INFO 16 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5ee60ccf
2022-01-16 11:08:02.542  INFO 16 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5ee60ccf
2022-01-16 11:08:02.543  INFO 16 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5ee60ccf
2022-01-16 11:08:02.555  INFO 16 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5ee60ccf
2022-01-16 11:08:02.556  WARN 16 --- [https-jsse-nio-7071-exec-3] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:08:02.556  WARN 16 --- [https-jsse-nio-7071-exec-3] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:08:02.557  INFO 16 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5ee60ccf
2022-01-16 11:08:02.558  INFO 16 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5ee60ccf
2022-01-16 11:08:02.559  WARN 16 --- [https-jsse-nio-7071-exec-3] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:08:02.559  WARN 16 --- [https-jsse-nio-7071-exec-3] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:08:02.560  INFO 16 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5ee60ccf
2022-01-16 11:08:02.572  INFO 16 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: emergency-active, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5ee60ccf
2022-01-16 11:08:02.625  INFO 16 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5ee60ccf
2022-01-16 11:08:02.626  INFO 16 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5ee60ccf
2022-01-16 11:08:02.637  INFO 16 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5ee60ccf
2022-01-16 11:08:02.637  INFO 16 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-revoke-extra, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5ee60ccf
2022-01-16 11:08:02.645  INFO 16 --- [https-jsse-nio-7071-exec-3] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18909733581611473-513755, decision=PERMIT, pdp-result=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}})
2022-01-16 11:08:02.646  INFO 16 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=25b0689f-9d75-4b88-80c7-a089860b2a74, content=PERMIT, timestamp=1642331282646, pdpResult=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}}))
2022-01-16 11:08:02.647  INFO 16 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=166ms, Total=171ms
2022-01-16 11:08:02.670  INFO 16 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=54b7f9d1-1c21-444f-ad76-4326d00d0af1, content=null, timestamp=1642331282664, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=50396, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=5fb2fe03fb5a, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=7187b2ea-af71-4106-9885-90a594c75da9, http-req-server-port=80, http-header-accept=*/*, kc-id=6b662965-9581-452d-9a8e-efb17f194ea0, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642331282663, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeP9sHNxAH4AEQAAAABh4/yEdAAkNmI2NjI5NjUtOTU4MS00NTJkLTlhOGUtZWZiMTdmMTk0ZWEwdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ3MTg3YjJlYS1hZjcxLTQxMDYtOTg4NS05MGE1OTRjNzVkYTlwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICI2cGUwZ2U1ck0zU2E2SUt5WXBsLTVkQTZrVXVleWo3X1psV2c1aDU4MmFvIn0.eyJleHAiOjE2NDIzMzE1NjgsImlhdCI6MTY0MjMzMTI2OCwianRpIjoiNmI2NjI5NjUtOTU4MS00NTJkLTlhOGUtZWZiMTdmMTk0ZWEwIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiI3MTg3YjJlYS1hZjcxLTQxMDYtOTg4NS05MGE1OTRjNzVkYTkiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.omg8lBi8aYXNKFtyz-59LVSg2a2tCMxJ-pijDZk_PJuP3t0KLP9mK065sgr18j9RRLlhB5Gz2kgicFArxHtivEl0gUXu61vDMI1JwNX-iJP3IW1nOuz1niWS06XTsBAs3FLboN9JCzCrlyLSB7kFOSKNyr9gnqXqesWQU1H_s6k9aowpZ2V4aNEsojTx4jRXH2wCNB77m23zlaTQfbhQx_Hi4ZBiiOFCmRXadXaP0PC2LKecdNH4x8WAIIR9Jxwe-mzphLjj5_er637GhiPlR7lUQk9Yn4L72NWb6IEYvcz5_B5E73AFiU_xFR5kcOBPp-wTl_8-LRcBhxSaV9WLrA, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642331568, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.48.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=7D3A2F88A17FBE23DCDB419793339ED6, http-session-last-accessed-time=1642331282663, kc-category-name=ACCESS, kc-iat=1642331268, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:50396 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:08:02.670  INFO 16 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:08:02.671  INFO 16 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6bf63d2f
2022-01-16 11:08:02.671  INFO 16 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6bf63d2f
2022-01-16 11:08:02.721  INFO 16 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6bf63d2f
2022-01-16 11:08:02.721  INFO 16 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6bf63d2f
2022-01-16 11:08:02.737  INFO 16 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6bf63d2f
2022-01-16 11:08:02.737  WARN 16 --- [https-jsse-nio-7071-exec-4] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:08:02.738  WARN 16 --- [https-jsse-nio-7071-exec-4] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:08:02.738  INFO 16 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6bf63d2f
2022-01-16 11:08:02.738  INFO 16 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6bf63d2f
2022-01-16 11:08:02.738  WARN 16 --- [https-jsse-nio-7071-exec-4] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:08:02.738  WARN 16 --- [https-jsse-nio-7071-exec-4] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:08:02.738  INFO 16 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6bf63d2f
2022-01-16 11:08:02.750  INFO 16 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: emergency-active, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6bf63d2f
2022-01-16 11:08:02.801  INFO 16 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6bf63d2f
2022-01-16 11:08:02.802  INFO 16 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6bf63d2f
2022-01-16 11:08:02.812  INFO 16 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6bf63d2f
2022-01-16 11:08:02.813  INFO 16 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-revoke-extra, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6bf63d2f
2022-01-16 11:08:02.822  INFO 16 --- [https-jsse-nio-7071-exec-4] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18909733771945750-203414, decision=PERMIT, pdp-result=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}})
2022-01-16 11:08:02.822  INFO 16 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=54b7f9d1-1c21-444f-ad76-4326d00d0af1, content=PERMIT, timestamp=1642331282822, pdpResult=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}}))
2022-01-16 11:08:02.823  INFO 16 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=152ms, Total=154ms
2022-01-16 11:08:02.848  INFO 16 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=5b960690-5e4d-48da-82bf-b57362b91109, content=null, timestamp=1642331282842, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=50398, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=5fb2fe03fb5a, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=7187b2ea-af71-4106-9885-90a594c75da9, http-req-server-port=80, http-header-accept=*/*, kc-id=6b662965-9581-452d-9a8e-efb17f194ea0, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642331282841, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeP9sHNxAH4AEQAAAABh4/yEdAAkNmI2NjI5NjUtOTU4MS00NTJkLTlhOGUtZWZiMTdmMTk0ZWEwdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ3MTg3YjJlYS1hZjcxLTQxMDYtOTg4NS05MGE1OTRjNzVkYTlwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICI2cGUwZ2U1ck0zU2E2SUt5WXBsLTVkQTZrVXVleWo3X1psV2c1aDU4MmFvIn0.eyJleHAiOjE2NDIzMzE1NjgsImlhdCI6MTY0MjMzMTI2OCwianRpIjoiNmI2NjI5NjUtOTU4MS00NTJkLTlhOGUtZWZiMTdmMTk0ZWEwIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiI3MTg3YjJlYS1hZjcxLTQxMDYtOTg4NS05MGE1OTRjNzVkYTkiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.omg8lBi8aYXNKFtyz-59LVSg2a2tCMxJ-pijDZk_PJuP3t0KLP9mK065sgr18j9RRLlhB5Gz2kgicFArxHtivEl0gUXu61vDMI1JwNX-iJP3IW1nOuz1niWS06XTsBAs3FLboN9JCzCrlyLSB7kFOSKNyr9gnqXqesWQU1H_s6k9aowpZ2V4aNEsojTx4jRXH2wCNB77m23zlaTQfbhQx_Hi4ZBiiOFCmRXadXaP0PC2LKecdNH4x8WAIIR9Jxwe-mzphLjj5_er637GhiPlR7lUQk9Yn4L72NWb6IEYvcz5_B5E73AFiU_xFR5kcOBPp-wTl_8-LRcBhxSaV9WLrA, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642331568, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.48.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=A0139A000387198803287B0F72B3D425, http-session-last-accessed-time=1642331282841, kc-category-name=ACCESS, kc-iat=1642331268, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:50398 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:08:02.848  INFO 16 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:08:02.849  INFO 16 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@45c73295
2022-01-16 11:08:02.849  INFO 16 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@45c73295
2022-01-16 11:08:02.902  INFO 16 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@45c73295
2022-01-16 11:08:02.902  INFO 16 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@45c73295
2022-01-16 11:08:02.914  INFO 16 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@45c73295
2022-01-16 11:08:02.914  WARN 16 --- [https-jsse-nio-7071-exec-5] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:08:02.915  WARN 16 --- [https-jsse-nio-7071-exec-5] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:08:02.915  INFO 16 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@45c73295
2022-01-16 11:08:02.916  INFO 16 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@45c73295
2022-01-16 11:08:02.916  WARN 16 --- [https-jsse-nio-7071-exec-5] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:08:02.917  WARN 16 --- [https-jsse-nio-7071-exec-5] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:08:02.917  INFO 16 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@45c73295
2022-01-16 11:08:02.926  INFO 16 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: emergency-active, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@45c73295
2022-01-16 11:08:02.981  INFO 16 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@45c73295
2022-01-16 11:08:02.982  INFO 16 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@45c73295
2022-01-16 11:08:02.999  INFO 16 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@45c73295
2022-01-16 11:08:02.999  INFO 16 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-revoke-extra, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@45c73295
2022-01-16 11:08:03.010  INFO 16 --- [https-jsse-nio-7071-exec-5] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18909733949733375-614914, decision=PERMIT, pdp-result=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}})
2022-01-16 11:08:03.010  INFO 16 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=5b960690-5e4d-48da-82bf-b57362b91109, content=PERMIT, timestamp=1642331283010, pdpResult=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}}))
2022-01-16 11:08:03.011  INFO 16 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=162ms, Total=165ms
2022-01-16 11:08:03.040  INFO 16 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=518f2524-73bd-474f-bb9d-b05cdaf6c70b, content=null, timestamp=1642331283035, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=50400, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=5fb2fe03fb5a, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=7187b2ea-af71-4106-9885-90a594c75da9, http-req-server-port=80, http-header-accept=*/*, kc-id=6b662965-9581-452d-9a8e-efb17f194ea0, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642331283033, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeP9sHNxAH4AEQAAAABh4/yEdAAkNmI2NjI5NjUtOTU4MS00NTJkLTlhOGUtZWZiMTdmMTk0ZWEwdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ3MTg3YjJlYS1hZjcxLTQxMDYtOTg4NS05MGE1OTRjNzVkYTlwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICI2cGUwZ2U1ck0zU2E2SUt5WXBsLTVkQTZrVXVleWo3X1psV2c1aDU4MmFvIn0.eyJleHAiOjE2NDIzMzE1NjgsImlhdCI6MTY0MjMzMTI2OCwianRpIjoiNmI2NjI5NjUtOTU4MS00NTJkLTlhOGUtZWZiMTdmMTk0ZWEwIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiI3MTg3YjJlYS1hZjcxLTQxMDYtOTg4NS05MGE1OTRjNzVkYTkiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.omg8lBi8aYXNKFtyz-59LVSg2a2tCMxJ-pijDZk_PJuP3t0KLP9mK065sgr18j9RRLlhB5Gz2kgicFArxHtivEl0gUXu61vDMI1JwNX-iJP3IW1nOuz1niWS06XTsBAs3FLboN9JCzCrlyLSB7kFOSKNyr9gnqXqesWQU1H_s6k9aowpZ2V4aNEsojTx4jRXH2wCNB77m23zlaTQfbhQx_Hi4ZBiiOFCmRXadXaP0PC2LKecdNH4x8WAIIR9Jxwe-mzphLjj5_er637GhiPlR7lUQk9Yn4L72NWb6IEYvcz5_B5E73AFiU_xFR5kcOBPp-wTl_8-LRcBhxSaV9WLrA, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642331568, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.48.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=B49E1A46B4D16329669631D9FF0004EF, http-session-last-accessed-time=1642331283033, kc-category-name=ACCESS, kc-iat=1642331268, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:50400 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:08:03.041  INFO 16 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:08:03.042  INFO 16 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@657cfaad
2022-01-16 11:08:03.042  INFO 16 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@657cfaad
2022-01-16 11:08:03.097  INFO 16 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@657cfaad
2022-01-16 11:08:03.098  INFO 16 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@657cfaad
2022-01-16 11:08:03.107  INFO 16 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@657cfaad
2022-01-16 11:08:03.107  WARN 16 --- [https-jsse-nio-7071-exec-6] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:08:03.108  WARN 16 --- [https-jsse-nio-7071-exec-6] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:08:03.108  INFO 16 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@657cfaad
2022-01-16 11:08:03.108  INFO 16 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@657cfaad
2022-01-16 11:08:03.109  WARN 16 --- [https-jsse-nio-7071-exec-6] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:08:03.109  WARN 16 --- [https-jsse-nio-7071-exec-6] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:08:03.109  INFO 16 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@657cfaad
2022-01-16 11:08:03.118  INFO 16 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: emergency-active, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@657cfaad
2022-01-16 11:08:03.169  INFO 16 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@657cfaad
2022-01-16 11:08:03.169  INFO 16 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@657cfaad
2022-01-16 11:08:03.178  INFO 16 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@657cfaad
2022-01-16 11:08:03.178  INFO 16 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-revoke-extra, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@657cfaad
2022-01-16 11:08:03.187  INFO 16 --- [https-jsse-nio-7071-exec-6] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18909734142332433-202768, decision=PERMIT, pdp-result=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}})
2022-01-16 11:08:03.187  INFO 16 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=518f2524-73bd-474f-bb9d-b05cdaf6c70b, content=PERMIT, timestamp=1642331283187, pdpResult=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}}))
2022-01-16 11:08:03.187  INFO 16 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=146ms, Total=148ms
2022-01-16 11:08:03.206  INFO 16 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=3fd69f3e-69b0-4f79-874f-466772f4c285, content=null, timestamp=1642331283202, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=50402, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=5fb2fe03fb5a, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=7187b2ea-af71-4106-9885-90a594c75da9, http-req-server-port=80, http-header-accept=*/*, kc-id=6b662965-9581-452d-9a8e-efb17f194ea0, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642331283201, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeP9sHNxAH4AEQAAAABh4/yEdAAkNmI2NjI5NjUtOTU4MS00NTJkLTlhOGUtZWZiMTdmMTk0ZWEwdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ3MTg3YjJlYS1hZjcxLTQxMDYtOTg4NS05MGE1OTRjNzVkYTlwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICI2cGUwZ2U1ck0zU2E2SUt5WXBsLTVkQTZrVXVleWo3X1psV2c1aDU4MmFvIn0.eyJleHAiOjE2NDIzMzE1NjgsImlhdCI6MTY0MjMzMTI2OCwianRpIjoiNmI2NjI5NjUtOTU4MS00NTJkLTlhOGUtZWZiMTdmMTk0ZWEwIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiI3MTg3YjJlYS1hZjcxLTQxMDYtOTg4NS05MGE1OTRjNzVkYTkiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.omg8lBi8aYXNKFtyz-59LVSg2a2tCMxJ-pijDZk_PJuP3t0KLP9mK065sgr18j9RRLlhB5Gz2kgicFArxHtivEl0gUXu61vDMI1JwNX-iJP3IW1nOuz1niWS06XTsBAs3FLboN9JCzCrlyLSB7kFOSKNyr9gnqXqesWQU1H_s6k9aowpZ2V4aNEsojTx4jRXH2wCNB77m23zlaTQfbhQx_Hi4ZBiiOFCmRXadXaP0PC2LKecdNH4x8WAIIR9Jxwe-mzphLjj5_er637GhiPlR7lUQk9Yn4L72NWb6IEYvcz5_B5E73AFiU_xFR5kcOBPp-wTl_8-LRcBhxSaV9WLrA, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642331568, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.48.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=BBD567DF4DB696F43CA1766550D145D7, http-session-last-accessed-time=1642331283201, kc-category-name=ACCESS, kc-iat=1642331268, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:50402 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:08:03.207  INFO 16 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:08:03.208  INFO 16 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@497810ac
2022-01-16 11:08:03.208  INFO 16 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@497810ac
2022-01-16 11:08:03.261  INFO 16 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@497810ac
2022-01-16 11:08:03.262  INFO 16 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@497810ac
2022-01-16 11:08:03.278  INFO 16 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@497810ac
2022-01-16 11:08:03.278  WARN 16 --- [https-jsse-nio-7071-exec-7] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:08:03.278  WARN 16 --- [https-jsse-nio-7071-exec-7] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:08:03.279  INFO 16 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@497810ac
2022-01-16 11:08:03.279  INFO 16 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@497810ac
2022-01-16 11:08:03.279  WARN 16 --- [https-jsse-nio-7071-exec-7] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:08:03.279  WARN 16 --- [https-jsse-nio-7071-exec-7] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:08:03.279  INFO 16 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@497810ac
2022-01-16 11:08:03.291  INFO 16 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: emergency-active, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@497810ac
2022-01-16 11:08:03.341  INFO 16 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@497810ac
2022-01-16 11:08:03.342  INFO 16 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@497810ac
2022-01-16 11:08:03.355  INFO 16 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@497810ac
2022-01-16 11:08:03.356  INFO 16 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-revoke-extra, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@497810ac
2022-01-16 11:08:03.367  INFO 16 --- [https-jsse-nio-7071-exec-7] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18909734308271545-558817, decision=PERMIT, pdp-result=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}})
2022-01-16 11:08:03.367  INFO 16 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=3fd69f3e-69b0-4f79-874f-466772f4c285, content=PERMIT, timestamp=1642331283367, pdpResult=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}}))
2022-01-16 11:08:03.368  INFO 16 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=160ms, Total=163ms
2022-01-16 11:08:03.390  INFO 16 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=a403d874-9921-4e13-b07b-f7e4ff3c6c6f, content=null, timestamp=1642331283384, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=50404, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=5fb2fe03fb5a, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=7187b2ea-af71-4106-9885-90a594c75da9, http-req-server-port=80, http-header-accept=*/*, kc-id=6b662965-9581-452d-9a8e-efb17f194ea0, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642331283383, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeP9sHNxAH4AEQAAAABh4/yEdAAkNmI2NjI5NjUtOTU4MS00NTJkLTlhOGUtZWZiMTdmMTk0ZWEwdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ3MTg3YjJlYS1hZjcxLTQxMDYtOTg4NS05MGE1OTRjNzVkYTlwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICI2cGUwZ2U1ck0zU2E2SUt5WXBsLTVkQTZrVXVleWo3X1psV2c1aDU4MmFvIn0.eyJleHAiOjE2NDIzMzE1NjgsImlhdCI6MTY0MjMzMTI2OCwianRpIjoiNmI2NjI5NjUtOTU4MS00NTJkLTlhOGUtZWZiMTdmMTk0ZWEwIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiI3MTg3YjJlYS1hZjcxLTQxMDYtOTg4NS05MGE1OTRjNzVkYTkiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.omg8lBi8aYXNKFtyz-59LVSg2a2tCMxJ-pijDZk_PJuP3t0KLP9mK065sgr18j9RRLlhB5Gz2kgicFArxHtivEl0gUXu61vDMI1JwNX-iJP3IW1nOuz1niWS06XTsBAs3FLboN9JCzCrlyLSB7kFOSKNyr9gnqXqesWQU1H_s6k9aowpZ2V4aNEsojTx4jRXH2wCNB77m23zlaTQfbhQx_Hi4ZBiiOFCmRXadXaP0PC2LKecdNH4x8WAIIR9Jxwe-mzphLjj5_er637GhiPlR7lUQk9Yn4L72NWb6IEYvcz5_B5E73AFiU_xFR5kcOBPp-wTl_8-LRcBhxSaV9WLrA, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642331568, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.48.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=DFB3ECF8E521A7C30CDC09DA057DDD27, http-session-last-accessed-time=1642331283383, kc-category-name=ACCESS, kc-iat=1642331268, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:50404 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:08:03.390  INFO 16 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:08:03.391  INFO 16 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@238f86cd
2022-01-16 11:08:03.391  INFO 16 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@238f86cd
2022-01-16 11:08:03.441  INFO 16 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@238f86cd
2022-01-16 11:08:03.441  INFO 16 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@238f86cd
2022-01-16 11:08:03.455  INFO 16 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@238f86cd
2022-01-16 11:08:03.456  WARN 16 --- [https-jsse-nio-7071-exec-8] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:08:03.456  WARN 16 --- [https-jsse-nio-7071-exec-8] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:08:03.456  INFO 16 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@238f86cd
2022-01-16 11:08:03.457  INFO 16 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@238f86cd
2022-01-16 11:08:03.457  WARN 16 --- [https-jsse-nio-7071-exec-8] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:08:03.457  WARN 16 --- [https-jsse-nio-7071-exec-8] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:08:03.458  INFO 16 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@238f86cd
2022-01-16 11:08:03.467  INFO 16 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: emergency-active, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@238f86cd
2022-01-16 11:08:03.517  INFO 16 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@238f86cd
2022-01-16 11:08:03.517  INFO 16 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@238f86cd
2022-01-16 11:08:03.539  INFO 16 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@238f86cd
2022-01-16 11:08:03.539  INFO 16 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-revoke-extra, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@238f86cd
2022-01-16 11:08:03.567  INFO 16 --- [https-jsse-nio-7071-exec-8] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18909734491606083-880486, decision=PERMIT, pdp-result=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}})
2022-01-16 11:08:03.567  INFO 16 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=a403d874-9921-4e13-b07b-f7e4ff3c6c6f, content=PERMIT, timestamp=1642331283567, pdpResult=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}}))
2022-01-16 11:08:03.568  INFO 16 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=177ms, Total=180ms
2022-01-16 11:08:03.592  INFO 16 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=9e6ce0ec-5baf-40eb-bcba-04300e26455a, content=null, timestamp=1642331283587, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=50406, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=5fb2fe03fb5a, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=7187b2ea-af71-4106-9885-90a594c75da9, http-req-server-port=80, http-header-accept=*/*, kc-id=6b662965-9581-452d-9a8e-efb17f194ea0, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642331283586, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeP9sHNxAH4AEQAAAABh4/yEdAAkNmI2NjI5NjUtOTU4MS00NTJkLTlhOGUtZWZiMTdmMTk0ZWEwdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ3MTg3YjJlYS1hZjcxLTQxMDYtOTg4NS05MGE1OTRjNzVkYTlwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICI2cGUwZ2U1ck0zU2E2SUt5WXBsLTVkQTZrVXVleWo3X1psV2c1aDU4MmFvIn0.eyJleHAiOjE2NDIzMzE1NjgsImlhdCI6MTY0MjMzMTI2OCwianRpIjoiNmI2NjI5NjUtOTU4MS00NTJkLTlhOGUtZWZiMTdmMTk0ZWEwIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiI3MTg3YjJlYS1hZjcxLTQxMDYtOTg4NS05MGE1OTRjNzVkYTkiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.omg8lBi8aYXNKFtyz-59LVSg2a2tCMxJ-pijDZk_PJuP3t0KLP9mK065sgr18j9RRLlhB5Gz2kgicFArxHtivEl0gUXu61vDMI1JwNX-iJP3IW1nOuz1niWS06XTsBAs3FLboN9JCzCrlyLSB7kFOSKNyr9gnqXqesWQU1H_s6k9aowpZ2V4aNEsojTx4jRXH2wCNB77m23zlaTQfbhQx_Hi4ZBiiOFCmRXadXaP0PC2LKecdNH4x8WAIIR9Jxwe-mzphLjj5_er637GhiPlR7lUQk9Yn4L72NWb6IEYvcz5_B5E73AFiU_xFR5kcOBPp-wTl_8-LRcBhxSaV9WLrA, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642331568, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.48.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=C915652D0AC382AF3D1FB0B6109F3E98, http-session-last-accessed-time=1642331283586, kc-category-name=ACCESS, kc-iat=1642331268, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:50406 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:08:03.592  INFO 16 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:08:03.593  INFO 16 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@64f81b61
2022-01-16 11:08:03.594  INFO 16 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@64f81b61
2022-01-16 11:08:03.645  INFO 16 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@64f81b61
2022-01-16 11:08:03.645  INFO 16 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@64f81b61
2022-01-16 11:08:03.654  INFO 16 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@64f81b61
2022-01-16 11:08:03.654  WARN 16 --- [https-jsse-nio-7071-exec-9] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:08:03.654  WARN 16 --- [https-jsse-nio-7071-exec-9] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:08:03.654  INFO 16 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@64f81b61
2022-01-16 11:08:03.655  INFO 16 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@64f81b61
2022-01-16 11:08:03.655  WARN 16 --- [https-jsse-nio-7071-exec-9] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:08:03.655  WARN 16 --- [https-jsse-nio-7071-exec-9] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:08:03.655  INFO 16 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@64f81b61
2022-01-16 11:08:03.666  INFO 16 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: emergency-active, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@64f81b61
2022-01-16 11:08:03.717  INFO 16 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@64f81b61
2022-01-16 11:08:03.718  INFO 16 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@64f81b61
2022-01-16 11:08:03.732  INFO 16 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@64f81b61
2022-01-16 11:08:03.732  INFO 16 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-revoke-extra, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@64f81b61
2022-01-16 11:08:03.743  INFO 16 --- [https-jsse-nio-7071-exec-9] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18909734693596631-147898, decision=PERMIT, pdp-result=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}})
2022-01-16 11:08:03.743  INFO 16 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=9e6ce0ec-5baf-40eb-bcba-04300e26455a, content=PERMIT, timestamp=1642331283743, pdpResult=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}}))
2022-01-16 11:08:03.744  INFO 16 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=151ms, Total=154ms
2022-01-16 11:08:03.765  INFO 16 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=90233c9b-5670-4f7b-a287-c787e18f83ed, content=null, timestamp=1642331283759, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=50408, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=5fb2fe03fb5a, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=7187b2ea-af71-4106-9885-90a594c75da9, http-req-server-port=80, http-header-accept=*/*, kc-id=6b662965-9581-452d-9a8e-efb17f194ea0, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642331283758, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeP9sHNxAH4AEQAAAABh4/yEdAAkNmI2NjI5NjUtOTU4MS00NTJkLTlhOGUtZWZiMTdmMTk0ZWEwdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ3MTg3YjJlYS1hZjcxLTQxMDYtOTg4NS05MGE1OTRjNzVkYTlwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICI2cGUwZ2U1ck0zU2E2SUt5WXBsLTVkQTZrVXVleWo3X1psV2c1aDU4MmFvIn0.eyJleHAiOjE2NDIzMzE1NjgsImlhdCI6MTY0MjMzMTI2OCwianRpIjoiNmI2NjI5NjUtOTU4MS00NTJkLTlhOGUtZWZiMTdmMTk0ZWEwIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiI3MTg3YjJlYS1hZjcxLTQxMDYtOTg4NS05MGE1OTRjNzVkYTkiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.omg8lBi8aYXNKFtyz-59LVSg2a2tCMxJ-pijDZk_PJuP3t0KLP9mK065sgr18j9RRLlhB5Gz2kgicFArxHtivEl0gUXu61vDMI1JwNX-iJP3IW1nOuz1niWS06XTsBAs3FLboN9JCzCrlyLSB7kFOSKNyr9gnqXqesWQU1H_s6k9aowpZ2V4aNEsojTx4jRXH2wCNB77m23zlaTQfbhQx_Hi4ZBiiOFCmRXadXaP0PC2LKecdNH4x8WAIIR9Jxwe-mzphLjj5_er637GhiPlR7lUQk9Yn4L72NWb6IEYvcz5_B5E73AFiU_xFR5kcOBPp-wTl_8-LRcBhxSaV9WLrA, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642331568, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.48.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=2BB4659C87827C5F59500C89BDD4874A, http-session-last-accessed-time=1642331283758, kc-category-name=ACCESS, kc-iat=1642331268, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:50408 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:08:03.765  INFO 16 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:08:03.766  INFO 16 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3eacaf01
2022-01-16 11:08:03.766  INFO 16 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3eacaf01
2022-01-16 11:08:03.825  INFO 16 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3eacaf01
2022-01-16 11:08:03.826  INFO 16 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3eacaf01
2022-01-16 11:08:03.836  INFO 16 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3eacaf01
2022-01-16 11:08:03.836  WARN 16 --- [https-jsse-nio-7071-exec-10] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:08:03.837  WARN 16 --- [https-jsse-nio-7071-exec-10] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:08:03.837  INFO 16 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3eacaf01
2022-01-16 11:08:03.838  INFO 16 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3eacaf01
2022-01-16 11:08:03.838  WARN 16 --- [https-jsse-nio-7071-exec-10] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:08:03.838  WARN 16 --- [https-jsse-nio-7071-exec-10] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:08:03.839  INFO 16 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3eacaf01
2022-01-16 11:08:03.847  INFO 16 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: emergency-active, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3eacaf01
2022-01-16 11:08:03.897  INFO 16 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3eacaf01
2022-01-16 11:08:03.897  INFO 16 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3eacaf01
2022-01-16 11:08:03.911  INFO 16 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3eacaf01
2022-01-16 11:08:03.911  INFO 16 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-revoke-extra, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3eacaf01
2022-01-16 11:08:03.921  INFO 16 --- [https-jsse-nio-7071-exec-10] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18909734866790270-557489, decision=PERMIT, pdp-result=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}})
2022-01-16 11:08:03.921  INFO 16 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=90233c9b-5670-4f7b-a287-c787e18f83ed, content=PERMIT, timestamp=1642331283921, pdpResult=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}}))
2022-01-16 11:08:03.922  INFO 16 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=156ms, Total=159ms
2022-01-16 11:08:03.945  INFO 16 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=97a32c45-5b13-49f1-b6e6-851638ca638f, content=null, timestamp=1642331283941, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=50410, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=5fb2fe03fb5a, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=7187b2ea-af71-4106-9885-90a594c75da9, http-req-server-port=80, http-header-accept=*/*, kc-id=6b662965-9581-452d-9a8e-efb17f194ea0, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642331283940, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeP9sHNxAH4AEQAAAABh4/yEdAAkNmI2NjI5NjUtOTU4MS00NTJkLTlhOGUtZWZiMTdmMTk0ZWEwdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ3MTg3YjJlYS1hZjcxLTQxMDYtOTg4NS05MGE1OTRjNzVkYTlwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICI2cGUwZ2U1ck0zU2E2SUt5WXBsLTVkQTZrVXVleWo3X1psV2c1aDU4MmFvIn0.eyJleHAiOjE2NDIzMzE1NjgsImlhdCI6MTY0MjMzMTI2OCwianRpIjoiNmI2NjI5NjUtOTU4MS00NTJkLTlhOGUtZWZiMTdmMTk0ZWEwIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiI3MTg3YjJlYS1hZjcxLTQxMDYtOTg4NS05MGE1OTRjNzVkYTkiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.omg8lBi8aYXNKFtyz-59LVSg2a2tCMxJ-pijDZk_PJuP3t0KLP9mK065sgr18j9RRLlhB5Gz2kgicFArxHtivEl0gUXu61vDMI1JwNX-iJP3IW1nOuz1niWS06XTsBAs3FLboN9JCzCrlyLSB7kFOSKNyr9gnqXqesWQU1H_s6k9aowpZ2V4aNEsojTx4jRXH2wCNB77m23zlaTQfbhQx_Hi4ZBiiOFCmRXadXaP0PC2LKecdNH4x8WAIIR9Jxwe-mzphLjj5_er637GhiPlR7lUQk9Yn4L72NWb6IEYvcz5_B5E73AFiU_xFR5kcOBPp-wTl_8-LRcBhxSaV9WLrA, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642331568, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.48.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=91CC6AFF991695E64B8764A2CD670D16, http-session-last-accessed-time=1642331283940, kc-category-name=ACCESS, kc-iat=1642331268, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:50410 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:08:03.946  INFO 16 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:08:03.946  INFO 16 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6c838348
2022-01-16 11:08:03.947  INFO 16 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6c838348
2022-01-16 11:08:03.997  INFO 16 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6c838348
2022-01-16 11:08:03.998  INFO 16 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6c838348
2022-01-16 11:08:04.013  INFO 16 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6c838348
2022-01-16 11:08:04.013  WARN 16 --- [https-jsse-nio-7071-exec-1] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:08:04.013  WARN 16 --- [https-jsse-nio-7071-exec-1] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:08:04.013  INFO 16 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6c838348
2022-01-16 11:08:04.013  INFO 16 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6c838348
2022-01-16 11:08:04.014  WARN 16 --- [https-jsse-nio-7071-exec-1] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:08:04.014  WARN 16 --- [https-jsse-nio-7071-exec-1] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:08:04.014  INFO 16 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6c838348
2022-01-16 11:08:04.026  INFO 16 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: emergency-active, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6c838348
2022-01-16 11:08:04.077  INFO 16 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6c838348
2022-01-16 11:08:04.078  INFO 16 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6c838348
2022-01-16 11:08:04.089  INFO 16 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6c838348
2022-01-16 11:08:04.090  INFO 16 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-revoke-extra, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6c838348
2022-01-16 11:08:04.099  INFO 16 --- [https-jsse-nio-7071-exec-1] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18909735047219945-567519, decision=PERMIT, pdp-result=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}})
2022-01-16 11:08:04.100  INFO 16 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=97a32c45-5b13-49f1-b6e6-851638ca638f, content=PERMIT, timestamp=1642331284100, pdpResult=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}}))
2022-01-16 11:08:04.101  INFO 16 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=154ms, Total=157ms
2022-01-16 11:08:04.123  INFO 16 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=bdba0498-78a3-469d-bf3f-91abff57f3cf, content=null, timestamp=1642331284117, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=50412, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=5fb2fe03fb5a, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=7187b2ea-af71-4106-9885-90a594c75da9, http-req-server-port=80, http-header-accept=*/*, kc-id=6b662965-9581-452d-9a8e-efb17f194ea0, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642331284115, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeP9sHNxAH4AEQAAAABh4/yEdAAkNmI2NjI5NjUtOTU4MS00NTJkLTlhOGUtZWZiMTdmMTk0ZWEwdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ3MTg3YjJlYS1hZjcxLTQxMDYtOTg4NS05MGE1OTRjNzVkYTlwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICI2cGUwZ2U1ck0zU2E2SUt5WXBsLTVkQTZrVXVleWo3X1psV2c1aDU4MmFvIn0.eyJleHAiOjE2NDIzMzE1NjgsImlhdCI6MTY0MjMzMTI2OCwianRpIjoiNmI2NjI5NjUtOTU4MS00NTJkLTlhOGUtZWZiMTdmMTk0ZWEwIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiI3MTg3YjJlYS1hZjcxLTQxMDYtOTg4NS05MGE1OTRjNzVkYTkiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.omg8lBi8aYXNKFtyz-59LVSg2a2tCMxJ-pijDZk_PJuP3t0KLP9mK065sgr18j9RRLlhB5Gz2kgicFArxHtivEl0gUXu61vDMI1JwNX-iJP3IW1nOuz1niWS06XTsBAs3FLboN9JCzCrlyLSB7kFOSKNyr9gnqXqesWQU1H_s6k9aowpZ2V4aNEsojTx4jRXH2wCNB77m23zlaTQfbhQx_Hi4ZBiiOFCmRXadXaP0PC2LKecdNH4x8WAIIR9Jxwe-mzphLjj5_er637GhiPlR7lUQk9Yn4L72NWb6IEYvcz5_B5E73AFiU_xFR5kcOBPp-wTl_8-LRcBhxSaV9WLrA, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642331568, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.48.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=379B93F32CB506F94F8A172ABE372A80, http-session-last-accessed-time=1642331284115, kc-category-name=ACCESS, kc-iat=1642331268, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:50412 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:08:04.123  INFO 16 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:08:04.124  INFO 16 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@f2dfefd
2022-01-16 11:08:04.124  INFO 16 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@f2dfefd
2022-01-16 11:08:04.173  INFO 16 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@f2dfefd
2022-01-16 11:08:04.174  INFO 16 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@f2dfefd
2022-01-16 11:08:04.185  INFO 16 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@f2dfefd
2022-01-16 11:08:04.186  WARN 16 --- [https-jsse-nio-7071-exec-2] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:08:04.186  WARN 16 --- [https-jsse-nio-7071-exec-2] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:08:04.195  INFO 16 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@f2dfefd
2022-01-16 11:08:04.196  INFO 16 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@f2dfefd
2022-01-16 11:08:04.196  WARN 16 --- [https-jsse-nio-7071-exec-2] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:08:04.196  WARN 16 --- [https-jsse-nio-7071-exec-2] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:08:04.196  INFO 16 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@f2dfefd
2022-01-16 11:08:04.205  INFO 16 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: emergency-active, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@f2dfefd
2022-01-16 11:08:04.261  INFO 16 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@f2dfefd
2022-01-16 11:08:04.262  INFO 16 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@f2dfefd
2022-01-16 11:08:04.272  INFO 16 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@f2dfefd
2022-01-16 11:08:04.273  INFO 16 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-revoke-extra, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@f2dfefd
2022-01-16 11:08:04.282  INFO 16 --- [https-jsse-nio-7071-exec-2] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18909735224633948-111726, decision=PERMIT, pdp-result=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}})
2022-01-16 11:08:04.282  INFO 16 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=bdba0498-78a3-469d-bf3f-91abff57f3cf, content=PERMIT, timestamp=1642331284282, pdpResult=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}}))
2022-01-16 11:08:04.283  INFO 16 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=159ms, Total=161ms
2022-01-16 11:08:04.304  INFO 16 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=7be2a297-2232-478a-810a-6b82d5ea0863, content=null, timestamp=1642331284300, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=50414, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=5fb2fe03fb5a, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=7187b2ea-af71-4106-9885-90a594c75da9, http-req-server-port=80, http-header-accept=*/*, kc-id=6b662965-9581-452d-9a8e-efb17f194ea0, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642331284298, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeP9sHNxAH4AEQAAAABh4/yEdAAkNmI2NjI5NjUtOTU4MS00NTJkLTlhOGUtZWZiMTdmMTk0ZWEwdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ3MTg3YjJlYS1hZjcxLTQxMDYtOTg4NS05MGE1OTRjNzVkYTlwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICI2cGUwZ2U1ck0zU2E2SUt5WXBsLTVkQTZrVXVleWo3X1psV2c1aDU4MmFvIn0.eyJleHAiOjE2NDIzMzE1NjgsImlhdCI6MTY0MjMzMTI2OCwianRpIjoiNmI2NjI5NjUtOTU4MS00NTJkLTlhOGUtZWZiMTdmMTk0ZWEwIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiI3MTg3YjJlYS1hZjcxLTQxMDYtOTg4NS05MGE1OTRjNzVkYTkiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.omg8lBi8aYXNKFtyz-59LVSg2a2tCMxJ-pijDZk_PJuP3t0KLP9mK065sgr18j9RRLlhB5Gz2kgicFArxHtivEl0gUXu61vDMI1JwNX-iJP3IW1nOuz1niWS06XTsBAs3FLboN9JCzCrlyLSB7kFOSKNyr9gnqXqesWQU1H_s6k9aowpZ2V4aNEsojTx4jRXH2wCNB77m23zlaTQfbhQx_Hi4ZBiiOFCmRXadXaP0PC2LKecdNH4x8WAIIR9Jxwe-mzphLjj5_er637GhiPlR7lUQk9Yn4L72NWb6IEYvcz5_B5E73AFiU_xFR5kcOBPp-wTl_8-LRcBhxSaV9WLrA, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642331568, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.48.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=F3BFDD77D6FF88036F648BAAA33FD57D, http-session-last-accessed-time=1642331284298, kc-category-name=ACCESS, kc-iat=1642331268, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:50414 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:08:04.304  INFO 16 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:08:04.306  INFO 16 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1e46ae6a
2022-01-16 11:08:04.307  INFO 16 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1e46ae6a
2022-01-16 11:08:04.357  INFO 16 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1e46ae6a
2022-01-16 11:08:04.358  INFO 16 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1e46ae6a
2022-01-16 11:08:04.370  INFO 16 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1e46ae6a
2022-01-16 11:08:04.370  WARN 16 --- [https-jsse-nio-7071-exec-3] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:08:04.370  WARN 16 --- [https-jsse-nio-7071-exec-3] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:08:04.371  INFO 16 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1e46ae6a
2022-01-16 11:08:04.371  INFO 16 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1e46ae6a
2022-01-16 11:08:04.372  WARN 16 --- [https-jsse-nio-7071-exec-3] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:08:04.372  WARN 16 --- [https-jsse-nio-7071-exec-3] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:08:04.372  INFO 16 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1e46ae6a
2022-01-16 11:08:04.382  INFO 16 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: emergency-active, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1e46ae6a
2022-01-16 11:08:04.433  INFO 16 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1e46ae6a
2022-01-16 11:08:04.434  INFO 16 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1e46ae6a
2022-01-16 11:08:04.449  INFO 16 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1e46ae6a
2022-01-16 11:08:04.449  INFO 16 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-revoke-extra, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1e46ae6a
2022-01-16 11:08:04.458  INFO 16 --- [https-jsse-nio-7071-exec-3] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18909735406151697-929105, decision=PERMIT, pdp-result=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}})
2022-01-16 11:08:04.458  INFO 16 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=7be2a297-2232-478a-810a-6b82d5ea0863, content=PERMIT, timestamp=1642331284458, pdpResult=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}}))
2022-01-16 11:08:04.458  INFO 16 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=153ms, Total=155ms
2022-01-16 11:08:04.481  INFO 16 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=142c4f23-a374-4e91-9429-58b29a1e0a7b, content=null, timestamp=1642331284476, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=50416, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=5fb2fe03fb5a, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=7187b2ea-af71-4106-9885-90a594c75da9, http-req-server-port=80, http-header-accept=*/*, kc-id=6b662965-9581-452d-9a8e-efb17f194ea0, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642331284474, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeP9sHNxAH4AEQAAAABh4/yEdAAkNmI2NjI5NjUtOTU4MS00NTJkLTlhOGUtZWZiMTdmMTk0ZWEwdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ3MTg3YjJlYS1hZjcxLTQxMDYtOTg4NS05MGE1OTRjNzVkYTlwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICI2cGUwZ2U1ck0zU2E2SUt5WXBsLTVkQTZrVXVleWo3X1psV2c1aDU4MmFvIn0.eyJleHAiOjE2NDIzMzE1NjgsImlhdCI6MTY0MjMzMTI2OCwianRpIjoiNmI2NjI5NjUtOTU4MS00NTJkLTlhOGUtZWZiMTdmMTk0ZWEwIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiI3MTg3YjJlYS1hZjcxLTQxMDYtOTg4NS05MGE1OTRjNzVkYTkiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.omg8lBi8aYXNKFtyz-59LVSg2a2tCMxJ-pijDZk_PJuP3t0KLP9mK065sgr18j9RRLlhB5Gz2kgicFArxHtivEl0gUXu61vDMI1JwNX-iJP3IW1nOuz1niWS06XTsBAs3FLboN9JCzCrlyLSB7kFOSKNyr9gnqXqesWQU1H_s6k9aowpZ2V4aNEsojTx4jRXH2wCNB77m23zlaTQfbhQx_Hi4ZBiiOFCmRXadXaP0PC2LKecdNH4x8WAIIR9Jxwe-mzphLjj5_er637GhiPlR7lUQk9Yn4L72NWb6IEYvcz5_B5E73AFiU_xFR5kcOBPp-wTl_8-LRcBhxSaV9WLrA, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642331568, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.48.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=B968BA365C27FCB2E7D436EB2331BBE8, http-session-last-accessed-time=1642331284474, kc-category-name=ACCESS, kc-iat=1642331268, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:50416 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:08:04.482  INFO 16 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:08:04.482  INFO 16 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@70829a7e
2022-01-16 11:08:04.482  INFO 16 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@70829a7e
2022-01-16 11:08:04.541  INFO 16 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@70829a7e
2022-01-16 11:08:04.541  INFO 16 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@70829a7e
2022-01-16 11:08:04.549  INFO 16 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@70829a7e
2022-01-16 11:08:04.549  WARN 16 --- [https-jsse-nio-7071-exec-4] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:08:04.549  WARN 16 --- [https-jsse-nio-7071-exec-4] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:08:04.550  INFO 16 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@70829a7e
2022-01-16 11:08:04.550  INFO 16 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@70829a7e
2022-01-16 11:08:04.550  WARN 16 --- [https-jsse-nio-7071-exec-4] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:08:04.550  WARN 16 --- [https-jsse-nio-7071-exec-4] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:08:04.550  INFO 16 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@70829a7e
2022-01-16 11:08:04.558  INFO 16 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: emergency-active, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@70829a7e
2022-01-16 11:08:04.609  INFO 16 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@70829a7e
2022-01-16 11:08:04.609  INFO 16 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@70829a7e
2022-01-16 11:08:04.624  INFO 16 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@70829a7e
2022-01-16 11:08:04.624  INFO 16 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-revoke-extra, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@70829a7e
2022-01-16 11:08:04.634  INFO 16 --- [https-jsse-nio-7071-exec-4] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18909735583189811-10674, decision=PERMIT, pdp-result=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}})
2022-01-16 11:08:04.634  INFO 16 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=142c4f23-a374-4e91-9429-58b29a1e0a7b, content=PERMIT, timestamp=1642331284634, pdpResult=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}}))
2022-01-16 11:08:04.635  INFO 16 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=152ms, Total=155ms
2022-01-16 11:08:04.659  INFO 16 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=afa3aa4b-9d1e-4f04-9cfc-e96f691f5385, content=null, timestamp=1642331284654, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=50418, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=5fb2fe03fb5a, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=7187b2ea-af71-4106-9885-90a594c75da9, http-req-server-port=80, http-header-accept=*/*, kc-id=6b662965-9581-452d-9a8e-efb17f194ea0, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642331284653, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeP9sHNxAH4AEQAAAABh4/yEdAAkNmI2NjI5NjUtOTU4MS00NTJkLTlhOGUtZWZiMTdmMTk0ZWEwdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ3MTg3YjJlYS1hZjcxLTQxMDYtOTg4NS05MGE1OTRjNzVkYTlwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICI2cGUwZ2U1ck0zU2E2SUt5WXBsLTVkQTZrVXVleWo3X1psV2c1aDU4MmFvIn0.eyJleHAiOjE2NDIzMzE1NjgsImlhdCI6MTY0MjMzMTI2OCwianRpIjoiNmI2NjI5NjUtOTU4MS00NTJkLTlhOGUtZWZiMTdmMTk0ZWEwIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiI3MTg3YjJlYS1hZjcxLTQxMDYtOTg4NS05MGE1OTRjNzVkYTkiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.omg8lBi8aYXNKFtyz-59LVSg2a2tCMxJ-pijDZk_PJuP3t0KLP9mK065sgr18j9RRLlhB5Gz2kgicFArxHtivEl0gUXu61vDMI1JwNX-iJP3IW1nOuz1niWS06XTsBAs3FLboN9JCzCrlyLSB7kFOSKNyr9gnqXqesWQU1H_s6k9aowpZ2V4aNEsojTx4jRXH2wCNB77m23zlaTQfbhQx_Hi4ZBiiOFCmRXadXaP0PC2LKecdNH4x8WAIIR9Jxwe-mzphLjj5_er637GhiPlR7lUQk9Yn4L72NWb6IEYvcz5_B5E73AFiU_xFR5kcOBPp-wTl_8-LRcBhxSaV9WLrA, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642331568, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.48.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=83EAEE3E6597B9D73005FE51D9B63662, http-session-last-accessed-time=1642331284653, kc-category-name=ACCESS, kc-iat=1642331268, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:50418 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:08:04.673  INFO 16 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:08:04.674  INFO 16 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@761c80be
2022-01-16 11:08:04.674  INFO 16 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@761c80be
2022-01-16 11:08:04.698  INFO 16 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@761c80be
2022-01-16 11:08:04.698  INFO 16 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@761c80be
2022-01-16 11:08:04.757  INFO 16 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@761c80be
2022-01-16 11:08:04.758  WARN 16 --- [https-jsse-nio-7071-exec-5] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:08:04.758  WARN 16 --- [https-jsse-nio-7071-exec-5] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:08:04.758  INFO 16 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@761c80be
2022-01-16 11:08:04.759  INFO 16 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@761c80be
2022-01-16 11:08:04.759  WARN 16 --- [https-jsse-nio-7071-exec-5] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:08:04.760  WARN 16 --- [https-jsse-nio-7071-exec-5] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:08:04.760  INFO 16 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@761c80be
2022-01-16 11:08:04.770  INFO 16 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: emergency-active, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@761c80be
2022-01-16 11:08:04.782  INFO 16 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@761c80be
2022-01-16 11:08:04.783  INFO 16 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@761c80be
2022-01-16 11:08:04.833  INFO 16 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@761c80be
2022-01-16 11:08:04.834  INFO 16 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-revoke-extra, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@761c80be
2022-01-16 11:08:04.853  INFO 16 --- [https-jsse-nio-7071-exec-5] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18909735774513861-728622, decision=PERMIT, pdp-result=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}})
2022-01-16 11:08:04.854  INFO 16 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=afa3aa4b-9d1e-4f04-9cfc-e96f691f5385, content=PERMIT, timestamp=1642331284854, pdpResult=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}}))
2022-01-16 11:08:04.856  INFO 16 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=181ms, Total=198ms
2022-01-16 11:08:04.880  INFO 16 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=19a35b90-bbcb-49df-97d1-b42586f7dd22, content=null, timestamp=1642331284874, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=50420, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=5fb2fe03fb5a, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=7187b2ea-af71-4106-9885-90a594c75da9, http-req-server-port=80, http-header-accept=*/*, kc-id=6b662965-9581-452d-9a8e-efb17f194ea0, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642331284872, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeP9sHNxAH4AEQAAAABh4/yEdAAkNmI2NjI5NjUtOTU4MS00NTJkLTlhOGUtZWZiMTdmMTk0ZWEwdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ3MTg3YjJlYS1hZjcxLTQxMDYtOTg4NS05MGE1OTRjNzVkYTlwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICI2cGUwZ2U1ck0zU2E2SUt5WXBsLTVkQTZrVXVleWo3X1psV2c1aDU4MmFvIn0.eyJleHAiOjE2NDIzMzE1NjgsImlhdCI6MTY0MjMzMTI2OCwianRpIjoiNmI2NjI5NjUtOTU4MS00NTJkLTlhOGUtZWZiMTdmMTk0ZWEwIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiI3MTg3YjJlYS1hZjcxLTQxMDYtOTg4NS05MGE1OTRjNzVkYTkiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.omg8lBi8aYXNKFtyz-59LVSg2a2tCMxJ-pijDZk_PJuP3t0KLP9mK065sgr18j9RRLlhB5Gz2kgicFArxHtivEl0gUXu61vDMI1JwNX-iJP3IW1nOuz1niWS06XTsBAs3FLboN9JCzCrlyLSB7kFOSKNyr9gnqXqesWQU1H_s6k9aowpZ2V4aNEsojTx4jRXH2wCNB77m23zlaTQfbhQx_Hi4ZBiiOFCmRXadXaP0PC2LKecdNH4x8WAIIR9Jxwe-mzphLjj5_er637GhiPlR7lUQk9Yn4L72NWb6IEYvcz5_B5E73AFiU_xFR5kcOBPp-wTl_8-LRcBhxSaV9WLrA, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642331568, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.48.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=226106028230FDD71DE31C210530B6CA, http-session-last-accessed-time=1642331284872, kc-category-name=ACCESS, kc-iat=1642331268, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:50420 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:08:04.881  INFO 16 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:08:04.882  INFO 16 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@780e5f7a
2022-01-16 11:08:04.882  INFO 16 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@780e5f7a
2022-01-16 11:08:04.906  INFO 16 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@780e5f7a
2022-01-16 11:08:04.906  INFO 16 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@780e5f7a
2022-01-16 11:08:04.965  INFO 16 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@780e5f7a
2022-01-16 11:08:04.966  WARN 16 --- [https-jsse-nio-7071-exec-6] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:08:04.967  WARN 16 --- [https-jsse-nio-7071-exec-6] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:08:04.968  INFO 16 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@780e5f7a
2022-01-16 11:08:04.969  INFO 16 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@780e5f7a
2022-01-16 11:08:04.970  WARN 16 --- [https-jsse-nio-7071-exec-6] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:08:04.971  WARN 16 --- [https-jsse-nio-7071-exec-6] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:08:04.971  INFO 16 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@780e5f7a
2022-01-16 11:08:04.980  INFO 16 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: emergency-active, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@780e5f7a
2022-01-16 11:08:04.989  INFO 16 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@780e5f7a
2022-01-16 11:08:04.990  INFO 16 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@780e5f7a
2022-01-16 11:08:05.042  INFO 16 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@780e5f7a
2022-01-16 11:08:05.043  INFO 16 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-revoke-extra, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@780e5f7a
2022-01-16 11:08:05.060  INFO 16 --- [https-jsse-nio-7071-exec-6] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18909735982910952-174673, decision=PERMIT, pdp-result=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}})
2022-01-16 11:08:05.061  INFO 16 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=19a35b90-bbcb-49df-97d1-b42586f7dd22, content=PERMIT, timestamp=1642331285061, pdpResult=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}}))
2022-01-16 11:08:05.062  INFO 16 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=180ms, Total=184ms
2022-01-16 11:08:05.092  INFO 16 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=7abb00c3-2399-41b8-b7ed-3139730cbdc1, content=null, timestamp=1642331285087, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=50422, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=5fb2fe03fb5a, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=7187b2ea-af71-4106-9885-90a594c75da9, http-req-server-port=80, http-header-accept=*/*, kc-id=6b662965-9581-452d-9a8e-efb17f194ea0, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642331285085, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeP9sHNxAH4AEQAAAABh4/yEdAAkNmI2NjI5NjUtOTU4MS00NTJkLTlhOGUtZWZiMTdmMTk0ZWEwdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ3MTg3YjJlYS1hZjcxLTQxMDYtOTg4NS05MGE1OTRjNzVkYTlwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICI2cGUwZ2U1ck0zU2E2SUt5WXBsLTVkQTZrVXVleWo3X1psV2c1aDU4MmFvIn0.eyJleHAiOjE2NDIzMzE1NjgsImlhdCI6MTY0MjMzMTI2OCwianRpIjoiNmI2NjI5NjUtOTU4MS00NTJkLTlhOGUtZWZiMTdmMTk0ZWEwIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiI3MTg3YjJlYS1hZjcxLTQxMDYtOTg4NS05MGE1OTRjNzVkYTkiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.omg8lBi8aYXNKFtyz-59LVSg2a2tCMxJ-pijDZk_PJuP3t0KLP9mK065sgr18j9RRLlhB5Gz2kgicFArxHtivEl0gUXu61vDMI1JwNX-iJP3IW1nOuz1niWS06XTsBAs3FLboN9JCzCrlyLSB7kFOSKNyr9gnqXqesWQU1H_s6k9aowpZ2V4aNEsojTx4jRXH2wCNB77m23zlaTQfbhQx_Hi4ZBiiOFCmRXadXaP0PC2LKecdNH4x8WAIIR9Jxwe-mzphLjj5_er637GhiPlR7lUQk9Yn4L72NWb6IEYvcz5_B5E73AFiU_xFR5kcOBPp-wTl_8-LRcBhxSaV9WLrA, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642331568, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.48.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=4E85743BE11CBA71FA8BBDE992844969, http-session-last-accessed-time=1642331285085, kc-category-name=ACCESS, kc-iat=1642331268, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:50422 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:08:05.093  INFO 16 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:08:05.093  INFO 16 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1beb42f7
2022-01-16 11:08:05.093  INFO 16 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1beb42f7
2022-01-16 11:08:05.104  INFO 16 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1beb42f7
2022-01-16 11:08:05.104  INFO 16 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1beb42f7
2022-01-16 11:08:05.153  INFO 16 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1beb42f7
2022-01-16 11:08:05.154  WARN 16 --- [https-jsse-nio-7071-exec-7] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:08:05.154  WARN 16 --- [https-jsse-nio-7071-exec-7] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:08:05.154  INFO 16 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1beb42f7
2022-01-16 11:08:05.154  INFO 16 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1beb42f7
2022-01-16 11:08:05.154  WARN 16 --- [https-jsse-nio-7071-exec-7] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:08:05.154  WARN 16 --- [https-jsse-nio-7071-exec-7] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:08:05.154  INFO 16 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1beb42f7
2022-01-16 11:08:05.167  INFO 16 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: emergency-active, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1beb42f7
2022-01-16 11:08:05.177  INFO 16 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1beb42f7
2022-01-16 11:08:05.177  INFO 16 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1beb42f7
2022-01-16 11:08:05.229  INFO 16 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1beb42f7
2022-01-16 11:08:05.230  INFO 16 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-revoke-extra, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1beb42f7
2022-01-16 11:08:05.248  INFO 16 --- [https-jsse-nio-7071-exec-7] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18909736194066153-725920, decision=PERMIT, pdp-result=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}})
2022-01-16 11:08:05.248  INFO 16 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=7abb00c3-2399-41b8-b7ed-3139730cbdc1, content=PERMIT, timestamp=1642331285248, pdpResult=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}}))
2022-01-16 11:08:05.249  INFO 16 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=155ms, Total=158ms
2022-01-16 11:08:05.267  INFO 16 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=59f587fe-140a-417f-b891-bb7d95ece6c7, content=null, timestamp=1642331285263, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=50424, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=5fb2fe03fb5a, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=7187b2ea-af71-4106-9885-90a594c75da9, http-req-server-port=80, http-header-accept=*/*, kc-id=6b662965-9581-452d-9a8e-efb17f194ea0, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642331285262, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeP9sHNxAH4AEQAAAABh4/yEdAAkNmI2NjI5NjUtOTU4MS00NTJkLTlhOGUtZWZiMTdmMTk0ZWEwdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ3MTg3YjJlYS1hZjcxLTQxMDYtOTg4NS05MGE1OTRjNzVkYTlwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICI2cGUwZ2U1ck0zU2E2SUt5WXBsLTVkQTZrVXVleWo3X1psV2c1aDU4MmFvIn0.eyJleHAiOjE2NDIzMzE1NjgsImlhdCI6MTY0MjMzMTI2OCwianRpIjoiNmI2NjI5NjUtOTU4MS00NTJkLTlhOGUtZWZiMTdmMTk0ZWEwIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiI3MTg3YjJlYS1hZjcxLTQxMDYtOTg4NS05MGE1OTRjNzVkYTkiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.omg8lBi8aYXNKFtyz-59LVSg2a2tCMxJ-pijDZk_PJuP3t0KLP9mK065sgr18j9RRLlhB5Gz2kgicFArxHtivEl0gUXu61vDMI1JwNX-iJP3IW1nOuz1niWS06XTsBAs3FLboN9JCzCrlyLSB7kFOSKNyr9gnqXqesWQU1H_s6k9aowpZ2V4aNEsojTx4jRXH2wCNB77m23zlaTQfbhQx_Hi4ZBiiOFCmRXadXaP0PC2LKecdNH4x8WAIIR9Jxwe-mzphLjj5_er637GhiPlR7lUQk9Yn4L72NWb6IEYvcz5_B5E73AFiU_xFR5kcOBPp-wTl_8-LRcBhxSaV9WLrA, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642331568, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.48.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=CBA2AED2EB0035A1772B208552CAC13B, http-session-last-accessed-time=1642331285262, kc-category-name=ACCESS, kc-iat=1642331268, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:50424 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:08:05.268  INFO 16 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:08:05.268  INFO 16 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3fdbb6db
2022-01-16 11:08:05.268  INFO 16 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3fdbb6db
2022-01-16 11:08:05.282  INFO 16 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3fdbb6db
2022-01-16 11:08:05.282  INFO 16 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3fdbb6db
2022-01-16 11:08:05.333  INFO 16 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3fdbb6db
2022-01-16 11:08:05.333  WARN 16 --- [https-jsse-nio-7071-exec-8] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:08:05.333  WARN 16 --- [https-jsse-nio-7071-exec-8] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:08:05.334  INFO 16 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3fdbb6db
2022-01-16 11:08:05.334  INFO 16 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3fdbb6db
2022-01-16 11:08:05.334  WARN 16 --- [https-jsse-nio-7071-exec-8] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:08:05.334  WARN 16 --- [https-jsse-nio-7071-exec-8] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:08:05.334  INFO 16 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3fdbb6db
2022-01-16 11:08:05.346  INFO 16 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: emergency-active, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3fdbb6db
2022-01-16 11:08:05.354  INFO 16 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3fdbb6db
2022-01-16 11:08:05.355  INFO 16 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3fdbb6db
2022-01-16 11:08:05.405  INFO 16 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3fdbb6db
2022-01-16 11:08:05.406  INFO 16 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-revoke-extra, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3fdbb6db
2022-01-16 11:08:05.422  INFO 16 --- [https-jsse-nio-7071-exec-8] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18909736369053523-425403, decision=PERMIT, pdp-result=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}})
2022-01-16 11:08:05.423  INFO 16 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=59f587fe-140a-417f-b891-bb7d95ece6c7, content=PERMIT, timestamp=1642331285423, pdpResult=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}}))
2022-01-16 11:08:05.424  INFO 16 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=155ms, Total=158ms
2022-01-16 11:08:05.448  INFO 16 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=4c21b497-41d2-419b-bd74-fd03f653e7b8, content=null, timestamp=1642331285442, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=50426, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=5fb2fe03fb5a, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=7187b2ea-af71-4106-9885-90a594c75da9, http-req-server-port=80, http-header-accept=*/*, kc-id=6b662965-9581-452d-9a8e-efb17f194ea0, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642331285440, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeP9sHNxAH4AEQAAAABh4/yEdAAkNmI2NjI5NjUtOTU4MS00NTJkLTlhOGUtZWZiMTdmMTk0ZWEwdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ3MTg3YjJlYS1hZjcxLTQxMDYtOTg4NS05MGE1OTRjNzVkYTlwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICI2cGUwZ2U1ck0zU2E2SUt5WXBsLTVkQTZrVXVleWo3X1psV2c1aDU4MmFvIn0.eyJleHAiOjE2NDIzMzE1NjgsImlhdCI6MTY0MjMzMTI2OCwianRpIjoiNmI2NjI5NjUtOTU4MS00NTJkLTlhOGUtZWZiMTdmMTk0ZWEwIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiI3MTg3YjJlYS1hZjcxLTQxMDYtOTg4NS05MGE1OTRjNzVkYTkiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.omg8lBi8aYXNKFtyz-59LVSg2a2tCMxJ-pijDZk_PJuP3t0KLP9mK065sgr18j9RRLlhB5Gz2kgicFArxHtivEl0gUXu61vDMI1JwNX-iJP3IW1nOuz1niWS06XTsBAs3FLboN9JCzCrlyLSB7kFOSKNyr9gnqXqesWQU1H_s6k9aowpZ2V4aNEsojTx4jRXH2wCNB77m23zlaTQfbhQx_Hi4ZBiiOFCmRXadXaP0PC2LKecdNH4x8WAIIR9Jxwe-mzphLjj5_er637GhiPlR7lUQk9Yn4L72NWb6IEYvcz5_B5E73AFiU_xFR5kcOBPp-wTl_8-LRcBhxSaV9WLrA, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642331568, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.48.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=B0483DD58ECAAF57C14844C376CAEE67, http-session-last-accessed-time=1642331285440, kc-category-name=ACCESS, kc-iat=1642331268, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:50426 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:08:05.449  INFO 16 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:08:05.450  INFO 16 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7b390ea8
2022-01-16 11:08:05.450  INFO 16 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7b390ea8
2022-01-16 11:08:05.463  INFO 16 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7b390ea8
2022-01-16 11:08:05.463  INFO 16 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7b390ea8
2022-01-16 11:08:05.513  INFO 16 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7b390ea8
2022-01-16 11:08:05.514  WARN 16 --- [https-jsse-nio-7071-exec-9] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:08:05.514  WARN 16 --- [https-jsse-nio-7071-exec-9] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:08:05.515  INFO 16 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7b390ea8
2022-01-16 11:08:05.515  INFO 16 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7b390ea8
2022-01-16 11:08:05.516  WARN 16 --- [https-jsse-nio-7071-exec-9] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:08:05.516  WARN 16 --- [https-jsse-nio-7071-exec-9] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:08:05.517  INFO 16 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7b390ea8
2022-01-16 11:08:05.528  INFO 16 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: emergency-active, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7b390ea8
2022-01-16 11:08:05.537  INFO 16 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7b390ea8
2022-01-16 11:08:05.537  INFO 16 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7b390ea8
2022-01-16 11:08:05.585  INFO 16 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7b390ea8
2022-01-16 11:08:05.586  INFO 16 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-revoke-extra, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7b390ea8
2022-01-16 11:08:05.599  INFO 16 --- [https-jsse-nio-7071-exec-9] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18909736550863925-919810, decision=PERMIT, pdp-result=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}})
2022-01-16 11:08:05.599  INFO 16 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=4c21b497-41d2-419b-bd74-fd03f653e7b8, content=PERMIT, timestamp=1642331285599, pdpResult=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}}))
2022-01-16 11:08:05.600  INFO 16 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=150ms, Total=154ms
2022-01-16 11:08:05.618  INFO 16 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=156f33e0-af56-492a-b958-a12562aa22cd, content=null, timestamp=1642331285614, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=50428, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=5fb2fe03fb5a, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=7187b2ea-af71-4106-9885-90a594c75da9, http-req-server-port=80, http-header-accept=*/*, kc-id=6b662965-9581-452d-9a8e-efb17f194ea0, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642331285613, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeP9sHNxAH4AEQAAAABh4/yEdAAkNmI2NjI5NjUtOTU4MS00NTJkLTlhOGUtZWZiMTdmMTk0ZWEwdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ3MTg3YjJlYS1hZjcxLTQxMDYtOTg4NS05MGE1OTRjNzVkYTlwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICI2cGUwZ2U1ck0zU2E2SUt5WXBsLTVkQTZrVXVleWo3X1psV2c1aDU4MmFvIn0.eyJleHAiOjE2NDIzMzE1NjgsImlhdCI6MTY0MjMzMTI2OCwianRpIjoiNmI2NjI5NjUtOTU4MS00NTJkLTlhOGUtZWZiMTdmMTk0ZWEwIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiI3MTg3YjJlYS1hZjcxLTQxMDYtOTg4NS05MGE1OTRjNzVkYTkiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.omg8lBi8aYXNKFtyz-59LVSg2a2tCMxJ-pijDZk_PJuP3t0KLP9mK065sgr18j9RRLlhB5Gz2kgicFArxHtivEl0gUXu61vDMI1JwNX-iJP3IW1nOuz1niWS06XTsBAs3FLboN9JCzCrlyLSB7kFOSKNyr9gnqXqesWQU1H_s6k9aowpZ2V4aNEsojTx4jRXH2wCNB77m23zlaTQfbhQx_Hi4ZBiiOFCmRXadXaP0PC2LKecdNH4x8WAIIR9Jxwe-mzphLjj5_er637GhiPlR7lUQk9Yn4L72NWb6IEYvcz5_B5E73AFiU_xFR5kcOBPp-wTl_8-LRcBhxSaV9WLrA, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642331568, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.48.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=40B5CF19B982EDF8F358747C6714FEAE, http-session-last-accessed-time=1642331285613, kc-category-name=ACCESS, kc-iat=1642331268, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:50428 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:08:05.619  INFO 16 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:08:05.620  INFO 16 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6bccb49e
2022-01-16 11:08:05.620  INFO 16 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6bccb49e
2022-01-16 11:08:05.632  INFO 16 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6bccb49e
2022-01-16 11:08:05.632  INFO 16 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6bccb49e
2022-01-16 11:08:05.681  INFO 16 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6bccb49e
2022-01-16 11:08:05.682  WARN 16 --- [https-jsse-nio-7071-exec-10] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:08:05.682  WARN 16 --- [https-jsse-nio-7071-exec-10] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:08:05.682  INFO 16 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6bccb49e
2022-01-16 11:08:05.682  INFO 16 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6bccb49e
2022-01-16 11:08:05.682  WARN 16 --- [https-jsse-nio-7071-exec-10] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:08:05.682  WARN 16 --- [https-jsse-nio-7071-exec-10] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:08:05.682  INFO 16 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6bccb49e
2022-01-16 11:08:05.692  INFO 16 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: emergency-active, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6bccb49e
2022-01-16 11:08:05.700  INFO 16 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6bccb49e
2022-01-16 11:08:05.700  INFO 16 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6bccb49e
2022-01-16 11:08:05.754  INFO 16 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6bccb49e
2022-01-16 11:08:05.754  INFO 16 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-revoke-extra, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6bccb49e
2022-01-16 11:08:05.772  INFO 16 --- [https-jsse-nio-7071-exec-10] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18909736720287278-539817, decision=PERMIT, pdp-result=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}})
2022-01-16 11:08:05.772  INFO 16 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=156f33e0-af56-492a-b958-a12562aa22cd, content=PERMIT, timestamp=1642331285772, pdpResult=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}}))
2022-01-16 11:08:05.772  INFO 16 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=153ms, Total=155ms
2022-01-16 11:08:05.794  INFO 16 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=5dae22e7-565c-4830-a4e9-1d904a301979, content=null, timestamp=1642331285789, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=50430, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=5fb2fe03fb5a, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=7187b2ea-af71-4106-9885-90a594c75da9, http-req-server-port=80, http-header-accept=*/*, kc-id=6b662965-9581-452d-9a8e-efb17f194ea0, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642331285788, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeP9sHNxAH4AEQAAAABh4/yEdAAkNmI2NjI5NjUtOTU4MS00NTJkLTlhOGUtZWZiMTdmMTk0ZWEwdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ3MTg3YjJlYS1hZjcxLTQxMDYtOTg4NS05MGE1OTRjNzVkYTlwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICI2cGUwZ2U1ck0zU2E2SUt5WXBsLTVkQTZrVXVleWo3X1psV2c1aDU4MmFvIn0.eyJleHAiOjE2NDIzMzE1NjgsImlhdCI6MTY0MjMzMTI2OCwianRpIjoiNmI2NjI5NjUtOTU4MS00NTJkLTlhOGUtZWZiMTdmMTk0ZWEwIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiI3MTg3YjJlYS1hZjcxLTQxMDYtOTg4NS05MGE1OTRjNzVkYTkiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.omg8lBi8aYXNKFtyz-59LVSg2a2tCMxJ-pijDZk_PJuP3t0KLP9mK065sgr18j9RRLlhB5Gz2kgicFArxHtivEl0gUXu61vDMI1JwNX-iJP3IW1nOuz1niWS06XTsBAs3FLboN9JCzCrlyLSB7kFOSKNyr9gnqXqesWQU1H_s6k9aowpZ2V4aNEsojTx4jRXH2wCNB77m23zlaTQfbhQx_Hi4ZBiiOFCmRXadXaP0PC2LKecdNH4x8WAIIR9Jxwe-mzphLjj5_er637GhiPlR7lUQk9Yn4L72NWb6IEYvcz5_B5E73AFiU_xFR5kcOBPp-wTl_8-LRcBhxSaV9WLrA, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642331568, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.48.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=220F3C2818F9F03692AF6E883F28B37B, http-session-last-accessed-time=1642331285788, kc-category-name=ACCESS, kc-iat=1642331268, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:50430 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:08:05.795  INFO 16 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:08:05.796  INFO 16 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@f41f564
2022-01-16 11:08:05.796  INFO 16 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@f41f564
2022-01-16 11:08:05.810  INFO 16 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@f41f564
2022-01-16 11:08:05.810  INFO 16 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@f41f564
2022-01-16 11:08:05.870  INFO 16 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@f41f564
2022-01-16 11:08:05.870  WARN 16 --- [https-jsse-nio-7071-exec-1] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:08:05.870  WARN 16 --- [https-jsse-nio-7071-exec-1] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:08:05.870  INFO 16 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@f41f564
2022-01-16 11:08:05.870  INFO 16 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@f41f564
2022-01-16 11:08:05.871  WARN 16 --- [https-jsse-nio-7071-exec-1] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:08:05.871  WARN 16 --- [https-jsse-nio-7071-exec-1] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:08:05.871  INFO 16 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@f41f564
2022-01-16 11:08:05.888  INFO 16 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: emergency-active, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@f41f564
2022-01-16 11:08:05.897  INFO 16 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@f41f564
2022-01-16 11:08:05.897  INFO 16 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@f41f564
2022-01-16 11:08:05.950  INFO 16 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@f41f564
2022-01-16 11:08:05.950  INFO 16 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-revoke-extra, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@f41f564
2022-01-16 11:08:05.967  INFO 16 --- [https-jsse-nio-7071-exec-1] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18909736896405080-292487, decision=PERMIT, pdp-result=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}})
2022-01-16 11:08:05.967  INFO 16 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=5dae22e7-565c-4830-a4e9-1d904a301979, content=PERMIT, timestamp=1642331285967, pdpResult=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}}))
2022-01-16 11:08:05.967  INFO 16 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=172ms, Total=174ms
2022-01-16 11:08:05.990  INFO 16 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=e6c0b8f1-94e6-4ac5-b6b7-39a7ce63e6de, content=null, timestamp=1642331285986, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=50432, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=5fb2fe03fb5a, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=7187b2ea-af71-4106-9885-90a594c75da9, http-req-server-port=80, http-header-accept=*/*, kc-id=6b662965-9581-452d-9a8e-efb17f194ea0, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642331285985, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeP9sHNxAH4AEQAAAABh4/yEdAAkNmI2NjI5NjUtOTU4MS00NTJkLTlhOGUtZWZiMTdmMTk0ZWEwdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ3MTg3YjJlYS1hZjcxLTQxMDYtOTg4NS05MGE1OTRjNzVkYTlwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICI2cGUwZ2U1ck0zU2E2SUt5WXBsLTVkQTZrVXVleWo3X1psV2c1aDU4MmFvIn0.eyJleHAiOjE2NDIzMzE1NjgsImlhdCI6MTY0MjMzMTI2OCwianRpIjoiNmI2NjI5NjUtOTU4MS00NTJkLTlhOGUtZWZiMTdmMTk0ZWEwIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiI3MTg3YjJlYS1hZjcxLTQxMDYtOTg4NS05MGE1OTRjNzVkYTkiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.omg8lBi8aYXNKFtyz-59LVSg2a2tCMxJ-pijDZk_PJuP3t0KLP9mK065sgr18j9RRLlhB5Gz2kgicFArxHtivEl0gUXu61vDMI1JwNX-iJP3IW1nOuz1niWS06XTsBAs3FLboN9JCzCrlyLSB7kFOSKNyr9gnqXqesWQU1H_s6k9aowpZ2V4aNEsojTx4jRXH2wCNB77m23zlaTQfbhQx_Hi4ZBiiOFCmRXadXaP0PC2LKecdNH4x8WAIIR9Jxwe-mzphLjj5_er637GhiPlR7lUQk9Yn4L72NWb6IEYvcz5_B5E73AFiU_xFR5kcOBPp-wTl_8-LRcBhxSaV9WLrA, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642331568, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.48.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=DB9F729AF6CA7A4C09E95B1EA8505808, http-session-last-accessed-time=1642331285985, kc-category-name=ACCESS, kc-iat=1642331268, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:50432 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:08:05.991  INFO 16 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:08:05.992  INFO 16 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4628a9e1
2022-01-16 11:08:05.992  INFO 16 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4628a9e1
2022-01-16 11:08:06.003  INFO 16 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4628a9e1
2022-01-16 11:08:06.003  INFO 16 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4628a9e1
2022-01-16 11:08:06.057  INFO 16 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4628a9e1
2022-01-16 11:08:06.058  WARN 16 --- [https-jsse-nio-7071-exec-2] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:08:06.058  WARN 16 --- [https-jsse-nio-7071-exec-2] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:08:06.058  INFO 16 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4628a9e1
2022-01-16 11:08:06.058  INFO 16 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4628a9e1
2022-01-16 11:08:06.058  WARN 16 --- [https-jsse-nio-7071-exec-2] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:08:06.059  WARN 16 --- [https-jsse-nio-7071-exec-2] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:08:06.059  INFO 16 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4628a9e1
2022-01-16 11:08:06.070  INFO 16 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: emergency-active, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4628a9e1
2022-01-16 11:08:06.079  INFO 16 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4628a9e1
2022-01-16 11:08:06.079  INFO 16 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4628a9e1
2022-01-16 11:08:06.129  INFO 16 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4628a9e1
2022-01-16 11:08:06.129  INFO 16 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-revoke-extra, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4628a9e1
2022-01-16 11:08:06.145  INFO 16 --- [https-jsse-nio-7071-exec-2] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18909737092654011-564855, decision=PERMIT, pdp-result=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}})
2022-01-16 11:08:06.145  INFO 16 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=e6c0b8f1-94e6-4ac5-b6b7-39a7ce63e6de, content=PERMIT, timestamp=1642331286145, pdpResult=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}}))
2022-01-16 11:08:06.146  INFO 16 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=154ms, Total=157ms
2022-01-16 11:08:06.164  INFO 16 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=dd53b95b-4183-4ea4-945f-f3129f674e53, content=null, timestamp=1642331286160, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=50434, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=5fb2fe03fb5a, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=7187b2ea-af71-4106-9885-90a594c75da9, http-req-server-port=80, http-header-accept=*/*, kc-id=6b662965-9581-452d-9a8e-efb17f194ea0, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642331286159, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeP9sHNxAH4AEQAAAABh4/yEdAAkNmI2NjI5NjUtOTU4MS00NTJkLTlhOGUtZWZiMTdmMTk0ZWEwdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ3MTg3YjJlYS1hZjcxLTQxMDYtOTg4NS05MGE1OTRjNzVkYTlwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICI2cGUwZ2U1ck0zU2E2SUt5WXBsLTVkQTZrVXVleWo3X1psV2c1aDU4MmFvIn0.eyJleHAiOjE2NDIzMzE1NjgsImlhdCI6MTY0MjMzMTI2OCwianRpIjoiNmI2NjI5NjUtOTU4MS00NTJkLTlhOGUtZWZiMTdmMTk0ZWEwIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiI3MTg3YjJlYS1hZjcxLTQxMDYtOTg4NS05MGE1OTRjNzVkYTkiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.omg8lBi8aYXNKFtyz-59LVSg2a2tCMxJ-pijDZk_PJuP3t0KLP9mK065sgr18j9RRLlhB5Gz2kgicFArxHtivEl0gUXu61vDMI1JwNX-iJP3IW1nOuz1niWS06XTsBAs3FLboN9JCzCrlyLSB7kFOSKNyr9gnqXqesWQU1H_s6k9aowpZ2V4aNEsojTx4jRXH2wCNB77m23zlaTQfbhQx_Hi4ZBiiOFCmRXadXaP0PC2LKecdNH4x8WAIIR9Jxwe-mzphLjj5_er637GhiPlR7lUQk9Yn4L72NWb6IEYvcz5_B5E73AFiU_xFR5kcOBPp-wTl_8-LRcBhxSaV9WLrA, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642331568, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.48.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=A718048EC628DEE0925B69679A331077, http-session-last-accessed-time=1642331286159, kc-category-name=ACCESS, kc-iat=1642331268, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:50434 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:08:06.165  INFO 16 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:08:06.166  INFO 16 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@55ef12e1
2022-01-16 11:08:06.166  INFO 16 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@55ef12e1
2022-01-16 11:08:06.179  INFO 16 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@55ef12e1
2022-01-16 11:08:06.180  INFO 16 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@55ef12e1
2022-01-16 11:08:06.238  INFO 16 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@55ef12e1
2022-01-16 11:08:06.239  WARN 16 --- [https-jsse-nio-7071-exec-3] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:08:06.240  WARN 16 --- [https-jsse-nio-7071-exec-3] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:08:06.240  INFO 16 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@55ef12e1
2022-01-16 11:08:06.241  INFO 16 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@55ef12e1
2022-01-16 11:08:06.242  WARN 16 --- [https-jsse-nio-7071-exec-3] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:08:06.243  WARN 16 --- [https-jsse-nio-7071-exec-3] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:08:06.244  INFO 16 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@55ef12e1
2022-01-16 11:08:06.257  INFO 16 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: emergency-active, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@55ef12e1
2022-01-16 11:08:06.266  INFO 16 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@55ef12e1
2022-01-16 11:08:06.267  INFO 16 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@55ef12e1
2022-01-16 11:08:06.317  INFO 16 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@55ef12e1
2022-01-16 11:08:06.318  INFO 16 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-revoke-extra, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@55ef12e1
2022-01-16 11:08:06.334  INFO 16 --- [https-jsse-nio-7071-exec-3] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18909737266887959-267421, decision=PERMIT, pdp-result=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}})
2022-01-16 11:08:06.334  INFO 16 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=dd53b95b-4183-4ea4-945f-f3129f674e53, content=PERMIT, timestamp=1642331286334, pdpResult=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}}))
2022-01-16 11:08:06.335  INFO 16 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=169ms, Total=172ms
2022-01-16 11:08:06.356  INFO 16 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=0351c798-dc7b-4494-b868-a8f710582c76, content=null, timestamp=1642331286350, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=50436, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=5fb2fe03fb5a, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=7187b2ea-af71-4106-9885-90a594c75da9, http-req-server-port=80, http-header-accept=*/*, kc-id=6b662965-9581-452d-9a8e-efb17f194ea0, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642331286350, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeP9sHNxAH4AEQAAAABh4/yEdAAkNmI2NjI5NjUtOTU4MS00NTJkLTlhOGUtZWZiMTdmMTk0ZWEwdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ3MTg3YjJlYS1hZjcxLTQxMDYtOTg4NS05MGE1OTRjNzVkYTlwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICI2cGUwZ2U1ck0zU2E2SUt5WXBsLTVkQTZrVXVleWo3X1psV2c1aDU4MmFvIn0.eyJleHAiOjE2NDIzMzE1NjgsImlhdCI6MTY0MjMzMTI2OCwianRpIjoiNmI2NjI5NjUtOTU4MS00NTJkLTlhOGUtZWZiMTdmMTk0ZWEwIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiI3MTg3YjJlYS1hZjcxLTQxMDYtOTg4NS05MGE1OTRjNzVkYTkiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.omg8lBi8aYXNKFtyz-59LVSg2a2tCMxJ-pijDZk_PJuP3t0KLP9mK065sgr18j9RRLlhB5Gz2kgicFArxHtivEl0gUXu61vDMI1JwNX-iJP3IW1nOuz1niWS06XTsBAs3FLboN9JCzCrlyLSB7kFOSKNyr9gnqXqesWQU1H_s6k9aowpZ2V4aNEsojTx4jRXH2wCNB77m23zlaTQfbhQx_Hi4ZBiiOFCmRXadXaP0PC2LKecdNH4x8WAIIR9Jxwe-mzphLjj5_er637GhiPlR7lUQk9Yn4L72NWb6IEYvcz5_B5E73AFiU_xFR5kcOBPp-wTl_8-LRcBhxSaV9WLrA, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642331568, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.48.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=01A0F9D85CD2D6A026ADA1A2351ED2BF, http-session-last-accessed-time=1642331286350, kc-category-name=ACCESS, kc-iat=1642331268, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:50436 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:08:06.357  INFO 16 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:08:06.357  INFO 16 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7e2ad0a8
2022-01-16 11:08:06.357  INFO 16 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7e2ad0a8
2022-01-16 11:08:06.370  INFO 16 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7e2ad0a8
2022-01-16 11:08:06.370  INFO 16 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7e2ad0a8
2022-01-16 11:08:06.421  INFO 16 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7e2ad0a8
2022-01-16 11:08:06.421  WARN 16 --- [https-jsse-nio-7071-exec-4] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:08:06.421  WARN 16 --- [https-jsse-nio-7071-exec-4] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:08:06.421  INFO 16 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7e2ad0a8
2022-01-16 11:08:06.421  INFO 16 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7e2ad0a8
2022-01-16 11:08:06.421  WARN 16 --- [https-jsse-nio-7071-exec-4] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:08:06.421  WARN 16 --- [https-jsse-nio-7071-exec-4] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:08:06.421  INFO 16 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7e2ad0a8
2022-01-16 11:08:06.433  INFO 16 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: emergency-active, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7e2ad0a8
2022-01-16 11:08:06.441  INFO 16 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7e2ad0a8
2022-01-16 11:08:06.442  INFO 16 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7e2ad0a8
2022-01-16 11:08:06.493  INFO 16 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7e2ad0a8
2022-01-16 11:08:06.494  INFO 16 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-revoke-extra, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7e2ad0a8
2022-01-16 11:08:06.515  INFO 16 --- [https-jsse-nio-7071-exec-4] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18909737458050280-2433, decision=PERMIT, pdp-result=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}})
2022-01-16 11:08:06.515  INFO 16 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=0351c798-dc7b-4494-b868-a8f710582c76, content=PERMIT, timestamp=1642331286515, pdpResult=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}}))
2022-01-16 11:08:06.515  INFO 16 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=158ms, Total=160ms
2022-01-16 11:08:06.536  INFO 16 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=0a87d801-6b15-4699-974e-125d86497b09, content=null, timestamp=1642331286530, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=50438, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=5fb2fe03fb5a, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=7187b2ea-af71-4106-9885-90a594c75da9, http-req-server-port=80, http-header-accept=*/*, kc-id=6b662965-9581-452d-9a8e-efb17f194ea0, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642331286529, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeP9sHNxAH4AEQAAAABh4/yEdAAkNmI2NjI5NjUtOTU4MS00NTJkLTlhOGUtZWZiMTdmMTk0ZWEwdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ3MTg3YjJlYS1hZjcxLTQxMDYtOTg4NS05MGE1OTRjNzVkYTlwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICI2cGUwZ2U1ck0zU2E2SUt5WXBsLTVkQTZrVXVleWo3X1psV2c1aDU4MmFvIn0.eyJleHAiOjE2NDIzMzE1NjgsImlhdCI6MTY0MjMzMTI2OCwianRpIjoiNmI2NjI5NjUtOTU4MS00NTJkLTlhOGUtZWZiMTdmMTk0ZWEwIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiI3MTg3YjJlYS1hZjcxLTQxMDYtOTg4NS05MGE1OTRjNzVkYTkiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.omg8lBi8aYXNKFtyz-59LVSg2a2tCMxJ-pijDZk_PJuP3t0KLP9mK065sgr18j9RRLlhB5Gz2kgicFArxHtivEl0gUXu61vDMI1JwNX-iJP3IW1nOuz1niWS06XTsBAs3FLboN9JCzCrlyLSB7kFOSKNyr9gnqXqesWQU1H_s6k9aowpZ2V4aNEsojTx4jRXH2wCNB77m23zlaTQfbhQx_Hi4ZBiiOFCmRXadXaP0PC2LKecdNH4x8WAIIR9Jxwe-mzphLjj5_er637GhiPlR7lUQk9Yn4L72NWb6IEYvcz5_B5E73AFiU_xFR5kcOBPp-wTl_8-LRcBhxSaV9WLrA, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642331568, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.48.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=9F1D76685F309F1F416C018E48079EFC, http-session-last-accessed-time=1642331286529, kc-category-name=ACCESS, kc-iat=1642331268, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:50438 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:08:06.537  INFO 16 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:08:06.537  INFO 16 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6fb845ae
2022-01-16 11:08:06.538  INFO 16 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6fb845ae
2022-01-16 11:08:06.548  INFO 16 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6fb845ae
2022-01-16 11:08:06.548  INFO 16 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6fb845ae
2022-01-16 11:08:06.597  INFO 16 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6fb845ae
2022-01-16 11:08:06.598  WARN 16 --- [https-jsse-nio-7071-exec-5] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:08:06.598  WARN 16 --- [https-jsse-nio-7071-exec-5] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:08:06.598  INFO 16 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6fb845ae
2022-01-16 11:08:06.598  INFO 16 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6fb845ae
2022-01-16 11:08:06.599  WARN 16 --- [https-jsse-nio-7071-exec-5] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:08:06.599  WARN 16 --- [https-jsse-nio-7071-exec-5] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:08:06.599  INFO 16 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6fb845ae
2022-01-16 11:08:06.612  INFO 16 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: emergency-active, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6fb845ae
2022-01-16 11:08:06.627  INFO 16 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6fb845ae
2022-01-16 11:08:06.627  INFO 16 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6fb845ae
2022-01-16 11:08:06.677  INFO 16 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6fb845ae
2022-01-16 11:08:06.678  INFO 16 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-revoke-extra, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6fb845ae
2022-01-16 11:08:06.695  INFO 16 --- [https-jsse-nio-7071-exec-5] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18909737638286818-637674, decision=PERMIT, pdp-result=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}})
2022-01-16 11:08:06.695  INFO 16 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=0a87d801-6b15-4699-974e-125d86497b09, content=PERMIT, timestamp=1642331286695, pdpResult=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}}))
2022-01-16 11:08:06.696  INFO 16 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=158ms, Total=162ms
2022-01-16 11:08:06.718  INFO 16 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=877aca45-b172-4825-9f1b-2f4b0c51e8b5, content=null, timestamp=1642331286713, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=50440, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=5fb2fe03fb5a, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=7187b2ea-af71-4106-9885-90a594c75da9, http-req-server-port=80, http-header-accept=*/*, kc-id=6b662965-9581-452d-9a8e-efb17f194ea0, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642331286712, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeP9sHNxAH4AEQAAAABh4/yEdAAkNmI2NjI5NjUtOTU4MS00NTJkLTlhOGUtZWZiMTdmMTk0ZWEwdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ3MTg3YjJlYS1hZjcxLTQxMDYtOTg4NS05MGE1OTRjNzVkYTlwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICI2cGUwZ2U1ck0zU2E2SUt5WXBsLTVkQTZrVXVleWo3X1psV2c1aDU4MmFvIn0.eyJleHAiOjE2NDIzMzE1NjgsImlhdCI6MTY0MjMzMTI2OCwianRpIjoiNmI2NjI5NjUtOTU4MS00NTJkLTlhOGUtZWZiMTdmMTk0ZWEwIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiI3MTg3YjJlYS1hZjcxLTQxMDYtOTg4NS05MGE1OTRjNzVkYTkiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.omg8lBi8aYXNKFtyz-59LVSg2a2tCMxJ-pijDZk_PJuP3t0KLP9mK065sgr18j9RRLlhB5Gz2kgicFArxHtivEl0gUXu61vDMI1JwNX-iJP3IW1nOuz1niWS06XTsBAs3FLboN9JCzCrlyLSB7kFOSKNyr9gnqXqesWQU1H_s6k9aowpZ2V4aNEsojTx4jRXH2wCNB77m23zlaTQfbhQx_Hi4ZBiiOFCmRXadXaP0PC2LKecdNH4x8WAIIR9Jxwe-mzphLjj5_er637GhiPlR7lUQk9Yn4L72NWb6IEYvcz5_B5E73AFiU_xFR5kcOBPp-wTl_8-LRcBhxSaV9WLrA, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642331568, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.48.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=AD1DA8946A9C8F8BF03E97F047A92D16, http-session-last-accessed-time=1642331286712, kc-category-name=ACCESS, kc-iat=1642331268, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:50440 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:08:06.719  INFO 16 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:08:06.719  INFO 16 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@70227717
2022-01-16 11:08:06.719  INFO 16 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@70227717
2022-01-16 11:08:06.727  INFO 16 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@70227717
2022-01-16 11:08:06.727  INFO 16 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@70227717
2022-01-16 11:08:06.783  INFO 16 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@70227717
2022-01-16 11:08:06.783  WARN 16 --- [https-jsse-nio-7071-exec-6] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:08:06.783  WARN 16 --- [https-jsse-nio-7071-exec-6] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:08:06.783  INFO 16 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@70227717
2022-01-16 11:08:06.784  INFO 16 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@70227717
2022-01-16 11:08:06.784  WARN 16 --- [https-jsse-nio-7071-exec-6] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:08:06.784  WARN 16 --- [https-jsse-nio-7071-exec-6] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:08:06.784  INFO 16 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@70227717
2022-01-16 11:08:06.799  INFO 16 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: emergency-active, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@70227717
2022-01-16 11:08:06.811  INFO 16 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@70227717
2022-01-16 11:08:06.811  INFO 16 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@70227717
2022-01-16 11:08:06.865  INFO 16 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@70227717
2022-01-16 11:08:06.866  INFO 16 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-revoke-extra, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@70227717
2022-01-16 11:08:06.879  INFO 16 --- [https-jsse-nio-7071-exec-6] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18909737820373969-650785, decision=PERMIT, pdp-result=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}})
2022-01-16 11:08:06.880  INFO 16 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=877aca45-b172-4825-9f1b-2f4b0c51e8b5, content=PERMIT, timestamp=1642331286880, pdpResult=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}}))
2022-01-16 11:08:06.880  INFO 16 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=161ms, Total=163ms
2022-01-16 11:08:06.903  INFO 16 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=530c7792-fdfa-4da0-96ae-aabf4dc164dc, content=null, timestamp=1642331286898, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=50442, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=5fb2fe03fb5a, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=7187b2ea-af71-4106-9885-90a594c75da9, http-req-server-port=80, http-header-accept=*/*, kc-id=6b662965-9581-452d-9a8e-efb17f194ea0, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642331286897, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeP9sHNxAH4AEQAAAABh4/yEdAAkNmI2NjI5NjUtOTU4MS00NTJkLTlhOGUtZWZiMTdmMTk0ZWEwdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ3MTg3YjJlYS1hZjcxLTQxMDYtOTg4NS05MGE1OTRjNzVkYTlwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICI2cGUwZ2U1ck0zU2E2SUt5WXBsLTVkQTZrVXVleWo3X1psV2c1aDU4MmFvIn0.eyJleHAiOjE2NDIzMzE1NjgsImlhdCI6MTY0MjMzMTI2OCwianRpIjoiNmI2NjI5NjUtOTU4MS00NTJkLTlhOGUtZWZiMTdmMTk0ZWEwIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiI3MTg3YjJlYS1hZjcxLTQxMDYtOTg4NS05MGE1OTRjNzVkYTkiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.omg8lBi8aYXNKFtyz-59LVSg2a2tCMxJ-pijDZk_PJuP3t0KLP9mK065sgr18j9RRLlhB5Gz2kgicFArxHtivEl0gUXu61vDMI1JwNX-iJP3IW1nOuz1niWS06XTsBAs3FLboN9JCzCrlyLSB7kFOSKNyr9gnqXqesWQU1H_s6k9aowpZ2V4aNEsojTx4jRXH2wCNB77m23zlaTQfbhQx_Hi4ZBiiOFCmRXadXaP0PC2LKecdNH4x8WAIIR9Jxwe-mzphLjj5_er637GhiPlR7lUQk9Yn4L72NWb6IEYvcz5_B5E73AFiU_xFR5kcOBPp-wTl_8-LRcBhxSaV9WLrA, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642331568, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.48.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=228B394EB05AF9DA7FB6A4D22C08783E, http-session-last-accessed-time=1642331286897, kc-category-name=ACCESS, kc-iat=1642331268, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:50442 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:08:06.903  INFO 16 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:08:06.904  INFO 16 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1b314066
2022-01-16 11:08:06.904  INFO 16 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1b314066
2022-01-16 11:08:06.936  INFO 16 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1b314066
2022-01-16 11:08:06.936  INFO 16 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1b314066
2022-01-16 11:08:06.989  INFO 16 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1b314066
2022-01-16 11:08:06.989  WARN 16 --- [https-jsse-nio-7071-exec-7] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:08:06.990  WARN 16 --- [https-jsse-nio-7071-exec-7] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:08:06.990  INFO 16 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1b314066
2022-01-16 11:08:06.990  INFO 16 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1b314066
2022-01-16 11:08:06.990  WARN 16 --- [https-jsse-nio-7071-exec-7] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:08:06.990  WARN 16 --- [https-jsse-nio-7071-exec-7] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:08:06.990  INFO 16 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1b314066
2022-01-16 11:08:07.003  INFO 16 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: emergency-active, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1b314066
2022-01-16 11:08:07.010  INFO 16 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1b314066
2022-01-16 11:08:07.010  INFO 16 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1b314066
2022-01-16 11:08:07.057  INFO 16 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1b314066
2022-01-16 11:08:07.057  INFO 16 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-revoke-extra, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1b314066
2022-01-16 11:08:07.068  INFO 16 --- [https-jsse-nio-7071-exec-7] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18909738004617171-425355, decision=PERMIT, pdp-result=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}})
2022-01-16 11:08:07.068  INFO 16 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=530c7792-fdfa-4da0-96ae-aabf4dc164dc, content=PERMIT, timestamp=1642331287068, pdpResult=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}}))
2022-01-16 11:08:07.069  INFO 16 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=165ms, Total=167ms
2022-01-16 11:08:07.089  INFO 16 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=7736d818-596c-4b34-aae7-54108293e6dc, content=null, timestamp=1642331287084, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=50444, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=5fb2fe03fb5a, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=7187b2ea-af71-4106-9885-90a594c75da9, http-req-server-port=80, http-header-accept=*/*, kc-id=6b662965-9581-452d-9a8e-efb17f194ea0, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642331287083, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeP9sHNxAH4AEQAAAABh4/yEdAAkNmI2NjI5NjUtOTU4MS00NTJkLTlhOGUtZWZiMTdmMTk0ZWEwdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ3MTg3YjJlYS1hZjcxLTQxMDYtOTg4NS05MGE1OTRjNzVkYTlwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICI2cGUwZ2U1ck0zU2E2SUt5WXBsLTVkQTZrVXVleWo3X1psV2c1aDU4MmFvIn0.eyJleHAiOjE2NDIzMzE1NjgsImlhdCI6MTY0MjMzMTI2OCwianRpIjoiNmI2NjI5NjUtOTU4MS00NTJkLTlhOGUtZWZiMTdmMTk0ZWEwIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiI3MTg3YjJlYS1hZjcxLTQxMDYtOTg4NS05MGE1OTRjNzVkYTkiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.omg8lBi8aYXNKFtyz-59LVSg2a2tCMxJ-pijDZk_PJuP3t0KLP9mK065sgr18j9RRLlhB5Gz2kgicFArxHtivEl0gUXu61vDMI1JwNX-iJP3IW1nOuz1niWS06XTsBAs3FLboN9JCzCrlyLSB7kFOSKNyr9gnqXqesWQU1H_s6k9aowpZ2V4aNEsojTx4jRXH2wCNB77m23zlaTQfbhQx_Hi4ZBiiOFCmRXadXaP0PC2LKecdNH4x8WAIIR9Jxwe-mzphLjj5_er637GhiPlR7lUQk9Yn4L72NWb6IEYvcz5_B5E73AFiU_xFR5kcOBPp-wTl_8-LRcBhxSaV9WLrA, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642331568, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.48.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=364B30EA61F6DD30A9CDFCD9882ED4F1, http-session-last-accessed-time=1642331287083, kc-category-name=ACCESS, kc-iat=1642331268, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:50444 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:08:07.089  INFO 16 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:08:07.090  INFO 16 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@51cace60
2022-01-16 11:08:07.090  INFO 16 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@51cace60
2022-01-16 11:08:07.101  INFO 16 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@51cace60
2022-01-16 11:08:07.101  INFO 16 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@51cace60
2022-01-16 11:08:07.150  INFO 16 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@51cace60
2022-01-16 11:08:07.150  WARN 16 --- [https-jsse-nio-7071-exec-8] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:08:07.150  WARN 16 --- [https-jsse-nio-7071-exec-8] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:08:07.150  INFO 16 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@51cace60
2022-01-16 11:08:07.150  INFO 16 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@51cace60
2022-01-16 11:08:07.150  WARN 16 --- [https-jsse-nio-7071-exec-8] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:08:07.150  WARN 16 --- [https-jsse-nio-7071-exec-8] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:08:07.150  INFO 16 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@51cace60
2022-01-16 11:08:07.166  INFO 16 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: emergency-active, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@51cace60
2022-01-16 11:08:07.175  INFO 16 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@51cace60
2022-01-16 11:08:07.175  INFO 16 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@51cace60
2022-01-16 11:08:07.229  INFO 16 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@51cace60
2022-01-16 11:08:07.230  INFO 16 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-revoke-extra, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@51cace60
2022-01-16 11:08:07.251  INFO 16 --- [https-jsse-nio-7071-exec-8] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18909738190724741-393820, decision=PERMIT, pdp-result=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}})
2022-01-16 11:08:07.251  INFO 16 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=7736d818-596c-4b34-aae7-54108293e6dc, content=PERMIT, timestamp=1642331287251, pdpResult=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}}))
2022-01-16 11:08:07.252  INFO 16 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=162ms, Total=164ms
2022-01-16 11:08:07.273  INFO 16 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=b00d5bd7-a580-4d60-81bd-560335f8d2fc, content=null, timestamp=1642331287269, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=50446, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=5fb2fe03fb5a, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=7187b2ea-af71-4106-9885-90a594c75da9, http-req-server-port=80, http-header-accept=*/*, kc-id=6b662965-9581-452d-9a8e-efb17f194ea0, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642331287267, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeP9sHNxAH4AEQAAAABh4/yEdAAkNmI2NjI5NjUtOTU4MS00NTJkLTlhOGUtZWZiMTdmMTk0ZWEwdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ3MTg3YjJlYS1hZjcxLTQxMDYtOTg4NS05MGE1OTRjNzVkYTlwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICI2cGUwZ2U1ck0zU2E2SUt5WXBsLTVkQTZrVXVleWo3X1psV2c1aDU4MmFvIn0.eyJleHAiOjE2NDIzMzE1NjgsImlhdCI6MTY0MjMzMTI2OCwianRpIjoiNmI2NjI5NjUtOTU4MS00NTJkLTlhOGUtZWZiMTdmMTk0ZWEwIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiI3MTg3YjJlYS1hZjcxLTQxMDYtOTg4NS05MGE1OTRjNzVkYTkiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.omg8lBi8aYXNKFtyz-59LVSg2a2tCMxJ-pijDZk_PJuP3t0KLP9mK065sgr18j9RRLlhB5Gz2kgicFArxHtivEl0gUXu61vDMI1JwNX-iJP3IW1nOuz1niWS06XTsBAs3FLboN9JCzCrlyLSB7kFOSKNyr9gnqXqesWQU1H_s6k9aowpZ2V4aNEsojTx4jRXH2wCNB77m23zlaTQfbhQx_Hi4ZBiiOFCmRXadXaP0PC2LKecdNH4x8WAIIR9Jxwe-mzphLjj5_er637GhiPlR7lUQk9Yn4L72NWb6IEYvcz5_B5E73AFiU_xFR5kcOBPp-wTl_8-LRcBhxSaV9WLrA, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642331568, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.48.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=43EA287CCE37C3BB2B426EFAFBE596E1, http-session-last-accessed-time=1642331287267, kc-category-name=ACCESS, kc-iat=1642331268, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:50446 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:08:07.273  INFO 16 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:08:07.274  INFO 16 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@64172f7c
2022-01-16 11:08:07.274  INFO 16 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@64172f7c
2022-01-16 11:08:07.283  INFO 16 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@64172f7c
2022-01-16 11:08:07.283  INFO 16 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@64172f7c
2022-01-16 11:08:07.337  INFO 16 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@64172f7c
2022-01-16 11:08:07.338  WARN 16 --- [https-jsse-nio-7071-exec-9] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:08:07.338  WARN 16 --- [https-jsse-nio-7071-exec-9] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:08:07.338  INFO 16 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@64172f7c
2022-01-16 11:08:07.338  INFO 16 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@64172f7c
2022-01-16 11:08:07.338  WARN 16 --- [https-jsse-nio-7071-exec-9] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:08:07.338  WARN 16 --- [https-jsse-nio-7071-exec-9] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:08:07.338  INFO 16 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@64172f7c
2022-01-16 11:08:07.352  INFO 16 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: emergency-active, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@64172f7c
2022-01-16 11:08:07.360  INFO 16 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@64172f7c
2022-01-16 11:08:07.360  INFO 16 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@64172f7c
2022-01-16 11:08:07.409  INFO 16 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@64172f7c
2022-01-16 11:08:07.409  INFO 16 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-revoke-extra, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@64172f7c
2022-01-16 11:08:07.423  INFO 16 --- [https-jsse-nio-7071-exec-9] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18909738374971751-404365, decision=PERMIT, pdp-result=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}})
2022-01-16 11:08:07.423  INFO 16 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=b00d5bd7-a580-4d60-81bd-560335f8d2fc, content=PERMIT, timestamp=1642331287423, pdpResult=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}}))
2022-01-16 11:08:07.423  INFO 16 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=150ms, Total=151ms
2022-01-16 11:08:07.443  INFO 16 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=23763468-2027-4cfa-977b-7f782f938062, content=null, timestamp=1642331287439, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=50448, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=5fb2fe03fb5a, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=7187b2ea-af71-4106-9885-90a594c75da9, http-req-server-port=80, http-header-accept=*/*, kc-id=6b662965-9581-452d-9a8e-efb17f194ea0, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642331287437, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeP9sHNxAH4AEQAAAABh4/yEdAAkNmI2NjI5NjUtOTU4MS00NTJkLTlhOGUtZWZiMTdmMTk0ZWEwdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ3MTg3YjJlYS1hZjcxLTQxMDYtOTg4NS05MGE1OTRjNzVkYTlwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICI2cGUwZ2U1ck0zU2E2SUt5WXBsLTVkQTZrVXVleWo3X1psV2c1aDU4MmFvIn0.eyJleHAiOjE2NDIzMzE1NjgsImlhdCI6MTY0MjMzMTI2OCwianRpIjoiNmI2NjI5NjUtOTU4MS00NTJkLTlhOGUtZWZiMTdmMTk0ZWEwIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiI3MTg3YjJlYS1hZjcxLTQxMDYtOTg4NS05MGE1OTRjNzVkYTkiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.omg8lBi8aYXNKFtyz-59LVSg2a2tCMxJ-pijDZk_PJuP3t0KLP9mK065sgr18j9RRLlhB5Gz2kgicFArxHtivEl0gUXu61vDMI1JwNX-iJP3IW1nOuz1niWS06XTsBAs3FLboN9JCzCrlyLSB7kFOSKNyr9gnqXqesWQU1H_s6k9aowpZ2V4aNEsojTx4jRXH2wCNB77m23zlaTQfbhQx_Hi4ZBiiOFCmRXadXaP0PC2LKecdNH4x8WAIIR9Jxwe-mzphLjj5_er637GhiPlR7lUQk9Yn4L72NWb6IEYvcz5_B5E73AFiU_xFR5kcOBPp-wTl_8-LRcBhxSaV9WLrA, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642331568, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.48.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=0585BF520172DBD40BA89B0C26DC43E8, http-session-last-accessed-time=1642331287437, kc-category-name=ACCESS, kc-iat=1642331268, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:50448 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:08:07.444  INFO 16 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:08:07.444  INFO 16 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@493cde3
2022-01-16 11:08:07.444  INFO 16 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@493cde3
2022-01-16 11:08:07.454  INFO 16 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@493cde3
2022-01-16 11:08:07.454  INFO 16 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@493cde3
2022-01-16 11:08:07.509  INFO 16 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@493cde3
2022-01-16 11:08:07.509  WARN 16 --- [https-jsse-nio-7071-exec-10] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:08:07.509  WARN 16 --- [https-jsse-nio-7071-exec-10] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:08:07.509  INFO 16 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@493cde3
2022-01-16 11:08:07.509  INFO 16 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@493cde3
2022-01-16 11:08:07.509  WARN 16 --- [https-jsse-nio-7071-exec-10] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:08:07.509  WARN 16 --- [https-jsse-nio-7071-exec-10] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:08:07.509  INFO 16 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@493cde3
2022-01-16 11:08:07.521  INFO 16 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: emergency-active, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@493cde3
2022-01-16 11:08:07.531  INFO 16 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@493cde3
2022-01-16 11:08:07.531  INFO 16 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@493cde3
2022-01-16 11:08:07.581  INFO 16 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@493cde3
2022-01-16 11:08:07.581  INFO 16 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-revoke-extra, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@493cde3
2022-01-16 11:08:07.593  INFO 16 --- [https-jsse-nio-7071-exec-10] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18909738545040578-624164, decision=PERMIT, pdp-result=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}})
2022-01-16 11:08:07.593  INFO 16 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=23763468-2027-4cfa-977b-7f782f938062, content=PERMIT, timestamp=1642331287593, pdpResult=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}}))
2022-01-16 11:08:07.594  INFO 16 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=149ms, Total=152ms
2022-01-16 11:08:07.617  INFO 16 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=ddb36412-1bac-4032-bbfc-f259d3722bae, content=null, timestamp=1642331287611, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=50450, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=5fb2fe03fb5a, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=7187b2ea-af71-4106-9885-90a594c75da9, http-req-server-port=80, http-header-accept=*/*, kc-id=6b662965-9581-452d-9a8e-efb17f194ea0, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642331287610, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeP9sHNxAH4AEQAAAABh4/yEdAAkNmI2NjI5NjUtOTU4MS00NTJkLTlhOGUtZWZiMTdmMTk0ZWEwdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ3MTg3YjJlYS1hZjcxLTQxMDYtOTg4NS05MGE1OTRjNzVkYTlwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICI2cGUwZ2U1ck0zU2E2SUt5WXBsLTVkQTZrVXVleWo3X1psV2c1aDU4MmFvIn0.eyJleHAiOjE2NDIzMzE1NjgsImlhdCI6MTY0MjMzMTI2OCwianRpIjoiNmI2NjI5NjUtOTU4MS00NTJkLTlhOGUtZWZiMTdmMTk0ZWEwIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiI3MTg3YjJlYS1hZjcxLTQxMDYtOTg4NS05MGE1OTRjNzVkYTkiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.omg8lBi8aYXNKFtyz-59LVSg2a2tCMxJ-pijDZk_PJuP3t0KLP9mK065sgr18j9RRLlhB5Gz2kgicFArxHtivEl0gUXu61vDMI1JwNX-iJP3IW1nOuz1niWS06XTsBAs3FLboN9JCzCrlyLSB7kFOSKNyr9gnqXqesWQU1H_s6k9aowpZ2V4aNEsojTx4jRXH2wCNB77m23zlaTQfbhQx_Hi4ZBiiOFCmRXadXaP0PC2LKecdNH4x8WAIIR9Jxwe-mzphLjj5_er637GhiPlR7lUQk9Yn4L72NWb6IEYvcz5_B5E73AFiU_xFR5kcOBPp-wTl_8-LRcBhxSaV9WLrA, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642331568, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.48.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=F13ADC78BB7278FDC79AFFF789851557, http-session-last-accessed-time=1642331287610, kc-category-name=ACCESS, kc-iat=1642331268, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:50450 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:08:07.617  INFO 16 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:08:07.618  INFO 16 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1eca745
2022-01-16 11:08:07.618  INFO 16 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1eca745
2022-01-16 11:08:07.629  INFO 16 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1eca745
2022-01-16 11:08:07.630  INFO 16 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1eca745
2022-01-16 11:08:07.681  INFO 16 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1eca745
2022-01-16 11:08:07.681  WARN 16 --- [https-jsse-nio-7071-exec-1] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:08:07.681  WARN 16 --- [https-jsse-nio-7071-exec-1] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:08:07.681  INFO 16 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1eca745
2022-01-16 11:08:07.682  INFO 16 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1eca745
2022-01-16 11:08:07.682  WARN 16 --- [https-jsse-nio-7071-exec-1] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:08:07.682  WARN 16 --- [https-jsse-nio-7071-exec-1] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:08:07.682  INFO 16 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1eca745
2022-01-16 11:08:07.694  INFO 16 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: emergency-active, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1eca745
2022-01-16 11:08:07.705  INFO 16 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1eca745
2022-01-16 11:08:07.705  INFO 16 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1eca745
2022-01-16 11:08:07.760  INFO 16 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1eca745
2022-01-16 11:08:07.760  INFO 16 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-revoke-extra, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1eca745
2022-01-16 11:08:07.772  INFO 16 --- [https-jsse-nio-7071-exec-1] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18909738718954212-112596, decision=PERMIT, pdp-result=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}})
2022-01-16 11:08:07.772  INFO 16 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=ddb36412-1bac-4032-bbfc-f259d3722bae, content=PERMIT, timestamp=1642331287772, pdpResult=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}}))
2022-01-16 11:08:07.772  INFO 16 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=155ms, Total=157ms
2022-01-16 11:08:07.794  INFO 16 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=7e8e25a8-4429-4ffb-b0d2-56c0b5d14cf4, content=null, timestamp=1642331287790, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=50452, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=5fb2fe03fb5a, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=7187b2ea-af71-4106-9885-90a594c75da9, http-req-server-port=80, http-header-accept=*/*, kc-id=6b662965-9581-452d-9a8e-efb17f194ea0, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642331287789, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeP9sHNxAH4AEQAAAABh4/yEdAAkNmI2NjI5NjUtOTU4MS00NTJkLTlhOGUtZWZiMTdmMTk0ZWEwdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ3MTg3YjJlYS1hZjcxLTQxMDYtOTg4NS05MGE1OTRjNzVkYTlwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICI2cGUwZ2U1ck0zU2E2SUt5WXBsLTVkQTZrVXVleWo3X1psV2c1aDU4MmFvIn0.eyJleHAiOjE2NDIzMzE1NjgsImlhdCI6MTY0MjMzMTI2OCwianRpIjoiNmI2NjI5NjUtOTU4MS00NTJkLTlhOGUtZWZiMTdmMTk0ZWEwIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiI3MTg3YjJlYS1hZjcxLTQxMDYtOTg4NS05MGE1OTRjNzVkYTkiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.omg8lBi8aYXNKFtyz-59LVSg2a2tCMxJ-pijDZk_PJuP3t0KLP9mK065sgr18j9RRLlhB5Gz2kgicFArxHtivEl0gUXu61vDMI1JwNX-iJP3IW1nOuz1niWS06XTsBAs3FLboN9JCzCrlyLSB7kFOSKNyr9gnqXqesWQU1H_s6k9aowpZ2V4aNEsojTx4jRXH2wCNB77m23zlaTQfbhQx_Hi4ZBiiOFCmRXadXaP0PC2LKecdNH4x8WAIIR9Jxwe-mzphLjj5_er637GhiPlR7lUQk9Yn4L72NWb6IEYvcz5_B5E73AFiU_xFR5kcOBPp-wTl_8-LRcBhxSaV9WLrA, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642331568, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.48.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=277A153DD0203648EF8BD8945D65BAF9, http-session-last-accessed-time=1642331287789, kc-category-name=ACCESS, kc-iat=1642331268, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:50452 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:08:07.794  INFO 16 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:08:07.795  INFO 16 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@472d1534
2022-01-16 11:08:07.795  INFO 16 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@472d1534
2022-01-16 11:08:07.806  INFO 16 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@472d1534
2022-01-16 11:08:07.806  INFO 16 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@472d1534
2022-01-16 11:08:07.861  INFO 16 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@472d1534
2022-01-16 11:08:07.862  WARN 16 --- [https-jsse-nio-7071-exec-2] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:08:07.862  WARN 16 --- [https-jsse-nio-7071-exec-2] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:08:07.862  INFO 16 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@472d1534
2022-01-16 11:08:07.863  INFO 16 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@472d1534
2022-01-16 11:08:07.863  WARN 16 --- [https-jsse-nio-7071-exec-2] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:08:07.863  WARN 16 --- [https-jsse-nio-7071-exec-2] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:08:07.864  INFO 16 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@472d1534
2022-01-16 11:08:07.883  INFO 16 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: emergency-active, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@472d1534
2022-01-16 11:08:07.898  INFO 16 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@472d1534
2022-01-16 11:08:07.899  INFO 16 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@472d1534
2022-01-16 11:08:07.965  INFO 16 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@472d1534
2022-01-16 11:08:07.966  INFO 16 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-revoke-extra, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@472d1534
2022-01-16 11:08:07.983  INFO 16 --- [https-jsse-nio-7071-exec-2] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18909738895932726-530777, decision=PERMIT, pdp-result=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}})
2022-01-16 11:08:07.983  INFO 16 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=7e8e25a8-4429-4ffb-b0d2-56c0b5d14cf4, content=PERMIT, timestamp=1642331287983, pdpResult=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}}))
2022-01-16 11:08:07.984  INFO 16 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=189ms, Total=191ms
2022-01-16 11:08:08.009  INFO 16 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=f11bbde7-72df-481c-9030-b3e3e7fff58e, content=null, timestamp=1642331288000, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=50454, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=5fb2fe03fb5a, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=7187b2ea-af71-4106-9885-90a594c75da9, http-req-server-port=80, http-header-accept=*/*, kc-id=6b662965-9581-452d-9a8e-efb17f194ea0, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642331287998, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeP9sHNxAH4AEQAAAABh4/yEdAAkNmI2NjI5NjUtOTU4MS00NTJkLTlhOGUtZWZiMTdmMTk0ZWEwdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ3MTg3YjJlYS1hZjcxLTQxMDYtOTg4NS05MGE1OTRjNzVkYTlwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICI2cGUwZ2U1ck0zU2E2SUt5WXBsLTVkQTZrVXVleWo3X1psV2c1aDU4MmFvIn0.eyJleHAiOjE2NDIzMzE1NjgsImlhdCI6MTY0MjMzMTI2OCwianRpIjoiNmI2NjI5NjUtOTU4MS00NTJkLTlhOGUtZWZiMTdmMTk0ZWEwIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiI3MTg3YjJlYS1hZjcxLTQxMDYtOTg4NS05MGE1OTRjNzVkYTkiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.omg8lBi8aYXNKFtyz-59LVSg2a2tCMxJ-pijDZk_PJuP3t0KLP9mK065sgr18j9RRLlhB5Gz2kgicFArxHtivEl0gUXu61vDMI1JwNX-iJP3IW1nOuz1niWS06XTsBAs3FLboN9JCzCrlyLSB7kFOSKNyr9gnqXqesWQU1H_s6k9aowpZ2V4aNEsojTx4jRXH2wCNB77m23zlaTQfbhQx_Hi4ZBiiOFCmRXadXaP0PC2LKecdNH4x8WAIIR9Jxwe-mzphLjj5_er637GhiPlR7lUQk9Yn4L72NWb6IEYvcz5_B5E73AFiU_xFR5kcOBPp-wTl_8-LRcBhxSaV9WLrA, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642331568, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.48.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=E26BBAE08057A1E24FF167ABDC8C2743, http-session-last-accessed-time=1642331287998, kc-category-name=ACCESS, kc-iat=1642331268, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:50454 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:08:08.009  INFO 16 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:08:08.011  INFO 16 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@95f44d6
2022-01-16 11:08:08.011  INFO 16 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@95f44d6
2022-01-16 11:08:08.021  INFO 16 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@95f44d6
2022-01-16 11:08:08.021  INFO 16 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@95f44d6
2022-01-16 11:08:08.073  INFO 16 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@95f44d6
2022-01-16 11:08:08.074  WARN 16 --- [https-jsse-nio-7071-exec-3] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:08:08.075  WARN 16 --- [https-jsse-nio-7071-exec-3] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:08:08.076  INFO 16 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@95f44d6
2022-01-16 11:08:08.076  INFO 16 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@95f44d6
2022-01-16 11:08:08.077  WARN 16 --- [https-jsse-nio-7071-exec-3] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:08:08.077  WARN 16 --- [https-jsse-nio-7071-exec-3] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:08:08.078  INFO 16 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@95f44d6
2022-01-16 11:08:08.092  INFO 16 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: emergency-active, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@95f44d6
2022-01-16 11:08:08.103  INFO 16 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@95f44d6
2022-01-16 11:08:08.103  INFO 16 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@95f44d6
2022-01-16 11:08:08.153  INFO 16 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@95f44d6
2022-01-16 11:08:08.154  INFO 16 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-revoke-extra, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@95f44d6
2022-01-16 11:08:08.173  INFO 16 --- [https-jsse-nio-7071-exec-3] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18909739111203815-179338, decision=PERMIT, pdp-result=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}})
2022-01-16 11:08:08.174  INFO 16 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=f11bbde7-72df-481c-9030-b3e3e7fff58e, content=PERMIT, timestamp=1642331288174, pdpResult=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}}))
2022-01-16 11:08:08.175  INFO 16 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=164ms, Total=168ms
2022-01-16 11:08:08.202  INFO 16 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=8ce32fec-4e3c-4655-9d5d-22bb09a38fef, content=null, timestamp=1642331288196, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=50456, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=5fb2fe03fb5a, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=7187b2ea-af71-4106-9885-90a594c75da9, http-req-server-port=80, http-header-accept=*/*, kc-id=6b662965-9581-452d-9a8e-efb17f194ea0, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642331288195, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeP9sHNxAH4AEQAAAABh4/yEdAAkNmI2NjI5NjUtOTU4MS00NTJkLTlhOGUtZWZiMTdmMTk0ZWEwdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ3MTg3YjJlYS1hZjcxLTQxMDYtOTg4NS05MGE1OTRjNzVkYTlwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICI2cGUwZ2U1ck0zU2E2SUt5WXBsLTVkQTZrVXVleWo3X1psV2c1aDU4MmFvIn0.eyJleHAiOjE2NDIzMzE1NjgsImlhdCI6MTY0MjMzMTI2OCwianRpIjoiNmI2NjI5NjUtOTU4MS00NTJkLTlhOGUtZWZiMTdmMTk0ZWEwIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiI3MTg3YjJlYS1hZjcxLTQxMDYtOTg4NS05MGE1OTRjNzVkYTkiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.omg8lBi8aYXNKFtyz-59LVSg2a2tCMxJ-pijDZk_PJuP3t0KLP9mK065sgr18j9RRLlhB5Gz2kgicFArxHtivEl0gUXu61vDMI1JwNX-iJP3IW1nOuz1niWS06XTsBAs3FLboN9JCzCrlyLSB7kFOSKNyr9gnqXqesWQU1H_s6k9aowpZ2V4aNEsojTx4jRXH2wCNB77m23zlaTQfbhQx_Hi4ZBiiOFCmRXadXaP0PC2LKecdNH4x8WAIIR9Jxwe-mzphLjj5_er637GhiPlR7lUQk9Yn4L72NWb6IEYvcz5_B5E73AFiU_xFR5kcOBPp-wTl_8-LRcBhxSaV9WLrA, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642331568, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.48.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=BD93D9A9406D0471D1FF94FD7C570039, http-session-last-accessed-time=1642331288195, kc-category-name=ACCESS, kc-iat=1642331268, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:50456 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:08:08.203  INFO 16 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:08:08.205  INFO 16 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7e10d924
2022-01-16 11:08:08.205  INFO 16 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7e10d924
2022-01-16 11:08:08.214  INFO 16 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7e10d924
2022-01-16 11:08:08.214  INFO 16 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7e10d924
2022-01-16 11:08:08.265  INFO 16 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7e10d924
2022-01-16 11:08:08.266  WARN 16 --- [https-jsse-nio-7071-exec-4] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:08:08.266  WARN 16 --- [https-jsse-nio-7071-exec-4] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:08:08.267  INFO 16 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7e10d924
2022-01-16 11:08:08.268  INFO 16 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7e10d924
2022-01-16 11:08:08.268  WARN 16 --- [https-jsse-nio-7071-exec-4] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:08:08.269  WARN 16 --- [https-jsse-nio-7071-exec-4] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:08:08.269  INFO 16 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7e10d924
2022-01-16 11:08:08.282  INFO 16 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: emergency-active, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7e10d924
2022-01-16 11:08:08.290  INFO 16 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7e10d924
2022-01-16 11:08:08.290  INFO 16 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7e10d924
2022-01-16 11:08:08.341  INFO 16 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7e10d924
2022-01-16 11:08:08.341  INFO 16 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-revoke-extra, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7e10d924
2022-01-16 11:08:08.349  INFO 16 --- [https-jsse-nio-7071-exec-4] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18909739304142338-394261, decision=PERMIT, pdp-result=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}})
2022-01-16 11:08:08.350  INFO 16 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=8ce32fec-4e3c-4655-9d5d-22bb09a38fef, content=PERMIT, timestamp=1642331288350, pdpResult=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}}))
2022-01-16 11:08:08.351  INFO 16 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=147ms, Total=149ms
2022-01-16 11:08:08.372  INFO 16 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=5c4bcd5e-2264-4b99-a0f4-0a98912aefb4, content=null, timestamp=1642331288366, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=50458, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=5fb2fe03fb5a, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=7187b2ea-af71-4106-9885-90a594c75da9, http-req-server-port=80, http-header-accept=*/*, kc-id=6b662965-9581-452d-9a8e-efb17f194ea0, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642331288365, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeP9sHNxAH4AEQAAAABh4/yEdAAkNmI2NjI5NjUtOTU4MS00NTJkLTlhOGUtZWZiMTdmMTk0ZWEwdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ3MTg3YjJlYS1hZjcxLTQxMDYtOTg4NS05MGE1OTRjNzVkYTlwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICI2cGUwZ2U1ck0zU2E2SUt5WXBsLTVkQTZrVXVleWo3X1psV2c1aDU4MmFvIn0.eyJleHAiOjE2NDIzMzE1NjgsImlhdCI6MTY0MjMzMTI2OCwianRpIjoiNmI2NjI5NjUtOTU4MS00NTJkLTlhOGUtZWZiMTdmMTk0ZWEwIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiI3MTg3YjJlYS1hZjcxLTQxMDYtOTg4NS05MGE1OTRjNzVkYTkiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.omg8lBi8aYXNKFtyz-59LVSg2a2tCMxJ-pijDZk_PJuP3t0KLP9mK065sgr18j9RRLlhB5Gz2kgicFArxHtivEl0gUXu61vDMI1JwNX-iJP3IW1nOuz1niWS06XTsBAs3FLboN9JCzCrlyLSB7kFOSKNyr9gnqXqesWQU1H_s6k9aowpZ2V4aNEsojTx4jRXH2wCNB77m23zlaTQfbhQx_Hi4ZBiiOFCmRXadXaP0PC2LKecdNH4x8WAIIR9Jxwe-mzphLjj5_er637GhiPlR7lUQk9Yn4L72NWb6IEYvcz5_B5E73AFiU_xFR5kcOBPp-wTl_8-LRcBhxSaV9WLrA, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642331568, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.48.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=0DE9E53DB10D6AAB357F8D3A11E58316, http-session-last-accessed-time=1642331288365, kc-category-name=ACCESS, kc-iat=1642331268, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:50458 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:08:08.373  INFO 16 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:08:08.373  INFO 16 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3557c8f8
2022-01-16 11:08:08.374  INFO 16 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3557c8f8
2022-01-16 11:08:08.388  INFO 16 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3557c8f8
2022-01-16 11:08:08.389  INFO 16 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3557c8f8
2022-01-16 11:08:08.437  INFO 16 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3557c8f8
2022-01-16 11:08:08.438  WARN 16 --- [https-jsse-nio-7071-exec-5] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:08:08.439  WARN 16 --- [https-jsse-nio-7071-exec-5] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:08:08.439  INFO 16 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3557c8f8
2022-01-16 11:08:08.440  INFO 16 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3557c8f8
2022-01-16 11:08:08.440  WARN 16 --- [https-jsse-nio-7071-exec-5] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:08:08.441  WARN 16 --- [https-jsse-nio-7071-exec-5] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:08:08.441  INFO 16 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3557c8f8
2022-01-16 11:08:08.455  INFO 16 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: emergency-active, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3557c8f8
2022-01-16 11:08:08.463  INFO 16 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3557c8f8
2022-01-16 11:08:08.463  INFO 16 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3557c8f8
2022-01-16 11:08:08.513  INFO 16 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3557c8f8
2022-01-16 11:08:08.514  INFO 16 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-revoke-extra, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3557c8f8
2022-01-16 11:08:08.526  INFO 16 --- [https-jsse-nio-7071-exec-5] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18909739474394308-859963, decision=PERMIT, pdp-result=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}})
2022-01-16 11:08:08.526  INFO 16 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=5c4bcd5e-2264-4b99-a0f4-0a98912aefb4, content=PERMIT, timestamp=1642331288526, pdpResult=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}}))
2022-01-16 11:08:08.527  INFO 16 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=153ms, Total=157ms
2022-01-16 11:08:08.569  INFO 16 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=4c06e52e-097c-4631-a970-8d6fc7ddfa04, content=null, timestamp=1642331288543, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=50460, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=5fb2fe03fb5a, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=7187b2ea-af71-4106-9885-90a594c75da9, http-req-server-port=80, http-header-accept=*/*, kc-id=6b662965-9581-452d-9a8e-efb17f194ea0, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642331288541, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeP9sHNxAH4AEQAAAABh4/yEdAAkNmI2NjI5NjUtOTU4MS00NTJkLTlhOGUtZWZiMTdmMTk0ZWEwdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ3MTg3YjJlYS1hZjcxLTQxMDYtOTg4NS05MGE1OTRjNzVkYTlwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICI2cGUwZ2U1ck0zU2E2SUt5WXBsLTVkQTZrVXVleWo3X1psV2c1aDU4MmFvIn0.eyJleHAiOjE2NDIzMzE1NjgsImlhdCI6MTY0MjMzMTI2OCwianRpIjoiNmI2NjI5NjUtOTU4MS00NTJkLTlhOGUtZWZiMTdmMTk0ZWEwIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiI3MTg3YjJlYS1hZjcxLTQxMDYtOTg4NS05MGE1OTRjNzVkYTkiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.omg8lBi8aYXNKFtyz-59LVSg2a2tCMxJ-pijDZk_PJuP3t0KLP9mK065sgr18j9RRLlhB5Gz2kgicFArxHtivEl0gUXu61vDMI1JwNX-iJP3IW1nOuz1niWS06XTsBAs3FLboN9JCzCrlyLSB7kFOSKNyr9gnqXqesWQU1H_s6k9aowpZ2V4aNEsojTx4jRXH2wCNB77m23zlaTQfbhQx_Hi4ZBiiOFCmRXadXaP0PC2LKecdNH4x8WAIIR9Jxwe-mzphLjj5_er637GhiPlR7lUQk9Yn4L72NWb6IEYvcz5_B5E73AFiU_xFR5kcOBPp-wTl_8-LRcBhxSaV9WLrA, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642331568, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.48.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=6B3DE6C7EEC1BAC6C025CED705C5FED5, http-session-last-accessed-time=1642331288541, kc-category-name=ACCESS, kc-iat=1642331268, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:50460 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:08:08.569  INFO 16 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:08:08.570  INFO 16 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4bd0aa82
2022-01-16 11:08:08.570  INFO 16 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4bd0aa82
2022-01-16 11:08:08.581  INFO 16 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4bd0aa82
2022-01-16 11:08:08.581  INFO 16 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4bd0aa82
2022-01-16 11:08:08.591  INFO 16 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4bd0aa82
2022-01-16 11:08:08.591  WARN 16 --- [https-jsse-nio-7071-exec-9] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:08:08.591  WARN 16 --- [https-jsse-nio-7071-exec-9] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:08:08.592  INFO 16 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4bd0aa82
2022-01-16 11:08:08.592  INFO 16 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4bd0aa82
2022-01-16 11:08:08.592  WARN 16 --- [https-jsse-nio-7071-exec-9] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:08:08.592  WARN 16 --- [https-jsse-nio-7071-exec-9] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:08:08.592  INFO 16 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4bd0aa82
2022-01-16 11:08:08.641  INFO 16 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: emergency-active, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4bd0aa82
2022-01-16 11:08:08.656  INFO 16 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4bd0aa82
2022-01-16 11:08:08.656  INFO 16 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4bd0aa82
2022-01-16 11:08:08.664  INFO 16 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4bd0aa82
2022-01-16 11:08:08.665  INFO 16 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-revoke-extra, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4bd0aa82
2022-01-16 11:08:08.714  INFO 16 --- [https-jsse-nio-7071-exec-9] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18909739670674256-731130, decision=PERMIT, pdp-result=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}})
2022-01-16 11:08:08.715  INFO 16 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=4c06e52e-097c-4631-a970-8d6fc7ddfa04, content=PERMIT, timestamp=1642331288715, pdpResult=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}}))
2022-01-16 11:08:08.716  INFO 16 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=146ms, Total=148ms
2022-01-16 11:08:08.737  INFO 16 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=9bd3e7ab-bcc9-44f2-98f5-3d7bfdaf5600, content=null, timestamp=1642331288732, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=50464, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=5fb2fe03fb5a, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=7187b2ea-af71-4106-9885-90a594c75da9, http-req-server-port=80, http-header-accept=*/*, kc-id=6b662965-9581-452d-9a8e-efb17f194ea0, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642331288730, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeP9sHNxAH4AEQAAAABh4/yEdAAkNmI2NjI5NjUtOTU4MS00NTJkLTlhOGUtZWZiMTdmMTk0ZWEwdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ3MTg3YjJlYS1hZjcxLTQxMDYtOTg4NS05MGE1OTRjNzVkYTlwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICI2cGUwZ2U1ck0zU2E2SUt5WXBsLTVkQTZrVXVleWo3X1psV2c1aDU4MmFvIn0.eyJleHAiOjE2NDIzMzE1NjgsImlhdCI6MTY0MjMzMTI2OCwianRpIjoiNmI2NjI5NjUtOTU4MS00NTJkLTlhOGUtZWZiMTdmMTk0ZWEwIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiI3MTg3YjJlYS1hZjcxLTQxMDYtOTg4NS05MGE1OTRjNzVkYTkiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.omg8lBi8aYXNKFtyz-59LVSg2a2tCMxJ-pijDZk_PJuP3t0KLP9mK065sgr18j9RRLlhB5Gz2kgicFArxHtivEl0gUXu61vDMI1JwNX-iJP3IW1nOuz1niWS06XTsBAs3FLboN9JCzCrlyLSB7kFOSKNyr9gnqXqesWQU1H_s6k9aowpZ2V4aNEsojTx4jRXH2wCNB77m23zlaTQfbhQx_Hi4ZBiiOFCmRXadXaP0PC2LKecdNH4x8WAIIR9Jxwe-mzphLjj5_er637GhiPlR7lUQk9Yn4L72NWb6IEYvcz5_B5E73AFiU_xFR5kcOBPp-wTl_8-LRcBhxSaV9WLrA, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642331568, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.48.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=CBECD7E29AB7B95CB86CAE22ADC049F8, http-session-last-accessed-time=1642331288730, kc-category-name=ACCESS, kc-iat=1642331268, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:50464 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:08:08.737  INFO 16 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:08:08.738  INFO 16 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@735f20f0
2022-01-16 11:08:08.738  INFO 16 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@735f20f0
2022-01-16 11:08:08.746  INFO 16 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@735f20f0
2022-01-16 11:08:08.746  INFO 16 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@735f20f0
2022-01-16 11:08:08.753  INFO 16 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@735f20f0
2022-01-16 11:08:08.753  WARN 16 --- [https-jsse-nio-7071-exec-10] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:08:08.753  WARN 16 --- [https-jsse-nio-7071-exec-10] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:08:08.753  INFO 16 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@735f20f0
2022-01-16 11:08:08.753  INFO 16 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@735f20f0
2022-01-16 11:08:08.754  WARN 16 --- [https-jsse-nio-7071-exec-10] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:08:08.754  WARN 16 --- [https-jsse-nio-7071-exec-10] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:08:08.754  INFO 16 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@735f20f0
2022-01-16 11:08:08.805  INFO 16 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: emergency-active, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@735f20f0
2022-01-16 11:08:08.816  INFO 16 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@735f20f0
2022-01-16 11:08:08.816  INFO 16 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@735f20f0
2022-01-16 11:08:08.828  INFO 16 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@735f20f0
2022-01-16 11:08:08.829  INFO 16 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-revoke-extra, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@735f20f0
2022-01-16 11:08:08.886  INFO 16 --- [https-jsse-nio-7071-exec-10] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18909739838871378-292212, decision=PERMIT, pdp-result=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}})
2022-01-16 11:08:08.886  INFO 16 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=9bd3e7ab-bcc9-44f2-98f5-3d7bfdaf5600, content=PERMIT, timestamp=1642331288886, pdpResult=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}}))
2022-01-16 11:08:08.886  INFO 16 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=149ms, Total=150ms
2022-01-16 11:08:08.904  INFO 16 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=79b62397-b1a2-48cf-ab05-bc0b21bd183b, content=null, timestamp=1642331288899, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=50466, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=5fb2fe03fb5a, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=7187b2ea-af71-4106-9885-90a594c75da9, http-req-server-port=80, http-header-accept=*/*, kc-id=6b662965-9581-452d-9a8e-efb17f194ea0, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642331288898, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeP9sHNxAH4AEQAAAABh4/yEdAAkNmI2NjI5NjUtOTU4MS00NTJkLTlhOGUtZWZiMTdmMTk0ZWEwdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ3MTg3YjJlYS1hZjcxLTQxMDYtOTg4NS05MGE1OTRjNzVkYTlwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICI2cGUwZ2U1ck0zU2E2SUt5WXBsLTVkQTZrVXVleWo3X1psV2c1aDU4MmFvIn0.eyJleHAiOjE2NDIzMzE1NjgsImlhdCI6MTY0MjMzMTI2OCwianRpIjoiNmI2NjI5NjUtOTU4MS00NTJkLTlhOGUtZWZiMTdmMTk0ZWEwIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiI3MTg3YjJlYS1hZjcxLTQxMDYtOTg4NS05MGE1OTRjNzVkYTkiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.omg8lBi8aYXNKFtyz-59LVSg2a2tCMxJ-pijDZk_PJuP3t0KLP9mK065sgr18j9RRLlhB5Gz2kgicFArxHtivEl0gUXu61vDMI1JwNX-iJP3IW1nOuz1niWS06XTsBAs3FLboN9JCzCrlyLSB7kFOSKNyr9gnqXqesWQU1H_s6k9aowpZ2V4aNEsojTx4jRXH2wCNB77m23zlaTQfbhQx_Hi4ZBiiOFCmRXadXaP0PC2LKecdNH4x8WAIIR9Jxwe-mzphLjj5_er637GhiPlR7lUQk9Yn4L72NWb6IEYvcz5_B5E73AFiU_xFR5kcOBPp-wTl_8-LRcBhxSaV9WLrA, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642331568, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.48.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=11CB8FFCF19D8AE54CC1F9040978DD90, http-session-last-accessed-time=1642331288898, kc-category-name=ACCESS, kc-iat=1642331268, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:50466 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:08:08.905  INFO 16 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:08:08.905  INFO 16 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@d303129
2022-01-16 11:08:08.912  INFO 16 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@d303129
2022-01-16 11:08:08.922  INFO 16 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@d303129
2022-01-16 11:08:08.922  INFO 16 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@d303129
2022-01-16 11:08:08.929  INFO 16 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@d303129
2022-01-16 11:08:08.929  WARN 16 --- [https-jsse-nio-7071-exec-1] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:08:08.929  WARN 16 --- [https-jsse-nio-7071-exec-1] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:08:08.930  INFO 16 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@d303129
2022-01-16 11:08:08.930  INFO 16 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@d303129
2022-01-16 11:08:08.930  WARN 16 --- [https-jsse-nio-7071-exec-1] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:08:08.930  WARN 16 --- [https-jsse-nio-7071-exec-1] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:08:08.930  INFO 16 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@d303129
2022-01-16 11:08:08.981  INFO 16 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: emergency-active, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@d303129
2022-01-16 11:08:08.995  INFO 16 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@d303129
2022-01-16 11:08:08.995  INFO 16 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@d303129
2022-01-16 11:08:09.004  INFO 16 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@d303129
2022-01-16 11:08:09.004  INFO 16 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-revoke-extra, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@d303129
2022-01-16 11:08:09.058  INFO 16 --- [https-jsse-nio-7071-exec-1] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18909740006259633-484531, decision=PERMIT, pdp-result=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}})
2022-01-16 11:08:09.058  INFO 16 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=79b62397-b1a2-48cf-ab05-bc0b21bd183b, content=PERMIT, timestamp=1642331289058, pdpResult=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}}))
2022-01-16 11:08:09.059  INFO 16 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=153ms, Total=156ms
2022-01-16 11:08:09.084  INFO 16 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=59cfcb8b-b307-459d-bf88-6b3e5913484c, content=null, timestamp=1642331289073, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=50468, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=5fb2fe03fb5a, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=7187b2ea-af71-4106-9885-90a594c75da9, http-req-server-port=80, http-header-accept=*/*, kc-id=6b662965-9581-452d-9a8e-efb17f194ea0, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642331289072, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeP9sHNxAH4AEQAAAABh4/yEdAAkNmI2NjI5NjUtOTU4MS00NTJkLTlhOGUtZWZiMTdmMTk0ZWEwdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ3MTg3YjJlYS1hZjcxLTQxMDYtOTg4NS05MGE1OTRjNzVkYTlwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICI2cGUwZ2U1ck0zU2E2SUt5WXBsLTVkQTZrVXVleWo3X1psV2c1aDU4MmFvIn0.eyJleHAiOjE2NDIzMzE1NjgsImlhdCI6MTY0MjMzMTI2OCwianRpIjoiNmI2NjI5NjUtOTU4MS00NTJkLTlhOGUtZWZiMTdmMTk0ZWEwIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiI3MTg3YjJlYS1hZjcxLTQxMDYtOTg4NS05MGE1OTRjNzVkYTkiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.omg8lBi8aYXNKFtyz-59LVSg2a2tCMxJ-pijDZk_PJuP3t0KLP9mK065sgr18j9RRLlhB5Gz2kgicFArxHtivEl0gUXu61vDMI1JwNX-iJP3IW1nOuz1niWS06XTsBAs3FLboN9JCzCrlyLSB7kFOSKNyr9gnqXqesWQU1H_s6k9aowpZ2V4aNEsojTx4jRXH2wCNB77m23zlaTQfbhQx_Hi4ZBiiOFCmRXadXaP0PC2LKecdNH4x8WAIIR9Jxwe-mzphLjj5_er637GhiPlR7lUQk9Yn4L72NWb6IEYvcz5_B5E73AFiU_xFR5kcOBPp-wTl_8-LRcBhxSaV9WLrA, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642331568, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.48.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=B2810493622D90CF892D3539DF98BCA3, http-session-last-accessed-time=1642331289072, kc-category-name=ACCESS, kc-iat=1642331268, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:50468 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:08:09.084  INFO 16 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:08:09.085  INFO 16 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@396eb79b
2022-01-16 11:08:09.085  INFO 16 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@396eb79b
2022-01-16 11:08:09.095  INFO 16 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@396eb79b
2022-01-16 11:08:09.096  INFO 16 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@396eb79b
2022-01-16 11:08:09.109  INFO 16 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@396eb79b
2022-01-16 11:08:09.109  WARN 16 --- [https-jsse-nio-7071-exec-2] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:08:09.109  WARN 16 --- [https-jsse-nio-7071-exec-2] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:08:09.109  INFO 16 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@396eb79b
2022-01-16 11:08:09.109  INFO 16 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@396eb79b
2022-01-16 11:08:09.109  WARN 16 --- [https-jsse-nio-7071-exec-2] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:08:09.109  WARN 16 --- [https-jsse-nio-7071-exec-2] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:08:09.109  INFO 16 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@396eb79b
2022-01-16 11:08:09.157  INFO 16 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: emergency-active, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@396eb79b
2022-01-16 11:08:09.171  INFO 16 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@396eb79b
2022-01-16 11:08:09.171  INFO 16 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@396eb79b
2022-01-16 11:08:09.181  INFO 16 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@396eb79b
2022-01-16 11:08:09.181  INFO 16 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-revoke-extra, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@396eb79b
2022-01-16 11:08:09.230  INFO 16 --- [https-jsse-nio-7071-exec-2] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18909740185455564-234044, decision=PERMIT, pdp-result=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}})
2022-01-16 11:08:09.230  INFO 16 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=59cfcb8b-b307-459d-bf88-6b3e5913484c, content=PERMIT, timestamp=1642331289230, pdpResult=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}}))
2022-01-16 11:08:09.231  INFO 16 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=146ms, Total=149ms
2022-01-16 11:08:09.250  INFO 16 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=55dbfbbd-f14b-49e0-b8bd-c6d52bb1b49c, content=null, timestamp=1642331289246, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=50470, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=5fb2fe03fb5a, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=7187b2ea-af71-4106-9885-90a594c75da9, http-req-server-port=80, http-header-accept=*/*, kc-id=6b662965-9581-452d-9a8e-efb17f194ea0, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642331289244, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeP9sHNxAH4AEQAAAABh4/yEdAAkNmI2NjI5NjUtOTU4MS00NTJkLTlhOGUtZWZiMTdmMTk0ZWEwdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ3MTg3YjJlYS1hZjcxLTQxMDYtOTg4NS05MGE1OTRjNzVkYTlwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICI2cGUwZ2U1ck0zU2E2SUt5WXBsLTVkQTZrVXVleWo3X1psV2c1aDU4MmFvIn0.eyJleHAiOjE2NDIzMzE1NjgsImlhdCI6MTY0MjMzMTI2OCwianRpIjoiNmI2NjI5NjUtOTU4MS00NTJkLTlhOGUtZWZiMTdmMTk0ZWEwIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiI3MTg3YjJlYS1hZjcxLTQxMDYtOTg4NS05MGE1OTRjNzVkYTkiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.omg8lBi8aYXNKFtyz-59LVSg2a2tCMxJ-pijDZk_PJuP3t0KLP9mK065sgr18j9RRLlhB5Gz2kgicFArxHtivEl0gUXu61vDMI1JwNX-iJP3IW1nOuz1niWS06XTsBAs3FLboN9JCzCrlyLSB7kFOSKNyr9gnqXqesWQU1H_s6k9aowpZ2V4aNEsojTx4jRXH2wCNB77m23zlaTQfbhQx_Hi4ZBiiOFCmRXadXaP0PC2LKecdNH4x8WAIIR9Jxwe-mzphLjj5_er637GhiPlR7lUQk9Yn4L72NWb6IEYvcz5_B5E73AFiU_xFR5kcOBPp-wTl_8-LRcBhxSaV9WLrA, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642331568, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.48.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=30689A9B1C93ADB8C8205EB720427301, http-session-last-accessed-time=1642331289244, kc-category-name=ACCESS, kc-iat=1642331268, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:50470 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:08:09.251  INFO 16 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:08:09.252  INFO 16 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@550fcd3d
2022-01-16 11:08:09.252  INFO 16 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@550fcd3d
2022-01-16 11:08:09.261  INFO 16 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@550fcd3d
2022-01-16 11:08:09.262  INFO 16 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@550fcd3d
2022-01-16 11:08:09.270  INFO 16 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@550fcd3d
2022-01-16 11:08:09.270  WARN 16 --- [https-jsse-nio-7071-exec-3] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:08:09.271  WARN 16 --- [https-jsse-nio-7071-exec-3] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:08:09.271  INFO 16 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@550fcd3d
2022-01-16 11:08:09.271  INFO 16 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@550fcd3d
2022-01-16 11:08:09.272  WARN 16 --- [https-jsse-nio-7071-exec-3] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:08:09.272  WARN 16 --- [https-jsse-nio-7071-exec-3] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:08:09.273  INFO 16 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@550fcd3d
2022-01-16 11:08:09.321  INFO 16 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: emergency-active, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@550fcd3d
2022-01-16 11:08:09.336  INFO 16 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@550fcd3d
2022-01-16 11:08:09.336  INFO 16 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@550fcd3d
2022-01-16 11:08:09.344  INFO 16 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@550fcd3d
2022-01-16 11:08:09.344  INFO 16 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-revoke-extra, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@550fcd3d
2022-01-16 11:08:09.401  INFO 16 --- [https-jsse-nio-7071-exec-3] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18909740352917203-48271, decision=PERMIT, pdp-result=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}})
2022-01-16 11:08:09.402  INFO 16 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=55dbfbbd-f14b-49e0-b8bd-c6d52bb1b49c, content=PERMIT, timestamp=1642331289402, pdpResult=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}}))
2022-01-16 11:08:09.402  INFO 16 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=151ms, Total=153ms
2022-01-16 11:08:09.428  INFO 16 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=6203082f-0de2-46fd-92d0-04e7b3103fa4, content=null, timestamp=1642331289423, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=50472, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=5fb2fe03fb5a, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=7187b2ea-af71-4106-9885-90a594c75da9, http-req-server-port=80, http-header-accept=*/*, kc-id=6b662965-9581-452d-9a8e-efb17f194ea0, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642331289422, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeP9sHNxAH4AEQAAAABh4/yEdAAkNmI2NjI5NjUtOTU4MS00NTJkLTlhOGUtZWZiMTdmMTk0ZWEwdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ3MTg3YjJlYS1hZjcxLTQxMDYtOTg4NS05MGE1OTRjNzVkYTlwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICI2cGUwZ2U1ck0zU2E2SUt5WXBsLTVkQTZrVXVleWo3X1psV2c1aDU4MmFvIn0.eyJleHAiOjE2NDIzMzE1NjgsImlhdCI6MTY0MjMzMTI2OCwianRpIjoiNmI2NjI5NjUtOTU4MS00NTJkLTlhOGUtZWZiMTdmMTk0ZWEwIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiI3MTg3YjJlYS1hZjcxLTQxMDYtOTg4NS05MGE1OTRjNzVkYTkiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.omg8lBi8aYXNKFtyz-59LVSg2a2tCMxJ-pijDZk_PJuP3t0KLP9mK065sgr18j9RRLlhB5Gz2kgicFArxHtivEl0gUXu61vDMI1JwNX-iJP3IW1nOuz1niWS06XTsBAs3FLboN9JCzCrlyLSB7kFOSKNyr9gnqXqesWQU1H_s6k9aowpZ2V4aNEsojTx4jRXH2wCNB77m23zlaTQfbhQx_Hi4ZBiiOFCmRXadXaP0PC2LKecdNH4x8WAIIR9Jxwe-mzphLjj5_er637GhiPlR7lUQk9Yn4L72NWb6IEYvcz5_B5E73AFiU_xFR5kcOBPp-wTl_8-LRcBhxSaV9WLrA, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642331568, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.48.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=87FD82FC4D480B308BDFEBC945FE5565, http-session-last-accessed-time=1642331289422, kc-category-name=ACCESS, kc-iat=1642331268, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:50472 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:08:09.429  INFO 16 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:08:09.430  INFO 16 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2a658ebc
2022-01-16 11:08:09.430  INFO 16 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2a658ebc
2022-01-16 11:08:09.442  INFO 16 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2a658ebc
2022-01-16 11:08:09.442  INFO 16 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2a658ebc
2022-01-16 11:08:09.451  INFO 16 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2a658ebc
2022-01-16 11:08:09.452  WARN 16 --- [https-jsse-nio-7071-exec-4] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:08:09.452  WARN 16 --- [https-jsse-nio-7071-exec-4] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:08:09.453  INFO 16 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2a658ebc
2022-01-16 11:08:09.454  INFO 16 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2a658ebc
2022-01-16 11:08:09.454  WARN 16 --- [https-jsse-nio-7071-exec-4] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:08:09.455  WARN 16 --- [https-jsse-nio-7071-exec-4] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:08:09.455  INFO 16 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2a658ebc
2022-01-16 11:08:09.509  INFO 16 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: emergency-active, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2a658ebc
2022-01-16 11:08:09.527  INFO 16 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2a658ebc
2022-01-16 11:08:09.527  INFO 16 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2a658ebc
2022-01-16 11:08:09.540  INFO 16 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2a658ebc
2022-01-16 11:08:09.540  INFO 16 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-revoke-extra, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2a658ebc
2022-01-16 11:08:09.593  INFO 16 --- [https-jsse-nio-7071-exec-4] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18909740530932017-807493, decision=PERMIT, pdp-result=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}})
2022-01-16 11:08:09.594  INFO 16 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=6203082f-0de2-46fd-92d0-04e7b3103fa4, content=PERMIT, timestamp=1642331289594, pdpResult=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}}))
2022-01-16 11:08:09.595  INFO 16 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=165ms, Total=168ms
2022-01-16 11:08:09.613  INFO 16 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=f6e9ac29-0103-4fd7-832f-a7929c8d5d8d, content=null, timestamp=1642331289608, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=50474, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=5fb2fe03fb5a, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=7187b2ea-af71-4106-9885-90a594c75da9, http-req-server-port=80, http-header-accept=*/*, kc-id=6b662965-9581-452d-9a8e-efb17f194ea0, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642331289608, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeP9sHNxAH4AEQAAAABh4/yEdAAkNmI2NjI5NjUtOTU4MS00NTJkLTlhOGUtZWZiMTdmMTk0ZWEwdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ3MTg3YjJlYS1hZjcxLTQxMDYtOTg4NS05MGE1OTRjNzVkYTlwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICI2cGUwZ2U1ck0zU2E2SUt5WXBsLTVkQTZrVXVleWo3X1psV2c1aDU4MmFvIn0.eyJleHAiOjE2NDIzMzE1NjgsImlhdCI6MTY0MjMzMTI2OCwianRpIjoiNmI2NjI5NjUtOTU4MS00NTJkLTlhOGUtZWZiMTdmMTk0ZWEwIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiI3MTg3YjJlYS1hZjcxLTQxMDYtOTg4NS05MGE1OTRjNzVkYTkiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.omg8lBi8aYXNKFtyz-59LVSg2a2tCMxJ-pijDZk_PJuP3t0KLP9mK065sgr18j9RRLlhB5Gz2kgicFArxHtivEl0gUXu61vDMI1JwNX-iJP3IW1nOuz1niWS06XTsBAs3FLboN9JCzCrlyLSB7kFOSKNyr9gnqXqesWQU1H_s6k9aowpZ2V4aNEsojTx4jRXH2wCNB77m23zlaTQfbhQx_Hi4ZBiiOFCmRXadXaP0PC2LKecdNH4x8WAIIR9Jxwe-mzphLjj5_er637GhiPlR7lUQk9Yn4L72NWb6IEYvcz5_B5E73AFiU_xFR5kcOBPp-wTl_8-LRcBhxSaV9WLrA, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642331568, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.48.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=0C048E40178AC8D79E7BD9B3F8B74E9E, http-session-last-accessed-time=1642331289608, kc-category-name=ACCESS, kc-iat=1642331268, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:50474 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:08:09.614  INFO 16 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:08:09.615  INFO 16 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@157553a
2022-01-16 11:08:09.615  INFO 16 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@157553a
2022-01-16 11:08:09.629  INFO 16 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@157553a
2022-01-16 11:08:09.630  INFO 16 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@157553a
2022-01-16 11:08:09.638  INFO 16 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@157553a
2022-01-16 11:08:09.639  WARN 16 --- [https-jsse-nio-7071-exec-5] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:08:09.639  WARN 16 --- [https-jsse-nio-7071-exec-5] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:08:09.639  INFO 16 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@157553a
2022-01-16 11:08:09.639  INFO 16 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@157553a
2022-01-16 11:08:09.639  WARN 16 --- [https-jsse-nio-7071-exec-5] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:08:09.640  WARN 16 --- [https-jsse-nio-7071-exec-5] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:08:09.640  INFO 16 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@157553a
2022-01-16 11:08:09.689  INFO 16 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: emergency-active, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@157553a
2022-01-16 11:08:09.703  INFO 16 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@157553a
2022-01-16 11:08:09.703  INFO 16 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@157553a
2022-01-16 11:08:09.715  INFO 16 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@157553a
2022-01-16 11:08:09.715  INFO 16 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-revoke-extra, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@157553a
2022-01-16 11:08:09.774  INFO 16 --- [https-jsse-nio-7071-exec-5] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18909740715739961-261979, decision=PERMIT, pdp-result=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}})
2022-01-16 11:08:09.775  INFO 16 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=f6e9ac29-0103-4fd7-832f-a7929c8d5d8d, content=PERMIT, timestamp=1642331289775, pdpResult=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}}))
2022-01-16 11:08:09.775  INFO 16 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=160ms, Total=163ms
2022-01-16 11:08:09.798  INFO 16 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=3d45d18a-31b0-4759-91dc-ff99c76f777b, content=null, timestamp=1642331289792, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=50476, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=5fb2fe03fb5a, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=7187b2ea-af71-4106-9885-90a594c75da9, http-req-server-port=80, http-header-accept=*/*, kc-id=6b662965-9581-452d-9a8e-efb17f194ea0, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642331289790, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeP9sHNxAH4AEQAAAABh4/yEdAAkNmI2NjI5NjUtOTU4MS00NTJkLTlhOGUtZWZiMTdmMTk0ZWEwdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ3MTg3YjJlYS1hZjcxLTQxMDYtOTg4NS05MGE1OTRjNzVkYTlwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICI2cGUwZ2U1ck0zU2E2SUt5WXBsLTVkQTZrVXVleWo3X1psV2c1aDU4MmFvIn0.eyJleHAiOjE2NDIzMzE1NjgsImlhdCI6MTY0MjMzMTI2OCwianRpIjoiNmI2NjI5NjUtOTU4MS00NTJkLTlhOGUtZWZiMTdmMTk0ZWEwIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiI3MTg3YjJlYS1hZjcxLTQxMDYtOTg4NS05MGE1OTRjNzVkYTkiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.omg8lBi8aYXNKFtyz-59LVSg2a2tCMxJ-pijDZk_PJuP3t0KLP9mK065sgr18j9RRLlhB5Gz2kgicFArxHtivEl0gUXu61vDMI1JwNX-iJP3IW1nOuz1niWS06XTsBAs3FLboN9JCzCrlyLSB7kFOSKNyr9gnqXqesWQU1H_s6k9aowpZ2V4aNEsojTx4jRXH2wCNB77m23zlaTQfbhQx_Hi4ZBiiOFCmRXadXaP0PC2LKecdNH4x8WAIIR9Jxwe-mzphLjj5_er637GhiPlR7lUQk9Yn4L72NWb6IEYvcz5_B5E73AFiU_xFR5kcOBPp-wTl_8-LRcBhxSaV9WLrA, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642331568, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.48.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=8AC411B66D3D8A57E66ECF30E6D62D22, http-session-last-accessed-time=1642331289790, kc-category-name=ACCESS, kc-iat=1642331268, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:50476 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:08:09.799  INFO 16 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:08:09.799  INFO 16 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@426e148b
2022-01-16 11:08:09.800  INFO 16 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@426e148b
2022-01-16 11:08:09.820  INFO 16 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@426e148b
2022-01-16 11:08:09.820  INFO 16 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@426e148b
2022-01-16 11:08:09.832  INFO 16 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@426e148b
2022-01-16 11:08:09.861  WARN 16 --- [https-jsse-nio-7071-exec-6] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:08:09.861  WARN 16 --- [https-jsse-nio-7071-exec-6] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:08:09.861  INFO 16 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@426e148b
2022-01-16 11:08:09.861  INFO 16 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@426e148b
2022-01-16 11:08:09.861  WARN 16 --- [https-jsse-nio-7071-exec-6] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:08:09.861  WARN 16 --- [https-jsse-nio-7071-exec-6] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:08:09.862  INFO 16 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@426e148b
2022-01-16 11:08:09.929  INFO 16 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: emergency-active, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@426e148b
2022-01-16 11:08:09.938  INFO 16 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@426e148b
2022-01-16 11:08:09.938  INFO 16 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@426e148b
2022-01-16 11:08:09.949  INFO 16 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@426e148b
2022-01-16 11:08:09.949  INFO 16 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-revoke-extra, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@426e148b
2022-01-16 11:08:10.005  INFO 16 --- [https-jsse-nio-7071-exec-6] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18909740900525832-29941, decision=PERMIT, pdp-result=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}})
2022-01-16 11:08:10.006  INFO 16 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=3d45d18a-31b0-4759-91dc-ff99c76f777b, content=PERMIT, timestamp=1642331290006, pdpResult=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}}))
2022-01-16 11:08:10.006  INFO 16 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=207ms, Total=210ms
2022-01-16 11:08:10.032  INFO 16 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=f20c936a-c056-4f3b-a743-3dd6cc6fee31, content=null, timestamp=1642331290023, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=50478, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=5fb2fe03fb5a, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=7187b2ea-af71-4106-9885-90a594c75da9, http-req-server-port=80, http-header-accept=*/*, kc-id=6b662965-9581-452d-9a8e-efb17f194ea0, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642331290021, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeP9sHNxAH4AEQAAAABh4/yEdAAkNmI2NjI5NjUtOTU4MS00NTJkLTlhOGUtZWZiMTdmMTk0ZWEwdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ3MTg3YjJlYS1hZjcxLTQxMDYtOTg4NS05MGE1OTRjNzVkYTlwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICI2cGUwZ2U1ck0zU2E2SUt5WXBsLTVkQTZrVXVleWo3X1psV2c1aDU4MmFvIn0.eyJleHAiOjE2NDIzMzE1NjgsImlhdCI6MTY0MjMzMTI2OCwianRpIjoiNmI2NjI5NjUtOTU4MS00NTJkLTlhOGUtZWZiMTdmMTk0ZWEwIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiI3MTg3YjJlYS1hZjcxLTQxMDYtOTg4NS05MGE1OTRjNzVkYTkiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.omg8lBi8aYXNKFtyz-59LVSg2a2tCMxJ-pijDZk_PJuP3t0KLP9mK065sgr18j9RRLlhB5Gz2kgicFArxHtivEl0gUXu61vDMI1JwNX-iJP3IW1nOuz1niWS06XTsBAs3FLboN9JCzCrlyLSB7kFOSKNyr9gnqXqesWQU1H_s6k9aowpZ2V4aNEsojTx4jRXH2wCNB77m23zlaTQfbhQx_Hi4ZBiiOFCmRXadXaP0PC2LKecdNH4x8WAIIR9Jxwe-mzphLjj5_er637GhiPlR7lUQk9Yn4L72NWb6IEYvcz5_B5E73AFiU_xFR5kcOBPp-wTl_8-LRcBhxSaV9WLrA, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642331568, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.48.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=DE6954AE3135A4D9EE8A8040B390E333, http-session-last-accessed-time=1642331290021, kc-category-name=ACCESS, kc-iat=1642331268, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:50478 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:08:10.033  INFO 16 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:08:10.034  INFO 16 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@65f05909
2022-01-16 11:08:10.034  INFO 16 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@65f05909
2022-01-16 11:08:10.046  INFO 16 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@65f05909
2022-01-16 11:08:10.046  INFO 16 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@65f05909
2022-01-16 11:08:10.057  INFO 16 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@65f05909
2022-01-16 11:08:10.058  WARN 16 --- [https-jsse-nio-7071-exec-7] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:08:10.058  WARN 16 --- [https-jsse-nio-7071-exec-7] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:08:10.058  INFO 16 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@65f05909
2022-01-16 11:08:10.058  INFO 16 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@65f05909
2022-01-16 11:08:10.058  WARN 16 --- [https-jsse-nio-7071-exec-7] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:08:10.059  WARN 16 --- [https-jsse-nio-7071-exec-7] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:08:10.059  INFO 16 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@65f05909
2022-01-16 11:08:10.113  INFO 16 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: emergency-active, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@65f05909
2022-01-16 11:08:10.126  INFO 16 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@65f05909
2022-01-16 11:08:10.126  INFO 16 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@65f05909
2022-01-16 11:08:10.136  INFO 16 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@65f05909
2022-01-16 11:08:10.136  INFO 16 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-revoke-extra, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@65f05909
2022-01-16 11:08:10.189  INFO 16 --- [https-jsse-nio-7071-exec-7] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18909741134348671-359149, decision=PERMIT, pdp-result=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}})
2022-01-16 11:08:10.190  INFO 16 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=f20c936a-c056-4f3b-a743-3dd6cc6fee31, content=PERMIT, timestamp=1642331290190, pdpResult=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}}))
2022-01-16 11:08:10.190  INFO 16 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=157ms, Total=159ms
2022-01-16 11:08:10.214  INFO 16 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=517167d5-61a0-47f3-9b7c-26e834d846d5, content=null, timestamp=1642331290208, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=50480, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=5fb2fe03fb5a, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=7187b2ea-af71-4106-9885-90a594c75da9, http-req-server-port=80, http-header-accept=*/*, kc-id=6b662965-9581-452d-9a8e-efb17f194ea0, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642331290206, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeP9sHNxAH4AEQAAAABh4/yEdAAkNmI2NjI5NjUtOTU4MS00NTJkLTlhOGUtZWZiMTdmMTk0ZWEwdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ3MTg3YjJlYS1hZjcxLTQxMDYtOTg4NS05MGE1OTRjNzVkYTlwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICI2cGUwZ2U1ck0zU2E2SUt5WXBsLTVkQTZrVXVleWo3X1psV2c1aDU4MmFvIn0.eyJleHAiOjE2NDIzMzE1NjgsImlhdCI6MTY0MjMzMTI2OCwianRpIjoiNmI2NjI5NjUtOTU4MS00NTJkLTlhOGUtZWZiMTdmMTk0ZWEwIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiI3MTg3YjJlYS1hZjcxLTQxMDYtOTg4NS05MGE1OTRjNzVkYTkiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.omg8lBi8aYXNKFtyz-59LVSg2a2tCMxJ-pijDZk_PJuP3t0KLP9mK065sgr18j9RRLlhB5Gz2kgicFArxHtivEl0gUXu61vDMI1JwNX-iJP3IW1nOuz1niWS06XTsBAs3FLboN9JCzCrlyLSB7kFOSKNyr9gnqXqesWQU1H_s6k9aowpZ2V4aNEsojTx4jRXH2wCNB77m23zlaTQfbhQx_Hi4ZBiiOFCmRXadXaP0PC2LKecdNH4x8WAIIR9Jxwe-mzphLjj5_er637GhiPlR7lUQk9Yn4L72NWb6IEYvcz5_B5E73AFiU_xFR5kcOBPp-wTl_8-LRcBhxSaV9WLrA, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642331568, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.48.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=DC732DA42EE0394947B1C466EB941D97, http-session-last-accessed-time=1642331290206, kc-category-name=ACCESS, kc-iat=1642331268, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:50480 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:08:10.216  INFO 16 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:08:10.221  INFO 16 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6be947f3
2022-01-16 11:08:10.221  INFO 16 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6be947f3
2022-01-16 11:08:10.234  INFO 16 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6be947f3
2022-01-16 11:08:10.234  INFO 16 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6be947f3
2022-01-16 11:08:10.249  INFO 16 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6be947f3
2022-01-16 11:08:10.249  WARN 16 --- [https-jsse-nio-7071-exec-8] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:08:10.249  WARN 16 --- [https-jsse-nio-7071-exec-8] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:08:10.249  INFO 16 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6be947f3
2022-01-16 11:08:10.249  INFO 16 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6be947f3
2022-01-16 11:08:10.249  WARN 16 --- [https-jsse-nio-7071-exec-8] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:08:10.249  WARN 16 --- [https-jsse-nio-7071-exec-8] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:08:10.249  INFO 16 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6be947f3
2022-01-16 11:08:10.301  INFO 16 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: emergency-active, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6be947f3
2022-01-16 11:08:10.314  INFO 16 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6be947f3
2022-01-16 11:08:10.314  INFO 16 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6be947f3
2022-01-16 11:08:10.323  INFO 16 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6be947f3
2022-01-16 11:08:10.323  INFO 16 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-revoke-extra, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6be947f3
2022-01-16 11:08:10.374  INFO 16 --- [https-jsse-nio-7071-exec-8] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18909741317180004-965473, decision=PERMIT, pdp-result=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}})
2022-01-16 11:08:10.374  INFO 16 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=517167d5-61a0-47f3-9b7c-26e834d846d5, content=PERMIT, timestamp=1642331290374, pdpResult=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}}))
2022-01-16 11:08:10.375  INFO 16 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=158ms, Total=163ms
