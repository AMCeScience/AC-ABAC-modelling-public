2022-01-16 11:17:49.721  INFO 16 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=60ms, Total=68ms
2022-01-16 11:17:49.742  INFO 16 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=80ec924f-6465-4fd8-ac82-9f75a48d9d9a, content=null, timestamp=1642331869734, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=51072, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=22766fcc86b6, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=aafd4250-e6a1-4378-91fb-a2a4ddd87c5e, http-req-server-port=80, http-header-accept=*/*, kc-id=77b9495c-1692-426c-96be-094189073545, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642331869733, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQAB3NxAH4AEQAAAABh4/7bdAAkNzdiOTQ5NWMtMTY5Mi00MjZjLTk2YmUtMDk0MTg5MDczNTQ1dAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRhYWZkNDI1MC1lNmExLTQzNzgtOTFmYi1hMmE0ZGRkODdjNWVwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJhY3dRY1p6TGlENW1hRl85amJINGVRVFplOElvZDdldllhOUk2eDVXWjJnIn0.eyJleHAiOjE2NDIzMzIxNjcsImlhdCI6MTY0MjMzMTg2NywianRpIjoiNzdiOTQ5NWMtMTY5Mi00MjZjLTk2YmUtMDk0MTg5MDczNTQ1IiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiJhYWZkNDI1MC1lNmExLTQzNzgtOTFmYi1hMmE0ZGRkODdjNWUiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.ep3IG5UMcj__1HopMvUFb4xo9nI32gjSZwh03RVYoaim2ExbnEMIikZYIfXlh68pK0CGsTDpWMFgwTbyE98St8icBudSUAJ7fcG3ZJGb84sN9y5pZx7kMMWsBOdB37lSq2eX5SR6l1XgEUB3QxLM6uCgqXfD8yQ7r-ZSC1WitU1NoZ3zGnlrJ4e2aMv_CbLrohDHGwrC2jJJh5Zru_VzRYxTqfIfbMQu6To4QONfTJnbu47lmp8wtTkJIISRnNYAwTUPFWUjm-MHSLlOlOgU9eGKLm6VTM_WxZxFSX5mHs3gbOp_Ou_jDgVNbgzItCK6BCJSXoXfhVOCgNnH_g6F_w, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre/read, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642332167, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.144.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=D64B1D1EA340A9AEC5130A50456FB2D2, http-session-last-accessed-time=1642331869733, kc-category-name=ACCESS, kc-iat=1642331867, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:51072 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:17:49.742  INFO 16 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:17:49.743  INFO 16 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@270e792b
2022-01-16 11:17:49.744  INFO 16 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@270e792b
2022-01-16 11:17:49.760  INFO 16 --- [https-jsse-nio-7071-exec-6] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18910320843785404-263255, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:31aa3bfa-c095-4f10-a6c7-a9d759a8e54b:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=31aa3bfa-c095-4f10-a6c7-a9d759a8e54b, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time after Shift Start, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:17:49.761  INFO 16 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=80ec924f-6465-4fd8-ac82-9f75a48d9d9a, content=DENY, timestamp=1642331869761, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:31aa3bfa-c095-4f10-a6c7-a9d759a8e54b:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=31aa3bfa-c095-4f10-a6c7-a9d759a8e54b, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time after Shift Start, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:17:49.762  INFO 16 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=19ms, Total=22ms
2022-01-16 11:17:49.809  INFO 16 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=e26ea0f2-e0ff-4108-b0c4-beaf06283ff0, content=null, timestamp=1642331869774, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=51074, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=22766fcc86b6, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=aafd4250-e6a1-4378-91fb-a2a4ddd87c5e, http-req-server-port=80, http-header-accept=*/*, kc-id=77b9495c-1692-426c-96be-094189073545, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642331869773, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQAB3NxAH4AEQAAAABh4/7bdAAkNzdiOTQ5NWMtMTY5Mi00MjZjLTk2YmUtMDk0MTg5MDczNTQ1dAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRhYWZkNDI1MC1lNmExLTQzNzgtOTFmYi1hMmE0ZGRkODdjNWVwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJhY3dRY1p6TGlENW1hRl85amJINGVRVFplOElvZDdldllhOUk2eDVXWjJnIn0.eyJleHAiOjE2NDIzMzIxNjcsImlhdCI6MTY0MjMzMTg2NywianRpIjoiNzdiOTQ5NWMtMTY5Mi00MjZjLTk2YmUtMDk0MTg5MDczNTQ1IiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiJhYWZkNDI1MC1lNmExLTQzNzgtOTFmYi1hMmE0ZGRkODdjNWUiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.ep3IG5UMcj__1HopMvUFb4xo9nI32gjSZwh03RVYoaim2ExbnEMIikZYIfXlh68pK0CGsTDpWMFgwTbyE98St8icBudSUAJ7fcG3ZJGb84sN9y5pZx7kMMWsBOdB37lSq2eX5SR6l1XgEUB3QxLM6uCgqXfD8yQ7r-ZSC1WitU1NoZ3zGnlrJ4e2aMv_CbLrohDHGwrC2jJJh5Zru_VzRYxTqfIfbMQu6To4QONfTJnbu47lmp8wtTkJIISRnNYAwTUPFWUjm-MHSLlOlOgU9eGKLm6VTM_WxZxFSX5mHs3gbOp_Ou_jDgVNbgzItCK6BCJSXoXfhVOCgNnH_g6F_w, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre/read, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642332167, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.144.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=D8B9CED26CEFA0B7DF0BB2F0CD78E4F4, http-session-last-accessed-time=1642331869773, kc-category-name=ACCESS, kc-iat=1642331867, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:51074 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:17:49.811  INFO 16 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:17:49.812  INFO 16 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@227d9a16
2022-01-16 11:17:49.813  INFO 16 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@227d9a16
2022-01-16 11:17:49.831  INFO 16 --- [https-jsse-nio-7071-exec-7] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18910320912330906-33674, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:31aa3bfa-c095-4f10-a6c7-a9d759a8e54b:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=31aa3bfa-c095-4f10-a6c7-a9d759a8e54b, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time after Shift Start, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:17:49.831  INFO 16 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=e26ea0f2-e0ff-4108-b0c4-beaf06283ff0, content=DENY, timestamp=1642331869831, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:31aa3bfa-c095-4f10-a6c7-a9d759a8e54b:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=31aa3bfa-c095-4f10-a6c7-a9d759a8e54b, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time after Shift Start, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:17:49.833  INFO 16 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=20ms, Total=44ms
2022-01-16 11:17:49.863  INFO 16 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=64a75509-ebc4-4b74-86f4-cf1372e0ab25, content=null, timestamp=1642331869848, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=51076, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=22766fcc86b6, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=aafd4250-e6a1-4378-91fb-a2a4ddd87c5e, http-req-server-port=80, http-header-accept=*/*, kc-id=77b9495c-1692-426c-96be-094189073545, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642331869846, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQAB3NxAH4AEQAAAABh4/7bdAAkNzdiOTQ5NWMtMTY5Mi00MjZjLTk2YmUtMDk0MTg5MDczNTQ1dAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRhYWZkNDI1MC1lNmExLTQzNzgtOTFmYi1hMmE0ZGRkODdjNWVwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJhY3dRY1p6TGlENW1hRl85amJINGVRVFplOElvZDdldllhOUk2eDVXWjJnIn0.eyJleHAiOjE2NDIzMzIxNjcsImlhdCI6MTY0MjMzMTg2NywianRpIjoiNzdiOTQ5NWMtMTY5Mi00MjZjLTk2YmUtMDk0MTg5MDczNTQ1IiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiJhYWZkNDI1MC1lNmExLTQzNzgtOTFmYi1hMmE0ZGRkODdjNWUiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.ep3IG5UMcj__1HopMvUFb4xo9nI32gjSZwh03RVYoaim2ExbnEMIikZYIfXlh68pK0CGsTDpWMFgwTbyE98St8icBudSUAJ7fcG3ZJGb84sN9y5pZx7kMMWsBOdB37lSq2eX5SR6l1XgEUB3QxLM6uCgqXfD8yQ7r-ZSC1WitU1NoZ3zGnlrJ4e2aMv_CbLrohDHGwrC2jJJh5Zru_VzRYxTqfIfbMQu6To4QONfTJnbu47lmp8wtTkJIISRnNYAwTUPFWUjm-MHSLlOlOgU9eGKLm6VTM_WxZxFSX5mHs3gbOp_Ou_jDgVNbgzItCK6BCJSXoXfhVOCgNnH_g6F_w, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre/read, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642332167, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.144.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=987A93D3C2EA7F03002D5FF0A8DE78A8, http-session-last-accessed-time=1642331869846, kc-category-name=ACCESS, kc-iat=1642331867, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:51076 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:17:49.865  INFO 16 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:17:49.866  INFO 16 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2d805a8c
2022-01-16 11:17:49.867  INFO 16 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2d805a8c
2022-01-16 11:17:49.883  INFO 16 --- [https-jsse-nio-7071-exec-8] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18910320966923815-238473, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:31aa3bfa-c095-4f10-a6c7-a9d759a8e54b:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=31aa3bfa-c095-4f10-a6c7-a9d759a8e54b, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time after Shift Start, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:17:49.883  INFO 16 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=64a75509-ebc4-4b74-86f4-cf1372e0ab25, content=DENY, timestamp=1642331869883, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:31aa3bfa-c095-4f10-a6c7-a9d759a8e54b:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=31aa3bfa-c095-4f10-a6c7-a9d759a8e54b, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time after Shift Start, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:17:49.884  INFO 16 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=18ms, Total=22ms
2022-01-16 11:17:49.906  INFO 16 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=713da70a-d19e-4c7c-85b9-9ab2954d3c22, content=null, timestamp=1642331869898, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=51078, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=22766fcc86b6, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=aafd4250-e6a1-4378-91fb-a2a4ddd87c5e, http-req-server-port=80, http-header-accept=*/*, kc-id=77b9495c-1692-426c-96be-094189073545, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642331869896, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQAB3NxAH4AEQAAAABh4/7bdAAkNzdiOTQ5NWMtMTY5Mi00MjZjLTk2YmUtMDk0MTg5MDczNTQ1dAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRhYWZkNDI1MC1lNmExLTQzNzgtOTFmYi1hMmE0ZGRkODdjNWVwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJhY3dRY1p6TGlENW1hRl85amJINGVRVFplOElvZDdldllhOUk2eDVXWjJnIn0.eyJleHAiOjE2NDIzMzIxNjcsImlhdCI6MTY0MjMzMTg2NywianRpIjoiNzdiOTQ5NWMtMTY5Mi00MjZjLTk2YmUtMDk0MTg5MDczNTQ1IiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiJhYWZkNDI1MC1lNmExLTQzNzgtOTFmYi1hMmE0ZGRkODdjNWUiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.ep3IG5UMcj__1HopMvUFb4xo9nI32gjSZwh03RVYoaim2ExbnEMIikZYIfXlh68pK0CGsTDpWMFgwTbyE98St8icBudSUAJ7fcG3ZJGb84sN9y5pZx7kMMWsBOdB37lSq2eX5SR6l1XgEUB3QxLM6uCgqXfD8yQ7r-ZSC1WitU1NoZ3zGnlrJ4e2aMv_CbLrohDHGwrC2jJJh5Zru_VzRYxTqfIfbMQu6To4QONfTJnbu47lmp8wtTkJIISRnNYAwTUPFWUjm-MHSLlOlOgU9eGKLm6VTM_WxZxFSX5mHs3gbOp_Ou_jDgVNbgzItCK6BCJSXoXfhVOCgNnH_g6F_w, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre/read, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642332167, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.144.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=B33C172FBD52809454AA14A0FB4E9DF7, http-session-last-accessed-time=1642331869896, kc-category-name=ACCESS, kc-iat=1642331867, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:51078 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:17:49.906  INFO 16 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:17:49.907  INFO 16 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7353d7e0
2022-01-16 11:17:49.908  INFO 16 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7353d7e0
2022-01-16 11:17:49.974  INFO 16 --- [https-jsse-nio-7071-exec-9] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18910321008298575-945264, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:31aa3bfa-c095-4f10-a6c7-a9d759a8e54b:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=31aa3bfa-c095-4f10-a6c7-a9d759a8e54b, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time after Shift Start, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:17:49.975  INFO 16 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=713da70a-d19e-4c7c-85b9-9ab2954d3c22, content=DENY, timestamp=1642331869975, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:31aa3bfa-c095-4f10-a6c7-a9d759a8e54b:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=31aa3bfa-c095-4f10-a6c7-a9d759a8e54b, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time after Shift Start, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:17:49.975  INFO 16 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=68ms, Total=71ms
2022-01-16 11:17:50.002  INFO 16 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=a1eec876-b25a-4d95-bf97-6135f5ac8f66, content=null, timestamp=1642331869993, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=51080, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=22766fcc86b6, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=aafd4250-e6a1-4378-91fb-a2a4ddd87c5e, http-req-server-port=80, http-header-accept=*/*, kc-id=77b9495c-1692-426c-96be-094189073545, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642331869992, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQAB3NxAH4AEQAAAABh4/7bdAAkNzdiOTQ5NWMtMTY5Mi00MjZjLTk2YmUtMDk0MTg5MDczNTQ1dAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRhYWZkNDI1MC1lNmExLTQzNzgtOTFmYi1hMmE0ZGRkODdjNWVwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJhY3dRY1p6TGlENW1hRl85amJINGVRVFplOElvZDdldllhOUk2eDVXWjJnIn0.eyJleHAiOjE2NDIzMzIxNjcsImlhdCI6MTY0MjMzMTg2NywianRpIjoiNzdiOTQ5NWMtMTY5Mi00MjZjLTk2YmUtMDk0MTg5MDczNTQ1IiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiJhYWZkNDI1MC1lNmExLTQzNzgtOTFmYi1hMmE0ZGRkODdjNWUiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.ep3IG5UMcj__1HopMvUFb4xo9nI32gjSZwh03RVYoaim2ExbnEMIikZYIfXlh68pK0CGsTDpWMFgwTbyE98St8icBudSUAJ7fcG3ZJGb84sN9y5pZx7kMMWsBOdB37lSq2eX5SR6l1XgEUB3QxLM6uCgqXfD8yQ7r-ZSC1WitU1NoZ3zGnlrJ4e2aMv_CbLrohDHGwrC2jJJh5Zru_VzRYxTqfIfbMQu6To4QONfTJnbu47lmp8wtTkJIISRnNYAwTUPFWUjm-MHSLlOlOgU9eGKLm6VTM_WxZxFSX5mHs3gbOp_Ou_jDgVNbgzItCK6BCJSXoXfhVOCgNnH_g6F_w, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre/read, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642332167, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.144.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=75077A8594E0CC9B4C5D6C3FB7C13973, http-session-last-accessed-time=1642331869992, kc-category-name=ACCESS, kc-iat=1642331867, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:51080 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:17:50.002  INFO 16 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:17:50.003  INFO 16 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4a6a9d51
2022-01-16 11:17:50.004  INFO 16 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4a6a9d51
2022-01-16 11:17:50.016  INFO 16 --- [https-jsse-nio-7071-exec-10] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18910321103954234-676802, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:31aa3bfa-c095-4f10-a6c7-a9d759a8e54b:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=31aa3bfa-c095-4f10-a6c7-a9d759a8e54b, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time after Shift Start, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:17:50.016  INFO 16 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=a1eec876-b25a-4d95-bf97-6135f5ac8f66, content=DENY, timestamp=1642331870016, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:31aa3bfa-c095-4f10-a6c7-a9d759a8e54b:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=31aa3bfa-c095-4f10-a6c7-a9d759a8e54b, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time after Shift Start, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:17:50.017  INFO 16 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=14ms, Total=17ms
2022-01-16 11:17:50.040  INFO 16 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=07b8acdc-3c14-4a52-8bac-d4f291ce4209, content=null, timestamp=1642331870031, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=51082, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=22766fcc86b6, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=aafd4250-e6a1-4378-91fb-a2a4ddd87c5e, http-req-server-port=80, http-header-accept=*/*, kc-id=77b9495c-1692-426c-96be-094189073545, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642331870029, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQAB3NxAH4AEQAAAABh4/7bdAAkNzdiOTQ5NWMtMTY5Mi00MjZjLTk2YmUtMDk0MTg5MDczNTQ1dAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRhYWZkNDI1MC1lNmExLTQzNzgtOTFmYi1hMmE0ZGRkODdjNWVwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJhY3dRY1p6TGlENW1hRl85amJINGVRVFplOElvZDdldllhOUk2eDVXWjJnIn0.eyJleHAiOjE2NDIzMzIxNjcsImlhdCI6MTY0MjMzMTg2NywianRpIjoiNzdiOTQ5NWMtMTY5Mi00MjZjLTk2YmUtMDk0MTg5MDczNTQ1IiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiJhYWZkNDI1MC1lNmExLTQzNzgtOTFmYi1hMmE0ZGRkODdjNWUiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.ep3IG5UMcj__1HopMvUFb4xo9nI32gjSZwh03RVYoaim2ExbnEMIikZYIfXlh68pK0CGsTDpWMFgwTbyE98St8icBudSUAJ7fcG3ZJGb84sN9y5pZx7kMMWsBOdB37lSq2eX5SR6l1XgEUB3QxLM6uCgqXfD8yQ7r-ZSC1WitU1NoZ3zGnlrJ4e2aMv_CbLrohDHGwrC2jJJh5Zru_VzRYxTqfIfbMQu6To4QONfTJnbu47lmp8wtTkJIISRnNYAwTUPFWUjm-MHSLlOlOgU9eGKLm6VTM_WxZxFSX5mHs3gbOp_Ou_jDgVNbgzItCK6BCJSXoXfhVOCgNnH_g6F_w, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre/read, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642332167, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.144.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=84A28D17D842D413E39200CE3EC557C6, http-session-last-accessed-time=1642331870029, kc-category-name=ACCESS, kc-iat=1642331867, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:51082 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:17:50.040  INFO 16 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:17:50.041  INFO 16 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@381fd185
2022-01-16 11:17:50.041  INFO 16 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@381fd185
2022-01-16 11:17:50.052  INFO 16 --- [https-jsse-nio-7071-exec-1] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18910321141460224-461581, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:31aa3bfa-c095-4f10-a6c7-a9d759a8e54b:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=31aa3bfa-c095-4f10-a6c7-a9d759a8e54b, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time after Shift Start, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:17:50.053  INFO 16 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=07b8acdc-3c14-4a52-8bac-d4f291ce4209, content=DENY, timestamp=1642331870053, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:31aa3bfa-c095-4f10-a6c7-a9d759a8e54b:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=31aa3bfa-c095-4f10-a6c7-a9d759a8e54b, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time after Shift Start, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:17:50.054  INFO 16 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=13ms, Total=16ms
2022-01-16 11:17:50.076  INFO 16 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=2d62ec75-d7e1-4edd-bb56-224659945169, content=null, timestamp=1642331870070, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=51084, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=22766fcc86b6, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=aafd4250-e6a1-4378-91fb-a2a4ddd87c5e, http-req-server-port=80, http-header-accept=*/*, kc-id=77b9495c-1692-426c-96be-094189073545, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642331870069, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQAB3NxAH4AEQAAAABh4/7bdAAkNzdiOTQ5NWMtMTY5Mi00MjZjLTk2YmUtMDk0MTg5MDczNTQ1dAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRhYWZkNDI1MC1lNmExLTQzNzgtOTFmYi1hMmE0ZGRkODdjNWVwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJhY3dRY1p6TGlENW1hRl85amJINGVRVFplOElvZDdldllhOUk2eDVXWjJnIn0.eyJleHAiOjE2NDIzMzIxNjcsImlhdCI6MTY0MjMzMTg2NywianRpIjoiNzdiOTQ5NWMtMTY5Mi00MjZjLTk2YmUtMDk0MTg5MDczNTQ1IiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiJhYWZkNDI1MC1lNmExLTQzNzgtOTFmYi1hMmE0ZGRkODdjNWUiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.ep3IG5UMcj__1HopMvUFb4xo9nI32gjSZwh03RVYoaim2ExbnEMIikZYIfXlh68pK0CGsTDpWMFgwTbyE98St8icBudSUAJ7fcG3ZJGb84sN9y5pZx7kMMWsBOdB37lSq2eX5SR6l1XgEUB3QxLM6uCgqXfD8yQ7r-ZSC1WitU1NoZ3zGnlrJ4e2aMv_CbLrohDHGwrC2jJJh5Zru_VzRYxTqfIfbMQu6To4QONfTJnbu47lmp8wtTkJIISRnNYAwTUPFWUjm-MHSLlOlOgU9eGKLm6VTM_WxZxFSX5mHs3gbOp_Ou_jDgVNbgzItCK6BCJSXoXfhVOCgNnH_g6F_w, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre/read, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642332167, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.144.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=A2EBECC04FD0231F55A84B28F08FE461, http-session-last-accessed-time=1642331870069, kc-category-name=ACCESS, kc-iat=1642331867, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:51084 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:17:50.077  INFO 16 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:17:50.079  INFO 16 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7d7c9a63
2022-01-16 11:17:50.080  INFO 16 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7d7c9a63
2022-01-16 11:17:50.135  INFO 16 --- [https-jsse-nio-7071-exec-2] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18910321178896388-228987, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:31aa3bfa-c095-4f10-a6c7-a9d759a8e54b:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=31aa3bfa-c095-4f10-a6c7-a9d759a8e54b, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time after Shift Start, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:17:50.135  INFO 16 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=2d62ec75-d7e1-4edd-bb56-224659945169, content=DENY, timestamp=1642331870135, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:31aa3bfa-c095-4f10-a6c7-a9d759a8e54b:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=31aa3bfa-c095-4f10-a6c7-a9d759a8e54b, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time after Shift Start, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:17:50.136  INFO 16 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=58ms, Total=62ms
2022-01-16 11:17:50.160  INFO 16 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=a9625c5a-8f83-45b0-b1cd-98402c92e860, content=null, timestamp=1642331870152, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=51086, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=22766fcc86b6, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=aafd4250-e6a1-4378-91fb-a2a4ddd87c5e, http-req-server-port=80, http-header-accept=*/*, kc-id=77b9495c-1692-426c-96be-094189073545, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642331870151, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQAB3NxAH4AEQAAAABh4/7bdAAkNzdiOTQ5NWMtMTY5Mi00MjZjLTk2YmUtMDk0MTg5MDczNTQ1dAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRhYWZkNDI1MC1lNmExLTQzNzgtOTFmYi1hMmE0ZGRkODdjNWVwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJhY3dRY1p6TGlENW1hRl85amJINGVRVFplOElvZDdldllhOUk2eDVXWjJnIn0.eyJleHAiOjE2NDIzMzIxNjcsImlhdCI6MTY0MjMzMTg2NywianRpIjoiNzdiOTQ5NWMtMTY5Mi00MjZjLTk2YmUtMDk0MTg5MDczNTQ1IiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiJhYWZkNDI1MC1lNmExLTQzNzgtOTFmYi1hMmE0ZGRkODdjNWUiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.ep3IG5UMcj__1HopMvUFb4xo9nI32gjSZwh03RVYoaim2ExbnEMIikZYIfXlh68pK0CGsTDpWMFgwTbyE98St8icBudSUAJ7fcG3ZJGb84sN9y5pZx7kMMWsBOdB37lSq2eX5SR6l1XgEUB3QxLM6uCgqXfD8yQ7r-ZSC1WitU1NoZ3zGnlrJ4e2aMv_CbLrohDHGwrC2jJJh5Zru_VzRYxTqfIfbMQu6To4QONfTJnbu47lmp8wtTkJIISRnNYAwTUPFWUjm-MHSLlOlOgU9eGKLm6VTM_WxZxFSX5mHs3gbOp_Ou_jDgVNbgzItCK6BCJSXoXfhVOCgNnH_g6F_w, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre/read, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642332167, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.144.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=E8E8CE7D936144AC17377631079DFD35, http-session-last-accessed-time=1642331870151, kc-category-name=ACCESS, kc-iat=1642331867, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:51086 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:17:50.161  INFO 16 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:17:50.163  INFO 16 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@51a75927
2022-01-16 11:17:50.164  INFO 16 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@51a75927
2022-01-16 11:17:50.176  INFO 16 --- [https-jsse-nio-7071-exec-3] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18910321263247205-685764, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:31aa3bfa-c095-4f10-a6c7-a9d759a8e54b:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=31aa3bfa-c095-4f10-a6c7-a9d759a8e54b, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time after Shift Start, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:17:50.176  INFO 16 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=a9625c5a-8f83-45b0-b1cd-98402c92e860, content=DENY, timestamp=1642331870176, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:31aa3bfa-c095-4f10-a6c7-a9d759a8e54b:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=31aa3bfa-c095-4f10-a6c7-a9d759a8e54b, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time after Shift Start, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:17:50.177  INFO 16 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=14ms, Total=19ms
2022-01-16 11:17:50.195  INFO 16 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=c1844d79-6b88-4fa6-b42e-feaad2fb7964, content=null, timestamp=1642331870190, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=51088, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=22766fcc86b6, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=aafd4250-e6a1-4378-91fb-a2a4ddd87c5e, http-req-server-port=80, http-header-accept=*/*, kc-id=77b9495c-1692-426c-96be-094189073545, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642331870188, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQAB3NxAH4AEQAAAABh4/7bdAAkNzdiOTQ5NWMtMTY5Mi00MjZjLTk2YmUtMDk0MTg5MDczNTQ1dAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRhYWZkNDI1MC1lNmExLTQzNzgtOTFmYi1hMmE0ZGRkODdjNWVwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJhY3dRY1p6TGlENW1hRl85amJINGVRVFplOElvZDdldllhOUk2eDVXWjJnIn0.eyJleHAiOjE2NDIzMzIxNjcsImlhdCI6MTY0MjMzMTg2NywianRpIjoiNzdiOTQ5NWMtMTY5Mi00MjZjLTk2YmUtMDk0MTg5MDczNTQ1IiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiJhYWZkNDI1MC1lNmExLTQzNzgtOTFmYi1hMmE0ZGRkODdjNWUiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.ep3IG5UMcj__1HopMvUFb4xo9nI32gjSZwh03RVYoaim2ExbnEMIikZYIfXlh68pK0CGsTDpWMFgwTbyE98St8icBudSUAJ7fcG3ZJGb84sN9y5pZx7kMMWsBOdB37lSq2eX5SR6l1XgEUB3QxLM6uCgqXfD8yQ7r-ZSC1WitU1NoZ3zGnlrJ4e2aMv_CbLrohDHGwrC2jJJh5Zru_VzRYxTqfIfbMQu6To4QONfTJnbu47lmp8wtTkJIISRnNYAwTUPFWUjm-MHSLlOlOgU9eGKLm6VTM_WxZxFSX5mHs3gbOp_Ou_jDgVNbgzItCK6BCJSXoXfhVOCgNnH_g6F_w, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre/read, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642332167, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.144.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=5BB275550492B251BB9AFCBC46D71663, http-session-last-accessed-time=1642331870188, kc-category-name=ACCESS, kc-iat=1642331867, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:51088 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:17:50.196  INFO 16 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:17:50.198  INFO 16 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@76e3fb4f
2022-01-16 11:17:50.199  INFO 16 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@76e3fb4f
2022-01-16 11:17:50.210  INFO 16 --- [https-jsse-nio-7071-exec-4] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18910321298954581-342580, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:31aa3bfa-c095-4f10-a6c7-a9d759a8e54b:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=31aa3bfa-c095-4f10-a6c7-a9d759a8e54b, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time after Shift Start, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:17:50.210  INFO 16 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=c1844d79-6b88-4fa6-b42e-feaad2fb7964, content=DENY, timestamp=1642331870210, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:31aa3bfa-c095-4f10-a6c7-a9d759a8e54b:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=31aa3bfa-c095-4f10-a6c7-a9d759a8e54b, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time after Shift Start, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:17:50.211  INFO 16 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=13ms, Total=17ms
2022-01-16 11:17:50.230  INFO 16 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=a8481798-53c8-49c7-9ecb-49993723d905, content=null, timestamp=1642331870224, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=51090, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=22766fcc86b6, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=aafd4250-e6a1-4378-91fb-a2a4ddd87c5e, http-req-server-port=80, http-header-accept=*/*, kc-id=77b9495c-1692-426c-96be-094189073545, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642331870223, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQAB3NxAH4AEQAAAABh4/7bdAAkNzdiOTQ5NWMtMTY5Mi00MjZjLTk2YmUtMDk0MTg5MDczNTQ1dAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRhYWZkNDI1MC1lNmExLTQzNzgtOTFmYi1hMmE0ZGRkODdjNWVwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJhY3dRY1p6TGlENW1hRl85amJINGVRVFplOElvZDdldllhOUk2eDVXWjJnIn0.eyJleHAiOjE2NDIzMzIxNjcsImlhdCI6MTY0MjMzMTg2NywianRpIjoiNzdiOTQ5NWMtMTY5Mi00MjZjLTk2YmUtMDk0MTg5MDczNTQ1IiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiJhYWZkNDI1MC1lNmExLTQzNzgtOTFmYi1hMmE0ZGRkODdjNWUiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.ep3IG5UMcj__1HopMvUFb4xo9nI32gjSZwh03RVYoaim2ExbnEMIikZYIfXlh68pK0CGsTDpWMFgwTbyE98St8icBudSUAJ7fcG3ZJGb84sN9y5pZx7kMMWsBOdB37lSq2eX5SR6l1XgEUB3QxLM6uCgqXfD8yQ7r-ZSC1WitU1NoZ3zGnlrJ4e2aMv_CbLrohDHGwrC2jJJh5Zru_VzRYxTqfIfbMQu6To4QONfTJnbu47lmp8wtTkJIISRnNYAwTUPFWUjm-MHSLlOlOgU9eGKLm6VTM_WxZxFSX5mHs3gbOp_Ou_jDgVNbgzItCK6BCJSXoXfhVOCgNnH_g6F_w, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre/read, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642332167, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.144.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=0C16F2F9375FD3ADA336E98FCC6CAD7C, http-session-last-accessed-time=1642331870223, kc-category-name=ACCESS, kc-iat=1642331867, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:51090 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:17:50.231  INFO 16 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:17:50.232  INFO 16 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6c8b126e
2022-01-16 11:17:50.232  INFO 16 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6c8b126e
2022-01-16 11:17:50.286  INFO 16 --- [https-jsse-nio-7071-exec-5] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18910321332826113-7929, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:31aa3bfa-c095-4f10-a6c7-a9d759a8e54b:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=31aa3bfa-c095-4f10-a6c7-a9d759a8e54b, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time after Shift Start, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:17:50.287  INFO 16 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=a8481798-53c8-49c7-9ecb-49993723d905, content=DENY, timestamp=1642331870287, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:31aa3bfa-c095-4f10-a6c7-a9d759a8e54b:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=31aa3bfa-c095-4f10-a6c7-a9d759a8e54b, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time after Shift Start, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:17:50.287  INFO 16 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=56ms, Total=58ms
2022-01-16 11:17:50.307  INFO 16 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=774303d8-f7e3-406e-be77-7555aed9c171, content=null, timestamp=1642331870302, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=51092, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=22766fcc86b6, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=aafd4250-e6a1-4378-91fb-a2a4ddd87c5e, http-req-server-port=80, http-header-accept=*/*, kc-id=77b9495c-1692-426c-96be-094189073545, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642331870301, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQAB3NxAH4AEQAAAABh4/7bdAAkNzdiOTQ5NWMtMTY5Mi00MjZjLTk2YmUtMDk0MTg5MDczNTQ1dAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRhYWZkNDI1MC1lNmExLTQzNzgtOTFmYi1hMmE0ZGRkODdjNWVwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJhY3dRY1p6TGlENW1hRl85amJINGVRVFplOElvZDdldllhOUk2eDVXWjJnIn0.eyJleHAiOjE2NDIzMzIxNjcsImlhdCI6MTY0MjMzMTg2NywianRpIjoiNzdiOTQ5NWMtMTY5Mi00MjZjLTk2YmUtMDk0MTg5MDczNTQ1IiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiJhYWZkNDI1MC1lNmExLTQzNzgtOTFmYi1hMmE0ZGRkODdjNWUiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.ep3IG5UMcj__1HopMvUFb4xo9nI32gjSZwh03RVYoaim2ExbnEMIikZYIfXlh68pK0CGsTDpWMFgwTbyE98St8icBudSUAJ7fcG3ZJGb84sN9y5pZx7kMMWsBOdB37lSq2eX5SR6l1XgEUB3QxLM6uCgqXfD8yQ7r-ZSC1WitU1NoZ3zGnlrJ4e2aMv_CbLrohDHGwrC2jJJh5Zru_VzRYxTqfIfbMQu6To4QONfTJnbu47lmp8wtTkJIISRnNYAwTUPFWUjm-MHSLlOlOgU9eGKLm6VTM_WxZxFSX5mHs3gbOp_Ou_jDgVNbgzItCK6BCJSXoXfhVOCgNnH_g6F_w, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre/read, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642332167, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.144.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=2878E0F8459F9BAD8C9CE82303E544BA, http-session-last-accessed-time=1642331870301, kc-category-name=ACCESS, kc-iat=1642331867, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:51092 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:17:50.308  INFO 16 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:17:50.309  INFO 16 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2cad54ed
2022-01-16 11:17:50.310  INFO 16 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2cad54ed
2022-01-16 11:17:50.323  INFO 16 --- [https-jsse-nio-7071-exec-6] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18910321409548593-712605, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:31aa3bfa-c095-4f10-a6c7-a9d759a8e54b:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=31aa3bfa-c095-4f10-a6c7-a9d759a8e54b, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time after Shift Start, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:17:50.323  INFO 16 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=774303d8-f7e3-406e-be77-7555aed9c171, content=DENY, timestamp=1642331870323, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:31aa3bfa-c095-4f10-a6c7-a9d759a8e54b:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=31aa3bfa-c095-4f10-a6c7-a9d759a8e54b, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time after Shift Start, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:17:50.324  INFO 16 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=15ms, Total=18ms
2022-01-16 11:17:50.343  INFO 16 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=077d5c67-ab03-4f96-81a9-c93cc8200687, content=null, timestamp=1642331870336, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=51094, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=22766fcc86b6, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=aafd4250-e6a1-4378-91fb-a2a4ddd87c5e, http-req-server-port=80, http-header-accept=*/*, kc-id=77b9495c-1692-426c-96be-094189073545, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642331870335, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQAB3NxAH4AEQAAAABh4/7bdAAkNzdiOTQ5NWMtMTY5Mi00MjZjLTk2YmUtMDk0MTg5MDczNTQ1dAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRhYWZkNDI1MC1lNmExLTQzNzgtOTFmYi1hMmE0ZGRkODdjNWVwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJhY3dRY1p6TGlENW1hRl85amJINGVRVFplOElvZDdldllhOUk2eDVXWjJnIn0.eyJleHAiOjE2NDIzMzIxNjcsImlhdCI6MTY0MjMzMTg2NywianRpIjoiNzdiOTQ5NWMtMTY5Mi00MjZjLTk2YmUtMDk0MTg5MDczNTQ1IiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiJhYWZkNDI1MC1lNmExLTQzNzgtOTFmYi1hMmE0ZGRkODdjNWUiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.ep3IG5UMcj__1HopMvUFb4xo9nI32gjSZwh03RVYoaim2ExbnEMIikZYIfXlh68pK0CGsTDpWMFgwTbyE98St8icBudSUAJ7fcG3ZJGb84sN9y5pZx7kMMWsBOdB37lSq2eX5SR6l1XgEUB3QxLM6uCgqXfD8yQ7r-ZSC1WitU1NoZ3zGnlrJ4e2aMv_CbLrohDHGwrC2jJJh5Zru_VzRYxTqfIfbMQu6To4QONfTJnbu47lmp8wtTkJIISRnNYAwTUPFWUjm-MHSLlOlOgU9eGKLm6VTM_WxZxFSX5mHs3gbOp_Ou_jDgVNbgzItCK6BCJSXoXfhVOCgNnH_g6F_w, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre/read, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642332167, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.144.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=05E5E47B5E990C4CC393C2D6846306C7, http-session-last-accessed-time=1642331870335, kc-category-name=ACCESS, kc-iat=1642331867, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:51094 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:17:50.344  INFO 16 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:17:50.344  INFO 16 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@74207ef
2022-01-16 11:17:50.345  INFO 16 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@74207ef
2022-01-16 11:17:50.355  INFO 16 --- [https-jsse-nio-7071-exec-7] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18910321445266180-99776, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:31aa3bfa-c095-4f10-a6c7-a9d759a8e54b:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=31aa3bfa-c095-4f10-a6c7-a9d759a8e54b, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time after Shift Start, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:17:50.356  INFO 16 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=077d5c67-ab03-4f96-81a9-c93cc8200687, content=DENY, timestamp=1642331870356, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:31aa3bfa-c095-4f10-a6c7-a9d759a8e54b:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=31aa3bfa-c095-4f10-a6c7-a9d759a8e54b, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time after Shift Start, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:17:50.357  INFO 16 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=12ms, Total=15ms
2022-01-16 11:17:50.374  INFO 16 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=986a76c0-a3a4-4655-bec3-b4afc3f6274e, content=null, timestamp=1642331870368, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=51096, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=22766fcc86b6, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=aafd4250-e6a1-4378-91fb-a2a4ddd87c5e, http-req-server-port=80, http-header-accept=*/*, kc-id=77b9495c-1692-426c-96be-094189073545, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642331870367, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQAB3NxAH4AEQAAAABh4/7bdAAkNzdiOTQ5NWMtMTY5Mi00MjZjLTk2YmUtMDk0MTg5MDczNTQ1dAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRhYWZkNDI1MC1lNmExLTQzNzgtOTFmYi1hMmE0ZGRkODdjNWVwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJhY3dRY1p6TGlENW1hRl85amJINGVRVFplOElvZDdldllhOUk2eDVXWjJnIn0.eyJleHAiOjE2NDIzMzIxNjcsImlhdCI6MTY0MjMzMTg2NywianRpIjoiNzdiOTQ5NWMtMTY5Mi00MjZjLTk2YmUtMDk0MTg5MDczNTQ1IiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiJhYWZkNDI1MC1lNmExLTQzNzgtOTFmYi1hMmE0ZGRkODdjNWUiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.ep3IG5UMcj__1HopMvUFb4xo9nI32gjSZwh03RVYoaim2ExbnEMIikZYIfXlh68pK0CGsTDpWMFgwTbyE98St8icBudSUAJ7fcG3ZJGb84sN9y5pZx7kMMWsBOdB37lSq2eX5SR6l1XgEUB3QxLM6uCgqXfD8yQ7r-ZSC1WitU1NoZ3zGnlrJ4e2aMv_CbLrohDHGwrC2jJJh5Zru_VzRYxTqfIfbMQu6To4QONfTJnbu47lmp8wtTkJIISRnNYAwTUPFWUjm-MHSLlOlOgU9eGKLm6VTM_WxZxFSX5mHs3gbOp_Ou_jDgVNbgzItCK6BCJSXoXfhVOCgNnH_g6F_w, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre/read, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642332167, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.144.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=67E8A4B4BF36A0162671295FFB92F575, http-session-last-accessed-time=1642331870367, kc-category-name=ACCESS, kc-iat=1642331867, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:51096 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:17:50.375  INFO 16 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:17:50.376  INFO 16 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@13bbb6ed
2022-01-16 11:17:50.376  INFO 16 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@13bbb6ed
2022-01-16 11:17:50.426  INFO 16 --- [https-jsse-nio-7071-exec-8] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18910321476417160-602030, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:31aa3bfa-c095-4f10-a6c7-a9d759a8e54b:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=31aa3bfa-c095-4f10-a6c7-a9d759a8e54b, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time after Shift Start, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:17:50.426  INFO 16 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=986a76c0-a3a4-4655-bec3-b4afc3f6274e, content=DENY, timestamp=1642331870426, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:31aa3bfa-c095-4f10-a6c7-a9d759a8e54b:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=31aa3bfa-c095-4f10-a6c7-a9d759a8e54b, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time after Shift Start, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:17:50.427  INFO 16 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=51ms, Total=54ms
2022-01-16 11:17:50.444  INFO 16 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=69d716e9-2c20-4cf3-9c23-86ef2fb719ad, content=null, timestamp=1642331870439, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=51098, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=22766fcc86b6, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=aafd4250-e6a1-4378-91fb-a2a4ddd87c5e, http-req-server-port=80, http-header-accept=*/*, kc-id=77b9495c-1692-426c-96be-094189073545, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642331870438, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQAB3NxAH4AEQAAAABh4/7bdAAkNzdiOTQ5NWMtMTY5Mi00MjZjLTk2YmUtMDk0MTg5MDczNTQ1dAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRhYWZkNDI1MC1lNmExLTQzNzgtOTFmYi1hMmE0ZGRkODdjNWVwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJhY3dRY1p6TGlENW1hRl85amJINGVRVFplOElvZDdldllhOUk2eDVXWjJnIn0.eyJleHAiOjE2NDIzMzIxNjcsImlhdCI6MTY0MjMzMTg2NywianRpIjoiNzdiOTQ5NWMtMTY5Mi00MjZjLTk2YmUtMDk0MTg5MDczNTQ1IiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiJhYWZkNDI1MC1lNmExLTQzNzgtOTFmYi1hMmE0ZGRkODdjNWUiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.ep3IG5UMcj__1HopMvUFb4xo9nI32gjSZwh03RVYoaim2ExbnEMIikZYIfXlh68pK0CGsTDpWMFgwTbyE98St8icBudSUAJ7fcG3ZJGb84sN9y5pZx7kMMWsBOdB37lSq2eX5SR6l1XgEUB3QxLM6uCgqXfD8yQ7r-ZSC1WitU1NoZ3zGnlrJ4e2aMv_CbLrohDHGwrC2jJJh5Zru_VzRYxTqfIfbMQu6To4QONfTJnbu47lmp8wtTkJIISRnNYAwTUPFWUjm-MHSLlOlOgU9eGKLm6VTM_WxZxFSX5mHs3gbOp_Ou_jDgVNbgzItCK6BCJSXoXfhVOCgNnH_g6F_w, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre/read, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642332167, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.144.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=69C4B11294950A085D2D37B468572B80, http-session-last-accessed-time=1642331870438, kc-category-name=ACCESS, kc-iat=1642331867, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:51098 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:17:50.445  INFO 16 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:17:50.446  INFO 16 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@8d01f6d
2022-01-16 11:17:50.446  INFO 16 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@8d01f6d
2022-01-16 11:17:50.457  INFO 16 --- [https-jsse-nio-7071-exec-9] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18910321546780016-756566, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:31aa3bfa-c095-4f10-a6c7-a9d759a8e54b:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=31aa3bfa-c095-4f10-a6c7-a9d759a8e54b, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time after Shift Start, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:17:50.457  INFO 16 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=69d716e9-2c20-4cf3-9c23-86ef2fb719ad, content=DENY, timestamp=1642331870457, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:31aa3bfa-c095-4f10-a6c7-a9d759a8e54b:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=31aa3bfa-c095-4f10-a6c7-a9d759a8e54b, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time after Shift Start, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:17:50.458  INFO 16 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=12ms, Total=15ms
2022-01-16 11:17:50.476  INFO 16 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=47086f6d-ceee-48af-a106-0b0d7d2271f3, content=null, timestamp=1642331870470, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=51100, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=22766fcc86b6, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=aafd4250-e6a1-4378-91fb-a2a4ddd87c5e, http-req-server-port=80, http-header-accept=*/*, kc-id=77b9495c-1692-426c-96be-094189073545, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642331870469, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQAB3NxAH4AEQAAAABh4/7bdAAkNzdiOTQ5NWMtMTY5Mi00MjZjLTk2YmUtMDk0MTg5MDczNTQ1dAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRhYWZkNDI1MC1lNmExLTQzNzgtOTFmYi1hMmE0ZGRkODdjNWVwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJhY3dRY1p6TGlENW1hRl85amJINGVRVFplOElvZDdldllhOUk2eDVXWjJnIn0.eyJleHAiOjE2NDIzMzIxNjcsImlhdCI6MTY0MjMzMTg2NywianRpIjoiNzdiOTQ5NWMtMTY5Mi00MjZjLTk2YmUtMDk0MTg5MDczNTQ1IiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiJhYWZkNDI1MC1lNmExLTQzNzgtOTFmYi1hMmE0ZGRkODdjNWUiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.ep3IG5UMcj__1HopMvUFb4xo9nI32gjSZwh03RVYoaim2ExbnEMIikZYIfXlh68pK0CGsTDpWMFgwTbyE98St8icBudSUAJ7fcG3ZJGb84sN9y5pZx7kMMWsBOdB37lSq2eX5SR6l1XgEUB3QxLM6uCgqXfD8yQ7r-ZSC1WitU1NoZ3zGnlrJ4e2aMv_CbLrohDHGwrC2jJJh5Zru_VzRYxTqfIfbMQu6To4QONfTJnbu47lmp8wtTkJIISRnNYAwTUPFWUjm-MHSLlOlOgU9eGKLm6VTM_WxZxFSX5mHs3gbOp_Ou_jDgVNbgzItCK6BCJSXoXfhVOCgNnH_g6F_w, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre/read, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642332167, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.144.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=98C50AFF39E9B0D29002BAB3D7BAB1FC, http-session-last-accessed-time=1642331870469, kc-category-name=ACCESS, kc-iat=1642331867, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:51100 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:17:50.476  INFO 16 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:17:50.477  INFO 16 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2dedfe53
2022-01-16 11:17:50.478  INFO 16 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2dedfe53
2022-01-16 11:17:50.489  INFO 16 --- [https-jsse-nio-7071-exec-10] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18910321578079320-999366, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:31aa3bfa-c095-4f10-a6c7-a9d759a8e54b:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=31aa3bfa-c095-4f10-a6c7-a9d759a8e54b, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time after Shift Start, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:17:50.490  INFO 16 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=47086f6d-ceee-48af-a106-0b0d7d2271f3, content=DENY, timestamp=1642331870490, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:31aa3bfa-c095-4f10-a6c7-a9d759a8e54b:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=31aa3bfa-c095-4f10-a6c7-a9d759a8e54b, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time after Shift Start, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:17:50.490  INFO 16 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=13ms, Total=16ms
2022-01-16 11:17:50.508  INFO 16 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=d5318de3-69f9-47c4-8155-9a04d64f25ec, content=null, timestamp=1642331870502, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=51102, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=22766fcc86b6, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=aafd4250-e6a1-4378-91fb-a2a4ddd87c5e, http-req-server-port=80, http-header-accept=*/*, kc-id=77b9495c-1692-426c-96be-094189073545, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642331870500, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQAB3NxAH4AEQAAAABh4/7bdAAkNzdiOTQ5NWMtMTY5Mi00MjZjLTk2YmUtMDk0MTg5MDczNTQ1dAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRhYWZkNDI1MC1lNmExLTQzNzgtOTFmYi1hMmE0ZGRkODdjNWVwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJhY3dRY1p6TGlENW1hRl85amJINGVRVFplOElvZDdldllhOUk2eDVXWjJnIn0.eyJleHAiOjE2NDIzMzIxNjcsImlhdCI6MTY0MjMzMTg2NywianRpIjoiNzdiOTQ5NWMtMTY5Mi00MjZjLTk2YmUtMDk0MTg5MDczNTQ1IiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiJhYWZkNDI1MC1lNmExLTQzNzgtOTFmYi1hMmE0ZGRkODdjNWUiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.ep3IG5UMcj__1HopMvUFb4xo9nI32gjSZwh03RVYoaim2ExbnEMIikZYIfXlh68pK0CGsTDpWMFgwTbyE98St8icBudSUAJ7fcG3ZJGb84sN9y5pZx7kMMWsBOdB37lSq2eX5SR6l1XgEUB3QxLM6uCgqXfD8yQ7r-ZSC1WitU1NoZ3zGnlrJ4e2aMv_CbLrohDHGwrC2jJJh5Zru_VzRYxTqfIfbMQu6To4QONfTJnbu47lmp8wtTkJIISRnNYAwTUPFWUjm-MHSLlOlOgU9eGKLm6VTM_WxZxFSX5mHs3gbOp_Ou_jDgVNbgzItCK6BCJSXoXfhVOCgNnH_g6F_w, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre/read, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642332167, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.144.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=0647C2F7DD37BC4A436A87DAC5BBDB5D, http-session-last-accessed-time=1642331870500, kc-category-name=ACCESS, kc-iat=1642331867, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:51102 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:17:50.509  INFO 16 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:17:50.510  INFO 16 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@f5086f0
2022-01-16 11:17:50.510  INFO 16 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@f5086f0
2022-01-16 11:17:50.562  INFO 16 --- [https-jsse-nio-7071-exec-1] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18910321610550083-59619, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:31aa3bfa-c095-4f10-a6c7-a9d759a8e54b:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=31aa3bfa-c095-4f10-a6c7-a9d759a8e54b, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time after Shift Start, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:17:50.563  INFO 16 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=d5318de3-69f9-47c4-8155-9a04d64f25ec, content=DENY, timestamp=1642331870563, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:31aa3bfa-c095-4f10-a6c7-a9d759a8e54b:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=31aa3bfa-c095-4f10-a6c7-a9d759a8e54b, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time after Shift Start, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:17:50.564  INFO 16 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=54ms, Total=57ms
2022-01-16 11:17:50.585  INFO 16 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=ab5a897d-58dc-4423-b235-9f3dc235fadd, content=null, timestamp=1642331870575, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=51104, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=22766fcc86b6, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=aafd4250-e6a1-4378-91fb-a2a4ddd87c5e, http-req-server-port=80, http-header-accept=*/*, kc-id=77b9495c-1692-426c-96be-094189073545, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642331870574, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQAB3NxAH4AEQAAAABh4/7bdAAkNzdiOTQ5NWMtMTY5Mi00MjZjLTk2YmUtMDk0MTg5MDczNTQ1dAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRhYWZkNDI1MC1lNmExLTQzNzgtOTFmYi1hMmE0ZGRkODdjNWVwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJhY3dRY1p6TGlENW1hRl85amJINGVRVFplOElvZDdldllhOUk2eDVXWjJnIn0.eyJleHAiOjE2NDIzMzIxNjcsImlhdCI6MTY0MjMzMTg2NywianRpIjoiNzdiOTQ5NWMtMTY5Mi00MjZjLTk2YmUtMDk0MTg5MDczNTQ1IiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiJhYWZkNDI1MC1lNmExLTQzNzgtOTFmYi1hMmE0ZGRkODdjNWUiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.ep3IG5UMcj__1HopMvUFb4xo9nI32gjSZwh03RVYoaim2ExbnEMIikZYIfXlh68pK0CGsTDpWMFgwTbyE98St8icBudSUAJ7fcG3ZJGb84sN9y5pZx7kMMWsBOdB37lSq2eX5SR6l1XgEUB3QxLM6uCgqXfD8yQ7r-ZSC1WitU1NoZ3zGnlrJ4e2aMv_CbLrohDHGwrC2jJJh5Zru_VzRYxTqfIfbMQu6To4QONfTJnbu47lmp8wtTkJIISRnNYAwTUPFWUjm-MHSLlOlOgU9eGKLm6VTM_WxZxFSX5mHs3gbOp_Ou_jDgVNbgzItCK6BCJSXoXfhVOCgNnH_g6F_w, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre/read, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642332167, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.144.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=D504A381A9F67EE1B69567452A384483, http-session-last-accessed-time=1642331870574, kc-category-name=ACCESS, kc-iat=1642331867, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:51104 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:17:50.586  INFO 16 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:17:50.587  INFO 16 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@deb7c95
2022-01-16 11:17:50.587  INFO 16 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@deb7c95
2022-01-16 11:17:50.600  INFO 16 --- [https-jsse-nio-7071-exec-2] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18910321687712567-64558, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:31aa3bfa-c095-4f10-a6c7-a9d759a8e54b:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=31aa3bfa-c095-4f10-a6c7-a9d759a8e54b, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time after Shift Start, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:17:50.601  INFO 16 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=ab5a897d-58dc-4423-b235-9f3dc235fadd, content=DENY, timestamp=1642331870601, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:31aa3bfa-c095-4f10-a6c7-a9d759a8e54b:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=31aa3bfa-c095-4f10-a6c7-a9d759a8e54b, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time after Shift Start, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:17:50.602  INFO 16 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=15ms, Total=18ms
2022-01-16 11:17:50.625  INFO 16 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=4cbb9f25-5add-44d1-bd92-2d0955746983, content=null, timestamp=1642331870615, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=51106, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=22766fcc86b6, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=aafd4250-e6a1-4378-91fb-a2a4ddd87c5e, http-req-server-port=80, http-header-accept=*/*, kc-id=77b9495c-1692-426c-96be-094189073545, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642331870614, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQAB3NxAH4AEQAAAABh4/7bdAAkNzdiOTQ5NWMtMTY5Mi00MjZjLTk2YmUtMDk0MTg5MDczNTQ1dAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRhYWZkNDI1MC1lNmExLTQzNzgtOTFmYi1hMmE0ZGRkODdjNWVwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJhY3dRY1p6TGlENW1hRl85amJINGVRVFplOElvZDdldllhOUk2eDVXWjJnIn0.eyJleHAiOjE2NDIzMzIxNjcsImlhdCI6MTY0MjMzMTg2NywianRpIjoiNzdiOTQ5NWMtMTY5Mi00MjZjLTk2YmUtMDk0MTg5MDczNTQ1IiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiJhYWZkNDI1MC1lNmExLTQzNzgtOTFmYi1hMmE0ZGRkODdjNWUiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.ep3IG5UMcj__1HopMvUFb4xo9nI32gjSZwh03RVYoaim2ExbnEMIikZYIfXlh68pK0CGsTDpWMFgwTbyE98St8icBudSUAJ7fcG3ZJGb84sN9y5pZx7kMMWsBOdB37lSq2eX5SR6l1XgEUB3QxLM6uCgqXfD8yQ7r-ZSC1WitU1NoZ3zGnlrJ4e2aMv_CbLrohDHGwrC2jJJh5Zru_VzRYxTqfIfbMQu6To4QONfTJnbu47lmp8wtTkJIISRnNYAwTUPFWUjm-MHSLlOlOgU9eGKLm6VTM_WxZxFSX5mHs3gbOp_Ou_jDgVNbgzItCK6BCJSXoXfhVOCgNnH_g6F_w, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre/read, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642332167, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.144.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=FD44172299A0C5E664AB0AEADD77C6C1, http-session-last-accessed-time=1642331870614, kc-category-name=ACCESS, kc-iat=1642331867, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:51106 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:17:50.626  INFO 16 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:17:50.627  INFO 16 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@260a97
2022-01-16 11:17:50.627  INFO 16 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@260a97
2022-01-16 11:17:50.640  INFO 16 --- [https-jsse-nio-7071-exec-3] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18910321727454004-656782, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:31aa3bfa-c095-4f10-a6c7-a9d759a8e54b:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=31aa3bfa-c095-4f10-a6c7-a9d759a8e54b, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time after Shift Start, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:17:50.642  INFO 16 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=4cbb9f25-5add-44d1-bd92-2d0955746983, content=DENY, timestamp=1642331870642, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:31aa3bfa-c095-4f10-a6c7-a9d759a8e54b:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=31aa3bfa-c095-4f10-a6c7-a9d759a8e54b, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time after Shift Start, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:17:50.644  INFO 16 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=16ms, Total=22ms
2022-01-16 11:17:50.664  INFO 16 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=ccc8810e-3aa5-4c21-b117-62743464d5bd, content=null, timestamp=1642331870655, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=51108, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=22766fcc86b6, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=aafd4250-e6a1-4378-91fb-a2a4ddd87c5e, http-req-server-port=80, http-header-accept=*/*, kc-id=77b9495c-1692-426c-96be-094189073545, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642331870654, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQAB3NxAH4AEQAAAABh4/7bdAAkNzdiOTQ5NWMtMTY5Mi00MjZjLTk2YmUtMDk0MTg5MDczNTQ1dAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRhYWZkNDI1MC1lNmExLTQzNzgtOTFmYi1hMmE0ZGRkODdjNWVwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJhY3dRY1p6TGlENW1hRl85amJINGVRVFplOElvZDdldllhOUk2eDVXWjJnIn0.eyJleHAiOjE2NDIzMzIxNjcsImlhdCI6MTY0MjMzMTg2NywianRpIjoiNzdiOTQ5NWMtMTY5Mi00MjZjLTk2YmUtMDk0MTg5MDczNTQ1IiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiJhYWZkNDI1MC1lNmExLTQzNzgtOTFmYi1hMmE0ZGRkODdjNWUiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.ep3IG5UMcj__1HopMvUFb4xo9nI32gjSZwh03RVYoaim2ExbnEMIikZYIfXlh68pK0CGsTDpWMFgwTbyE98St8icBudSUAJ7fcG3ZJGb84sN9y5pZx7kMMWsBOdB37lSq2eX5SR6l1XgEUB3QxLM6uCgqXfD8yQ7r-ZSC1WitU1NoZ3zGnlrJ4e2aMv_CbLrohDHGwrC2jJJh5Zru_VzRYxTqfIfbMQu6To4QONfTJnbu47lmp8wtTkJIISRnNYAwTUPFWUjm-MHSLlOlOgU9eGKLm6VTM_WxZxFSX5mHs3gbOp_Ou_jDgVNbgzItCK6BCJSXoXfhVOCgNnH_g6F_w, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre/read, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642332167, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.144.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=E5615A2AA02BBF625F8D2A5B0ADA54C4, http-session-last-accessed-time=1642331870654, kc-category-name=ACCESS, kc-iat=1642331867, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:51108 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:17:50.664  INFO 16 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:17:50.666  INFO 16 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6c657460
2022-01-16 11:17:50.667  INFO 16 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6c657460
2022-01-16 11:17:50.719  INFO 16 --- [https-jsse-nio-7071-exec-4] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18910321766754744-530090, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:31aa3bfa-c095-4f10-a6c7-a9d759a8e54b:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=31aa3bfa-c095-4f10-a6c7-a9d759a8e54b, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time after Shift Start, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:17:50.720  INFO 16 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=ccc8810e-3aa5-4c21-b117-62743464d5bd, content=DENY, timestamp=1642331870720, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:31aa3bfa-c095-4f10-a6c7-a9d759a8e54b:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=31aa3bfa-c095-4f10-a6c7-a9d759a8e54b, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time after Shift Start, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:17:50.721  INFO 16 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=55ms, Total=58ms
2022-01-16 11:17:50.744  INFO 16 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=1cd4d527-47cd-4e1f-ac9c-e05ff843b6c8, content=null, timestamp=1642331870735, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=51110, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=22766fcc86b6, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=aafd4250-e6a1-4378-91fb-a2a4ddd87c5e, http-req-server-port=80, http-header-accept=*/*, kc-id=77b9495c-1692-426c-96be-094189073545, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642331870734, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQAB3NxAH4AEQAAAABh4/7bdAAkNzdiOTQ5NWMtMTY5Mi00MjZjLTk2YmUtMDk0MTg5MDczNTQ1dAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRhYWZkNDI1MC1lNmExLTQzNzgtOTFmYi1hMmE0ZGRkODdjNWVwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJhY3dRY1p6TGlENW1hRl85amJINGVRVFplOElvZDdldllhOUk2eDVXWjJnIn0.eyJleHAiOjE2NDIzMzIxNjcsImlhdCI6MTY0MjMzMTg2NywianRpIjoiNzdiOTQ5NWMtMTY5Mi00MjZjLTk2YmUtMDk0MTg5MDczNTQ1IiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiJhYWZkNDI1MC1lNmExLTQzNzgtOTFmYi1hMmE0ZGRkODdjNWUiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.ep3IG5UMcj__1HopMvUFb4xo9nI32gjSZwh03RVYoaim2ExbnEMIikZYIfXlh68pK0CGsTDpWMFgwTbyE98St8icBudSUAJ7fcG3ZJGb84sN9y5pZx7kMMWsBOdB37lSq2eX5SR6l1XgEUB3QxLM6uCgqXfD8yQ7r-ZSC1WitU1NoZ3zGnlrJ4e2aMv_CbLrohDHGwrC2jJJh5Zru_VzRYxTqfIfbMQu6To4QONfTJnbu47lmp8wtTkJIISRnNYAwTUPFWUjm-MHSLlOlOgU9eGKLm6VTM_WxZxFSX5mHs3gbOp_Ou_jDgVNbgzItCK6BCJSXoXfhVOCgNnH_g6F_w, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre/read, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642332167, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.144.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=464D9A06E6275FB63DA563B2D352646D, http-session-last-accessed-time=1642331870734, kc-category-name=ACCESS, kc-iat=1642331867, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:51110 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:17:50.745  INFO 16 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:17:50.746  INFO 16 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2aecaba9
2022-01-16 11:17:50.747  INFO 16 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2aecaba9
2022-01-16 11:17:50.759  INFO 16 --- [https-jsse-nio-7071-exec-4] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18910321846889222-48244, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:31aa3bfa-c095-4f10-a6c7-a9d759a8e54b:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=31aa3bfa-c095-4f10-a6c7-a9d759a8e54b, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time after Shift Start, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:17:50.759  INFO 16 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=1cd4d527-47cd-4e1f-ac9c-e05ff843b6c8, content=DENY, timestamp=1642331870759, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:31aa3bfa-c095-4f10-a6c7-a9d759a8e54b:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=31aa3bfa-c095-4f10-a6c7-a9d759a8e54b, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time after Shift Start, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:17:50.760  INFO 16 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=14ms, Total=17ms
2022-01-16 11:17:50.777  INFO 16 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=005f6be5-22bc-4660-879f-d2e5c7f1227b, content=null, timestamp=1642331870771, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=51112, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=22766fcc86b6, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=aafd4250-e6a1-4378-91fb-a2a4ddd87c5e, http-req-server-port=80, http-header-accept=*/*, kc-id=77b9495c-1692-426c-96be-094189073545, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642331870769, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQAB3NxAH4AEQAAAABh4/7bdAAkNzdiOTQ5NWMtMTY5Mi00MjZjLTk2YmUtMDk0MTg5MDczNTQ1dAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRhYWZkNDI1MC1lNmExLTQzNzgtOTFmYi1hMmE0ZGRkODdjNWVwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJhY3dRY1p6TGlENW1hRl85amJINGVRVFplOElvZDdldllhOUk2eDVXWjJnIn0.eyJleHAiOjE2NDIzMzIxNjcsImlhdCI6MTY0MjMzMTg2NywianRpIjoiNzdiOTQ5NWMtMTY5Mi00MjZjLTk2YmUtMDk0MTg5MDczNTQ1IiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiJhYWZkNDI1MC1lNmExLTQzNzgtOTFmYi1hMmE0ZGRkODdjNWUiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.ep3IG5UMcj__1HopMvUFb4xo9nI32gjSZwh03RVYoaim2ExbnEMIikZYIfXlh68pK0CGsTDpWMFgwTbyE98St8icBudSUAJ7fcG3ZJGb84sN9y5pZx7kMMWsBOdB37lSq2eX5SR6l1XgEUB3QxLM6uCgqXfD8yQ7r-ZSC1WitU1NoZ3zGnlrJ4e2aMv_CbLrohDHGwrC2jJJh5Zru_VzRYxTqfIfbMQu6To4QONfTJnbu47lmp8wtTkJIISRnNYAwTUPFWUjm-MHSLlOlOgU9eGKLm6VTM_WxZxFSX5mHs3gbOp_Ou_jDgVNbgzItCK6BCJSXoXfhVOCgNnH_g6F_w, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre/read, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642332167, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.144.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=74802A637E3C5741436E71906C36297F, http-session-last-accessed-time=1642331870769, kc-category-name=ACCESS, kc-iat=1642331867, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:51112 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:17:50.778  INFO 16 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:17:50.783  INFO 16 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@41091eed
2022-01-16 11:17:50.784  INFO 16 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@41091eed
2022-01-16 11:17:50.795  INFO 16 --- [https-jsse-nio-7071-exec-5] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18910321884390080-493330, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:31aa3bfa-c095-4f10-a6c7-a9d759a8e54b:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=31aa3bfa-c095-4f10-a6c7-a9d759a8e54b, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time after Shift Start, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:17:50.796  INFO 16 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=005f6be5-22bc-4660-879f-d2e5c7f1227b, content=DENY, timestamp=1642331870796, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:31aa3bfa-c095-4f10-a6c7-a9d759a8e54b:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=31aa3bfa-c095-4f10-a6c7-a9d759a8e54b, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time after Shift Start, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:17:50.796  INFO 16 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=13ms, Total=20ms
2022-01-16 11:17:50.814  INFO 16 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=e34e0ce5-a4e7-4842-a4a2-e345d3bdffb5, content=null, timestamp=1642331870808, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=51114, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=22766fcc86b6, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=aafd4250-e6a1-4378-91fb-a2a4ddd87c5e, http-req-server-port=80, http-header-accept=*/*, kc-id=77b9495c-1692-426c-96be-094189073545, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642331870807, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQAB3NxAH4AEQAAAABh4/7bdAAkNzdiOTQ5NWMtMTY5Mi00MjZjLTk2YmUtMDk0MTg5MDczNTQ1dAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRhYWZkNDI1MC1lNmExLTQzNzgtOTFmYi1hMmE0ZGRkODdjNWVwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJhY3dRY1p6TGlENW1hRl85amJINGVRVFplOElvZDdldllhOUk2eDVXWjJnIn0.eyJleHAiOjE2NDIzMzIxNjcsImlhdCI6MTY0MjMzMTg2NywianRpIjoiNzdiOTQ5NWMtMTY5Mi00MjZjLTk2YmUtMDk0MTg5MDczNTQ1IiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiJhYWZkNDI1MC1lNmExLTQzNzgtOTFmYi1hMmE0ZGRkODdjNWUiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.ep3IG5UMcj__1HopMvUFb4xo9nI32gjSZwh03RVYoaim2ExbnEMIikZYIfXlh68pK0CGsTDpWMFgwTbyE98St8icBudSUAJ7fcG3ZJGb84sN9y5pZx7kMMWsBOdB37lSq2eX5SR6l1XgEUB3QxLM6uCgqXfD8yQ7r-ZSC1WitU1NoZ3zGnlrJ4e2aMv_CbLrohDHGwrC2jJJh5Zru_VzRYxTqfIfbMQu6To4QONfTJnbu47lmp8wtTkJIISRnNYAwTUPFWUjm-MHSLlOlOgU9eGKLm6VTM_WxZxFSX5mHs3gbOp_Ou_jDgVNbgzItCK6BCJSXoXfhVOCgNnH_g6F_w, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre/read, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642332167, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.144.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=E62C68074440B8956F203101E12D8B2C, http-session-last-accessed-time=1642331870807, kc-category-name=ACCESS, kc-iat=1642331867, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:51114 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:17:50.815  INFO 16 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:17:50.816  INFO 16 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@17bb1726
2022-01-16 11:17:50.816  INFO 16 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@17bb1726
2022-01-16 11:17:50.874  INFO 16 --- [https-jsse-nio-7071-exec-6] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18910321916342352-356148, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:31aa3bfa-c095-4f10-a6c7-a9d759a8e54b:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=31aa3bfa-c095-4f10-a6c7-a9d759a8e54b, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time after Shift Start, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:17:50.874  INFO 16 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=e34e0ce5-a4e7-4842-a4a2-e345d3bdffb5, content=DENY, timestamp=1642331870874, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:31aa3bfa-c095-4f10-a6c7-a9d759a8e54b:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=31aa3bfa-c095-4f10-a6c7-a9d759a8e54b, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time after Shift Start, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:17:50.875  INFO 16 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=59ms, Total=62ms
2022-01-16 11:17:50.891  INFO 16 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=a1034483-cfd9-4eca-9c7d-4f14f6c606f3, content=null, timestamp=1642331870886, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=51116, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=22766fcc86b6, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=aafd4250-e6a1-4378-91fb-a2a4ddd87c5e, http-req-server-port=80, http-header-accept=*/*, kc-id=77b9495c-1692-426c-96be-094189073545, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642331870884, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQAB3NxAH4AEQAAAABh4/7bdAAkNzdiOTQ5NWMtMTY5Mi00MjZjLTk2YmUtMDk0MTg5MDczNTQ1dAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRhYWZkNDI1MC1lNmExLTQzNzgtOTFmYi1hMmE0ZGRkODdjNWVwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJhY3dRY1p6TGlENW1hRl85amJINGVRVFplOElvZDdldllhOUk2eDVXWjJnIn0.eyJleHAiOjE2NDIzMzIxNjcsImlhdCI6MTY0MjMzMTg2NywianRpIjoiNzdiOTQ5NWMtMTY5Mi00MjZjLTk2YmUtMDk0MTg5MDczNTQ1IiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiJhYWZkNDI1MC1lNmExLTQzNzgtOTFmYi1hMmE0ZGRkODdjNWUiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.ep3IG5UMcj__1HopMvUFb4xo9nI32gjSZwh03RVYoaim2ExbnEMIikZYIfXlh68pK0CGsTDpWMFgwTbyE98St8icBudSUAJ7fcG3ZJGb84sN9y5pZx7kMMWsBOdB37lSq2eX5SR6l1XgEUB3QxLM6uCgqXfD8yQ7r-ZSC1WitU1NoZ3zGnlrJ4e2aMv_CbLrohDHGwrC2jJJh5Zru_VzRYxTqfIfbMQu6To4QONfTJnbu47lmp8wtTkJIISRnNYAwTUPFWUjm-MHSLlOlOgU9eGKLm6VTM_WxZxFSX5mHs3gbOp_Ou_jDgVNbgzItCK6BCJSXoXfhVOCgNnH_g6F_w, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre/read, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642332167, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.144.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=5B0BDBF7937ACC969E1A292978FCEBE1, http-session-last-accessed-time=1642331870884, kc-category-name=ACCESS, kc-iat=1642331867, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:51116 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:17:50.891  INFO 16 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:17:50.893  INFO 16 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1204917
2022-01-16 11:17:50.893  INFO 16 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1204917
2022-01-16 11:17:50.904  INFO 16 --- [https-jsse-nio-7071-exec-7] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18910321992936540-70393, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:31aa3bfa-c095-4f10-a6c7-a9d759a8e54b:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=31aa3bfa-c095-4f10-a6c7-a9d759a8e54b, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time after Shift Start, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:17:50.904  INFO 16 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=a1034483-cfd9-4eca-9c7d-4f14f6c606f3, content=DENY, timestamp=1642331870904, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:31aa3bfa-c095-4f10-a6c7-a9d759a8e54b:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=31aa3bfa-c095-4f10-a6c7-a9d759a8e54b, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time after Shift Start, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:17:50.905  INFO 16 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=13ms, Total=15ms
2022-01-16 11:17:50.932  INFO 16 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=f775a6ea-ad4a-4a1a-b57b-54dcb03d937f, content=null, timestamp=1642331870916, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=51118, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=22766fcc86b6, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=aafd4250-e6a1-4378-91fb-a2a4ddd87c5e, http-req-server-port=80, http-header-accept=*/*, kc-id=77b9495c-1692-426c-96be-094189073545, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642331870915, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQAB3NxAH4AEQAAAABh4/7bdAAkNzdiOTQ5NWMtMTY5Mi00MjZjLTk2YmUtMDk0MTg5MDczNTQ1dAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRhYWZkNDI1MC1lNmExLTQzNzgtOTFmYi1hMmE0ZGRkODdjNWVwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJhY3dRY1p6TGlENW1hRl85amJINGVRVFplOElvZDdldllhOUk2eDVXWjJnIn0.eyJleHAiOjE2NDIzMzIxNjcsImlhdCI6MTY0MjMzMTg2NywianRpIjoiNzdiOTQ5NWMtMTY5Mi00MjZjLTk2YmUtMDk0MTg5MDczNTQ1IiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiJhYWZkNDI1MC1lNmExLTQzNzgtOTFmYi1hMmE0ZGRkODdjNWUiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.ep3IG5UMcj__1HopMvUFb4xo9nI32gjSZwh03RVYoaim2ExbnEMIikZYIfXlh68pK0CGsTDpWMFgwTbyE98St8icBudSUAJ7fcG3ZJGb84sN9y5pZx7kMMWsBOdB37lSq2eX5SR6l1XgEUB3QxLM6uCgqXfD8yQ7r-ZSC1WitU1NoZ3zGnlrJ4e2aMv_CbLrohDHGwrC2jJJh5Zru_VzRYxTqfIfbMQu6To4QONfTJnbu47lmp8wtTkJIISRnNYAwTUPFWUjm-MHSLlOlOgU9eGKLm6VTM_WxZxFSX5mHs3gbOp_Ou_jDgVNbgzItCK6BCJSXoXfhVOCgNnH_g6F_w, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre/read, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642332167, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.144.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=C8C8B849608B21B1EA55A192762AF550, http-session-last-accessed-time=1642331870915, kc-category-name=ACCESS, kc-iat=1642331867, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:51118 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:17:50.932  INFO 16 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:17:50.934  INFO 16 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4ebff4e6
2022-01-16 11:17:50.935  INFO 16 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4ebff4e6
2022-01-16 11:17:50.962  INFO 16 --- [https-jsse-nio-7071-exec-8] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18910322034378573-399399, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:31aa3bfa-c095-4f10-a6c7-a9d759a8e54b:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=31aa3bfa-c095-4f10-a6c7-a9d759a8e54b, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time after Shift Start, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:17:50.964  INFO 16 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=f775a6ea-ad4a-4a1a-b57b-54dcb03d937f, content=DENY, timestamp=1642331870964, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:31aa3bfa-c095-4f10-a6c7-a9d759a8e54b:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=31aa3bfa-c095-4f10-a6c7-a9d759a8e54b, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time after Shift Start, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:17:50.967  INFO 16 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=31ms, Total=37ms
2022-01-16 11:17:50.996  INFO 16 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=fc0e6e44-d587-457f-b825-45fbebdf6587, content=null, timestamp=1642331870983, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=51120, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=22766fcc86b6, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=aafd4250-e6a1-4378-91fb-a2a4ddd87c5e, http-req-server-port=80, http-header-accept=*/*, kc-id=77b9495c-1692-426c-96be-094189073545, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642331870981, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQAB3NxAH4AEQAAAABh4/7bdAAkNzdiOTQ5NWMtMTY5Mi00MjZjLTk2YmUtMDk0MTg5MDczNTQ1dAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRhYWZkNDI1MC1lNmExLTQzNzgtOTFmYi1hMmE0ZGRkODdjNWVwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJhY3dRY1p6TGlENW1hRl85amJINGVRVFplOElvZDdldllhOUk2eDVXWjJnIn0.eyJleHAiOjE2NDIzMzIxNjcsImlhdCI6MTY0MjMzMTg2NywianRpIjoiNzdiOTQ5NWMtMTY5Mi00MjZjLTk2YmUtMDk0MTg5MDczNTQ1IiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiJhYWZkNDI1MC1lNmExLTQzNzgtOTFmYi1hMmE0ZGRkODdjNWUiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.ep3IG5UMcj__1HopMvUFb4xo9nI32gjSZwh03RVYoaim2ExbnEMIikZYIfXlh68pK0CGsTDpWMFgwTbyE98St8icBudSUAJ7fcG3ZJGb84sN9y5pZx7kMMWsBOdB37lSq2eX5SR6l1XgEUB3QxLM6uCgqXfD8yQ7r-ZSC1WitU1NoZ3zGnlrJ4e2aMv_CbLrohDHGwrC2jJJh5Zru_VzRYxTqfIfbMQu6To4QONfTJnbu47lmp8wtTkJIISRnNYAwTUPFWUjm-MHSLlOlOgU9eGKLm6VTM_WxZxFSX5mHs3gbOp_Ou_jDgVNbgzItCK6BCJSXoXfhVOCgNnH_g6F_w, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre/read, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642332167, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.144.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=77FB88E380F6BFD18B60EF2DE2027AE5, http-session-last-accessed-time=1642331870981, kc-category-name=ACCESS, kc-iat=1642331867, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:51120 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:17:50.997  INFO 16 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:17:51.001  INFO 16 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@24744257
2022-01-16 11:17:51.007  INFO 16 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@24744257
2022-01-16 11:17:51.023  INFO 16 --- [https-jsse-nio-7071-exec-9] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18910322098962442-533835, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:31aa3bfa-c095-4f10-a6c7-a9d759a8e54b:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=31aa3bfa-c095-4f10-a6c7-a9d759a8e54b, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time after Shift Start, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:17:51.024  INFO 16 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=fc0e6e44-d587-457f-b825-45fbebdf6587, content=DENY, timestamp=1642331871024, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:31aa3bfa-c095-4f10-a6c7-a9d759a8e54b:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=31aa3bfa-c095-4f10-a6c7-a9d759a8e54b, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time after Shift Start, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:17:51.025  INFO 16 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=27ms, Total=30ms
2022-01-16 11:17:51.044  INFO 16 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=84e2e79d-1601-44cf-8229-c0185c3305c3, content=null, timestamp=1642331871036, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=51122, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=22766fcc86b6, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=aafd4250-e6a1-4378-91fb-a2a4ddd87c5e, http-req-server-port=80, http-header-accept=*/*, kc-id=77b9495c-1692-426c-96be-094189073545, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642331871035, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQAB3NxAH4AEQAAAABh4/7bdAAkNzdiOTQ5NWMtMTY5Mi00MjZjLTk2YmUtMDk0MTg5MDczNTQ1dAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRhYWZkNDI1MC1lNmExLTQzNzgtOTFmYi1hMmE0ZGRkODdjNWVwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJhY3dRY1p6TGlENW1hRl85amJINGVRVFplOElvZDdldllhOUk2eDVXWjJnIn0.eyJleHAiOjE2NDIzMzIxNjcsImlhdCI6MTY0MjMzMTg2NywianRpIjoiNzdiOTQ5NWMtMTY5Mi00MjZjLTk2YmUtMDk0MTg5MDczNTQ1IiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiJhYWZkNDI1MC1lNmExLTQzNzgtOTFmYi1hMmE0ZGRkODdjNWUiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.ep3IG5UMcj__1HopMvUFb4xo9nI32gjSZwh03RVYoaim2ExbnEMIikZYIfXlh68pK0CGsTDpWMFgwTbyE98St8icBudSUAJ7fcG3ZJGb84sN9y5pZx7kMMWsBOdB37lSq2eX5SR6l1XgEUB3QxLM6uCgqXfD8yQ7r-ZSC1WitU1NoZ3zGnlrJ4e2aMv_CbLrohDHGwrC2jJJh5Zru_VzRYxTqfIfbMQu6To4QONfTJnbu47lmp8wtTkJIISRnNYAwTUPFWUjm-MHSLlOlOgU9eGKLm6VTM_WxZxFSX5mHs3gbOp_Ou_jDgVNbgzItCK6BCJSXoXfhVOCgNnH_g6F_w, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre/read, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642332167, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.144.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=34321627881D894EE96362829F22E08D, http-session-last-accessed-time=1642331871035, kc-category-name=ACCESS, kc-iat=1642331867, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:51122 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:17:51.045  INFO 16 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:17:51.046  INFO 16 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3a975b21
2022-01-16 11:17:51.047  INFO 16 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3a975b21
2022-01-16 11:17:51.099  INFO 16 --- [https-jsse-nio-7071-exec-10] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18910322147098997-6766, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:31aa3bfa-c095-4f10-a6c7-a9d759a8e54b:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=31aa3bfa-c095-4f10-a6c7-a9d759a8e54b, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time after Shift Start, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:17:51.099  INFO 16 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=84e2e79d-1601-44cf-8229-c0185c3305c3, content=DENY, timestamp=1642331871099, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:31aa3bfa-c095-4f10-a6c7-a9d759a8e54b:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=31aa3bfa-c095-4f10-a6c7-a9d759a8e54b, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time after Shift Start, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:17:51.100  INFO 16 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=53ms, Total=57ms
2022-01-16 11:17:51.124  INFO 16 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=92f3440a-8636-46b0-a330-310317842c6b, content=null, timestamp=1642331871116, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=51124, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=22766fcc86b6, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=aafd4250-e6a1-4378-91fb-a2a4ddd87c5e, http-req-server-port=80, http-header-accept=*/*, kc-id=77b9495c-1692-426c-96be-094189073545, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642331871114, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQAB3NxAH4AEQAAAABh4/7bdAAkNzdiOTQ5NWMtMTY5Mi00MjZjLTk2YmUtMDk0MTg5MDczNTQ1dAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRhYWZkNDI1MC1lNmExLTQzNzgtOTFmYi1hMmE0ZGRkODdjNWVwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJhY3dRY1p6TGlENW1hRl85amJINGVRVFplOElvZDdldllhOUk2eDVXWjJnIn0.eyJleHAiOjE2NDIzMzIxNjcsImlhdCI6MTY0MjMzMTg2NywianRpIjoiNzdiOTQ5NWMtMTY5Mi00MjZjLTk2YmUtMDk0MTg5MDczNTQ1IiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiJhYWZkNDI1MC1lNmExLTQzNzgtOTFmYi1hMmE0ZGRkODdjNWUiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.ep3IG5UMcj__1HopMvUFb4xo9nI32gjSZwh03RVYoaim2ExbnEMIikZYIfXlh68pK0CGsTDpWMFgwTbyE98St8icBudSUAJ7fcG3ZJGb84sN9y5pZx7kMMWsBOdB37lSq2eX5SR6l1XgEUB3QxLM6uCgqXfD8yQ7r-ZSC1WitU1NoZ3zGnlrJ4e2aMv_CbLrohDHGwrC2jJJh5Zru_VzRYxTqfIfbMQu6To4QONfTJnbu47lmp8wtTkJIISRnNYAwTUPFWUjm-MHSLlOlOgU9eGKLm6VTM_WxZxFSX5mHs3gbOp_Ou_jDgVNbgzItCK6BCJSXoXfhVOCgNnH_g6F_w, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre/read, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642332167, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.144.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=6BF0363A8F2E776528C03E4E8C44D06E, http-session-last-accessed-time=1642331871114, kc-category-name=ACCESS, kc-iat=1642331867, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:51124 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:17:51.125  INFO 16 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:17:51.126  INFO 16 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@627e28f0
2022-01-16 11:17:51.127  INFO 16 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@627e28f0
2022-01-16 11:17:51.144  INFO 16 --- [https-jsse-nio-7071-exec-1] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18910322226684034-69383, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:31aa3bfa-c095-4f10-a6c7-a9d759a8e54b:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=31aa3bfa-c095-4f10-a6c7-a9d759a8e54b, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time after Shift Start, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:17:51.144  INFO 16 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=92f3440a-8636-46b0-a330-310317842c6b, content=DENY, timestamp=1642331871144, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:31aa3bfa-c095-4f10-a6c7-a9d759a8e54b:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=31aa3bfa-c095-4f10-a6c7-a9d759a8e54b, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time after Shift Start, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:17:51.145  INFO 16 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=19ms, Total=22ms
2022-01-16 11:17:51.166  INFO 16 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=475f4b54-f62c-403b-93d4-6a44e5039cb8, content=null, timestamp=1642331871156, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=51126, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=22766fcc86b6, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=aafd4250-e6a1-4378-91fb-a2a4ddd87c5e, http-req-server-port=80, http-header-accept=*/*, kc-id=77b9495c-1692-426c-96be-094189073545, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642331871154, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQAB3NxAH4AEQAAAABh4/7bdAAkNzdiOTQ5NWMtMTY5Mi00MjZjLTk2YmUtMDk0MTg5MDczNTQ1dAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRhYWZkNDI1MC1lNmExLTQzNzgtOTFmYi1hMmE0ZGRkODdjNWVwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJhY3dRY1p6TGlENW1hRl85amJINGVRVFplOElvZDdldllhOUk2eDVXWjJnIn0.eyJleHAiOjE2NDIzMzIxNjcsImlhdCI6MTY0MjMzMTg2NywianRpIjoiNzdiOTQ5NWMtMTY5Mi00MjZjLTk2YmUtMDk0MTg5MDczNTQ1IiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiJhYWZkNDI1MC1lNmExLTQzNzgtOTFmYi1hMmE0ZGRkODdjNWUiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.ep3IG5UMcj__1HopMvUFb4xo9nI32gjSZwh03RVYoaim2ExbnEMIikZYIfXlh68pK0CGsTDpWMFgwTbyE98St8icBudSUAJ7fcG3ZJGb84sN9y5pZx7kMMWsBOdB37lSq2eX5SR6l1XgEUB3QxLM6uCgqXfD8yQ7r-ZSC1WitU1NoZ3zGnlrJ4e2aMv_CbLrohDHGwrC2jJJh5Zru_VzRYxTqfIfbMQu6To4QONfTJnbu47lmp8wtTkJIISRnNYAwTUPFWUjm-MHSLlOlOgU9eGKLm6VTM_WxZxFSX5mHs3gbOp_Ou_jDgVNbgzItCK6BCJSXoXfhVOCgNnH_g6F_w, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre/read, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642332167, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.144.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=6C4D8292CE5EDD2B6B934A5F06825ED3, http-session-last-accessed-time=1642331871154, kc-category-name=ACCESS, kc-iat=1642331867, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:51126 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:17:51.171  INFO 16 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:17:51.172  INFO 16 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@75df1255
2022-01-16 11:17:51.172  INFO 16 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@75df1255
2022-01-16 11:17:51.184  INFO 16 --- [https-jsse-nio-7071-exec-2] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18910322272682710-413817, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:31aa3bfa-c095-4f10-a6c7-a9d759a8e54b:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=31aa3bfa-c095-4f10-a6c7-a9d759a8e54b, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time after Shift Start, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:17:51.184  INFO 16 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=475f4b54-f62c-403b-93d4-6a44e5039cb8, content=DENY, timestamp=1642331871184, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:31aa3bfa-c095-4f10-a6c7-a9d759a8e54b:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=31aa3bfa-c095-4f10-a6c7-a9d759a8e54b, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time after Shift Start, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:17:51.185  INFO 16 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=13ms, Total=20ms
2022-01-16 11:17:51.207  INFO 16 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=e6ec06da-e525-4cb2-a65a-c79c94730952, content=null, timestamp=1642331871196, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=51128, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=22766fcc86b6, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=aafd4250-e6a1-4378-91fb-a2a4ddd87c5e, http-req-server-port=80, http-header-accept=*/*, kc-id=77b9495c-1692-426c-96be-094189073545, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642331871194, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQAB3NxAH4AEQAAAABh4/7bdAAkNzdiOTQ5NWMtMTY5Mi00MjZjLTk2YmUtMDk0MTg5MDczNTQ1dAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRhYWZkNDI1MC1lNmExLTQzNzgtOTFmYi1hMmE0ZGRkODdjNWVwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJhY3dRY1p6TGlENW1hRl85amJINGVRVFplOElvZDdldllhOUk2eDVXWjJnIn0.eyJleHAiOjE2NDIzMzIxNjcsImlhdCI6MTY0MjMzMTg2NywianRpIjoiNzdiOTQ5NWMtMTY5Mi00MjZjLTk2YmUtMDk0MTg5MDczNTQ1IiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiJhYWZkNDI1MC1lNmExLTQzNzgtOTFmYi1hMmE0ZGRkODdjNWUiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.ep3IG5UMcj__1HopMvUFb4xo9nI32gjSZwh03RVYoaim2ExbnEMIikZYIfXlh68pK0CGsTDpWMFgwTbyE98St8icBudSUAJ7fcG3ZJGb84sN9y5pZx7kMMWsBOdB37lSq2eX5SR6l1XgEUB3QxLM6uCgqXfD8yQ7r-ZSC1WitU1NoZ3zGnlrJ4e2aMv_CbLrohDHGwrC2jJJh5Zru_VzRYxTqfIfbMQu6To4QONfTJnbu47lmp8wtTkJIISRnNYAwTUPFWUjm-MHSLlOlOgU9eGKLm6VTM_WxZxFSX5mHs3gbOp_Ou_jDgVNbgzItCK6BCJSXoXfhVOCgNnH_g6F_w, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre/read, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642332167, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.144.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=56B3E929E96231E6A5EACF8DBDA4354F, http-session-last-accessed-time=1642331871194, kc-category-name=ACCESS, kc-iat=1642331867, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:51128 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:17:51.208  INFO 16 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:17:51.209  INFO 16 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@56e832cf
2022-01-16 11:17:51.209  INFO 16 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@56e832cf
2022-01-16 11:17:51.262  INFO 16 --- [https-jsse-nio-7071-exec-3] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18910322309566004-44521, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:31aa3bfa-c095-4f10-a6c7-a9d759a8e54b:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=31aa3bfa-c095-4f10-a6c7-a9d759a8e54b, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time after Shift Start, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:17:51.263  INFO 16 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=e6ec06da-e525-4cb2-a65a-c79c94730952, content=DENY, timestamp=1642331871263, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:31aa3bfa-c095-4f10-a6c7-a9d759a8e54b:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=31aa3bfa-c095-4f10-a6c7-a9d759a8e54b, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time after Shift Start, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:17:51.263  INFO 16 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=55ms, Total=57ms
2022-01-16 11:17:51.294  INFO 16 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=2ed08aa5-322c-4fe8-a1af-1d7df70941dc, content=null, timestamp=1642331871277, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=51130, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=22766fcc86b6, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=aafd4250-e6a1-4378-91fb-a2a4ddd87c5e, http-req-server-port=80, http-header-accept=*/*, kc-id=77b9495c-1692-426c-96be-094189073545, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642331871276, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQAB3NxAH4AEQAAAABh4/7bdAAkNzdiOTQ5NWMtMTY5Mi00MjZjLTk2YmUtMDk0MTg5MDczNTQ1dAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRhYWZkNDI1MC1lNmExLTQzNzgtOTFmYi1hMmE0ZGRkODdjNWVwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJhY3dRY1p6TGlENW1hRl85amJINGVRVFplOElvZDdldllhOUk2eDVXWjJnIn0.eyJleHAiOjE2NDIzMzIxNjcsImlhdCI6MTY0MjMzMTg2NywianRpIjoiNzdiOTQ5NWMtMTY5Mi00MjZjLTk2YmUtMDk0MTg5MDczNTQ1IiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiJhYWZkNDI1MC1lNmExLTQzNzgtOTFmYi1hMmE0ZGRkODdjNWUiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.ep3IG5UMcj__1HopMvUFb4xo9nI32gjSZwh03RVYoaim2ExbnEMIikZYIfXlh68pK0CGsTDpWMFgwTbyE98St8icBudSUAJ7fcG3ZJGb84sN9y5pZx7kMMWsBOdB37lSq2eX5SR6l1XgEUB3QxLM6uCgqXfD8yQ7r-ZSC1WitU1NoZ3zGnlrJ4e2aMv_CbLrohDHGwrC2jJJh5Zru_VzRYxTqfIfbMQu6To4QONfTJnbu47lmp8wtTkJIISRnNYAwTUPFWUjm-MHSLlOlOgU9eGKLm6VTM_WxZxFSX5mHs3gbOp_Ou_jDgVNbgzItCK6BCJSXoXfhVOCgNnH_g6F_w, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre/read, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642332167, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.144.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=0E22DF61C8FD17BBD060127F07BB0448, http-session-last-accessed-time=1642331871276, kc-category-name=ACCESS, kc-iat=1642331867, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:51130 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:17:51.295  INFO 16 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:17:51.296  INFO 16 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6e2c8f92
2022-01-16 11:17:51.296  INFO 16 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6e2c8f92
2022-01-16 11:17:51.308  INFO 16 --- [https-jsse-nio-7071-exec-4] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18910322396848941-600403, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:31aa3bfa-c095-4f10-a6c7-a9d759a8e54b:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=31aa3bfa-c095-4f10-a6c7-a9d759a8e54b, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time after Shift Start, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:17:51.308  INFO 16 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=2ed08aa5-322c-4fe8-a1af-1d7df70941dc, content=DENY, timestamp=1642331871308, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:31aa3bfa-c095-4f10-a6c7-a9d759a8e54b:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=31aa3bfa-c095-4f10-a6c7-a9d759a8e54b, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time after Shift Start, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:17:51.310  INFO 16 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=13ms, Total=17ms
2022-01-16 11:17:51.332  INFO 16 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=6b16264a-aa67-4af6-b1da-9a4ff17e1bb2, content=null, timestamp=1642331871325, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=51132, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=22766fcc86b6, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=aafd4250-e6a1-4378-91fb-a2a4ddd87c5e, http-req-server-port=80, http-header-accept=*/*, kc-id=77b9495c-1692-426c-96be-094189073545, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642331871323, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQAB3NxAH4AEQAAAABh4/7bdAAkNzdiOTQ5NWMtMTY5Mi00MjZjLTk2YmUtMDk0MTg5MDczNTQ1dAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRhYWZkNDI1MC1lNmExLTQzNzgtOTFmYi1hMmE0ZGRkODdjNWVwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJhY3dRY1p6TGlENW1hRl85amJINGVRVFplOElvZDdldllhOUk2eDVXWjJnIn0.eyJleHAiOjE2NDIzMzIxNjcsImlhdCI6MTY0MjMzMTg2NywianRpIjoiNzdiOTQ5NWMtMTY5Mi00MjZjLTk2YmUtMDk0MTg5MDczNTQ1IiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiJhYWZkNDI1MC1lNmExLTQzNzgtOTFmYi1hMmE0ZGRkODdjNWUiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.ep3IG5UMcj__1HopMvUFb4xo9nI32gjSZwh03RVYoaim2ExbnEMIikZYIfXlh68pK0CGsTDpWMFgwTbyE98St8icBudSUAJ7fcG3ZJGb84sN9y5pZx7kMMWsBOdB37lSq2eX5SR6l1XgEUB3QxLM6uCgqXfD8yQ7r-ZSC1WitU1NoZ3zGnlrJ4e2aMv_CbLrohDHGwrC2jJJh5Zru_VzRYxTqfIfbMQu6To4QONfTJnbu47lmp8wtTkJIISRnNYAwTUPFWUjm-MHSLlOlOgU9eGKLm6VTM_WxZxFSX5mHs3gbOp_Ou_jDgVNbgzItCK6BCJSXoXfhVOCgNnH_g6F_w, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre/read, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642332167, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.144.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=A3738D1C6EC3D4CF6BB5EF845848DF6C, http-session-last-accessed-time=1642331871323, kc-category-name=ACCESS, kc-iat=1642331867, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:51132 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:17:51.332  INFO 16 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:17:51.333  INFO 16 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1c1b7784
2022-01-16 11:17:51.334  INFO 16 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1c1b7784
2022-01-16 11:17:51.345  INFO 16 --- [https-jsse-nio-7071-exec-5] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18910322434072222-458460, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:31aa3bfa-c095-4f10-a6c7-a9d759a8e54b:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=31aa3bfa-c095-4f10-a6c7-a9d759a8e54b, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time after Shift Start, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:17:51.345  INFO 16 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=6b16264a-aa67-4af6-b1da-9a4ff17e1bb2, content=DENY, timestamp=1642331871345, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:31aa3bfa-c095-4f10-a6c7-a9d759a8e54b:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=31aa3bfa-c095-4f10-a6c7-a9d759a8e54b, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time after Shift Start, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:17:51.345  INFO 16 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=12ms, Total=14ms
2022-01-16 11:17:51.366  INFO 16 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=1f822bd4-4e4f-4fbf-85ff-6185918521f4, content=null, timestamp=1642331871355, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=51134, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=22766fcc86b6, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=aafd4250-e6a1-4378-91fb-a2a4ddd87c5e, http-req-server-port=80, http-header-accept=*/*, kc-id=77b9495c-1692-426c-96be-094189073545, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642331871354, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQAB3NxAH4AEQAAAABh4/7bdAAkNzdiOTQ5NWMtMTY5Mi00MjZjLTk2YmUtMDk0MTg5MDczNTQ1dAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRhYWZkNDI1MC1lNmExLTQzNzgtOTFmYi1hMmE0ZGRkODdjNWVwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJhY3dRY1p6TGlENW1hRl85amJINGVRVFplOElvZDdldllhOUk2eDVXWjJnIn0.eyJleHAiOjE2NDIzMzIxNjcsImlhdCI6MTY0MjMzMTg2NywianRpIjoiNzdiOTQ5NWMtMTY5Mi00MjZjLTk2YmUtMDk0MTg5MDczNTQ1IiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiJhYWZkNDI1MC1lNmExLTQzNzgtOTFmYi1hMmE0ZGRkODdjNWUiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.ep3IG5UMcj__1HopMvUFb4xo9nI32gjSZwh03RVYoaim2ExbnEMIikZYIfXlh68pK0CGsTDpWMFgwTbyE98St8icBudSUAJ7fcG3ZJGb84sN9y5pZx7kMMWsBOdB37lSq2eX5SR6l1XgEUB3QxLM6uCgqXfD8yQ7r-ZSC1WitU1NoZ3zGnlrJ4e2aMv_CbLrohDHGwrC2jJJh5Zru_VzRYxTqfIfbMQu6To4QONfTJnbu47lmp8wtTkJIISRnNYAwTUPFWUjm-MHSLlOlOgU9eGKLm6VTM_WxZxFSX5mHs3gbOp_Ou_jDgVNbgzItCK6BCJSXoXfhVOCgNnH_g6F_w, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre/read, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642332167, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.144.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=D904BF928E0FCEA639D1BB849FBD9866, http-session-last-accessed-time=1642331871354, kc-category-name=ACCESS, kc-iat=1642331867, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:51134 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:17:51.369  INFO 16 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:17:51.373  INFO 16 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4dd1dbfb
2022-01-16 11:17:51.374  INFO 16 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4dd1dbfb
2022-01-16 11:17:51.426  INFO 16 --- [https-jsse-nio-7071-exec-6] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18910322470482965-348778, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:31aa3bfa-c095-4f10-a6c7-a9d759a8e54b:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=31aa3bfa-c095-4f10-a6c7-a9d759a8e54b, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time after Shift Start, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:17:51.426  INFO 16 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=1f822bd4-4e4f-4fbf-85ff-6185918521f4, content=DENY, timestamp=1642331871426, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:31aa3bfa-c095-4f10-a6c7-a9d759a8e54b:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=31aa3bfa-c095-4f10-a6c7-a9d759a8e54b, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time after Shift Start, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:17:51.427  INFO 16 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=57ms, Total=64ms
2022-01-16 11:17:51.448  INFO 16 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=605a3af3-3f77-4c5c-8f56-a3a8590063de, content=null, timestamp=1642331871441, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=51136, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=22766fcc86b6, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=aafd4250-e6a1-4378-91fb-a2a4ddd87c5e, http-req-server-port=80, http-header-accept=*/*, kc-id=77b9495c-1692-426c-96be-094189073545, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642331871439, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQAB3NxAH4AEQAAAABh4/7bdAAkNzdiOTQ5NWMtMTY5Mi00MjZjLTk2YmUtMDk0MTg5MDczNTQ1dAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRhYWZkNDI1MC1lNmExLTQzNzgtOTFmYi1hMmE0ZGRkODdjNWVwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJhY3dRY1p6TGlENW1hRl85amJINGVRVFplOElvZDdldllhOUk2eDVXWjJnIn0.eyJleHAiOjE2NDIzMzIxNjcsImlhdCI6MTY0MjMzMTg2NywianRpIjoiNzdiOTQ5NWMtMTY5Mi00MjZjLTk2YmUtMDk0MTg5MDczNTQ1IiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiJhYWZkNDI1MC1lNmExLTQzNzgtOTFmYi1hMmE0ZGRkODdjNWUiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.ep3IG5UMcj__1HopMvUFb4xo9nI32gjSZwh03RVYoaim2ExbnEMIikZYIfXlh68pK0CGsTDpWMFgwTbyE98St8icBudSUAJ7fcG3ZJGb84sN9y5pZx7kMMWsBOdB37lSq2eX5SR6l1XgEUB3QxLM6uCgqXfD8yQ7r-ZSC1WitU1NoZ3zGnlrJ4e2aMv_CbLrohDHGwrC2jJJh5Zru_VzRYxTqfIfbMQu6To4QONfTJnbu47lmp8wtTkJIISRnNYAwTUPFWUjm-MHSLlOlOgU9eGKLm6VTM_WxZxFSX5mHs3gbOp_Ou_jDgVNbgzItCK6BCJSXoXfhVOCgNnH_g6F_w, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre/read, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642332167, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.144.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=9BA5034412A884EEA0739CBCE0D53AF8, http-session-last-accessed-time=1642331871439, kc-category-name=ACCESS, kc-iat=1642331867, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:51136 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:17:51.449  INFO 16 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:17:51.450  INFO 16 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7130ed4e
2022-01-16 11:17:51.451  INFO 16 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7130ed4e
2022-01-16 11:17:51.465  INFO 16 --- [https-jsse-nio-7071-exec-7] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18910322550954409-953854, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:31aa3bfa-c095-4f10-a6c7-a9d759a8e54b:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=31aa3bfa-c095-4f10-a6c7-a9d759a8e54b, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time after Shift Start, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:17:51.465  INFO 16 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=605a3af3-3f77-4c5c-8f56-a3a8590063de, content=DENY, timestamp=1642331871465, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:31aa3bfa-c095-4f10-a6c7-a9d759a8e54b:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=31aa3bfa-c095-4f10-a6c7-a9d759a8e54b, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time after Shift Start, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:17:51.466  INFO 16 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=16ms, Total=19ms
2022-01-16 11:17:51.487  INFO 16 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=98efaaa8-daea-4db0-8137-0067c4a90636, content=null, timestamp=1642331871477, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=51138, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=22766fcc86b6, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=aafd4250-e6a1-4378-91fb-a2a4ddd87c5e, http-req-server-port=80, http-header-accept=*/*, kc-id=77b9495c-1692-426c-96be-094189073545, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642331871476, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQAB3NxAH4AEQAAAABh4/7bdAAkNzdiOTQ5NWMtMTY5Mi00MjZjLTk2YmUtMDk0MTg5MDczNTQ1dAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRhYWZkNDI1MC1lNmExLTQzNzgtOTFmYi1hMmE0ZGRkODdjNWVwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJhY3dRY1p6TGlENW1hRl85amJINGVRVFplOElvZDdldllhOUk2eDVXWjJnIn0.eyJleHAiOjE2NDIzMzIxNjcsImlhdCI6MTY0MjMzMTg2NywianRpIjoiNzdiOTQ5NWMtMTY5Mi00MjZjLTk2YmUtMDk0MTg5MDczNTQ1IiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiJhYWZkNDI1MC1lNmExLTQzNzgtOTFmYi1hMmE0ZGRkODdjNWUiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.ep3IG5UMcj__1HopMvUFb4xo9nI32gjSZwh03RVYoaim2ExbnEMIikZYIfXlh68pK0CGsTDpWMFgwTbyE98St8icBudSUAJ7fcG3ZJGb84sN9y5pZx7kMMWsBOdB37lSq2eX5SR6l1XgEUB3QxLM6uCgqXfD8yQ7r-ZSC1WitU1NoZ3zGnlrJ4e2aMv_CbLrohDHGwrC2jJJh5Zru_VzRYxTqfIfbMQu6To4QONfTJnbu47lmp8wtTkJIISRnNYAwTUPFWUjm-MHSLlOlOgU9eGKLm6VTM_WxZxFSX5mHs3gbOp_Ou_jDgVNbgzItCK6BCJSXoXfhVOCgNnH_g6F_w, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre/read, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642332167, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.144.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=A3E78DE744A393F98249D582AA190B80, http-session-last-accessed-time=1642331871476, kc-category-name=ACCESS, kc-iat=1642331867, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:51138 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:17:51.488  INFO 16 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:17:51.488  INFO 16 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@ef1a2e8
2022-01-16 11:17:51.489  INFO 16 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@ef1a2e8
2022-01-16 11:17:51.499  INFO 16 --- [https-jsse-nio-7071-exec-8] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18910322589206042-217029, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:31aa3bfa-c095-4f10-a6c7-a9d759a8e54b:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=31aa3bfa-c095-4f10-a6c7-a9d759a8e54b, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time after Shift Start, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:17:51.500  INFO 16 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=98efaaa8-daea-4db0-8137-0067c4a90636, content=DENY, timestamp=1642331871500, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:31aa3bfa-c095-4f10-a6c7-a9d759a8e54b:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=31aa3bfa-c095-4f10-a6c7-a9d759a8e54b, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time after Shift Start, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:17:51.500  INFO 16 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=12ms, Total=15ms
2022-01-16 11:17:51.518  INFO 16 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=7ef713ea-843a-4cee-87ac-004fafbb7b6b, content=null, timestamp=1642331871513, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=51140, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=22766fcc86b6, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=aafd4250-e6a1-4378-91fb-a2a4ddd87c5e, http-req-server-port=80, http-header-accept=*/*, kc-id=77b9495c-1692-426c-96be-094189073545, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642331871511, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQAB3NxAH4AEQAAAABh4/7bdAAkNzdiOTQ5NWMtMTY5Mi00MjZjLTk2YmUtMDk0MTg5MDczNTQ1dAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRhYWZkNDI1MC1lNmExLTQzNzgtOTFmYi1hMmE0ZGRkODdjNWVwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJhY3dRY1p6TGlENW1hRl85amJINGVRVFplOElvZDdldllhOUk2eDVXWjJnIn0.eyJleHAiOjE2NDIzMzIxNjcsImlhdCI6MTY0MjMzMTg2NywianRpIjoiNzdiOTQ5NWMtMTY5Mi00MjZjLTk2YmUtMDk0MTg5MDczNTQ1IiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiJhYWZkNDI1MC1lNmExLTQzNzgtOTFmYi1hMmE0ZGRkODdjNWUiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.ep3IG5UMcj__1HopMvUFb4xo9nI32gjSZwh03RVYoaim2ExbnEMIikZYIfXlh68pK0CGsTDpWMFgwTbyE98St8icBudSUAJ7fcG3ZJGb84sN9y5pZx7kMMWsBOdB37lSq2eX5SR6l1XgEUB3QxLM6uCgqXfD8yQ7r-ZSC1WitU1NoZ3zGnlrJ4e2aMv_CbLrohDHGwrC2jJJh5Zru_VzRYxTqfIfbMQu6To4QONfTJnbu47lmp8wtTkJIISRnNYAwTUPFWUjm-MHSLlOlOgU9eGKLm6VTM_WxZxFSX5mHs3gbOp_Ou_jDgVNbgzItCK6BCJSXoXfhVOCgNnH_g6F_w, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre/read, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642332167, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.144.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=52E6DDACF406E7DCCBDD8EC735232634, http-session-last-accessed-time=1642331871511, kc-category-name=ACCESS, kc-iat=1642331867, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:51140 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:17:51.519  INFO 16 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:17:51.521  INFO 16 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@60a5b6e4
2022-01-16 11:17:51.521  INFO 16 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@60a5b6e4
2022-01-16 11:17:51.582  INFO 16 --- [https-jsse-nio-7071-exec-9] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18910322620683806-721306, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:31aa3bfa-c095-4f10-a6c7-a9d759a8e54b:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=31aa3bfa-c095-4f10-a6c7-a9d759a8e54b, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time after Shift Start, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:17:51.583  INFO 16 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=7ef713ea-843a-4cee-87ac-004fafbb7b6b, content=DENY, timestamp=1642331871583, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:31aa3bfa-c095-4f10-a6c7-a9d759a8e54b:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=31aa3bfa-c095-4f10-a6c7-a9d759a8e54b, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time after Shift Start, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:17:51.584  INFO 16 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=64ms, Total=67ms
2022-01-16 11:17:51.601  INFO 16 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=be0204af-6c85-4ed9-ab0e-33e19211d53a, content=null, timestamp=1642331871597, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=51142, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=22766fcc86b6, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=aafd4250-e6a1-4378-91fb-a2a4ddd87c5e, http-req-server-port=80, http-header-accept=*/*, kc-id=77b9495c-1692-426c-96be-094189073545, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642331871595, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQAB3NxAH4AEQAAAABh4/7bdAAkNzdiOTQ5NWMtMTY5Mi00MjZjLTk2YmUtMDk0MTg5MDczNTQ1dAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRhYWZkNDI1MC1lNmExLTQzNzgtOTFmYi1hMmE0ZGRkODdjNWVwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJhY3dRY1p6TGlENW1hRl85amJINGVRVFplOElvZDdldllhOUk2eDVXWjJnIn0.eyJleHAiOjE2NDIzMzIxNjcsImlhdCI6MTY0MjMzMTg2NywianRpIjoiNzdiOTQ5NWMtMTY5Mi00MjZjLTk2YmUtMDk0MTg5MDczNTQ1IiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiJhYWZkNDI1MC1lNmExLTQzNzgtOTFmYi1hMmE0ZGRkODdjNWUiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.ep3IG5UMcj__1HopMvUFb4xo9nI32gjSZwh03RVYoaim2ExbnEMIikZYIfXlh68pK0CGsTDpWMFgwTbyE98St8icBudSUAJ7fcG3ZJGb84sN9y5pZx7kMMWsBOdB37lSq2eX5SR6l1XgEUB3QxLM6uCgqXfD8yQ7r-ZSC1WitU1NoZ3zGnlrJ4e2aMv_CbLrohDHGwrC2jJJh5Zru_VzRYxTqfIfbMQu6To4QONfTJnbu47lmp8wtTkJIISRnNYAwTUPFWUjm-MHSLlOlOgU9eGKLm6VTM_WxZxFSX5mHs3gbOp_Ou_jDgVNbgzItCK6BCJSXoXfhVOCgNnH_g6F_w, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre/read, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642332167, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.144.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=7832229CEE66F935E878A48746A97678, http-session-last-accessed-time=1642331871595, kc-category-name=ACCESS, kc-iat=1642331867, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:51142 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:17:51.602  INFO 16 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:17:51.603  INFO 16 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2ef19819
2022-01-16 11:17:51.603  INFO 16 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2ef19819
2022-01-16 11:17:51.614  INFO 16 --- [https-jsse-nio-7071-exec-10] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18910322703363438-123102, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:31aa3bfa-c095-4f10-a6c7-a9d759a8e54b:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=31aa3bfa-c095-4f10-a6c7-a9d759a8e54b, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time after Shift Start, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:17:51.614  INFO 16 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=be0204af-6c85-4ed9-ab0e-33e19211d53a, content=DENY, timestamp=1642331871614, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:31aa3bfa-c095-4f10-a6c7-a9d759a8e54b:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=31aa3bfa-c095-4f10-a6c7-a9d759a8e54b, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time after Shift Start, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:17:51.615  INFO 16 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=12ms, Total=15ms
2022-01-16 11:17:51.639  INFO 16 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=891c1457-e7bb-4e20-b97a-b3ea4b24cd41, content=null, timestamp=1642331871626, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=51144, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=22766fcc86b6, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=aafd4250-e6a1-4378-91fb-a2a4ddd87c5e, http-req-server-port=80, http-header-accept=*/*, kc-id=77b9495c-1692-426c-96be-094189073545, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642331871624, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQAB3NxAH4AEQAAAABh4/7bdAAkNzdiOTQ5NWMtMTY5Mi00MjZjLTk2YmUtMDk0MTg5MDczNTQ1dAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRhYWZkNDI1MC1lNmExLTQzNzgtOTFmYi1hMmE0ZGRkODdjNWVwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJhY3dRY1p6TGlENW1hRl85amJINGVRVFplOElvZDdldllhOUk2eDVXWjJnIn0.eyJleHAiOjE2NDIzMzIxNjcsImlhdCI6MTY0MjMzMTg2NywianRpIjoiNzdiOTQ5NWMtMTY5Mi00MjZjLTk2YmUtMDk0MTg5MDczNTQ1IiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiJhYWZkNDI1MC1lNmExLTQzNzgtOTFmYi1hMmE0ZGRkODdjNWUiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.ep3IG5UMcj__1HopMvUFb4xo9nI32gjSZwh03RVYoaim2ExbnEMIikZYIfXlh68pK0CGsTDpWMFgwTbyE98St8icBudSUAJ7fcG3ZJGb84sN9y5pZx7kMMWsBOdB37lSq2eX5SR6l1XgEUB3QxLM6uCgqXfD8yQ7r-ZSC1WitU1NoZ3zGnlrJ4e2aMv_CbLrohDHGwrC2jJJh5Zru_VzRYxTqfIfbMQu6To4QONfTJnbu47lmp8wtTkJIISRnNYAwTUPFWUjm-MHSLlOlOgU9eGKLm6VTM_WxZxFSX5mHs3gbOp_Ou_jDgVNbgzItCK6BCJSXoXfhVOCgNnH_g6F_w, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre/read, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642332167, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.144.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=59645797830C6853297A1A89C2B7B81D, http-session-last-accessed-time=1642331871624, kc-category-name=ACCESS, kc-iat=1642331867, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:51144 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:17:51.649  INFO 16 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:17:51.650  INFO 16 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1f7b5b86
2022-01-16 11:17:51.651  INFO 16 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1f7b5b86
2022-01-16 11:17:51.662  INFO 16 --- [https-jsse-nio-7071-exec-1] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18910322751198682-764435, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:31aa3bfa-c095-4f10-a6c7-a9d759a8e54b:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=31aa3bfa-c095-4f10-a6c7-a9d759a8e54b, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time after Shift Start, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:17:51.662  INFO 16 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=891c1457-e7bb-4e20-b97a-b3ea4b24cd41, content=DENY, timestamp=1642331871662, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:31aa3bfa-c095-4f10-a6c7-a9d759a8e54b:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=31aa3bfa-c095-4f10-a6c7-a9d759a8e54b, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time after Shift Start, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:17:51.663  INFO 16 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=12ms, Total=25ms
2022-01-16 11:17:51.684  INFO 16 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=5f1e9cfe-ad4b-4084-b5fe-fba11d5198f0, content=null, timestamp=1642331871672, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=51146, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=22766fcc86b6, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=aafd4250-e6a1-4378-91fb-a2a4ddd87c5e, http-req-server-port=80, http-header-accept=*/*, kc-id=77b9495c-1692-426c-96be-094189073545, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642331871671, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQAB3NxAH4AEQAAAABh4/7bdAAkNzdiOTQ5NWMtMTY5Mi00MjZjLTk2YmUtMDk0MTg5MDczNTQ1dAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRhYWZkNDI1MC1lNmExLTQzNzgtOTFmYi1hMmE0ZGRkODdjNWVwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJhY3dRY1p6TGlENW1hRl85amJINGVRVFplOElvZDdldllhOUk2eDVXWjJnIn0.eyJleHAiOjE2NDIzMzIxNjcsImlhdCI6MTY0MjMzMTg2NywianRpIjoiNzdiOTQ5NWMtMTY5Mi00MjZjLTk2YmUtMDk0MTg5MDczNTQ1IiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiJhYWZkNDI1MC1lNmExLTQzNzgtOTFmYi1hMmE0ZGRkODdjNWUiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.ep3IG5UMcj__1HopMvUFb4xo9nI32gjSZwh03RVYoaim2ExbnEMIikZYIfXlh68pK0CGsTDpWMFgwTbyE98St8icBudSUAJ7fcG3ZJGb84sN9y5pZx7kMMWsBOdB37lSq2eX5SR6l1XgEUB3QxLM6uCgqXfD8yQ7r-ZSC1WitU1NoZ3zGnlrJ4e2aMv_CbLrohDHGwrC2jJJh5Zru_VzRYxTqfIfbMQu6To4QONfTJnbu47lmp8wtTkJIISRnNYAwTUPFWUjm-MHSLlOlOgU9eGKLm6VTM_WxZxFSX5mHs3gbOp_Ou_jDgVNbgzItCK6BCJSXoXfhVOCgNnH_g6F_w, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre/read, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642332167, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.144.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=23B3FC7A02048D81B5067823F8BF8201, http-session-last-accessed-time=1642331871671, kc-category-name=ACCESS, kc-iat=1642331867, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:51146 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:17:51.685  INFO 16 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:17:51.686  INFO 16 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2abb65b0
2022-01-16 11:17:51.686  INFO 16 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2abb65b0
2022-01-16 11:17:51.697  INFO 16 --- [https-jsse-nio-7071-exec-2] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18910322786879147-681705, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:31aa3bfa-c095-4f10-a6c7-a9d759a8e54b:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=31aa3bfa-c095-4f10-a6c7-a9d759a8e54b, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time after Shift Start, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:17:51.698  INFO 16 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=5f1e9cfe-ad4b-4084-b5fe-fba11d5198f0, content=DENY, timestamp=1642331871698, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:31aa3bfa-c095-4f10-a6c7-a9d759a8e54b:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=31aa3bfa-c095-4f10-a6c7-a9d759a8e54b, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time after Shift Start, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:17:51.698  INFO 16 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=13ms, Total=15ms
2022-01-16 11:17:51.724  INFO 16 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=dad532c5-ac72-4681-af59-97c8f5330f94, content=null, timestamp=1642331871714, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=51148, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=22766fcc86b6, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=aafd4250-e6a1-4378-91fb-a2a4ddd87c5e, http-req-server-port=80, http-header-accept=*/*, kc-id=77b9495c-1692-426c-96be-094189073545, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642331871713, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQAB3NxAH4AEQAAAABh4/7bdAAkNzdiOTQ5NWMtMTY5Mi00MjZjLTk2YmUtMDk0MTg5MDczNTQ1dAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRhYWZkNDI1MC1lNmExLTQzNzgtOTFmYi1hMmE0ZGRkODdjNWVwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJhY3dRY1p6TGlENW1hRl85amJINGVRVFplOElvZDdldllhOUk2eDVXWjJnIn0.eyJleHAiOjE2NDIzMzIxNjcsImlhdCI6MTY0MjMzMTg2NywianRpIjoiNzdiOTQ5NWMtMTY5Mi00MjZjLTk2YmUtMDk0MTg5MDczNTQ1IiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiJhYWZkNDI1MC1lNmExLTQzNzgtOTFmYi1hMmE0ZGRkODdjNWUiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.ep3IG5UMcj__1HopMvUFb4xo9nI32gjSZwh03RVYoaim2ExbnEMIikZYIfXlh68pK0CGsTDpWMFgwTbyE98St8icBudSUAJ7fcG3ZJGb84sN9y5pZx7kMMWsBOdB37lSq2eX5SR6l1XgEUB3QxLM6uCgqXfD8yQ7r-ZSC1WitU1NoZ3zGnlrJ4e2aMv_CbLrohDHGwrC2jJJh5Zru_VzRYxTqfIfbMQu6To4QONfTJnbu47lmp8wtTkJIISRnNYAwTUPFWUjm-MHSLlOlOgU9eGKLm6VTM_WxZxFSX5mHs3gbOp_Ou_jDgVNbgzItCK6BCJSXoXfhVOCgNnH_g6F_w, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre/read, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642332167, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.144.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=59876413F3CD54C7F77BFEA77E2809EF, http-session-last-accessed-time=1642331871713, kc-category-name=ACCESS, kc-iat=1642331867, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:51148 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:17:51.724  INFO 16 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:17:51.727  INFO 16 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@11db92d
2022-01-16 11:17:51.727  INFO 16 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@11db92d
2022-01-16 11:17:51.790  INFO 16 --- [https-jsse-nio-7071-exec-3] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18910322826152363-153057, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:31aa3bfa-c095-4f10-a6c7-a9d759a8e54b:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=31aa3bfa-c095-4f10-a6c7-a9d759a8e54b, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time after Shift Start, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:17:51.790  INFO 16 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=dad532c5-ac72-4681-af59-97c8f5330f94, content=DENY, timestamp=1642331871790, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:31aa3bfa-c095-4f10-a6c7-a9d759a8e54b:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=31aa3bfa-c095-4f10-a6c7-a9d759a8e54b, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time after Shift Start, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:17:51.791  INFO 16 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=65ms, Total=68ms
2022-01-16 11:17:51.808  INFO 16 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=0dff99d3-d4ec-40c8-9381-e9dd7588a3d6, content=null, timestamp=1642331871803, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=51150, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=22766fcc86b6, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=aafd4250-e6a1-4378-91fb-a2a4ddd87c5e, http-req-server-port=80, http-header-accept=*/*, kc-id=77b9495c-1692-426c-96be-094189073545, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642331871802, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQAB3NxAH4AEQAAAABh4/7bdAAkNzdiOTQ5NWMtMTY5Mi00MjZjLTk2YmUtMDk0MTg5MDczNTQ1dAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRhYWZkNDI1MC1lNmExLTQzNzgtOTFmYi1hMmE0ZGRkODdjNWVwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJhY3dRY1p6TGlENW1hRl85amJINGVRVFplOElvZDdldllhOUk2eDVXWjJnIn0.eyJleHAiOjE2NDIzMzIxNjcsImlhdCI6MTY0MjMzMTg2NywianRpIjoiNzdiOTQ5NWMtMTY5Mi00MjZjLTk2YmUtMDk0MTg5MDczNTQ1IiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiJhYWZkNDI1MC1lNmExLTQzNzgtOTFmYi1hMmE0ZGRkODdjNWUiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.ep3IG5UMcj__1HopMvUFb4xo9nI32gjSZwh03RVYoaim2ExbnEMIikZYIfXlh68pK0CGsTDpWMFgwTbyE98St8icBudSUAJ7fcG3ZJGb84sN9y5pZx7kMMWsBOdB37lSq2eX5SR6l1XgEUB3QxLM6uCgqXfD8yQ7r-ZSC1WitU1NoZ3zGnlrJ4e2aMv_CbLrohDHGwrC2jJJh5Zru_VzRYxTqfIfbMQu6To4QONfTJnbu47lmp8wtTkJIISRnNYAwTUPFWUjm-MHSLlOlOgU9eGKLm6VTM_WxZxFSX5mHs3gbOp_Ou_jDgVNbgzItCK6BCJSXoXfhVOCgNnH_g6F_w, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre/read, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642332167, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.144.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=2EDB3B8F420E4604C56CF94164867307, http-session-last-accessed-time=1642331871802, kc-category-name=ACCESS, kc-iat=1642331867, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:51150 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:17:51.808  INFO 16 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:17:51.810  INFO 16 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@218cee4a
2022-01-16 11:17:51.810  INFO 16 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@218cee4a
2022-01-16 11:17:51.822  INFO 16 --- [https-jsse-nio-7071-exec-4] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18910322910226352-205632, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:31aa3bfa-c095-4f10-a6c7-a9d759a8e54b:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=31aa3bfa-c095-4f10-a6c7-a9d759a8e54b, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time after Shift Start, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:17:51.822  INFO 16 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=0dff99d3-d4ec-40c8-9381-e9dd7588a3d6, content=DENY, timestamp=1642331871822, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:31aa3bfa-c095-4f10-a6c7-a9d759a8e54b:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=31aa3bfa-c095-4f10-a6c7-a9d759a8e54b, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time after Shift Start, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:17:51.823  INFO 16 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=13ms, Total=16ms
2022-01-16 11:17:51.845  INFO 16 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=919e119f-ff63-41fa-a0a3-20587c6e424c, content=null, timestamp=1642331871834, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=51152, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=22766fcc86b6, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=aafd4250-e6a1-4378-91fb-a2a4ddd87c5e, http-req-server-port=80, http-header-accept=*/*, kc-id=77b9495c-1692-426c-96be-094189073545, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642331871833, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQAB3NxAH4AEQAAAABh4/7bdAAkNzdiOTQ5NWMtMTY5Mi00MjZjLTk2YmUtMDk0MTg5MDczNTQ1dAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRhYWZkNDI1MC1lNmExLTQzNzgtOTFmYi1hMmE0ZGRkODdjNWVwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJhY3dRY1p6TGlENW1hRl85amJINGVRVFplOElvZDdldllhOUk2eDVXWjJnIn0.eyJleHAiOjE2NDIzMzIxNjcsImlhdCI6MTY0MjMzMTg2NywianRpIjoiNzdiOTQ5NWMtMTY5Mi00MjZjLTk2YmUtMDk0MTg5MDczNTQ1IiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiJhYWZkNDI1MC1lNmExLTQzNzgtOTFmYi1hMmE0ZGRkODdjNWUiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.ep3IG5UMcj__1HopMvUFb4xo9nI32gjSZwh03RVYoaim2ExbnEMIikZYIfXlh68pK0CGsTDpWMFgwTbyE98St8icBudSUAJ7fcG3ZJGb84sN9y5pZx7kMMWsBOdB37lSq2eX5SR6l1XgEUB3QxLM6uCgqXfD8yQ7r-ZSC1WitU1NoZ3zGnlrJ4e2aMv_CbLrohDHGwrC2jJJh5Zru_VzRYxTqfIfbMQu6To4QONfTJnbu47lmp8wtTkJIISRnNYAwTUPFWUjm-MHSLlOlOgU9eGKLm6VTM_WxZxFSX5mHs3gbOp_Ou_jDgVNbgzItCK6BCJSXoXfhVOCgNnH_g6F_w, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre/read, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642332167, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.144.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=D314EB4F15DAAC8EF9B4A139B36145B4, http-session-last-accessed-time=1642331871833, kc-category-name=ACCESS, kc-iat=1642331867, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:51152 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:17:51.845  INFO 16 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:17:51.846  INFO 16 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3254cc37
2022-01-16 11:17:51.847  INFO 16 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3254cc37
2022-01-16 11:17:51.858  INFO 16 --- [https-jsse-nio-7071-exec-5] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18910322946922748-52345, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:31aa3bfa-c095-4f10-a6c7-a9d759a8e54b:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=31aa3bfa-c095-4f10-a6c7-a9d759a8e54b, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time after Shift Start, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:17:51.858  INFO 16 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=919e119f-ff63-41fa-a0a3-20587c6e424c, content=DENY, timestamp=1642331871858, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:31aa3bfa-c095-4f10-a6c7-a9d759a8e54b:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=31aa3bfa-c095-4f10-a6c7-a9d759a8e54b, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time after Shift Start, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:17:51.858  INFO 16 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=13ms, Total=15ms
2022-01-16 11:17:51.874  INFO 16 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=240363bd-a927-4021-8a6e-3857b552a01b, content=null, timestamp=1642331871869, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=51154, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=22766fcc86b6, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=aafd4250-e6a1-4378-91fb-a2a4ddd87c5e, http-req-server-port=80, http-header-accept=*/*, kc-id=77b9495c-1692-426c-96be-094189073545, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642331871868, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQAB3NxAH4AEQAAAABh4/7bdAAkNzdiOTQ5NWMtMTY5Mi00MjZjLTk2YmUtMDk0MTg5MDczNTQ1dAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRhYWZkNDI1MC1lNmExLTQzNzgtOTFmYi1hMmE0ZGRkODdjNWVwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJhY3dRY1p6TGlENW1hRl85amJINGVRVFplOElvZDdldllhOUk2eDVXWjJnIn0.eyJleHAiOjE2NDIzMzIxNjcsImlhdCI6MTY0MjMzMTg2NywianRpIjoiNzdiOTQ5NWMtMTY5Mi00MjZjLTk2YmUtMDk0MTg5MDczNTQ1IiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiJhYWZkNDI1MC1lNmExLTQzNzgtOTFmYi1hMmE0ZGRkODdjNWUiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.ep3IG5UMcj__1HopMvUFb4xo9nI32gjSZwh03RVYoaim2ExbnEMIikZYIfXlh68pK0CGsTDpWMFgwTbyE98St8icBudSUAJ7fcG3ZJGb84sN9y5pZx7kMMWsBOdB37lSq2eX5SR6l1XgEUB3QxLM6uCgqXfD8yQ7r-ZSC1WitU1NoZ3zGnlrJ4e2aMv_CbLrohDHGwrC2jJJh5Zru_VzRYxTqfIfbMQu6To4QONfTJnbu47lmp8wtTkJIISRnNYAwTUPFWUjm-MHSLlOlOgU9eGKLm6VTM_WxZxFSX5mHs3gbOp_Ou_jDgVNbgzItCK6BCJSXoXfhVOCgNnH_g6F_w, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre/read, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642332167, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.144.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=FF6BF306F69F4E11B653E860BE34BC9C, http-session-last-accessed-time=1642331871868, kc-category-name=ACCESS, kc-iat=1642331867, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:51154 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:17:51.875  INFO 16 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:17:51.876  INFO 16 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@46bfc48e
2022-01-16 11:17:51.876  INFO 16 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@46bfc48e
2022-01-16 11:17:51.931  INFO 16 --- [https-jsse-nio-7071-exec-6] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18910322976468699-516277, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:31aa3bfa-c095-4f10-a6c7-a9d759a8e54b:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=31aa3bfa-c095-4f10-a6c7-a9d759a8e54b, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time after Shift Start, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:17:51.931  INFO 16 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=240363bd-a927-4021-8a6e-3857b552a01b, content=DENY, timestamp=1642331871931, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:31aa3bfa-c095-4f10-a6c7-a9d759a8e54b:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=31aa3bfa-c095-4f10-a6c7-a9d759a8e54b, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time after Shift Start, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:17:51.931  INFO 16 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=56ms, Total=58ms
2022-01-16 11:17:51.953  INFO 16 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=dece8f94-9291-4b67-b986-8693133abf07, content=null, timestamp=1642331871946, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=51156, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=22766fcc86b6, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=aafd4250-e6a1-4378-91fb-a2a4ddd87c5e, http-req-server-port=80, http-header-accept=*/*, kc-id=77b9495c-1692-426c-96be-094189073545, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642331871944, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQAB3NxAH4AEQAAAABh4/7bdAAkNzdiOTQ5NWMtMTY5Mi00MjZjLTk2YmUtMDk0MTg5MDczNTQ1dAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRhYWZkNDI1MC1lNmExLTQzNzgtOTFmYi1hMmE0ZGRkODdjNWVwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJhY3dRY1p6TGlENW1hRl85amJINGVRVFplOElvZDdldllhOUk2eDVXWjJnIn0.eyJleHAiOjE2NDIzMzIxNjcsImlhdCI6MTY0MjMzMTg2NywianRpIjoiNzdiOTQ5NWMtMTY5Mi00MjZjLTk2YmUtMDk0MTg5MDczNTQ1IiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiJhYWZkNDI1MC1lNmExLTQzNzgtOTFmYi1hMmE0ZGRkODdjNWUiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.ep3IG5UMcj__1HopMvUFb4xo9nI32gjSZwh03RVYoaim2ExbnEMIikZYIfXlh68pK0CGsTDpWMFgwTbyE98St8icBudSUAJ7fcG3ZJGb84sN9y5pZx7kMMWsBOdB37lSq2eX5SR6l1XgEUB3QxLM6uCgqXfD8yQ7r-ZSC1WitU1NoZ3zGnlrJ4e2aMv_CbLrohDHGwrC2jJJh5Zru_VzRYxTqfIfbMQu6To4QONfTJnbu47lmp8wtTkJIISRnNYAwTUPFWUjm-MHSLlOlOgU9eGKLm6VTM_WxZxFSX5mHs3gbOp_Ou_jDgVNbgzItCK6BCJSXoXfhVOCgNnH_g6F_w, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre/read, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642332167, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.144.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=815C77CC08897595253ED92C589A9473, http-session-last-accessed-time=1642331871944, kc-category-name=ACCESS, kc-iat=1642331867, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:51156 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:17:51.992  INFO 16 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:17:51.994  INFO 16 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1f5062a0
2022-01-16 11:17:51.994  INFO 16 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1f5062a0
2022-01-16 11:17:52.006  INFO 16 --- [https-jsse-nio-7071-exec-7] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18910323094644128-844831, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:31aa3bfa-c095-4f10-a6c7-a9d759a8e54b:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=31aa3bfa-c095-4f10-a6c7-a9d759a8e54b, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time after Shift Start, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:17:52.006  INFO 16 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=dece8f94-9291-4b67-b986-8693133abf07, content=DENY, timestamp=1642331872006, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:31aa3bfa-c095-4f10-a6c7-a9d759a8e54b:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=31aa3bfa-c095-4f10-a6c7-a9d759a8e54b, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time after Shift Start, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:17:52.007  INFO 16 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=13ms, Total=56ms
2022-01-16 11:17:52.024  INFO 16 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=5c23da4a-3c87-4df0-a462-a61b6217c576, content=null, timestamp=1642331872018, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=51158, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=22766fcc86b6, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=aafd4250-e6a1-4378-91fb-a2a4ddd87c5e, http-req-server-port=80, http-header-accept=*/*, kc-id=77b9495c-1692-426c-96be-094189073545, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642331872017, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQAB3NxAH4AEQAAAABh4/7bdAAkNzdiOTQ5NWMtMTY5Mi00MjZjLTk2YmUtMDk0MTg5MDczNTQ1dAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRhYWZkNDI1MC1lNmExLTQzNzgtOTFmYi1hMmE0ZGRkODdjNWVwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJhY3dRY1p6TGlENW1hRl85amJINGVRVFplOElvZDdldllhOUk2eDVXWjJnIn0.eyJleHAiOjE2NDIzMzIxNjcsImlhdCI6MTY0MjMzMTg2NywianRpIjoiNzdiOTQ5NWMtMTY5Mi00MjZjLTk2YmUtMDk0MTg5MDczNTQ1IiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiJhYWZkNDI1MC1lNmExLTQzNzgtOTFmYi1hMmE0ZGRkODdjNWUiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.ep3IG5UMcj__1HopMvUFb4xo9nI32gjSZwh03RVYoaim2ExbnEMIikZYIfXlh68pK0CGsTDpWMFgwTbyE98St8icBudSUAJ7fcG3ZJGb84sN9y5pZx7kMMWsBOdB37lSq2eX5SR6l1XgEUB3QxLM6uCgqXfD8yQ7r-ZSC1WitU1NoZ3zGnlrJ4e2aMv_CbLrohDHGwrC2jJJh5Zru_VzRYxTqfIfbMQu6To4QONfTJnbu47lmp8wtTkJIISRnNYAwTUPFWUjm-MHSLlOlOgU9eGKLm6VTM_WxZxFSX5mHs3gbOp_Ou_jDgVNbgzItCK6BCJSXoXfhVOCgNnH_g6F_w, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre/read, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642332167, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.144.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=2E04AF2346CC61A0D8A25B38740BA524, http-session-last-accessed-time=1642331872017, kc-category-name=ACCESS, kc-iat=1642331867, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:51158 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:17:52.025  INFO 16 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:17:52.026  INFO 16 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6a84a3cb
2022-01-16 11:17:52.035  INFO 16 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6a84a3cb
2022-01-16 11:17:52.047  INFO 16 --- [https-jsse-nio-7071-exec-8] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18910323126791159-562487, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:31aa3bfa-c095-4f10-a6c7-a9d759a8e54b:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=31aa3bfa-c095-4f10-a6c7-a9d759a8e54b, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time after Shift Start, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:17:52.048  INFO 16 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=5c23da4a-3c87-4df0-a462-a61b6217c576, content=DENY, timestamp=1642331872048, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:31aa3bfa-c095-4f10-a6c7-a9d759a8e54b:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=31aa3bfa-c095-4f10-a6c7-a9d759a8e54b, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time after Shift Start, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:17:52.048  INFO 16 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=23ms, Total=26ms
2022-01-16 11:17:52.064  INFO 16 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=7974af58-0d9c-4f14-aec1-f7e8924be917, content=null, timestamp=1642331872059, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=51160, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=22766fcc86b6, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=aafd4250-e6a1-4378-91fb-a2a4ddd87c5e, http-req-server-port=80, http-header-accept=*/*, kc-id=77b9495c-1692-426c-96be-094189073545, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642331872058, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQAB3NxAH4AEQAAAABh4/7bdAAkNzdiOTQ5NWMtMTY5Mi00MjZjLTk2YmUtMDk0MTg5MDczNTQ1dAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRhYWZkNDI1MC1lNmExLTQzNzgtOTFmYi1hMmE0ZGRkODdjNWVwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJhY3dRY1p6TGlENW1hRl85amJINGVRVFplOElvZDdldllhOUk2eDVXWjJnIn0.eyJleHAiOjE2NDIzMzIxNjcsImlhdCI6MTY0MjMzMTg2NywianRpIjoiNzdiOTQ5NWMtMTY5Mi00MjZjLTk2YmUtMDk0MTg5MDczNTQ1IiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiJhYWZkNDI1MC1lNmExLTQzNzgtOTFmYi1hMmE0ZGRkODdjNWUiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.ep3IG5UMcj__1HopMvUFb4xo9nI32gjSZwh03RVYoaim2ExbnEMIikZYIfXlh68pK0CGsTDpWMFgwTbyE98St8icBudSUAJ7fcG3ZJGb84sN9y5pZx7kMMWsBOdB37lSq2eX5SR6l1XgEUB3QxLM6uCgqXfD8yQ7r-ZSC1WitU1NoZ3zGnlrJ4e2aMv_CbLrohDHGwrC2jJJh5Zru_VzRYxTqfIfbMQu6To4QONfTJnbu47lmp8wtTkJIISRnNYAwTUPFWUjm-MHSLlOlOgU9eGKLm6VTM_WxZxFSX5mHs3gbOp_Ou_jDgVNbgzItCK6BCJSXoXfhVOCgNnH_g6F_w, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre/read, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642332167, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.144.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=C60D69AA48BD3111E7F5DFF7A0F65325, http-session-last-accessed-time=1642331872058, kc-category-name=ACCESS, kc-iat=1642331867, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:51160 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:17:52.064  INFO 16 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:17:52.066  INFO 16 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6ba8ce3b
2022-01-16 11:17:52.066  INFO 16 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6ba8ce3b
2022-01-16 11:17:52.118  INFO 16 --- [https-jsse-nio-7071-exec-9] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18910323166125841-568696, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:31aa3bfa-c095-4f10-a6c7-a9d759a8e54b:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=31aa3bfa-c095-4f10-a6c7-a9d759a8e54b, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time after Shift Start, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:17:52.118  INFO 16 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=7974af58-0d9c-4f14-aec1-f7e8924be917, content=DENY, timestamp=1642331872118, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:31aa3bfa-c095-4f10-a6c7-a9d759a8e54b:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=31aa3bfa-c095-4f10-a6c7-a9d759a8e54b, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time after Shift Start, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:17:52.119  INFO 16 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=53ms, Total=56ms
2022-01-16 11:17:52.135  INFO 16 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=37df4a57-9163-4953-a658-1cff0a4a711b, content=null, timestamp=1642331872129, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=51162, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=22766fcc86b6, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=aafd4250-e6a1-4378-91fb-a2a4ddd87c5e, http-req-server-port=80, http-header-accept=*/*, kc-id=77b9495c-1692-426c-96be-094189073545, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642331872128, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQAB3NxAH4AEQAAAABh4/7bdAAkNzdiOTQ5NWMtMTY5Mi00MjZjLTk2YmUtMDk0MTg5MDczNTQ1dAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRhYWZkNDI1MC1lNmExLTQzNzgtOTFmYi1hMmE0ZGRkODdjNWVwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJhY3dRY1p6TGlENW1hRl85amJINGVRVFplOElvZDdldllhOUk2eDVXWjJnIn0.eyJleHAiOjE2NDIzMzIxNjcsImlhdCI6MTY0MjMzMTg2NywianRpIjoiNzdiOTQ5NWMtMTY5Mi00MjZjLTk2YmUtMDk0MTg5MDczNTQ1IiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiJhYWZkNDI1MC1lNmExLTQzNzgtOTFmYi1hMmE0ZGRkODdjNWUiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.ep3IG5UMcj__1HopMvUFb4xo9nI32gjSZwh03RVYoaim2ExbnEMIikZYIfXlh68pK0CGsTDpWMFgwTbyE98St8icBudSUAJ7fcG3ZJGb84sN9y5pZx7kMMWsBOdB37lSq2eX5SR6l1XgEUB3QxLM6uCgqXfD8yQ7r-ZSC1WitU1NoZ3zGnlrJ4e2aMv_CbLrohDHGwrC2jJJh5Zru_VzRYxTqfIfbMQu6To4QONfTJnbu47lmp8wtTkJIISRnNYAwTUPFWUjm-MHSLlOlOgU9eGKLm6VTM_WxZxFSX5mHs3gbOp_Ou_jDgVNbgzItCK6BCJSXoXfhVOCgNnH_g6F_w, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre/read, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642332167, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.144.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=145C282AA133C3251CD0424A85942FB8, http-session-last-accessed-time=1642331872128, kc-category-name=ACCESS, kc-iat=1642331867, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:51162 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:17:52.135  INFO 16 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:17:52.136  INFO 16 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3fdb0fd3
2022-01-16 11:17:52.136  INFO 16 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3fdb0fd3
2022-01-16 11:17:52.149  INFO 16 --- [https-jsse-nio-7071-exec-10] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18910323236921134-745279, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:31aa3bfa-c095-4f10-a6c7-a9d759a8e54b:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=31aa3bfa-c095-4f10-a6c7-a9d759a8e54b, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time after Shift Start, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:17:52.149  INFO 16 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=37df4a57-9163-4953-a658-1cff0a4a711b, content=DENY, timestamp=1642331872149, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:31aa3bfa-c095-4f10-a6c7-a9d759a8e54b:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=31aa3bfa-c095-4f10-a6c7-a9d759a8e54b, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time after Shift Start, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:17:52.149  INFO 16 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=14ms, Total=16ms
2022-01-16 11:17:52.165  INFO 16 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=98cc3a87-9d77-42a2-88b6-c65863a53333, content=null, timestamp=1642331872160, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=51164, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=22766fcc86b6, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=aafd4250-e6a1-4378-91fb-a2a4ddd87c5e, http-req-server-port=80, http-header-accept=*/*, kc-id=77b9495c-1692-426c-96be-094189073545, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642331872159, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQAB3NxAH4AEQAAAABh4/7bdAAkNzdiOTQ5NWMtMTY5Mi00MjZjLTk2YmUtMDk0MTg5MDczNTQ1dAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRhYWZkNDI1MC1lNmExLTQzNzgtOTFmYi1hMmE0ZGRkODdjNWVwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJhY3dRY1p6TGlENW1hRl85amJINGVRVFplOElvZDdldllhOUk2eDVXWjJnIn0.eyJleHAiOjE2NDIzMzIxNjcsImlhdCI6MTY0MjMzMTg2NywianRpIjoiNzdiOTQ5NWMtMTY5Mi00MjZjLTk2YmUtMDk0MTg5MDczNTQ1IiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiJhYWZkNDI1MC1lNmExLTQzNzgtOTFmYi1hMmE0ZGRkODdjNWUiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.ep3IG5UMcj__1HopMvUFb4xo9nI32gjSZwh03RVYoaim2ExbnEMIikZYIfXlh68pK0CGsTDpWMFgwTbyE98St8icBudSUAJ7fcG3ZJGb84sN9y5pZx7kMMWsBOdB37lSq2eX5SR6l1XgEUB3QxLM6uCgqXfD8yQ7r-ZSC1WitU1NoZ3zGnlrJ4e2aMv_CbLrohDHGwrC2jJJh5Zru_VzRYxTqfIfbMQu6To4QONfTJnbu47lmp8wtTkJIISRnNYAwTUPFWUjm-MHSLlOlOgU9eGKLm6VTM_WxZxFSX5mHs3gbOp_Ou_jDgVNbgzItCK6BCJSXoXfhVOCgNnH_g6F_w, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre/read, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642332167, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.144.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=1F586C0722336081B27C2D2F5671AB6F, http-session-last-accessed-time=1642331872159, kc-category-name=ACCESS, kc-iat=1642331867, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:51164 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:17:52.166  INFO 16 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:17:52.167  INFO 16 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@300c608d
2022-01-16 11:17:52.168  INFO 16 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@300c608d
2022-01-16 11:17:52.181  INFO 16 --- [https-jsse-nio-7071-exec-1] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18910323267974896-79178, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:31aa3bfa-c095-4f10-a6c7-a9d759a8e54b:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=31aa3bfa-c095-4f10-a6c7-a9d759a8e54b, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time after Shift Start, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:17:52.181  INFO 16 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=98cc3a87-9d77-42a2-88b6-c65863a53333, content=DENY, timestamp=1642331872181, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:31aa3bfa-c095-4f10-a6c7-a9d759a8e54b:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=31aa3bfa-c095-4f10-a6c7-a9d759a8e54b, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time after Shift Start, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:17:52.182  INFO 16 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=15ms, Total=18ms
2022-01-16 11:17:52.196  INFO 16 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=10696e2f-9c57-409e-aced-fb58bd9b5f1b, content=null, timestamp=1642331872192, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=51166, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=22766fcc86b6, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=aafd4250-e6a1-4378-91fb-a2a4ddd87c5e, http-req-server-port=80, http-header-accept=*/*, kc-id=77b9495c-1692-426c-96be-094189073545, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642331872190, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQAB3NxAH4AEQAAAABh4/7bdAAkNzdiOTQ5NWMtMTY5Mi00MjZjLTk2YmUtMDk0MTg5MDczNTQ1dAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRhYWZkNDI1MC1lNmExLTQzNzgtOTFmYi1hMmE0ZGRkODdjNWVwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJhY3dRY1p6TGlENW1hRl85amJINGVRVFplOElvZDdldllhOUk2eDVXWjJnIn0.eyJleHAiOjE2NDIzMzIxNjcsImlhdCI6MTY0MjMzMTg2NywianRpIjoiNzdiOTQ5NWMtMTY5Mi00MjZjLTk2YmUtMDk0MTg5MDczNTQ1IiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiJhYWZkNDI1MC1lNmExLTQzNzgtOTFmYi1hMmE0ZGRkODdjNWUiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.ep3IG5UMcj__1HopMvUFb4xo9nI32gjSZwh03RVYoaim2ExbnEMIikZYIfXlh68pK0CGsTDpWMFgwTbyE98St8icBudSUAJ7fcG3ZJGb84sN9y5pZx7kMMWsBOdB37lSq2eX5SR6l1XgEUB3QxLM6uCgqXfD8yQ7r-ZSC1WitU1NoZ3zGnlrJ4e2aMv_CbLrohDHGwrC2jJJh5Zru_VzRYxTqfIfbMQu6To4QONfTJnbu47lmp8wtTkJIISRnNYAwTUPFWUjm-MHSLlOlOgU9eGKLm6VTM_WxZxFSX5mHs3gbOp_Ou_jDgVNbgzItCK6BCJSXoXfhVOCgNnH_g6F_w, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre/read, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642332167, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.144.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=66F585BAC7EBF61B5C18BB7D2F0D1209, http-session-last-accessed-time=1642331872190, kc-category-name=ACCESS, kc-iat=1642331867, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:51166 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:17:52.196  INFO 16 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:17:52.198  INFO 16 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4dae8547
2022-01-16 11:17:52.198  INFO 16 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4dae8547
2022-01-16 11:17:52.250  INFO 16 --- [https-jsse-nio-7071-exec-2] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18910323297788080-726816, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:31aa3bfa-c095-4f10-a6c7-a9d759a8e54b:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=31aa3bfa-c095-4f10-a6c7-a9d759a8e54b, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time after Shift Start, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:17:52.250  INFO 16 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=10696e2f-9c57-409e-aced-fb58bd9b5f1b, content=DENY, timestamp=1642331872250, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:31aa3bfa-c095-4f10-a6c7-a9d759a8e54b:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=31aa3bfa-c095-4f10-a6c7-a9d759a8e54b, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time after Shift Start, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:17:52.251  INFO 16 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=54ms, Total=56ms
2022-01-16 11:17:52.270  INFO 16 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=8fd17197-1a46-49ed-bc55-aed7625e2620, content=null, timestamp=1642331872264, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=51168, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=22766fcc86b6, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=aafd4250-e6a1-4378-91fb-a2a4ddd87c5e, http-req-server-port=80, http-header-accept=*/*, kc-id=77b9495c-1692-426c-96be-094189073545, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642331872262, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQAB3NxAH4AEQAAAABh4/7bdAAkNzdiOTQ5NWMtMTY5Mi00MjZjLTk2YmUtMDk0MTg5MDczNTQ1dAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRhYWZkNDI1MC1lNmExLTQzNzgtOTFmYi1hMmE0ZGRkODdjNWVwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJhY3dRY1p6TGlENW1hRl85amJINGVRVFplOElvZDdldllhOUk2eDVXWjJnIn0.eyJleHAiOjE2NDIzMzIxNjcsImlhdCI6MTY0MjMzMTg2NywianRpIjoiNzdiOTQ5NWMtMTY5Mi00MjZjLTk2YmUtMDk0MTg5MDczNTQ1IiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiJhYWZkNDI1MC1lNmExLTQzNzgtOTFmYi1hMmE0ZGRkODdjNWUiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.ep3IG5UMcj__1HopMvUFb4xo9nI32gjSZwh03RVYoaim2ExbnEMIikZYIfXlh68pK0CGsTDpWMFgwTbyE98St8icBudSUAJ7fcG3ZJGb84sN9y5pZx7kMMWsBOdB37lSq2eX5SR6l1XgEUB3QxLM6uCgqXfD8yQ7r-ZSC1WitU1NoZ3zGnlrJ4e2aMv_CbLrohDHGwrC2jJJh5Zru_VzRYxTqfIfbMQu6To4QONfTJnbu47lmp8wtTkJIISRnNYAwTUPFWUjm-MHSLlOlOgU9eGKLm6VTM_WxZxFSX5mHs3gbOp_Ou_jDgVNbgzItCK6BCJSXoXfhVOCgNnH_g6F_w, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre/read, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642332167, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.144.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=79EDB4498FAC4831D4F8EC4DDF61A7D4, http-session-last-accessed-time=1642331872262, kc-category-name=ACCESS, kc-iat=1642331867, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:51168 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:17:52.271  INFO 16 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:17:52.272  INFO 16 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2d107efb
2022-01-16 11:17:52.272  INFO 16 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2d107efb
2022-01-16 11:17:52.284  INFO 16 --- [https-jsse-nio-7071-exec-3] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18910323372793538-840373, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:31aa3bfa-c095-4f10-a6c7-a9d759a8e54b:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=31aa3bfa-c095-4f10-a6c7-a9d759a8e54b, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time after Shift Start, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:17:52.284  INFO 16 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=8fd17197-1a46-49ed-bc55-aed7625e2620, content=DENY, timestamp=1642331872284, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:31aa3bfa-c095-4f10-a6c7-a9d759a8e54b:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=31aa3bfa-c095-4f10-a6c7-a9d759a8e54b, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time after Shift Start, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:17:52.285  INFO 16 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=13ms, Total=17ms
2022-01-16 11:17:52.303  INFO 16 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=3e581b6d-cdfe-4434-818b-89d34bc8a8dd, content=null, timestamp=1642331872296, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=51170, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=22766fcc86b6, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=aafd4250-e6a1-4378-91fb-a2a4ddd87c5e, http-req-server-port=80, http-header-accept=*/*, kc-id=77b9495c-1692-426c-96be-094189073545, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642331872295, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQAB3NxAH4AEQAAAABh4/7bdAAkNzdiOTQ5NWMtMTY5Mi00MjZjLTk2YmUtMDk0MTg5MDczNTQ1dAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRhYWZkNDI1MC1lNmExLTQzNzgtOTFmYi1hMmE0ZGRkODdjNWVwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJhY3dRY1p6TGlENW1hRl85amJINGVRVFplOElvZDdldllhOUk2eDVXWjJnIn0.eyJleHAiOjE2NDIzMzIxNjcsImlhdCI6MTY0MjMzMTg2NywianRpIjoiNzdiOTQ5NWMtMTY5Mi00MjZjLTk2YmUtMDk0MTg5MDczNTQ1IiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiJhYWZkNDI1MC1lNmExLTQzNzgtOTFmYi1hMmE0ZGRkODdjNWUiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.ep3IG5UMcj__1HopMvUFb4xo9nI32gjSZwh03RVYoaim2ExbnEMIikZYIfXlh68pK0CGsTDpWMFgwTbyE98St8icBudSUAJ7fcG3ZJGb84sN9y5pZx7kMMWsBOdB37lSq2eX5SR6l1XgEUB3QxLM6uCgqXfD8yQ7r-ZSC1WitU1NoZ3zGnlrJ4e2aMv_CbLrohDHGwrC2jJJh5Zru_VzRYxTqfIfbMQu6To4QONfTJnbu47lmp8wtTkJIISRnNYAwTUPFWUjm-MHSLlOlOgU9eGKLm6VTM_WxZxFSX5mHs3gbOp_Ou_jDgVNbgzItCK6BCJSXoXfhVOCgNnH_g6F_w, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre/read, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642332167, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.144.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=ADC832F1542DB5CF9ECD432F00D14B32, http-session-last-accessed-time=1642331872295, kc-category-name=ACCESS, kc-iat=1642331867, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:51170 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:17:52.304  INFO 16 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:17:52.305  INFO 16 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6e7c2e6f
2022-01-16 11:17:52.306  INFO 16 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6e7c2e6f
2022-01-16 11:17:52.320  INFO 16 --- [https-jsse-nio-7071-exec-4] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18910323406209314-69467, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:31aa3bfa-c095-4f10-a6c7-a9d759a8e54b:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=31aa3bfa-c095-4f10-a6c7-a9d759a8e54b, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time after Shift Start, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:17:52.321  INFO 16 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=3e581b6d-cdfe-4434-818b-89d34bc8a8dd, content=DENY, timestamp=1642331872321, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:31aa3bfa-c095-4f10-a6c7-a9d759a8e54b:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=31aa3bfa-c095-4f10-a6c7-a9d759a8e54b, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time after Shift Start, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:17:52.323  INFO 16 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=16ms, Total=22ms
2022-01-16 11:17:52.341  INFO 16 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=22d4c50c-a87d-4803-8b0f-2d5f55ceb40d, content=null, timestamp=1642331872332, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=51172, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=22766fcc86b6, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=aafd4250-e6a1-4378-91fb-a2a4ddd87c5e, http-req-server-port=80, http-header-accept=*/*, kc-id=77b9495c-1692-426c-96be-094189073545, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642331872331, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQAB3NxAH4AEQAAAABh4/7bdAAkNzdiOTQ5NWMtMTY5Mi00MjZjLTk2YmUtMDk0MTg5MDczNTQ1dAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRhYWZkNDI1MC1lNmExLTQzNzgtOTFmYi1hMmE0ZGRkODdjNWVwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJhY3dRY1p6TGlENW1hRl85amJINGVRVFplOElvZDdldllhOUk2eDVXWjJnIn0.eyJleHAiOjE2NDIzMzIxNjcsImlhdCI6MTY0MjMzMTg2NywianRpIjoiNzdiOTQ5NWMtMTY5Mi00MjZjLTk2YmUtMDk0MTg5MDczNTQ1IiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiJhYWZkNDI1MC1lNmExLTQzNzgtOTFmYi1hMmE0ZGRkODdjNWUiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.ep3IG5UMcj__1HopMvUFb4xo9nI32gjSZwh03RVYoaim2ExbnEMIikZYIfXlh68pK0CGsTDpWMFgwTbyE98St8icBudSUAJ7fcG3ZJGb84sN9y5pZx7kMMWsBOdB37lSq2eX5SR6l1XgEUB3QxLM6uCgqXfD8yQ7r-ZSC1WitU1NoZ3zGnlrJ4e2aMv_CbLrohDHGwrC2jJJh5Zru_VzRYxTqfIfbMQu6To4QONfTJnbu47lmp8wtTkJIISRnNYAwTUPFWUjm-MHSLlOlOgU9eGKLm6VTM_WxZxFSX5mHs3gbOp_Ou_jDgVNbgzItCK6BCJSXoXfhVOCgNnH_g6F_w, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre/read, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642332167, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.144.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=2E9BCCB8A58A902ED14BB03F5EE3E57D, http-session-last-accessed-time=1642331872331, kc-category-name=ACCESS, kc-iat=1642331867, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:51172 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:17:52.343  INFO 16 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:17:52.344  INFO 16 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7ade2421
2022-01-16 11:17:52.350  INFO 16 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7ade2421
2022-01-16 11:17:52.402  INFO 16 --- [https-jsse-nio-7071-exec-5] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18910323445250978-502705, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:31aa3bfa-c095-4f10-a6c7-a9d759a8e54b:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=31aa3bfa-c095-4f10-a6c7-a9d759a8e54b, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time after Shift Start, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:17:52.403  INFO 16 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=22d4c50c-a87d-4803-8b0f-2d5f55ceb40d, content=DENY, timestamp=1642331872403, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:31aa3bfa-c095-4f10-a6c7-a9d759a8e54b:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=31aa3bfa-c095-4f10-a6c7-a9d759a8e54b, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time after Shift Start, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:17:52.404  INFO 16 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=59ms, Total=64ms
2022-01-16 11:17:52.422  INFO 16 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=0c2aed7f-8705-4c1c-82f2-129d082e4a88, content=null, timestamp=1642331872417, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=51174, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=22766fcc86b6, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=aafd4250-e6a1-4378-91fb-a2a4ddd87c5e, http-req-server-port=80, http-header-accept=*/*, kc-id=77b9495c-1692-426c-96be-094189073545, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642331872416, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQAB3NxAH4AEQAAAABh4/7bdAAkNzdiOTQ5NWMtMTY5Mi00MjZjLTk2YmUtMDk0MTg5MDczNTQ1dAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRhYWZkNDI1MC1lNmExLTQzNzgtOTFmYi1hMmE0ZGRkODdjNWVwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJhY3dRY1p6TGlENW1hRl85amJINGVRVFplOElvZDdldllhOUk2eDVXWjJnIn0.eyJleHAiOjE2NDIzMzIxNjcsImlhdCI6MTY0MjMzMTg2NywianRpIjoiNzdiOTQ5NWMtMTY5Mi00MjZjLTk2YmUtMDk0MTg5MDczNTQ1IiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiJhYWZkNDI1MC1lNmExLTQzNzgtOTFmYi1hMmE0ZGRkODdjNWUiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.ep3IG5UMcj__1HopMvUFb4xo9nI32gjSZwh03RVYoaim2ExbnEMIikZYIfXlh68pK0CGsTDpWMFgwTbyE98St8icBudSUAJ7fcG3ZJGb84sN9y5pZx7kMMWsBOdB37lSq2eX5SR6l1XgEUB3QxLM6uCgqXfD8yQ7r-ZSC1WitU1NoZ3zGnlrJ4e2aMv_CbLrohDHGwrC2jJJh5Zru_VzRYxTqfIfbMQu6To4QONfTJnbu47lmp8wtTkJIISRnNYAwTUPFWUjm-MHSLlOlOgU9eGKLm6VTM_WxZxFSX5mHs3gbOp_Ou_jDgVNbgzItCK6BCJSXoXfhVOCgNnH_g6F_w, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre/read, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642332167, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.144.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=E3B51C0605DD9FC19A70DAD8EDC102DE, http-session-last-accessed-time=1642331872416, kc-category-name=ACCESS, kc-iat=1642331867, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:51174 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:17:52.423  INFO 16 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:17:52.424  INFO 16 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@57947bb2
2022-01-16 11:17:52.424  INFO 16 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@57947bb2
2022-01-16 11:17:52.436  INFO 16 --- [https-jsse-nio-7071-exec-6] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18910323524482163-24558, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:31aa3bfa-c095-4f10-a6c7-a9d759a8e54b:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=31aa3bfa-c095-4f10-a6c7-a9d759a8e54b, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time after Shift Start, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:17:52.436  INFO 16 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=0c2aed7f-8705-4c1c-82f2-129d082e4a88, content=DENY, timestamp=1642331872436, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:31aa3bfa-c095-4f10-a6c7-a9d759a8e54b:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=31aa3bfa-c095-4f10-a6c7-a9d759a8e54b, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time after Shift Start, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:17:52.436  INFO 16 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=13ms, Total=15ms
2022-01-16 11:17:52.460  INFO 16 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=df4f8a9c-d1fe-4f17-8b29-36964e5392b5, content=null, timestamp=1642331872453, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=51176, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=22766fcc86b6, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=aafd4250-e6a1-4378-91fb-a2a4ddd87c5e, http-req-server-port=80, http-header-accept=*/*, kc-id=77b9495c-1692-426c-96be-094189073545, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642331872448, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQAB3NxAH4AEQAAAABh4/7bdAAkNzdiOTQ5NWMtMTY5Mi00MjZjLTk2YmUtMDk0MTg5MDczNTQ1dAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRhYWZkNDI1MC1lNmExLTQzNzgtOTFmYi1hMmE0ZGRkODdjNWVwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJhY3dRY1p6TGlENW1hRl85amJINGVRVFplOElvZDdldllhOUk2eDVXWjJnIn0.eyJleHAiOjE2NDIzMzIxNjcsImlhdCI6MTY0MjMzMTg2NywianRpIjoiNzdiOTQ5NWMtMTY5Mi00MjZjLTk2YmUtMDk0MTg5MDczNTQ1IiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiJhYWZkNDI1MC1lNmExLTQzNzgtOTFmYi1hMmE0ZGRkODdjNWUiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.ep3IG5UMcj__1HopMvUFb4xo9nI32gjSZwh03RVYoaim2ExbnEMIikZYIfXlh68pK0CGsTDpWMFgwTbyE98St8icBudSUAJ7fcG3ZJGb84sN9y5pZx7kMMWsBOdB37lSq2eX5SR6l1XgEUB3QxLM6uCgqXfD8yQ7r-ZSC1WitU1NoZ3zGnlrJ4e2aMv_CbLrohDHGwrC2jJJh5Zru_VzRYxTqfIfbMQu6To4QONfTJnbu47lmp8wtTkJIISRnNYAwTUPFWUjm-MHSLlOlOgU9eGKLm6VTM_WxZxFSX5mHs3gbOp_Ou_jDgVNbgzItCK6BCJSXoXfhVOCgNnH_g6F_w, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre/read, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642332167, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.144.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=C179F1E49B157115863B33008E90AEB8, http-session-last-accessed-time=1642331872448, kc-category-name=ACCESS, kc-iat=1642331867, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:51176 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:17:52.462  INFO 16 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:17:52.462  INFO 16 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1fb8d134
2022-01-16 11:17:52.463  INFO 16 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1fb8d134
2022-01-16 11:17:52.475  INFO 16 --- [https-jsse-nio-7071-exec-7] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18910323563279252-488270, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:31aa3bfa-c095-4f10-a6c7-a9d759a8e54b:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=31aa3bfa-c095-4f10-a6c7-a9d759a8e54b, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time after Shift Start, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:17:52.475  INFO 16 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=df4f8a9c-d1fe-4f17-8b29-36964e5392b5, content=DENY, timestamp=1642331872475, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:31aa3bfa-c095-4f10-a6c7-a9d759a8e54b:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=31aa3bfa-c095-4f10-a6c7-a9d759a8e54b, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time after Shift Start, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:17:52.476  INFO 16 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=13ms, Total=17ms
2022-01-16 11:17:52.493  INFO 16 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=1834bdb1-8993-4440-aa0c-67e8805b409e, content=null, timestamp=1642331872488, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=51178, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=22766fcc86b6, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=aafd4250-e6a1-4378-91fb-a2a4ddd87c5e, http-req-server-port=80, http-header-accept=*/*, kc-id=77b9495c-1692-426c-96be-094189073545, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642331872487, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQAB3NxAH4AEQAAAABh4/7bdAAkNzdiOTQ5NWMtMTY5Mi00MjZjLTk2YmUtMDk0MTg5MDczNTQ1dAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRhYWZkNDI1MC1lNmExLTQzNzgtOTFmYi1hMmE0ZGRkODdjNWVwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJhY3dRY1p6TGlENW1hRl85amJINGVRVFplOElvZDdldllhOUk2eDVXWjJnIn0.eyJleHAiOjE2NDIzMzIxNjcsImlhdCI6MTY0MjMzMTg2NywianRpIjoiNzdiOTQ5NWMtMTY5Mi00MjZjLTk2YmUtMDk0MTg5MDczNTQ1IiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiJhYWZkNDI1MC1lNmExLTQzNzgtOTFmYi1hMmE0ZGRkODdjNWUiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.ep3IG5UMcj__1HopMvUFb4xo9nI32gjSZwh03RVYoaim2ExbnEMIikZYIfXlh68pK0CGsTDpWMFgwTbyE98St8icBudSUAJ7fcG3ZJGb84sN9y5pZx7kMMWsBOdB37lSq2eX5SR6l1XgEUB3QxLM6uCgqXfD8yQ7r-ZSC1WitU1NoZ3zGnlrJ4e2aMv_CbLrohDHGwrC2jJJh5Zru_VzRYxTqfIfbMQu6To4QONfTJnbu47lmp8wtTkJIISRnNYAwTUPFWUjm-MHSLlOlOgU9eGKLm6VTM_WxZxFSX5mHs3gbOp_Ou_jDgVNbgzItCK6BCJSXoXfhVOCgNnH_g6F_w, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre/read, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642332167, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.144.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=3F8322590F878539033554FBA3AF558D, http-session-last-accessed-time=1642331872487, kc-category-name=ACCESS, kc-iat=1642331867, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:51178 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:17:52.493  INFO 16 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:17:52.495  INFO 16 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5c454bb7
2022-01-16 11:17:52.495  INFO 16 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5c454bb7
2022-01-16 11:17:52.551  INFO 16 --- [https-jsse-nio-7071-exec-8] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18910323595022810-155822, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:31aa3bfa-c095-4f10-a6c7-a9d759a8e54b:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=31aa3bfa-c095-4f10-a6c7-a9d759a8e54b, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time after Shift Start, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:17:52.551  INFO 16 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=1834bdb1-8993-4440-aa0c-67e8805b409e, content=DENY, timestamp=1642331872551, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:31aa3bfa-c095-4f10-a6c7-a9d759a8e54b:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=31aa3bfa-c095-4f10-a6c7-a9d759a8e54b, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time after Shift Start, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:17:52.552  INFO 16 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=57ms, Total=61ms
2022-01-16 11:17:52.570  INFO 16 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=a96733a1-ff19-4907-9c68-69661c48879e, content=null, timestamp=1642331872564, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=51180, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=22766fcc86b6, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=aafd4250-e6a1-4378-91fb-a2a4ddd87c5e, http-req-server-port=80, http-header-accept=*/*, kc-id=77b9495c-1692-426c-96be-094189073545, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642331872562, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQAB3NxAH4AEQAAAABh4/7bdAAkNzdiOTQ5NWMtMTY5Mi00MjZjLTk2YmUtMDk0MTg5MDczNTQ1dAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRhYWZkNDI1MC1lNmExLTQzNzgtOTFmYi1hMmE0ZGRkODdjNWVwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJhY3dRY1p6TGlENW1hRl85amJINGVRVFplOElvZDdldllhOUk2eDVXWjJnIn0.eyJleHAiOjE2NDIzMzIxNjcsImlhdCI6MTY0MjMzMTg2NywianRpIjoiNzdiOTQ5NWMtMTY5Mi00MjZjLTk2YmUtMDk0MTg5MDczNTQ1IiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiJhYWZkNDI1MC1lNmExLTQzNzgtOTFmYi1hMmE0ZGRkODdjNWUiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.ep3IG5UMcj__1HopMvUFb4xo9nI32gjSZwh03RVYoaim2ExbnEMIikZYIfXlh68pK0CGsTDpWMFgwTbyE98St8icBudSUAJ7fcG3ZJGb84sN9y5pZx7kMMWsBOdB37lSq2eX5SR6l1XgEUB3QxLM6uCgqXfD8yQ7r-ZSC1WitU1NoZ3zGnlrJ4e2aMv_CbLrohDHGwrC2jJJh5Zru_VzRYxTqfIfbMQu6To4QONfTJnbu47lmp8wtTkJIISRnNYAwTUPFWUjm-MHSLlOlOgU9eGKLm6VTM_WxZxFSX5mHs3gbOp_Ou_jDgVNbgzItCK6BCJSXoXfhVOCgNnH_g6F_w, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre/read, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642332167, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.144.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=D756468B812F3B9A50E02E08CAA22E30, http-session-last-accessed-time=1642331872562, kc-category-name=ACCESS, kc-iat=1642331867, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:51180 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:17:52.570  INFO 16 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:17:52.571  INFO 16 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@465de51
2022-01-16 11:17:52.572  INFO 16 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@465de51
2022-01-16 11:17:52.583  INFO 16 --- [https-jsse-nio-7071-exec-9] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18910323672209234-654021, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:31aa3bfa-c095-4f10-a6c7-a9d759a8e54b:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=31aa3bfa-c095-4f10-a6c7-a9d759a8e54b, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time after Shift Start, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:17:52.584  INFO 16 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=a96733a1-ff19-4907-9c68-69661c48879e, content=DENY, timestamp=1642331872584, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:31aa3bfa-c095-4f10-a6c7-a9d759a8e54b:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=31aa3bfa-c095-4f10-a6c7-a9d759a8e54b, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time after Shift Start, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:17:52.584  INFO 16 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=13ms, Total=16ms
2022-01-16 11:17:52.611  INFO 16 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=1cee67af-8d2a-4c49-ab0e-09d8d83bf758, content=null, timestamp=1642331872604, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=51182, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=22766fcc86b6, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=aafd4250-e6a1-4378-91fb-a2a4ddd87c5e, http-req-server-port=80, http-header-accept=*/*, kc-id=77b9495c-1692-426c-96be-094189073545, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642331872601, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQAB3NxAH4AEQAAAABh4/7bdAAkNzdiOTQ5NWMtMTY5Mi00MjZjLTk2YmUtMDk0MTg5MDczNTQ1dAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRhYWZkNDI1MC1lNmExLTQzNzgtOTFmYi1hMmE0ZGRkODdjNWVwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJhY3dRY1p6TGlENW1hRl85amJINGVRVFplOElvZDdldllhOUk2eDVXWjJnIn0.eyJleHAiOjE2NDIzMzIxNjcsImlhdCI6MTY0MjMzMTg2NywianRpIjoiNzdiOTQ5NWMtMTY5Mi00MjZjLTk2YmUtMDk0MTg5MDczNTQ1IiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiJhYWZkNDI1MC1lNmExLTQzNzgtOTFmYi1hMmE0ZGRkODdjNWUiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.ep3IG5UMcj__1HopMvUFb4xo9nI32gjSZwh03RVYoaim2ExbnEMIikZYIfXlh68pK0CGsTDpWMFgwTbyE98St8icBudSUAJ7fcG3ZJGb84sN9y5pZx7kMMWsBOdB37lSq2eX5SR6l1XgEUB3QxLM6uCgqXfD8yQ7r-ZSC1WitU1NoZ3zGnlrJ4e2aMv_CbLrohDHGwrC2jJJh5Zru_VzRYxTqfIfbMQu6To4QONfTJnbu47lmp8wtTkJIISRnNYAwTUPFWUjm-MHSLlOlOgU9eGKLm6VTM_WxZxFSX5mHs3gbOp_Ou_jDgVNbgzItCK6BCJSXoXfhVOCgNnH_g6F_w, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre/read, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642332167, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.144.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=08C3014C5C7EE045922DE7432A9904CD, http-session-last-accessed-time=1642331872601, kc-category-name=ACCESS, kc-iat=1642331867, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:51182 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:17:52.612  INFO 16 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:17:52.613  INFO 16 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1528a740
2022-01-16 11:17:52.613  INFO 16 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1528a740
2022-01-16 11:17:52.625  INFO 16 --- [https-jsse-nio-7071-exec-10] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18910323713935626-740635, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:31aa3bfa-c095-4f10-a6c7-a9d759a8e54b:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=31aa3bfa-c095-4f10-a6c7-a9d759a8e54b, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time after Shift Start, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:17:52.626  INFO 16 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=1cee67af-8d2a-4c49-ab0e-09d8d83bf758, content=DENY, timestamp=1642331872626, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:31aa3bfa-c095-4f10-a6c7-a9d759a8e54b:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=31aa3bfa-c095-4f10-a6c7-a9d759a8e54b, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time after Shift Start, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:17:52.626  INFO 16 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=14ms, Total=16ms
2022-01-16 11:17:52.644  INFO 16 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=1e52e34e-acd8-4cdd-a039-ddb78d05c615, content=null, timestamp=1642331872638, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=51184, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=22766fcc86b6, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=aafd4250-e6a1-4378-91fb-a2a4ddd87c5e, http-req-server-port=80, http-header-accept=*/*, kc-id=77b9495c-1692-426c-96be-094189073545, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642331872636, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQAB3NxAH4AEQAAAABh4/7bdAAkNzdiOTQ5NWMtMTY5Mi00MjZjLTk2YmUtMDk0MTg5MDczNTQ1dAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRhYWZkNDI1MC1lNmExLTQzNzgtOTFmYi1hMmE0ZGRkODdjNWVwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJhY3dRY1p6TGlENW1hRl85amJINGVRVFplOElvZDdldllhOUk2eDVXWjJnIn0.eyJleHAiOjE2NDIzMzIxNjcsImlhdCI6MTY0MjMzMTg2NywianRpIjoiNzdiOTQ5NWMtMTY5Mi00MjZjLTk2YmUtMDk0MTg5MDczNTQ1IiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiJhYWZkNDI1MC1lNmExLTQzNzgtOTFmYi1hMmE0ZGRkODdjNWUiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.ep3IG5UMcj__1HopMvUFb4xo9nI32gjSZwh03RVYoaim2ExbnEMIikZYIfXlh68pK0CGsTDpWMFgwTbyE98St8icBudSUAJ7fcG3ZJGb84sN9y5pZx7kMMWsBOdB37lSq2eX5SR6l1XgEUB3QxLM6uCgqXfD8yQ7r-ZSC1WitU1NoZ3zGnlrJ4e2aMv_CbLrohDHGwrC2jJJh5Zru_VzRYxTqfIfbMQu6To4QONfTJnbu47lmp8wtTkJIISRnNYAwTUPFWUjm-MHSLlOlOgU9eGKLm6VTM_WxZxFSX5mHs3gbOp_Ou_jDgVNbgzItCK6BCJSXoXfhVOCgNnH_g6F_w, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre/read, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642332167, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.144.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=37F64A910C2BC65B902426F723A94FD8, http-session-last-accessed-time=1642331872636, kc-category-name=ACCESS, kc-iat=1642331867, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:51184 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:17:52.644  INFO 16 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:17:52.645  INFO 16 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1e4099ab
2022-01-16 11:17:52.646  INFO 16 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1e4099ab
2022-01-16 11:17:52.699  INFO 16 --- [https-jsse-nio-7071-exec-1] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18910323745629542-833855, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:31aa3bfa-c095-4f10-a6c7-a9d759a8e54b:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=31aa3bfa-c095-4f10-a6c7-a9d759a8e54b, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time after Shift Start, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:17:52.699  INFO 16 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=1e52e34e-acd8-4cdd-a039-ddb78d05c615, content=DENY, timestamp=1642331872699, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:31aa3bfa-c095-4f10-a6c7-a9d759a8e54b:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=31aa3bfa-c095-4f10-a6c7-a9d759a8e54b, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time after Shift Start, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:17:52.700  INFO 16 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=55ms, Total=57ms
2022-01-16 11:17:52.722  INFO 16 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=cd09ecff-4b6b-4281-9faf-b59a8ab506c6, content=null, timestamp=1642331872717, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=51186, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=22766fcc86b6, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=aafd4250-e6a1-4378-91fb-a2a4ddd87c5e, http-req-server-port=80, http-header-accept=*/*, kc-id=77b9495c-1692-426c-96be-094189073545, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642331872714, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQAB3NxAH4AEQAAAABh4/7bdAAkNzdiOTQ5NWMtMTY5Mi00MjZjLTk2YmUtMDk0MTg5MDczNTQ1dAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRhYWZkNDI1MC1lNmExLTQzNzgtOTFmYi1hMmE0ZGRkODdjNWVwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJhY3dRY1p6TGlENW1hRl85amJINGVRVFplOElvZDdldllhOUk2eDVXWjJnIn0.eyJleHAiOjE2NDIzMzIxNjcsImlhdCI6MTY0MjMzMTg2NywianRpIjoiNzdiOTQ5NWMtMTY5Mi00MjZjLTk2YmUtMDk0MTg5MDczNTQ1IiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiJhYWZkNDI1MC1lNmExLTQzNzgtOTFmYi1hMmE0ZGRkODdjNWUiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.ep3IG5UMcj__1HopMvUFb4xo9nI32gjSZwh03RVYoaim2ExbnEMIikZYIfXlh68pK0CGsTDpWMFgwTbyE98St8icBudSUAJ7fcG3ZJGb84sN9y5pZx7kMMWsBOdB37lSq2eX5SR6l1XgEUB3QxLM6uCgqXfD8yQ7r-ZSC1WitU1NoZ3zGnlrJ4e2aMv_CbLrohDHGwrC2jJJh5Zru_VzRYxTqfIfbMQu6To4QONfTJnbu47lmp8wtTkJIISRnNYAwTUPFWUjm-MHSLlOlOgU9eGKLm6VTM_WxZxFSX5mHs3gbOp_Ou_jDgVNbgzItCK6BCJSXoXfhVOCgNnH_g6F_w, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre/read, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642332167, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.144.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=FA94E0FC3038FD2EEB0DCE830BD24B2E, http-session-last-accessed-time=1642331872714, kc-category-name=ACCESS, kc-iat=1642331867, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:51186 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:17:52.722  INFO 16 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:17:52.724  INFO 16 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@746b61a8
2022-01-16 11:17:52.724  INFO 16 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@746b61a8
2022-01-16 11:17:52.735  INFO 16 --- [https-jsse-nio-7071-exec-2] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18910323823978943-309406, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:31aa3bfa-c095-4f10-a6c7-a9d759a8e54b:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=31aa3bfa-c095-4f10-a6c7-a9d759a8e54b, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time after Shift Start, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:17:52.735  INFO 16 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=cd09ecff-4b6b-4281-9faf-b59a8ab506c6, content=DENY, timestamp=1642331872735, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:31aa3bfa-c095-4f10-a6c7-a9d759a8e54b:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=31aa3bfa-c095-4f10-a6c7-a9d759a8e54b, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time after Shift Start, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:17:52.736  INFO 16 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=13ms, Total=15ms
2022-01-16 11:17:52.751  INFO 16 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=d3caf561-a371-4b2d-855d-661009d2e7e2, content=null, timestamp=1642331872745, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=51188, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=22766fcc86b6, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=aafd4250-e6a1-4378-91fb-a2a4ddd87c5e, http-req-server-port=80, http-header-accept=*/*, kc-id=77b9495c-1692-426c-96be-094189073545, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642331872744, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQAB3NxAH4AEQAAAABh4/7bdAAkNzdiOTQ5NWMtMTY5Mi00MjZjLTk2YmUtMDk0MTg5MDczNTQ1dAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRhYWZkNDI1MC1lNmExLTQzNzgtOTFmYi1hMmE0ZGRkODdjNWVwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJhY3dRY1p6TGlENW1hRl85amJINGVRVFplOElvZDdldllhOUk2eDVXWjJnIn0.eyJleHAiOjE2NDIzMzIxNjcsImlhdCI6MTY0MjMzMTg2NywianRpIjoiNzdiOTQ5NWMtMTY5Mi00MjZjLTk2YmUtMDk0MTg5MDczNTQ1IiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiJhYWZkNDI1MC1lNmExLTQzNzgtOTFmYi1hMmE0ZGRkODdjNWUiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.ep3IG5UMcj__1HopMvUFb4xo9nI32gjSZwh03RVYoaim2ExbnEMIikZYIfXlh68pK0CGsTDpWMFgwTbyE98St8icBudSUAJ7fcG3ZJGb84sN9y5pZx7kMMWsBOdB37lSq2eX5SR6l1XgEUB3QxLM6uCgqXfD8yQ7r-ZSC1WitU1NoZ3zGnlrJ4e2aMv_CbLrohDHGwrC2jJJh5Zru_VzRYxTqfIfbMQu6To4QONfTJnbu47lmp8wtTkJIISRnNYAwTUPFWUjm-MHSLlOlOgU9eGKLm6VTM_WxZxFSX5mHs3gbOp_Ou_jDgVNbgzItCK6BCJSXoXfhVOCgNnH_g6F_w, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre/read, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642332167, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.144.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=864423FD099D7C7573B6266F31087B49, http-session-last-accessed-time=1642331872744, kc-category-name=ACCESS, kc-iat=1642331867, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:51188 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:17:52.751  INFO 16 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:17:52.752  INFO 16 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1bab98f5
2022-01-16 11:17:52.752  INFO 16 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1bab98f5
2022-01-16 11:17:52.763  INFO 16 --- [https-jsse-nio-7071-exec-2] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18910323852942406-168330, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:31aa3bfa-c095-4f10-a6c7-a9d759a8e54b:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=31aa3bfa-c095-4f10-a6c7-a9d759a8e54b, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time after Shift Start, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:17:52.763  INFO 16 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=d3caf561-a371-4b2d-855d-661009d2e7e2, content=DENY, timestamp=1642331872763, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:31aa3bfa-c095-4f10-a6c7-a9d759a8e54b:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=31aa3bfa-c095-4f10-a6c7-a9d759a8e54b, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time after Shift Start, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:17:52.764  INFO 16 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=12ms, Total=14ms
2022-01-16 11:17:52.779  INFO 16 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=fdf320bb-fcc8-48ec-802e-2526fd405dd9, content=null, timestamp=1642331872774, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=51190, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=22766fcc86b6, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=aafd4250-e6a1-4378-91fb-a2a4ddd87c5e, http-req-server-port=80, http-header-accept=*/*, kc-id=77b9495c-1692-426c-96be-094189073545, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642331872773, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQAB3NxAH4AEQAAAABh4/7bdAAkNzdiOTQ5NWMtMTY5Mi00MjZjLTk2YmUtMDk0MTg5MDczNTQ1dAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRhYWZkNDI1MC1lNmExLTQzNzgtOTFmYi1hMmE0ZGRkODdjNWVwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJhY3dRY1p6TGlENW1hRl85amJINGVRVFplOElvZDdldllhOUk2eDVXWjJnIn0.eyJleHAiOjE2NDIzMzIxNjcsImlhdCI6MTY0MjMzMTg2NywianRpIjoiNzdiOTQ5NWMtMTY5Mi00MjZjLTk2YmUtMDk0MTg5MDczNTQ1IiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiJhYWZkNDI1MC1lNmExLTQzNzgtOTFmYi1hMmE0ZGRkODdjNWUiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.ep3IG5UMcj__1HopMvUFb4xo9nI32gjSZwh03RVYoaim2ExbnEMIikZYIfXlh68pK0CGsTDpWMFgwTbyE98St8icBudSUAJ7fcG3ZJGb84sN9y5pZx7kMMWsBOdB37lSq2eX5SR6l1XgEUB3QxLM6uCgqXfD8yQ7r-ZSC1WitU1NoZ3zGnlrJ4e2aMv_CbLrohDHGwrC2jJJh5Zru_VzRYxTqfIfbMQu6To4QONfTJnbu47lmp8wtTkJIISRnNYAwTUPFWUjm-MHSLlOlOgU9eGKLm6VTM_WxZxFSX5mHs3gbOp_Ou_jDgVNbgzItCK6BCJSXoXfhVOCgNnH_g6F_w, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre/read, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642332167, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.144.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=D0C5BBACF9963F8993D759816C051F29, http-session-last-accessed-time=1642331872773, kc-category-name=ACCESS, kc-iat=1642331867, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:51190 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:17:52.781  INFO 16 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:17:52.782  INFO 16 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4ff0aedb
2022-01-16 11:17:52.782  INFO 16 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4ff0aedb
2022-01-16 11:17:52.842  INFO 16 --- [https-jsse-nio-7071-exec-3] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18910323882685859-542279, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:31aa3bfa-c095-4f10-a6c7-a9d759a8e54b:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=31aa3bfa-c095-4f10-a6c7-a9d759a8e54b, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time after Shift Start, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:17:52.843  INFO 16 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=fdf320bb-fcc8-48ec-802e-2526fd405dd9, content=DENY, timestamp=1642331872843, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:31aa3bfa-c095-4f10-a6c7-a9d759a8e54b:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=31aa3bfa-c095-4f10-a6c7-a9d759a8e54b, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time after Shift Start, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:17:52.843  INFO 16 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=62ms, Total=65ms
2022-01-16 11:17:52.864  INFO 16 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=05c4a130-b95c-4b02-99a4-0787a34b71e7, content=null, timestamp=1642331872857, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=51192, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=22766fcc86b6, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=aafd4250-e6a1-4378-91fb-a2a4ddd87c5e, http-req-server-port=80, http-header-accept=*/*, kc-id=77b9495c-1692-426c-96be-094189073545, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642331872856, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQAB3NxAH4AEQAAAABh4/7bdAAkNzdiOTQ5NWMtMTY5Mi00MjZjLTk2YmUtMDk0MTg5MDczNTQ1dAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRhYWZkNDI1MC1lNmExLTQzNzgtOTFmYi1hMmE0ZGRkODdjNWVwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJhY3dRY1p6TGlENW1hRl85amJINGVRVFplOElvZDdldllhOUk2eDVXWjJnIn0.eyJleHAiOjE2NDIzMzIxNjcsImlhdCI6MTY0MjMzMTg2NywianRpIjoiNzdiOTQ5NWMtMTY5Mi00MjZjLTk2YmUtMDk0MTg5MDczNTQ1IiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiJhYWZkNDI1MC1lNmExLTQzNzgtOTFmYi1hMmE0ZGRkODdjNWUiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.ep3IG5UMcj__1HopMvUFb4xo9nI32gjSZwh03RVYoaim2ExbnEMIikZYIfXlh68pK0CGsTDpWMFgwTbyE98St8icBudSUAJ7fcG3ZJGb84sN9y5pZx7kMMWsBOdB37lSq2eX5SR6l1XgEUB3QxLM6uCgqXfD8yQ7r-ZSC1WitU1NoZ3zGnlrJ4e2aMv_CbLrohDHGwrC2jJJh5Zru_VzRYxTqfIfbMQu6To4QONfTJnbu47lmp8wtTkJIISRnNYAwTUPFWUjm-MHSLlOlOgU9eGKLm6VTM_WxZxFSX5mHs3gbOp_Ou_jDgVNbgzItCK6BCJSXoXfhVOCgNnH_g6F_w, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre/read, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642332167, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.144.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=21019CD5DED90BD5BB6617299C8B663B, http-session-last-accessed-time=1642331872856, kc-category-name=ACCESS, kc-iat=1642331867, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:51192 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:17:52.864  INFO 16 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:17:52.866  INFO 16 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5f5827c1
2022-01-16 11:17:52.866  INFO 16 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5f5827c1
2022-01-16 11:17:52.878  INFO 16 --- [https-jsse-nio-7071-exec-4] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18910323966430148-748668, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:31aa3bfa-c095-4f10-a6c7-a9d759a8e54b:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=31aa3bfa-c095-4f10-a6c7-a9d759a8e54b, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time after Shift Start, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:17:52.878  INFO 16 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=05c4a130-b95c-4b02-99a4-0787a34b71e7, content=DENY, timestamp=1642331872878, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:31aa3bfa-c095-4f10-a6c7-a9d759a8e54b:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=31aa3bfa-c095-4f10-a6c7-a9d759a8e54b, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time after Shift Start, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:17:52.879  INFO 16 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=13ms, Total=16ms
2022-01-16 11:17:52.896  INFO 16 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=c716bf03-9dec-46e3-a427-b8eeb5e5613e, content=null, timestamp=1642331872890, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=51194, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=22766fcc86b6, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=aafd4250-e6a1-4378-91fb-a2a4ddd87c5e, http-req-server-port=80, http-header-accept=*/*, kc-id=77b9495c-1692-426c-96be-094189073545, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642331872889, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQAB3NxAH4AEQAAAABh4/7bdAAkNzdiOTQ5NWMtMTY5Mi00MjZjLTk2YmUtMDk0MTg5MDczNTQ1dAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRhYWZkNDI1MC1lNmExLTQzNzgtOTFmYi1hMmE0ZGRkODdjNWVwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJhY3dRY1p6TGlENW1hRl85amJINGVRVFplOElvZDdldllhOUk2eDVXWjJnIn0.eyJleHAiOjE2NDIzMzIxNjcsImlhdCI6MTY0MjMzMTg2NywianRpIjoiNzdiOTQ5NWMtMTY5Mi00MjZjLTk2YmUtMDk0MTg5MDczNTQ1IiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiJhYWZkNDI1MC1lNmExLTQzNzgtOTFmYi1hMmE0ZGRkODdjNWUiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.ep3IG5UMcj__1HopMvUFb4xo9nI32gjSZwh03RVYoaim2ExbnEMIikZYIfXlh68pK0CGsTDpWMFgwTbyE98St8icBudSUAJ7fcG3ZJGb84sN9y5pZx7kMMWsBOdB37lSq2eX5SR6l1XgEUB3QxLM6uCgqXfD8yQ7r-ZSC1WitU1NoZ3zGnlrJ4e2aMv_CbLrohDHGwrC2jJJh5Zru_VzRYxTqfIfbMQu6To4QONfTJnbu47lmp8wtTkJIISRnNYAwTUPFWUjm-MHSLlOlOgU9eGKLm6VTM_WxZxFSX5mHs3gbOp_Ou_jDgVNbgzItCK6BCJSXoXfhVOCgNnH_g6F_w, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre/read, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642332167, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.144.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=6B49B2D319E16D7AF14FF1D9C9155C12, http-session-last-accessed-time=1642331872889, kc-category-name=ACCESS, kc-iat=1642331867, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:51194 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:17:52.896  INFO 16 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:17:52.897  INFO 16 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6adbd7a0
2022-01-16 11:17:52.898  INFO 16 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6adbd7a0
2022-01-16 11:17:52.908  INFO 16 --- [https-jsse-nio-7071-exec-5] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18910323997894259-590364, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:31aa3bfa-c095-4f10-a6c7-a9d759a8e54b:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=31aa3bfa-c095-4f10-a6c7-a9d759a8e54b, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time after Shift Start, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:17:52.908  INFO 16 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=c716bf03-9dec-46e3-a427-b8eeb5e5613e, content=DENY, timestamp=1642331872908, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:31aa3bfa-c095-4f10-a6c7-a9d759a8e54b:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=31aa3bfa-c095-4f10-a6c7-a9d759a8e54b, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time after Shift Start, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:17:52.909  INFO 16 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=12ms, Total=15ms
2022-01-16 11:17:52.921  INFO 16 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=77474a72-4487-4b96-8069-77e363bde3f1, content=null, timestamp=1642331872917, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=51196, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=22766fcc86b6, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=aafd4250-e6a1-4378-91fb-a2a4ddd87c5e, http-req-server-port=80, http-header-accept=*/*, kc-id=77b9495c-1692-426c-96be-094189073545, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642331872916, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQAB3NxAH4AEQAAAABh4/7bdAAkNzdiOTQ5NWMtMTY5Mi00MjZjLTk2YmUtMDk0MTg5MDczNTQ1dAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRhYWZkNDI1MC1lNmExLTQzNzgtOTFmYi1hMmE0ZGRkODdjNWVwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJhY3dRY1p6TGlENW1hRl85amJINGVRVFplOElvZDdldllhOUk2eDVXWjJnIn0.eyJleHAiOjE2NDIzMzIxNjcsImlhdCI6MTY0MjMzMTg2NywianRpIjoiNzdiOTQ5NWMtMTY5Mi00MjZjLTk2YmUtMDk0MTg5MDczNTQ1IiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiJhYWZkNDI1MC1lNmExLTQzNzgtOTFmYi1hMmE0ZGRkODdjNWUiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.ep3IG5UMcj__1HopMvUFb4xo9nI32gjSZwh03RVYoaim2ExbnEMIikZYIfXlh68pK0CGsTDpWMFgwTbyE98St8icBudSUAJ7fcG3ZJGb84sN9y5pZx7kMMWsBOdB37lSq2eX5SR6l1XgEUB3QxLM6uCgqXfD8yQ7r-ZSC1WitU1NoZ3zGnlrJ4e2aMv_CbLrohDHGwrC2jJJh5Zru_VzRYxTqfIfbMQu6To4QONfTJnbu47lmp8wtTkJIISRnNYAwTUPFWUjm-MHSLlOlOgU9eGKLm6VTM_WxZxFSX5mHs3gbOp_Ou_jDgVNbgzItCK6BCJSXoXfhVOCgNnH_g6F_w, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre/read, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642332167, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.144.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=FBD0061B66653AC42CDEC9CC90127425, http-session-last-accessed-time=1642331872916, kc-category-name=ACCESS, kc-iat=1642331867, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:51196 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:17:52.922  INFO 16 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:17:52.923  INFO 16 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7d1f99e8
2022-01-16 11:17:52.923  INFO 16 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7d1f99e8
2022-01-16 11:17:52.974  INFO 16 --- [https-jsse-nio-7071-exec-6] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18910324023652400-254398, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:31aa3bfa-c095-4f10-a6c7-a9d759a8e54b:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=31aa3bfa-c095-4f10-a6c7-a9d759a8e54b, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time after Shift Start, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:17:52.974  INFO 16 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=77474a72-4487-4b96-8069-77e363bde3f1, content=DENY, timestamp=1642331872974, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:31aa3bfa-c095-4f10-a6c7-a9d759a8e54b:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=31aa3bfa-c095-4f10-a6c7-a9d759a8e54b, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time after Shift Start, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:17:52.975  INFO 16 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=52ms, Total=55ms
2022-01-16 11:17:52.992  INFO 16 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=aa3d89b4-2764-49f4-84bc-20b2bfce26f9, content=null, timestamp=1642331872987, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=51198, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=22766fcc86b6, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=aafd4250-e6a1-4378-91fb-a2a4ddd87c5e, http-req-server-port=80, http-header-accept=*/*, kc-id=77b9495c-1692-426c-96be-094189073545, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642331872985, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQAB3NxAH4AEQAAAABh4/7bdAAkNzdiOTQ5NWMtMTY5Mi00MjZjLTk2YmUtMDk0MTg5MDczNTQ1dAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRhYWZkNDI1MC1lNmExLTQzNzgtOTFmYi1hMmE0ZGRkODdjNWVwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJhY3dRY1p6TGlENW1hRl85amJINGVRVFplOElvZDdldllhOUk2eDVXWjJnIn0.eyJleHAiOjE2NDIzMzIxNjcsImlhdCI6MTY0MjMzMTg2NywianRpIjoiNzdiOTQ5NWMtMTY5Mi00MjZjLTk2YmUtMDk0MTg5MDczNTQ1IiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiJhYWZkNDI1MC1lNmExLTQzNzgtOTFmYi1hMmE0ZGRkODdjNWUiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.ep3IG5UMcj__1HopMvUFb4xo9nI32gjSZwh03RVYoaim2ExbnEMIikZYIfXlh68pK0CGsTDpWMFgwTbyE98St8icBudSUAJ7fcG3ZJGb84sN9y5pZx7kMMWsBOdB37lSq2eX5SR6l1XgEUB3QxLM6uCgqXfD8yQ7r-ZSC1WitU1NoZ3zGnlrJ4e2aMv_CbLrohDHGwrC2jJJh5Zru_VzRYxTqfIfbMQu6To4QONfTJnbu47lmp8wtTkJIISRnNYAwTUPFWUjm-MHSLlOlOgU9eGKLm6VTM_WxZxFSX5mHs3gbOp_Ou_jDgVNbgzItCK6BCJSXoXfhVOCgNnH_g6F_w, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre/read, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642332167, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.144.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=82D6B9B9AF48087F7A0D9933DADA07B4, http-session-last-accessed-time=1642331872985, kc-category-name=ACCESS, kc-iat=1642331867, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:51198 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:17:52.993  INFO 16 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:17:52.994  INFO 16 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2a76128
2022-01-16 11:17:52.994  INFO 16 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2a76128
2022-01-16 11:17:53.007  INFO 16 --- [https-jsse-nio-7071-exec-7] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18910324094485250-789642, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:31aa3bfa-c095-4f10-a6c7-a9d759a8e54b:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=31aa3bfa-c095-4f10-a6c7-a9d759a8e54b, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time after Shift Start, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:17:53.007  INFO 16 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=aa3d89b4-2764-49f4-84bc-20b2bfce26f9, content=DENY, timestamp=1642331873007, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:31aa3bfa-c095-4f10-a6c7-a9d759a8e54b:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=31aa3bfa-c095-4f10-a6c7-a9d759a8e54b, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time after Shift Start, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:17:53.008  INFO 16 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=14ms, Total=17ms
2022-01-16 11:17:53.025  INFO 16 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=91976e30-ce7d-480f-a554-e3ab440e6f60, content=null, timestamp=1642331873019, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=51200, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=22766fcc86b6, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=aafd4250-e6a1-4378-91fb-a2a4ddd87c5e, http-req-server-port=80, http-header-accept=*/*, kc-id=77b9495c-1692-426c-96be-094189073545, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642331873018, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQAB3NxAH4AEQAAAABh4/7bdAAkNzdiOTQ5NWMtMTY5Mi00MjZjLTk2YmUtMDk0MTg5MDczNTQ1dAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRhYWZkNDI1MC1lNmExLTQzNzgtOTFmYi1hMmE0ZGRkODdjNWVwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJhY3dRY1p6TGlENW1hRl85amJINGVRVFplOElvZDdldllhOUk2eDVXWjJnIn0.eyJleHAiOjE2NDIzMzIxNjcsImlhdCI6MTY0MjMzMTg2NywianRpIjoiNzdiOTQ5NWMtMTY5Mi00MjZjLTk2YmUtMDk0MTg5MDczNTQ1IiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiJhYWZkNDI1MC1lNmExLTQzNzgtOTFmYi1hMmE0ZGRkODdjNWUiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.ep3IG5UMcj__1HopMvUFb4xo9nI32gjSZwh03RVYoaim2ExbnEMIikZYIfXlh68pK0CGsTDpWMFgwTbyE98St8icBudSUAJ7fcG3ZJGb84sN9y5pZx7kMMWsBOdB37lSq2eX5SR6l1XgEUB3QxLM6uCgqXfD8yQ7r-ZSC1WitU1NoZ3zGnlrJ4e2aMv_CbLrohDHGwrC2jJJh5Zru_VzRYxTqfIfbMQu6To4QONfTJnbu47lmp8wtTkJIISRnNYAwTUPFWUjm-MHSLlOlOgU9eGKLm6VTM_WxZxFSX5mHs3gbOp_Ou_jDgVNbgzItCK6BCJSXoXfhVOCgNnH_g6F_w, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre/read, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642332167, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.144.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=61AF337200A5F464131953220DA7AF58, http-session-last-accessed-time=1642331873018, kc-category-name=ACCESS, kc-iat=1642331867, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:51200 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:17:53.027  INFO 16 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:17:53.028  INFO 16 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4c38897e
2022-01-16 11:17:53.028  INFO 16 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4c38897e
2022-01-16 11:17:53.040  INFO 16 --- [https-jsse-nio-7071-exec-8] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18910324128414135-116437, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:31aa3bfa-c095-4f10-a6c7-a9d759a8e54b:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=31aa3bfa-c095-4f10-a6c7-a9d759a8e54b, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time after Shift Start, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:17:53.040  INFO 16 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=91976e30-ce7d-480f-a554-e3ab440e6f60, content=DENY, timestamp=1642331873040, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:31aa3bfa-c095-4f10-a6c7-a9d759a8e54b:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=31aa3bfa-c095-4f10-a6c7-a9d759a8e54b, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time after Shift Start, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:17:53.041  INFO 16 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=13ms, Total=18ms
2022-01-16 11:17:53.055  INFO 16 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=ca728944-a0af-4e03-8cdb-22e0fb8edd67, content=null, timestamp=1642331873051, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=51202, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=22766fcc86b6, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=aafd4250-e6a1-4378-91fb-a2a4ddd87c5e, http-req-server-port=80, http-header-accept=*/*, kc-id=77b9495c-1692-426c-96be-094189073545, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642331873050, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQAB3NxAH4AEQAAAABh4/7bdAAkNzdiOTQ5NWMtMTY5Mi00MjZjLTk2YmUtMDk0MTg5MDczNTQ1dAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRhYWZkNDI1MC1lNmExLTQzNzgtOTFmYi1hMmE0ZGRkODdjNWVwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJhY3dRY1p6TGlENW1hRl85amJINGVRVFplOElvZDdldllhOUk2eDVXWjJnIn0.eyJleHAiOjE2NDIzMzIxNjcsImlhdCI6MTY0MjMzMTg2NywianRpIjoiNzdiOTQ5NWMtMTY5Mi00MjZjLTk2YmUtMDk0MTg5MDczNTQ1IiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiJhYWZkNDI1MC1lNmExLTQzNzgtOTFmYi1hMmE0ZGRkODdjNWUiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.ep3IG5UMcj__1HopMvUFb4xo9nI32gjSZwh03RVYoaim2ExbnEMIikZYIfXlh68pK0CGsTDpWMFgwTbyE98St8icBudSUAJ7fcG3ZJGb84sN9y5pZx7kMMWsBOdB37lSq2eX5SR6l1XgEUB3QxLM6uCgqXfD8yQ7r-ZSC1WitU1NoZ3zGnlrJ4e2aMv_CbLrohDHGwrC2jJJh5Zru_VzRYxTqfIfbMQu6To4QONfTJnbu47lmp8wtTkJIISRnNYAwTUPFWUjm-MHSLlOlOgU9eGKLm6VTM_WxZxFSX5mHs3gbOp_Ou_jDgVNbgzItCK6BCJSXoXfhVOCgNnH_g6F_w, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre/read, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642332167, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.144.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=869DA01696CB1DC9A204595223FFAD85, http-session-last-accessed-time=1642331873050, kc-category-name=ACCESS, kc-iat=1642331867, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:51202 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:17:53.055  INFO 16 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:17:53.056  INFO 16 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@10447520
2022-01-16 11:17:53.056  INFO 16 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@10447520
2022-01-16 11:17:53.126  INFO 16 --- [https-jsse-nio-7071-exec-9] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18910324156909402-518408, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:31aa3bfa-c095-4f10-a6c7-a9d759a8e54b:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=31aa3bfa-c095-4f10-a6c7-a9d759a8e54b, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time after Shift Start, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:17:53.127  INFO 16 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=ca728944-a0af-4e03-8cdb-22e0fb8edd67, content=DENY, timestamp=1642331873127, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:31aa3bfa-c095-4f10-a6c7-a9d759a8e54b:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=31aa3bfa-c095-4f10-a6c7-a9d759a8e54b, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time after Shift Start, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:17:53.127  INFO 16 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=72ms, Total=73ms
2022-01-16 11:17:53.150  INFO 16 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=320bf0cc-1841-457a-8639-6bde120d2a7b, content=null, timestamp=1642331873144, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=51204, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=22766fcc86b6, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=aafd4250-e6a1-4378-91fb-a2a4ddd87c5e, http-req-server-port=80, http-header-accept=*/*, kc-id=77b9495c-1692-426c-96be-094189073545, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642331873142, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQAB3NxAH4AEQAAAABh4/7bdAAkNzdiOTQ5NWMtMTY5Mi00MjZjLTk2YmUtMDk0MTg5MDczNTQ1dAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRhYWZkNDI1MC1lNmExLTQzNzgtOTFmYi1hMmE0ZGRkODdjNWVwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJhY3dRY1p6TGlENW1hRl85amJINGVRVFplOElvZDdldllhOUk2eDVXWjJnIn0.eyJleHAiOjE2NDIzMzIxNjcsImlhdCI6MTY0MjMzMTg2NywianRpIjoiNzdiOTQ5NWMtMTY5Mi00MjZjLTk2YmUtMDk0MTg5MDczNTQ1IiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiJhYWZkNDI1MC1lNmExLTQzNzgtOTFmYi1hMmE0ZGRkODdjNWUiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.ep3IG5UMcj__1HopMvUFb4xo9nI32gjSZwh03RVYoaim2ExbnEMIikZYIfXlh68pK0CGsTDpWMFgwTbyE98St8icBudSUAJ7fcG3ZJGb84sN9y5pZx7kMMWsBOdB37lSq2eX5SR6l1XgEUB3QxLM6uCgqXfD8yQ7r-ZSC1WitU1NoZ3zGnlrJ4e2aMv_CbLrohDHGwrC2jJJh5Zru_VzRYxTqfIfbMQu6To4QONfTJnbu47lmp8wtTkJIISRnNYAwTUPFWUjm-MHSLlOlOgU9eGKLm6VTM_WxZxFSX5mHs3gbOp_Ou_jDgVNbgzItCK6BCJSXoXfhVOCgNnH_g6F_w, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre/read, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642332167, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.144.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=B6F50E9B9DB1072CEBC6C21D23C75C90, http-session-last-accessed-time=1642331873142, kc-category-name=ACCESS, kc-iat=1642331867, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:51204 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:17:53.151  INFO 16 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:17:53.151  INFO 16 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4dea32db
2022-01-16 11:17:53.152  INFO 16 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4dea32db
2022-01-16 11:17:53.173  INFO 16 --- [https-jsse-nio-7071-exec-10] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18910324252174679-845302, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:31aa3bfa-c095-4f10-a6c7-a9d759a8e54b:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=31aa3bfa-c095-4f10-a6c7-a9d759a8e54b, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time after Shift Start, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:17:53.174  INFO 16 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=320bf0cc-1841-457a-8639-6bde120d2a7b, content=DENY, timestamp=1642331873174, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:31aa3bfa-c095-4f10-a6c7-a9d759a8e54b:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=31aa3bfa-c095-4f10-a6c7-a9d759a8e54b, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time after Shift Start, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:17:53.174  INFO 16 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=23ms, Total=26ms
2022-01-16 11:17:53.199  INFO 16 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=2baca20e-ee59-4cce-9319-394c9ac9a521, content=null, timestamp=1642331873185, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=51206, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=22766fcc86b6, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=aafd4250-e6a1-4378-91fb-a2a4ddd87c5e, http-req-server-port=80, http-header-accept=*/*, kc-id=77b9495c-1692-426c-96be-094189073545, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642331873184, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQAB3NxAH4AEQAAAABh4/7bdAAkNzdiOTQ5NWMtMTY5Mi00MjZjLTk2YmUtMDk0MTg5MDczNTQ1dAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRhYWZkNDI1MC1lNmExLTQzNzgtOTFmYi1hMmE0ZGRkODdjNWVwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJhY3dRY1p6TGlENW1hRl85amJINGVRVFplOElvZDdldllhOUk2eDVXWjJnIn0.eyJleHAiOjE2NDIzMzIxNjcsImlhdCI6MTY0MjMzMTg2NywianRpIjoiNzdiOTQ5NWMtMTY5Mi00MjZjLTk2YmUtMDk0MTg5MDczNTQ1IiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiJhYWZkNDI1MC1lNmExLTQzNzgtOTFmYi1hMmE0ZGRkODdjNWUiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.ep3IG5UMcj__1HopMvUFb4xo9nI32gjSZwh03RVYoaim2ExbnEMIikZYIfXlh68pK0CGsTDpWMFgwTbyE98St8icBudSUAJ7fcG3ZJGb84sN9y5pZx7kMMWsBOdB37lSq2eX5SR6l1XgEUB3QxLM6uCgqXfD8yQ7r-ZSC1WitU1NoZ3zGnlrJ4e2aMv_CbLrohDHGwrC2jJJh5Zru_VzRYxTqfIfbMQu6To4QONfTJnbu47lmp8wtTkJIISRnNYAwTUPFWUjm-MHSLlOlOgU9eGKLm6VTM_WxZxFSX5mHs3gbOp_Ou_jDgVNbgzItCK6BCJSXoXfhVOCgNnH_g6F_w, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre/read, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642332167, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.144.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=55B556F24790E82BA3181DE4A36DCD52, http-session-last-accessed-time=1642331873184, kc-category-name=ACCESS, kc-iat=1642331867, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:51206 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:17:53.201  INFO 16 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:17:53.206  INFO 16 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@48a11996
2022-01-16 11:17:53.207  INFO 16 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@48a11996
2022-01-16 11:17:53.220  INFO 16 --- [https-jsse-nio-7071-exec-1] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18910324303961431-458575, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:31aa3bfa-c095-4f10-a6c7-a9d759a8e54b:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=31aa3bfa-c095-4f10-a6c7-a9d759a8e54b, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time after Shift Start, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:17:53.221  INFO 16 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=2baca20e-ee59-4cce-9319-394c9ac9a521, content=DENY, timestamp=1642331873221, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:31aa3bfa-c095-4f10-a6c7-a9d759a8e54b:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=31aa3bfa-c095-4f10-a6c7-a9d759a8e54b, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time after Shift Start, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:17:53.222  INFO 16 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=19ms, Total=29ms
2022-01-16 11:17:53.238  INFO 16 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=d66a148f-9535-4e58-99a8-69542557b5bb, content=null, timestamp=1642331873233, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=51208, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=22766fcc86b6, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=aafd4250-e6a1-4378-91fb-a2a4ddd87c5e, http-req-server-port=80, http-header-accept=*/*, kc-id=77b9495c-1692-426c-96be-094189073545, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642331873232, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQAB3NxAH4AEQAAAABh4/7bdAAkNzdiOTQ5NWMtMTY5Mi00MjZjLTk2YmUtMDk0MTg5MDczNTQ1dAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRhYWZkNDI1MC1lNmExLTQzNzgtOTFmYi1hMmE0ZGRkODdjNWVwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJhY3dRY1p6TGlENW1hRl85amJINGVRVFplOElvZDdldllhOUk2eDVXWjJnIn0.eyJleHAiOjE2NDIzMzIxNjcsImlhdCI6MTY0MjMzMTg2NywianRpIjoiNzdiOTQ5NWMtMTY5Mi00MjZjLTk2YmUtMDk0MTg5MDczNTQ1IiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiJhYWZkNDI1MC1lNmExLTQzNzgtOTFmYi1hMmE0ZGRkODdjNWUiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.ep3IG5UMcj__1HopMvUFb4xo9nI32gjSZwh03RVYoaim2ExbnEMIikZYIfXlh68pK0CGsTDpWMFgwTbyE98St8icBudSUAJ7fcG3ZJGb84sN9y5pZx7kMMWsBOdB37lSq2eX5SR6l1XgEUB3QxLM6uCgqXfD8yQ7r-ZSC1WitU1NoZ3zGnlrJ4e2aMv_CbLrohDHGwrC2jJJh5Zru_VzRYxTqfIfbMQu6To4QONfTJnbu47lmp8wtTkJIISRnNYAwTUPFWUjm-MHSLlOlOgU9eGKLm6VTM_WxZxFSX5mHs3gbOp_Ou_jDgVNbgzItCK6BCJSXoXfhVOCgNnH_g6F_w, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre/read, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642332167, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.144.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=7FA9DC3288FA5BFBAE81B8C5F2D1B7BC, http-session-last-accessed-time=1642331873232, kc-category-name=ACCESS, kc-iat=1642331867, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:51208 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:17:53.238  INFO 16 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:17:53.239  INFO 16 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@51c2ae4f
2022-01-16 11:17:53.240  INFO 16 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@51c2ae4f
2022-01-16 11:17:53.260  INFO 16 --- [https-jsse-nio-7071-exec-2] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18910324339855421-723731, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:31aa3bfa-c095-4f10-a6c7-a9d759a8e54b:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=31aa3bfa-c095-4f10-a6c7-a9d759a8e54b, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time after Shift Start, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:17:53.260  INFO 16 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=d66a148f-9535-4e58-99a8-69542557b5bb, content=DENY, timestamp=1642331873260, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:31aa3bfa-c095-4f10-a6c7-a9d759a8e54b:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=31aa3bfa-c095-4f10-a6c7-a9d759a8e54b, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time after Shift Start, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:17:53.262  INFO 16 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=22ms, Total=25ms
2022-01-16 11:17:53.280  INFO 16 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=0a302ff9-49ab-4ec7-9d89-1f14864ac2ec, content=null, timestamp=1642331873273, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=51210, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=22766fcc86b6, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=aafd4250-e6a1-4378-91fb-a2a4ddd87c5e, http-req-server-port=80, http-header-accept=*/*, kc-id=77b9495c-1692-426c-96be-094189073545, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642331873272, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQAB3NxAH4AEQAAAABh4/7bdAAkNzdiOTQ5NWMtMTY5Mi00MjZjLTk2YmUtMDk0MTg5MDczNTQ1dAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRhYWZkNDI1MC1lNmExLTQzNzgtOTFmYi1hMmE0ZGRkODdjNWVwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJhY3dRY1p6TGlENW1hRl85amJINGVRVFplOElvZDdldllhOUk2eDVXWjJnIn0.eyJleHAiOjE2NDIzMzIxNjcsImlhdCI6MTY0MjMzMTg2NywianRpIjoiNzdiOTQ5NWMtMTY5Mi00MjZjLTk2YmUtMDk0MTg5MDczNTQ1IiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiJhYWZkNDI1MC1lNmExLTQzNzgtOTFmYi1hMmE0ZGRkODdjNWUiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.ep3IG5UMcj__1HopMvUFb4xo9nI32gjSZwh03RVYoaim2ExbnEMIikZYIfXlh68pK0CGsTDpWMFgwTbyE98St8icBudSUAJ7fcG3ZJGb84sN9y5pZx7kMMWsBOdB37lSq2eX5SR6l1XgEUB3QxLM6uCgqXfD8yQ7r-ZSC1WitU1NoZ3zGnlrJ4e2aMv_CbLrohDHGwrC2jJJh5Zru_VzRYxTqfIfbMQu6To4QONfTJnbu47lmp8wtTkJIISRnNYAwTUPFWUjm-MHSLlOlOgU9eGKLm6VTM_WxZxFSX5mHs3gbOp_Ou_jDgVNbgzItCK6BCJSXoXfhVOCgNnH_g6F_w, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre/read, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642332167, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.144.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=3C5A03DA7B5749728BFAC924F458598A, http-session-last-accessed-time=1642331873272, kc-category-name=ACCESS, kc-iat=1642331867, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:51210 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:17:53.281  INFO 16 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:17:53.282  INFO 16 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2465668b
2022-01-16 11:17:53.283  INFO 16 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2465668b
2022-01-16 11:17:53.338  INFO 16 --- [https-jsse-nio-7071-exec-3] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18910324382148401-867516, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:31aa3bfa-c095-4f10-a6c7-a9d759a8e54b:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=31aa3bfa-c095-4f10-a6c7-a9d759a8e54b, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time after Shift Start, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:17:53.338  INFO 16 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=0a302ff9-49ab-4ec7-9d89-1f14864ac2ec, content=DENY, timestamp=1642331873338, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:31aa3bfa-c095-4f10-a6c7-a9d759a8e54b:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=31aa3bfa-c095-4f10-a6c7-a9d759a8e54b, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time after Shift Start, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:17:53.339  INFO 16 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=57ms, Total=60ms
2022-01-16 11:17:53.356  INFO 16 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=1b8f771e-03ad-4d2f-9472-7302ed9ace70, content=null, timestamp=1642331873351, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=51212, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=22766fcc86b6, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=aafd4250-e6a1-4378-91fb-a2a4ddd87c5e, http-req-server-port=80, http-header-accept=*/*, kc-id=77b9495c-1692-426c-96be-094189073545, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642331873350, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQAB3NxAH4AEQAAAABh4/7bdAAkNzdiOTQ5NWMtMTY5Mi00MjZjLTk2YmUtMDk0MTg5MDczNTQ1dAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRhYWZkNDI1MC1lNmExLTQzNzgtOTFmYi1hMmE0ZGRkODdjNWVwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJhY3dRY1p6TGlENW1hRl85amJINGVRVFplOElvZDdldllhOUk2eDVXWjJnIn0.eyJleHAiOjE2NDIzMzIxNjcsImlhdCI6MTY0MjMzMTg2NywianRpIjoiNzdiOTQ5NWMtMTY5Mi00MjZjLTk2YmUtMDk0MTg5MDczNTQ1IiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiJhYWZkNDI1MC1lNmExLTQzNzgtOTFmYi1hMmE0ZGRkODdjNWUiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.ep3IG5UMcj__1HopMvUFb4xo9nI32gjSZwh03RVYoaim2ExbnEMIikZYIfXlh68pK0CGsTDpWMFgwTbyE98St8icBudSUAJ7fcG3ZJGb84sN9y5pZx7kMMWsBOdB37lSq2eX5SR6l1XgEUB3QxLM6uCgqXfD8yQ7r-ZSC1WitU1NoZ3zGnlrJ4e2aMv_CbLrohDHGwrC2jJJh5Zru_VzRYxTqfIfbMQu6To4QONfTJnbu47lmp8wtTkJIISRnNYAwTUPFWUjm-MHSLlOlOgU9eGKLm6VTM_WxZxFSX5mHs3gbOp_Ou_jDgVNbgzItCK6BCJSXoXfhVOCgNnH_g6F_w, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre/read, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642332167, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.144.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=B88F355A2712000BE02C447DF28827D6, http-session-last-accessed-time=1642331873350, kc-category-name=ACCESS, kc-iat=1642331867, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:51212 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:17:53.356  INFO 16 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:17:53.357  INFO 16 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@f9ac6f2
2022-01-16 11:17:53.357  INFO 16 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@f9ac6f2
2022-01-16 11:17:53.368  INFO 16 --- [https-jsse-nio-7071-exec-4] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18910324457714356-161256, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:31aa3bfa-c095-4f10-a6c7-a9d759a8e54b:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=31aa3bfa-c095-4f10-a6c7-a9d759a8e54b, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time after Shift Start, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:17:53.369  INFO 16 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=1b8f771e-03ad-4d2f-9472-7302ed9ace70, content=DENY, timestamp=1642331873369, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:31aa3bfa-c095-4f10-a6c7-a9d759a8e54b:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=31aa3bfa-c095-4f10-a6c7-a9d759a8e54b, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time after Shift Start, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:17:53.370  INFO 16 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=13ms, Total=15ms
2022-01-16 11:17:53.389  INFO 16 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=dc4eb067-9515-4358-83cc-91b7c305df00, content=null, timestamp=1642331873383, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=51214, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=22766fcc86b6, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=aafd4250-e6a1-4378-91fb-a2a4ddd87c5e, http-req-server-port=80, http-header-accept=*/*, kc-id=77b9495c-1692-426c-96be-094189073545, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642331873382, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQAB3NxAH4AEQAAAABh4/7bdAAkNzdiOTQ5NWMtMTY5Mi00MjZjLTk2YmUtMDk0MTg5MDczNTQ1dAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRhYWZkNDI1MC1lNmExLTQzNzgtOTFmYi1hMmE0ZGRkODdjNWVwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJhY3dRY1p6TGlENW1hRl85amJINGVRVFplOElvZDdldllhOUk2eDVXWjJnIn0.eyJleHAiOjE2NDIzMzIxNjcsImlhdCI6MTY0MjMzMTg2NywianRpIjoiNzdiOTQ5NWMtMTY5Mi00MjZjLTk2YmUtMDk0MTg5MDczNTQ1IiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiJhYWZkNDI1MC1lNmExLTQzNzgtOTFmYi1hMmE0ZGRkODdjNWUiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.ep3IG5UMcj__1HopMvUFb4xo9nI32gjSZwh03RVYoaim2ExbnEMIikZYIfXlh68pK0CGsTDpWMFgwTbyE98St8icBudSUAJ7fcG3ZJGb84sN9y5pZx7kMMWsBOdB37lSq2eX5SR6l1XgEUB3QxLM6uCgqXfD8yQ7r-ZSC1WitU1NoZ3zGnlrJ4e2aMv_CbLrohDHGwrC2jJJh5Zru_VzRYxTqfIfbMQu6To4QONfTJnbu47lmp8wtTkJIISRnNYAwTUPFWUjm-MHSLlOlOgU9eGKLm6VTM_WxZxFSX5mHs3gbOp_Ou_jDgVNbgzItCK6BCJSXoXfhVOCgNnH_g6F_w, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre/read, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642332167, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.144.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=EA862FB044F5BDF0478E7329D0D51C86, http-session-last-accessed-time=1642331873382, kc-category-name=ACCESS, kc-iat=1642331867, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:51214 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:17:53.390  INFO 16 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:17:53.390  INFO 16 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@60998826
2022-01-16 11:17:53.391  INFO 16 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@60998826
2022-01-16 11:17:53.402  INFO 16 --- [https-jsse-nio-7071-exec-5] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18910324491288727-276433, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:31aa3bfa-c095-4f10-a6c7-a9d759a8e54b:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=31aa3bfa-c095-4f10-a6c7-a9d759a8e54b, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time after Shift Start, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:17:53.402  INFO 16 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=dc4eb067-9515-4358-83cc-91b7c305df00, content=DENY, timestamp=1642331873402, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:31aa3bfa-c095-4f10-a6c7-a9d759a8e54b:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=31aa3bfa-c095-4f10-a6c7-a9d759a8e54b, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time after Shift Start, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:17:53.403  INFO 16 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=12ms, Total=15ms
2022-01-16 11:17:53.425  INFO 16 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=4b039ad4-a804-4724-ba54-dae50c455730, content=null, timestamp=1642331873420, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=51216, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=22766fcc86b6, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=aafd4250-e6a1-4378-91fb-a2a4ddd87c5e, http-req-server-port=80, http-header-accept=*/*, kc-id=77b9495c-1692-426c-96be-094189073545, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642331873418, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQAB3NxAH4AEQAAAABh4/7bdAAkNzdiOTQ5NWMtMTY5Mi00MjZjLTk2YmUtMDk0MTg5MDczNTQ1dAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRhYWZkNDI1MC1lNmExLTQzNzgtOTFmYi1hMmE0ZGRkODdjNWVwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJhY3dRY1p6TGlENW1hRl85amJINGVRVFplOElvZDdldllhOUk2eDVXWjJnIn0.eyJleHAiOjE2NDIzMzIxNjcsImlhdCI6MTY0MjMzMTg2NywianRpIjoiNzdiOTQ5NWMtMTY5Mi00MjZjLTk2YmUtMDk0MTg5MDczNTQ1IiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiJhYWZkNDI1MC1lNmExLTQzNzgtOTFmYi1hMmE0ZGRkODdjNWUiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.ep3IG5UMcj__1HopMvUFb4xo9nI32gjSZwh03RVYoaim2ExbnEMIikZYIfXlh68pK0CGsTDpWMFgwTbyE98St8icBudSUAJ7fcG3ZJGb84sN9y5pZx7kMMWsBOdB37lSq2eX5SR6l1XgEUB3QxLM6uCgqXfD8yQ7r-ZSC1WitU1NoZ3zGnlrJ4e2aMv_CbLrohDHGwrC2jJJh5Zru_VzRYxTqfIfbMQu6To4QONfTJnbu47lmp8wtTkJIISRnNYAwTUPFWUjm-MHSLlOlOgU9eGKLm6VTM_WxZxFSX5mHs3gbOp_Ou_jDgVNbgzItCK6BCJSXoXfhVOCgNnH_g6F_w, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre/read, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642332167, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.144.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=241682ABCEBFD76274A5E56AC5A498A8, http-session-last-accessed-time=1642331873418, kc-category-name=ACCESS, kc-iat=1642331867, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:51216 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:17:53.426  INFO 16 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:17:53.427  INFO 16 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@15b776b5
2022-01-16 11:17:53.427  INFO 16 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@15b776b5
2022-01-16 11:17:53.478  INFO 16 --- [https-jsse-nio-7071-exec-6] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18910324527446787-872659, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:31aa3bfa-c095-4f10-a6c7-a9d759a8e54b:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=31aa3bfa-c095-4f10-a6c7-a9d759a8e54b, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time after Shift Start, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:17:53.478  INFO 16 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=4b039ad4-a804-4724-ba54-dae50c455730, content=DENY, timestamp=1642331873478, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:31aa3bfa-c095-4f10-a6c7-a9d759a8e54b:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=31aa3bfa-c095-4f10-a6c7-a9d759a8e54b, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time after Shift Start, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:17:53.479  INFO 16 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=52ms, Total=55ms
2022-01-16 11:17:53.493  INFO 16 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=b11a20b3-0326-40da-b81c-afe40bc58079, content=null, timestamp=1642331873489, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=51218, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=22766fcc86b6, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=aafd4250-e6a1-4378-91fb-a2a4ddd87c5e, http-req-server-port=80, http-header-accept=*/*, kc-id=77b9495c-1692-426c-96be-094189073545, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642331873487, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQAB3NxAH4AEQAAAABh4/7bdAAkNzdiOTQ5NWMtMTY5Mi00MjZjLTk2YmUtMDk0MTg5MDczNTQ1dAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRhYWZkNDI1MC1lNmExLTQzNzgtOTFmYi1hMmE0ZGRkODdjNWVwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJhY3dRY1p6TGlENW1hRl85amJINGVRVFplOElvZDdldllhOUk2eDVXWjJnIn0.eyJleHAiOjE2NDIzMzIxNjcsImlhdCI6MTY0MjMzMTg2NywianRpIjoiNzdiOTQ5NWMtMTY5Mi00MjZjLTk2YmUtMDk0MTg5MDczNTQ1IiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiJhYWZkNDI1MC1lNmExLTQzNzgtOTFmYi1hMmE0ZGRkODdjNWUiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.ep3IG5UMcj__1HopMvUFb4xo9nI32gjSZwh03RVYoaim2ExbnEMIikZYIfXlh68pK0CGsTDpWMFgwTbyE98St8icBudSUAJ7fcG3ZJGb84sN9y5pZx7kMMWsBOdB37lSq2eX5SR6l1XgEUB3QxLM6uCgqXfD8yQ7r-ZSC1WitU1NoZ3zGnlrJ4e2aMv_CbLrohDHGwrC2jJJh5Zru_VzRYxTqfIfbMQu6To4QONfTJnbu47lmp8wtTkJIISRnNYAwTUPFWUjm-MHSLlOlOgU9eGKLm6VTM_WxZxFSX5mHs3gbOp_Ou_jDgVNbgzItCK6BCJSXoXfhVOCgNnH_g6F_w, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre/read, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642332167, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.144.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=524BC80333C7D8C2EDA724D722D471C5, http-session-last-accessed-time=1642331873487, kc-category-name=ACCESS, kc-iat=1642331867, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:51218 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:17:53.494  INFO 16 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:17:53.495  INFO 16 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5692878f
2022-01-16 11:17:53.495  INFO 16 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5692878f
2022-01-16 11:17:53.506  INFO 16 --- [https-jsse-nio-7071-exec-7] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18910324595410371-695167, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:31aa3bfa-c095-4f10-a6c7-a9d759a8e54b:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=31aa3bfa-c095-4f10-a6c7-a9d759a8e54b, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time after Shift Start, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:17:53.506  INFO 16 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=b11a20b3-0326-40da-b81c-afe40bc58079, content=DENY, timestamp=1642331873506, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:31aa3bfa-c095-4f10-a6c7-a9d759a8e54b:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=31aa3bfa-c095-4f10-a6c7-a9d759a8e54b, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time after Shift Start, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:17:53.507  INFO 16 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=12ms, Total=15ms
2022-01-16 11:17:53.525  INFO 16 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=e8b71991-05a0-4f55-972d-36d760c94871, content=null, timestamp=1642331873518, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=51220, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=22766fcc86b6, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=aafd4250-e6a1-4378-91fb-a2a4ddd87c5e, http-req-server-port=80, http-header-accept=*/*, kc-id=77b9495c-1692-426c-96be-094189073545, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642331873516, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQAB3NxAH4AEQAAAABh4/7bdAAkNzdiOTQ5NWMtMTY5Mi00MjZjLTk2YmUtMDk0MTg5MDczNTQ1dAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRhYWZkNDI1MC1lNmExLTQzNzgtOTFmYi1hMmE0ZGRkODdjNWVwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJhY3dRY1p6TGlENW1hRl85amJINGVRVFplOElvZDdldllhOUk2eDVXWjJnIn0.eyJleHAiOjE2NDIzMzIxNjcsImlhdCI6MTY0MjMzMTg2NywianRpIjoiNzdiOTQ5NWMtMTY5Mi00MjZjLTk2YmUtMDk0MTg5MDczNTQ1IiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiJhYWZkNDI1MC1lNmExLTQzNzgtOTFmYi1hMmE0ZGRkODdjNWUiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.ep3IG5UMcj__1HopMvUFb4xo9nI32gjSZwh03RVYoaim2ExbnEMIikZYIfXlh68pK0CGsTDpWMFgwTbyE98St8icBudSUAJ7fcG3ZJGb84sN9y5pZx7kMMWsBOdB37lSq2eX5SR6l1XgEUB3QxLM6uCgqXfD8yQ7r-ZSC1WitU1NoZ3zGnlrJ4e2aMv_CbLrohDHGwrC2jJJh5Zru_VzRYxTqfIfbMQu6To4QONfTJnbu47lmp8wtTkJIISRnNYAwTUPFWUjm-MHSLlOlOgU9eGKLm6VTM_WxZxFSX5mHs3gbOp_Ou_jDgVNbgzItCK6BCJSXoXfhVOCgNnH_g6F_w, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre/read, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642332167, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.144.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=8537D35710863D7183A4FD51ECD692CB, http-session-last-accessed-time=1642331873516, kc-category-name=ACCESS, kc-iat=1642331867, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:51220 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:17:53.526  INFO 16 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:17:53.527  INFO 16 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@186e6fd1
2022-01-16 11:17:53.528  INFO 16 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@186e6fd1
2022-01-16 11:17:53.545  INFO 16 --- [https-jsse-nio-7071-exec-8] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18910324628104826-291014, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:31aa3bfa-c095-4f10-a6c7-a9d759a8e54b:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=31aa3bfa-c095-4f10-a6c7-a9d759a8e54b, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time after Shift Start, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:17:53.546  INFO 16 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=e8b71991-05a0-4f55-972d-36d760c94871, content=DENY, timestamp=1642331873546, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:31aa3bfa-c095-4f10-a6c7-a9d759a8e54b:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=31aa3bfa-c095-4f10-a6c7-a9d759a8e54b, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time after Shift Start, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:17:53.547  INFO 16 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=19ms, Total=24ms
2022-01-16 11:17:53.569  INFO 16 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=dcb9fd6a-4485-4928-b459-7e4d4cc3d6d8, content=null, timestamp=1642331873556, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=51222, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=22766fcc86b6, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=aafd4250-e6a1-4378-91fb-a2a4ddd87c5e, http-req-server-port=80, http-header-accept=*/*, kc-id=77b9495c-1692-426c-96be-094189073545, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642331873556, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQAB3NxAH4AEQAAAABh4/7bdAAkNzdiOTQ5NWMtMTY5Mi00MjZjLTk2YmUtMDk0MTg5MDczNTQ1dAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRhYWZkNDI1MC1lNmExLTQzNzgtOTFmYi1hMmE0ZGRkODdjNWVwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJhY3dRY1p6TGlENW1hRl85amJINGVRVFplOElvZDdldllhOUk2eDVXWjJnIn0.eyJleHAiOjE2NDIzMzIxNjcsImlhdCI6MTY0MjMzMTg2NywianRpIjoiNzdiOTQ5NWMtMTY5Mi00MjZjLTk2YmUtMDk0MTg5MDczNTQ1IiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiJhYWZkNDI1MC1lNmExLTQzNzgtOTFmYi1hMmE0ZGRkODdjNWUiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.ep3IG5UMcj__1HopMvUFb4xo9nI32gjSZwh03RVYoaim2ExbnEMIikZYIfXlh68pK0CGsTDpWMFgwTbyE98St8icBudSUAJ7fcG3ZJGb84sN9y5pZx7kMMWsBOdB37lSq2eX5SR6l1XgEUB3QxLM6uCgqXfD8yQ7r-ZSC1WitU1NoZ3zGnlrJ4e2aMv_CbLrohDHGwrC2jJJh5Zru_VzRYxTqfIfbMQu6To4QONfTJnbu47lmp8wtTkJIISRnNYAwTUPFWUjm-MHSLlOlOgU9eGKLm6VTM_WxZxFSX5mHs3gbOp_Ou_jDgVNbgzItCK6BCJSXoXfhVOCgNnH_g6F_w, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre/read, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642332167, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.144.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=EA2803E7624FA493516489F70A68CAEB, http-session-last-accessed-time=1642331873556, kc-category-name=ACCESS, kc-iat=1642331867, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:51222 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:17:53.569  INFO 16 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:17:53.570  INFO 16 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@55327cba
2022-01-16 11:17:53.571  INFO 16 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@55327cba
2022-01-16 11:17:53.626  INFO 16 --- [https-jsse-nio-7071-exec-9] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18910324671051352-328996, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:31aa3bfa-c095-4f10-a6c7-a9d759a8e54b:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=31aa3bfa-c095-4f10-a6c7-a9d759a8e54b, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time after Shift Start, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:17:53.626  INFO 16 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=dcb9fd6a-4485-4928-b459-7e4d4cc3d6d8, content=DENY, timestamp=1642331873626, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:31aa3bfa-c095-4f10-a6c7-a9d759a8e54b:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=31aa3bfa-c095-4f10-a6c7-a9d759a8e54b, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time after Shift Start, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:17:53.627  INFO 16 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=56ms, Total=62ms
2022-01-16 11:17:53.644  INFO 16 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=f747ff0b-dddd-4c28-a14e-31ac3cb6aa23, content=null, timestamp=1642331873638, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=51224, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=22766fcc86b6, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=aafd4250-e6a1-4378-91fb-a2a4ddd87c5e, http-req-server-port=80, http-header-accept=*/*, kc-id=77b9495c-1692-426c-96be-094189073545, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642331873637, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQAB3NxAH4AEQAAAABh4/7bdAAkNzdiOTQ5NWMtMTY5Mi00MjZjLTk2YmUtMDk0MTg5MDczNTQ1dAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRhYWZkNDI1MC1lNmExLTQzNzgtOTFmYi1hMmE0ZGRkODdjNWVwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJhY3dRY1p6TGlENW1hRl85amJINGVRVFplOElvZDdldllhOUk2eDVXWjJnIn0.eyJleHAiOjE2NDIzMzIxNjcsImlhdCI6MTY0MjMzMTg2NywianRpIjoiNzdiOTQ5NWMtMTY5Mi00MjZjLTk2YmUtMDk0MTg5MDczNTQ1IiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiJhYWZkNDI1MC1lNmExLTQzNzgtOTFmYi1hMmE0ZGRkODdjNWUiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.ep3IG5UMcj__1HopMvUFb4xo9nI32gjSZwh03RVYoaim2ExbnEMIikZYIfXlh68pK0CGsTDpWMFgwTbyE98St8icBudSUAJ7fcG3ZJGb84sN9y5pZx7kMMWsBOdB37lSq2eX5SR6l1XgEUB3QxLM6uCgqXfD8yQ7r-ZSC1WitU1NoZ3zGnlrJ4e2aMv_CbLrohDHGwrC2jJJh5Zru_VzRYxTqfIfbMQu6To4QONfTJnbu47lmp8wtTkJIISRnNYAwTUPFWUjm-MHSLlOlOgU9eGKLm6VTM_WxZxFSX5mHs3gbOp_Ou_jDgVNbgzItCK6BCJSXoXfhVOCgNnH_g6F_w, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre/read, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642332167, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.144.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=E4C74301BFB2DE5BC6A6C4721638CB4A, http-session-last-accessed-time=1642331873637, kc-category-name=ACCESS, kc-iat=1642331867, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:51224 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:17:53.648  INFO 16 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:17:53.650  INFO 16 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@bdf8d79
2022-01-16 11:17:53.652  INFO 16 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@bdf8d79
2022-01-16 11:17:53.664  INFO 16 --- [https-jsse-nio-7071-exec-10] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18910324749845975-517890, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:31aa3bfa-c095-4f10-a6c7-a9d759a8e54b:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=31aa3bfa-c095-4f10-a6c7-a9d759a8e54b, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time after Shift Start, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:17:53.665  INFO 16 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=f747ff0b-dddd-4c28-a14e-31ac3cb6aa23, content=DENY, timestamp=1642331873665, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:31aa3bfa-c095-4f10-a6c7-a9d759a8e54b:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=31aa3bfa-c095-4f10-a6c7-a9d759a8e54b, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time after Shift Start, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:17:53.666  INFO 16 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=17ms, Total=24ms
2022-01-16 11:17:53.684  INFO 16 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=7c5f0228-cf24-4c8a-8dde-27efb5e36bea, content=null, timestamp=1642331873678, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=51226, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=22766fcc86b6, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=aafd4250-e6a1-4378-91fb-a2a4ddd87c5e, http-req-server-port=80, http-header-accept=*/*, kc-id=77b9495c-1692-426c-96be-094189073545, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642331873676, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQAB3NxAH4AEQAAAABh4/7bdAAkNzdiOTQ5NWMtMTY5Mi00MjZjLTk2YmUtMDk0MTg5MDczNTQ1dAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRhYWZkNDI1MC1lNmExLTQzNzgtOTFmYi1hMmE0ZGRkODdjNWVwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJhY3dRY1p6TGlENW1hRl85amJINGVRVFplOElvZDdldllhOUk2eDVXWjJnIn0.eyJleHAiOjE2NDIzMzIxNjcsImlhdCI6MTY0MjMzMTg2NywianRpIjoiNzdiOTQ5NWMtMTY5Mi00MjZjLTk2YmUtMDk0MTg5MDczNTQ1IiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiJhYWZkNDI1MC1lNmExLTQzNzgtOTFmYi1hMmE0ZGRkODdjNWUiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.ep3IG5UMcj__1HopMvUFb4xo9nI32gjSZwh03RVYoaim2ExbnEMIikZYIfXlh68pK0CGsTDpWMFgwTbyE98St8icBudSUAJ7fcG3ZJGb84sN9y5pZx7kMMWsBOdB37lSq2eX5SR6l1XgEUB3QxLM6uCgqXfD8yQ7r-ZSC1WitU1NoZ3zGnlrJ4e2aMv_CbLrohDHGwrC2jJJh5Zru_VzRYxTqfIfbMQu6To4QONfTJnbu47lmp8wtTkJIISRnNYAwTUPFWUjm-MHSLlOlOgU9eGKLm6VTM_WxZxFSX5mHs3gbOp_Ou_jDgVNbgzItCK6BCJSXoXfhVOCgNnH_g6F_w, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre/read, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642332167, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.144.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=15376AACC2B9595A376A43B1E8CBE01D, http-session-last-accessed-time=1642331873676, kc-category-name=ACCESS, kc-iat=1642331867, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:51226 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:17:53.686  INFO 16 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:17:53.687  INFO 16 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1759dba0
2022-01-16 11:17:53.687  INFO 16 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1759dba0
2022-01-16 11:17:53.699  INFO 16 --- [https-jsse-nio-7071-exec-1] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18910324787427988-673261, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:31aa3bfa-c095-4f10-a6c7-a9d759a8e54b:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=31aa3bfa-c095-4f10-a6c7-a9d759a8e54b, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time after Shift Start, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:17:53.700  INFO 16 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=7c5f0228-cf24-4c8a-8dde-27efb5e36bea, content=DENY, timestamp=1642331873700, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:31aa3bfa-c095-4f10-a6c7-a9d759a8e54b:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=31aa3bfa-c095-4f10-a6c7-a9d759a8e54b, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time after Shift Start, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:17:53.700  INFO 16 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=13ms, Total=17ms
2022-01-16 11:17:53.722  INFO 16 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=817cad5b-033e-4a8c-b07d-c8634a4d7899, content=null, timestamp=1642331873717, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=51228, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=22766fcc86b6, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=aafd4250-e6a1-4378-91fb-a2a4ddd87c5e, http-req-server-port=80, http-header-accept=*/*, kc-id=77b9495c-1692-426c-96be-094189073545, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642331873716, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQAB3NxAH4AEQAAAABh4/7bdAAkNzdiOTQ5NWMtMTY5Mi00MjZjLTk2YmUtMDk0MTg5MDczNTQ1dAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRhYWZkNDI1MC1lNmExLTQzNzgtOTFmYi1hMmE0ZGRkODdjNWVwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJhY3dRY1p6TGlENW1hRl85amJINGVRVFplOElvZDdldllhOUk2eDVXWjJnIn0.eyJleHAiOjE2NDIzMzIxNjcsImlhdCI6MTY0MjMzMTg2NywianRpIjoiNzdiOTQ5NWMtMTY5Mi00MjZjLTk2YmUtMDk0MTg5MDczNTQ1IiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiJhYWZkNDI1MC1lNmExLTQzNzgtOTFmYi1hMmE0ZGRkODdjNWUiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.ep3IG5UMcj__1HopMvUFb4xo9nI32gjSZwh03RVYoaim2ExbnEMIikZYIfXlh68pK0CGsTDpWMFgwTbyE98St8icBudSUAJ7fcG3ZJGb84sN9y5pZx7kMMWsBOdB37lSq2eX5SR6l1XgEUB3QxLM6uCgqXfD8yQ7r-ZSC1WitU1NoZ3zGnlrJ4e2aMv_CbLrohDHGwrC2jJJh5Zru_VzRYxTqfIfbMQu6To4QONfTJnbu47lmp8wtTkJIISRnNYAwTUPFWUjm-MHSLlOlOgU9eGKLm6VTM_WxZxFSX5mHs3gbOp_Ou_jDgVNbgzItCK6BCJSXoXfhVOCgNnH_g6F_w, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre/read, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642332167, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.144.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=C72AD45DEF5E564E09871195C1BE4A77, http-session-last-accessed-time=1642331873716, kc-category-name=ACCESS, kc-iat=1642331867, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:51228 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:17:53.723  INFO 16 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:17:53.724  INFO 16 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@37cfdb2e
2022-01-16 11:17:53.724  INFO 16 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@37cfdb2e
2022-01-16 11:17:53.784  INFO 16 --- [https-jsse-nio-7071-exec-2] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18910324824445246-797713, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:31aa3bfa-c095-4f10-a6c7-a9d759a8e54b:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=31aa3bfa-c095-4f10-a6c7-a9d759a8e54b, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time after Shift Start, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:17:53.784  INFO 16 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=817cad5b-033e-4a8c-b07d-c8634a4d7899, content=DENY, timestamp=1642331873784, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:31aa3bfa-c095-4f10-a6c7-a9d759a8e54b:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=31aa3bfa-c095-4f10-a6c7-a9d759a8e54b, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time after Shift Start, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:17:53.785  INFO 16 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=61ms, Total=64ms
2022-01-16 11:17:53.813  INFO 16 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=d245db70-0547-46c9-bbb0-ae421b51a812, content=null, timestamp=1642331873804, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=51230, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=22766fcc86b6, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=aafd4250-e6a1-4378-91fb-a2a4ddd87c5e, http-req-server-port=80, http-header-accept=*/*, kc-id=77b9495c-1692-426c-96be-094189073545, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642331873803, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQAB3NxAH4AEQAAAABh4/7bdAAkNzdiOTQ5NWMtMTY5Mi00MjZjLTk2YmUtMDk0MTg5MDczNTQ1dAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRhYWZkNDI1MC1lNmExLTQzNzgtOTFmYi1hMmE0ZGRkODdjNWVwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJhY3dRY1p6TGlENW1hRl85amJINGVRVFplOElvZDdldllhOUk2eDVXWjJnIn0.eyJleHAiOjE2NDIzMzIxNjcsImlhdCI6MTY0MjMzMTg2NywianRpIjoiNzdiOTQ5NWMtMTY5Mi00MjZjLTk2YmUtMDk0MTg5MDczNTQ1IiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiJhYWZkNDI1MC1lNmExLTQzNzgtOTFmYi1hMmE0ZGRkODdjNWUiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.ep3IG5UMcj__1HopMvUFb4xo9nI32gjSZwh03RVYoaim2ExbnEMIikZYIfXlh68pK0CGsTDpWMFgwTbyE98St8icBudSUAJ7fcG3ZJGb84sN9y5pZx7kMMWsBOdB37lSq2eX5SR6l1XgEUB3QxLM6uCgqXfD8yQ7r-ZSC1WitU1NoZ3zGnlrJ4e2aMv_CbLrohDHGwrC2jJJh5Zru_VzRYxTqfIfbMQu6To4QONfTJnbu47lmp8wtTkJIISRnNYAwTUPFWUjm-MHSLlOlOgU9eGKLm6VTM_WxZxFSX5mHs3gbOp_Ou_jDgVNbgzItCK6BCJSXoXfhVOCgNnH_g6F_w, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre/read, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642332167, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.144.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=9A04EF3B985DC018197069078D3AD9F4, http-session-last-accessed-time=1642331873803, kc-category-name=ACCESS, kc-iat=1642331867, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:51230 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:17:53.814  INFO 16 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:17:53.815  INFO 16 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@620ad306
2022-01-16 11:17:53.816  INFO 16 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@620ad306
2022-01-16 11:17:53.835  INFO 16 --- [https-jsse-nio-7071-exec-3] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18910324915551455-835079, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:31aa3bfa-c095-4f10-a6c7-a9d759a8e54b:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=31aa3bfa-c095-4f10-a6c7-a9d759a8e54b, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time after Shift Start, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:17:53.836  INFO 16 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=d245db70-0547-46c9-bbb0-ae421b51a812, content=DENY, timestamp=1642331873836, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:31aa3bfa-c095-4f10-a6c7-a9d759a8e54b:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=31aa3bfa-c095-4f10-a6c7-a9d759a8e54b, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time after Shift Start, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:17:53.836  INFO 16 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=22ms, Total=24ms
2022-01-16 11:17:53.852  INFO 16 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=446fd405-58a9-4e7f-bd1d-988eb30f5434, content=null, timestamp=1642331873847, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=51232, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=22766fcc86b6, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=aafd4250-e6a1-4378-91fb-a2a4ddd87c5e, http-req-server-port=80, http-header-accept=*/*, kc-id=77b9495c-1692-426c-96be-094189073545, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642331873846, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQAB3NxAH4AEQAAAABh4/7bdAAkNzdiOTQ5NWMtMTY5Mi00MjZjLTk2YmUtMDk0MTg5MDczNTQ1dAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRhYWZkNDI1MC1lNmExLTQzNzgtOTFmYi1hMmE0ZGRkODdjNWVwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJhY3dRY1p6TGlENW1hRl85amJINGVRVFplOElvZDdldllhOUk2eDVXWjJnIn0.eyJleHAiOjE2NDIzMzIxNjcsImlhdCI6MTY0MjMzMTg2NywianRpIjoiNzdiOTQ5NWMtMTY5Mi00MjZjLTk2YmUtMDk0MTg5MDczNTQ1IiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiJhYWZkNDI1MC1lNmExLTQzNzgtOTFmYi1hMmE0ZGRkODdjNWUiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.ep3IG5UMcj__1HopMvUFb4xo9nI32gjSZwh03RVYoaim2ExbnEMIikZYIfXlh68pK0CGsTDpWMFgwTbyE98St8icBudSUAJ7fcG3ZJGb84sN9y5pZx7kMMWsBOdB37lSq2eX5SR6l1XgEUB3QxLM6uCgqXfD8yQ7r-ZSC1WitU1NoZ3zGnlrJ4e2aMv_CbLrohDHGwrC2jJJh5Zru_VzRYxTqfIfbMQu6To4QONfTJnbu47lmp8wtTkJIISRnNYAwTUPFWUjm-MHSLlOlOgU9eGKLm6VTM_WxZxFSX5mHs3gbOp_Ou_jDgVNbgzItCK6BCJSXoXfhVOCgNnH_g6F_w, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre/read, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642332167, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.144.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=B0CA988EB7F0949C8E4DF7A39E0F956C, http-session-last-accessed-time=1642331873846, kc-category-name=ACCESS, kc-iat=1642331867, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:51232 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:17:53.852  INFO 16 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:17:53.853  INFO 16 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@49a0c255
2022-01-16 11:17:53.853  INFO 16 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@49a0c255
2022-01-16 11:17:53.866  INFO 16 --- [https-jsse-nio-7071-exec-4] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18910324953958352-270290, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:31aa3bfa-c095-4f10-a6c7-a9d759a8e54b:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=31aa3bfa-c095-4f10-a6c7-a9d759a8e54b, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time after Shift Start, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:17:53.866  INFO 16 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=446fd405-58a9-4e7f-bd1d-988eb30f5434, content=DENY, timestamp=1642331873866, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:31aa3bfa-c095-4f10-a6c7-a9d759a8e54b:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=31aa3bfa-c095-4f10-a6c7-a9d759a8e54b, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time after Shift Start, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:17:53.867  INFO 16 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=14ms, Total=16ms
2022-01-16 11:17:53.885  INFO 16 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=0d8a426a-12fa-4b4a-a83c-88402533f98b, content=null, timestamp=1642331873879, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=51234, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=22766fcc86b6, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=aafd4250-e6a1-4378-91fb-a2a4ddd87c5e, http-req-server-port=80, http-header-accept=*/*, kc-id=77b9495c-1692-426c-96be-094189073545, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642331873878, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQAB3NxAH4AEQAAAABh4/7bdAAkNzdiOTQ5NWMtMTY5Mi00MjZjLTk2YmUtMDk0MTg5MDczNTQ1dAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRhYWZkNDI1MC1lNmExLTQzNzgtOTFmYi1hMmE0ZGRkODdjNWVwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJhY3dRY1p6TGlENW1hRl85amJINGVRVFplOElvZDdldllhOUk2eDVXWjJnIn0.eyJleHAiOjE2NDIzMzIxNjcsImlhdCI6MTY0MjMzMTg2NywianRpIjoiNzdiOTQ5NWMtMTY5Mi00MjZjLTk2YmUtMDk0MTg5MDczNTQ1IiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiJhYWZkNDI1MC1lNmExLTQzNzgtOTFmYi1hMmE0ZGRkODdjNWUiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.ep3IG5UMcj__1HopMvUFb4xo9nI32gjSZwh03RVYoaim2ExbnEMIikZYIfXlh68pK0CGsTDpWMFgwTbyE98St8icBudSUAJ7fcG3ZJGb84sN9y5pZx7kMMWsBOdB37lSq2eX5SR6l1XgEUB3QxLM6uCgqXfD8yQ7r-ZSC1WitU1NoZ3zGnlrJ4e2aMv_CbLrohDHGwrC2jJJh5Zru_VzRYxTqfIfbMQu6To4QONfTJnbu47lmp8wtTkJIISRnNYAwTUPFWUjm-MHSLlOlOgU9eGKLm6VTM_WxZxFSX5mHs3gbOp_Ou_jDgVNbgzItCK6BCJSXoXfhVOCgNnH_g6F_w, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre/read, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642332167, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.144.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=CACACA232A8CD6EC9AB1D772A7D5469B, http-session-last-accessed-time=1642331873878, kc-category-name=ACCESS, kc-iat=1642331867, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:51234 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:17:53.886  INFO 16 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:17:53.890  INFO 16 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5591978f
2022-01-16 11:17:53.890  INFO 16 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5591978f
2022-01-16 11:17:53.901  INFO 16 --- [https-jsse-nio-7071-exec-5] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18910324988006999-992014, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:31aa3bfa-c095-4f10-a6c7-a9d759a8e54b:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=31aa3bfa-c095-4f10-a6c7-a9d759a8e54b, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time after Shift Start, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:17:53.902  INFO 16 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=0d8a426a-12fa-4b4a-a83c-88402533f98b, content=DENY, timestamp=1642331873902, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:31aa3bfa-c095-4f10-a6c7-a9d759a8e54b:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=31aa3bfa-c095-4f10-a6c7-a9d759a8e54b, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time after Shift Start, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:17:53.903  INFO 16 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=15ms, Total=20ms
2022-01-16 11:17:53.922  INFO 16 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=50cd26d0-291d-49fb-bfb2-cfe2fb4b8932, content=null, timestamp=1642331873914, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=51236, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=22766fcc86b6, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=aafd4250-e6a1-4378-91fb-a2a4ddd87c5e, http-req-server-port=80, http-header-accept=*/*, kc-id=77b9495c-1692-426c-96be-094189073545, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642331873913, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQAB3NxAH4AEQAAAABh4/7bdAAkNzdiOTQ5NWMtMTY5Mi00MjZjLTk2YmUtMDk0MTg5MDczNTQ1dAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRhYWZkNDI1MC1lNmExLTQzNzgtOTFmYi1hMmE0ZGRkODdjNWVwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJhY3dRY1p6TGlENW1hRl85amJINGVRVFplOElvZDdldllhOUk2eDVXWjJnIn0.eyJleHAiOjE2NDIzMzIxNjcsImlhdCI6MTY0MjMzMTg2NywianRpIjoiNzdiOTQ5NWMtMTY5Mi00MjZjLTk2YmUtMDk0MTg5MDczNTQ1IiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiJhYWZkNDI1MC1lNmExLTQzNzgtOTFmYi1hMmE0ZGRkODdjNWUiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.ep3IG5UMcj__1HopMvUFb4xo9nI32gjSZwh03RVYoaim2ExbnEMIikZYIfXlh68pK0CGsTDpWMFgwTbyE98St8icBudSUAJ7fcG3ZJGb84sN9y5pZx7kMMWsBOdB37lSq2eX5SR6l1XgEUB3QxLM6uCgqXfD8yQ7r-ZSC1WitU1NoZ3zGnlrJ4e2aMv_CbLrohDHGwrC2jJJh5Zru_VzRYxTqfIfbMQu6To4QONfTJnbu47lmp8wtTkJIISRnNYAwTUPFWUjm-MHSLlOlOgU9eGKLm6VTM_WxZxFSX5mHs3gbOp_Ou_jDgVNbgzItCK6BCJSXoXfhVOCgNnH_g6F_w, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre/read, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642332167, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.144.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=5BE15DC63379BA6A1F2FC365A6647BAA, http-session-last-accessed-time=1642331873913, kc-category-name=ACCESS, kc-iat=1642331867, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:51236 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:17:53.923  INFO 16 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:17:53.925  INFO 16 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4ff7d8bf
2022-01-16 11:17:53.932  INFO 16 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4ff7d8bf
2022-01-16 11:17:53.990  INFO 16 --- [https-jsse-nio-7071-exec-6] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18910325024603803-285731, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:31aa3bfa-c095-4f10-a6c7-a9d759a8e54b:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=31aa3bfa-c095-4f10-a6c7-a9d759a8e54b, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time after Shift Start, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:17:53.990  INFO 16 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=50cd26d0-291d-49fb-bfb2-cfe2fb4b8932, content=DENY, timestamp=1642331873990, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:31aa3bfa-c095-4f10-a6c7-a9d759a8e54b:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=31aa3bfa-c095-4f10-a6c7-a9d759a8e54b, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time after Shift Start, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:17:53.991  INFO 16 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=67ms, Total=70ms
2022-01-16 11:17:54.012  INFO 16 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=48c06352-4283-4eef-a364-81a356c7a5c6, content=null, timestamp=1642331874004, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=51238, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=22766fcc86b6, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=aafd4250-e6a1-4378-91fb-a2a4ddd87c5e, http-req-server-port=80, http-header-accept=*/*, kc-id=77b9495c-1692-426c-96be-094189073545, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642331874003, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQAB3NxAH4AEQAAAABh4/7bdAAkNzdiOTQ5NWMtMTY5Mi00MjZjLTk2YmUtMDk0MTg5MDczNTQ1dAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRhYWZkNDI1MC1lNmExLTQzNzgtOTFmYi1hMmE0ZGRkODdjNWVwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJhY3dRY1p6TGlENW1hRl85amJINGVRVFplOElvZDdldllhOUk2eDVXWjJnIn0.eyJleHAiOjE2NDIzMzIxNjcsImlhdCI6MTY0MjMzMTg2NywianRpIjoiNzdiOTQ5NWMtMTY5Mi00MjZjLTk2YmUtMDk0MTg5MDczNTQ1IiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiJhYWZkNDI1MC1lNmExLTQzNzgtOTFmYi1hMmE0ZGRkODdjNWUiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.ep3IG5UMcj__1HopMvUFb4xo9nI32gjSZwh03RVYoaim2ExbnEMIikZYIfXlh68pK0CGsTDpWMFgwTbyE98St8icBudSUAJ7fcG3ZJGb84sN9y5pZx7kMMWsBOdB37lSq2eX5SR6l1XgEUB3QxLM6uCgqXfD8yQ7r-ZSC1WitU1NoZ3zGnlrJ4e2aMv_CbLrohDHGwrC2jJJh5Zru_VzRYxTqfIfbMQu6To4QONfTJnbu47lmp8wtTkJIISRnNYAwTUPFWUjm-MHSLlOlOgU9eGKLm6VTM_WxZxFSX5mHs3gbOp_Ou_jDgVNbgzItCK6BCJSXoXfhVOCgNnH_g6F_w, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre/read, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642332167, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.144.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=2ED85657A7A4F570FACC9C0CC2D54E3B, http-session-last-accessed-time=1642331874003, kc-category-name=ACCESS, kc-iat=1642331867, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:51238 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:17:54.013  INFO 16 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:17:54.014  INFO 16 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@25f4b097
2022-01-16 11:17:54.015  INFO 16 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@25f4b097
2022-01-16 11:17:54.028  INFO 16 --- [https-jsse-nio-7071-exec-7] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18910325114224218-5095, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:31aa3bfa-c095-4f10-a6c7-a9d759a8e54b:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=31aa3bfa-c095-4f10-a6c7-a9d759a8e54b, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time after Shift Start, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:17:54.029  INFO 16 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=48c06352-4283-4eef-a364-81a356c7a5c6, content=DENY, timestamp=1642331874029, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:31aa3bfa-c095-4f10-a6c7-a9d759a8e54b:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=31aa3bfa-c095-4f10-a6c7-a9d759a8e54b, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time after Shift Start, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:17:54.030  INFO 16 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=16ms, Total=21ms
2022-01-16 11:17:54.055  INFO 16 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=029132e7-61f1-4cc9-a2c1-b2323fa04115, content=null, timestamp=1642331874049, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=51240, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=22766fcc86b6, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=aafd4250-e6a1-4378-91fb-a2a4ddd87c5e, http-req-server-port=80, http-header-accept=*/*, kc-id=77b9495c-1692-426c-96be-094189073545, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642331874044, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQAB3NxAH4AEQAAAABh4/7bdAAkNzdiOTQ5NWMtMTY5Mi00MjZjLTk2YmUtMDk0MTg5MDczNTQ1dAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRhYWZkNDI1MC1lNmExLTQzNzgtOTFmYi1hMmE0ZGRkODdjNWVwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJhY3dRY1p6TGlENW1hRl85amJINGVRVFplOElvZDdldllhOUk2eDVXWjJnIn0.eyJleHAiOjE2NDIzMzIxNjcsImlhdCI6MTY0MjMzMTg2NywianRpIjoiNzdiOTQ5NWMtMTY5Mi00MjZjLTk2YmUtMDk0MTg5MDczNTQ1IiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiJhYWZkNDI1MC1lNmExLTQzNzgtOTFmYi1hMmE0ZGRkODdjNWUiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.ep3IG5UMcj__1HopMvUFb4xo9nI32gjSZwh03RVYoaim2ExbnEMIikZYIfXlh68pK0CGsTDpWMFgwTbyE98St8icBudSUAJ7fcG3ZJGb84sN9y5pZx7kMMWsBOdB37lSq2eX5SR6l1XgEUB3QxLM6uCgqXfD8yQ7r-ZSC1WitU1NoZ3zGnlrJ4e2aMv_CbLrohDHGwrC2jJJh5Zru_VzRYxTqfIfbMQu6To4QONfTJnbu47lmp8wtTkJIISRnNYAwTUPFWUjm-MHSLlOlOgU9eGKLm6VTM_WxZxFSX5mHs3gbOp_Ou_jDgVNbgzItCK6BCJSXoXfhVOCgNnH_g6F_w, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre/read, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642332167, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.144.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=8095562F3BA1D4E2983396F46E28A8A5, http-session-last-accessed-time=1642331874044, kc-category-name=ACCESS, kc-iat=1642331867, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:51240 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:17:54.056  INFO 16 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:17:54.057  INFO 16 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@19e1ffaf
2022-01-16 11:17:54.057  INFO 16 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@19e1ffaf
2022-01-16 11:17:54.068  INFO 16 --- [https-jsse-nio-7071-exec-8] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18910325157385672-180813, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:31aa3bfa-c095-4f10-a6c7-a9d759a8e54b:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=31aa3bfa-c095-4f10-a6c7-a9d759a8e54b, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time after Shift Start, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:17:54.069  INFO 16 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=029132e7-61f1-4cc9-a2c1-b2323fa04115, content=DENY, timestamp=1642331874069, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:31aa3bfa-c095-4f10-a6c7-a9d759a8e54b:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=31aa3bfa-c095-4f10-a6c7-a9d759a8e54b, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time after Shift Start, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:17:54.070  INFO 16 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=13ms, Total=17ms
2022-01-16 11:17:54.089  INFO 16 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=eeeaa11d-f57c-4630-9413-e36365d5c38b, content=null, timestamp=1642331874082, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=51242, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=22766fcc86b6, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=aafd4250-e6a1-4378-91fb-a2a4ddd87c5e, http-req-server-port=80, http-header-accept=*/*, kc-id=77b9495c-1692-426c-96be-094189073545, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642331874081, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQAB3NxAH4AEQAAAABh4/7bdAAkNzdiOTQ5NWMtMTY5Mi00MjZjLTk2YmUtMDk0MTg5MDczNTQ1dAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRhYWZkNDI1MC1lNmExLTQzNzgtOTFmYi1hMmE0ZGRkODdjNWVwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJhY3dRY1p6TGlENW1hRl85amJINGVRVFplOElvZDdldllhOUk2eDVXWjJnIn0.eyJleHAiOjE2NDIzMzIxNjcsImlhdCI6MTY0MjMzMTg2NywianRpIjoiNzdiOTQ5NWMtMTY5Mi00MjZjLTk2YmUtMDk0MTg5MDczNTQ1IiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiJhYWZkNDI1MC1lNmExLTQzNzgtOTFmYi1hMmE0ZGRkODdjNWUiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.ep3IG5UMcj__1HopMvUFb4xo9nI32gjSZwh03RVYoaim2ExbnEMIikZYIfXlh68pK0CGsTDpWMFgwTbyE98St8icBudSUAJ7fcG3ZJGb84sN9y5pZx7kMMWsBOdB37lSq2eX5SR6l1XgEUB3QxLM6uCgqXfD8yQ7r-ZSC1WitU1NoZ3zGnlrJ4e2aMv_CbLrohDHGwrC2jJJh5Zru_VzRYxTqfIfbMQu6To4QONfTJnbu47lmp8wtTkJIISRnNYAwTUPFWUjm-MHSLlOlOgU9eGKLm6VTM_WxZxFSX5mHs3gbOp_Ou_jDgVNbgzItCK6BCJSXoXfhVOCgNnH_g6F_w, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre/read, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642332167, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.144.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=352DE02DA6B22C3D22E0C07F42105940, http-session-last-accessed-time=1642331874081, kc-category-name=ACCESS, kc-iat=1642331867, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:51242 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:17:54.089  INFO 16 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:17:54.090  INFO 16 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@65e20921
2022-01-16 11:17:54.091  INFO 16 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@65e20921
2022-01-16 11:17:54.142  INFO 16 --- [https-jsse-nio-7071-exec-9] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18910325190906818-593447, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:31aa3bfa-c095-4f10-a6c7-a9d759a8e54b:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=31aa3bfa-c095-4f10-a6c7-a9d759a8e54b, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time after Shift Start, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:17:54.143  INFO 16 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=eeeaa11d-f57c-4630-9413-e36365d5c38b, content=DENY, timestamp=1642331874143, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:31aa3bfa-c095-4f10-a6c7-a9d759a8e54b:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=31aa3bfa-c095-4f10-a6c7-a9d759a8e54b, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time after Shift Start, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:17:54.144  INFO 16 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=54ms, Total=56ms
2022-01-16 11:17:54.160  INFO 16 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=eeafcdd9-c7cc-4df6-8279-ad1c0997941f, content=null, timestamp=1642331874156, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=51244, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=22766fcc86b6, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=aafd4250-e6a1-4378-91fb-a2a4ddd87c5e, http-req-server-port=80, http-header-accept=*/*, kc-id=77b9495c-1692-426c-96be-094189073545, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642331874155, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQAB3NxAH4AEQAAAABh4/7bdAAkNzdiOTQ5NWMtMTY5Mi00MjZjLTk2YmUtMDk0MTg5MDczNTQ1dAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRhYWZkNDI1MC1lNmExLTQzNzgtOTFmYi1hMmE0ZGRkODdjNWVwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJhY3dRY1p6TGlENW1hRl85amJINGVRVFplOElvZDdldllhOUk2eDVXWjJnIn0.eyJleHAiOjE2NDIzMzIxNjcsImlhdCI6MTY0MjMzMTg2NywianRpIjoiNzdiOTQ5NWMtMTY5Mi00MjZjLTk2YmUtMDk0MTg5MDczNTQ1IiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiJhYWZkNDI1MC1lNmExLTQzNzgtOTFmYi1hMmE0ZGRkODdjNWUiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.ep3IG5UMcj__1HopMvUFb4xo9nI32gjSZwh03RVYoaim2ExbnEMIikZYIfXlh68pK0CGsTDpWMFgwTbyE98St8icBudSUAJ7fcG3ZJGb84sN9y5pZx7kMMWsBOdB37lSq2eX5SR6l1XgEUB3QxLM6uCgqXfD8yQ7r-ZSC1WitU1NoZ3zGnlrJ4e2aMv_CbLrohDHGwrC2jJJh5Zru_VzRYxTqfIfbMQu6To4QONfTJnbu47lmp8wtTkJIISRnNYAwTUPFWUjm-MHSLlOlOgU9eGKLm6VTM_WxZxFSX5mHs3gbOp_Ou_jDgVNbgzItCK6BCJSXoXfhVOCgNnH_g6F_w, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre/read, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642332167, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.144.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=AE15797D4FC6FEA7F7D29CC8226B4CE3, http-session-last-accessed-time=1642331874155, kc-category-name=ACCESS, kc-iat=1642331867, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:51244 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:17:54.160  INFO 16 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:17:54.161  INFO 16 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@48e0327d
2022-01-16 11:17:54.162  INFO 16 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@48e0327d
2022-01-16 11:17:54.174  INFO 16 --- [https-jsse-nio-7071-exec-10] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18910325262392117-327020, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:31aa3bfa-c095-4f10-a6c7-a9d759a8e54b:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=31aa3bfa-c095-4f10-a6c7-a9d759a8e54b, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time after Shift Start, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:17:54.175  INFO 16 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=eeafcdd9-c7cc-4df6-8279-ad1c0997941f, content=DENY, timestamp=1642331874175, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:31aa3bfa-c095-4f10-a6c7-a9d759a8e54b:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=31aa3bfa-c095-4f10-a6c7-a9d759a8e54b, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time after Shift Start, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:17:54.175  INFO 16 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=14ms, Total=16ms
2022-01-16 11:17:54.190  INFO 16 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=050fdc90-3749-48d0-b469-d81db52b9bf4, content=null, timestamp=1642331874186, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=51246, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=22766fcc86b6, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=aafd4250-e6a1-4378-91fb-a2a4ddd87c5e, http-req-server-port=80, http-header-accept=*/*, kc-id=77b9495c-1692-426c-96be-094189073545, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642331874184, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQAB3NxAH4AEQAAAABh4/7bdAAkNzdiOTQ5NWMtMTY5Mi00MjZjLTk2YmUtMDk0MTg5MDczNTQ1dAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRhYWZkNDI1MC1lNmExLTQzNzgtOTFmYi1hMmE0ZGRkODdjNWVwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJhY3dRY1p6TGlENW1hRl85amJINGVRVFplOElvZDdldllhOUk2eDVXWjJnIn0.eyJleHAiOjE2NDIzMzIxNjcsImlhdCI6MTY0MjMzMTg2NywianRpIjoiNzdiOTQ5NWMtMTY5Mi00MjZjLTk2YmUtMDk0MTg5MDczNTQ1IiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiJhYWZkNDI1MC1lNmExLTQzNzgtOTFmYi1hMmE0ZGRkODdjNWUiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.ep3IG5UMcj__1HopMvUFb4xo9nI32gjSZwh03RVYoaim2ExbnEMIikZYIfXlh68pK0CGsTDpWMFgwTbyE98St8icBudSUAJ7fcG3ZJGb84sN9y5pZx7kMMWsBOdB37lSq2eX5SR6l1XgEUB3QxLM6uCgqXfD8yQ7r-ZSC1WitU1NoZ3zGnlrJ4e2aMv_CbLrohDHGwrC2jJJh5Zru_VzRYxTqfIfbMQu6To4QONfTJnbu47lmp8wtTkJIISRnNYAwTUPFWUjm-MHSLlOlOgU9eGKLm6VTM_WxZxFSX5mHs3gbOp_Ou_jDgVNbgzItCK6BCJSXoXfhVOCgNnH_g6F_w, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre/read, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642332167, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.144.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=9FEB533B19B56EAAA5C37C78D3DEDA1B, http-session-last-accessed-time=1642331874184, kc-category-name=ACCESS, kc-iat=1642331867, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:51246 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:17:54.191  INFO 16 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:17:54.192  INFO 16 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6d665d70
2022-01-16 11:17:54.192  INFO 16 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6d665d70
2022-01-16 11:17:54.202  INFO 16 --- [https-jsse-nio-7071-exec-1] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18910325292400809-900872, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:31aa3bfa-c095-4f10-a6c7-a9d759a8e54b:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=31aa3bfa-c095-4f10-a6c7-a9d759a8e54b, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time after Shift Start, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:17:54.202  INFO 16 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=050fdc90-3749-48d0-b469-d81db52b9bf4, content=DENY, timestamp=1642331874202, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:31aa3bfa-c095-4f10-a6c7-a9d759a8e54b:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=31aa3bfa-c095-4f10-a6c7-a9d759a8e54b, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time after Shift Start, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:17:54.202  INFO 16 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=11ms, Total=13ms
2022-01-16 11:17:54.214  INFO 16 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=5b34cf8e-bc0b-42f1-9cb2-1f791c905059, content=null, timestamp=1642331874211, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=51248, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=22766fcc86b6, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=aafd4250-e6a1-4378-91fb-a2a4ddd87c5e, http-req-server-port=80, http-header-accept=*/*, kc-id=77b9495c-1692-426c-96be-094189073545, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642331874210, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQAB3NxAH4AEQAAAABh4/7bdAAkNzdiOTQ5NWMtMTY5Mi00MjZjLTk2YmUtMDk0MTg5MDczNTQ1dAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRhYWZkNDI1MC1lNmExLTQzNzgtOTFmYi1hMmE0ZGRkODdjNWVwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJhY3dRY1p6TGlENW1hRl85amJINGVRVFplOElvZDdldllhOUk2eDVXWjJnIn0.eyJleHAiOjE2NDIzMzIxNjcsImlhdCI6MTY0MjMzMTg2NywianRpIjoiNzdiOTQ5NWMtMTY5Mi00MjZjLTk2YmUtMDk0MTg5MDczNTQ1IiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiJhYWZkNDI1MC1lNmExLTQzNzgtOTFmYi1hMmE0ZGRkODdjNWUiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.ep3IG5UMcj__1HopMvUFb4xo9nI32gjSZwh03RVYoaim2ExbnEMIikZYIfXlh68pK0CGsTDpWMFgwTbyE98St8icBudSUAJ7fcG3ZJGb84sN9y5pZx7kMMWsBOdB37lSq2eX5SR6l1XgEUB3QxLM6uCgqXfD8yQ7r-ZSC1WitU1NoZ3zGnlrJ4e2aMv_CbLrohDHGwrC2jJJh5Zru_VzRYxTqfIfbMQu6To4QONfTJnbu47lmp8wtTkJIISRnNYAwTUPFWUjm-MHSLlOlOgU9eGKLm6VTM_WxZxFSX5mHs3gbOp_Ou_jDgVNbgzItCK6BCJSXoXfhVOCgNnH_g6F_w, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre/read, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642332167, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.144.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=500F23A739B977E085BD1142794B8EB0, http-session-last-accessed-time=1642331874210, kc-category-name=ACCESS, kc-iat=1642331867, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:51248 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:17:54.215  INFO 16 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:17:54.216  INFO 16 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1a79ffdd
2022-01-16 11:17:54.216  INFO 16 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1a79ffdd
2022-01-16 11:17:54.270  INFO 16 --- [https-jsse-nio-7071-exec-2] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18910325316675676-820757, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:31aa3bfa-c095-4f10-a6c7-a9d759a8e54b:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=31aa3bfa-c095-4f10-a6c7-a9d759a8e54b, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time after Shift Start, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:17:54.271  INFO 16 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=5b34cf8e-bc0b-42f1-9cb2-1f791c905059, content=DENY, timestamp=1642331874271, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:31aa3bfa-c095-4f10-a6c7-a9d759a8e54b:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=31aa3bfa-c095-4f10-a6c7-a9d759a8e54b, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time after Shift Start, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:17:54.271  INFO 16 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=56ms, Total=57ms
2022-01-16 11:17:54.315  INFO 16 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=e1b7a4d8-e25a-4108-b752-96b4796f2801, content=null, timestamp=1642331874286, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=51250, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=22766fcc86b6, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=aafd4250-e6a1-4378-91fb-a2a4ddd87c5e, http-req-server-port=80, http-header-accept=*/*, kc-id=77b9495c-1692-426c-96be-094189073545, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642331874285, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQAB3NxAH4AEQAAAABh4/7bdAAkNzdiOTQ5NWMtMTY5Mi00MjZjLTk2YmUtMDk0MTg5MDczNTQ1dAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRhYWZkNDI1MC1lNmExLTQzNzgtOTFmYi1hMmE0ZGRkODdjNWVwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJhY3dRY1p6TGlENW1hRl85amJINGVRVFplOElvZDdldllhOUk2eDVXWjJnIn0.eyJleHAiOjE2NDIzMzIxNjcsImlhdCI6MTY0MjMzMTg2NywianRpIjoiNzdiOTQ5NWMtMTY5Mi00MjZjLTk2YmUtMDk0MTg5MDczNTQ1IiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiJhYWZkNDI1MC1lNmExLTQzNzgtOTFmYi1hMmE0ZGRkODdjNWUiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.ep3IG5UMcj__1HopMvUFb4xo9nI32gjSZwh03RVYoaim2ExbnEMIikZYIfXlh68pK0CGsTDpWMFgwTbyE98St8icBudSUAJ7fcG3ZJGb84sN9y5pZx7kMMWsBOdB37lSq2eX5SR6l1XgEUB3QxLM6uCgqXfD8yQ7r-ZSC1WitU1NoZ3zGnlrJ4e2aMv_CbLrohDHGwrC2jJJh5Zru_VzRYxTqfIfbMQu6To4QONfTJnbu47lmp8wtTkJIISRnNYAwTUPFWUjm-MHSLlOlOgU9eGKLm6VTM_WxZxFSX5mHs3gbOp_Ou_jDgVNbgzItCK6BCJSXoXfhVOCgNnH_g6F_w, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre/read, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642332167, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.144.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=867A4D2C40A3632B1BB5E477787B0A2B, http-session-last-accessed-time=1642331874285, kc-category-name=ACCESS, kc-iat=1642331867, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:51250 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:17:54.320  INFO 16 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:17:54.322  INFO 16 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@52382f57
2022-01-16 11:17:54.322  INFO 16 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@52382f57
2022-01-16 11:17:54.336  INFO 16 --- [https-jsse-nio-7071-exec-6] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18910325421583843-257686, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:31aa3bfa-c095-4f10-a6c7-a9d759a8e54b:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=31aa3bfa-c095-4f10-a6c7-a9d759a8e54b, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time after Shift Start, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:17:54.336  INFO 16 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=e1b7a4d8-e25a-4108-b752-96b4796f2801, content=DENY, timestamp=1642331874336, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:31aa3bfa-c095-4f10-a6c7-a9d759a8e54b:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=31aa3bfa-c095-4f10-a6c7-a9d759a8e54b, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time after Shift Start, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:17:54.336  INFO 16 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=16ms, Total=24ms
2022-01-16 11:17:54.353  INFO 16 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=b8213228-c992-43b0-8cf3-4e1d5f509cc6, content=null, timestamp=1642331874348, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=51254, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=22766fcc86b6, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=aafd4250-e6a1-4378-91fb-a2a4ddd87c5e, http-req-server-port=80, http-header-accept=*/*, kc-id=77b9495c-1692-426c-96be-094189073545, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642331874346, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQAB3NxAH4AEQAAAABh4/7bdAAkNzdiOTQ5NWMtMTY5Mi00MjZjLTk2YmUtMDk0MTg5MDczNTQ1dAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRhYWZkNDI1MC1lNmExLTQzNzgtOTFmYi1hMmE0ZGRkODdjNWVwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJhY3dRY1p6TGlENW1hRl85amJINGVRVFplOElvZDdldllhOUk2eDVXWjJnIn0.eyJleHAiOjE2NDIzMzIxNjcsImlhdCI6MTY0MjMzMTg2NywianRpIjoiNzdiOTQ5NWMtMTY5Mi00MjZjLTk2YmUtMDk0MTg5MDczNTQ1IiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiJhYWZkNDI1MC1lNmExLTQzNzgtOTFmYi1hMmE0ZGRkODdjNWUiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.ep3IG5UMcj__1HopMvUFb4xo9nI32gjSZwh03RVYoaim2ExbnEMIikZYIfXlh68pK0CGsTDpWMFgwTbyE98St8icBudSUAJ7fcG3ZJGb84sN9y5pZx7kMMWsBOdB37lSq2eX5SR6l1XgEUB3QxLM6uCgqXfD8yQ7r-ZSC1WitU1NoZ3zGnlrJ4e2aMv_CbLrohDHGwrC2jJJh5Zru_VzRYxTqfIfbMQu6To4QONfTJnbu47lmp8wtTkJIISRnNYAwTUPFWUjm-MHSLlOlOgU9eGKLm6VTM_WxZxFSX5mHs3gbOp_Ou_jDgVNbgzItCK6BCJSXoXfhVOCgNnH_g6F_w, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre/read, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642332167, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.144.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=7391E931D9B36463CE782B29720E521B, http-session-last-accessed-time=1642331874346, kc-category-name=ACCESS, kc-iat=1642331867, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:51254 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:17:54.354  INFO 16 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:17:54.355  INFO 16 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1c9ac527
2022-01-16 11:17:54.355  INFO 16 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1c9ac527
2022-01-16 11:17:54.368  INFO 16 --- [https-jsse-nio-7071-exec-7] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18910325455704919-138541, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:31aa3bfa-c095-4f10-a6c7-a9d759a8e54b:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=31aa3bfa-c095-4f10-a6c7-a9d759a8e54b, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time after Shift Start, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:17:54.368  INFO 16 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=b8213228-c992-43b0-8cf3-4e1d5f509cc6, content=DENY, timestamp=1642331874368, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:31aa3bfa-c095-4f10-a6c7-a9d759a8e54b:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=31aa3bfa-c095-4f10-a6c7-a9d759a8e54b, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time after Shift Start, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:17:54.369  INFO 16 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=14ms, Total=17ms
2022-01-16 11:17:54.384  INFO 16 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=5b8907c1-ba6f-4c69-af92-5b788608f30c, content=null, timestamp=1642331874380, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=51256, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=22766fcc86b6, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=aafd4250-e6a1-4378-91fb-a2a4ddd87c5e, http-req-server-port=80, http-header-accept=*/*, kc-id=77b9495c-1692-426c-96be-094189073545, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642331874379, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQAB3NxAH4AEQAAAABh4/7bdAAkNzdiOTQ5NWMtMTY5Mi00MjZjLTk2YmUtMDk0MTg5MDczNTQ1dAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRhYWZkNDI1MC1lNmExLTQzNzgtOTFmYi1hMmE0ZGRkODdjNWVwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJhY3dRY1p6TGlENW1hRl85amJINGVRVFplOElvZDdldllhOUk2eDVXWjJnIn0.eyJleHAiOjE2NDIzMzIxNjcsImlhdCI6MTY0MjMzMTg2NywianRpIjoiNzdiOTQ5NWMtMTY5Mi00MjZjLTk2YmUtMDk0MTg5MDczNTQ1IiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiJhYWZkNDI1MC1lNmExLTQzNzgtOTFmYi1hMmE0ZGRkODdjNWUiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.ep3IG5UMcj__1HopMvUFb4xo9nI32gjSZwh03RVYoaim2ExbnEMIikZYIfXlh68pK0CGsTDpWMFgwTbyE98St8icBudSUAJ7fcG3ZJGb84sN9y5pZx7kMMWsBOdB37lSq2eX5SR6l1XgEUB3QxLM6uCgqXfD8yQ7r-ZSC1WitU1NoZ3zGnlrJ4e2aMv_CbLrohDHGwrC2jJJh5Zru_VzRYxTqfIfbMQu6To4QONfTJnbu47lmp8wtTkJIISRnNYAwTUPFWUjm-MHSLlOlOgU9eGKLm6VTM_WxZxFSX5mHs3gbOp_Ou_jDgVNbgzItCK6BCJSXoXfhVOCgNnH_g6F_w, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre/read, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642332167, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.144.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=3824E8201F121CF1166A5BFEE5B3C4A8, http-session-last-accessed-time=1642331874379, kc-category-name=ACCESS, kc-iat=1642331867, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:51256 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:17:54.385  INFO 16 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:17:54.385  INFO 16 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@92c1f9a
2022-01-16 11:17:54.386  INFO 16 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@92c1f9a
2022-01-16 11:17:54.441  INFO 16 --- [https-jsse-nio-7071-exec-8] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18910325486463001-996191, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:31aa3bfa-c095-4f10-a6c7-a9d759a8e54b:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=31aa3bfa-c095-4f10-a6c7-a9d759a8e54b, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time after Shift Start, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:17:54.442  INFO 16 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=5b8907c1-ba6f-4c69-af92-5b788608f30c, content=DENY, timestamp=1642331874442, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:31aa3bfa-c095-4f10-a6c7-a9d759a8e54b:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=31aa3bfa-c095-4f10-a6c7-a9d759a8e54b, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time after Shift Start, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:17:54.442  INFO 16 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=57ms, Total=59ms
2022-01-16 11:17:54.463  INFO 16 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=7039e088-9556-4eb5-a7c4-9063130acf1f, content=null, timestamp=1642331874459, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=51258, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=22766fcc86b6, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=aafd4250-e6a1-4378-91fb-a2a4ddd87c5e, http-req-server-port=80, http-header-accept=*/*, kc-id=77b9495c-1692-426c-96be-094189073545, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642331874458, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQAB3NxAH4AEQAAAABh4/7bdAAkNzdiOTQ5NWMtMTY5Mi00MjZjLTk2YmUtMDk0MTg5MDczNTQ1dAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRhYWZkNDI1MC1lNmExLTQzNzgtOTFmYi1hMmE0ZGRkODdjNWVwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJhY3dRY1p6TGlENW1hRl85amJINGVRVFplOElvZDdldllhOUk2eDVXWjJnIn0.eyJleHAiOjE2NDIzMzIxNjcsImlhdCI6MTY0MjMzMTg2NywianRpIjoiNzdiOTQ5NWMtMTY5Mi00MjZjLTk2YmUtMDk0MTg5MDczNTQ1IiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiJhYWZkNDI1MC1lNmExLTQzNzgtOTFmYi1hMmE0ZGRkODdjNWUiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.ep3IG5UMcj__1HopMvUFb4xo9nI32gjSZwh03RVYoaim2ExbnEMIikZYIfXlh68pK0CGsTDpWMFgwTbyE98St8icBudSUAJ7fcG3ZJGb84sN9y5pZx7kMMWsBOdB37lSq2eX5SR6l1XgEUB3QxLM6uCgqXfD8yQ7r-ZSC1WitU1NoZ3zGnlrJ4e2aMv_CbLrohDHGwrC2jJJh5Zru_VzRYxTqfIfbMQu6To4QONfTJnbu47lmp8wtTkJIISRnNYAwTUPFWUjm-MHSLlOlOgU9eGKLm6VTM_WxZxFSX5mHs3gbOp_Ou_jDgVNbgzItCK6BCJSXoXfhVOCgNnH_g6F_w, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre/read, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642332167, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.144.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=78C33893D8C569AE060AE1733E35149C, http-session-last-accessed-time=1642331874458, kc-category-name=ACCESS, kc-iat=1642331867, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:51258 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:17:54.463  INFO 16 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:17:54.464  INFO 16 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@14b99d86
2022-01-16 11:17:54.465  INFO 16 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@14b99d86
2022-01-16 11:17:54.475  INFO 16 --- [https-jsse-nio-7071-exec-9] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18910325564891484-808343, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:31aa3bfa-c095-4f10-a6c7-a9d759a8e54b:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=31aa3bfa-c095-4f10-a6c7-a9d759a8e54b, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time after Shift Start, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:17:54.475  INFO 16 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=7039e088-9556-4eb5-a7c4-9063130acf1f, content=DENY, timestamp=1642331874475, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:31aa3bfa-c095-4f10-a6c7-a9d759a8e54b:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=31aa3bfa-c095-4f10-a6c7-a9d759a8e54b, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time after Shift Start, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:17:54.476  INFO 16 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=12ms, Total=14ms
2022-01-16 11:17:54.490  INFO 16 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=70d78718-4ca8-4944-8940-e0f04f2d9058, content=null, timestamp=1642331874484, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=51260, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=22766fcc86b6, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=aafd4250-e6a1-4378-91fb-a2a4ddd87c5e, http-req-server-port=80, http-header-accept=*/*, kc-id=77b9495c-1692-426c-96be-094189073545, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642331874484, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQAB3NxAH4AEQAAAABh4/7bdAAkNzdiOTQ5NWMtMTY5Mi00MjZjLTk2YmUtMDk0MTg5MDczNTQ1dAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRhYWZkNDI1MC1lNmExLTQzNzgtOTFmYi1hMmE0ZGRkODdjNWVwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJhY3dRY1p6TGlENW1hRl85amJINGVRVFplOElvZDdldllhOUk2eDVXWjJnIn0.eyJleHAiOjE2NDIzMzIxNjcsImlhdCI6MTY0MjMzMTg2NywianRpIjoiNzdiOTQ5NWMtMTY5Mi00MjZjLTk2YmUtMDk0MTg5MDczNTQ1IiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiJhYWZkNDI1MC1lNmExLTQzNzgtOTFmYi1hMmE0ZGRkODdjNWUiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.ep3IG5UMcj__1HopMvUFb4xo9nI32gjSZwh03RVYoaim2ExbnEMIikZYIfXlh68pK0CGsTDpWMFgwTbyE98St8icBudSUAJ7fcG3ZJGb84sN9y5pZx7kMMWsBOdB37lSq2eX5SR6l1XgEUB3QxLM6uCgqXfD8yQ7r-ZSC1WitU1NoZ3zGnlrJ4e2aMv_CbLrohDHGwrC2jJJh5Zru_VzRYxTqfIfbMQu6To4QONfTJnbu47lmp8wtTkJIISRnNYAwTUPFWUjm-MHSLlOlOgU9eGKLm6VTM_WxZxFSX5mHs3gbOp_Ou_jDgVNbgzItCK6BCJSXoXfhVOCgNnH_g6F_w, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre/read, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642332167, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.144.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=ACEA6D80FF5C217B522233F78D7DDC78, http-session-last-accessed-time=1642331874484, kc-category-name=ACCESS, kc-iat=1642331867, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:51260 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:17:54.494  INFO 16 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:17:54.496  INFO 16 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6f18cff7
2022-01-16 11:17:54.496  INFO 16 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6f18cff7
2022-01-16 11:17:54.509  INFO 16 --- [https-jsse-nio-7071-exec-10] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18910325595581792-113147, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:31aa3bfa-c095-4f10-a6c7-a9d759a8e54b:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=31aa3bfa-c095-4f10-a6c7-a9d759a8e54b, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time after Shift Start, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:17:54.510  INFO 16 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=70d78718-4ca8-4944-8940-e0f04f2d9058, content=DENY, timestamp=1642331874510, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:31aa3bfa-c095-4f10-a6c7-a9d759a8e54b:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=31aa3bfa-c095-4f10-a6c7-a9d759a8e54b, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time after Shift Start, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:17:54.511  INFO 16 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=16ms, Total=23ms
2022-01-16 11:17:54.525  INFO 16 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=acdf4150-8001-48d9-8aec-51211abd1512, content=null, timestamp=1642331874520, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=51262, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=22766fcc86b6, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=aafd4250-e6a1-4378-91fb-a2a4ddd87c5e, http-req-server-port=80, http-header-accept=*/*, kc-id=77b9495c-1692-426c-96be-094189073545, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642331874520, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQAB3NxAH4AEQAAAABh4/7bdAAkNzdiOTQ5NWMtMTY5Mi00MjZjLTk2YmUtMDk0MTg5MDczNTQ1dAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRhYWZkNDI1MC1lNmExLTQzNzgtOTFmYi1hMmE0ZGRkODdjNWVwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJhY3dRY1p6TGlENW1hRl85amJINGVRVFplOElvZDdldllhOUk2eDVXWjJnIn0.eyJleHAiOjE2NDIzMzIxNjcsImlhdCI6MTY0MjMzMTg2NywianRpIjoiNzdiOTQ5NWMtMTY5Mi00MjZjLTk2YmUtMDk0MTg5MDczNTQ1IiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiJhYWZkNDI1MC1lNmExLTQzNzgtOTFmYi1hMmE0ZGRkODdjNWUiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.ep3IG5UMcj__1HopMvUFb4xo9nI32gjSZwh03RVYoaim2ExbnEMIikZYIfXlh68pK0CGsTDpWMFgwTbyE98St8icBudSUAJ7fcG3ZJGb84sN9y5pZx7kMMWsBOdB37lSq2eX5SR6l1XgEUB3QxLM6uCgqXfD8yQ7r-ZSC1WitU1NoZ3zGnlrJ4e2aMv_CbLrohDHGwrC2jJJh5Zru_VzRYxTqfIfbMQu6To4QONfTJnbu47lmp8wtTkJIISRnNYAwTUPFWUjm-MHSLlOlOgU9eGKLm6VTM_WxZxFSX5mHs3gbOp_Ou_jDgVNbgzItCK6BCJSXoXfhVOCgNnH_g6F_w, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre/read, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642332167, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.144.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=881DEAECBD8DF3BD9F0834023DD4A6C5, http-session-last-accessed-time=1642331874520, kc-category-name=ACCESS, kc-iat=1642331867, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:51262 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:17:54.526  INFO 16 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:17:54.526  INFO 16 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@632b573c
2022-01-16 11:17:54.527  INFO 16 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@632b573c
2022-01-16 11:17:54.578  INFO 16 --- [https-jsse-nio-7071-exec-1] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18910325627545661-926857, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:31aa3bfa-c095-4f10-a6c7-a9d759a8e54b:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=31aa3bfa-c095-4f10-a6c7-a9d759a8e54b, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time after Shift Start, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:17:54.579  INFO 16 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=acdf4150-8001-48d9-8aec-51211abd1512, content=DENY, timestamp=1642331874579, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:31aa3bfa-c095-4f10-a6c7-a9d759a8e54b:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=31aa3bfa-c095-4f10-a6c7-a9d759a8e54b, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time after Shift Start, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:17:54.579  INFO 16 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=53ms, Total=56ms
2022-01-16 11:17:54.592  INFO 16 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=aa7ec55d-905a-4861-9746-517e96416886, content=null, timestamp=1642331874588, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=51264, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=22766fcc86b6, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=aafd4250-e6a1-4378-91fb-a2a4ddd87c5e, http-req-server-port=80, http-header-accept=*/*, kc-id=77b9495c-1692-426c-96be-094189073545, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642331874587, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQAB3NxAH4AEQAAAABh4/7bdAAkNzdiOTQ5NWMtMTY5Mi00MjZjLTk2YmUtMDk0MTg5MDczNTQ1dAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRhYWZkNDI1MC1lNmExLTQzNzgtOTFmYi1hMmE0ZGRkODdjNWVwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJhY3dRY1p6TGlENW1hRl85amJINGVRVFplOElvZDdldllhOUk2eDVXWjJnIn0.eyJleHAiOjE2NDIzMzIxNjcsImlhdCI6MTY0MjMzMTg2NywianRpIjoiNzdiOTQ5NWMtMTY5Mi00MjZjLTk2YmUtMDk0MTg5MDczNTQ1IiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiJhYWZkNDI1MC1lNmExLTQzNzgtOTFmYi1hMmE0ZGRkODdjNWUiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.ep3IG5UMcj__1HopMvUFb4xo9nI32gjSZwh03RVYoaim2ExbnEMIikZYIfXlh68pK0CGsTDpWMFgwTbyE98St8icBudSUAJ7fcG3ZJGb84sN9y5pZx7kMMWsBOdB37lSq2eX5SR6l1XgEUB3QxLM6uCgqXfD8yQ7r-ZSC1WitU1NoZ3zGnlrJ4e2aMv_CbLrohDHGwrC2jJJh5Zru_VzRYxTqfIfbMQu6To4QONfTJnbu47lmp8wtTkJIISRnNYAwTUPFWUjm-MHSLlOlOgU9eGKLm6VTM_WxZxFSX5mHs3gbOp_Ou_jDgVNbgzItCK6BCJSXoXfhVOCgNnH_g6F_w, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre/read, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642332167, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.144.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=BBF7314391C2A1E10A707A6EDA65EAD2, http-session-last-accessed-time=1642331874587, kc-category-name=ACCESS, kc-iat=1642331867, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:51264 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:17:54.592  INFO 16 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:17:54.593  INFO 16 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7a14895
2022-01-16 11:17:54.593  INFO 16 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7a14895
2022-01-16 11:17:54.604  INFO 16 --- [https-jsse-nio-7071-exec-2] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18910325693589912-701025, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:31aa3bfa-c095-4f10-a6c7-a9d759a8e54b:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=31aa3bfa-c095-4f10-a6c7-a9d759a8e54b, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time after Shift Start, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:17:54.604  INFO 16 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=aa7ec55d-905a-4861-9746-517e96416886, content=DENY, timestamp=1642331874604, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:31aa3bfa-c095-4f10-a6c7-a9d759a8e54b:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=31aa3bfa-c095-4f10-a6c7-a9d759a8e54b, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time after Shift Start, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:17:54.604  INFO 16 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=12ms, Total=13ms
2022-01-16 11:17:54.624  INFO 16 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=a8bc8e0d-60fc-48f2-ac2e-be5537abc882, content=null, timestamp=1642331874616, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=51266, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=22766fcc86b6, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=aafd4250-e6a1-4378-91fb-a2a4ddd87c5e, http-req-server-port=80, http-header-accept=*/*, kc-id=77b9495c-1692-426c-96be-094189073545, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642331874614, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQAB3NxAH4AEQAAAABh4/7bdAAkNzdiOTQ5NWMtMTY5Mi00MjZjLTk2YmUtMDk0MTg5MDczNTQ1dAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRhYWZkNDI1MC1lNmExLTQzNzgtOTFmYi1hMmE0ZGRkODdjNWVwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJhY3dRY1p6TGlENW1hRl85amJINGVRVFplOElvZDdldllhOUk2eDVXWjJnIn0.eyJleHAiOjE2NDIzMzIxNjcsImlhdCI6MTY0MjMzMTg2NywianRpIjoiNzdiOTQ5NWMtMTY5Mi00MjZjLTk2YmUtMDk0MTg5MDczNTQ1IiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiJhYWZkNDI1MC1lNmExLTQzNzgtOTFmYi1hMmE0ZGRkODdjNWUiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.ep3IG5UMcj__1HopMvUFb4xo9nI32gjSZwh03RVYoaim2ExbnEMIikZYIfXlh68pK0CGsTDpWMFgwTbyE98St8icBudSUAJ7fcG3ZJGb84sN9y5pZx7kMMWsBOdB37lSq2eX5SR6l1XgEUB3QxLM6uCgqXfD8yQ7r-ZSC1WitU1NoZ3zGnlrJ4e2aMv_CbLrohDHGwrC2jJJh5Zru_VzRYxTqfIfbMQu6To4QONfTJnbu47lmp8wtTkJIISRnNYAwTUPFWUjm-MHSLlOlOgU9eGKLm6VTM_WxZxFSX5mHs3gbOp_Ou_jDgVNbgzItCK6BCJSXoXfhVOCgNnH_g6F_w, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre/read, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642332167, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.144.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=77D6E095803137A3BA7893B6721E0899, http-session-last-accessed-time=1642331874614, kc-category-name=ACCESS, kc-iat=1642331867, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:51266 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:17:54.625  INFO 16 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:17:54.628  INFO 16 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7e9304c8
2022-01-16 11:17:54.628  INFO 16 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7e9304c8
2022-01-16 11:17:54.641  INFO 16 --- [https-jsse-nio-7071-exec-3] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18910325726107176-596572, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:31aa3bfa-c095-4f10-a6c7-a9d759a8e54b:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=31aa3bfa-c095-4f10-a6c7-a9d759a8e54b, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time after Shift Start, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:17:54.641  INFO 16 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=a8bc8e0d-60fc-48f2-ac2e-be5537abc882, content=DENY, timestamp=1642331874641, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:31aa3bfa-c095-4f10-a6c7-a9d759a8e54b:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=31aa3bfa-c095-4f10-a6c7-a9d759a8e54b, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time after Shift Start, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:17:54.642  INFO 16 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=16ms, Total=19ms
2022-01-16 11:17:54.657  INFO 16 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=d60b87ff-7708-483f-a9f2-bfc465101810, content=null, timestamp=1642331874652, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=51268, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=22766fcc86b6, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=aafd4250-e6a1-4378-91fb-a2a4ddd87c5e, http-req-server-port=80, http-header-accept=*/*, kc-id=77b9495c-1692-426c-96be-094189073545, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642331874651, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQAB3NxAH4AEQAAAABh4/7bdAAkNzdiOTQ5NWMtMTY5Mi00MjZjLTk2YmUtMDk0MTg5MDczNTQ1dAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRhYWZkNDI1MC1lNmExLTQzNzgtOTFmYi1hMmE0ZGRkODdjNWVwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJhY3dRY1p6TGlENW1hRl85amJINGVRVFplOElvZDdldllhOUk2eDVXWjJnIn0.eyJleHAiOjE2NDIzMzIxNjcsImlhdCI6MTY0MjMzMTg2NywianRpIjoiNzdiOTQ5NWMtMTY5Mi00MjZjLTk2YmUtMDk0MTg5MDczNTQ1IiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiJhYWZkNDI1MC1lNmExLTQzNzgtOTFmYi1hMmE0ZGRkODdjNWUiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.ep3IG5UMcj__1HopMvUFb4xo9nI32gjSZwh03RVYoaim2ExbnEMIikZYIfXlh68pK0CGsTDpWMFgwTbyE98St8icBudSUAJ7fcG3ZJGb84sN9y5pZx7kMMWsBOdB37lSq2eX5SR6l1XgEUB3QxLM6uCgqXfD8yQ7r-ZSC1WitU1NoZ3zGnlrJ4e2aMv_CbLrohDHGwrC2jJJh5Zru_VzRYxTqfIfbMQu6To4QONfTJnbu47lmp8wtTkJIISRnNYAwTUPFWUjm-MHSLlOlOgU9eGKLm6VTM_WxZxFSX5mHs3gbOp_Ou_jDgVNbgzItCK6BCJSXoXfhVOCgNnH_g6F_w, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre/read, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642332167, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.144.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=539FA58D11E1BA928E45A48855776C07, http-session-last-accessed-time=1642331874651, kc-category-name=ACCESS, kc-iat=1642331867, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:51268 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:17:54.658  INFO 16 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:17:54.659  INFO 16 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3e23464e
2022-01-16 11:17:54.659  INFO 16 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3e23464e
2022-01-16 11:17:54.715  INFO 16 --- [https-jsse-nio-7071-exec-4] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18910325759498993-470798, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:31aa3bfa-c095-4f10-a6c7-a9d759a8e54b:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=31aa3bfa-c095-4f10-a6c7-a9d759a8e54b, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time after Shift Start, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:17:54.715  INFO 16 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=d60b87ff-7708-483f-a9f2-bfc465101810, content=DENY, timestamp=1642331874715, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:31aa3bfa-c095-4f10-a6c7-a9d759a8e54b:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=31aa3bfa-c095-4f10-a6c7-a9d759a8e54b, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time after Shift Start, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:17:54.717  INFO 16 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=57ms, Total=61ms
2022-01-16 11:17:54.733  INFO 16 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=49f0ec60-1ece-4b6b-9760-d703b226e673, content=null, timestamp=1642331874729, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=51270, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=22766fcc86b6, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=aafd4250-e6a1-4378-91fb-a2a4ddd87c5e, http-req-server-port=80, http-header-accept=*/*, kc-id=77b9495c-1692-426c-96be-094189073545, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642331874728, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQAB3NxAH4AEQAAAABh4/7bdAAkNzdiOTQ5NWMtMTY5Mi00MjZjLTk2YmUtMDk0MTg5MDczNTQ1dAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRhYWZkNDI1MC1lNmExLTQzNzgtOTFmYi1hMmE0ZGRkODdjNWVwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJhY3dRY1p6TGlENW1hRl85amJINGVRVFplOElvZDdldllhOUk2eDVXWjJnIn0.eyJleHAiOjE2NDIzMzIxNjcsImlhdCI6MTY0MjMzMTg2NywianRpIjoiNzdiOTQ5NWMtMTY5Mi00MjZjLTk2YmUtMDk0MTg5MDczNTQ1IiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiJhYWZkNDI1MC1lNmExLTQzNzgtOTFmYi1hMmE0ZGRkODdjNWUiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.ep3IG5UMcj__1HopMvUFb4xo9nI32gjSZwh03RVYoaim2ExbnEMIikZYIfXlh68pK0CGsTDpWMFgwTbyE98St8icBudSUAJ7fcG3ZJGb84sN9y5pZx7kMMWsBOdB37lSq2eX5SR6l1XgEUB3QxLM6uCgqXfD8yQ7r-ZSC1WitU1NoZ3zGnlrJ4e2aMv_CbLrohDHGwrC2jJJh5Zru_VzRYxTqfIfbMQu6To4QONfTJnbu47lmp8wtTkJIISRnNYAwTUPFWUjm-MHSLlOlOgU9eGKLm6VTM_WxZxFSX5mHs3gbOp_Ou_jDgVNbgzItCK6BCJSXoXfhVOCgNnH_g6F_w, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre/read, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642332167, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.144.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=8D6762F749FE76EDCA8A0930C82E7EB7, http-session-last-accessed-time=1642331874728, kc-category-name=ACCESS, kc-iat=1642331867, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:51270 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:17:54.734  INFO 16 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:17:54.735  INFO 16 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@53904fad
2022-01-16 11:17:54.735  INFO 16 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@53904fad
2022-01-16 11:17:54.748  INFO 16 --- [https-jsse-nio-7071-exec-5] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18910325835330928-871590, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:31aa3bfa-c095-4f10-a6c7-a9d759a8e54b:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=31aa3bfa-c095-4f10-a6c7-a9d759a8e54b, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time after Shift Start, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:17:54.748  INFO 16 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=49f0ec60-1ece-4b6b-9760-d703b226e673, content=DENY, timestamp=1642331874748, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:31aa3bfa-c095-4f10-a6c7-a9d759a8e54b:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=31aa3bfa-c095-4f10-a6c7-a9d759a8e54b, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time after Shift Start, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:17:54.749  INFO 16 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=14ms, Total=17ms