Durations for: Evaluation=121ms, Total=150ms
2022-01-11 12:54:32.481  INFO 14 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=481bf26d-b824-4d1a-a9a8-b4537d1d6818, content=null, timestamp=1641905672469, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=65162, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=eb230e1d0f5c, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.29.0.1, kc-session-state=5479e8ce-ab30-4375-a9ec-31812ab40e37, http-req-server-port=80, http-header-accept=*/*, kc-id=3f3eb186-3198-4309-999b-06de29e30711, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641905672464, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd1/MXNxAH4AEQAAAABh3X4FdAAkM2YzZWIxODYtMzE5OC00MzA5LTk5OWItMDZkZTI5ZTMwNzExdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkNTQ3OWU4Y2UtYWIzMC00Mzc1LWE5ZWMtMzE4MTJhYjQwZTM3cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJIWlNtUmxVS3VKU2sxNUJ6ZEt5UGdzcW90aHA1ZEtYRlVDZmluNi1qVDlNIn0.eyJleHAiOjE2NDE5MDU5NjksImlhdCI6MTY0MTkwNTY2OSwianRpIjoiM2YzZWIxODYtMzE5OC00MzA5LTk5OWItMDZkZTI5ZTMwNzExIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiNTQ3OWU4Y2UtYWIzMC00Mzc1LWE5ZWMtMzE4MTJhYjQwZTM3IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Qo2snvszM0ZptvUZiRHLSSO4nz1K0HwEkVPSMfl64bUpFF7dFqQatXHINmKGObf_HLuTviCYih0aDatO_ipy06Y4tSx-aQoewxxEkeGWRmVOlyiyrp9j-XJN3TfhF57Y_19HdtT3yLszqb0mJeIPLO66K0ls96aqjCfn6YfyylVsBiWomsvHUxklb_mZZG8pJiQ82iyMA9KVgkGo68ujHKEGB8BLP7kfxEgM45fP2DCeuElpkQXJGWVhoQITnrDPYnX1L5RBBl1Sy_HFgupsV5mv6e-qEj8poRZxLJqEYv3n762T5wWyc230vjqeenX7NuDmygQK97M3dJdqg3rVQA, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641905969, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=172.29.0.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.29.0.1, http-session-id=1D42281117889380D757734C54F34DDF, http-session-last-accessed-time=1641905672464, kc-category-name=ACCESS, kc-iat=1641905669, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.29.0.1:65162 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 12:54:32.488  INFO 14 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 12:54:32.493  INFO 14 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3c0302cd
2022-01-11 12:54:32.496  INFO 14 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3c0302cd
2022-01-11 12:54:32.529  INFO 14 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3c0302cd
2022-01-11 12:54:32.533  INFO 14 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3c0302cd
2022-01-11 12:54:32.625  INFO 14 --- [https-jsse-nio-7071-exec-3] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-4852039483475-647484, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:b90c11d7-db11-4fad-aaae-8c841010ad99:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=b90c11d7-db11-4fad-aaae-8c841010ad99, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time before Shift end, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-11 12:54:32.629  INFO 14 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=481bf26d-b824-4d1a-a9a8-b4537d1d6818, content=DENY, timestamp=1641905672629, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:b90c11d7-db11-4fad-aaae-8c841010ad99:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=b90c11d7-db11-4fad-aaae-8c841010ad99, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time before Shift end, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-11 12:54:32.633  INFO 14 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=137ms, Total=156ms
2022-01-11 12:54:32.693  INFO 14 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=169f00a8-f7c3-490d-bba5-ff25a974ba09, content=null, timestamp=1641905672675, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=65164, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=eb230e1d0f5c, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.29.0.1, kc-session-state=5479e8ce-ab30-4375-a9ec-31812ab40e37, http-req-server-port=80, http-header-accept=*/*, kc-id=3f3eb186-3198-4309-999b-06de29e30711, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641905672674, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd1/MXNxAH4AEQAAAABh3X4FdAAkM2YzZWIxODYtMzE5OC00MzA5LTk5OWItMDZkZTI5ZTMwNzExdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkNTQ3OWU4Y2UtYWIzMC00Mzc1LWE5ZWMtMzE4MTJhYjQwZTM3cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJIWlNtUmxVS3VKU2sxNUJ6ZEt5UGdzcW90aHA1ZEtYRlVDZmluNi1qVDlNIn0.eyJleHAiOjE2NDE5MDU5NjksImlhdCI6MTY0MTkwNTY2OSwianRpIjoiM2YzZWIxODYtMzE5OC00MzA5LTk5OWItMDZkZTI5ZTMwNzExIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiNTQ3OWU4Y2UtYWIzMC00Mzc1LWE5ZWMtMzE4MTJhYjQwZTM3IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Qo2snvszM0ZptvUZiRHLSSO4nz1K0HwEkVPSMfl64bUpFF7dFqQatXHINmKGObf_HLuTviCYih0aDatO_ipy06Y4tSx-aQoewxxEkeGWRmVOlyiyrp9j-XJN3TfhF57Y_19HdtT3yLszqb0mJeIPLO66K0ls96aqjCfn6YfyylVsBiWomsvHUxklb_mZZG8pJiQ82iyMA9KVgkGo68ujHKEGB8BLP7kfxEgM45fP2DCeuElpkQXJGWVhoQITnrDPYnX1L5RBBl1Sy_HFgupsV5mv6e-qEj8poRZxLJqEYv3n762T5wWyc230vjqeenX7NuDmygQK97M3dJdqg3rVQA, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641905969, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=172.29.0.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.29.0.1, http-session-id=C70F94ECD1FC36AED6D01B75B99DB401, http-session-last-accessed-time=1641905672674, kc-category-name=ACCESS, kc-iat=1641905669, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.29.0.1:65164 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 12:54:32.699  INFO 14 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 12:54:32.702  INFO 14 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@594a3861
2022-01-11 12:54:32.709  INFO 14 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@594a3861
2022-01-11 12:54:32.748  INFO 14 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@594a3861
2022-01-11 12:54:32.752  INFO 14 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@594a3861
2022-01-11 12:54:32.799  INFO 14 --- [https-jsse-nio-7071-exec-4] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-4852248835875-432043, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:b90c11d7-db11-4fad-aaae-8c841010ad99:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=b90c11d7-db11-4fad-aaae-8c841010ad99, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time before Shift end, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-11 12:54:32.803  INFO 14 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=169f00a8-f7c3-490d-bba5-ff25a974ba09, content=DENY, timestamp=1641905672803, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:b90c11d7-db11-4fad-aaae-8c841010ad99:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=b90c11d7-db11-4fad-aaae-8c841010ad99, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time before Shift end, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-11 12:54:32.809  INFO 14 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=102ms, Total=117ms
2022-01-11 12:54:32.895  INFO 14 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=fb7e257e-ffe3-416b-858f-5a0ba0a5c411, content=null, timestamp=1641905672875, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=65166, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=eb230e1d0f5c, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.29.0.1, kc-session-state=5479e8ce-ab30-4375-a9ec-31812ab40e37, http-req-server-port=80, http-header-accept=*/*, kc-id=3f3eb186-3198-4309-999b-06de29e30711, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641905672860, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd1/MXNxAH4AEQAAAABh3X4FdAAkM2YzZWIxODYtMzE5OC00MzA5LTk5OWItMDZkZTI5ZTMwNzExdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkNTQ3OWU4Y2UtYWIzMC00Mzc1LWE5ZWMtMzE4MTJhYjQwZTM3cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJIWlNtUmxVS3VKU2sxNUJ6ZEt5UGdzcW90aHA1ZEtYRlVDZmluNi1qVDlNIn0.eyJleHAiOjE2NDE5MDU5NjksImlhdCI6MTY0MTkwNTY2OSwianRpIjoiM2YzZWIxODYtMzE5OC00MzA5LTk5OWItMDZkZTI5ZTMwNzExIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiNTQ3OWU4Y2UtYWIzMC00Mzc1LWE5ZWMtMzE4MTJhYjQwZTM3IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Qo2snvszM0ZptvUZiRHLSSO4nz1K0HwEkVPSMfl64bUpFF7dFqQatXHINmKGObf_HLuTviCYih0aDatO_ipy06Y4tSx-aQoewxxEkeGWRmVOlyiyrp9j-XJN3TfhF57Y_19HdtT3yLszqb0mJeIPLO66K0ls96aqjCfn6YfyylVsBiWomsvHUxklb_mZZG8pJiQ82iyMA9KVgkGo68ujHKEGB8BLP7kfxEgM45fP2DCeuElpkQXJGWVhoQITnrDPYnX1L5RBBl1Sy_HFgupsV5mv6e-qEj8poRZxLJqEYv3n762T5wWyc230vjqeenX7NuDmygQK97M3dJdqg3rVQA, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641905969, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=172.29.0.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.29.0.1, http-session-id=ADF82FDE6F402CDCE4F5249E43A64287, http-session-last-accessed-time=1641905672860, kc-category-name=ACCESS, kc-iat=1641905669, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.29.0.1:65166 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 12:54:32.912  INFO 14 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 12:54:32.917  INFO 14 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@ab1b20
2022-01-11 12:54:32.920  INFO 14 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@ab1b20
2022-01-11 12:54:32.992  INFO 14 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@ab1b20
2022-01-11 12:54:32.995  INFO 14 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@ab1b20
2022-01-11 12:54:33.048  INFO 14 --- [https-jsse-nio-7071-exec-5] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-4852463544875-419580, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:b90c11d7-db11-4fad-aaae-8c841010ad99:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=b90c11d7-db11-4fad-aaae-8c841010ad99, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time before Shift end, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-11 12:54:33.052  INFO 14 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=fb7e257e-ffe3-416b-858f-5a0ba0a5c411, content=DENY, timestamp=1641905673052, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:b90c11d7-db11-4fad-aaae-8c841010ad99:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=b90c11d7-db11-4fad-aaae-8c841010ad99, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time before Shift end, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-11 12:54:33.056  INFO 14 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=136ms, Total=166ms
2022-01-11 12:54:33.118  INFO 14 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=1521b845-ced7-497e-ba71-739bc9c1f8ed, content=null, timestamp=1641905673110, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=65168, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=eb230e1d0f5c, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.29.0.1, kc-session-state=5479e8ce-ab30-4375-a9ec-31812ab40e37, http-req-server-port=80, http-header-accept=*/*, kc-id=3f3eb186-3198-4309-999b-06de29e30711, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641905673095, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd1/MXNxAH4AEQAAAABh3X4FdAAkM2YzZWIxODYtMzE5OC00MzA5LTk5OWItMDZkZTI5ZTMwNzExdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkNTQ3OWU4Y2UtYWIzMC00Mzc1LWE5ZWMtMzE4MTJhYjQwZTM3cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJIWlNtUmxVS3VKU2sxNUJ6ZEt5UGdzcW90aHA1ZEtYRlVDZmluNi1qVDlNIn0.eyJleHAiOjE2NDE5MDU5NjksImlhdCI6MTY0MTkwNTY2OSwianRpIjoiM2YzZWIxODYtMzE5OC00MzA5LTk5OWItMDZkZTI5ZTMwNzExIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiNTQ3OWU4Y2UtYWIzMC00Mzc1LWE5ZWMtMzE4MTJhYjQwZTM3IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Qo2snvszM0ZptvUZiRHLSSO4nz1K0HwEkVPSMfl64bUpFF7dFqQatXHINmKGObf_HLuTviCYih0aDatO_ipy06Y4tSx-aQoewxxEkeGWRmVOlyiyrp9j-XJN3TfhF57Y_19HdtT3yLszqb0mJeIPLO66K0ls96aqjCfn6YfyylVsBiWomsvHUxklb_mZZG8pJiQ82iyMA9KVgkGo68ujHKEGB8BLP7kfxEgM45fP2DCeuElpkQXJGWVhoQITnrDPYnX1L5RBBl1Sy_HFgupsV5mv6e-qEj8poRZxLJqEYv3n762T5wWyc230vjqeenX7NuDmygQK97M3dJdqg3rVQA, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641905969, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=172.29.0.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.29.0.1, http-session-id=BAD58409020E0BC9AE4814CBD40579DF, http-session-last-accessed-time=1641905673095, kc-category-name=ACCESS, kc-iat=1641905669, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.29.0.1:65168 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 12:54:33.135  INFO 14 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 12:54:33.142  INFO 14 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3f02216a
2022-01-11 12:54:33.153  INFO 14 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3f02216a
2022-01-11 12:54:33.201  INFO 14 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3f02216a
2022-01-11 12:54:33.204  INFO 14 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3f02216a
2022-01-11 12:54:33.315  INFO 14 --- [https-jsse-nio-7071-exec-6] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-4852687711175-211958, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:b90c11d7-db11-4fad-aaae-8c841010ad99:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=b90c11d7-db11-4fad-aaae-8c841010ad99, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time before Shift end, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-11 12:54:33.321  INFO 14 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=1521b845-ced7-497e-ba71-739bc9c1f8ed, content=DENY, timestamp=1641905673321, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:b90c11d7-db11-4fad-aaae-8c841010ad99:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=b90c11d7-db11-4fad-aaae-8c841010ad99, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time before Shift end, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-11 12:54:33.326  INFO 14 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=181ms, Total=209ms
2022-01-11 12:54:33.405  INFO 14 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=616236a4-6dc6-4816-8294-0ba7f066945a, content=null, timestamp=1641905673393, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=65170, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=eb230e1d0f5c, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.29.0.1, kc-session-state=5479e8ce-ab30-4375-a9ec-31812ab40e37, http-req-server-port=80, http-header-accept=*/*, kc-id=3f3eb186-3198-4309-999b-06de29e30711, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641905673388, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd1/MXNxAH4AEQAAAABh3X4FdAAkM2YzZWIxODYtMzE5OC00MzA5LTk5OWItMDZkZTI5ZTMwNzExdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkNTQ3OWU4Y2UtYWIzMC00Mzc1LWE5ZWMtMzE4MTJhYjQwZTM3cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJIWlNtUmxVS3VKU2sxNUJ6ZEt5UGdzcW90aHA1ZEtYRlVDZmluNi1qVDlNIn0.eyJleHAiOjE2NDE5MDU5NjksImlhdCI6MTY0MTkwNTY2OSwianRpIjoiM2YzZWIxODYtMzE5OC00MzA5LTk5OWItMDZkZTI5ZTMwNzExIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiNTQ3OWU4Y2UtYWIzMC00Mzc1LWE5ZWMtMzE4MTJhYjQwZTM3IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Qo2snvszM0ZptvUZiRHLSSO4nz1K0HwEkVPSMfl64bUpFF7dFqQatXHINmKGObf_HLuTviCYih0aDatO_ipy06Y4tSx-aQoewxxEkeGWRmVOlyiyrp9j-XJN3TfhF57Y_19HdtT3yLszqb0mJeIPLO66K0ls96aqjCfn6YfyylVsBiWomsvHUxklb_mZZG8pJiQ82iyMA9KVgkGo68ujHKEGB8BLP7kfxEgM45fP2DCeuElpkQXJGWVhoQITnrDPYnX1L5RBBl1Sy_HFgupsV5mv6e-qEj8poRZxLJqEYv3n762T5wWyc230vjqeenX7NuDmygQK97M3dJdqg3rVQA, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641905969, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=172.29.0.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.29.0.1, http-session-id=8E67D4DBB16F349C85014B4438A17C9F, http-session-last-accessed-time=1641905673388, kc-category-name=ACCESS, kc-iat=1641905669, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.29.0.1:65170 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 12:54:33.411  INFO 14 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 12:54:33.423  INFO 14 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1d9f71e4
2022-01-11 12:54:33.434  INFO 14 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1d9f71e4
2022-01-11 12:54:33.499  INFO 14 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1d9f71e4
2022-01-11 12:54:33.506  INFO 14 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1d9f71e4
2022-01-11 12:54:33.555  INFO 14 --- [https-jsse-nio-7071-exec-7] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-4852962309675-500125, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:b90c11d7-db11-4fad-aaae-8c841010ad99:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=b90c11d7-db11-4fad-aaae-8c841010ad99, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time before Shift end, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-11 12:54:33.559  INFO 14 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=616236a4-6dc6-4816-8294-0ba7f066945a, content=DENY, timestamp=1641905673559, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:b90c11d7-db11-4fad-aaae-8c841010ad99:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=b90c11d7-db11-4fad-aaae-8c841010ad99, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time before Shift end, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-11 12:54:33.566  INFO 14 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=145ms, Total=164ms
2022-01-11 12:54:33.622  INFO 14 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=bbe8fb5b-dd69-431a-9dda-dcbb5f8726d0, content=null, timestamp=1641905673611, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=65172, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=eb230e1d0f5c, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.29.0.1, kc-session-state=5479e8ce-ab30-4375-a9ec-31812ab40e37, http-req-server-port=80, http-header-accept=*/*, kc-id=3f3eb186-3198-4309-999b-06de29e30711, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641905673604, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd1/MXNxAH4AEQAAAABh3X4FdAAkM2YzZWIxODYtMzE5OC00MzA5LTk5OWItMDZkZTI5ZTMwNzExdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkNTQ3OWU4Y2UtYWIzMC00Mzc1LWE5ZWMtMzE4MTJhYjQwZTM3cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJIWlNtUmxVS3VKU2sxNUJ6ZEt5UGdzcW90aHA1ZEtYRlVDZmluNi1qVDlNIn0.eyJleHAiOjE2NDE5MDU5NjksImlhdCI6MTY0MTkwNTY2OSwianRpIjoiM2YzZWIxODYtMzE5OC00MzA5LTk5OWItMDZkZTI5ZTMwNzExIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiNTQ3OWU4Y2UtYWIzMC00Mzc1LWE5ZWMtMzE4MTJhYjQwZTM3IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Qo2snvszM0ZptvUZiRHLSSO4nz1K0HwEkVPSMfl64bUpFF7dFqQatXHINmKGObf_HLuTviCYih0aDatO_ipy06Y4tSx-aQoewxxEkeGWRmVOlyiyrp9j-XJN3TfhF57Y_19HdtT3yLszqb0mJeIPLO66K0ls96aqjCfn6YfyylVsBiWomsvHUxklb_mZZG8pJiQ82iyMA9KVgkGo68ujHKEGB8BLP7kfxEgM45fP2DCeuElpkQXJGWVhoQITnrDPYnX1L5RBBl1Sy_HFgupsV5mv6e-qEj8poRZxLJqEYv3n762T5wWyc230vjqeenX7NuDmygQK97M3dJdqg3rVQA, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641905969, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=172.29.0.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.29.0.1, http-session-id=BAEF096EF294E1ACD480100F8A79106B, http-session-last-accessed-time=1641905673604, kc-category-name=ACCESS, kc-iat=1641905669, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.29.0.1:65172 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 12:54:33.626  INFO 14 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 12:54:33.629  INFO 14 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@70a9941e
2022-01-11 12:54:33.632  INFO 14 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@70a9941e
2022-01-11 12:54:33.661  INFO 14 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@70a9941e
2022-01-11 12:54:33.668  INFO 14 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@70a9941e
2022-01-11 12:54:33.723  INFO 14 --- [https-jsse-nio-7071-exec-8] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-4853175781975-865918, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:b90c11d7-db11-4fad-aaae-8c841010ad99:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=b90c11d7-db11-4fad-aaae-8c841010ad99, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time before Shift end, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-11 12:54:33.733  INFO 14 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=bbe8fb5b-dd69-431a-9dda-dcbb5f8726d0, content=DENY, timestamp=1641905673733, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:b90c11d7-db11-4fad-aaae-8c841010ad99:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=b90c11d7-db11-4fad-aaae-8c841010ad99, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time before Shift end, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-11 12:54:33.748  INFO 14 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=105ms, Total=126ms
2022-01-11 12:54:33.846  INFO 14 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=131d0400-0b41-4f7c-9487-65c8cebc260a, content=null, timestamp=1641905673833, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=65174, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=eb230e1d0f5c, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.29.0.1, kc-session-state=5479e8ce-ab30-4375-a9ec-31812ab40e37, http-req-server-port=80, http-header-accept=*/*, kc-id=3f3eb186-3198-4309-999b-06de29e30711, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641905673798, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd1/MXNxAH4AEQAAAABh3X4FdAAkM2YzZWIxODYtMzE5OC00MzA5LTk5OWItMDZkZTI5ZTMwNzExdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkNTQ3OWU4Y2UtYWIzMC00Mzc1LWE5ZWMtMzE4MTJhYjQwZTM3cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJIWlNtUmxVS3VKU2sxNUJ6ZEt5UGdzcW90aHA1ZEtYRlVDZmluNi1qVDlNIn0.eyJleHAiOjE2NDE5MDU5NjksImlhdCI6MTY0MTkwNTY2OSwianRpIjoiM2YzZWIxODYtMzE5OC00MzA5LTk5OWItMDZkZTI5ZTMwNzExIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiNTQ3OWU4Y2UtYWIzMC00Mzc1LWE5ZWMtMzE4MTJhYjQwZTM3IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Qo2snvszM0ZptvUZiRHLSSO4nz1K0HwEkVPSMfl64bUpFF7dFqQatXHINmKGObf_HLuTviCYih0aDatO_ipy06Y4tSx-aQoewxxEkeGWRmVOlyiyrp9j-XJN3TfhF57Y_19HdtT3yLszqb0mJeIPLO66K0ls96aqjCfn6YfyylVsBiWomsvHUxklb_mZZG8pJiQ82iyMA9KVgkGo68ujHKEGB8BLP7kfxEgM45fP2DCeuElpkQXJGWVhoQITnrDPYnX1L5RBBl1Sy_HFgupsV5mv6e-qEj8poRZxLJqEYv3n762T5wWyc230vjqeenX7NuDmygQK97M3dJdqg3rVQA, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641905969, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=172.29.0.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.29.0.1, http-session-id=9D6D1E26B9D217AFEEEF9AD4F379F5DE, http-session-last-accessed-time=1641905673798, kc-category-name=ACCESS, kc-iat=1641905669, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.29.0.1:65174 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 12:54:33.855  INFO 14 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 12:54:33.860  INFO 14 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5c370f3d
2022-01-11 12:54:33.864  INFO 14 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5c370f3d
2022-01-11 12:54:33.909  INFO 14 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5c370f3d
2022-01-11 12:54:33.913  INFO 14 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5c370f3d
2022-01-11 12:54:33.999  INFO 14 --- [https-jsse-nio-7071-exec-9] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-4853404490075-900548, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:b90c11d7-db11-4fad-aaae-8c841010ad99:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=b90c11d7-db11-4fad-aaae-8c841010ad99, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time before Shift end, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-11 12:54:34.004  INFO 14 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=131d0400-0b41-4f7c-9487-65c8cebc260a, content=DENY, timestamp=1641905674003, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:b90c11d7-db11-4fad-aaae-8c841010ad99:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=b90c11d7-db11-4fad-aaae-8c841010ad99, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time before Shift end, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-11 12:54:34.010  INFO 14 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=146ms, Total=165ms
2022-01-11 12:54:34.080  INFO 14 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=4b8382b3-2e33-4136-aa6d-ba1b0ac460af, content=null, timestamp=1641905674069, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=65176, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=eb230e1d0f5c, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.29.0.1, kc-session-state=5479e8ce-ab30-4375-a9ec-31812ab40e37, http-req-server-port=80, http-header-accept=*/*, kc-id=3f3eb186-3198-4309-999b-06de29e30711, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641905674055, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd1/MXNxAH4AEQAAAABh3X4FdAAkM2YzZWIxODYtMzE5OC00MzA5LTk5OWItMDZkZTI5ZTMwNzExdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkNTQ3OWU4Y2UtYWIzMC00Mzc1LWE5ZWMtMzE4MTJhYjQwZTM3cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJIWlNtUmxVS3VKU2sxNUJ6ZEt5UGdzcW90aHA1ZEtYRlVDZmluNi1qVDlNIn0.eyJleHAiOjE2NDE5MDU5NjksImlhdCI6MTY0MTkwNTY2OSwianRpIjoiM2YzZWIxODYtMzE5OC00MzA5LTk5OWItMDZkZTI5ZTMwNzExIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiNTQ3OWU4Y2UtYWIzMC00Mzc1LWE5ZWMtMzE4MTJhYjQwZTM3IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Qo2snvszM0ZptvUZiRHLSSO4nz1K0HwEkVPSMfl64bUpFF7dFqQatXHINmKGObf_HLuTviCYih0aDatO_ipy06Y4tSx-aQoewxxEkeGWRmVOlyiyrp9j-XJN3TfhF57Y_19HdtT3yLszqb0mJeIPLO66K0ls96aqjCfn6YfyylVsBiWomsvHUxklb_mZZG8pJiQ82iyMA9KVgkGo68ujHKEGB8BLP7kfxEgM45fP2DCeuElpkQXJGWVhoQITnrDPYnX1L5RBBl1Sy_HFgupsV5mv6e-qEj8poRZxLJqEYv3n762T5wWyc230vjqeenX7NuDmygQK97M3dJdqg3rVQA, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641905969, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=172.29.0.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.29.0.1, http-session-id=7F6E1C268EE66CEDD404E2CD0E04F490, http-session-last-accessed-time=1641905674055, kc-category-name=ACCESS, kc-iat=1641905669, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.29.0.1:65176 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 12:54:34.092  INFO 14 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 12:54:34.108  INFO 14 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@44555adf
2022-01-11 12:54:34.112  INFO 14 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@44555adf
2022-01-11 12:54:34.150  INFO 14 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@44555adf
2022-01-11 12:54:34.154  INFO 14 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@44555adf
2022-01-11 12:54:34.184  INFO 14 --- [https-jsse-nio-7071-exec-10] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-4853643693275-603000, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:b90c11d7-db11-4fad-aaae-8c841010ad99:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=b90c11d7-db11-4fad-aaae-8c841010ad99, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time before Shift end, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-11 12:54:34.188  INFO 14 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=4b8382b3-2e33-4136-aa6d-ba1b0ac460af, content=DENY, timestamp=1641905674188, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:b90c11d7-db11-4fad-aaae-8c841010ad99:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=b90c11d7-db11-4fad-aaae-8c841010ad99, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time before Shift end, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-11 12:54:34.201  INFO 14 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=92ms, Total=123ms
2022-01-11 12:54:34.259  INFO 14 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=b29aaff8-361c-4dd5-ad72-7706824a7c71, content=null, timestamp=1641905674246, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=65178, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=eb230e1d0f5c, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.29.0.1, kc-session-state=5479e8ce-ab30-4375-a9ec-31812ab40e37, http-req-server-port=80, http-header-accept=*/*, kc-id=3f3eb186-3198-4309-999b-06de29e30711, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641905674240, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd1/MXNxAH4AEQAAAABh3X4FdAAkM2YzZWIxODYtMzE5OC00MzA5LTk5OWItMDZkZTI5ZTMwNzExdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkNTQ3OWU4Y2UtYWIzMC00Mzc1LWE5ZWMtMzE4MTJhYjQwZTM3cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJIWlNtUmxVS3VKU2sxNUJ6ZEt5UGdzcW90aHA1ZEtYRlVDZmluNi1qVDlNIn0.eyJleHAiOjE2NDE5MDU5NjksImlhdCI6MTY0MTkwNTY2OSwianRpIjoiM2YzZWIxODYtMzE5OC00MzA5LTk5OWItMDZkZTI5ZTMwNzExIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiNTQ3OWU4Y2UtYWIzMC00Mzc1LWE5ZWMtMzE4MTJhYjQwZTM3IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Qo2snvszM0ZptvUZiRHLSSO4nz1K0HwEkVPSMfl64bUpFF7dFqQatXHINmKGObf_HLuTviCYih0aDatO_ipy06Y4tSx-aQoewxxEkeGWRmVOlyiyrp9j-XJN3TfhF57Y_19HdtT3yLszqb0mJeIPLO66K0ls96aqjCfn6YfyylVsBiWomsvHUxklb_mZZG8pJiQ82iyMA9KVgkGo68ujHKEGB8BLP7kfxEgM45fP2DCeuElpkQXJGWVhoQITnrDPYnX1L5RBBl1Sy_HFgupsV5mv6e-qEj8poRZxLJqEYv3n762T5wWyc230vjqeenX7NuDmygQK97M3dJdqg3rVQA, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641905969, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=172.29.0.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.29.0.1, http-session-id=0D380E90535AFC8A76607A48B0767FBA, http-session-last-accessed-time=1641905674240, kc-category-name=ACCESS, kc-iat=1641905669, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.29.0.1:65178 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 12:54:34.264  INFO 14 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 12:54:34.277  INFO 14 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@45eeca14
2022-01-11 12:54:34.280  INFO 14 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@45eeca14
2022-01-11 12:54:34.331  INFO 14 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@45eeca14
2022-01-11 12:54:34.341  INFO 14 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@45eeca14
2022-01-11 12:54:34.408  INFO 14 --- [https-jsse-nio-7071-exec-1] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-4853814101275-428271, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:b90c11d7-db11-4fad-aaae-8c841010ad99:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=b90c11d7-db11-4fad-aaae-8c841010ad99, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time before Shift end, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-11 12:54:34.410  INFO 14 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=b29aaff8-361c-4dd5-ad72-7706824a7c71, content=DENY, timestamp=1641905674410, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:b90c11d7-db11-4fad-aaae-8c841010ad99:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=b90c11d7-db11-4fad-aaae-8c841010ad99, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time before Shift end, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-11 12:54:34.419  INFO 14 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=144ms, Total=165ms
2022-01-11 12:54:34.462  INFO 14 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=d22efe14-6931-4deb-8c66-3254f61587f7, content=null, timestamp=1641905674454, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=65180, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=eb230e1d0f5c, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.29.0.1, kc-session-state=5479e8ce-ab30-4375-a9ec-31812ab40e37, http-req-server-port=80, http-header-accept=*/*, kc-id=3f3eb186-3198-4309-999b-06de29e30711, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641905674450, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd1/MXNxAH4AEQAAAABh3X4FdAAkM2YzZWIxODYtMzE5OC00MzA5LTk5OWItMDZkZTI5ZTMwNzExdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkNTQ3OWU4Y2UtYWIzMC00Mzc1LWE5ZWMtMzE4MTJhYjQwZTM3cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJIWlNtUmxVS3VKU2sxNUJ6ZEt5UGdzcW90aHA1ZEtYRlVDZmluNi1qVDlNIn0.eyJleHAiOjE2NDE5MDU5NjksImlhdCI6MTY0MTkwNTY2OSwianRpIjoiM2YzZWIxODYtMzE5OC00MzA5LTk5OWItMDZkZTI5ZTMwNzExIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiNTQ3OWU4Y2UtYWIzMC00Mzc1LWE5ZWMtMzE4MTJhYjQwZTM3IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Qo2snvszM0ZptvUZiRHLSSO4nz1K0HwEkVPSMfl64bUpFF7dFqQatXHINmKGObf_HLuTviCYih0aDatO_ipy06Y4tSx-aQoewxxEkeGWRmVOlyiyrp9j-XJN3TfhF57Y_19HdtT3yLszqb0mJeIPLO66K0ls96aqjCfn6YfyylVsBiWomsvHUxklb_mZZG8pJiQ82iyMA9KVgkGo68ujHKEGB8BLP7kfxEgM45fP2DCeuElpkQXJGWVhoQITnrDPYnX1L5RBBl1Sy_HFgupsV5mv6e-qEj8poRZxLJqEYv3n762T5wWyc230vjqeenX7NuDmygQK97M3dJdqg3rVQA, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641905969, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=172.29.0.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.29.0.1, http-session-id=4D1B15CFDF50216891079A0E7E70E54F, http-session-last-accessed-time=1641905674450, kc-category-name=ACCESS, kc-iat=1641905669, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.29.0.1:65180 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 12:54:34.466  INFO 14 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 12:54:34.471  INFO 14 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7ce25b4b
2022-01-11 12:54:34.487  INFO 14 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7ce25b4b
2022-01-11 12:54:34.587  INFO 14 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7ce25b4b
2022-01-11 12:54:34.593  INFO 14 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7ce25b4b
2022-01-11 12:54:34.665  INFO 14 --- [https-jsse-nio-7071-exec-2] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-4854016481975-455915, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:b90c11d7-db11-4fad-aaae-8c841010ad99:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=b90c11d7-db11-4fad-aaae-8c841010ad99, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time before Shift end, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-11 12:54:34.676  INFO 14 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=d22efe14-6931-4deb-8c66-3254f61587f7, content=DENY, timestamp=1641905674676, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:b90c11d7-db11-4fad-aaae-8c841010ad99:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=b90c11d7-db11-4fad-aaae-8c841010ad99, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time before Shift end, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-11 12:54:34.681  INFO 14 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=207ms, Total=220ms
2022-01-11 12:54:34.729  INFO 14 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=4d30f4e0-1099-4e55-a31a-7dcc882951ff, content=null, timestamp=1641905674714, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=65182, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=eb230e1d0f5c, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.29.0.1, kc-session-state=5479e8ce-ab30-4375-a9ec-31812ab40e37, http-req-server-port=80, http-header-accept=*/*, kc-id=3f3eb186-3198-4309-999b-06de29e30711, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641905674713, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd1/MXNxAH4AEQAAAABh3X4FdAAkM2YzZWIxODYtMzE5OC00MzA5LTk5OWItMDZkZTI5ZTMwNzExdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkNTQ3OWU4Y2UtYWIzMC00Mzc1LWE5ZWMtMzE4MTJhYjQwZTM3cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJIWlNtUmxVS3VKU2sxNUJ6ZEt5UGdzcW90aHA1ZEtYRlVDZmluNi1qVDlNIn0.eyJleHAiOjE2NDE5MDU5NjksImlhdCI6MTY0MTkwNTY2OSwianRpIjoiM2YzZWIxODYtMzE5OC00MzA5LTk5OWItMDZkZTI5ZTMwNzExIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiNTQ3OWU4Y2UtYWIzMC00Mzc1LWE5ZWMtMzE4MTJhYjQwZTM3IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Qo2snvszM0ZptvUZiRHLSSO4nz1K0HwEkVPSMfl64bUpFF7dFqQatXHINmKGObf_HLuTviCYih0aDatO_ipy06Y4tSx-aQoewxxEkeGWRmVOlyiyrp9j-XJN3TfhF57Y_19HdtT3yLszqb0mJeIPLO66K0ls96aqjCfn6YfyylVsBiWomsvHUxklb_mZZG8pJiQ82iyMA9KVgkGo68ujHKEGB8BLP7kfxEgM45fP2DCeuElpkQXJGWVhoQITnrDPYnX1L5RBBl1Sy_HFgupsV5mv6e-qEj8poRZxLJqEYv3n762T5wWyc230vjqeenX7NuDmygQK97M3dJdqg3rVQA, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641905969, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=172.29.0.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.29.0.1, http-session-id=284F86BD9B8C5E5074F529A19F703814, http-session-last-accessed-time=1641905674713, kc-category-name=ACCESS, kc-iat=1641905669, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.29.0.1:65182 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 12:54:34.735  INFO 14 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 12:54:34.745  INFO 14 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@186e7887
2022-01-11 12:54:34.762  INFO 14 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@186e7887
2022-01-11 12:54:34.804  INFO 14 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@186e7887
2022-01-11 12:54:34.814  INFO 14 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@186e7887
2022-01-11 12:54:34.852  INFO 14 --- [https-jsse-nio-7071-exec-3] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-4854291221475-55948, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:b90c11d7-db11-4fad-aaae-8c841010ad99:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=b90c11d7-db11-4fad-aaae-8c841010ad99, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time before Shift end, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-11 12:54:34.855  INFO 14 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=4d30f4e0-1099-4e55-a31a-7dcc882951ff, content=DENY, timestamp=1641905674855, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:b90c11d7-db11-4fad-aaae-8c841010ad99:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=b90c11d7-db11-4fad-aaae-8c841010ad99, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time before Shift end, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-11 12:54:34.860  INFO 14 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=112ms, Total=139ms
2022-01-11 12:54:34.922  INFO 14 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=02cb44f0-64bd-4bd6-be71-f9c68d108b48, content=null, timestamp=1641905674910, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=65184, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=eb230e1d0f5c, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.29.0.1, kc-session-state=5479e8ce-ab30-4375-a9ec-31812ab40e37, http-req-server-port=80, http-header-accept=*/*, kc-id=3f3eb186-3198-4309-999b-06de29e30711, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641905674909, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd1/MXNxAH4AEQAAAABh3X4FdAAkM2YzZWIxODYtMzE5OC00MzA5LTk5OWItMDZkZTI5ZTMwNzExdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkNTQ3OWU4Y2UtYWIzMC00Mzc1LWE5ZWMtMzE4MTJhYjQwZTM3cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJIWlNtUmxVS3VKU2sxNUJ6ZEt5UGdzcW90aHA1ZEtYRlVDZmluNi1qVDlNIn0.eyJleHAiOjE2NDE5MDU5NjksImlhdCI6MTY0MTkwNTY2OSwianRpIjoiM2YzZWIxODYtMzE5OC00MzA5LTk5OWItMDZkZTI5ZTMwNzExIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiNTQ3OWU4Y2UtYWIzMC00Mzc1LWE5ZWMtMzE4MTJhYjQwZTM3IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Qo2snvszM0ZptvUZiRHLSSO4nz1K0HwEkVPSMfl64bUpFF7dFqQatXHINmKGObf_HLuTviCYih0aDatO_ipy06Y4tSx-aQoewxxEkeGWRmVOlyiyrp9j-XJN3TfhF57Y_19HdtT3yLszqb0mJeIPLO66K0ls96aqjCfn6YfyylVsBiWomsvHUxklb_mZZG8pJiQ82iyMA9KVgkGo68ujHKEGB8BLP7kfxEgM45fP2DCeuElpkQXJGWVhoQITnrDPYnX1L5RBBl1Sy_HFgupsV5mv6e-qEj8poRZxLJqEYv3n762T5wWyc230vjqeenX7NuDmygQK97M3dJdqg3rVQA, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641905969, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=172.29.0.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.29.0.1, http-session-id=692F9448A28E931EDC08B207524B67D3, http-session-last-accessed-time=1641905674909, kc-category-name=ACCESS, kc-iat=1641905669, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.29.0.1:65184 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 12:54:34.929  INFO 14 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 12:54:34.936  INFO 14 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5e168e03
2022-01-11 12:54:34.939  INFO 14 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5e168e03
2022-01-11 12:54:34.974  INFO 14 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5e168e03
2022-01-11 12:54:34.976  INFO 14 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5e168e03
2022-01-11 12:54:35.012  INFO 14 --- [https-jsse-nio-7071-exec-4] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-4854480392375-161788, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:b90c11d7-db11-4fad-aaae-8c841010ad99:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=b90c11d7-db11-4fad-aaae-8c841010ad99, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time before Shift end, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-11 12:54:35.017  INFO 14 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=02cb44f0-64bd-4bd6-be71-f9c68d108b48, content=DENY, timestamp=1641905675017, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:b90c11d7-db11-4fad-aaae-8c841010ad99:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=b90c11d7-db11-4fad-aaae-8c841010ad99, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time before Shift end, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-11 12:54:35.020  INFO 14 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=85ms, Total=103ms
2022-01-11 12:54:35.067  INFO 14 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=bb041462-6f2c-4e06-84db-9016a7dc329a, content=null, timestamp=1641905675059, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=65186, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=eb230e1d0f5c, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.29.0.1, kc-session-state=5479e8ce-ab30-4375-a9ec-31812ab40e37, http-req-server-port=80, http-header-accept=*/*, kc-id=3f3eb186-3198-4309-999b-06de29e30711, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641905675057, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd1/MXNxAH4AEQAAAABh3X4FdAAkM2YzZWIxODYtMzE5OC00MzA5LTk5OWItMDZkZTI5ZTMwNzExdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkNTQ3OWU4Y2UtYWIzMC00Mzc1LWE5ZWMtMzE4MTJhYjQwZTM3cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJIWlNtUmxVS3VKU2sxNUJ6ZEt5UGdzcW90aHA1ZEtYRlVDZmluNi1qVDlNIn0.eyJleHAiOjE2NDE5MDU5NjksImlhdCI6MTY0MTkwNTY2OSwianRpIjoiM2YzZWIxODYtMzE5OC00MzA5LTk5OWItMDZkZTI5ZTMwNzExIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiNTQ3OWU4Y2UtYWIzMC00Mzc1LWE5ZWMtMzE4MTJhYjQwZTM3IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Qo2snvszM0ZptvUZiRHLSSO4nz1K0HwEkVPSMfl64bUpFF7dFqQatXHINmKGObf_HLuTviCYih0aDatO_ipy06Y4tSx-aQoewxxEkeGWRmVOlyiyrp9j-XJN3TfhF57Y_19HdtT3yLszqb0mJeIPLO66K0ls96aqjCfn6YfyylVsBiWomsvHUxklb_mZZG8pJiQ82iyMA9KVgkGo68ujHKEGB8BLP7kfxEgM45fP2DCeuElpkQXJGWVhoQITnrDPYnX1L5RBBl1Sy_HFgupsV5mv6e-qEj8poRZxLJqEYv3n762T5wWyc230vjqeenX7NuDmygQK97M3dJdqg3rVQA, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641905969, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=172.29.0.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.29.0.1, http-session-id=CF00ACD79E551837BFB61A6F7FDEA44D, http-session-last-accessed-time=1641905675057, kc-category-name=ACCESS, kc-iat=1641905669, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.29.0.1:65186 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 12:54:35.076  INFO 14 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 12:54:35.079  INFO 14 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@374339b7
2022-01-11 12:54:35.082  INFO 14 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@374339b7
2022-01-11 12:54:35.123  INFO 14 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@374339b7
2022-01-11 12:54:35.127  INFO 14 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@374339b7
2022-01-11 12:54:35.212  INFO 14 --- [https-jsse-nio-7071-exec-5] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-4854625786175-244434, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:b90c11d7-db11-4fad-aaae-8c841010ad99:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=b90c11d7-db11-4fad-aaae-8c841010ad99, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time before Shift end, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-11 12:54:35.215  INFO 14 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=bb041462-6f2c-4e06-84db-9016a7dc329a, content=DENY, timestamp=1641905675215, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:b90c11d7-db11-4fad-aaae-8c841010ad99:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=b90c11d7-db11-4fad-aaae-8c841010ad99, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time before Shift end, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-11 12:54:35.220  INFO 14 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=137ms, Total=157ms
2022-01-11 12:54:35.270  INFO 14 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=ac40899f-b285-4ebd-8e05-c616d166b65f, content=null, timestamp=1641905675258, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=65188, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=eb230e1d0f5c, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.29.0.1, kc-session-state=5479e8ce-ab30-4375-a9ec-31812ab40e37, http-req-server-port=80, http-header-accept=*/*, kc-id=3f3eb186-3198-4309-999b-06de29e30711, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641905675253, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd1/MXNxAH4AEQAAAABh3X4FdAAkM2YzZWIxODYtMzE5OC00MzA5LTk5OWItMDZkZTI5ZTMwNzExdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkNTQ3OWU4Y2UtYWIzMC00Mzc1LWE5ZWMtMzE4MTJhYjQwZTM3cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJIWlNtUmxVS3VKU2sxNUJ6ZEt5UGdzcW90aHA1ZEtYRlVDZmluNi1qVDlNIn0.eyJleHAiOjE2NDE5MDU5NjksImlhdCI6MTY0MTkwNTY2OSwianRpIjoiM2YzZWIxODYtMzE5OC00MzA5LTk5OWItMDZkZTI5ZTMwNzExIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiNTQ3OWU4Y2UtYWIzMC00Mzc1LWE5ZWMtMzE4MTJhYjQwZTM3IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Qo2snvszM0ZptvUZiRHLSSO4nz1K0HwEkVPSMfl64bUpFF7dFqQatXHINmKGObf_HLuTviCYih0aDatO_ipy06Y4tSx-aQoewxxEkeGWRmVOlyiyrp9j-XJN3TfhF57Y_19HdtT3yLszqb0mJeIPLO66K0ls96aqjCfn6YfyylVsBiWomsvHUxklb_mZZG8pJiQ82iyMA9KVgkGo68ujHKEGB8BLP7kfxEgM45fP2DCeuElpkQXJGWVhoQITnrDPYnX1L5RBBl1Sy_HFgupsV5mv6e-qEj8poRZxLJqEYv3n762T5wWyc230vjqeenX7NuDmygQK97M3dJdqg3rVQA, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641905969, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=172.29.0.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.29.0.1, http-session-id=4E50571598F817E9FB603365BE025DB6, http-session-last-accessed-time=1641905675253, kc-category-name=ACCESS, kc-iat=1641905669, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.29.0.1:65188 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 12:54:35.276  INFO 14 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 12:54:35.282  INFO 14 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4d6760db
2022-01-11 12:54:35.285  INFO 14 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4d6760db
2022-01-11 12:54:35.324  INFO 14 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4d6760db
2022-01-11 12:54:35.327  INFO 14 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4d6760db
2022-01-11 12:54:35.358  INFO 14 --- [https-jsse-nio-7071-exec-6] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-4854828849575-956761, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:b90c11d7-db11-4fad-aaae-8c841010ad99:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=b90c11d7-db11-4fad-aaae-8c841010ad99, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time before Shift end, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-11 12:54:35.363  INFO 14 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=ac40899f-b285-4ebd-8e05-c616d166b65f, content=DENY, timestamp=1641905675363, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:b90c11d7-db11-4fad-aaae-8c841010ad99:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=b90c11d7-db11-4fad-aaae-8c841010ad99, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time before Shift end, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-11 12:54:35.372  INFO 14 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=82ms, Total=105ms
2022-01-11 12:54:35.431  INFO 14 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=bfad3e46-d331-4051-8c8e-925d529e3cfb, content=null, timestamp=1641905675420, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=65190, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=eb230e1d0f5c, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.29.0.1, kc-session-state=5479e8ce-ab30-4375-a9ec-31812ab40e37, http-req-server-port=80, http-header-accept=*/*, kc-id=3f3eb186-3198-4309-999b-06de29e30711, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641905675409, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd1/MXNxAH4AEQAAAABh3X4FdAAkM2YzZWIxODYtMzE5OC00MzA5LTk5OWItMDZkZTI5ZTMwNzExdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkNTQ3OWU4Y2UtYWIzMC00Mzc1LWE5ZWMtMzE4MTJhYjQwZTM3cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJIWlNtUmxVS3VKU2sxNUJ6ZEt5UGdzcW90aHA1ZEtYRlVDZmluNi1qVDlNIn0.eyJleHAiOjE2NDE5MDU5NjksImlhdCI6MTY0MTkwNTY2OSwianRpIjoiM2YzZWIxODYtMzE5OC00MzA5LTk5OWItMDZkZTI5ZTMwNzExIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiNTQ3OWU4Y2UtYWIzMC00Mzc1LWE5ZWMtMzE4MTJhYjQwZTM3IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Qo2snvszM0ZptvUZiRHLSSO4nz1K0HwEkVPSMfl64bUpFF7dFqQatXHINmKGObf_HLuTviCYih0aDatO_ipy06Y4tSx-aQoewxxEkeGWRmVOlyiyrp9j-XJN3TfhF57Y_19HdtT3yLszqb0mJeIPLO66K0ls96aqjCfn6YfyylVsBiWomsvHUxklb_mZZG8pJiQ82iyMA9KVgkGo68ujHKEGB8BLP7kfxEgM45fP2DCeuElpkQXJGWVhoQITnrDPYnX1L5RBBl1Sy_HFgupsV5mv6e-qEj8poRZxLJqEYv3n762T5wWyc230vjqeenX7NuDmygQK97M3dJdqg3rVQA, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641905969, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=172.29.0.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.29.0.1, http-session-id=6D4B9F1A84205C3A459043A898585AEC, http-session-last-accessed-time=1641905675409, kc-category-name=ACCESS, kc-iat=1641905669, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.29.0.1:65190 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 12:54:35.440  INFO 14 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 12:54:35.447  INFO 14 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2cb3a3f7
2022-01-11 12:54:35.455  INFO 14 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2cb3a3f7
2022-01-11 12:54:35.488  INFO 14 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2cb3a3f7
2022-01-11 12:54:35.497  INFO 14 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2cb3a3f7
2022-01-11 12:54:35.538  INFO 14 --- [https-jsse-nio-7071-exec-7] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-4854991001575-543480, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:b90c11d7-db11-4fad-aaae-8c841010ad99:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=b90c11d7-db11-4fad-aaae-8c841010ad99, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time before Shift end, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-11 12:54:35.541  INFO 14 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=bfad3e46-d331-4051-8c8e-925d529e3cfb, content=DENY, timestamp=1641905675541, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:b90c11d7-db11-4fad-aaae-8c841010ad99:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=b90c11d7-db11-4fad-aaae-8c841010ad99, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time before Shift end, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-11 12:54:35.543  INFO 14 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=98ms, Total=114ms
2022-01-11 12:54:35.615  INFO 14 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=ff2f8dcd-2afa-4d95-9c07-22b0ef0764a5, content=null, timestamp=1641905675597, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=65192, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=eb230e1d0f5c, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.29.0.1, kc-session-state=5479e8ce-ab30-4375-a9ec-31812ab40e37, http-req-server-port=80, http-header-accept=*/*, kc-id=3f3eb186-3198-4309-999b-06de29e30711, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641905675590, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd1/MXNxAH4AEQAAAABh3X4FdAAkM2YzZWIxODYtMzE5OC00MzA5LTk5OWItMDZkZTI5ZTMwNzExdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkNTQ3OWU4Y2UtYWIzMC00Mzc1LWE5ZWMtMzE4MTJhYjQwZTM3cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJIWlNtUmxVS3VKU2sxNUJ6ZEt5UGdzcW90aHA1ZEtYRlVDZmluNi1qVDlNIn0.eyJleHAiOjE2NDE5MDU5NjksImlhdCI6MTY0MTkwNTY2OSwianRpIjoiM2YzZWIxODYtMzE5OC00MzA5LTk5OWItMDZkZTI5ZTMwNzExIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiNTQ3OWU4Y2UtYWIzMC00Mzc1LWE5ZWMtMzE4MTJhYjQwZTM3IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Qo2snvszM0ZptvUZiRHLSSO4nz1K0HwEkVPSMfl64bUpFF7dFqQatXHINmKGObf_HLuTviCYih0aDatO_ipy06Y4tSx-aQoewxxEkeGWRmVOlyiyrp9j-XJN3TfhF57Y_19HdtT3yLszqb0mJeIPLO66K0ls96aqjCfn6YfyylVsBiWomsvHUxklb_mZZG8pJiQ82iyMA9KVgkGo68ujHKEGB8BLP7kfxEgM45fP2DCeuElpkQXJGWVhoQITnrDPYnX1L5RBBl1Sy_HFgupsV5mv6e-qEj8poRZxLJqEYv3n762T5wWyc230vjqeenX7NuDmygQK97M3dJdqg3rVQA, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641905969, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=172.29.0.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.29.0.1, http-session-id=651966FC53333183AB284FDB65C98926, http-session-last-accessed-time=1641905675590, kc-category-name=ACCESS, kc-iat=1641905669, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.29.0.1:65192 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 12:54:35.620  INFO 14 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 12:54:35.630  INFO 14 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@297b525b
2022-01-11 12:54:35.634  INFO 14 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@297b525b
2022-01-11 12:54:35.669  INFO 14 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@297b525b
2022-01-11 12:54:35.671  INFO 14 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@297b525b
2022-01-11 12:54:35.759  INFO 14 --- [https-jsse-nio-7071-exec-8] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-4855171210575-215491, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:b90c11d7-db11-4fad-aaae-8c841010ad99:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=b90c11d7-db11-4fad-aaae-8c841010ad99, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time before Shift end, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-11 12:54:35.765  INFO 14 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=ff2f8dcd-2afa-4d95-9c07-22b0ef0764a5, content=DENY, timestamp=1641905675765, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:b90c11d7-db11-4fad-aaae-8c841010ad99:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=b90c11d7-db11-4fad-aaae-8c841010ad99, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time before Shift end, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-11 12:54:35.770  INFO 14 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=142ms, Total=157ms
2022-01-11 12:54:35.840  INFO 14 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=aef5a256-ac50-4308-abd2-fa73c769d754, content=null, timestamp=1641905675810, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=65194, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=eb230e1d0f5c, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.29.0.1, kc-session-state=5479e8ce-ab30-4375-a9ec-31812ab40e37, http-req-server-port=80, http-header-accept=*/*, kc-id=3f3eb186-3198-4309-999b-06de29e30711, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641905675804, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd1/MXNxAH4AEQAAAABh3X4FdAAkM2YzZWIxODYtMzE5OC00MzA5LTk5OWItMDZkZTI5ZTMwNzExdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkNTQ3OWU4Y2UtYWIzMC00Mzc1LWE5ZWMtMzE4MTJhYjQwZTM3cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJIWlNtUmxVS3VKU2sxNUJ6ZEt5UGdzcW90aHA1ZEtYRlVDZmluNi1qVDlNIn0.eyJleHAiOjE2NDE5MDU5NjksImlhdCI6MTY0MTkwNTY2OSwianRpIjoiM2YzZWIxODYtMzE5OC00MzA5LTk5OWItMDZkZTI5ZTMwNzExIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiNTQ3OWU4Y2UtYWIzMC00Mzc1LWE5ZWMtMzE4MTJhYjQwZTM3IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Qo2snvszM0ZptvUZiRHLSSO4nz1K0HwEkVPSMfl64bUpFF7dFqQatXHINmKGObf_HLuTviCYih0aDatO_ipy06Y4tSx-aQoewxxEkeGWRmVOlyiyrp9j-XJN3TfhF57Y_19HdtT3yLszqb0mJeIPLO66K0ls96aqjCfn6YfyylVsBiWomsvHUxklb_mZZG8pJiQ82iyMA9KVgkGo68ujHKEGB8BLP7kfxEgM45fP2DCeuElpkQXJGWVhoQITnrDPYnX1L5RBBl1Sy_HFgupsV5mv6e-qEj8poRZxLJqEYv3n762T5wWyc230vjqeenX7NuDmygQK97M3dJdqg3rVQA, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641905969, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=172.29.0.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.29.0.1, http-session-id=6379209D18F5C89DB47A5B6ABC32AD77, http-session-last-accessed-time=1641905675804, kc-category-name=ACCESS, kc-iat=1641905669, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.29.0.1:65194 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 12:54:35.817  INFO 14 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 12:54:35.835  INFO 14 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@43c1532d
2022-01-11 12:54:35.840  INFO 14 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@43c1532d
2022-01-11 12:54:35.922  INFO 14 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@43c1532d
2022-01-11 12:54:35.924  INFO 14 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@43c1532d
2022-01-11 12:54:35.980  INFO 14 --- [https-jsse-nio-7071-exec-9] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-4855416757975-331661, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:b90c11d7-db11-4fad-aaae-8c841010ad99:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=b90c11d7-db11-4fad-aaae-8c841010ad99, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time before Shift end, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-11 12:54:35.982  INFO 14 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=aef5a256-ac50-4308-abd2-fa73c769d754, content=DENY, timestamp=1641905675982, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:b90c11d7-db11-4fad-aaae-8c841010ad99:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=b90c11d7-db11-4fad-aaae-8c841010ad99, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time before Shift end, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-11 12:54:35.986  INFO 14 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=148ms, Total=158ms
2022-01-11 12:54:36.033  INFO 14 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=05def149-2a8f-480f-8830-088a857dc4c3, content=null, timestamp=1641905676025, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=65196, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=eb230e1d0f5c, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.29.0.1, kc-session-state=5479e8ce-ab30-4375-a9ec-31812ab40e37, http-req-server-port=80, http-header-accept=*/*, kc-id=3f3eb186-3198-4309-999b-06de29e30711, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641905676023, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd1/MXNxAH4AEQAAAABh3X4FdAAkM2YzZWIxODYtMzE5OC00MzA5LTk5OWItMDZkZTI5ZTMwNzExdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkNTQ3OWU4Y2UtYWIzMC00Mzc1LWE5ZWMtMzE4MTJhYjQwZTM3cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJIWlNtUmxVS3VKU2sxNUJ6ZEt5UGdzcW90aHA1ZEtYRlVDZmluNi1qVDlNIn0.eyJleHAiOjE2NDE5MDU5NjksImlhdCI6MTY0MTkwNTY2OSwianRpIjoiM2YzZWIxODYtMzE5OC00MzA5LTk5OWItMDZkZTI5ZTMwNzExIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiNTQ3OWU4Y2UtYWIzMC00Mzc1LWE5ZWMtMzE4MTJhYjQwZTM3IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Qo2snvszM0ZptvUZiRHLSSO4nz1K0HwEkVPSMfl64bUpFF7dFqQatXHINmKGObf_HLuTviCYih0aDatO_ipy06Y4tSx-aQoewxxEkeGWRmVOlyiyrp9j-XJN3TfhF57Y_19HdtT3yLszqb0mJeIPLO66K0ls96aqjCfn6YfyylVsBiWomsvHUxklb_mZZG8pJiQ82iyMA9KVgkGo68ujHKEGB8BLP7kfxEgM45fP2DCeuElpkQXJGWVhoQITnrDPYnX1L5RBBl1Sy_HFgupsV5mv6e-qEj8poRZxLJqEYv3n762T5wWyc230vjqeenX7NuDmygQK97M3dJdqg3rVQA, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641905969, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=172.29.0.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.29.0.1, http-session-id=A2942EB559AB33AB326F2D2A89369B32, http-session-last-accessed-time=1641905676023, kc-category-name=ACCESS, kc-iat=1641905669, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.29.0.1:65196 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 12:54:36.038  INFO 14 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 12:54:36.044  INFO 14 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3222a04d
2022-01-11 12:54:36.046  INFO 14 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3222a04d
2022-01-11 12:54:36.091  INFO 14 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3222a04d
2022-01-11 12:54:36.098  INFO 14 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3222a04d
2022-01-11 12:54:36.143  INFO 14 --- [https-jsse-nio-7071-exec-10] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-4855624314975-371248, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:b90c11d7-db11-4fad-aaae-8c841010ad99:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=b90c11d7-db11-4fad-aaae-8c841010ad99, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time before Shift end, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-11 12:54:36.146  INFO 14 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=05def149-2a8f-480f-8830-088a857dc4c3, content=DENY, timestamp=1641905676146, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:b90c11d7-db11-4fad-aaae-8c841010ad99:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=b90c11d7-db11-4fad-aaae-8c841010ad99, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time before Shift end, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-11 12:54:36.154  INFO 14 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=105ms, Total=122ms
2022-01-11 12:54:36.209  INFO 14 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=0d661717-5943-40af-9aaf-c6eeeee832b5, content=null, timestamp=1641905676198, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=65198, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=eb230e1d0f5c, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.29.0.1, kc-session-state=5479e8ce-ab30-4375-a9ec-31812ab40e37, http-req-server-port=80, http-header-accept=*/*, kc-id=3f3eb186-3198-4309-999b-06de29e30711, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641905676195, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd1/MXNxAH4AEQAAAABh3X4FdAAkM2YzZWIxODYtMzE5OC00MzA5LTk5OWItMDZkZTI5ZTMwNzExdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkNTQ3OWU4Y2UtYWIzMC00Mzc1LWE5ZWMtMzE4MTJhYjQwZTM3cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJIWlNtUmxVS3VKU2sxNUJ6ZEt5UGdzcW90aHA1ZEtYRlVDZmluNi1qVDlNIn0.eyJleHAiOjE2NDE5MDU5NjksImlhdCI6MTY0MTkwNTY2OSwianRpIjoiM2YzZWIxODYtMzE5OC00MzA5LTk5OWItMDZkZTI5ZTMwNzExIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiNTQ3OWU4Y2UtYWIzMC00Mzc1LWE5ZWMtMzE4MTJhYjQwZTM3IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Qo2snvszM0ZptvUZiRHLSSO4nz1K0HwEkVPSMfl64bUpFF7dFqQatXHINmKGObf_HLuTviCYih0aDatO_ipy06Y4tSx-aQoewxxEkeGWRmVOlyiyrp9j-XJN3TfhF57Y_19HdtT3yLszqb0mJeIPLO66K0ls96aqjCfn6YfyylVsBiWomsvHUxklb_mZZG8pJiQ82iyMA9KVgkGo68ujHKEGB8BLP7kfxEgM45fP2DCeuElpkQXJGWVhoQITnrDPYnX1L5RBBl1Sy_HFgupsV5mv6e-qEj8poRZxLJqEYv3n762T5wWyc230vjqeenX7NuDmygQK97M3dJdqg3rVQA, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641905969, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=172.29.0.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.29.0.1, http-session-id=3F6F40641A6B24B3E73D3235B340D8F0, http-session-last-accessed-time=1641905676195, kc-category-name=ACCESS, kc-iat=1641905669, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.29.0.1:65198 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 12:54:36.216  INFO 14 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 12:54:36.237  INFO 14 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1a68160e
2022-01-11 12:54:36.240  INFO 14 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1a68160e
2022-01-11 12:54:36.270  INFO 14 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1a68160e
2022-01-11 12:54:36.276  INFO 14 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1a68160e
2022-01-11 12:54:36.354  INFO 14 --- [https-jsse-nio-7071-exec-1] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-4855808291075-307281, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:b90c11d7-db11-4fad-aaae-8c841010ad99:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=b90c11d7-db11-4fad-aaae-8c841010ad99, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time before Shift end, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-11 12:54:36.360  INFO 14 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=0d661717-5943-40af-9aaf-c6eeeee832b5, content=DENY, timestamp=1641905676360, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:b90c11d7-db11-4fad-aaae-8c841010ad99:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=b90c11d7-db11-4fad-aaae-8c841010ad99, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time before Shift end, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-11 12:54:36.365  INFO 14 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=135ms, Total=158ms
2022-01-11 12:54:36.410  INFO 14 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=ba162ea4-1f33-45ab-93c7-735cd1f3429f, content=null, timestamp=1641905676396, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=65200, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=eb230e1d0f5c, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.29.0.1, kc-session-state=5479e8ce-ab30-4375-a9ec-31812ab40e37, http-req-server-port=80, http-header-accept=*/*, kc-id=3f3eb186-3198-4309-999b-06de29e30711, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641905676393, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd1/MXNxAH4AEQAAAABh3X4FdAAkM2YzZWIxODYtMzE5OC00MzA5LTk5OWItMDZkZTI5ZTMwNzExdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkNTQ3OWU4Y2UtYWIzMC00Mzc1LWE5ZWMtMzE4MTJhYjQwZTM3cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJIWlNtUmxVS3VKU2sxNUJ6ZEt5UGdzcW90aHA1ZEtYRlVDZmluNi1qVDlNIn0.eyJleHAiOjE2NDE5MDU5NjksImlhdCI6MTY0MTkwNTY2OSwianRpIjoiM2YzZWIxODYtMzE5OC00MzA5LTk5OWItMDZkZTI5ZTMwNzExIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiNTQ3OWU4Y2UtYWIzMC00Mzc1LWE5ZWMtMzE4MTJhYjQwZTM3IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Qo2snvszM0ZptvUZiRHLSSO4nz1K0HwEkVPSMfl64bUpFF7dFqQatXHINmKGObf_HLuTviCYih0aDatO_ipy06Y4tSx-aQoewxxEkeGWRmVOlyiyrp9j-XJN3TfhF57Y_19HdtT3yLszqb0mJeIPLO66K0ls96aqjCfn6YfyylVsBiWomsvHUxklb_mZZG8pJiQ82iyMA9KVgkGo68ujHKEGB8BLP7kfxEgM45fP2DCeuElpkQXJGWVhoQITnrDPYnX1L5RBBl1Sy_HFgupsV5mv6e-qEj8poRZxLJqEYv3n762T5wWyc230vjqeenX7NuDmygQK97M3dJdqg3rVQA, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641905969, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=172.29.0.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.29.0.1, http-session-id=0F06E3DCCBC1F7FB02387CB58BD59449, http-session-last-accessed-time=1641905676393, kc-category-name=ACCESS, kc-iat=1641905669, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.29.0.1:65200 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 12:54:36.416  INFO 14 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 12:54:36.432  INFO 14 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3189d169
2022-01-11 12:54:36.437  INFO 14 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3189d169
2022-01-11 12:54:36.478  INFO 14 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3189d169
2022-01-11 12:54:36.483  INFO 14 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3189d169
2022-01-11 12:54:36.524  INFO 14 --- [https-jsse-nio-7071-exec-2] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-4856004494575-922431, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:b90c11d7-db11-4fad-aaae-8c841010ad99:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=b90c11d7-db11-4fad-aaae-8c841010ad99, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time before Shift end, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-11 12:54:36.527  INFO 14 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=ba162ea4-1f33-45ab-93c7-735cd1f3429f, content=DENY, timestamp=1641905676527, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:b90c11d7-db11-4fad-aaae-8c841010ad99:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=b90c11d7-db11-4fad-aaae-8c841010ad99, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time before Shift end, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-11 12:54:36.532  INFO 14 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=106ms, Total=124ms
2022-01-11 12:54:36.589  INFO 14 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=c5a79c30-f1a4-450f-abb0-f35e5b0250c8, content=null, timestamp=1641905676576, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=65202, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=eb230e1d0f5c, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.29.0.1, kc-session-state=5479e8ce-ab30-4375-a9ec-31812ab40e37, http-req-server-port=80, http-header-accept=*/*, kc-id=3f3eb186-3198-4309-999b-06de29e30711, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641905676572, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd1/MXNxAH4AEQAAAABh3X4FdAAkM2YzZWIxODYtMzE5OC00MzA5LTk5OWItMDZkZTI5ZTMwNzExdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkNTQ3OWU4Y2UtYWIzMC00Mzc1LWE5ZWMtMzE4MTJhYjQwZTM3cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJIWlNtUmxVS3VKU2sxNUJ6ZEt5UGdzcW90aHA1ZEtYRlVDZmluNi1qVDlNIn0.eyJleHAiOjE2NDE5MDU5NjksImlhdCI6MTY0MTkwNTY2OSwianRpIjoiM2YzZWIxODYtMzE5OC00MzA5LTk5OWItMDZkZTI5ZTMwNzExIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiNTQ3OWU4Y2UtYWIzMC00Mzc1LWE5ZWMtMzE4MTJhYjQwZTM3IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Qo2snvszM0ZptvUZiRHLSSO4nz1K0HwEkVPSMfl64bUpFF7dFqQatXHINmKGObf_HLuTviCYih0aDatO_ipy06Y4tSx-aQoewxxEkeGWRmVOlyiyrp9j-XJN3TfhF57Y_19HdtT3yLszqb0mJeIPLO66K0ls96aqjCfn6YfyylVsBiWomsvHUxklb_mZZG8pJiQ82iyMA9KVgkGo68ujHKEGB8BLP7kfxEgM45fP2DCeuElpkQXJGWVhoQITnrDPYnX1L5RBBl1Sy_HFgupsV5mv6e-qEj8poRZxLJqEYv3n762T5wWyc230vjqeenX7NuDmygQK97M3dJdqg3rVQA, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641905969, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=172.29.0.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.29.0.1, http-session-id=D6AB8CC5F92FCE3CDF0C60780FE68FC4, http-session-last-accessed-time=1641905676572, kc-category-name=ACCESS, kc-iat=1641905669, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.29.0.1:65202 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 12:54:36.595  INFO 14 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 12:54:36.605  INFO 14 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@311d441b
2022-01-11 12:54:36.610  INFO 14 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@311d441b
2022-01-11 12:54:36.652  INFO 14 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@311d441b
2022-01-11 12:54:36.656  INFO 14 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@311d441b
2022-01-11 12:54:36.694  INFO 14 --- [https-jsse-nio-7071-exec-3] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-4856182694175-755153, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:b90c11d7-db11-4fad-aaae-8c841010ad99:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=b90c11d7-db11-4fad-aaae-8c841010ad99, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time before Shift end, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-11 12:54:36.695  INFO 14 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=c5a79c30-f1a4-450f-abb0-f35e5b0250c8, content=DENY, timestamp=1641905676695, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:b90c11d7-db11-4fad-aaae-8c841010ad99:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=b90c11d7-db11-4fad-aaae-8c841010ad99, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time before Shift end, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-11 12:54:36.700  INFO 14 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=96ms, Total=113ms
2022-01-11 12:54:36.741  INFO 14 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=5287b78d-8d83-46ae-9f91-6f28c968ea00, content=null, timestamp=1641905676734, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=65204, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=eb230e1d0f5c, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.29.0.1, kc-session-state=5479e8ce-ab30-4375-a9ec-31812ab40e37, http-req-server-port=80, http-header-accept=*/*, kc-id=3f3eb186-3198-4309-999b-06de29e30711, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641905676732, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd1/MXNxAH4AEQAAAABh3X4FdAAkM2YzZWIxODYtMzE5OC00MzA5LTk5OWItMDZkZTI5ZTMwNzExdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkNTQ3OWU4Y2UtYWIzMC00Mzc1LWE5ZWMtMzE4MTJhYjQwZTM3cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJIWlNtUmxVS3VKU2sxNUJ6ZEt5UGdzcW90aHA1ZEtYRlVDZmluNi1qVDlNIn0.eyJleHAiOjE2NDE5MDU5NjksImlhdCI6MTY0MTkwNTY2OSwianRpIjoiM2YzZWIxODYtMzE5OC00MzA5LTk5OWItMDZkZTI5ZTMwNzExIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiNTQ3OWU4Y2UtYWIzMC00Mzc1LWE5ZWMtMzE4MTJhYjQwZTM3IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Qo2snvszM0ZptvUZiRHLSSO4nz1K0HwEkVPSMfl64bUpFF7dFqQatXHINmKGObf_HLuTviCYih0aDatO_ipy06Y4tSx-aQoewxxEkeGWRmVOlyiyrp9j-XJN3TfhF57Y_19HdtT3yLszqb0mJeIPLO66K0ls96aqjCfn6YfyylVsBiWomsvHUxklb_mZZG8pJiQ82iyMA9KVgkGo68ujHKEGB8BLP7kfxEgM45fP2DCeuElpkQXJGWVhoQITnrDPYnX1L5RBBl1Sy_HFgupsV5mv6e-qEj8poRZxLJqEYv3n762T5wWyc230vjqeenX7NuDmygQK97M3dJdqg3rVQA, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641905969, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=172.29.0.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.29.0.1, http-session-id=DD73A81A5E3173654DDD51F78C0E7F3C, http-session-last-accessed-time=1641905676732, kc-category-name=ACCESS, kc-iat=1641905669, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.29.0.1:65204 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 12:54:36.745  INFO 14 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 12:54:36.750  INFO 14 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6b01f772
2022-01-11 12:54:36.752  INFO 14 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6b01f772
2022-01-11 12:54:36.783  INFO 14 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6b01f772
2022-01-11 12:54:36.787  INFO 14 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6b01f772
2022-01-11 12:54:36.859  INFO 14 --- [https-jsse-nio-7071-exec-4] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-4856329936575-337509, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:b90c11d7-db11-4fad-aaae-8c841010ad99:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=b90c11d7-db11-4fad-aaae-8c841010ad99, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time before Shift end, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-11 12:54:36.863  INFO 14 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=5287b78d-8d83-46ae-9f91-6f28c968ea00, content=DENY, timestamp=1641905676863, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:b90c11d7-db11-4fad-aaae-8c841010ad99:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=b90c11d7-db11-4fad-aaae-8c841010ad99, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time before Shift end, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-11 12:54:36.866  INFO 14 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=116ms, Total=127ms
2022-01-11 12:54:36.934  INFO 14 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=c293c623-8fa5-47d1-839f-09f87946faf2, content=null, timestamp=1641905676907, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=65206, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=eb230e1d0f5c, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.29.0.1, kc-session-state=5479e8ce-ab30-4375-a9ec-31812ab40e37, http-req-server-port=80, http-header-accept=*/*, kc-id=3f3eb186-3198-4309-999b-06de29e30711, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641905676904, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd1/MXNxAH4AEQAAAABh3X4FdAAkM2YzZWIxODYtMzE5OC00MzA5LTk5OWItMDZkZTI5ZTMwNzExdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkNTQ3OWU4Y2UtYWIzMC00Mzc1LWE5ZWMtMzE4MTJhYjQwZTM3cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJIWlNtUmxVS3VKU2sxNUJ6ZEt5UGdzcW90aHA1ZEtYRlVDZmluNi1qVDlNIn0.eyJleHAiOjE2NDE5MDU5NjksImlhdCI6MTY0MTkwNTY2OSwianRpIjoiM2YzZWIxODYtMzE5OC00MzA5LTk5OWItMDZkZTI5ZTMwNzExIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiNTQ3OWU4Y2UtYWIzMC00Mzc1LWE5ZWMtMzE4MTJhYjQwZTM3IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Qo2snvszM0ZptvUZiRHLSSO4nz1K0HwEkVPSMfl64bUpFF7dFqQatXHINmKGObf_HLuTviCYih0aDatO_ipy06Y4tSx-aQoewxxEkeGWRmVOlyiyrp9j-XJN3TfhF57Y_19HdtT3yLszqb0mJeIPLO66K0ls96aqjCfn6YfyylVsBiWomsvHUxklb_mZZG8pJiQ82iyMA9KVgkGo68ujHKEGB8BLP7kfxEgM45fP2DCeuElpkQXJGWVhoQITnrDPYnX1L5RBBl1Sy_HFgupsV5mv6e-qEj8poRZxLJqEYv3n762T5wWyc230vjqeenX7NuDmygQK97M3dJdqg3rVQA, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641905969, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=172.29.0.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.29.0.1, http-session-id=589F194055DB466F24392773417405D7, http-session-last-accessed-time=1641905676904, kc-category-name=ACCESS, kc-iat=1641905669, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.29.0.1:65206 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 12:54:36.941  INFO 14 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 12:54:36.962  INFO 14 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1f38aff7
2022-01-11 12:54:36.970  INFO 14 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1f38aff7
2022-01-11 12:54:37.073  INFO 14 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1f38aff7
2022-01-11 12:54:37.078  INFO 14 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1f38aff7
2022-01-11 12:54:37.158  INFO 14 --- [https-jsse-nio-7071-exec-5] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-4856527486675-93476, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:b90c11d7-db11-4fad-aaae-8c841010ad99:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=b90c11d7-db11-4fad-aaae-8c841010ad99, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time before Shift end, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-11 12:54:37.166  INFO 14 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=c293c623-8fa5-47d1-839f-09f87946faf2, content=DENY, timestamp=1641905677166, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:b90c11d7-db11-4fad-aaae-8c841010ad99:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=b90c11d7-db11-4fad-aaae-8c841010ad99, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time before Shift end, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-11 12:54:37.176  INFO 14 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=222ms, Total=243ms
2022-01-11 12:54:37.234  INFO 14 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=fbf58c28-4d81-40c6-a68a-1cff7bfdd993, content=null, timestamp=1641905677216, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=65208, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=eb230e1d0f5c, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.29.0.1, kc-session-state=5479e8ce-ab30-4375-a9ec-31812ab40e37, http-req-server-port=80, http-header-accept=*/*, kc-id=3f3eb186-3198-4309-999b-06de29e30711, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641905677214, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd1/MXNxAH4AEQAAAABh3X4FdAAkM2YzZWIxODYtMzE5OC00MzA5LTk5OWItMDZkZTI5ZTMwNzExdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkNTQ3OWU4Y2UtYWIzMC00Mzc1LWE5ZWMtMzE4MTJhYjQwZTM3cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJIWlNtUmxVS3VKU2sxNUJ6ZEt5UGdzcW90aHA1ZEtYRlVDZmluNi1qVDlNIn0.eyJleHAiOjE2NDE5MDU5NjksImlhdCI6MTY0MTkwNTY2OSwianRpIjoiM2YzZWIxODYtMzE5OC00MzA5LTk5OWItMDZkZTI5ZTMwNzExIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiNTQ3OWU4Y2UtYWIzMC00Mzc1LWE5ZWMtMzE4MTJhYjQwZTM3IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Qo2snvszM0ZptvUZiRHLSSO4nz1K0HwEkVPSMfl64bUpFF7dFqQatXHINmKGObf_HLuTviCYih0aDatO_ipy06Y4tSx-aQoewxxEkeGWRmVOlyiyrp9j-XJN3TfhF57Y_19HdtT3yLszqb0mJeIPLO66K0ls96aqjCfn6YfyylVsBiWomsvHUxklb_mZZG8pJiQ82iyMA9KVgkGo68ujHKEGB8BLP7kfxEgM45fP2DCeuElpkQXJGWVhoQITnrDPYnX1L5RBBl1Sy_HFgupsV5mv6e-qEj8poRZxLJqEYv3n762T5wWyc230vjqeenX7NuDmygQK97M3dJdqg3rVQA, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641905969, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=172.29.0.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.29.0.1, http-session-id=3CA0C31D7DC8B70BA16FB58788226C4C, http-session-last-accessed-time=1641905677214, kc-category-name=ACCESS, kc-iat=1641905669, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.29.0.1:65208 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 12:54:37.246  INFO 14 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 12:54:37.250  INFO 14 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3d145282
2022-01-11 12:54:37.254  INFO 14 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3d145282
2022-01-11 12:54:37.324  INFO 14 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3d145282
2022-01-11 12:54:37.329  INFO 14 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3d145282
2022-01-11 12:54:37.363  INFO 14 --- [https-jsse-nio-7071-exec-6] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-4856831293275-161267, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:b90c11d7-db11-4fad-aaae-8c841010ad99:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=b90c11d7-db11-4fad-aaae-8c841010ad99, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time before Shift end, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-11 12:54:37.367  INFO 14 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=fbf58c28-4d81-40c6-a68a-1cff7bfdd993, content=DENY, timestamp=1641905677366, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:b90c11d7-db11-4fad-aaae-8c841010ad99:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=b90c11d7-db11-4fad-aaae-8c841010ad99, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time before Shift end, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-11 12:54:37.371  INFO 14 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=118ms, Total=147ms
2022-01-11 12:54:37.458  INFO 14 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=70500f9a-240d-444c-8d98-6b26c3308707, content=null, timestamp=1641905677447, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=65210, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=eb230e1d0f5c, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.29.0.1, kc-session-state=5479e8ce-ab30-4375-a9ec-31812ab40e37, http-req-server-port=80, http-header-accept=*/*, kc-id=3f3eb186-3198-4309-999b-06de29e30711, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641905677444, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd1/MXNxAH4AEQAAAABh3X4FdAAkM2YzZWIxODYtMzE5OC00MzA5LTk5OWItMDZkZTI5ZTMwNzExdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkNTQ3OWU4Y2UtYWIzMC00Mzc1LWE5ZWMtMzE4MTJhYjQwZTM3cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJIWlNtUmxVS3VKU2sxNUJ6ZEt5UGdzcW90aHA1ZEtYRlVDZmluNi1qVDlNIn0.eyJleHAiOjE2NDE5MDU5NjksImlhdCI6MTY0MTkwNTY2OSwianRpIjoiM2YzZWIxODYtMzE5OC00MzA5LTk5OWItMDZkZTI5ZTMwNzExIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiNTQ3OWU4Y2UtYWIzMC00Mzc1LWE5ZWMtMzE4MTJhYjQwZTM3IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Qo2snvszM0ZptvUZiRHLSSO4nz1K0HwEkVPSMfl64bUpFF7dFqQatXHINmKGObf_HLuTviCYih0aDatO_ipy06Y4tSx-aQoewxxEkeGWRmVOlyiyrp9j-XJN3TfhF57Y_19HdtT3yLszqb0mJeIPLO66K0ls96aqjCfn6YfyylVsBiWomsvHUxklb_mZZG8pJiQ82iyMA9KVgkGo68ujHKEGB8BLP7kfxEgM45fP2DCeuElpkQXJGWVhoQITnrDPYnX1L5RBBl1Sy_HFgupsV5mv6e-qEj8poRZxLJqEYv3n762T5wWyc230vjqeenX7NuDmygQK97M3dJdqg3rVQA, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641905969, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=172.29.0.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.29.0.1, http-session-id=B4A57FD0674873D51D47684CC1E46944, http-session-last-accessed-time=1641905677444, kc-category-name=ACCESS, kc-iat=1641905669, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.29.0.1:65210 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 12:54:37.466  INFO 14 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 12:54:37.482  INFO 14 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@36f7e396
2022-01-11 12:54:37.486  INFO 14 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@36f7e396
2022-01-11 12:54:37.530  INFO 14 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@36f7e396
2022-01-11 12:54:37.534  INFO 14 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@36f7e396
2022-01-11 12:54:37.613  INFO 14 --- [https-jsse-nio-7071-exec-7] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-4857057158475-357089, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:b90c11d7-db11-4fad-aaae-8c841010ad99:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=b90c11d7-db11-4fad-aaae-8c841010ad99, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time before Shift end, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-11 12:54:37.621  INFO 14 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=70500f9a-240d-444c-8d98-6b26c3308707, content=DENY, timestamp=1641905677621, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:b90c11d7-db11-4fad-aaae-8c841010ad99:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=b90c11d7-db11-4fad-aaae-8c841010ad99, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time before Shift end, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-11 12:54:37.626  INFO 14 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=147ms, Total=170ms
2022-01-11 12:54:37.710  INFO 14 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=7a31a9f5-cb06-482a-ade6-af813edbbcbd, content=null, timestamp=1641905677698, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=65212, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=eb230e1d0f5c, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.29.0.1, kc-session-state=5479e8ce-ab30-4375-a9ec-31812ab40e37, http-req-server-port=80, http-header-accept=*/*, kc-id=3f3eb186-3198-4309-999b-06de29e30711, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641905677689, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd1/MXNxAH4AEQAAAABh3X4FdAAkM2YzZWIxODYtMzE5OC00MzA5LTk5OWItMDZkZTI5ZTMwNzExdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkNTQ3OWU4Y2UtYWIzMC00Mzc1LWE5ZWMtMzE4MTJhYjQwZTM3cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJIWlNtUmxVS3VKU2sxNUJ6ZEt5UGdzcW90aHA1ZEtYRlVDZmluNi1qVDlNIn0.eyJleHAiOjE2NDE5MDU5NjksImlhdCI6MTY0MTkwNTY2OSwianRpIjoiM2YzZWIxODYtMzE5OC00MzA5LTk5OWItMDZkZTI5ZTMwNzExIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiNTQ3OWU4Y2UtYWIzMC00Mzc1LWE5ZWMtMzE4MTJhYjQwZTM3IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Qo2snvszM0ZptvUZiRHLSSO4nz1K0HwEkVPSMfl64bUpFF7dFqQatXHINmKGObf_HLuTviCYih0aDatO_ipy06Y4tSx-aQoewxxEkeGWRmVOlyiyrp9j-XJN3TfhF57Y_19HdtT3yLszqb0mJeIPLO66K0ls96aqjCfn6YfyylVsBiWomsvHUxklb_mZZG8pJiQ82iyMA9KVgkGo68ujHKEGB8BLP7kfxEgM45fP2DCeuElpkQXJGWVhoQITnrDPYnX1L5RBBl1Sy_HFgupsV5mv6e-qEj8poRZxLJqEYv3n762T5wWyc230vjqeenX7NuDmygQK97M3dJdqg3rVQA, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641905969, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=172.29.0.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.29.0.1, http-session-id=D5EDABB361E021ED9AD9E92868DDF9E8, http-session-last-accessed-time=1641905677689, kc-category-name=ACCESS, kc-iat=1641905669, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.29.0.1:65212 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 12:54:37.750  INFO 14 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 12:54:37.763  INFO 14 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@551796f1
2022-01-11 12:54:37.768  INFO 14 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@551796f1
2022-01-11 12:54:37.799  INFO 14 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@551796f1
2022-01-11 12:54:37.802  INFO 14 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@551796f1
2022-01-11 12:54:37.832  INFO 14 --- [https-jsse-nio-7071-exec-8] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-4857343353075-777523, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:b90c11d7-db11-4fad-aaae-8c841010ad99:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=b90c11d7-db11-4fad-aaae-8c841010ad99, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time before Shift end, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-11 12:54:37.837  INFO 14 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=7a31a9f5-cb06-482a-ade6-af813edbbcbd, content=DENY, timestamp=1641905677837, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:b90c11d7-db11-4fad-aaae-8c841010ad99:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=b90c11d7-db11-4fad-aaae-8c841010ad99, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time before Shift end, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-11 12:54:37.842  INFO 14 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=77ms, Total=140ms
2022-01-11 12:54:37.908  INFO 14 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=b9b8cd0d-6706-4ee8-a4fa-d5e2a2eb5b02, content=null, timestamp=1641905677897, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=65214, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=eb230e1d0f5c, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.29.0.1, kc-session-state=5479e8ce-ab30-4375-a9ec-31812ab40e37, http-req-server-port=80, http-header-accept=*/*, kc-id=3f3eb186-3198-4309-999b-06de29e30711, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641905677894, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd1/MXNxAH4AEQAAAABh3X4FdAAkM2YzZWIxODYtMzE5OC00MzA5LTk5OWItMDZkZTI5ZTMwNzExdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkNTQ3OWU4Y2UtYWIzMC00Mzc1LWE5ZWMtMzE4MTJhYjQwZTM3cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJIWlNtUmxVS3VKU2sxNUJ6ZEt5UGdzcW90aHA1ZEtYRlVDZmluNi1qVDlNIn0.eyJleHAiOjE2NDE5MDU5NjksImlhdCI6MTY0MTkwNTY2OSwianRpIjoiM2YzZWIxODYtMzE5OC00MzA5LTk5OWItMDZkZTI5ZTMwNzExIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiNTQ3OWU4Y2UtYWIzMC00Mzc1LWE5ZWMtMzE4MTJhYjQwZTM3IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Qo2snvszM0ZptvUZiRHLSSO4nz1K0HwEkVPSMfl64bUpFF7dFqQatXHINmKGObf_HLuTviCYih0aDatO_ipy06Y4tSx-aQoewxxEkeGWRmVOlyiyrp9j-XJN3TfhF57Y_19HdtT3yLszqb0mJeIPLO66K0ls96aqjCfn6YfyylVsBiWomsvHUxklb_mZZG8pJiQ82iyMA9KVgkGo68ujHKEGB8BLP7kfxEgM45fP2DCeuElpkQXJGWVhoQITnrDPYnX1L5RBBl1Sy_HFgupsV5mv6e-qEj8poRZxLJqEYv3n762T5wWyc230vjqeenX7NuDmygQK97M3dJdqg3rVQA, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641905969, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=172.29.0.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.29.0.1, http-session-id=FCCC5A56D285BEC53F1F34A3593D5E1D, http-session-last-accessed-time=1641905677894, kc-category-name=ACCESS, kc-iat=1641905669, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.29.0.1:65214 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 12:54:37.916  INFO 14 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 12:54:37.924  INFO 14 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@26468c8c
2022-01-11 12:54:37.927  INFO 14 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@26468c8c
2022-01-11 12:54:37.966  INFO 14 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@26468c8c
2022-01-11 12:54:37.970  INFO 14 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@26468c8c
2022-01-11 12:54:38.005  INFO 14 --- [https-jsse-nio-7071-exec-9] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-4857502966475-157639, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:b90c11d7-db11-4fad-aaae-8c841010ad99:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=b90c11d7-db11-4fad-aaae-8c841010ad99, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time before Shift end, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-11 12:54:38.011  INFO 14 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=b9b8cd0d-6706-4ee8-a4fa-d5e2a2eb5b02, content=DENY, timestamp=1641905678011, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:b90c11d7-db11-4fad-aaae-8c841010ad99:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=b90c11d7-db11-4fad-aaae-8c841010ad99, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time before Shift end, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-11 12:54:38.018  INFO 14 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=91ms, Total=113ms
2022-01-11 12:54:38.072  INFO 14 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=a76c0764-42bf-4553-9e6a-0ff4b6b66756, content=null, timestamp=1641905678052, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=65216, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=eb230e1d0f5c, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.29.0.1, kc-session-state=5479e8ce-ab30-4375-a9ec-31812ab40e37, http-req-server-port=80, http-header-accept=*/*, kc-id=3f3eb186-3198-4309-999b-06de29e30711, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641905678048, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd1/MXNxAH4AEQAAAABh3X4FdAAkM2YzZWIxODYtMzE5OC00MzA5LTk5OWItMDZkZTI5ZTMwNzExdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkNTQ3OWU4Y2UtYWIzMC00Mzc1LWE5ZWMtMzE4MTJhYjQwZTM3cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJIWlNtUmxVS3VKU2sxNUJ6ZEt5UGdzcW90aHA1ZEtYRlVDZmluNi1qVDlNIn0.eyJleHAiOjE2NDE5MDU5NjksImlhdCI6MTY0MTkwNTY2OSwianRpIjoiM2YzZWIxODYtMzE5OC00MzA5LTk5OWItMDZkZTI5ZTMwNzExIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiNTQ3OWU4Y2UtYWIzMC00Mzc1LWE5ZWMtMzE4MTJhYjQwZTM3IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Qo2snvszM0ZptvUZiRHLSSO4nz1K0HwEkVPSMfl64bUpFF7dFqQatXHINmKGObf_HLuTviCYih0aDatO_ipy06Y4tSx-aQoewxxEkeGWRmVOlyiyrp9j-XJN3TfhF57Y_19HdtT3yLszqb0mJeIPLO66K0ls96aqjCfn6YfyylVsBiWomsvHUxklb_mZZG8pJiQ82iyMA9KVgkGo68ujHKEGB8BLP7kfxEgM45fP2DCeuElpkQXJGWVhoQITnrDPYnX1L5RBBl1Sy_HFgupsV5mv6e-qEj8poRZxLJqEYv3n762T5wWyc230vjqeenX7NuDmygQK97M3dJdqg3rVQA, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641905969, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=172.29.0.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.29.0.1, http-session-id=EDE73ED064DBF5DA43BA04A415564027, http-session-last-accessed-time=1641905678048, kc-category-name=ACCESS, kc-iat=1641905669, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.29.0.1:65216 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 12:54:38.078  INFO 14 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 12:54:38.092  INFO 14 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@f3ec2ec
2022-01-11 12:54:38.095  INFO 14 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@f3ec2ec
2022-01-11 12:54:38.143  INFO 14 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@f3ec2ec
2022-01-11 12:54:38.147  INFO 14 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@f3ec2ec
2022-01-11 12:54:38.222  INFO 14 --- [https-jsse-nio-7071-exec-10] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-4857673045275-852129, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:b90c11d7-db11-4fad-aaae-8c841010ad99:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=b90c11d7-db11-4fad-aaae-8c841010ad99, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time before Shift end, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-11 12:54:38.226  INFO 14 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=a76c0764-42bf-4553-9e6a-0ff4b6b66756, content=DENY, timestamp=1641905678226, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:b90c11d7-db11-4fad-aaae-8c841010ad99:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=b90c11d7-db11-4fad-aaae-8c841010ad99, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time before Shift end, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-11 12:54:38.231  INFO 14 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=135ms, Total=160ms
2022-01-11 12:54:38.267  INFO 14 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=a6191790-f0b2-4db5-9a3d-755a68ae92df, content=null, timestamp=1641905678257, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=65218, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=eb230e1d0f5c, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.29.0.1, kc-session-state=5479e8ce-ab30-4375-a9ec-31812ab40e37, http-req-server-port=80, http-header-accept=*/*, kc-id=3f3eb186-3198-4309-999b-06de29e30711, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641905678255, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd1/MXNxAH4AEQAAAABh3X4FdAAkM2YzZWIxODYtMzE5OC00MzA5LTk5OWItMDZkZTI5ZTMwNzExdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkNTQ3OWU4Y2UtYWIzMC00Mzc1LWE5ZWMtMzE4MTJhYjQwZTM3cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJIWlNtUmxVS3VKU2sxNUJ6ZEt5UGdzcW90aHA1ZEtYRlVDZmluNi1qVDlNIn0.eyJleHAiOjE2NDE5MDU5NjksImlhdCI6MTY0MTkwNTY2OSwianRpIjoiM2YzZWIxODYtMzE5OC00MzA5LTk5OWItMDZkZTI5ZTMwNzExIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiNTQ3OWU4Y2UtYWIzMC00Mzc1LWE5ZWMtMzE4MTJhYjQwZTM3IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Qo2snvszM0ZptvUZiRHLSSO4nz1K0HwEkVPSMfl64bUpFF7dFqQatXHINmKGObf_HLuTviCYih0aDatO_ipy06Y4tSx-aQoewxxEkeGWRmVOlyiyrp9j-XJN3TfhF57Y_19HdtT3yLszqb0mJeIPLO66K0ls96aqjCfn6YfyylVsBiWomsvHUxklb_mZZG8pJiQ82iyMA9KVgkGo68ujHKEGB8BLP7kfxEgM45fP2DCeuElpkQXJGWVhoQITnrDPYnX1L5RBBl1Sy_HFgupsV5mv6e-qEj8poRZxLJqEYv3n762T5wWyc230vjqeenX7NuDmygQK97M3dJdqg3rVQA, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641905969, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=172.29.0.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.29.0.1, http-session-id=EF1F808C424CF5A45CFB861D23EB4C9A, http-session-last-accessed-time=1641905678255, kc-category-name=ACCESS, kc-iat=1641905669, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.29.0.1:65218 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 12:54:38.278  INFO 14 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 12:54:38.283  INFO 14 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5b553b97
2022-01-11 12:54:38.285  INFO 14 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5b553b97
2022-01-11 12:54:38.310  INFO 14 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5b553b97
2022-01-11 12:54:38.313  INFO 14 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5b553b97
2022-01-11 12:54:38.340  INFO 14 --- [https-jsse-nio-7071-exec-1] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-4857863437875-40381, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:b90c11d7-db11-4fad-aaae-8c841010ad99:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=b90c11d7-db11-4fad-aaae-8c841010ad99, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time before Shift end, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-11 12:54:38.344  INFO 14 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=a6191790-f0b2-4db5-9a3d-755a68ae92df, content=DENY, timestamp=1641905678344, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:b90c11d7-db11-4fad-aaae-8c841010ad99:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=b90c11d7-db11-4fad-aaae-8c841010ad99, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time before Shift end, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-11 12:54:38.350  INFO 14 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=63ms, Total=87ms
2022-01-11 12:54:38.393  INFO 14 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=41d2e26f-d4df-43e6-8d28-6e50f8fc2a5d, content=null, timestamp=1641905678385, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=65220, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=eb230e1d0f5c, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.29.0.1, kc-session-state=5479e8ce-ab30-4375-a9ec-31812ab40e37, http-req-server-port=80, http-header-accept=*/*, kc-id=3f3eb186-3198-4309-999b-06de29e30711, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641905678377, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd1/MXNxAH4AEQAAAABh3X4FdAAkM2YzZWIxODYtMzE5OC00MzA5LTk5OWItMDZkZTI5ZTMwNzExdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkNTQ3OWU4Y2UtYWIzMC00Mzc1LWE5ZWMtMzE4MTJhYjQwZTM3cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJIWlNtUmxVS3VKU2sxNUJ6ZEt5UGdzcW90aHA1ZEtYRlVDZmluNi1qVDlNIn0.eyJleHAiOjE2NDE5MDU5NjksImlhdCI6MTY0MTkwNTY2OSwianRpIjoiM2YzZWIxODYtMzE5OC00MzA5LTk5OWItMDZkZTI5ZTMwNzExIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiNTQ3OWU4Y2UtYWIzMC00Mzc1LWE5ZWMtMzE4MTJhYjQwZTM3IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Qo2snvszM0ZptvUZiRHLSSO4nz1K0HwEkVPSMfl64bUpFF7dFqQatXHINmKGObf_HLuTviCYih0aDatO_ipy06Y4tSx-aQoewxxEkeGWRmVOlyiyrp9j-XJN3TfhF57Y_19HdtT3yLszqb0mJeIPLO66K0ls96aqjCfn6YfyylVsBiWomsvHUxklb_mZZG8pJiQ82iyMA9KVgkGo68ujHKEGB8BLP7kfxEgM45fP2DCeuElpkQXJGWVhoQITnrDPYnX1L5RBBl1Sy_HFgupsV5mv6e-qEj8poRZxLJqEYv3n762T5wWyc230vjqeenX7NuDmygQK97M3dJdqg3rVQA, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641905969, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=172.29.0.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.29.0.1, http-session-id=00B21DA48105762728415507B68EFF31, http-session-last-accessed-time=1641905678377, kc-category-name=ACCESS, kc-iat=1641905669, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.29.0.1:65220 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 12:54:38.401  INFO 14 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 12:54:38.404  INFO 14 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2f435479
2022-01-11 12:54:38.408  INFO 14 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2f435479
2022-01-11 12:54:38.470  INFO 14 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2f435479
2022-01-11 12:54:38.473  INFO 14 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2f435479
2022-01-11 12:54:38.572  INFO 14 --- [https-jsse-nio-7071-exec-2] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-4857986252575-47976, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:b90c11d7-db11-4fad-aaae-8c841010ad99:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=b90c11d7-db11-4fad-aaae-8c841010ad99, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time before Shift end, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-11 12:54:38.577  INFO 14 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=41d2e26f-d4df-43e6-8d28-6e50f8fc2a5d, content=DENY, timestamp=1641905678577, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:b90c11d7-db11-4fad-aaae-8c841010ad99:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=b90c11d7-db11-4fad-aaae-8c841010ad99, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time before Shift end, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-11 12:54:38.587  INFO 14 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=174ms, Total=196ms
2022-01-11 12:54:38.660  INFO 14 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=cb604ecc-9acd-47b1-8992-f2e58271c984, content=null, timestamp=1641905678635, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=65222, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=eb230e1d0f5c, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.29.0.1, kc-session-state=5479e8ce-ab30-4375-a9ec-31812ab40e37, http-req-server-port=80, http-header-accept=*/*, kc-id=3f3eb186-3198-4309-999b-06de29e30711, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641905678630, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd1/MXNxAH4AEQAAAABh3X4FdAAkM2YzZWIxODYtMzE5OC00MzA5LTk5OWItMDZkZTI5ZTMwNzExdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkNTQ3OWU4Y2UtYWIzMC00Mzc1LWE5ZWMtMzE4MTJhYjQwZTM3cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJIWlNtUmxVS3VKU2sxNUJ6ZEt5UGdzcW90aHA1ZEtYRlVDZmluNi1qVDlNIn0.eyJleHAiOjE2NDE5MDU5NjksImlhdCI6MTY0MTkwNTY2OSwianRpIjoiM2YzZWIxODYtMzE5OC00MzA5LTk5OWItMDZkZTI5ZTMwNzExIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiNTQ3OWU4Y2UtYWIzMC00Mzc1LWE5ZWMtMzE4MTJhYjQwZTM3IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Qo2snvszM0ZptvUZiRHLSSO4nz1K0HwEkVPSMfl64bUpFF7dFqQatXHINmKGObf_HLuTviCYih0aDatO_ipy06Y4tSx-aQoewxxEkeGWRmVOlyiyrp9j-XJN3TfhF57Y_19HdtT3yLszqb0mJeIPLO66K0ls96aqjCfn6YfyylVsBiWomsvHUxklb_mZZG8pJiQ82iyMA9KVgkGo68ujHKEGB8BLP7kfxEgM45fP2DCeuElpkQXJGWVhoQITnrDPYnX1L5RBBl1Sy_HFgupsV5mv6e-qEj8poRZxLJqEYv3n762T5wWyc230vjqeenX7NuDmygQK97M3dJdqg3rVQA, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641905969, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=172.29.0.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.29.0.1, http-session-id=E99D60A3A11A796CDAF95E9BCE80FB12, http-session-last-accessed-time=1641905678630, kc-category-name=ACCESS, kc-iat=1641905669, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.29.0.1:65222 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 12:54:38.674  INFO 14 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 12:54:38.696  INFO 14 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6926b648
2022-01-11 12:54:38.704  INFO 14 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6926b648
2022-01-11 12:54:38.749  INFO 14 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6926b648
2022-01-11 12:54:38.753  INFO 14 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6926b648
2022-01-11 12:54:38.788  INFO 14 --- [https-jsse-nio-7071-exec-3] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-4858266791075-747323, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:b90c11d7-db11-4fad-aaae-8c841010ad99:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=b90c11d7-db11-4fad-aaae-8c841010ad99, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time before Shift end, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-11 12:54:38.792  INFO 14 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=cb604ecc-9acd-47b1-8992-f2e58271c984, content=DENY, timestamp=1641905678792, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:b90c11d7-db11-4fad-aaae-8c841010ad99:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=b90c11d7-db11-4fad-aaae-8c841010ad99, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time before Shift end, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-11 12:54:38.796  INFO 14 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=109ms, Total=141ms
2022-01-11 12:54:38.844  INFO 14 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=5a35740d-2308-4bae-a025-7df5db9a9ccd, content=null, timestamp=1641905678836, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=65224, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=eb230e1d0f5c, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.29.0.1, kc-session-state=5479e8ce-ab30-4375-a9ec-31812ab40e37, http-req-server-port=80, http-header-accept=*/*, kc-id=3f3eb186-3198-4309-999b-06de29e30711, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641905678832, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd1/MXNxAH4AEQAAAABh3X4FdAAkM2YzZWIxODYtMzE5OC00MzA5LTk5OWItMDZkZTI5ZTMwNzExdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkNTQ3OWU4Y2UtYWIzMC00Mzc1LWE5ZWMtMzE4MTJhYjQwZTM3cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJIWlNtUmxVS3VKU2sxNUJ6ZEt5UGdzcW90aHA1ZEtYRlVDZmluNi1qVDlNIn0.eyJleHAiOjE2NDE5MDU5NjksImlhdCI6MTY0MTkwNTY2OSwianRpIjoiM2YzZWIxODYtMzE5OC00MzA5LTk5OWItMDZkZTI5ZTMwNzExIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiNTQ3OWU4Y2UtYWIzMC00Mzc1LWE5ZWMtMzE4MTJhYjQwZTM3IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Qo2snvszM0ZptvUZiRHLSSO4nz1K0HwEkVPSMfl64bUpFF7dFqQatXHINmKGObf_HLuTviCYih0aDatO_ipy06Y4tSx-aQoewxxEkeGWRmVOlyiyrp9j-XJN3TfhF57Y_19HdtT3yLszqb0mJeIPLO66K0ls96aqjCfn6YfyylVsBiWomsvHUxklb_mZZG8pJiQ82iyMA9KVgkGo68ujHKEGB8BLP7kfxEgM45fP2DCeuElpkQXJGWVhoQITnrDPYnX1L5RBBl1Sy_HFgupsV5mv6e-qEj8poRZxLJqEYv3n762T5wWyc230vjqeenX7NuDmygQK97M3dJdqg3rVQA, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641905969, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=172.29.0.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.29.0.1, http-session-id=DEA48FD7EB3D44FD15974B1790A46511, http-session-last-accessed-time=1641905678832, kc-category-name=ACCESS, kc-iat=1641905669, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.29.0.1:65224 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 12:54:38.853  INFO 14 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 12:54:38.857  INFO 14 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@741ed33d
2022-01-11 12:54:38.860  INFO 14 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@741ed33d
2022-01-11 12:54:38.897  INFO 14 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@741ed33d
2022-01-11 12:54:38.901  INFO 14 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@741ed33d
2022-01-11 12:54:38.937  INFO 14 --- [https-jsse-nio-7071-exec-4] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-4858438726975-832199, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:b90c11d7-db11-4fad-aaae-8c841010ad99:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=b90c11d7-db11-4fad-aaae-8c841010ad99, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time before Shift end, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-11 12:54:38.942  INFO 14 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=5a35740d-2308-4bae-a025-7df5db9a9ccd, content=DENY, timestamp=1641905678942, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:b90c11d7-db11-4fad-aaae-8c841010ad99:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=b90c11d7-db11-4fad-aaae-8c841010ad99, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time before Shift end, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-11 12:54:38.959  INFO 14 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=87ms, Total=117ms
2022-01-11 12:54:39.012  INFO 14 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=cfde7cfa-cd08-44be-8c37-0e9f66dee133, content=null, timestamp=1641905679004, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=65226, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=eb230e1d0f5c, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.29.0.1, kc-session-state=5479e8ce-ab30-4375-a9ec-31812ab40e37, http-req-server-port=80, http-header-accept=*/*, kc-id=3f3eb186-3198-4309-999b-06de29e30711, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641905679002, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd1/MXNxAH4AEQAAAABh3X4FdAAkM2YzZWIxODYtMzE5OC00MzA5LTk5OWItMDZkZTI5ZTMwNzExdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkNTQ3OWU4Y2UtYWIzMC00Mzc1LWE5ZWMtMzE4MTJhYjQwZTM3cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJIWlNtUmxVS3VKU2sxNUJ6ZEt5UGdzcW90aHA1ZEtYRlVDZmluNi1qVDlNIn0.eyJleHAiOjE2NDE5MDU5NjksImlhdCI6MTY0MTkwNTY2OSwianRpIjoiM2YzZWIxODYtMzE5OC00MzA5LTk5OWItMDZkZTI5ZTMwNzExIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiNTQ3OWU4Y2UtYWIzMC00Mzc1LWE5ZWMtMzE4MTJhYjQwZTM3IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Qo2snvszM0ZptvUZiRHLSSO4nz1K0HwEkVPSMfl64bUpFF7dFqQatXHINmKGObf_HLuTviCYih0aDatO_ipy06Y4tSx-aQoewxxEkeGWRmVOlyiyrp9j-XJN3TfhF57Y_19HdtT3yLszqb0mJeIPLO66K0ls96aqjCfn6YfyylVsBiWomsvHUxklb_mZZG8pJiQ82iyMA9KVgkGo68ujHKEGB8BLP7kfxEgM45fP2DCeuElpkQXJGWVhoQITnrDPYnX1L5RBBl1Sy_HFgupsV5mv6e-qEj8poRZxLJqEYv3n762T5wWyc230vjqeenX7NuDmygQK97M3dJdqg3rVQA, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641905969, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=172.29.0.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.29.0.1, http-session-id=0D4FB8B9546EE969E00DD330F20784EE, http-session-last-accessed-time=1641905679002, kc-category-name=ACCESS, kc-iat=1641905669, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.29.0.1:65226 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 12:54:39.018  INFO 14 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 12:54:39.026  INFO 14 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@47cf0860
2022-01-11 12:54:39.030  INFO 14 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@47cf0860
2022-01-11 12:54:39.080  INFO 14 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@47cf0860
2022-01-11 12:54:39.086  INFO 14 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@47cf0860
2022-01-11 12:54:39.149  INFO 14 --- [https-jsse-nio-7071-exec-5] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-4858604491275-616031, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:b90c11d7-db11-4fad-aaae-8c841010ad99:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=b90c11d7-db11-4fad-aaae-8c841010ad99, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time before Shift end, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-11 12:54:39.151  INFO 14 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=cfde7cfa-cd08-44be-8c37-0e9f66dee133, content=DENY, timestamp=1641905679151, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:b90c11d7-db11-4fad-aaae-8c841010ad99:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=b90c11d7-db11-4fad-aaae-8c841010ad99, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time before Shift end, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-11 12:54:39.154  INFO 14 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=130ms, Total=144ms
2022-01-11 12:54:39.207  INFO 14 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=ee06df9d-bf1d-47a2-aa97-f932b7bac445, content=null, timestamp=1641905679201, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=65228, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=eb230e1d0f5c, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.29.0.1, kc-session-state=5479e8ce-ab30-4375-a9ec-31812ab40e37, http-req-server-port=80, http-header-accept=*/*, kc-id=3f3eb186-3198-4309-999b-06de29e30711, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641905679195, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd1/MXNxAH4AEQAAAABh3X4FdAAkM2YzZWIxODYtMzE5OC00MzA5LTk5OWItMDZkZTI5ZTMwNzExdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkNTQ3OWU4Y2UtYWIzMC00Mzc1LWE5ZWMtMzE4MTJhYjQwZTM3cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJIWlNtUmxVS3VKU2sxNUJ6ZEt5UGdzcW90aHA1ZEtYRlVDZmluNi1qVDlNIn0.eyJleHAiOjE2NDE5MDU5NjksImlhdCI6MTY0MTkwNTY2OSwianRpIjoiM2YzZWIxODYtMzE5OC00MzA5LTk5OWItMDZkZTI5ZTMwNzExIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiNTQ3OWU4Y2UtYWIzMC00Mzc1LWE5ZWMtMzE4MTJhYjQwZTM3IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Qo2snvszM0ZptvUZiRHLSSO4nz1K0HwEkVPSMfl64bUpFF7dFqQatXHINmKGObf_HLuTviCYih0aDatO_ipy06Y4tSx-aQoewxxEkeGWRmVOlyiyrp9j-XJN3TfhF57Y_19HdtT3yLszqb0mJeIPLO66K0ls96aqjCfn6YfyylVsBiWomsvHUxklb_mZZG8pJiQ82iyMA9KVgkGo68ujHKEGB8BLP7kfxEgM45fP2DCeuElpkQXJGWVhoQITnrDPYnX1L5RBBl1Sy_HFgupsV5mv6e-qEj8poRZxLJqEYv3n762T5wWyc230vjqeenX7NuDmygQK97M3dJdqg3rVQA, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641905969, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=172.29.0.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.29.0.1, http-session-id=1DB15EEDFB8DE04AF41209C25F9AB4BC, http-session-last-accessed-time=1641905679195, kc-category-name=ACCESS, kc-iat=1641905669, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.29.0.1:65228 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 12:54:39.214  INFO 14 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 12:54:39.220  INFO 14 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7a155f62
2022-01-11 12:54:39.224  INFO 14 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7a155f62
2022-01-11 12:54:39.257  INFO 14 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7a155f62
2022-01-11 12:54:39.261  INFO 14 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7a155f62
2022-01-11 12:54:39.302  INFO 14 --- [https-jsse-nio-7071-exec-6] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-4858800650975-73851, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:b90c11d7-db11-4fad-aaae-8c841010ad99:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=b90c11d7-db11-4fad-aaae-8c841010ad99, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time before Shift end, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-11 12:54:39.305  INFO 14 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=ee06df9d-bf1d-47a2-aa97-f932b7bac445, content=DENY, timestamp=1641905679305, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:b90c11d7-db11-4fad-aaae-8c841010ad99:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=b90c11d7-db11-4fad-aaae-8c841010ad99, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time before Shift end, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-11 12:54:39.313  INFO 14 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=88ms, Total=108ms
2022-01-11 12:54:39.373  INFO 14 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=866d6a2a-9a22-4995-9536-ca6709739ed8, content=null, timestamp=1641905679363, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=65230, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=eb230e1d0f5c, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.29.0.1, kc-session-state=5479e8ce-ab30-4375-a9ec-31812ab40e37, http-req-server-port=80, http-header-accept=*/*, kc-id=3f3eb186-3198-4309-999b-06de29e30711, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641905679349, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd1/MXNxAH4AEQAAAABh3X4FdAAkM2YzZWIxODYtMzE5OC00MzA5LTk5OWItMDZkZTI5ZTMwNzExdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkNTQ3OWU4Y2UtYWIzMC00Mzc1LWE5ZWMtMzE4MTJhYjQwZTM3cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJIWlNtUmxVS3VKU2sxNUJ6ZEt5UGdzcW90aHA1ZEtYRlVDZmluNi1qVDlNIn0.eyJleHAiOjE2NDE5MDU5NjksImlhdCI6MTY0MTkwNTY2OSwianRpIjoiM2YzZWIxODYtMzE5OC00MzA5LTk5OWItMDZkZTI5ZTMwNzExIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiNTQ3OWU4Y2UtYWIzMC00Mzc1LWE5ZWMtMzE4MTJhYjQwZTM3IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Qo2snvszM0ZptvUZiRHLSSO4nz1K0HwEkVPSMfl64bUpFF7dFqQatXHINmKGObf_HLuTviCYih0aDatO_ipy06Y4tSx-aQoewxxEkeGWRmVOlyiyrp9j-XJN3TfhF57Y_19HdtT3yLszqb0mJeIPLO66K0ls96aqjCfn6YfyylVsBiWomsvHUxklb_mZZG8pJiQ82iyMA9KVgkGo68ujHKEGB8BLP7kfxEgM45fP2DCeuElpkQXJGWVhoQITnrDPYnX1L5RBBl1Sy_HFgupsV5mv6e-qEj8poRZxLJqEYv3n762T5wWyc230vjqeenX7NuDmygQK97M3dJdqg3rVQA, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641905969, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=172.29.0.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.29.0.1, http-session-id=5AF7AF13AD6EF0D789BC055719177349, http-session-last-accessed-time=1641905679349, kc-category-name=ACCESS, kc-iat=1641905669, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.29.0.1:65230 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 12:54:39.379  INFO 14 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 12:54:39.386  INFO 14 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1ee506d7
2022-01-11 12:54:39.399  INFO 14 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1ee506d7
2022-01-11 12:54:39.461  INFO 14 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1ee506d7
2022-01-11 12:54:39.464  INFO 14 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1ee506d7
2022-01-11 12:54:39.496  INFO 14 --- [https-jsse-nio-7071-exec-7] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-4858967344575-564886, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:b90c11d7-db11-4fad-aaae-8c841010ad99:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=b90c11d7-db11-4fad-aaae-8c841010ad99, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time before Shift end, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-11 12:54:39.504  INFO 14 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=866d6a2a-9a22-4995-9536-ca6709739ed8, content=DENY, timestamp=1641905679502, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:b90c11d7-db11-4fad-aaae-8c841010ad99:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=b90c11d7-db11-4fad-aaae-8c841010ad99, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time before Shift end, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-11 12:54:39.508  INFO 14 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=118ms, Total=138ms
2022-01-11 12:54:39.559  INFO 14 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=60e86208-50ff-4e0a-b27d-d10f6c524d08, content=null, timestamp=1641905679536, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=65232, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=eb230e1d0f5c, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.29.0.1, kc-session-state=5479e8ce-ab30-4375-a9ec-31812ab40e37, http-req-server-port=80, http-header-accept=*/*, kc-id=3f3eb186-3198-4309-999b-06de29e30711, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641905679535, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd1/MXNxAH4AEQAAAABh3X4FdAAkM2YzZWIxODYtMzE5OC00MzA5LTk5OWItMDZkZTI5ZTMwNzExdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkNTQ3OWU4Y2UtYWIzMC00Mzc1LWE5ZWMtMzE4MTJhYjQwZTM3cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJIWlNtUmxVS3VKU2sxNUJ6ZEt5UGdzcW90aHA1ZEtYRlVDZmluNi1qVDlNIn0.eyJleHAiOjE2NDE5MDU5NjksImlhdCI6MTY0MTkwNTY2OSwianRpIjoiM2YzZWIxODYtMzE5OC00MzA5LTk5OWItMDZkZTI5ZTMwNzExIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiNTQ3OWU4Y2UtYWIzMC00Mzc1LWE5ZWMtMzE4MTJhYjQwZTM3IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Qo2snvszM0ZptvUZiRHLSSO4nz1K0HwEkVPSMfl64bUpFF7dFqQatXHINmKGObf_HLuTviCYih0aDatO_ipy06Y4tSx-aQoewxxEkeGWRmVOlyiyrp9j-XJN3TfhF57Y_19HdtT3yLszqb0mJeIPLO66K0ls96aqjCfn6YfyylVsBiWomsvHUxklb_mZZG8pJiQ82iyMA9KVgkGo68ujHKEGB8BLP7kfxEgM45fP2DCeuElpkQXJGWVhoQITnrDPYnX1L5RBBl1Sy_HFgupsV5mv6e-qEj8poRZxLJqEYv3n762T5wWyc230vjqeenX7NuDmygQK97M3dJdqg3rVQA, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641905969, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=172.29.0.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.29.0.1, http-session-id=067D8FF1CC5D75990CAFA5DC6EE2841C, http-session-last-accessed-time=1641905679535, kc-category-name=ACCESS, kc-iat=1641905669, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.29.0.1:65232 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 12:54:39.563  INFO 14 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 12:54:39.576  INFO 14 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@60f32c0a
2022-01-11 12:54:39.580  INFO 14 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@60f32c0a
2022-01-11 12:54:39.620  INFO 14 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@60f32c0a
2022-01-11 12:54:39.624  INFO 14 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@60f32c0a
2022-01-11 12:54:39.703  INFO 14 --- [https-jsse-nio-7071-exec-8] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-4859150182275-225572, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:b90c11d7-db11-4fad-aaae-8c841010ad99:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=b90c11d7-db11-4fad-aaae-8c841010ad99, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time before Shift end, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-11 12:54:39.706  INFO 14 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=60e86208-50ff-4e0a-b27d-d10f6c524d08, content=DENY, timestamp=1641905679706, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:b90c11d7-db11-4fad-aaae-8c841010ad99:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=b90c11d7-db11-4fad-aaae-8c841010ad99, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time before Shift end, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-11 12:54:39.715  INFO 14 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=139ms, Total=162ms
2022-01-11 12:54:39.763  INFO 14 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=fd0d5c6b-9b0e-4b7e-a0f1-bc78506b3ae7, content=null, timestamp=1641905679754, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=65234, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=eb230e1d0f5c, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.29.0.1, kc-session-state=5479e8ce-ab30-4375-a9ec-31812ab40e37, http-req-server-port=80, http-header-accept=*/*, kc-id=3f3eb186-3198-4309-999b-06de29e30711, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641905679749, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd1/MXNxAH4AEQAAAABh3X4FdAAkM2YzZWIxODYtMzE5OC00MzA5LTk5OWItMDZkZTI5ZTMwNzExdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkNTQ3OWU4Y2UtYWIzMC00Mzc1LWE5ZWMtMzE4MTJhYjQwZTM3cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJIWlNtUmxVS3VKU2sxNUJ6ZEt5UGdzcW90aHA1ZEtYRlVDZmluNi1qVDlNIn0.eyJleHAiOjE2NDE5MDU5NjksImlhdCI6MTY0MTkwNTY2OSwianRpIjoiM2YzZWIxODYtMzE5OC00MzA5LTk5OWItMDZkZTI5ZTMwNzExIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiNTQ3OWU4Y2UtYWIzMC00Mzc1LWE5ZWMtMzE4MTJhYjQwZTM3IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Qo2snvszM0ZptvUZiRHLSSO4nz1K0HwEkVPSMfl64bUpFF7dFqQatXHINmKGObf_HLuTviCYih0aDatO_ipy06Y4tSx-aQoewxxEkeGWRmVOlyiyrp9j-XJN3TfhF57Y_19HdtT3yLszqb0mJeIPLO66K0ls96aqjCfn6YfyylVsBiWomsvHUxklb_mZZG8pJiQ82iyMA9KVgkGo68ujHKEGB8BLP7kfxEgM45fP2DCeuElpkQXJGWVhoQITnrDPYnX1L5RBBl1Sy_HFgupsV5mv6e-qEj8poRZxLJqEYv3n762T5wWyc230vjqeenX7NuDmygQK97M3dJdqg3rVQA, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641905969, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=172.29.0.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.29.0.1, http-session-id=CD0C7BE438A79594CD4798460FE6E391, http-session-last-accessed-time=1641905679749, kc-category-name=ACCESS, kc-iat=1641905669, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.29.0.1:65234 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 12:54:39.770  INFO 14 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 12:54:39.779  INFO 14 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@12050a13
2022-01-11 12:54:39.785  INFO 14 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@12050a13
2022-01-11 12:54:39.839  INFO 14 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@12050a13
2022-01-11 12:54:39.844  INFO 14 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@12050a13
2022-01-11 12:54:39.892  INFO 14 --- [https-jsse-nio-7071-exec-9] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-4859358081075-913935, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:b90c11d7-db11-4fad-aaae-8c841010ad99:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=b90c11d7-db11-4fad-aaae-8c841010ad99, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time before Shift end, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-11 12:54:39.895  INFO 14 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=fd0d5c6b-9b0e-4b7e-a0f1-bc78506b3ae7, content=DENY, timestamp=1641905679895, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:b90c11d7-db11-4fad-aaae-8c841010ad99:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=b90c11d7-db11-4fad-aaae-8c841010ad99, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time before Shift end, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-11 12:54:39.904  INFO 14 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=120ms, Total=142ms
2022-01-11 12:54:39.950  INFO 14 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=f4b72509-ba23-43ed-b5ff-d1234f07bb5e, content=null, timestamp=1641905679941, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=65236, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=eb230e1d0f5c, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.29.0.1, kc-session-state=5479e8ce-ab30-4375-a9ec-31812ab40e37, http-req-server-port=80, http-header-accept=*/*, kc-id=3f3eb186-3198-4309-999b-06de29e30711, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641905679937, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd1/MXNxAH4AEQAAAABh3X4FdAAkM2YzZWIxODYtMzE5OC00MzA5LTk5OWItMDZkZTI5ZTMwNzExdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkNTQ3OWU4Y2UtYWIzMC00Mzc1LWE5ZWMtMzE4MTJhYjQwZTM3cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJIWlNtUmxVS3VKU2sxNUJ6ZEt5UGdzcW90aHA1ZEtYRlVDZmluNi1qVDlNIn0.eyJleHAiOjE2NDE5MDU5NjksImlhdCI6MTY0MTkwNTY2OSwianRpIjoiM2YzZWIxODYtMzE5OC00MzA5LTk5OWItMDZkZTI5ZTMwNzExIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiNTQ3OWU4Y2UtYWIzMC00Mzc1LWE5ZWMtMzE4MTJhYjQwZTM3IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Qo2snvszM0ZptvUZiRHLSSO4nz1K0HwEkVPSMfl64bUpFF7dFqQatXHINmKGObf_HLuTviCYih0aDatO_ipy06Y4tSx-aQoewxxEkeGWRmVOlyiyrp9j-XJN3TfhF57Y_19HdtT3yLszqb0mJeIPLO66K0ls96aqjCfn6YfyylVsBiWomsvHUxklb_mZZG8pJiQ82iyMA9KVgkGo68ujHKEGB8BLP7kfxEgM45fP2DCeuElpkQXJGWVhoQITnrDPYnX1L5RBBl1Sy_HFgupsV5mv6e-qEj8poRZxLJqEYv3n762T5wWyc230vjqeenX7NuDmygQK97M3dJdqg3rVQA, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641905969, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=172.29.0.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.29.0.1, http-session-id=5A1A692C6C0DB95CC6C0D5406D66B4C1, http-session-last-accessed-time=1641905679937, kc-category-name=ACCESS, kc-iat=1641905669, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.29.0.1:65236 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 12:54:39.955  INFO 14 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 12:54:39.962  INFO 14 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@262ee776
2022-01-11 12:54:39.966  INFO 14 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@262ee776
2022-01-11 12:54:40.031  INFO 14 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@262ee776
2022-01-11 12:54:40.034  INFO 14 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@262ee776
2022-01-11 12:54:40.079  INFO 14 --- [https-jsse-nio-7071-exec-10] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-4859541613075-590645, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:b90c11d7-db11-4fad-aaae-8c841010ad99:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=b90c11d7-db11-4fad-aaae-8c841010ad99, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time before Shift end, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-11 12:54:40.087  INFO 14 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=f4b72509-ba23-43ed-b5ff-d1234f07bb5e, content=DENY, timestamp=1641905680087, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:b90c11d7-db11-4fad-aaae-8c841010ad99:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=b90c11d7-db11-4fad-aaae-8c841010ad99, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time before Shift end, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-11 12:54:40.093  INFO 14 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=129ms, Total=145ms
2022-01-11 12:54:40.169  INFO 14 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=fd26865a-4d4c-43f5-a733-b03b9a7f552d, content=null, timestamp=1641905680158, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=65238, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=eb230e1d0f5c, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.29.0.1, kc-session-state=5479e8ce-ab30-4375-a9ec-31812ab40e37, http-req-server-port=80, http-header-accept=*/*, kc-id=3f3eb186-3198-4309-999b-06de29e30711, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641905680156, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd1/MXNxAH4AEQAAAABh3X4FdAAkM2YzZWIxODYtMzE5OC00MzA5LTk5OWItMDZkZTI5ZTMwNzExdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkNTQ3OWU4Y2UtYWIzMC00Mzc1LWE5ZWMtMzE4MTJhYjQwZTM3cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJIWlNtUmxVS3VKU2sxNUJ6ZEt5UGdzcW90aHA1ZEtYRlVDZmluNi1qVDlNIn0.eyJleHAiOjE2NDE5MDU5NjksImlhdCI6MTY0MTkwNTY2OSwianRpIjoiM2YzZWIxODYtMzE5OC00MzA5LTk5OWItMDZkZTI5ZTMwNzExIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiNTQ3OWU4Y2UtYWIzMC00Mzc1LWE5ZWMtMzE4MTJhYjQwZTM3IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Qo2snvszM0ZptvUZiRHLSSO4nz1K0HwEkVPSMfl64bUpFF7dFqQatXHINmKGObf_HLuTviCYih0aDatO_ipy06Y4tSx-aQoewxxEkeGWRmVOlyiyrp9j-XJN3TfhF57Y_19HdtT3yLszqb0mJeIPLO66K0ls96aqjCfn6YfyylVsBiWomsvHUxklb_mZZG8pJiQ82iyMA9KVgkGo68ujHKEGB8BLP7kfxEgM45fP2DCeuElpkQXJGWVhoQITnrDPYnX1L5RBBl1Sy_HFgupsV5mv6e-qEj8poRZxLJqEYv3n762T5wWyc230vjqeenX7NuDmygQK97M3dJdqg3rVQA, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641905969, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=172.29.0.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.29.0.1, http-session-id=75376B8EDB079BA5C70B52C4A6C688A7, http-session-last-accessed-time=1641905680156, kc-category-name=ACCESS, kc-iat=1641905669, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.29.0.1:65238 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 12:54:40.193  INFO 14 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 12:54:40.205  INFO 14 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@57a9c21d
2022-01-11 12:54:40.209  INFO 14 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@57a9c21d
2022-01-11 12:54:40.263  INFO 14 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@57a9c21d
2022-01-11 12:54:40.269  INFO 14 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@57a9c21d
2022-01-11 12:54:40.355  INFO 14 --- [https-jsse-nio-7071-exec-1] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-4859782745875-694166, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:b90c11d7-db11-4fad-aaae-8c841010ad99:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=b90c11d7-db11-4fad-aaae-8c841010ad99, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time before Shift end, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-11 12:54:40.358  INFO 14 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=fd26865a-4d4c-43f5-a733-b03b9a7f552d, content=DENY, timestamp=1641905680358, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:b90c11d7-db11-4fad-aaae-8c841010ad99:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=b90c11d7-db11-4fad-aaae-8c841010ad99, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time before Shift end, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-11 12:54:40.364  INFO 14 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=159ms, Total=198ms
2022-01-11 12:54:40.422  INFO 14 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=5a4c0408-241e-4541-b329-04748101d456, content=null, timestamp=1641905680401, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=65240, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=eb230e1d0f5c, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.29.0.1, kc-session-state=5479e8ce-ab30-4375-a9ec-31812ab40e37, http-req-server-port=80, http-header-accept=*/*, kc-id=3f3eb186-3198-4309-999b-06de29e30711, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641905680399, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd1/MXNxAH4AEQAAAABh3X4FdAAkM2YzZWIxODYtMzE5OC00MzA5LTk5OWItMDZkZTI5ZTMwNzExdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkNTQ3OWU4Y2UtYWIzMC00Mzc1LWE5ZWMtMzE4MTJhYjQwZTM3cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJIWlNtUmxVS3VKU2sxNUJ6ZEt5UGdzcW90aHA1ZEtYRlVDZmluNi1qVDlNIn0.eyJleHAiOjE2NDE5MDU5NjksImlhdCI6MTY0MTkwNTY2OSwianRpIjoiM2YzZWIxODYtMzE5OC00MzA5LTk5OWItMDZkZTI5ZTMwNzExIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiNTQ3OWU4Y2UtYWIzMC00Mzc1LWE5ZWMtMzE4MTJhYjQwZTM3IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Qo2snvszM0ZptvUZiRHLSSO4nz1K0HwEkVPSMfl64bUpFF7dFqQatXHINmKGObf_HLuTviCYih0aDatO_ipy06Y4tSx-aQoewxxEkeGWRmVOlyiyrp9j-XJN3TfhF57Y_19HdtT3yLszqb0mJeIPLO66K0ls96aqjCfn6YfyylVsBiWomsvHUxklb_mZZG8pJiQ82iyMA9KVgkGo68ujHKEGB8BLP7kfxEgM45fP2DCeuElpkQXJGWVhoQITnrDPYnX1L5RBBl1Sy_HFgupsV5mv6e-qEj8poRZxLJqEYv3n762T5wWyc230vjqeenX7NuDmygQK97M3dJdqg3rVQA, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641905969, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=172.29.0.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.29.0.1, http-session-id=29D357F20063DB1EE9F559CEF12814E3, http-session-last-accessed-time=1641905680399, kc-category-name=ACCESS, kc-iat=1641905669, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.29.0.1:65240 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 12:54:40.428  INFO 14 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 12:54:40.437  INFO 14 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@30dfe99d
2022-01-11 12:54:40.444  INFO 14 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@30dfe99d
2022-01-11 12:54:40.482  INFO 14 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@30dfe99d
2022-01-11 12:54:40.493  INFO 14 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@30dfe99d
2022-01-11 12:54:40.528  INFO 14 --- [https-jsse-nio-7071-exec-2] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-4860015588675-970872, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:b90c11d7-db11-4fad-aaae-8c841010ad99:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=b90c11d7-db11-4fad-aaae-8c841010ad99, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time before Shift end, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-11 12:54:40.534  INFO 14 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=5a4c0408-241e-4541-b329-04748101d456, content=DENY, timestamp=1641905680534, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:b90c11d7-db11-4fad-aaae-8c841010ad99:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=b90c11d7-db11-4fad-aaae-8c841010ad99, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time before Shift end, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-11 12:54:40.539  INFO 14 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=101ms, Total=118ms
2022-01-11 12:54:40.590  INFO 14 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=bf7a017c-3764-4aae-aa5e-47e87999cb7b, content=null, timestamp=1641905680577, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=65242, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=eb230e1d0f5c, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.29.0.1, kc-session-state=5479e8ce-ab30-4375-a9ec-31812ab40e37, http-req-server-port=80, http-header-accept=*/*, kc-id=3f3eb186-3198-4309-999b-06de29e30711, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641905680575, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd1/MXNxAH4AEQAAAABh3X4FdAAkM2YzZWIxODYtMzE5OC00MzA5LTk5OWItMDZkZTI5ZTMwNzExdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkNTQ3OWU4Y2UtYWIzMC00Mzc1LWE5ZWMtMzE4MTJhYjQwZTM3cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJIWlNtUmxVS3VKU2sxNUJ6ZEt5UGdzcW90aHA1ZEtYRlVDZmluNi1qVDlNIn0.eyJleHAiOjE2NDE5MDU5NjksImlhdCI6MTY0MTkwNTY2OSwianRpIjoiM2YzZWIxODYtMzE5OC00MzA5LTk5OWItMDZkZTI5ZTMwNzExIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiNTQ3OWU4Y2UtYWIzMC00Mzc1LWE5ZWMtMzE4MTJhYjQwZTM3IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Qo2snvszM0ZptvUZiRHLSSO4nz1K0HwEkVPSMfl64bUpFF7dFqQatXHINmKGObf_HLuTviCYih0aDatO_ipy06Y4tSx-aQoewxxEkeGWRmVOlyiyrp9j-XJN3TfhF57Y_19HdtT3yLszqb0mJeIPLO66K0ls96aqjCfn6YfyylVsBiWomsvHUxklb_mZZG8pJiQ82iyMA9KVgkGo68ujHKEGB8BLP7kfxEgM45fP2DCeuElpkQXJGWVhoQITnrDPYnX1L5RBBl1Sy_HFgupsV5mv6e-qEj8poRZxLJqEYv3n762T5wWyc230vjqeenX7NuDmygQK97M3dJdqg3rVQA, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641905969, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=172.29.0.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.29.0.1, http-session-id=1C19F695AA41635DB0E981901B2D1BE8, http-session-last-accessed-time=1641905680575, kc-category-name=ACCESS, kc-iat=1641905669, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.29.0.1:65242 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 12:54:40.598  INFO 14 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 12:54:40.602  INFO 14 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1c8905a0
2022-01-11 12:54:40.605  INFO 14 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1c8905a0
2022-01-11 12:54:40.634  INFO 14 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1c8905a0
2022-01-11 12:54:40.637  INFO 14 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1c8905a0
2022-01-11 12:54:40.712  INFO 14 --- [https-jsse-nio-7071-exec-3] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-4860183870075-338457, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:b90c11d7-db11-4fad-aaae-8c841010ad99:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=b90c11d7-db11-4fad-aaae-8c841010ad99, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time before Shift end, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-11 12:54:40.715  INFO 14 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=bf7a017c-3764-4aae-aa5e-47e87999cb7b, content=DENY, timestamp=1641905680715, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:b90c11d7-db11-4fad-aaae-8c841010ad99:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=b90c11d7-db11-4fad-aaae-8c841010ad99, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time before Shift end, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-11 12:54:40.718  INFO 14 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=114ms, Total=135ms
2022-01-11 12:54:40.836  INFO 14 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=4bcef46d-4eef-49ad-9bf4-203ce0e0b2eb, content=null, timestamp=1641905680801, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=65244, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=eb230e1d0f5c, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.29.0.1, kc-session-state=5479e8ce-ab30-4375-a9ec-31812ab40e37, http-req-server-port=80, http-header-accept=*/*, kc-id=3f3eb186-3198-4309-999b-06de29e30711, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641905680775, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd1/MXNxAH4AEQAAAABh3X4FdAAkM2YzZWIxODYtMzE5OC00MzA5LTk5OWItMDZkZTI5ZTMwNzExdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkNTQ3OWU4Y2UtYWIzMC00Mzc1LWE5ZWMtMzE4MTJhYjQwZTM3cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJIWlNtUmxVS3VKU2sxNUJ6ZEt5UGdzcW90aHA1ZEtYRlVDZmluNi1qVDlNIn0.eyJleHAiOjE2NDE5MDU5NjksImlhdCI6MTY0MTkwNTY2OSwianRpIjoiM2YzZWIxODYtMzE5OC00MzA5LTk5OWItMDZkZTI5ZTMwNzExIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiNTQ3OWU4Y2UtYWIzMC00Mzc1LWE5ZWMtMzE4MTJhYjQwZTM3IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Qo2snvszM0ZptvUZiRHLSSO4nz1K0HwEkVPSMfl64bUpFF7dFqQatXHINmKGObf_HLuTviCYih0aDatO_ipy06Y4tSx-aQoewxxEkeGWRmVOlyiyrp9j-XJN3TfhF57Y_19HdtT3yLszqb0mJeIPLO66K0ls96aqjCfn6YfyylVsBiWomsvHUxklb_mZZG8pJiQ82iyMA9KVgkGo68ujHKEGB8BLP7kfxEgM45fP2DCeuElpkQXJGWVhoQITnrDPYnX1L5RBBl1Sy_HFgupsV5mv6e-qEj8poRZxLJqEYv3n762T5wWyc230vjqeenX7NuDmygQK97M3dJdqg3rVQA, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641905969, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=172.29.0.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.29.0.1, http-session-id=B335D1C6F5FCB73A14EFD783ECF2539B, http-session-last-accessed-time=1641905680775, kc-category-name=ACCESS, kc-iat=1641905669, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.29.0.1:65244 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 12:54:40.848  INFO 14 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 12:54:40.855  INFO 14 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@609f8914
2022-01-11 12:54:40.860  INFO 14 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@609f8914
2022-01-11 12:54:40.907  INFO 14 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@609f8914
2022-01-11 12:54:40.910  INFO 14 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@609f8914
2022-01-11 12:54:40.950  INFO 14 --- [https-jsse-nio-7071-exec-4] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-4860437226675-672831, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:b90c11d7-db11-4fad-aaae-8c841010ad99:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=b90c11d7-db11-4fad-aaae-8c841010ad99, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time before Shift end, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-11 12:54:40.957  INFO 14 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=4bcef46d-4eef-49ad-9bf4-203ce0e0b2eb, content=DENY, timestamp=1641905680957, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:b90c11d7-db11-4fad-aaae-8c841010ad99:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=b90c11d7-db11-4fad-aaae-8c841010ad99, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time before Shift end, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-11 12:54:40.963  INFO 14 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=103ms, Total=153ms
2022-01-11 12:54:41.041  INFO 14 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=3896a068-8ae0-407f-953e-f52c4032510e, content=null, timestamp=1641905681017, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=65246, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=eb230e1d0f5c, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.29.0.1, kc-session-state=5479e8ce-ab30-4375-a9ec-31812ab40e37, http-req-server-port=80, http-header-accept=*/*, kc-id=3f3eb186-3198-4309-999b-06de29e30711, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641905681015, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd1/MXNxAH4AEQAAAABh3X4FdAAkM2YzZWIxODYtMzE5OC00MzA5LTk5OWItMDZkZTI5ZTMwNzExdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkNTQ3OWU4Y2UtYWIzMC00Mzc1LWE5ZWMtMzE4MTJhYjQwZTM3cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJIWlNtUmxVS3VKU2sxNUJ6ZEt5UGdzcW90aHA1ZEtYRlVDZmluNi1qVDlNIn0.eyJleHAiOjE2NDE5MDU5NjksImlhdCI6MTY0MTkwNTY2OSwianRpIjoiM2YzZWIxODYtMzE5OC00MzA5LTk5OWItMDZkZTI5ZTMwNzExIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiNTQ3OWU4Y2UtYWIzMC00Mzc1LWE5ZWMtMzE4MTJhYjQwZTM3IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Qo2snvszM0ZptvUZiRHLSSO4nz1K0HwEkVPSMfl64bUpFF7dFqQatXHINmKGObf_HLuTviCYih0aDatO_ipy06Y4tSx-aQoewxxEkeGWRmVOlyiyrp9j-XJN3TfhF57Y_19HdtT3yLszqb0mJeIPLO66K0ls96aqjCfn6YfyylVsBiWomsvHUxklb_mZZG8pJiQ82iyMA9KVgkGo68ujHKEGB8BLP7kfxEgM45fP2DCeuElpkQXJGWVhoQITnrDPYnX1L5RBBl1Sy_HFgupsV5mv6e-qEj8poRZxLJqEYv3n762T5wWyc230vjqeenX7NuDmygQK97M3dJdqg3rVQA, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641905969, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=172.29.0.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.29.0.1, http-session-id=6E3E6A4D82DCDB5C8EE314794D5A1108, http-session-last-accessed-time=1641905681015, kc-category-name=ACCESS, kc-iat=1641905669, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.29.0.1:65246 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 12:54:41.049  INFO 14 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 12:54:41.054  INFO 14 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@55dc1839
2022-01-11 12:54:41.062  INFO 14 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@55dc1839
2022-01-11 12:54:41.093  INFO 14 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@55dc1839
2022-01-11 12:54:41.096  INFO 14 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@55dc1839
2022-01-11 12:54:41.134  INFO 14 --- [https-jsse-nio-7071-exec-5] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-4860634726175-409127, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:b90c11d7-db11-4fad-aaae-8c841010ad99:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=b90c11d7-db11-4fad-aaae-8c841010ad99, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time before Shift end, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-11 12:54:41.137  INFO 14 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=3896a068-8ae0-407f-953e-f52c4032510e, content=DENY, timestamp=1641905681137, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:b90c11d7-db11-4fad-aaae-8c841010ad99:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=b90c11d7-db11-4fad-aaae-8c841010ad99, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time before Shift end, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-11 12:54:41.140  INFO 14 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=86ms, Total=105ms
2022-01-11 12:54:41.183  INFO 14 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=4271dfa7-47ed-42c1-a00f-1cf516bfa0c5, content=null, timestamp=1641905681174, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=65248, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=eb230e1d0f5c, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.29.0.1, kc-session-state=5479e8ce-ab30-4375-a9ec-31812ab40e37, http-req-server-port=80, http-header-accept=*/*, kc-id=3f3eb186-3198-4309-999b-06de29e30711, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641905681172, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd1/MXNxAH4AEQAAAABh3X4FdAAkM2YzZWIxODYtMzE5OC00MzA5LTk5OWItMDZkZTI5ZTMwNzExdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkNTQ3OWU4Y2UtYWIzMC00Mzc1LWE5ZWMtMzE4MTJhYjQwZTM3cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJIWlNtUmxVS3VKU2sxNUJ6ZEt5UGdzcW90aHA1ZEtYRlVDZmluNi1qVDlNIn0.eyJleHAiOjE2NDE5MDU5NjksImlhdCI6MTY0MTkwNTY2OSwianRpIjoiM2YzZWIxODYtMzE5OC00MzA5LTk5OWItMDZkZTI5ZTMwNzExIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiNTQ3OWU4Y2UtYWIzMC00Mzc1LWE5ZWMtMzE4MTJhYjQwZTM3IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Qo2snvszM0ZptvUZiRHLSSO4nz1K0HwEkVPSMfl64bUpFF7dFqQatXHINmKGObf_HLuTviCYih0aDatO_ipy06Y4tSx-aQoewxxEkeGWRmVOlyiyrp9j-XJN3TfhF57Y_19HdtT3yLszqb0mJeIPLO66K0ls96aqjCfn6YfyylVsBiWomsvHUxklb_mZZG8pJiQ82iyMA9KVgkGo68ujHKEGB8BLP7kfxEgM45fP2DCeuElpkQXJGWVhoQITnrDPYnX1L5RBBl1Sy_HFgupsV5mv6e-qEj8poRZxLJqEYv3n762T5wWyc230vjqeenX7NuDmygQK97M3dJdqg3rVQA, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641905969, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=172.29.0.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.29.0.1, http-session-id=946BA00F98177CCA8641C3D46DE853A1, http-session-last-accessed-time=1641905681172, kc-category-name=ACCESS, kc-iat=1641905669, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.29.0.1:65248 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 12:54:41.189  INFO 14 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 12:54:41.192  INFO 14 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7d120148
2022-01-11 12:54:41.194  INFO 14 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7d120148
2022-01-11 12:54:41.271  INFO 14 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7d120148
2022-01-11 12:54:41.274  INFO 14 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7d120148
2022-01-11 12:54:41.344  INFO 14 --- [https-jsse-nio-7071-exec-6] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-4860773791175-800015, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:b90c11d7-db11-4fad-aaae-8c841010ad99:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=b90c11d7-db11-4fad-aaae-8c841010ad99, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time before Shift end, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-11 12:54:41.348  INFO 14 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=4271dfa7-47ed-42c1-a00f-1cf516bfa0c5, content=DENY, timestamp=1641905681348, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:b90c11d7-db11-4fad-aaae-8c841010ad99:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=b90c11d7-db11-4fad-aaae-8c841010ad99, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time before Shift end, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-11 12:54:41.352  INFO 14 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=157ms, Total=170ms
2022-01-11 12:54:41.432  INFO 14 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=9a3ce0fe-f6f5-42e4-923b-b1bbc5ba08bc, content=null, timestamp=1641905681414, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=65250, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=eb230e1d0f5c, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.29.0.1, kc-session-state=5479e8ce-ab30-4375-a9ec-31812ab40e37, http-req-server-port=80, http-header-accept=*/*, kc-id=3f3eb186-3198-4309-999b-06de29e30711, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641905681412, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd1/MXNxAH4AEQAAAABh3X4FdAAkM2YzZWIxODYtMzE5OC00MzA5LTk5OWItMDZkZTI5ZTMwNzExdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkNTQ3OWU4Y2UtYWIzMC00Mzc1LWE5ZWMtMzE4MTJhYjQwZTM3cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJIWlNtUmxVS3VKU2sxNUJ6ZEt5UGdzcW90aHA1ZEtYRlVDZmluNi1qVDlNIn0.eyJleHAiOjE2NDE5MDU5NjksImlhdCI6MTY0MTkwNTY2OSwianRpIjoiM2YzZWIxODYtMzE5OC00MzA5LTk5OWItMDZkZTI5ZTMwNzExIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiNTQ3OWU4Y2UtYWIzMC00Mzc1LWE5ZWMtMzE4MTJhYjQwZTM3IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Qo2snvszM0ZptvUZiRHLSSO4nz1K0HwEkVPSMfl64bUpFF7dFqQatXHINmKGObf_HLuTviCYih0aDatO_ipy06Y4tSx-aQoewxxEkeGWRmVOlyiyrp9j-XJN3TfhF57Y_19HdtT3yLszqb0mJeIPLO66K0ls96aqjCfn6YfyylVsBiWomsvHUxklb_mZZG8pJiQ82iyMA9KVgkGo68ujHKEGB8BLP7kfxEgM45fP2DCeuElpkQXJGWVhoQITnrDPYnX1L5RBBl1Sy_HFgupsV5mv6e-qEj8poRZxLJqEYv3n762T5wWyc230vjqeenX7NuDmygQK97M3dJdqg3rVQA, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641905969, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=172.29.0.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.29.0.1, http-session-id=BE8772E32DCA1727BF5C4E60D731C8F4, http-session-last-accessed-time=1641905681412, kc-category-name=ACCESS, kc-iat=1641905669, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.29.0.1:65250 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 12:54:41.441  INFO 14 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 12:54:41.455  INFO 14 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5f6251d9
2022-01-11 12:54:41.459  INFO 14 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5f6251d9
2022-01-11 12:54:41.510  INFO 14 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5f6251d9
2022-01-11 12:54:41.513  INFO 14 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5f6251d9
2022-01-11 12:54:41.539  INFO 14 --- [https-jsse-nio-7071-exec-7] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-4861027266475-687754, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:b90c11d7-db11-4fad-aaae-8c841010ad99:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=b90c11d7-db11-4fad-aaae-8c841010ad99, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time before Shift end, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-11 12:54:41.542  INFO 14 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=9a3ce0fe-f6f5-42e4-923b-b1bbc5ba08bc, content=DENY, timestamp=1641905681542, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:b90c11d7-db11-4fad-aaae-8c841010ad99:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=b90c11d7-db11-4fad-aaae-8c841010ad99, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time before Shift end, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-11 12:54:41.554  INFO 14 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=98ms, Total=127ms
2022-01-11 12:54:41.601  INFO 14 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=e66d9d00-cfcc-44df-84ea-b04054b45b83, content=null, timestamp=1641905681590, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=65252, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=eb230e1d0f5c, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.29.0.1, kc-session-state=5479e8ce-ab30-4375-a9ec-31812ab40e37, http-req-server-port=80, http-header-accept=*/*, kc-id=3f3eb186-3198-4309-999b-06de29e30711, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641905681588, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd1/MXNxAH4AEQAAAABh3X4FdAAkM2YzZWIxODYtMzE5OC00MzA5LTk5OWItMDZkZTI5ZTMwNzExdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkNTQ3OWU4Y2UtYWIzMC00Mzc1LWE5ZWMtMzE4MTJhYjQwZTM3cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJIWlNtUmxVS3VKU2sxNUJ6ZEt5UGdzcW90aHA1ZEtYRlVDZmluNi1qVDlNIn0.eyJleHAiOjE2NDE5MDU5NjksImlhdCI6MTY0MTkwNTY2OSwianRpIjoiM2YzZWIxODYtMzE5OC00MzA5LTk5OWItMDZkZTI5ZTMwNzExIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiNTQ3OWU4Y2UtYWIzMC00Mzc1LWE5ZWMtMzE4MTJhYjQwZTM3IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Qo2snvszM0ZptvUZiRHLSSO4nz1K0HwEkVPSMfl64bUpFF7dFqQatXHINmKGObf_HLuTviCYih0aDatO_ipy06Y4tSx-aQoewxxEkeGWRmVOlyiyrp9j-XJN3TfhF57Y_19HdtT3yLszqb0mJeIPLO66K0ls96aqjCfn6YfyylVsBiWomsvHUxklb_mZZG8pJiQ82iyMA9KVgkGo68ujHKEGB8BLP7kfxEgM45fP2DCeuElpkQXJGWVhoQITnrDPYnX1L5RBBl1Sy_HFgupsV5mv6e-qEj8poRZxLJqEYv3n762T5wWyc230vjqeenX7NuDmygQK97M3dJdqg3rVQA, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641905969, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=172.29.0.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.29.0.1, http-session-id=74487F8C3D7ED90ABEB4E46C4FF4C828, http-session-last-accessed-time=1641905681588, kc-category-name=ACCESS, kc-iat=1641905669, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.29.0.1:65252 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 12:54:41.610  INFO 14 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 12:54:41.619  INFO 14 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7526cb22
2022-01-11 12:54:41.622  INFO 14 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7526cb22
2022-01-11 12:54:41.655  INFO 14 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7526cb22
2022-01-11 12:54:41.660  INFO 14 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7526cb22
2022-01-11 12:54:41.740  INFO 14 --- [https-jsse-nio-7071-exec-8] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-4861197087675-184243, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:b90c11d7-db11-4fad-aaae-8c841010ad99:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=b90c11d7-db11-4fad-aaae-8c841010ad99, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time before Shift end, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-11 12:54:41.744  INFO 14 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=e66d9d00-cfcc-44df-84ea-b04054b45b83, content=DENY, timestamp=1641905681744, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:b90c11d7-db11-4fad-aaae-8c841010ad99:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=b90c11d7-db11-4fad-aaae-8c841010ad99, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time before Shift end, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-11 12:54:41.748  INFO 14 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=130ms, Total=149ms
2022-01-11 12:54:41.800  INFO 14 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=1ca76d35-b9b3-4b08-a042-a9497a583e9f, content=null, timestamp=1641905681789, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=65254, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=eb230e1d0f5c, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.29.0.1, kc-session-state=5479e8ce-ab30-4375-a9ec-31812ab40e37, http-req-server-port=80, http-header-accept=*/*, kc-id=3f3eb186-3198-4309-999b-06de29e30711, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641905681786, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd1/MXNxAH4AEQAAAABh3X4FdAAkM2YzZWIxODYtMzE5OC00MzA5LTk5OWItMDZkZTI5ZTMwNzExdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkNTQ3OWU4Y2UtYWIzMC00Mzc1LWE5ZWMtMzE4MTJhYjQwZTM3cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJIWlNtUmxVS3VKU2sxNUJ6ZEt5UGdzcW90aHA1ZEtYRlVDZmluNi1qVDlNIn0.eyJleHAiOjE2NDE5MDU5NjksImlhdCI6MTY0MTkwNTY2OSwianRpIjoiM2YzZWIxODYtMzE5OC00MzA5LTk5OWItMDZkZTI5ZTMwNzExIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiNTQ3OWU4Y2UtYWIzMC00Mzc1LWE5ZWMtMzE4MTJhYjQwZTM3IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Qo2snvszM0ZptvUZiRHLSSO4nz1K0HwEkVPSMfl64bUpFF7dFqQatXHINmKGObf_HLuTviCYih0aDatO_ipy06Y4tSx-aQoewxxEkeGWRmVOlyiyrp9j-XJN3TfhF57Y_19HdtT3yLszqb0mJeIPLO66K0ls96aqjCfn6YfyylVsBiWomsvHUxklb_mZZG8pJiQ82iyMA9KVgkGo68ujHKEGB8BLP7kfxEgM45fP2DCeuElpkQXJGWVhoQITnrDPYnX1L5RBBl1Sy_HFgupsV5mv6e-qEj8poRZxLJqEYv3n762T5wWyc230vjqeenX7NuDmygQK97M3dJdqg3rVQA, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641905969, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=172.29.0.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.29.0.1, http-session-id=CBF8573D13EE22E80B134C3C4B408C87, http-session-last-accessed-time=1641905681786, kc-category-name=ACCESS, kc-iat=1641905669, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.29.0.1:65254 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 12:54:41.805  INFO 14 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 12:54:41.813  INFO 14 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@18072456
2022-01-11 12:54:41.816  INFO 14 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@18072456
2022-01-11 12:54:41.853  INFO 14 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@18072456
2022-01-11 12:54:41.859  INFO 14 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@18072456
2022-01-11 12:54:41.897  INFO 14 --- [https-jsse-nio-7071-exec-9] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-4861392313475-873417, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:b90c11d7-db11-4fad-aaae-8c841010ad99:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=b90c11d7-db11-4fad-aaae-8c841010ad99, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time before Shift end, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-11 12:54:41.901  INFO 14 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=1ca76d35-b9b3-4b08-a042-a9497a583e9f, content=DENY, timestamp=1641905681901, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:b90c11d7-db11-4fad-aaae-8c841010ad99:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=b90c11d7-db11-4fad-aaae-8c841010ad99, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time before Shift end, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-11 12:54:41.910  INFO 14 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=92ms, Total=113ms
2022-01-11 12:54:41.967  INFO 14 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=f270f21d-aaef-4875-b056-b8810e4af034, content=null, timestamp=1641905681950, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=65256, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=eb230e1d0f5c, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.29.0.1, kc-session-state=5479e8ce-ab30-4375-a9ec-31812ab40e37, http-req-server-port=80, http-header-accept=*/*, kc-id=3f3eb186-3198-4309-999b-06de29e30711, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641905681947, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd1/MXNxAH4AEQAAAABh3X4FdAAkM2YzZWIxODYtMzE5OC00MzA5LTk5OWItMDZkZTI5ZTMwNzExdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkNTQ3OWU4Y2UtYWIzMC00Mzc1LWE5ZWMtMzE4MTJhYjQwZTM3cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJIWlNtUmxVS3VKU2sxNUJ6ZEt5UGdzcW90aHA1ZEtYRlVDZmluNi1qVDlNIn0.eyJleHAiOjE2NDE5MDU5NjksImlhdCI6MTY0MTkwNTY2OSwianRpIjoiM2YzZWIxODYtMzE5OC00MzA5LTk5OWItMDZkZTI5ZTMwNzExIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiNTQ3OWU4Y2UtYWIzMC00Mzc1LWE5ZWMtMzE4MTJhYjQwZTM3IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Qo2snvszM0ZptvUZiRHLSSO4nz1K0HwEkVPSMfl64bUpFF7dFqQatXHINmKGObf_HLuTviCYih0aDatO_ipy06Y4tSx-aQoewxxEkeGWRmVOlyiyrp9j-XJN3TfhF57Y_19HdtT3yLszqb0mJeIPLO66K0ls96aqjCfn6YfyylVsBiWomsvHUxklb_mZZG8pJiQ82iyMA9KVgkGo68ujHKEGB8BLP7kfxEgM45fP2DCeuElpkQXJGWVhoQITnrDPYnX1L5RBBl1Sy_HFgupsV5mv6e-qEj8poRZxLJqEYv3n762T5wWyc230vjqeenX7NuDmygQK97M3dJdqg3rVQA, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641905969, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=172.29.0.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.29.0.1, http-session-id=45E816B016A93F38C32CFFD575F8EEA0, http-session-last-accessed-time=1641905681947, kc-category-name=ACCESS, kc-iat=1641905669, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.29.0.1:65256 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 12:54:41.973  INFO 14 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 12:54:41.987  INFO 14 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@689137a5
2022-01-11 12:54:41.992  INFO 14 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@689137a5
2022-01-11 12:54:42.083  INFO 14 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@689137a5
2022-01-11 12:54:42.087  INFO 14 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@689137a5
2022-01-11 12:54:42.163  INFO 14 --- [https-jsse-nio-7071-exec-10] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-4861561018375-497589, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:b90c11d7-db11-4fad-aaae-8c841010ad99:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=b90c11d7-db11-4fad-aaae-8c841010ad99, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time before Shift end, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-11 12:54:42.166  INFO 14 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=f270f21d-aaef-4875-b056-b8810e4af034, content=DENY, timestamp=1641905682166, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:b90c11d7-db11-4fad-aaae-8c841010ad99:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=b90c11d7-db11-4fad-aaae-8c841010ad99, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time before Shift end, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-11 12:54:42.169  INFO 14 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=189ms, Total=206ms
2022-01-11 12:54:42.212  INFO 14 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=7f9f1a2b-3a04-49c2-970d-4139dbecfd74, content=null, timestamp=1641905682202, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=65258, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=eb230e1d0f5c, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.29.0.1, kc-session-state=5479e8ce-ab30-4375-a9ec-31812ab40e37, http-req-server-port=80, http-header-accept=*/*, kc-id=3f3eb186-3198-4309-999b-06de29e30711, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641905682198, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd1/MXNxAH4AEQAAAABh3X4FdAAkM2YzZWIxODYtMzE5OC00MzA5LTk5OWItMDZkZTI5ZTMwNzExdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkNTQ3OWU4Y2UtYWIzMC00Mzc1LWE5ZWMtMzE4MTJhYjQwZTM3cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJIWlNtUmxVS3VKU2sxNUJ6ZEt5UGdzcW90aHA1ZEtYRlVDZmluNi1qVDlNIn0.eyJleHAiOjE2NDE5MDU5NjksImlhdCI6MTY0MTkwNTY2OSwianRpIjoiM2YzZWIxODYtMzE5OC00MzA5LTk5OWItMDZkZTI5ZTMwNzExIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiNTQ3OWU4Y2UtYWIzMC00Mzc1LWE5ZWMtMzE4MTJhYjQwZTM3IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Qo2snvszM0ZptvUZiRHLSSO4nz1K0HwEkVPSMfl64bUpFF7dFqQatXHINmKGObf_HLuTviCYih0aDatO_ipy06Y4tSx-aQoewxxEkeGWRmVOlyiyrp9j-XJN3TfhF57Y_19HdtT3yLszqb0mJeIPLO66K0ls96aqjCfn6YfyylVsBiWomsvHUxklb_mZZG8pJiQ82iyMA9KVgkGo68ujHKEGB8BLP7kfxEgM45fP2DCeuElpkQXJGWVhoQITnrDPYnX1L5RBBl1Sy_HFgupsV5mv6e-qEj8poRZxLJqEYv3n762T5wWyc230vjqeenX7NuDmygQK97M3dJdqg3rVQA, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641905969, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=172.29.0.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.29.0.1, http-session-id=3FFE675A1FB0F248C9A985F489E8D5EE, http-session-last-accessed-time=1641905682198, kc-category-name=ACCESS, kc-iat=1641905669, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.29.0.1:65258 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 12:54:42.221  INFO 14 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 12:54:42.230  INFO 14 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3c4fb8ca
2022-01-11 12:54:42.234  INFO 14 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3c4fb8ca
2022-01-11 12:54:42.320  INFO 14 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3c4fb8ca
2022-01-11 12:54:42.325  INFO 14 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3c4fb8ca
2022-01-11 12:54:42.363  INFO 14 --- [https-jsse-nio-7071-exec-1] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-4861807533275-849816, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:b90c11d7-db11-4fad-aaae-8c841010ad99:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=b90c11d7-db11-4fad-aaae-8c841010ad99, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time before Shift end, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-11 12:54:42.366  INFO 14 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=7f9f1a2b-3a04-49c2-970d-4139dbecfd74, content=DENY, timestamp=1641905682366, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:b90c11d7-db11-4fad-aaae-8c841010ad99:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=b90c11d7-db11-4fad-aaae-8c841010ad99, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time before Shift end, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-11 12:54:42.376  INFO 14 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=142ms, Total=166ms
2022-01-11 12:54:42.432  INFO 14 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=4ce2cc1e-c18d-4742-9771-b47bd5a01471, content=null, timestamp=1641905682411, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=65260, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=eb230e1d0f5c, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.29.0.1, kc-session-state=5479e8ce-ab30-4375-a9ec-31812ab40e37, http-req-server-port=80, http-header-accept=*/*, kc-id=3f3eb186-3198-4309-999b-06de29e30711, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641905682409, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd1/MXNxAH4AEQAAAABh3X4FdAAkM2YzZWIxODYtMzE5OC00MzA5LTk5OWItMDZkZTI5ZTMwNzExdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkNTQ3OWU4Y2UtYWIzMC00Mzc1LWE5ZWMtMzE4MTJhYjQwZTM3cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJIWlNtUmxVS3VKU2sxNUJ6ZEt5UGdzcW90aHA1ZEtYRlVDZmluNi1qVDlNIn0.eyJleHAiOjE2NDE5MDU5NjksImlhdCI6MTY0MTkwNTY2OSwianRpIjoiM2YzZWIxODYtMzE5OC00MzA5LTk5OWItMDZkZTI5ZTMwNzExIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiNTQ3OWU4Y2UtYWIzMC00Mzc1LWE5ZWMtMzE4MTJhYjQwZTM3IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Qo2snvszM0ZptvUZiRHLSSO4nz1K0HwEkVPSMfl64bUpFF7dFqQatXHINmKGObf_HLuTviCYih0aDatO_ipy06Y4tSx-aQoewxxEkeGWRmVOlyiyrp9j-XJN3TfhF57Y_19HdtT3yLszqb0mJeIPLO66K0ls96aqjCfn6YfyylVsBiWomsvHUxklb_mZZG8pJiQ82iyMA9KVgkGo68ujHKEGB8BLP7kfxEgM45fP2DCeuElpkQXJGWVhoQITnrDPYnX1L5RBBl1Sy_HFgupsV5mv6e-qEj8poRZxLJqEYv3n762T5wWyc230vjqeenX7NuDmygQK97M3dJdqg3rVQA, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641905969, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=172.29.0.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.29.0.1, http-session-id=2E75750A29B8017817C42672925D653C, http-session-last-accessed-time=1641905682409, kc-category-name=ACCESS, kc-iat=1641905669, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.29.0.1:65260 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 12:54:42.440  INFO 14 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 12:54:42.448  INFO 14 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@227f7644
2022-01-11 12:54:42.452  INFO 14 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@227f7644
2022-01-11 12:54:42.488  INFO 14 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@227f7644
2022-01-11 12:54:42.497  INFO 14 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@227f7644
2022-01-11 12:54:42.555  INFO 14 --- [https-jsse-nio-7071-exec-2] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-4862028685975-650271, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:b90c11d7-db11-4fad-aaae-8c841010ad99:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=b90c11d7-db11-4fad-aaae-8c841010ad99, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time before Shift end, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-11 12:54:42.559  INFO 14 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=4ce2cc1e-c18d-4742-9771-b47bd5a01471, content=DENY, timestamp=1641905682559, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:b90c11d7-db11-4fad-aaae-8c841010ad99:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=b90c11d7-db11-4fad-aaae-8c841010ad99, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time before Shift end, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-11 12:54:42.562  INFO 14 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=114ms, Total=135ms
2022-01-11 12:54:42.621  INFO 14 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=f2845475-f2b2-4c51-a260-2e4b7d606dac, content=null, timestamp=1641905682606, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=65262, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=eb230e1d0f5c, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.29.0.1, kc-session-state=5479e8ce-ab30-4375-a9ec-31812ab40e37, http-req-server-port=80, http-header-accept=*/*, kc-id=3f3eb186-3198-4309-999b-06de29e30711, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641905682605, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd1/MXNxAH4AEQAAAABh3X4FdAAkM2YzZWIxODYtMzE5OC00MzA5LTk5OWItMDZkZTI5ZTMwNzExdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkNTQ3OWU4Y2UtYWIzMC00Mzc1LWE5ZWMtMzE4MTJhYjQwZTM3cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJIWlNtUmxVS3VKU2sxNUJ6ZEt5UGdzcW90aHA1ZEtYRlVDZmluNi1qVDlNIn0.eyJleHAiOjE2NDE5MDU5NjksImlhdCI6MTY0MTkwNTY2OSwianRpIjoiM2YzZWIxODYtMzE5OC00MzA5LTk5OWItMDZkZTI5ZTMwNzExIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiNTQ3OWU4Y2UtYWIzMC00Mzc1LWE5ZWMtMzE4MTJhYjQwZTM3IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Qo2snvszM0ZptvUZiRHLSSO4nz1K0HwEkVPSMfl64bUpFF7dFqQatXHINmKGObf_HLuTviCYih0aDatO_ipy06Y4tSx-aQoewxxEkeGWRmVOlyiyrp9j-XJN3TfhF57Y_19HdtT3yLszqb0mJeIPLO66K0ls96aqjCfn6YfyylVsBiWomsvHUxklb_mZZG8pJiQ82iyMA9KVgkGo68ujHKEGB8BLP7kfxEgM45fP2DCeuElpkQXJGWVhoQITnrDPYnX1L5RBBl1Sy_HFgupsV5mv6e-qEj8poRZxLJqEYv3n762T5wWyc230vjqeenX7NuDmygQK97M3dJdqg3rVQA, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641905969, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=172.29.0.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.29.0.1, http-session-id=B5D8855D0218464C7C4BD109FB0CBC58, http-session-last-accessed-time=1641905682605, kc-category-name=ACCESS, kc-iat=1641905669, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.29.0.1:65262 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 12:54:42.626  INFO 14 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 12:54:42.648  INFO 14 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6cc5099e
2022-01-11 12:54:42.657  INFO 14 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6cc5099e
2022-01-11 12:54:42.721  INFO 14 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6cc5099e
2022-01-11 12:54:42.725  INFO 14 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6cc5099e
2022-01-11 12:54:42.808  INFO 14 --- [https-jsse-nio-7071-exec-3] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-4862215274075-986849, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:b90c11d7-db11-4fad-aaae-8c841010ad99:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=b90c11d7-db11-4fad-aaae-8c841010ad99, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time before Shift end, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-11 12:54:42.813  INFO 14 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=f2845475-f2b2-4c51-a260-2e4b7d606dac, content=DENY, timestamp=1641905682813, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:b90c11d7-db11-4fad-aaae-8c841010ad99:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=b90c11d7-db11-4fad-aaae-8c841010ad99, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time before Shift end, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-11 12:54:42.816  INFO 14 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=181ms, Total=197ms
2022-01-11 12:54:42.865  INFO 14 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=76c01370-7286-49b6-afe0-2b73304c792a, content=null, timestamp=1641905682858, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=65264, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=eb230e1d0f5c, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.29.0.1, kc-session-state=5479e8ce-ab30-4375-a9ec-31812ab40e37, http-req-server-port=80, http-header-accept=*/*, kc-id=3f3eb186-3198-4309-999b-06de29e30711, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641905682853, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd1/MXNxAH4AEQAAAABh3X4FdAAkM2YzZWIxODYtMzE5OC00MzA5LTk5OWItMDZkZTI5ZTMwNzExdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkNTQ3OWU4Y2UtYWIzMC00Mzc1LWE5ZWMtMzE4MTJhYjQwZTM3cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJIWlNtUmxVS3VKU2sxNUJ6ZEt5UGdzcW90aHA1ZEtYRlVDZmluNi1qVDlNIn0.eyJleHAiOjE2NDE5MDU5NjksImlhdCI6MTY0MTkwNTY2OSwianRpIjoiM2YzZWIxODYtMzE5OC00MzA5LTk5OWItMDZkZTI5ZTMwNzExIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiNTQ3OWU4Y2UtYWIzMC00Mzc1LWE5ZWMtMzE4MTJhYjQwZTM3IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Qo2snvszM0ZptvUZiRHLSSO4nz1K0HwEkVPSMfl64bUpFF7dFqQatXHINmKGObf_HLuTviCYih0aDatO_ipy06Y4tSx-aQoewxxEkeGWRmVOlyiyrp9j-XJN3TfhF57Y_19HdtT3yLszqb0mJeIPLO66K0ls96aqjCfn6YfyylVsBiWomsvHUxklb_mZZG8pJiQ82iyMA9KVgkGo68ujHKEGB8BLP7kfxEgM45fP2DCeuElpkQXJGWVhoQITnrDPYnX1L5RBBl1Sy_HFgupsV5mv6e-qEj8poRZxLJqEYv3n762T5wWyc230vjqeenX7NuDmygQK97M3dJdqg3rVQA, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641905969, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=172.29.0.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.29.0.1, http-session-id=028900992499BBCE656D0FA108A41CF4, http-session-last-accessed-time=1641905682853, kc-category-name=ACCESS, kc-iat=1641905669, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.29.0.1:65264 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 12:54:42.870  INFO 14 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 12:54:42.878  INFO 14 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@110d418b
2022-01-11 12:54:42.881  INFO 14 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@110d418b
2022-01-11 12:54:42.921  INFO 14 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@110d418b
2022-01-11 12:54:42.929  INFO 14 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@110d418b
2022-01-11 12:54:42.971  INFO 14 --- [https-jsse-nio-7071-exec-4] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-4862459421375-712748, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:b90c11d7-db11-4fad-aaae-8c841010ad99:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=b90c11d7-db11-4fad-aaae-8c841010ad99, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time before Shift end, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-11 12:54:42.975  INFO 14 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=76c01370-7286-49b6-afe0-2b73304c792a, content=DENY, timestamp=1641905682975, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:b90c11d7-db11-4fad-aaae-8c841010ad99:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=b90c11d7-db11-4fad-aaae-8c841010ad99, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time before Shift end, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-11 12:54:42.979  INFO 14 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=99ms, Total=116ms
2022-01-11 12:54:43.054  INFO 14 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=389bcc1a-a157-44db-b918-dfb55535c62b, content=null, timestamp=1641905683043, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=65266, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=eb230e1d0f5c, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.29.0.1, kc-session-state=5479e8ce-ab30-4375-a9ec-31812ab40e37, http-req-server-port=80, http-header-accept=*/*, kc-id=3f3eb186-3198-4309-999b-06de29e30711, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641905683038, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd1/MXNxAH4AEQAAAABh3X4FdAAkM2YzZWIxODYtMzE5OC00MzA5LTk5OWItMDZkZTI5ZTMwNzExdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkNTQ3OWU4Y2UtYWIzMC00Mzc1LWE5ZWMtMzE4MTJhYjQwZTM3cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJIWlNtUmxVS3VKU2sxNUJ6ZEt5UGdzcW90aHA1ZEtYRlVDZmluNi1qVDlNIn0.eyJleHAiOjE2NDE5MDU5NjksImlhdCI6MTY0MTkwNTY2OSwianRpIjoiM2YzZWIxODYtMzE5OC00MzA5LTk5OWItMDZkZTI5ZTMwNzExIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiNTQ3OWU4Y2UtYWIzMC00Mzc1LWE5ZWMtMzE4MTJhYjQwZTM3IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Qo2snvszM0ZptvUZiRHLSSO4nz1K0HwEkVPSMfl64bUpFF7dFqQatXHINmKGObf_HLuTviCYih0aDatO_ipy06Y4tSx-aQoewxxEkeGWRmVOlyiyrp9j-XJN3TfhF57Y_19HdtT3yLszqb0mJeIPLO66K0ls96aqjCfn6YfyylVsBiWomsvHUxklb_mZZG8pJiQ82iyMA9KVgkGo68ujHKEGB8BLP7kfxEgM45fP2DCeuElpkQXJGWVhoQITnrDPYnX1L5RBBl1Sy_HFgupsV5mv6e-qEj8poRZxLJqEYv3n762T5wWyc230vjqeenX7NuDmygQK97M3dJdqg3rVQA, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641905969, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=172.29.0.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.29.0.1, http-session-id=C0C631B20D6992309CFFA1853B6E2854, http-session-last-accessed-time=1641905683038, kc-category-name=ACCESS, kc-iat=1641905669, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.29.0.1:65266 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 12:54:43.060  INFO 14 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 12:54:43.073  INFO 14 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1a4a4e1d
2022-01-11 12:54:43.083  INFO 14 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1a4a4e1d
2022-01-11 12:54:43.110  INFO 14 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1a4a4e1d
2022-01-11 12:54:43.115  INFO 14 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1a4a4e1d
2022-01-11 12:54:43.192  INFO 14 --- [https-jsse-nio-7071-exec-5] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-4862646496275-938342, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:b90c11d7-db11-4fad-aaae-8c841010ad99:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=b90c11d7-db11-4fad-aaae-8c841010ad99, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time before Shift end, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-11 12:54:43.197  INFO 14 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=389bcc1a-a157-44db-b918-dfb55535c62b, content=DENY, timestamp=1641905683197, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:b90c11d7-db11-4fad-aaae-8c841010ad99:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=b90c11d7-db11-4fad-aaae-8c841010ad99, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time before Shift end, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-11 12:54:43.201  INFO 14 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=134ms, Total=148ms
2022-01-11 12:54:43.258  INFO 14 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=9958b40b-82d9-44cd-b906-3cb59f384b05, content=null, timestamp=1641905683252, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=65268, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=eb230e1d0f5c, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.29.0.1, kc-session-state=5479e8ce-ab30-4375-a9ec-31812ab40e37, http-req-server-port=80, http-header-accept=*/*, kc-id=3f3eb186-3198-4309-999b-06de29e30711, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641905683249, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd1/MXNxAH4AEQAAAABh3X4FdAAkM2YzZWIxODYtMzE5OC00MzA5LTk5OWItMDZkZTI5ZTMwNzExdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkNTQ3OWU4Y2UtYWIzMC00Mzc1LWE5ZWMtMzE4MTJhYjQwZTM3cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJIWlNtUmxVS3VKU2sxNUJ6ZEt5UGdzcW90aHA1ZEtYRlVDZmluNi1qVDlNIn0.eyJleHAiOjE2NDE5MDU5NjksImlhdCI6MTY0MTkwNTY2OSwianRpIjoiM2YzZWIxODYtMzE5OC00MzA5LTk5OWItMDZkZTI5ZTMwNzExIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiNTQ3OWU4Y2UtYWIzMC00Mzc1LWE5ZWMtMzE4MTJhYjQwZTM3IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Qo2snvszM0ZptvUZiRHLSSO4nz1K0HwEkVPSMfl64bUpFF7dFqQatXHINmKGObf_HLuTviCYih0aDatO_ipy06Y4tSx-aQoewxxEkeGWRmVOlyiyrp9j-XJN3TfhF57Y_19HdtT3yLszqb0mJeIPLO66K0ls96aqjCfn6YfyylVsBiWomsvHUxklb_mZZG8pJiQ82iyMA9KVgkGo68ujHKEGB8BLP7kfxEgM45fP2DCeuElpkQXJGWVhoQITnrDPYnX1L5RBBl1Sy_HFgupsV5mv6e-qEj8poRZxLJqEYv3n762T5wWyc230vjqeenX7NuDmygQK97M3dJdqg3rVQA, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641905969, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=172.29.0.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.29.0.1, http-session-id=26F5550ECF9FCA76F816E0396BB14338, http-session-last-accessed-time=1641905683249, kc-category-name=ACCESS, kc-iat=1641905669, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.29.0.1:65268 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 12:54:43.268  INFO 14 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 12:54:43.273  INFO 14 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5e27b053
2022-01-11 12:54:43.276  INFO 14 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5e27b053
2022-01-11 12:54:43.318  INFO 14 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5e27b053
2022-01-11 12:54:43.321  INFO 14 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5e27b053
2022-01-11 12:54:43.366  INFO 14 --- [https-jsse-nio-7071-exec-6] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-4862854417475-322296, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:b90c11d7-db11-4fad-aaae-8c841010ad99:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=b90c11d7-db11-4fad-aaae-8c841010ad99, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time before Shift end, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-11 12:54:43.370  INFO 14 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=9958b40b-82d9-44cd-b906-3cb59f384b05, content=DENY, timestamp=1641905683370, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:b90c11d7-db11-4fad-aaae-8c841010ad99:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=b90c11d7-db11-4fad-aaae-8c841010ad99, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time before Shift end, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-11 12:54:43.374  INFO 14 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=99ms, Total=117ms
2022-01-11 12:54:43.434  INFO 14 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=c21ee87e-1e96-4cd4-9d34-f78b83f598be, content=null, timestamp=1641905683417, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=65270, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=eb230e1d0f5c, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.29.0.1, kc-session-state=5479e8ce-ab30-4375-a9ec-31812ab40e37, http-req-server-port=80, http-header-accept=*/*, kc-id=3f3eb186-3198-4309-999b-06de29e30711, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641905683403, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd1/MXNxAH4AEQAAAABh3X4FdAAkM2YzZWIxODYtMzE5OC00MzA5LTk5OWItMDZkZTI5ZTMwNzExdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkNTQ3OWU4Y2UtYWIzMC00Mzc1LWE5ZWMtMzE4MTJhYjQwZTM3cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJIWlNtUmxVS3VKU2sxNUJ6ZEt5UGdzcW90aHA1ZEtYRlVDZmluNi1qVDlNIn0.eyJleHAiOjE2NDE5MDU5NjksImlhdCI6MTY0MTkwNTY2OSwianRpIjoiM2YzZWIxODYtMzE5OC00MzA5LTk5OWItMDZkZTI5ZTMwNzExIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiNTQ3OWU4Y2UtYWIzMC00Mzc1LWE5ZWMtMzE4MTJhYjQwZTM3IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Qo2snvszM0ZptvUZiRHLSSO4nz1K0HwEkVPSMfl64bUpFF7dFqQatXHINmKGObf_HLuTviCYih0aDatO_ipy06Y4tSx-aQoewxxEkeGWRmVOlyiyrp9j-XJN3TfhF57Y_19HdtT3yLszqb0mJeIPLO66K0ls96aqjCfn6YfyylVsBiWomsvHUxklb_mZZG8pJiQ82iyMA9KVgkGo68ujHKEGB8BLP7kfxEgM45fP2DCeuElpkQXJGWVhoQITnrDPYnX1L5RBBl1Sy_HFgupsV5mv6e-qEj8poRZxLJqEYv3n762T5wWyc230vjqeenX7NuDmygQK97M3dJdqg3rVQA, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641905969, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=172.29.0.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.29.0.1, http-session-id=C0D022620A73DCD2D82CBD7DAE3916F6, http-session-last-accessed-time=1641905683403, kc-category-name=ACCESS, kc-iat=1641905669, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.29.0.1:65270 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 12:54:43.446  INFO 14 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 12:54:43.450  INFO 14 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1c786017
2022-01-11 12:54:43.455  INFO 14 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1c786017
2022-01-11 12:54:43.496  INFO 14 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1c786017
2022-01-11 12:54:43.501  INFO 14 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1c786017
2022-01-11 12:54:43.577  INFO 14 --- [https-jsse-nio-7071-exec-7] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-4863031754375-538141, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:b90c11d7-db11-4fad-aaae-8c841010ad99:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=b90c11d7-db11-4fad-aaae-8c841010ad99, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time before Shift end, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-11 12:54:43.581  INFO 14 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=c21ee87e-1e96-4cd4-9d34-f78b83f598be, content=DENY, timestamp=1641905683581, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:b90c11d7-db11-4fad-aaae-8c841010ad99:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=b90c11d7-db11-4fad-aaae-8c841010ad99, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time before Shift end, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-11 12:54:43.584  INFO 14 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=133ms, Total=152ms
2022-01-11 12:54:43.640  INFO 14 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=69498e96-887c-41f9-8953-c8046385c5cb, content=null, timestamp=1641905683630, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=65272, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=eb230e1d0f5c, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.29.0.1, kc-session-state=5479e8ce-ab30-4375-a9ec-31812ab40e37, http-req-server-port=80, http-header-accept=*/*, kc-id=3f3eb186-3198-4309-999b-06de29e30711, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641905683628, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd1/MXNxAH4AEQAAAABh3X4FdAAkM2YzZWIxODYtMzE5OC00MzA5LTk5OWItMDZkZTI5ZTMwNzExdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkNTQ3OWU4Y2UtYWIzMC00Mzc1LWE5ZWMtMzE4MTJhYjQwZTM3cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJIWlNtUmxVS3VKU2sxNUJ6ZEt5UGdzcW90aHA1ZEtYRlVDZmluNi1qVDlNIn0.eyJleHAiOjE2NDE5MDU5NjksImlhdCI6MTY0MTkwNTY2OSwianRpIjoiM2YzZWIxODYtMzE5OC00MzA5LTk5OWItMDZkZTI5ZTMwNzExIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiNTQ3OWU4Y2UtYWIzMC00Mzc1LWE5ZWMtMzE4MTJhYjQwZTM3IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Qo2snvszM0ZptvUZiRHLSSO4nz1K0HwEkVPSMfl64bUpFF7dFqQatXHINmKGObf_HLuTviCYih0aDatO_ipy06Y4tSx-aQoewxxEkeGWRmVOlyiyrp9j-XJN3TfhF57Y_19HdtT3yLszqb0mJeIPLO66K0ls96aqjCfn6YfyylVsBiWomsvHUxklb_mZZG8pJiQ82iyMA9KVgkGo68ujHKEGB8BLP7kfxEgM45fP2DCeuElpkQXJGWVhoQITnrDPYnX1L5RBBl1Sy_HFgupsV5mv6e-qEj8poRZxLJqEYv3n762T5wWyc230vjqeenX7NuDmygQK97M3dJdqg3rVQA, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641905969, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=172.29.0.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.29.0.1, http-session-id=0C6FE3FE3A704FE4399228ED880B6C8D, http-session-last-accessed-time=1641905683628, kc-category-name=ACCESS, kc-iat=1641905669, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.29.0.1:65272 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 12:54:43.646  INFO 14 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 12:54:43.656  INFO 14 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@97ce06
2022-01-11 12:54:43.660  INFO 14 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@97ce06
2022-01-11 12:54:43.710  INFO 14 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@97ce06
2022-01-11 12:54:43.718  INFO 14 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@97ce06
2022-01-11 12:54:43.761  INFO 14 --- [https-jsse-nio-7071-exec-8] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-4863233208575-944133, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:b90c11d7-db11-4fad-aaae-8c841010ad99:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=b90c11d7-db11-4fad-aaae-8c841010ad99, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time before Shift end, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-11 12:54:43.766  INFO 14 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=69498e96-887c-41f9-8953-c8046385c5cb, content=DENY, timestamp=1641905683766, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:b90c11d7-db11-4fad-aaae-8c841010ad99:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=b90c11d7-db11-4fad-aaae-8c841010ad99, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time before Shift end, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-11 12:54:43.770  INFO 14 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=116ms, Total=133ms
2022-01-11 12:54:43.840  INFO 14 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=7544fd60-6e55-4314-aa7f-22fa8680825a, content=null, timestamp=1641905683821, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=65274, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=eb230e1d0f5c, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.29.0.1, kc-session-state=5479e8ce-ab30-4375-a9ec-31812ab40e37, http-req-server-port=80, http-header-accept=*/*, kc-id=3f3eb186-3198-4309-999b-06de29e30711, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641905683819, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd1/MXNxAH4AEQAAAABh3X4FdAAkM2YzZWIxODYtMzE5OC00MzA5LTk5OWItMDZkZTI5ZTMwNzExdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkNTQ3OWU4Y2UtYWIzMC00Mzc1LWE5ZWMtMzE4MTJhYjQwZTM3cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJIWlNtUmxVS3VKU2sxNUJ6ZEt5UGdzcW90aHA1ZEtYRlVDZmluNi1qVDlNIn0.eyJleHAiOjE2NDE5MDU5NjksImlhdCI6MTY0MTkwNTY2OSwianRpIjoiM2YzZWIxODYtMzE5OC00MzA5LTk5OWItMDZkZTI5ZTMwNzExIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiNTQ3OWU4Y2UtYWIzMC00Mzc1LWE5ZWMtMzE4MTJhYjQwZTM3IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Qo2snvszM0ZptvUZiRHLSSO4nz1K0HwEkVPSMfl64bUpFF7dFqQatXHINmKGObf_HLuTviCYih0aDatO_ipy06Y4tSx-aQoewxxEkeGWRmVOlyiyrp9j-XJN3TfhF57Y_19HdtT3yLszqb0mJeIPLO66K0ls96aqjCfn6YfyylVsBiWomsvHUxklb_mZZG8pJiQ82iyMA9KVgkGo68ujHKEGB8BLP7kfxEgM45fP2DCeuElpkQXJGWVhoQITnrDPYnX1L5RBBl1Sy_HFgupsV5mv6e-qEj8poRZxLJqEYv3n762T5wWyc230vjqeenX7NuDmygQK97M3dJdqg3rVQA, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641905969, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=172.29.0.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.29.0.1, http-session-id=D6E959D08BD48F980578A5F1C932BC24, http-session-last-accessed-time=1641905683819, kc-category-name=ACCESS, kc-iat=1641905669, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.29.0.1:65274 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 12:54:43.852  INFO 14 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 12:54:43.859  INFO 14 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7445e309
2022-01-11 12:54:43.866  INFO 14 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7445e309
2022-01-11 12:54:43.958  INFO 14 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7445e309
2022-01-11 12:54:43.961  INFO 14 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7445e309
2022-01-11 12:54:44.040  INFO 14 --- [https-jsse-nio-7071-exec-9] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-4863441279375-538062, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:b90c11d7-db11-4fad-aaae-8c841010ad99:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=b90c11d7-db11-4fad-aaae-8c841010ad99, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time before Shift end, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-11 12:54:44.045  INFO 14 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=7544fd60-6e55-4314-aa7f-22fa8680825a, content=DENY, timestamp=1641905684045, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:b90c11d7-db11-4fad-aaae-8c841010ad99:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=b90c11d7-db11-4fad-aaae-8c841010ad99, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time before Shift end, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-11 12:54:44.050  INFO 14 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=187ms, Total=218ms
2022-01-11 12:54:44.094  INFO 14 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=67ff7dd8-6bf9-44e3-a97a-b2e68e8fba12, content=null, timestamp=1641905684082, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=65276, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=eb230e1d0f5c, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.29.0.1, kc-session-state=5479e8ce-ab30-4375-a9ec-31812ab40e37, http-req-server-port=80, http-header-accept=*/*, kc-id=3f3eb186-3198-4309-999b-06de29e30711, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641905684080, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd1/MXNxAH4AEQAAAABh3X4FdAAkM2YzZWIxODYtMzE5OC00MzA5LTk5OWItMDZkZTI5ZTMwNzExdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkNTQ3OWU4Y2UtYWIzMC00Mzc1LWE5ZWMtMzE4MTJhYjQwZTM3cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJIWlNtUmxVS3VKU2sxNUJ6ZEt5UGdzcW90aHA1ZEtYRlVDZmluNi1qVDlNIn0.eyJleHAiOjE2NDE5MDU5NjksImlhdCI6MTY0MTkwNTY2OSwianRpIjoiM2YzZWIxODYtMzE5OC00MzA5LTk5OWItMDZkZTI5ZTMwNzExIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiNTQ3OWU4Y2UtYWIzMC00Mzc1LWE5ZWMtMzE4MTJhYjQwZTM3IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Qo2snvszM0ZptvUZiRHLSSO4nz1K0HwEkVPSMfl64bUpFF7dFqQatXHINmKGObf_HLuTviCYih0aDatO_ipy06Y4tSx-aQoewxxEkeGWRmVOlyiyrp9j-XJN3TfhF57Y_19HdtT3yLszqb0mJeIPLO66K0ls96aqjCfn6YfyylVsBiWomsvHUxklb_mZZG8pJiQ82iyMA9KVgkGo68ujHKEGB8BLP7kfxEgM45fP2DCeuElpkQXJGWVhoQITnrDPYnX1L5RBBl1Sy_HFgupsV5mv6e-qEj8poRZxLJqEYv3n762T5wWyc230vjqeenX7NuDmygQK97M3dJdqg3rVQA, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641905969, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=172.29.0.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.29.0.1, http-session-id=CFE696708CC5815ADFD7D38FD00DC80A, http-session-last-accessed-time=1641905684080, kc-category-name=ACCESS, kc-iat=1641905669, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.29.0.1:65276 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 12:54:44.099  INFO 14 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 12:54:44.108  INFO 14 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@251ca5b6
2022-01-11 12:54:44.113  INFO 14 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@251ca5b6
2022-01-11 12:54:44.152  INFO 14 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@251ca5b6
2022-01-11 12:54:44.159  INFO 14 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@251ca5b6
2022-01-11 12:54:44.256  INFO 14 --- [https-jsse-nio-7071-exec-10] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-4863690207475-881535, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:b90c11d7-db11-4fad-aaae-8c841010ad99:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=b90c11d7-db11-4fad-aaae-8c841010ad99, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time before Shift end, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-11 12:54:44.260  INFO 14 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=67ff7dd8-6bf9-44e3-a97a-b2e68e8fba12, content=DENY, timestamp=1641905684260, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:b90c11d7-db11-4fad-aaae-8c841010ad99:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=b90c11d7-db11-4fad-aaae-8c841010ad99, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time before Shift end, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-11 12:54:44.265  INFO 14 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=153ms, Total=172ms
2022-01-11 12:54:44.314  INFO 14 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=29317b26-0d19-4f70-9969-c2ca4ab7bf06, content=null, timestamp=1641905684303, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=65278, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=eb230e1d0f5c, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.29.0.1, kc-session-state=5479e8ce-ab30-4375-a9ec-31812ab40e37, http-req-server-port=80, http-header-accept=*/*, kc-id=3f3eb186-3198-4309-999b-06de29e30711, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641905684298, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd1/MXNxAH4AEQAAAABh3X4FdAAkM2YzZWIxODYtMzE5OC00MzA5LTk5OWItMDZkZTI5ZTMwNzExdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkNTQ3OWU4Y2UtYWIzMC00Mzc1LWE5ZWMtMzE4MTJhYjQwZTM3cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJIWlNtUmxVS3VKU2sxNUJ6ZEt5UGdzcW90aHA1ZEtYRlVDZmluNi1qVDlNIn0.eyJleHAiOjE2NDE5MDU5NjksImlhdCI6MTY0MTkwNTY2OSwianRpIjoiM2YzZWIxODYtMzE5OC00MzA5LTk5OWItMDZkZTI5ZTMwNzExIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiNTQ3OWU4Y2UtYWIzMC00Mzc1LWE5ZWMtMzE4MTJhYjQwZTM3IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Qo2snvszM0ZptvUZiRHLSSO4nz1K0HwEkVPSMfl64bUpFF7dFqQatXHINmKGObf_HLuTviCYih0aDatO_ipy06Y4tSx-aQoewxxEkeGWRmVOlyiyrp9j-XJN3TfhF57Y_19HdtT3yLszqb0mJeIPLO66K0ls96aqjCfn6YfyylVsBiWomsvHUxklb_mZZG8pJiQ82iyMA9KVgkGo68ujHKEGB8BLP7kfxEgM45fP2DCeuElpkQXJGWVhoQITnrDPYnX1L5RBBl1Sy_HFgupsV5mv6e-qEj8poRZxLJqEYv3n762T5wWyc230vjqeenX7NuDmygQK97M3dJdqg3rVQA, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641905969, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=172.29.0.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.29.0.1, http-session-id=5F6830028A62D7DE3694BE7B5C242242, http-session-last-accessed-time=1641905684298, kc-category-name=ACCESS, kc-iat=1641905669, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.29.0.1:65278 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 12:54:44.318  INFO 14 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 12:54:44.322  INFO 14 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2c6a3b24
2022-01-11 12:54:44.326  INFO 14 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2c6a3b24
2022-01-11 12:54:44.364  INFO 14 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2c6a3b24
2022-01-11 12:54:44.369  INFO 14 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2c6a3b24
2022-01-11 12:54:44.399  INFO 14 --- [https-jsse-nio-7071-exec-1] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-4863903936375-382813, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:b90c11d7-db11-4fad-aaae-8c841010ad99:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=b90c11d7-db11-4fad-aaae-8c841010ad99, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time before Shift end, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-11 12:54:44.404  INFO 14 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=29317b26-0d19-4f70-9969-c2ca4ab7bf06, content=DENY, timestamp=1641905684404, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:b90c11d7-db11-4fad-aaae-8c841010ad99:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=b90c11d7-db11-4fad-aaae-8c841010ad99, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time before Shift end, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-11 12:54:44.408  INFO 14 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=83ms, Total=96ms
2022-01-11 12:54:44.470  INFO 14 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=0c658217-e36a-43ff-ba1f-12b64712f15a, content=null, timestamp=1641905684450, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=65280, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=eb230e1d0f5c, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.29.0.1, kc-session-state=5479e8ce-ab30-4375-a9ec-31812ab40e37, http-req-server-port=80, http-header-accept=*/*, kc-id=3f3eb186-3198-4309-999b-06de29e30711, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641905684449, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd1/MXNxAH4AEQAAAABh3X4FdAAkM2YzZWIxODYtMzE5OC00MzA5LTk5OWItMDZkZTI5ZTMwNzExdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkNTQ3OWU4Y2UtYWIzMC00Mzc1LWE5ZWMtMzE4MTJhYjQwZTM3cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJIWlNtUmxVS3VKU2sxNUJ6ZEt5UGdzcW90aHA1ZEtYRlVDZmluNi1qVDlNIn0.eyJleHAiOjE2NDE5MDU5NjksImlhdCI6MTY0MTkwNTY2OSwianRpIjoiM2YzZWIxODYtMzE5OC00MzA5LTk5OWItMDZkZTI5ZTMwNzExIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiNTQ3OWU4Y2UtYWIzMC00Mzc1LWE5ZWMtMzE4MTJhYjQwZTM3IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Qo2snvszM0ZptvUZiRHLSSO4nz1K0HwEkVPSMfl64bUpFF7dFqQatXHINmKGObf_HLuTviCYih0aDatO_ipy06Y4tSx-aQoewxxEkeGWRmVOlyiyrp9j-XJN3TfhF57Y_19HdtT3yLszqb0mJeIPLO66K0ls96aqjCfn6YfyylVsBiWomsvHUxklb_mZZG8pJiQ82iyMA9KVgkGo68ujHKEGB8BLP7kfxEgM45fP2DCeuElpkQXJGWVhoQITnrDPYnX1L5RBBl1Sy_HFgupsV5mv6e-qEj8poRZxLJqEYv3n762T5wWyc230vjqeenX7NuDmygQK97M3dJdqg3rVQA, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641905969, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=172.29.0.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.29.0.1, http-session-id=1B12BB9753A7597CD07EE828F7E4315F, http-session-last-accessed-time=1641905684449, kc-category-name=ACCESS, kc-iat=1641905669, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.29.0.1:65280 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 12:54:44.483  INFO 14 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 12:54:44.488  INFO 14 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7789059b
2022-01-11 12:54:44.491  INFO 14 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7789059b
2022-01-11 12:54:44.539  INFO 14 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7789059b
2022-01-11 12:54:44.541  INFO 14 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7789059b
2022-01-11 12:54:44.611  INFO 14 --- [https-jsse-nio-7071-exec-2] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-4864069552575-573211, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:b90c11d7-db11-4fad-aaae-8c841010ad99:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=b90c11d7-db11-4fad-aaae-8c841010ad99, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time before Shift end, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-11 12:54:44.614  INFO 14 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=0c658217-e36a-43ff-ba1f-12b64712f15a, content=DENY, timestamp=1641905684614, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:b90c11d7-db11-4fad-aaae-8c841010ad99:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=b90c11d7-db11-4fad-aaae-8c841010ad99, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time before Shift end, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-11 12:54:44.618  INFO 14 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=128ms, Total=149ms
2022-01-11 12:54:44.661  INFO 14 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=e58eb00d-0b0f-46b9-8e73-64fc73462500, content=null, timestamp=1641905684654, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=65282, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=eb230e1d0f5c, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.29.0.1, kc-session-state=5479e8ce-ab30-4375-a9ec-31812ab40e37, http-req-server-port=80, http-header-accept=*/*, kc-id=3f3eb186-3198-4309-999b-06de29e30711, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641905684653, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd1/MXNxAH4AEQAAAABh3X4FdAAkM2YzZWIxODYtMzE5OC00MzA5LTk5OWItMDZkZTI5ZTMwNzExdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkNTQ3OWU4Y2UtYWIzMC00Mzc1LWE5ZWMtMzE4MTJhYjQwZTM3cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJIWlNtUmxVS3VKU2sxNUJ6ZEt5UGdzcW90aHA1ZEtYRlVDZmluNi1qVDlNIn0.eyJleHAiOjE2NDE5MDU5NjksImlhdCI6MTY0MTkwNTY2OSwianRpIjoiM2YzZWIxODYtMzE5OC00MzA5LTk5OWItMDZkZTI5ZTMwNzExIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiNTQ3OWU4Y2UtYWIzMC00Mzc1LWE5ZWMtMzE4MTJhYjQwZTM3IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Qo2snvszM0ZptvUZiRHLSSO4nz1K0HwEkVPSMfl64bUpFF7dFqQatXHINmKGObf_HLuTviCYih0aDatO_ipy06Y4tSx-aQoewxxEkeGWRmVOlyiyrp9j-XJN3TfhF57Y_19HdtT3yLszqb0mJeIPLO66K0ls96aqjCfn6YfyylVsBiWomsvHUxklb_mZZG8pJiQ82iyMA9KVgkGo68ujHKEGB8BLP7kfxEgM45fP2DCeuElpkQXJGWVhoQITnrDPYnX1L5RBBl1Sy_HFgupsV5mv6e-qEj8poRZxLJqEYv3n762T5wWyc230vjqeenX7NuDmygQK97M3dJdqg3rVQA, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641905969, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=172.29.0.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.29.0.1, http-session-id=4BA6CCB8DCFC517A1EACDF9A6A5EB244, http-session-last-accessed-time=1641905684653, kc-category-name=ACCESS, kc-iat=1641905669, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.29.0.1:65282 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 12:54:44.679  INFO 14 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 12:54:44.686  INFO 14 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@69d97961
2022-01-11 12:54:44.689  INFO 14 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@69d97961
2022-01-11 12:54:44.714  INFO 14 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@69d97961
2022-01-11 12:54:44.718  INFO 14 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@69d97961
2022-01-11 12:54:44.755  INFO 14 --- [https-jsse-nio-7071-exec-3] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-4864264930375-991765, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:b90c11d7-db11-4fad-aaae-8c841010ad99:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=b90c11d7-db11-4fad-aaae-8c841010ad99, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time before Shift end, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-11 12:54:44.759  INFO 14 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=e58eb00d-0b0f-46b9-8e73-64fc73462500, content=DENY, timestamp=1641905684759, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:b90c11d7-db11-4fad-aaae-8c841010ad99:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=b90c11d7-db11-4fad-aaae-8c841010ad99, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time before Shift end, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-11 12:54:44.764  INFO 14 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=77ms, Total=105ms
2022-01-11 12:54:44.818  INFO 14 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=29bc5bc4-ec88-4ca2-bab4-f154ca26c66e, content=null, timestamp=1641905684800, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=65284, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=eb230e1d0f5c, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.29.0.1, kc-session-state=5479e8ce-ab30-4375-a9ec-31812ab40e37, http-req-server-port=80, http-header-accept=*/*, kc-id=3f3eb186-3198-4309-999b-06de29e30711, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641905684799, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd1/MXNxAH4AEQAAAABh3X4FdAAkM2YzZWIxODYtMzE5OC00MzA5LTk5OWItMDZkZTI5ZTMwNzExdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkNTQ3OWU4Y2UtYWIzMC00Mzc1LWE5ZWMtMzE4MTJhYjQwZTM3cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJIWlNtUmxVS3VKU2sxNUJ6ZEt5UGdzcW90aHA1ZEtYRlVDZmluNi1qVDlNIn0.eyJleHAiOjE2NDE5MDU5NjksImlhdCI6MTY0MTkwNTY2OSwianRpIjoiM2YzZWIxODYtMzE5OC00MzA5LTk5OWItMDZkZTI5ZTMwNzExIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiNTQ3OWU4Y2UtYWIzMC00Mzc1LWE5ZWMtMzE4MTJhYjQwZTM3IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Qo2snvszM0ZptvUZiRHLSSO4nz1K0HwEkVPSMfl64bUpFF7dFqQatXHINmKGObf_HLuTviCYih0aDatO_ipy06Y4tSx-aQoewxxEkeGWRmVOlyiyrp9j-XJN3TfhF57Y_19HdtT3yLszqb0mJeIPLO66K0ls96aqjCfn6YfyylVsBiWomsvHUxklb_mZZG8pJiQ82iyMA9KVgkGo68ujHKEGB8BLP7kfxEgM45fP2DCeuElpkQXJGWVhoQITnrDPYnX1L5RBBl1Sy_HFgupsV5mv6e-qEj8poRZxLJqEYv3n762T5wWyc230vjqeenX7NuDmygQK97M3dJdqg3rVQA, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641905969, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=172.29.0.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.29.0.1, http-session-id=0DA70189363B259B939B6A977BB8E7BC, http-session-last-accessed-time=1641905684799, kc-category-name=ACCESS, kc-iat=1641905669, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.29.0.1:65284 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 12:54:44.826  INFO 14 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 12:54:44.848  INFO 14 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5e9ac306
2022-01-11 12:54:44.852  INFO 14 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5e9ac306
2022-01-11 12:54:44.904  INFO 14 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5e9ac306
2022-01-11 12:54:44.907  INFO 14 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5e9ac306
2022-01-11 12:54:44.945  INFO 14 --- [https-jsse-nio-7071-exec-4] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-4864415599775-312469, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:b90c11d7-db11-4fad-aaae-8c841010ad99:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=b90c11d7-db11-4fad-aaae-8c841010ad99, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time before Shift end, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-11 12:54:44.948  INFO 14 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=29bc5bc4-ec88-4ca2-bab4-f154ca26c66e, content=DENY, timestamp=1641905684948, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:b90c11d7-db11-4fad-aaae-8c841010ad99:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=b90c11d7-db11-4fad-aaae-8c841010ad99, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time before Shift end, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-11 12:54:44.955  INFO 14 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=116ms, Total=139ms
2022-01-11 12:54:45.004  INFO 14 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=7a91d2fa-6f7d-4d5c-b132-d256d290e647, content=null, timestamp=1641905684989, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=65286, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=eb230e1d0f5c, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.29.0.1, kc-session-state=5479e8ce-ab30-4375-a9ec-31812ab40e37, http-req-server-port=80, http-header-accept=*/*, kc-id=3f3eb186-3198-4309-999b-06de29e30711, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641905684987, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd1/MXNxAH4AEQAAAABh3X4FdAAkM2YzZWIxODYtMzE5OC00MzA5LTk5OWItMDZkZTI5ZTMwNzExdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkNTQ3OWU4Y2UtYWIzMC00Mzc1LWE5ZWMtMzE4MTJhYjQwZTM3cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJIWlNtUmxVS3VKU2sxNUJ6ZEt5UGdzcW90aHA1ZEtYRlVDZmluNi1qVDlNIn0.eyJleHAiOjE2NDE5MDU5NjksImlhdCI6MTY0MTkwNTY2OSwianRpIjoiM2YzZWIxODYtMzE5OC00MzA5LTk5OWItMDZkZTI5ZTMwNzExIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiNTQ3OWU4Y2UtYWIzMC00Mzc1LWE5ZWMtMzE4MTJhYjQwZTM3IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Qo2snvszM0ZptvUZiRHLSSO4nz1K0HwEkVPSMfl64bUpFF7dFqQatXHINmKGObf_HLuTviCYih0aDatO_ipy06Y4tSx-aQoewxxEkeGWRmVOlyiyrp9j-XJN3TfhF57Y_19HdtT3yLszqb0mJeIPLO66K0ls96aqjCfn6YfyylVsBiWomsvHUxklb_mZZG8pJiQ82iyMA9KVgkGo68ujHKEGB8BLP7kfxEgM45fP2DCeuElpkQXJGWVhoQITnrDPYnX1L5RBBl1Sy_HFgupsV5mv6e-qEj8poRZxLJqEYv3n762T5wWyc230vjqeenX7NuDmygQK97M3dJdqg3rVQA, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641905969, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=172.29.0.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.29.0.1, http-session-id=A8713DF262A76E3B168FB79643346E72, http-session-last-accessed-time=1641905684987, kc-category-name=ACCESS, kc-iat=1641905669, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.29.0.1:65286 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 12:54:45.008  INFO 14 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 12:54:45.015  INFO 14 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1f064763
2022-01-11 12:54:45.020  INFO 14 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1f064763
2022-01-11 12:54:45.094  INFO 14 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1f064763
2022-01-11 12:54:45.097  INFO 14 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1f064763
2022-01-11 12:54:45.133  INFO 14 --- [https-jsse-nio-7071-exec-5] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-4864594668975-580964, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:b90c11d7-db11-4fad-aaae-8c841010ad99:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=b90c11d7-db11-4fad-aaae-8c841010ad99, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time before Shift end, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-11 12:54:45.139  INFO 14 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=7a91d2fa-6f7d-4d5c-b132-d256d290e647, content=DENY, timestamp=1641905685139, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:b90c11d7-db11-4fad-aaae-8c841010ad99:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=b90c11d7-db11-4fad-aaae-8c841010ad99, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time before Shift end, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-11 12:54:45.148  INFO 14 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=128ms, Total=149ms
2022-01-11 12:54:45.201  INFO 14 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=1703c2f0-a3be-4014-b81d-4170fabd83c7, content=null, timestamp=1641905685188, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=65288, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=eb230e1d0f5c, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.29.0.1, kc-session-state=5479e8ce-ab30-4375-a9ec-31812ab40e37, http-req-server-port=80, http-header-accept=*/*, kc-id=3f3eb186-3198-4309-999b-06de29e30711, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641905685186, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd1/MXNxAH4AEQAAAABh3X4FdAAkM2YzZWIxODYtMzE5OC00MzA5LTk5OWItMDZkZTI5ZTMwNzExdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkNTQ3OWU4Y2UtYWIzMC00Mzc1LWE5ZWMtMzE4MTJhYjQwZTM3cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJIWlNtUmxVS3VKU2sxNUJ6ZEt5UGdzcW90aHA1ZEtYRlVDZmluNi1qVDlNIn0.eyJleHAiOjE2NDE5MDU5NjksImlhdCI6MTY0MTkwNTY2OSwianRpIjoiM2YzZWIxODYtMzE5OC00MzA5LTk5OWItMDZkZTI5ZTMwNzExIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiNTQ3OWU4Y2UtYWIzMC00Mzc1LWE5ZWMtMzE4MTJhYjQwZTM3IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Qo2snvszM0ZptvUZiRHLSSO4nz1K0HwEkVPSMfl64bUpFF7dFqQatXHINmKGObf_HLuTviCYih0aDatO_ipy06Y4tSx-aQoewxxEkeGWRmVOlyiyrp9j-XJN3TfhF57Y_19HdtT3yLszqb0mJeIPLO66K0ls96aqjCfn6YfyylVsBiWomsvHUxklb_mZZG8pJiQ82iyMA9KVgkGo68ujHKEGB8BLP7kfxEgM45fP2DCeuElpkQXJGWVhoQITnrDPYnX1L5RBBl1Sy_HFgupsV5mv6e-qEj8poRZxLJqEYv3n762T5wWyc230vjqeenX7NuDmygQK97M3dJdqg3rVQA, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641905969, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=172.29.0.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.29.0.1, http-session-id=ED09FFE8B8A20DC65008F4DFA1C1508B, http-session-last-accessed-time=1641905685186, kc-category-name=ACCESS, kc-iat=1641905669, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.29.0.1:65288 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 12:54:45.207  INFO 14 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 12:54:45.212  INFO 14 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1ad60ad9
2022-01-11 12:54:45.214  INFO 14 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1ad60ad9
2022-01-11 12:54:45.270  INFO 14 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1ad60ad9
2022-01-11 12:54:45.279  INFO 14 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1ad60ad9
2022-01-11 12:54:45.335  INFO 14 --- [https-jsse-nio-7071-exec-6] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-4864792830375-982561, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:b90c11d7-db11-4fad-aaae-8c841010ad99:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=b90c11d7-db11-4fad-aaae-8c841010ad99, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time before Shift end, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-11 12:54:45.344  INFO 14 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=1703c2f0-a3be-4014-b81d-4170fabd83c7, content=DENY, timestamp=1641905685344, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:b90c11d7-db11-4fad-aaae-8c841010ad99:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=b90c11d7-db11-4fad-aaae-8c841010ad99, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time before Shift end, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-11 12:54:45.346  INFO 14 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=134ms, Total=147ms
2022-01-11 12:54:45.425  INFO 14 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=e28edfcd-f08e-4c13-a99c-59643f63a700, content=null, timestamp=1641905685414, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=65290, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=eb230e1d0f5c, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.29.0.1, kc-session-state=5479e8ce-ab30-4375-a9ec-31812ab40e37, http-req-server-port=80, http-header-accept=*/*, kc-id=3f3eb186-3198-4309-999b-06de29e30711, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641905685405, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd1/MXNxAH4AEQAAAABh3X4FdAAkM2YzZWIxODYtMzE5OC00MzA5LTk5OWItMDZkZTI5ZTMwNzExdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkNTQ3OWU4Y2UtYWIzMC00Mzc1LWE5ZWMtMzE4MTJhYjQwZTM3cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJIWlNtUmxVS3VKU2sxNUJ6ZEt5UGdzcW90aHA1ZEtYRlVDZmluNi1qVDlNIn0.eyJleHAiOjE2NDE5MDU5NjksImlhdCI6MTY0MTkwNTY2OSwianRpIjoiM2YzZWIxODYtMzE5OC00MzA5LTk5OWItMDZkZTI5ZTMwNzExIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiNTQ3OWU4Y2UtYWIzMC00Mzc1LWE5ZWMtMzE4MTJhYjQwZTM3IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Qo2snvszM0ZptvUZiRHLSSO4nz1K0HwEkVPSMfl64bUpFF7dFqQatXHINmKGObf_HLuTviCYih0aDatO_ipy06Y4tSx-aQoewxxEkeGWRmVOlyiyrp9j-XJN3TfhF57Y_19HdtT3yLszqb0mJeIPLO66K0ls96aqjCfn6YfyylVsBiWomsvHUxklb_mZZG8pJiQ82iyMA9KVgkGo68ujHKEGB8BLP7kfxEgM45fP2DCeuElpkQXJGWVhoQITnrDPYnX1L5RBBl1Sy_HFgupsV5mv6e-qEj8poRZxLJqEYv3n762T5wWyc230vjqeenX7NuDmygQK97M3dJdqg3rVQA, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641905969, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=172.29.0.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.29.0.1, http-session-id=D00ECB6F9B448C3512E9ADEFE739F410, http-session-last-accessed-time=1641905685405, kc-category-name=ACCESS, kc-iat=1641905669, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.29.0.1:65290 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 12:54:45.430  INFO 14 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 12:54:45.434  INFO 14 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6018d1c2
2022-01-11 12:54:45.438  INFO 14 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6018d1c2
2022-01-11 12:54:45.496  INFO 14 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6018d1c2
2022-01-11 12:54:45.500  INFO 14 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6018d1c2
2022-01-11 12:54:45.582  INFO 14 --- [https-jsse-nio-7071-exec-7] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-4865015691975-80270, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:b90c11d7-db11-4fad-aaae-8c841010ad99:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=b90c11d7-db11-4fad-aaae-8c841010ad99, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time before Shift end, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-11 12:54:45.584  INFO 14 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=e28edfcd-f08e-4c13-a99c-59643f63a700, content=DENY, timestamp=1641905685584, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:b90c11d7-db11-4fad-aaae-8c841010ad99:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=b90c11d7-db11-4fad-aaae-8c841010ad99, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time before Shift end, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-11 12:54:45.586  INFO 14 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=152ms, Total=163ms
2022-01-11 12:54:45.645  INFO 14 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=ec8fd902-e84b-4a4d-a1b6-54868afd8d02, content=null, timestamp=1641905685615, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=65292, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=eb230e1d0f5c, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.29.0.1, kc-session-state=5479e8ce-ab30-4375-a9ec-31812ab40e37, http-req-server-port=80, http-header-accept=*/*, kc-id=3f3eb186-3198-4309-999b-06de29e30711, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641905685613, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd1/MXNxAH4AEQAAAABh3X4FdAAkM2YzZWIxODYtMzE5OC00MzA5LTk5OWItMDZkZTI5ZTMwNzExdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkNTQ3OWU4Y2UtYWIzMC00Mzc1LWE5ZWMtMzE4MTJhYjQwZTM3cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJIWlNtUmxVS3VKU2sxNUJ6ZEt5UGdzcW90aHA1ZEtYRlVDZmluNi1qVDlNIn0.eyJleHAiOjE2NDE5MDU5NjksImlhdCI6MTY0MTkwNTY2OSwianRpIjoiM2YzZWIxODYtMzE5OC00MzA5LTk5OWItMDZkZTI5ZTMwNzExIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiNTQ3OWU4Y2UtYWIzMC00Mzc1LWE5ZWMtMzE4MTJhYjQwZTM3IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Qo2snvszM0ZptvUZiRHLSSO4nz1K0HwEkVPSMfl64bUpFF7dFqQatXHINmKGObf_HLuTviCYih0aDatO_ipy06Y4tSx-aQoewxxEkeGWRmVOlyiyrp9j-XJN3TfhF57Y_19HdtT3yLszqb0mJeIPLO66K0ls96aqjCfn6YfyylVsBiWomsvHUxklb_mZZG8pJiQ82iyMA9KVgkGo68ujHKEGB8BLP7kfxEgM45fP2DCeuElpkQXJGWVhoQITnrDPYnX1L5RBBl1Sy_HFgupsV5mv6e-qEj8poRZxLJqEYv3n762T5wWyc230vjqeenX7NuDmygQK97M3dJdqg3rVQA, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641905969, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=172.29.0.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.29.0.1, http-session-id=DC38686935BACAEE3ECFAD50C93F9814, http-session-last-accessed-time=1641905685613, kc-category-name=ACCESS, kc-iat=1641905669, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.29.0.1:65292 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 12:54:45.651  INFO 14 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 12:54:45.661  INFO 14 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6e523e11
2022-01-11 12:54:45.666  INFO 14 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6e523e11
2022-01-11 12:54:45.715  INFO 14 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6e523e11
2022-01-11 12:54:45.719  INFO 14 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6e523e11
2022-01-11 12:54:45.762  INFO 14 --- [https-jsse-nio-7071-exec-8] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-4865238458675-965310, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:b90c11d7-db11-4fad-aaae-8c841010ad99:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=b90c11d7-db11-4fad-aaae-8c841010ad99, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time before Shift end, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-11 12:54:45.767  INFO 14 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=ec8fd902-e84b-4a4d-a1b6-54868afd8d02, content=DENY, timestamp=1641905685767, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:b90c11d7-db11-4fad-aaae-8c841010ad99:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=b90c11d7-db11-4fad-aaae-8c841010ad99, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time before Shift end, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-11 12:54:45.771  INFO 14 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=112ms, Total=130ms
2022-01-11 12:54:45.831  INFO 14 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=0782e0cc-0a3d-4d77-ad3f-a4c90f2b3b4e, content=null, timestamp=1641905685814, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=65294, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=eb230e1d0f5c, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.29.0.1, kc-session-state=5479e8ce-ab30-4375-a9ec-31812ab40e37, http-req-server-port=80, http-header-accept=*/*, kc-id=3f3eb186-3198-4309-999b-06de29e30711, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641905685813, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd1/MXNxAH4AEQAAAABh3X4FdAAkM2YzZWIxODYtMzE5OC00MzA5LTk5OWItMDZkZTI5ZTMwNzExdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkNTQ3OWU4Y2UtYWIzMC00Mzc1LWE5ZWMtMzE4MTJhYjQwZTM3cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJIWlNtUmxVS3VKU2sxNUJ6ZEt5UGdzcW90aHA1ZEtYRlVDZmluNi1qVDlNIn0.eyJleHAiOjE2NDE5MDU5NjksImlhdCI6MTY0MTkwNTY2OSwianRpIjoiM2YzZWIxODYtMzE5OC00MzA5LTk5OWItMDZkZTI5ZTMwNzExIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiNTQ3OWU4Y2UtYWIzMC00Mzc1LWE5ZWMtMzE4MTJhYjQwZTM3IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Qo2snvszM0ZptvUZiRHLSSO4nz1K0HwEkVPSMfl64bUpFF7dFqQatXHINmKGObf_HLuTviCYih0aDatO_ipy06Y4tSx-aQoewxxEkeGWRmVOlyiyrp9j-XJN3TfhF57Y_19HdtT3yLszqb0mJeIPLO66K0ls96aqjCfn6YfyylVsBiWomsvHUxklb_mZZG8pJiQ82iyMA9KVgkGo68ujHKEGB8BLP7kfxEgM45fP2DCeuElpkQXJGWVhoQITnrDPYnX1L5RBBl1Sy_HFgupsV5mv6e-qEj8poRZxLJqEYv3n762T5wWyc230vjqeenX7NuDmygQK97M3dJdqg3rVQA, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641905969, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=172.29.0.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.29.0.1, http-session-id=D5F29491D2A29D94F6FB85752336CC0C, http-session-last-accessed-time=1641905685813, kc-category-name=ACCESS, kc-iat=1641905669, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.29.0.1:65294 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 12:54:45.835  INFO 14 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 12:54:45.842  INFO 14 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@78f8f1aa
2022-01-11 12:54:45.846  INFO 14 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@78f8f1aa
2022-01-11 12:54:45.880  INFO 14 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@78f8f1aa
2022-01-11 12:54:45.884  INFO 14 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@78f8f1aa
2022-01-11 12:54:45.918  INFO 14 --- [https-jsse-nio-7071-exec-9] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-4865423303975-301728, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:b90c11d7-db11-4fad-aaae-8c841010ad99:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=b90c11d7-db11-4fad-aaae-8c841010ad99, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time before Shift end, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-11 12:54:45.920  INFO 14 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=0782e0cc-0a3d-4d77-ad3f-a4c90f2b3b4e, content=DENY, timestamp=1641905685920, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:b90c11d7-db11-4fad-aaae-8c841010ad99:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=b90c11d7-db11-4fad-aaae-8c841010ad99, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time before Shift end, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-11 12:54:45.924  INFO 14 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=80ms, Total=94ms
2022-01-11 12:54:45.977  INFO 14 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=3b779e83-b049-4b2a-8541-faa70bd58662, content=null, timestamp=1641905685968, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=65296, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=eb230e1d0f5c, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.29.0.1, kc-session-state=5479e8ce-ab30-4375-a9ec-31812ab40e37, http-req-server-port=80, http-header-accept=*/*, kc-id=3f3eb186-3198-4309-999b-06de29e30711, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641905685965, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd1/MXNxAH4AEQAAAABh3X4FdAAkM2YzZWIxODYtMzE5OC00MzA5LTk5OWItMDZkZTI5ZTMwNzExdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkNTQ3OWU4Y2UtYWIzMC00Mzc1LWE5ZWMtMzE4MTJhYjQwZTM3cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJIWlNtUmxVS3VKU2sxNUJ6ZEt5UGdzcW90aHA1ZEtYRlVDZmluNi1qVDlNIn0.eyJleHAiOjE2NDE5MDU5NjksImlhdCI6MTY0MTkwNTY2OSwianRpIjoiM2YzZWIxODYtMzE5OC00MzA5LTk5OWItMDZkZTI5ZTMwNzExIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiNTQ3OWU4Y2UtYWIzMC00Mzc1LWE5ZWMtMzE4MTJhYjQwZTM3IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Qo2snvszM0ZptvUZiRHLSSO4nz1K0HwEkVPSMfl64bUpFF7dFqQatXHINmKGObf_HLuTviCYih0aDatO_ipy06Y4tSx-aQoewxxEkeGWRmVOlyiyrp9j-XJN3TfhF57Y_19HdtT3yLszqb0mJeIPLO66K0ls96aqjCfn6YfyylVsBiWomsvHUxklb_mZZG8pJiQ82iyMA9KVgkGo68ujHKEGB8BLP7kfxEgM45fP2DCeuElpkQXJGWVhoQITnrDPYnX1L5RBBl1Sy_HFgupsV5mv6e-qEj8poRZxLJqEYv3n762T5wWyc230vjqeenX7NuDmygQK97M3dJdqg3rVQA, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641905969, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=172.29.0.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.29.0.1, http-session-id=B80AE01B447D4933B4EB39759EB6869A, http-session-last-accessed-time=1641905685965, kc-category-name=ACCESS, kc-iat=1641905669, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.29.0.1:65296 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 12:54:45.983  INFO 14 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 12:54:45.989  INFO 14 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@78c67d2
2022-01-11 12:54:45.993  INFO 14 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@78c67d2
2022-01-11 12:54:46.034  INFO 14 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@78c67d2
2022-01-11 12:54:46.038  INFO 14 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@78c67d2
2022-01-11 12:54:46.104  INFO 14 --- [https-jsse-nio-7071-exec-10] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-4865569372875-863032, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:b90c11d7-db11-4fad-aaae-8c841010ad99:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=b90c11d7-db11-4fad-aaae-8c841010ad99, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time before Shift end, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-11 12:54:46.109  INFO 14 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=3b779e83-b049-4b2a-8541-faa70bd58662, content=DENY, timestamp=1641905686109, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:b90c11d7-db11-4fad-aaae-8c841010ad99:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=b90c11d7-db11-4fad-aaae-8c841010ad99, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time before Shift end, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-11 12:54:46.112  INFO 14 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=123ms, Total=137ms
2022-01-11 12:54:46.159  INFO 14 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=7518c023-104b-441f-9381-28c41bda35be, content=null, timestamp=1641905686145, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=65298, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=eb230e1d0f5c, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.29.0.1, kc-session-state=5479e8ce-ab30-4375-a9ec-31812ab40e37, http-req-server-port=80, http-header-accept=*/*, kc-id=3f3eb186-3198-4309-999b-06de29e30711, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641905686144, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd1/MXNxAH4AEQAAAABh3X4FdAAkM2YzZWIxODYtMzE5OC00MzA5LTk5OWItMDZkZTI5ZTMwNzExdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkNTQ3OWU4Y2UtYWIzMC00Mzc1LWE5ZWMtMzE4MTJhYjQwZTM3cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJIWlNtUmxVS3VKU2sxNUJ6ZEt5UGdzcW90aHA1ZEtYRlVDZmluNi1qVDlNIn0.eyJleHAiOjE2NDE5MDU5NjksImlhdCI6MTY0MTkwNTY2OSwianRpIjoiM2YzZWIxODYtMzE5OC00MzA5LTk5OWItMDZkZTI5ZTMwNzExIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiNTQ3OWU4Y2UtYWIzMC00Mzc1LWE5ZWMtMzE4MTJhYjQwZTM3IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Qo2snvszM0ZptvUZiRHLSSO4nz1K0HwEkVPSMfl64bUpFF7dFqQatXHINmKGObf_HLuTviCYih0aDatO_ipy06Y4tSx-aQoewxxEkeGWRmVOlyiyrp9j-XJN3TfhF57Y_19HdtT3yLszqb0mJeIPLO66K0ls96aqjCfn6YfyylVsBiWomsvHUxklb_mZZG8pJiQ82iyMA9KVgkGo68ujHKEGB8BLP7kfxEgM45fP2DCeuElpkQXJGWVhoQITnrDPYnX1L5RBBl1Sy_HFgupsV5mv6e-qEj8poRZxLJqEYv3n762T5wWyc230vjqeenX7NuDmygQK97M3dJdqg3rVQA, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641905969, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=172.29.0.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.29.0.1, http-session-id=4BE260499A2AAAC4ECC1E2FE658A07B2, http-session-last-accessed-time=1641905686144, kc-category-name=ACCESS, kc-iat=1641905669, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.29.0.1:65298 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 12:54:46.164  INFO 14 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 12:54:46.169  INFO 14 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@502c44b7
2022-01-11 12:54:46.175  INFO 14 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@502c44b7
2022-01-11 12:54:46.214  INFO 14 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@502c44b7
2022-01-11 12:54:46.218  INFO 14 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@502c44b7
2022-01-11 12:54:46.256  INFO 14 --- [https-jsse-nio-7071-exec-1] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-4865750282775-21762, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:b90c11d7-db11-4fad-aaae-8c841010ad99:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=b90c11d7-db11-4fad-aaae-8c841010ad99, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time before Shift end, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-11 12:54:46.261  INFO 14 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=7518c023-104b-441f-9381-28c41bda35be, content=DENY, timestamp=1641905686261, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:b90c11d7-db11-4fad-aaae-8c841010ad99:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=b90c11d7-db11-4fad-aaae-8c841010ad99, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time before Shift end, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-11 12:54:46.264  INFO 14 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=94ms, Total=107ms
2022-01-11 12:54:46.313  INFO 14 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=5db08004-d444-435f-8d50-0f76fcc3457f, content=null, timestamp=1641905686294, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=65300, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=eb230e1d0f5c, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.29.0.1, kc-session-state=5479e8ce-ab30-4375-a9ec-31812ab40e37, http-req-server-port=80, http-header-accept=*/*, kc-id=3f3eb186-3198-4309-999b-06de29e30711, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641905686292, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd1/MXNxAH4AEQAAAABh3X4FdAAkM2YzZWIxODYtMzE5OC00MzA5LTk5OWItMDZkZTI5ZTMwNzExdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkNTQ3OWU4Y2UtYWIzMC00Mzc1LWE5ZWMtMzE4MTJhYjQwZTM3cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJIWlNtUmxVS3VKU2sxNUJ6ZEt5UGdzcW90aHA1ZEtYRlVDZmluNi1qVDlNIn0.eyJleHAiOjE2NDE5MDU5NjksImlhdCI6MTY0MTkwNTY2OSwianRpIjoiM2YzZWIxODYtMzE5OC00MzA5LTk5OWItMDZkZTI5ZTMwNzExIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiNTQ3OWU4Y2UtYWIzMC00Mzc1LWE5ZWMtMzE4MTJhYjQwZTM3IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Qo2snvszM0ZptvUZiRHLSSO4nz1K0HwEkVPSMfl64bUpFF7dFqQatXHINmKGObf_HLuTviCYih0aDatO_ipy06Y4tSx-aQoewxxEkeGWRmVOlyiyrp9j-XJN3TfhF57Y_19HdtT3yLszqb0mJeIPLO66K0ls96aqjCfn6YfyylVsBiWomsvHUxklb_mZZG8pJiQ82iyMA9KVgkGo68ujHKEGB8BLP7kfxEgM45fP2DCeuElpkQXJGWVhoQITnrDPYnX1L5RBBl1Sy_HFgupsV5mv6e-qEj8poRZxLJqEYv3n762T5wWyc230vjqeenX7NuDmygQK97M3dJdqg3rVQA, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641905969, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=172.29.0.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.29.0.1, http-session-id=7A16B3D223A1913D770069EC9F1275C6, http-session-last-accessed-time=1641905686292, kc-category-name=ACCESS, kc-iat=1641905669, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.29.0.1:65300 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 12:54:46.317  INFO 14 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 12:54:46.323  INFO 14 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4be8f940
2022-01-11 12:54:46.327  INFO 14 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4be8f940
2022-01-11 12:54:46.348  INFO 14 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4be8f940
2022-01-11 12:54:46.353  INFO 14 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4be8f940
2022-01-11 12:54:46.421  INFO 14 --- [https-jsse-nio-7071-exec-2] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-4865904639575-722447, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:b90c11d7-db11-4fad-aaae-8c841010ad99:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=b90c11d7-db11-4fad-aaae-8c841010ad99, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time before Shift end, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-11 12:54:46.429  INFO 14 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=5db08004-d444-435f-8d50-0f76fcc3457f, content=DENY, timestamp=1641905686428, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:b90c11d7-db11-4fad-aaae-8c841010ad99:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=b90c11d7-db11-4fad-aaae-8c841010ad99, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time before Shift end, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-11 12:54:46.433  INFO 14 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=107ms, Total=120ms
2022-01-11 12:54:46.488  INFO 14 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=4eea57e8-9a3b-4241-9910-f389496cab94, content=null, timestamp=1641905686472, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=65302, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=eb230e1d0f5c, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.29.0.1, kc-session-state=5479e8ce-ab30-4375-a9ec-31812ab40e37, http-req-server-port=80, http-header-accept=*/*, kc-id=3f3eb186-3198-4309-999b-06de29e30711, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641905686464, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd1/MXNxAH4AEQAAAABh3X4FdAAkM2YzZWIxODYtMzE5OC00MzA5LTk5OWItMDZkZTI5ZTMwNzExdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkNTQ3OWU4Y2UtYWIzMC00Mzc1LWE5ZWMtMzE4MTJhYjQwZTM3cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJIWlNtUmxVS3VKU2sxNUJ6ZEt5UGdzcW90aHA1ZEtYRlVDZmluNi1qVDlNIn0.eyJleHAiOjE2NDE5MDU5NjksImlhdCI6MTY0MTkwNTY2OSwianRpIjoiM2YzZWIxODYtMzE5OC00MzA5LTk5OWItMDZkZTI5ZTMwNzExIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiNTQ3OWU4Y2UtYWIzMC00Mzc1LWE5ZWMtMzE4MTJhYjQwZTM3IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Qo2snvszM0ZptvUZiRHLSSO4nz1K0HwEkVPSMfl64bUpFF7dFqQatXHINmKGObf_HLuTviCYih0aDatO_ipy06Y4tSx-aQoewxxEkeGWRmVOlyiyrp9j-XJN3TfhF57Y_19HdtT3yLszqb0mJeIPLO66K0ls96aqjCfn6YfyylVsBiWomsvHUxklb_mZZG8pJiQ82iyMA9KVgkGo68ujHKEGB8BLP7kfxEgM45fP2DCeuElpkQXJGWVhoQITnrDPYnX1L5RBBl1Sy_HFgupsV5mv6e-qEj8poRZxLJqEYv3n762T5wWyc230vjqeenX7NuDmygQK97M3dJdqg3rVQA, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641905969, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=172.29.0.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.29.0.1, http-session-id=4B444AD02DE124D3EB4038F840A27D25, http-session-last-accessed-time=1641905686464, kc-category-name=ACCESS, kc-iat=1641905669, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.29.0.1:65302 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 12:54:46.497  INFO 14 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 12:54:46.513  INFO 14 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1a8112ce
2022-01-11 12:54:46.517  INFO 14 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1a8112ce
2022-01-11 12:54:46.578  INFO 14 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1a8112ce
2022-01-11 12:54:46.581  INFO 14 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1a8112ce
2022-01-11 12:54:46.634  INFO 14 --- [https-jsse-nio-7071-exec-3] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-4866083091075-829514, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:b90c11d7-db11-4fad-aaae-8c841010ad99:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=b90c11d7-db11-4fad-aaae-8c841010ad99, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time before Shift end, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-11 12:54:46.637  INFO 14 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=4eea57e8-9a3b-4241-9910-f389496cab94, content=DENY, timestamp=1641905686637, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:b90c11d7-db11-4fad-aaae-8c841010ad99:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=b90c11d7-db11-4fad-aaae-8c841010ad99, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time before Shift end, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-11 12:54:46.643  INFO 14 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=137ms, Total=157ms
2022-01-11 12:54:46.721  INFO 14 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=1950d535-5696-4946-bbe8-6bd051fb5f02, content=null, timestamp=1641905686697, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=65304, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=eb230e1d0f5c, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.29.0.1, kc-session-state=5479e8ce-ab30-4375-a9ec-31812ab40e37, http-req-server-port=80, http-header-accept=*/*, kc-id=3f3eb186-3198-4309-999b-06de29e30711, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641905686694, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd1/MXNxAH4AEQAAAABh3X4FdAAkM2YzZWIxODYtMzE5OC00MzA5LTk5OWItMDZkZTI5ZTMwNzExdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkNTQ3OWU4Y2UtYWIzMC00Mzc1LWE5ZWMtMzE4MTJhYjQwZTM3cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJIWlNtUmxVS3VKU2sxNUJ6ZEt5UGdzcW90aHA1ZEtYRlVDZmluNi1qVDlNIn0.eyJleHAiOjE2NDE5MDU5NjksImlhdCI6MTY0MTkwNTY2OSwianRpIjoiM2YzZWIxODYtMzE5OC00MzA5LTk5OWItMDZkZTI5ZTMwNzExIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiNTQ3OWU4Y2UtYWIzMC00Mzc1LWE5ZWMtMzE4MTJhYjQwZTM3IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Qo2snvszM0ZptvUZiRHLSSO4nz1K0HwEkVPSMfl64bUpFF7dFqQatXHINmKGObf_HLuTviCYih0aDatO_ipy06Y4tSx-aQoewxxEkeGWRmVOlyiyrp9j-XJN3TfhF57Y_19HdtT3yLszqb0mJeIPLO66K0ls96aqjCfn6YfyylVsBiWomsvHUxklb_mZZG8pJiQ82iyMA9KVgkGo68ujHKEGB8BLP7kfxEgM45fP2DCeuElpkQXJGWVhoQITnrDPYnX1L5RBBl1Sy_HFgupsV5mv6e-qEj8poRZxLJqEYv3n762T5wWyc230vjqeenX7NuDmygQK97M3dJdqg3rVQA, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641905969, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=172.29.0.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.29.0.1, http-session-id=D3FD87A2AEEE3C2A4621C7D2601DEDDF, http-session-last-accessed-time=1641905686694, kc-category-name=ACCESS, kc-iat=1641905669, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.29.0.1:65304 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 12:54:46.742  INFO 14 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 12:54:46.759  INFO 14 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@49a536ee
2022-01-11 12:54:46.767  INFO 14 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@49a536ee
2022-01-11 12:54:46.818  INFO 14 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@49a536ee
2022-01-11 12:54:46.824  INFO 14 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@49a536ee
2022-01-11 12:54:46.862  INFO 14 --- [https-jsse-nio-7071-exec-4] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-4866328025775-787300, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:b90c11d7-db11-4fad-aaae-8c841010ad99:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=b90c11d7-db11-4fad-aaae-8c841010ad99, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time before Shift end, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-11 12:54:46.865  INFO 14 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=1950d535-5696-4946-bbe8-6bd051fb5f02, content=DENY, timestamp=1641905686865, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:b90c11d7-db11-4fad-aaae-8c841010ad99:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=b90c11d7-db11-4fad-aaae-8c841010ad99, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time before Shift end, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-11 12:54:46.869  INFO 14 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=121ms, Total=149ms
2022-01-11 12:54:46.964  INFO 14 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=4469c25c-7f6a-4360-b1eb-5d505bc14c81, content=null, timestamp=1641905686933, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=65306, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=eb230e1d0f5c, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.29.0.1, kc-session-state=5479e8ce-ab30-4375-a9ec-31812ab40e37, http-req-server-port=80, http-header-accept=*/*, kc-id=3f3eb186-3198-4309-999b-06de29e30711, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641905686926, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd1/MXNxAH4AEQAAAABh3X4FdAAkM2YzZWIxODYtMzE5OC00MzA5LTk5OWItMDZkZTI5ZTMwNzExdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkNTQ3OWU4Y2UtYWIzMC00Mzc1LWE5ZWMtMzE4MTJhYjQwZTM3cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJIWlNtUmxVS3VKU2sxNUJ6ZEt5UGdzcW90aHA1ZEtYRlVDZmluNi1qVDlNIn0.eyJleHAiOjE2NDE5MDU5NjksImlhdCI6MTY0MTkwNTY2OSwianRpIjoiM2YzZWIxODYtMzE5OC00MzA5LTk5OWItMDZkZTI5ZTMwNzExIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiNTQ3OWU4Y2UtYWIzMC00Mzc1LWE5ZWMtMzE4MTJhYjQwZTM3IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Qo2snvszM0ZptvUZiRHLSSO4nz1K0HwEkVPSMfl64bUpFF7dFqQatXHINmKGObf_HLuTviCYih0aDatO_ipy06Y4tSx-aQoewxxEkeGWRmVOlyiyrp9j-XJN3TfhF57Y_19HdtT3yLszqb0mJeIPLO66K0ls96aqjCfn6YfyylVsBiWomsvHUxklb_mZZG8pJiQ82iyMA9KVgkGo68ujHKEGB8BLP7kfxEgM45fP2DCeuElpkQXJGWVhoQITnrDPYnX1L5RBBl1Sy_HFgupsV5mv6e-qEj8poRZxLJqEYv3n762T5wWyc230vjqeenX7NuDmygQK97M3dJdqg3rVQA, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641905969, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=172.29.0.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.29.0.1, http-session-id=0E351D17934CCF08B39B612EB6A19550, http-session-last-accessed-time=1641905686926, kc-category-name=ACCESS, kc-iat=1641905669, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.29.0.1:65306 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 12:54:46.974  INFO 14 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 12:54:46.995  INFO 14 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@44eaa434
2022-01-11 12:54:47.004  INFO 14 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@44eaa434
2022-01-11 12:54:47.060  INFO 14 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@44eaa434
2022-01-11 12:54:47.067  INFO 14 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@44eaa434
2022-01-11 12:54:47.163  INFO 14 --- [https-jsse-nio-7071-exec-5] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-4866561091275-448361, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:b90c11d7-db11-4fad-aaae-8c841010ad99:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=b90c11d7-db11-4fad-aaae-8c841010ad99, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time before Shift end, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-11 12:54:47.166  INFO 14 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=4469c25c-7f6a-4360-b1eb-5d505bc14c81, content=DENY, timestamp=1641905687166, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:b90c11d7-db11-4fad-aaae-8c841010ad99:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=b90c11d7-db11-4fad-aaae-8c841010ad99, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time before Shift end, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-11 12:54:47.170  INFO 14 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=188ms, Total=220ms
2022-01-11 12:54:47.220  INFO 14 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=cae2c66c-f87f-45d7-b894-9fcbc196350a, content=null, timestamp=1641905687213, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=65308, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=eb230e1d0f5c, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.29.0.1, kc-session-state=5479e8ce-ab30-4375-a9ec-31812ab40e37, http-req-server-port=80, http-header-accept=*/*, kc-id=3f3eb186-3198-4309-999b-06de29e30711, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641905687211, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd1/MXNxAH4AEQAAAABh3X4FdAAkM2YzZWIxODYtMzE5OC00MzA5LTk5OWItMDZkZTI5ZTMwNzExdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkNTQ3OWU4Y2UtYWIzMC00Mzc1LWE5ZWMtMzE4MTJhYjQwZTM3cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJIWlNtUmxVS3VKU2sxNUJ6ZEt5UGdzcW90aHA1ZEtYRlVDZmluNi1qVDlNIn0.eyJleHAiOjE2NDE5MDU5NjksImlhdCI6MTY0MTkwNTY2OSwianRpIjoiM2YzZWIxODYtMzE5OC00MzA5LTk5OWItMDZkZTI5ZTMwNzExIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiNTQ3OWU4Y2UtYWIzMC00Mzc1LWE5ZWMtMzE4MTJhYjQwZTM3IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Qo2snvszM0ZptvUZiRHLSSO4nz1K0HwEkVPSMfl64bUpFF7dFqQatXHINmKGObf_HLuTviCYih0aDatO_ipy06Y4tSx-aQoewxxEkeGWRmVOlyiyrp9j-XJN3TfhF57Y_19HdtT3yLszqb0mJeIPLO66K0ls96aqjCfn6YfyylVsBiWomsvHUxklb_mZZG8pJiQ82iyMA9KVgkGo68ujHKEGB8BLP7kfxEgM45fP2DCeuElpkQXJGWVhoQITnrDPYnX1L5RBBl1Sy_HFgupsV5mv6e-qEj8poRZxLJqEYv3n762T5wWyc230vjqeenX7NuDmygQK97M3dJdqg3rVQA, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641905969, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=172.29.0.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.29.0.1, http-session-id=612324AB72069DA8C8F9A8EBFFFBA5FD, http-session-last-accessed-time=1641905687211, kc-category-name=ACCESS, kc-iat=1641905669, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.29.0.1:65308 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 12:54:47.225  INFO 14 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 12:54:47.238  INFO 14 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2fd21579
2022-01-11 12:54:47.245  INFO 14 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2fd21579
2022-01-11 12:54:47.289  INFO 14 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2fd21579
2022-01-11 12:54:47.295  INFO 14 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2fd21579
2022-01-11 12:54:47.365  INFO 14 --- [https-jsse-nio-7071-exec-6] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-4866815792775-485564, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:b90c11d7-db11-4fad-aaae-8c841010ad99:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=b90c11d7-db11-4fad-aaae-8c841010ad99, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time before Shift end, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-11 12:54:47.369  INFO 14 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=cae2c66c-f87f-45d7-b894-9fcbc196350a, content=DENY, timestamp=1641905687369, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:b90c11d7-db11-4fad-aaae-8c841010ad99:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=b90c11d7-db11-4fad-aaae-8c841010ad99, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time before Shift end, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-11 12:54:47.380  INFO 14 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=136ms, Total=162ms
2022-01-11 12:54:47.460  INFO 14 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=e8399da2-8bb5-4041-8c9f-396c58ab38c3, content=null, timestamp=1641905687446, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=65310, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=eb230e1d0f5c, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.29.0.1, kc-session-state=5479e8ce-ab30-4375-a9ec-31812ab40e37, http-req-server-port=80, http-header-accept=*/*, kc-id=3f3eb186-3198-4309-999b-06de29e30711, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641905687428, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd1/MXNxAH4AEQAAAABh3X4FdAAkM2YzZWIxODYtMzE5OC00MzA5LTk5OWItMDZkZTI5ZTMwNzExdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkNTQ3OWU4Y2UtYWIzMC00Mzc1LWE5ZWMtMzE4MTJhYjQwZTM3cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJIWlNtUmxVS3VKU2sxNUJ6ZEt5UGdzcW90aHA1ZEtYRlVDZmluNi1qVDlNIn0.eyJleHAiOjE2NDE5MDU5NjksImlhdCI6MTY0MTkwNTY2OSwianRpIjoiM2YzZWIxODYtMzE5OC00MzA5LTk5OWItMDZkZTI5ZTMwNzExIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiNTQ3OWU4Y2UtYWIzMC00Mzc1LWE5ZWMtMzE4MTJhYjQwZTM3IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Qo2snvszM0ZptvUZiRHLSSO4nz1K0HwEkVPSMfl64bUpFF7dFqQatXHINmKGObf_HLuTviCYih0aDatO_ipy06Y4tSx-aQoewxxEkeGWRmVOlyiyrp9j-XJN3TfhF57Y_19HdtT3yLszqb0mJeIPLO66K0ls96aqjCfn6YfyylVsBiWomsvHUxklb_mZZG8pJiQ82iyMA9KVgkGo68ujHKEGB8BLP7kfxEgM45fP2DCeuElpkQXJGWVhoQITnrDPYnX1L5RBBl1Sy_HFgupsV5mv6e-qEj8poRZxLJqEYv3n762T5wWyc230vjqeenX7NuDmygQK97M3dJdqg3rVQA, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641905969, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=172.29.0.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.29.0.1, http-session-id=61F13D71B65BB9F716189CB746C12365, http-session-last-accessed-time=1641905687428, kc-category-name=ACCESS, kc-iat=1641905669, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.29.0.1:65310 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 12:54:47.473  INFO 14 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 12:54:47.481  INFO 14 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@11aec8ee
2022-01-11 12:54:47.483  INFO 14 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@11aec8ee
2022-01-11 12:54:47.558  INFO 14 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@11aec8ee
2022-01-11 12:54:47.562  INFO 14 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@11aec8ee
2022-01-11 12:54:47.624  INFO 14 --- [https-jsse-nio-7071-exec-7] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-4867062554175-191724, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:b90c11d7-db11-4fad-aaae-8c841010ad99:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=b90c11d7-db11-4fad-aaae-8c841010ad99, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time before Shift end, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-11 12:54:47.630  INFO 14 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=e8399da2-8bb5-4041-8c9f-396c58ab38c3, content=DENY, timestamp=1641905687630, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:b90c11d7-db11-4fad-aaae-8c841010ad99:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=b90c11d7-db11-4fad-aaae-8c841010ad99, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time before Shift end, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-11 12:54:47.637  INFO 14 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=151ms, Total=179ms
2022-01-11 12:54:47.691  INFO 14 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=75849f2f-8f04-4dfe-80fb-25b01922b0e3, content=null, timestamp=1641905687682, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=65312, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=eb230e1d0f5c, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.29.0.1, kc-session-state=5479e8ce-ab30-4375-a9ec-31812ab40e37, http-req-server-port=80, http-header-accept=*/*, kc-id=3f3eb186-3198-4309-999b-06de29e30711, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641905687677, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd1/MXNxAH4AEQAAAABh3X4FdAAkM2YzZWIxODYtMzE5OC00MzA5LTk5OWItMDZkZTI5ZTMwNzExdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkNTQ3OWU4Y2UtYWIzMC00Mzc1LWE5ZWMtMzE4MTJhYjQwZTM3cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJIWlNtUmxVS3VKU2sxNUJ6ZEt5UGdzcW90aHA1ZEtYRlVDZmluNi1qVDlNIn0.eyJleHAiOjE2NDE5MDU5NjksImlhdCI6MTY0MTkwNTY2OSwianRpIjoiM2YzZWIxODYtMzE5OC00MzA5LTk5OWItMDZkZTI5ZTMwNzExIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiNTQ3OWU4Y2UtYWIzMC00Mzc1LWE5ZWMtMzE4MTJhYjQwZTM3IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Qo2snvszM0ZptvUZiRHLSSO4nz1K0HwEkVPSMfl64bUpFF7dFqQatXHINmKGObf_HLuTviCYih0aDatO_ipy06Y4tSx-aQoewxxEkeGWRmVOlyiyrp9j-XJN3TfhF57Y_19HdtT3yLszqb0mJeIPLO66K0ls96aqjCfn6YfyylVsBiWomsvHUxklb_mZZG8pJiQ82iyMA9KVgkGo68ujHKEGB8BLP7kfxEgM45fP2DCeuElpkQXJGWVhoQITnrDPYnX1L5RBBl1Sy_HFgupsV5mv6e-qEj8poRZxLJqEYv3n762T5wWyc230vjqeenX7NuDmygQK97M3dJdqg3rVQA, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641905969, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=172.29.0.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.29.0.1, http-session-id=71DF3D3D760E274B5C5E2BC5BD78E28B, http-session-last-accessed-time=1641905687677, kc-category-name=ACCESS, kc-iat=1641905669, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.29.0.1:65312 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 12:54:47.697  INFO 14 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 12:54:47.704  INFO 14 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@ad3f9dc
2022-01-11 12:54:47.707  INFO 14 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@ad3f9dc
2022-01-11 12:54:47.757  INFO 14 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@ad3f9dc
2022-01-11 12:54:47.763  INFO 14 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@ad3f9dc
2022-01-11 12:54:47.860  INFO 14 --- [https-jsse-nio-7071-exec-8] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-4867283786275-7266, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:b90c11d7-db11-4fad-aaae-8c841010ad99:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=b90c11d7-db11-4fad-aaae-8c841010ad99, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time before Shift end, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-11 12:54:47.864  INFO 14 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=75849f2f-8f04-4dfe-80fb-25b01922b0e3, content=DENY, timestamp=1641905687863, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:b90c11d7-db11-4fad-aaae-8c841010ad99:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=b90c11d7-db11-4fad-aaae-8c841010ad99, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time before Shift end, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-11 12:54:47.871  INFO 14 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=163ms, Total=183ms
2022-01-11 12:54:47.927  INFO 14 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=7da2d1b8-29ec-4e08-bb4b-1611b16a3870, content=null, timestamp=1641905687913, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=65314, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=eb230e1d0f5c, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.29.0.1, kc-session-state=5479e8ce-ab30-4375-a9ec-31812ab40e37, http-req-server-port=80, http-header-accept=*/*, kc-id=3f3eb186-3198-4309-999b-06de29e30711, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641905687909, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd1/MXNxAH4AEQAAAABh3X4FdAAkM2YzZWIxODYtMzE5OC00MzA5LTk5OWItMDZkZTI5ZTMwNzExdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkNTQ3OWU4Y2UtYWIzMC00Mzc1LWE5ZWMtMzE4MTJhYjQwZTM3cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJIWlNtUmxVS3VKU2sxNUJ6ZEt5UGdzcW90aHA1ZEtYRlVDZmluNi1qVDlNIn0.eyJleHAiOjE2NDE5MDU5NjksImlhdCI6MTY0MTkwNTY2OSwianRpIjoiM2YzZWIxODYtMzE5OC00MzA5LTk5OWItMDZkZTI5ZTMwNzExIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiNTQ3OWU4Y2UtYWIzMC00Mzc1LWE5ZWMtMzE4MTJhYjQwZTM3IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Qo2snvszM0ZptvUZiRHLSSO4nz1K0HwEkVPSMfl64bUpFF7dFqQatXHINmKGObf_HLuTviCYih0aDatO_ipy06Y4tSx-aQoewxxEkeGWRmVOlyiyrp9j-XJN3TfhF57Y_19HdtT3yLszqb0mJeIPLO66K0ls96aqjCfn6YfyylVsBiWomsvHUxklb_mZZG8pJiQ82iyMA9KVgkGo68ujHKEGB8BLP7kfxEgM45fP2DCeuElpkQXJGWVhoQITnrDPYnX1L5RBBl1Sy_HFgupsV5mv6e-qEj8poRZxLJqEYv3n762T5wWyc230vjqeenX7NuDmygQK97M3dJdqg3rVQA, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641905969, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=172.29.0.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.29.0.1, http-session-id=542B63539DB3AAA88E09D0CF8B057820, http-session-last-accessed-time=1641905687909, kc-category-name=ACCESS, kc-iat=1641905669, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.29.0.1:65314 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 12:54:47.932  INFO 14 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 12:54:47.935  INFO 14 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7b3039c0
2022-01-11 12:54:47.938  INFO 14 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7b3039c0
2022-01-11 12:54:47.991  INFO 14 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7b3039c0
2022-01-11 12:54:47.993  INFO 14 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7b3039c0
2022-01-11 12:54:48.050  INFO 14 --- [https-jsse-nio-7071-exec-9] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-4867517417875-905476, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:b90c11d7-db11-4fad-aaae-8c841010ad99:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=b90c11d7-db11-4fad-aaae-8c841010ad99, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time before Shift end, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-11 12:54:48.056  INFO 14 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=7da2d1b8-29ec-4e08-bb4b-1611b16a3870, content=DENY, timestamp=1641905688056, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:b90c11d7-db11-4fad-aaae-8c841010ad99:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=b90c11d7-db11-4fad-aaae-8c841010ad99, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time before Shift end, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-11 12:54:48.061  INFO 14 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=121ms, Total=137ms
2022-01-11 12:54:48.111  INFO 14 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=55423498-4bb9-49fb-8e98-4ae657f95d04, content=null, timestamp=1641905688102, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=65316, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=eb230e1d0f5c, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.29.0.1, kc-session-state=5479e8ce-ab30-4375-a9ec-31812ab40e37, http-req-server-port=80, http-header-accept=*/*, kc-id=3f3eb186-3198-4309-999b-06de29e30711, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641905688100, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd1/MXNxAH4AEQAAAABh3X4FdAAkM2YzZWIxODYtMzE5OC00MzA5LTk5OWItMDZkZTI5ZTMwNzExdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkNTQ3OWU4Y2UtYWIzMC00Mzc1LWE5ZWMtMzE4MTJhYjQwZTM3cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJIWlNtUmxVS3VKU2sxNUJ6ZEt5UGdzcW90aHA1ZEtYRlVDZmluNi1qVDlNIn0.eyJleHAiOjE2NDE5MDU5NjksImlhdCI6MTY0MTkwNTY2OSwianRpIjoiM2YzZWIxODYtMzE5OC00MzA5LTk5OWItMDZkZTI5ZTMwNzExIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiNTQ3OWU4Y2UtYWIzMC00Mzc1LWE5ZWMtMzE4MTJhYjQwZTM3IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Qo2snvszM0ZptvUZiRHLSSO4nz1K0HwEkVPSMfl64bUpFF7dFqQatXHINmKGObf_HLuTviCYih0aDatO_ipy06Y4tSx-aQoewxxEkeGWRmVOlyiyrp9j-XJN3TfhF57Y_19HdtT3yLszqb0mJeIPLO66K0ls96aqjCfn6YfyylVsBiWomsvHUxklb_mZZG8pJiQ82iyMA9KVgkGo68ujHKEGB8BLP7kfxEgM45fP2DCeuElpkQXJGWVhoQITnrDPYnX1L5RBBl1Sy_HFgupsV5mv6e-qEj8poRZxLJqEYv3n762T5wWyc230vjqeenX7NuDmygQK97M3dJdqg3rVQA, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641905969, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=172.29.0.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.29.0.1, http-session-id=220AFF0F33EE1FA8E6E3F69CEC8CA891, http-session-last-accessed-time=1641905688100, kc-category-name=ACCESS, kc-iat=1641905669, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.29.0.1:65316 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 12:54:48.116  INFO 14 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 12:54:48.120  INFO 14 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@69c69de8
2022-01-11 12:54:48.124  INFO 14 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@69c69de8
2022-01-11 12:54:48.179  INFO 14 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@69c69de8
2022-01-11 12:54:48.181  INFO 14 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@69c69de8
2022-01-11 12:54:48.243  INFO 14 --- [https-jsse-nio-7071-exec-10] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-4867701344575-908169, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:b90c11d7-db11-4fad-aaae-8c841010ad99:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=b90c11d7-db11-4fad-aaae-8c841010ad99, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time before Shift end, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-11 12:54:48.247  INFO 14 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=55423498-4bb9-49fb-8e98-4ae657f95d04, content=DENY, timestamp=1641905688247, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:b90c11d7-db11-4fad-aaae-8c841010ad99:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=b90c11d7-db11-4fad-aaae-8c841010ad99, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time before Shift end, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-11 12:54:48.249  INFO 14 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=129ms, Total=140ms
2022-01-11 12:54:48.321  INFO 14 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=1f39b934-e3ba-4c36-ae0f-1815cb9ebe14, content=null, timestamp=1641905688300, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=65318, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=eb230e1d0f5c, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.29.0.1, kc-session-state=5479e8ce-ab30-4375-a9ec-31812ab40e37, http-req-server-port=80, http-header-accept=*/*, kc-id=3f3eb186-3198-4309-999b-06de29e30711, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641905688295, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd1/MXNxAH4AEQAAAABh3X4FdAAkM2YzZWIxODYtMzE5OC00MzA5LTk5OWItMDZkZTI5ZTMwNzExdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkNTQ3OWU4Y2UtYWIzMC00Mzc1LWE5ZWMtMzE4MTJhYjQwZTM3cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJIWlNtUmxVS3VKU2sxNUJ6ZEt5UGdzcW90aHA1ZEtYRlVDZmluNi1qVDlNIn0.eyJleHAiOjE2NDE5MDU5NjksImlhdCI6MTY0MTkwNTY2OSwianRpIjoiM2YzZWIxODYtMzE5OC00MzA5LTk5OWItMDZkZTI5ZTMwNzExIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiNTQ3OWU4Y2UtYWIzMC00Mzc1LWE5ZWMtMzE4MTJhYjQwZTM3IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Qo2snvszM0ZptvUZiRHLSSO4nz1K0HwEkVPSMfl64bUpFF7dFqQatXHINmKGObf_HLuTviCYih0aDatO_ipy06Y4tSx-aQoewxxEkeGWRmVOlyiyrp9j-XJN3TfhF57Y_19HdtT3yLszqb0mJeIPLO66K0ls96aqjCfn6YfyylVsBiWomsvHUxklb_mZZG8pJiQ82iyMA9KVgkGo68ujHKEGB8BLP7kfxEgM45fP2DCeuElpkQXJGWVhoQITnrDPYnX1L5RBBl1Sy_HFgupsV5mv6e-qEj8poRZxLJqEYv3n762T5wWyc230vjqeenX7NuDmygQK97M3dJdqg3rVQA, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641905969, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=172.29.0.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.29.0.1, http-session-id=5E47798E2C3E24F4126F64EA7A92C3DE, http-session-last-accessed-time=1641905688295, kc-category-name=ACCESS, kc-iat=1641905669, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.29.0.1:65318 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 12:54:48.326  INFO 14 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 12:54:48.337  INFO 14 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@20a62f04
2022-01-11 12:54:48.345  INFO 14 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@20a62f04
2022-01-11 12:54:48.383  INFO 14 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@20a62f04
2022-01-11 12:54:48.388  INFO 14 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@20a62f04
2022-01-11 12:54:48.468  INFO 14 --- [https-jsse-nio-7071-exec-1] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-4867913510475-768441, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:b90c11d7-db11-4fad-aaae-8c841010ad99:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=b90c11d7-db11-4fad-aaae-8c841010ad99, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time before Shift end, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-11 12:54:48.474  INFO 14 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=1f39b934-e3ba-4c36-ae0f-1815cb9ebe14, content=DENY, timestamp=1641905688474, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:b90c11d7-db11-4fad-aaae-8c841010ad99:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=b90c11d7-db11-4fad-aaae-8c841010ad99, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time before Shift end, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-11 12:54:48.478  INFO 14 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=144ms, Total=158ms
2022-01-11 12:54:48.525  INFO 14 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=32261301-7498-4f36-914c-ecd34d65ab69, content=null, timestamp=1641905688512, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=65320, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=eb230e1d0f5c, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.29.0.1, kc-session-state=5479e8ce-ab30-4375-a9ec-31812ab40e37, http-req-server-port=80, http-header-accept=*/*, kc-id=3f3eb186-3198-4309-999b-06de29e30711, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641905688511, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd1/MXNxAH4AEQAAAABh3X4FdAAkM2YzZWIxODYtMzE5OC00MzA5LTk5OWItMDZkZTI5ZTMwNzExdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkNTQ3OWU4Y2UtYWIzMC00Mzc1LWE5ZWMtMzE4MTJhYjQwZTM3cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJIWlNtUmxVS3VKU2sxNUJ6ZEt5UGdzcW90aHA1ZEtYRlVDZmluNi1qVDlNIn0.eyJleHAiOjE2NDE5MDU5NjksImlhdCI6MTY0MTkwNTY2OSwianRpIjoiM2YzZWIxODYtMzE5OC00MzA5LTk5OWItMDZkZTI5ZTMwNzExIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiNTQ3OWU4Y2UtYWIzMC00Mzc1LWE5ZWMtMzE4MTJhYjQwZTM3IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Qo2snvszM0ZptvUZiRHLSSO4nz1K0HwEkVPSMfl64bUpFF7dFqQatXHINmKGObf_HLuTviCYih0aDatO_ipy06Y4tSx-aQoewxxEkeGWRmVOlyiyrp9j-XJN3TfhF57Y_19HdtT3yLszqb0mJeIPLO66K0ls96aqjCfn6YfyylVsBiWomsvHUxklb_mZZG8pJiQ82iyMA9KVgkGo68ujHKEGB8BLP7kfxEgM45fP2DCeuElpkQXJGWVhoQITnrDPYnX1L5RBBl1Sy_HFgupsV5mv6e-qEj8poRZxLJqEYv3n762T5wWyc230vjqeenX7NuDmygQK97M3dJdqg3rVQA, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641905969, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=172.29.0.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.29.0.1, http-session-id=891ED58401CCC27ED806D87356CFC6F4, http-session-last-accessed-time=1641905688511, kc-category-name=ACCESS, kc-iat=1641905669, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.29.0.1:65320 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 12:54:48.531  INFO 14 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 12:54:48.537  INFO 14 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@c88b8d3
2022-01-11 12:54:48.540  INFO 14 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@c88b8d3
2022-01-11 12:54:48.567  INFO 14 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@c88b8d3
2022-01-11 12:54:48.570  INFO 14 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@c88b8d3
2022-01-11 12:54:48.618  INFO 14 --- [https-jsse-nio-7071-exec-2] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-4868116799075-218849, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:b90c11d7-db11-4fad-aaae-8c841010ad99:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=b90c11d7-db11-4fad-aaae-8c841010ad99, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time before Shift end, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-11 12:54:48.622  INFO 14 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=32261301-7498-4f36-914c-ecd34d65ab69, content=DENY, timestamp=1641905688622, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:b90c11d7-db11-4fad-aaae-8c841010ad99:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=b90c11d7-db11-4fad-aaae-8c841010ad99, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time before Shift end, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-11 12:54:48.625  INFO 14 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=89ms, Total=101ms
2022-01-11 12:54:48.685  INFO 14 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=4a20d945-3cb2-4906-a5dc-79e83910adbf, content=null, timestamp=1641905688677, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=65322, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=eb230e1d0f5c, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.29.0.1, kc-session-state=5479e8ce-ab30-4375-a9ec-31812ab40e37, http-req-server-port=80, http-header-accept=*/*, kc-id=3f3eb186-3198-4309-999b-06de29e30711, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641905688676, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd1/MXNxAH4AEQAAAABh3X4FdAAkM2YzZWIxODYtMzE5OC00MzA5LTk5OWItMDZkZTI5ZTMwNzExdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkNTQ3OWU4Y2UtYWIzMC00Mzc1LWE5ZWMtMzE4MTJhYjQwZTM3cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJIWlNtUmxVS3VKU2sxNUJ6ZEt5UGdzcW90aHA1ZEtYRlVDZmluNi1qVDlNIn0.eyJleHAiOjE2NDE5MDU5NjksImlhdCI6MTY0MTkwNTY2OSwianRpIjoiM2YzZWIxODYtMzE5OC00MzA5LTk5OWItMDZkZTI5ZTMwNzExIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiNTQ3OWU4Y2UtYWIzMC00Mzc1LWE5ZWMtMzE4MTJhYjQwZTM3IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Qo2snvszM0ZptvUZiRHLSSO4nz1K0HwEkVPSMfl64bUpFF7dFqQatXHINmKGObf_HLuTviCYih0aDatO_ipy06Y4tSx-aQoewxxEkeGWRmVOlyiyrp9j-XJN3TfhF57Y_19HdtT3yLszqb0mJeIPLO66K0ls96aqjCfn6YfyylVsBiWomsvHUxklb_mZZG8pJiQ82iyMA9KVgkGo68ujHKEGB8BLP7kfxEgM45fP2DCeuElpkQXJGWVhoQITnrDPYnX1L5RBBl1Sy_HFgupsV5mv6e-qEj8poRZxLJqEYv3n762T5wWyc230vjqeenX7NuDmygQK97M3dJdqg3rVQA, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641905969, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=172.29.0.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.29.0.1, http-session-id=F5285199D068C3038426D8FA2F356150, http-session-last-accessed-time=1641905688676, kc-category-name=ACCESS, kc-iat=1641905669, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.29.0.1:65322 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 12:54:48.698  INFO 14 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 12:54:48.707  INFO 14 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@72d8195b
2022-01-11 12:54:48.710  INFO 14 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@72d8195b
2022-01-11 12:54:48.741  INFO 14 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@72d8195b
2022-01-11 12:54:48.748  INFO 14 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@72d8195b
2022-01-11 12:54:48.831  INFO 14 --- [https-jsse-nio-7071-exec-3] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-4868287714275-463475, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:b90c11d7-db11-4fad-aaae-8c841010ad99:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=b90c11d7-db11-4fad-aaae-8c841010ad99, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time before Shift end, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-11 12:54:48.839  INFO 14 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=4a20d945-3cb2-4906-a5dc-79e83910adbf, content=DENY, timestamp=1641905688839, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:b90c11d7-db11-4fad-aaae-8c841010ad99:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=b90c11d7-db11-4fad-aaae-8c841010ad99, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time before Shift end, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-11 12:54:48.843  INFO 14 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=135ms, Total=161ms
2022-01-11 12:54:48.890  INFO 14 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=4d646244-6d69-497b-9adc-19f88565656b, content=null, timestamp=1641905688883, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=65324, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=eb230e1d0f5c, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.29.0.1, kc-session-state=5479e8ce-ab30-4375-a9ec-31812ab40e37, http-req-server-port=80, http-header-accept=*/*, kc-id=3f3eb186-3198-4309-999b-06de29e30711, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641905688880, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd1/MXNxAH4AEQAAAABh3X4FdAAkM2YzZWIxODYtMzE5OC00MzA5LTk5OWItMDZkZTI5ZTMwNzExdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkNTQ3OWU4Y2UtYWIzMC00Mzc1LWE5ZWMtMzE4MTJhYjQwZTM3cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJIWlNtUmxVS3VKU2sxNUJ6ZEt5UGdzcW90aHA1ZEtYRlVDZmluNi1qVDlNIn0.eyJleHAiOjE2NDE5MDU5NjksImlhdCI6MTY0MTkwNTY2OSwianRpIjoiM2YzZWIxODYtMzE5OC00MzA5LTk5OWItMDZkZTI5ZTMwNzExIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiNTQ3OWU4Y2UtYWIzMC00Mzc1LWE5ZWMtMzE4MTJhYjQwZTM3IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Qo2snvszM0ZptvUZiRHLSSO4nz1K0HwEkVPSMfl64bUpFF7dFqQatXHINmKGObf_HLuTviCYih0aDatO_ipy06Y4tSx-aQoewxxEkeGWRmVOlyiyrp9j-XJN3TfhF57Y_19HdtT3yLszqb0mJeIPLO66K0ls96aqjCfn6YfyylVsBiWomsvHUxklb_mZZG8pJiQ82iyMA9KVgkGo68ujHKEGB8BLP7kfxEgM45fP2DCeuElpkQXJGWVhoQITnrDPYnX1L5RBBl1Sy_HFgupsV5mv6e-qEj8poRZxLJqEYv3n762T5wWyc230vjqeenX7NuDmygQK97M3dJdqg3rVQA, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641905969, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=172.29.0.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.29.0.1, http-session-id=03BDD310C0937FBCF14FC020CF047F83, http-session-last-accessed-time=1641905688880, kc-category-name=ACCESS, kc-iat=1641905669, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.29.0.1:65324 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 12:54:48.895  INFO 14 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 12:54:48.905  INFO 14 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@53ac2a30
2022-01-11 12:54:48.909  INFO 14 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@53ac2a30
2022-01-11 12:54:48.945  INFO 14 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@53ac2a30
2022-01-11 12:54:48.951  INFO 14 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@53ac2a30
2022-01-11 12:54:48.978  INFO 14 --- [https-jsse-nio-7071-exec-4] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-4868483411875-412481, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:b90c11d7-db11-4fad-aaae-8c841010ad99:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=b90c11d7-db11-4fad-aaae-8c841010ad99, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time before Shift end, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-11 12:54:48.980  INFO 14 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=4d646244-6d69-497b-9adc-19f88565656b, content=DENY, timestamp=1641905688980, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:b90c11d7-db11-4fad-aaae-8c841010ad99:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=b90c11d7-db11-4fad-aaae-8c841010ad99, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time before Shift end, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-11 12:54:48.985  INFO 14 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=80ms, Total=97ms
2022-01-11 12:54:49.046  INFO 14 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=e8d7c0be-f076-45c2-b278-715da042de65, content=null, timestamp=1641905689037, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=65326, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=eb230e1d0f5c, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.29.0.1, kc-session-state=5479e8ce-ab30-4375-a9ec-31812ab40e37, http-req-server-port=80, http-header-accept=*/*, kc-id=3f3eb186-3198-4309-999b-06de29e30711, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641905689031, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd1/MXNxAH4AEQAAAABh3X4FdAAkM2YzZWIxODYtMzE5OC00MzA5LTk5OWItMDZkZTI5ZTMwNzExdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkNTQ3OWU4Y2UtYWIzMC00Mzc1LWE5ZWMtMzE4MTJhYjQwZTM3cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJIWlNtUmxVS3VKU2sxNUJ6ZEt5UGdzcW90aHA1ZEtYRlVDZmluNi1qVDlNIn0.eyJleHAiOjE2NDE5MDU5NjksImlhdCI6MTY0MTkwNTY2OSwianRpIjoiM2YzZWIxODYtMzE5OC00MzA5LTk5OWItMDZkZTI5ZTMwNzExIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiNTQ3OWU4Y2UtYWIzMC00Mzc1LWE5ZWMtMzE4MTJhYjQwZTM3IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Qo2snvszM0ZptvUZiRHLSSO4nz1K0HwEkVPSMfl64bUpFF7dFqQatXHINmKGObf_HLuTviCYih0aDatO_ipy06Y4tSx-aQoewxxEkeGWRmVOlyiyrp9j-XJN3TfhF57Y_19HdtT3yLszqb0mJeIPLO66K0ls96aqjCfn6YfyylVsBiWomsvHUxklb_mZZG8pJiQ82iyMA9KVgkGo68ujHKEGB8BLP7kfxEgM45fP2DCeuElpkQXJGWVhoQITnrDPYnX1L5RBBl1Sy_HFgupsV5mv6e-qEj8poRZxLJqEYv3n762T5wWyc230vjqeenX7NuDmygQK97M3dJdqg3rVQA, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641905969, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=172.29.0.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.29.0.1, http-session-id=95EF388AEAC9A1D5F35784D6EB36C2B6, http-session-last-accessed-time=1641905689031, kc-category-name=ACCESS, kc-iat=1641905669, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.29.0.1:65326 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 12:54:49.052  INFO 14 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 12:54:49.059  INFO 14 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5000369
2022-01-11 12:54:49.062  INFO 14 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5000369
2022-01-11 12:54:49.081  INFO 14 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5000369
2022-01-11 12:54:49.084  INFO 14 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5000369
2022-01-11 12:54:49.167  INFO 14 --- [https-jsse-nio-7071-exec-5] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-4868640665675-741674, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:b90c11d7-db11-4fad-aaae-8c841010ad99:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=b90c11d7-db11-4fad-aaae-8c841010ad99, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time before Shift end, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-11 12:54:49.169  INFO 14 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=e8d7c0be-f076-45c2-b278-715da042de65, content=DENY, timestamp=1641905689169, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:b90c11d7-db11-4fad-aaae-8c841010ad99:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=b90c11d7-db11-4fad-aaae-8c841010ad99, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time before Shift end, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-11 12:54:49.173  INFO 14 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=112ms, Total=129ms
2022-01-11 12:54:49.241  INFO 14 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=d35f77df-7024-426d-85fd-ae4c56e348f5, content=null, timestamp=1641905689208, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=65328, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=eb230e1d0f5c, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.29.0.1, kc-session-state=5479e8ce-ab30-4375-a9ec-31812ab40e37, http-req-server-port=80, http-header-accept=*/*, kc-id=3f3eb186-3198-4309-999b-06de29e30711, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641905689205, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd1/MXNxAH4AEQAAAABh3X4FdAAkM2YzZWIxODYtMzE5OC00MzA5LTk5OWItMDZkZTI5ZTMwNzExdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkNTQ3OWU4Y2UtYWIzMC00Mzc1LWE5ZWMtMzE4MTJhYjQwZTM3cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJIWlNtUmxVS3VKU2sxNUJ6ZEt5UGdzcW90aHA1ZEtYRlVDZmluNi1qVDlNIn0.eyJleHAiOjE2NDE5MDU5NjksImlhdCI6MTY0MTkwNTY2OSwianRpIjoiM2YzZWIxODYtMzE5OC00MzA5LTk5OWItMDZkZTI5ZTMwNzExIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiNTQ3OWU4Y2UtYWIzMC00Mzc1LWE5ZWMtMzE4MTJhYjQwZTM3IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Qo2snvszM0ZptvUZiRHLSSO4nz1K0HwEkVPSMfl64bUpFF7dFqQatXHINmKGObf_HLuTviCYih0aDatO_ipy06Y4tSx-aQoewxxEkeGWRmVOlyiyrp9j-XJN3TfhF57Y_19HdtT3yLszqb0mJeIPLO66K0ls96aqjCfn6YfyylVsBiWomsvHUxklb_mZZG8pJiQ82iyMA9KVgkGo68ujHKEGB8BLP7kfxEgM45fP2DCeuElpkQXJGWVhoQITnrDPYnX1L5RBBl1Sy_HFgupsV5mv6e-qEj8poRZxLJqEYv3n762T5wWyc230vjqeenX7NuDmygQK97M3dJdqg3rVQA, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641905969, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=172.29.0.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.29.0.1, http-session-id=3068DFE58AA2993FF2319DB1505AB69B, http-session-last-accessed-time=1641905689205, kc-category-name=ACCESS, kc-iat=1641905669, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.29.0.1:65328 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 12:54:49.249  INFO 14 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 12:54:49.266  INFO 14 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1e7d3d61
2022-01-11 12:54:49.276  INFO 14 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1e7d3d61
2022-01-11 12:54:49.336  INFO 14 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1e7d3d61
2022-01-11 12:54:49.339  INFO 14 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1e7d3d61
2022-01-11 12:54:49.386  INFO 14 --- [https-jsse-nio-7071-exec-6] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-4868836827675-730121, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:b90c11d7-db11-4fad-aaae-8c841010ad99:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=b90c11d7-db11-4fad-aaae-8c841010ad99, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time before Shift end, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-11 12:54:49.389  INFO 14 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=d35f77df-7024-426d-85fd-ae4c56e348f5, content=DENY, timestamp=1641905689389, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:b90c11d7-db11-4fad-aaae-8c841010ad99:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=b90c11d7-db11-4fad-aaae-8c841010ad99, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time before Shift end, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-11 12:54:49.394  INFO 14 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=136ms, Total=156ms
2022-01-11 12:54:49.451  INFO 14 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=66e88e6e-f2b7-4722-9aac-3e6dc53dc421, content=null, timestamp=1641905689440, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=65330, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=eb230e1d0f5c, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.29.0.1, kc-session-state=5479e8ce-ab30-4375-a9ec-31812ab40e37, http-req-server-port=80, http-header-accept=*/*, kc-id=3f3eb186-3198-4309-999b-06de29e30711, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641905689436, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd1/MXNxAH4AEQAAAABh3X4FdAAkM2YzZWIxODYtMzE5OC00MzA5LTk5OWItMDZkZTI5ZTMwNzExdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkNTQ3OWU4Y2UtYWIzMC00Mzc1LWE5ZWMtMzE4MTJhYjQwZTM3cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJIWlNtUmxVS3VKU2sxNUJ6ZEt5UGdzcW90aHA1ZEtYRlVDZmluNi1qVDlNIn0.eyJleHAiOjE2NDE5MDU5NjksImlhdCI6MTY0MTkwNTY2OSwianRpIjoiM2YzZWIxODYtMzE5OC00MzA5LTk5OWItMDZkZTI5ZTMwNzExIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiNTQ3OWU4Y2UtYWIzMC00Mzc1LWE5ZWMtMzE4MTJhYjQwZTM3IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Qo2snvszM0ZptvUZiRHLSSO4nz1K0HwEkVPSMfl64bUpFF7dFqQatXHINmKGObf_HLuTviCYih0aDatO_ipy06Y4tSx-aQoewxxEkeGWRmVOlyiyrp9j-XJN3TfhF57Y_19HdtT3yLszqb0mJeIPLO66K0ls96aqjCfn6YfyylVsBiWomsvHUxklb_mZZG8pJiQ82iyMA9KVgkGo68ujHKEGB8BLP7kfxEgM45fP2DCeuElpkQXJGWVhoQITnrDPYnX1L5RBBl1Sy_HFgupsV5mv6e-qEj8poRZxLJqEYv3n762T5wWyc230vjqeenX7NuDmygQK97M3dJdqg3rVQA, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641905969, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=172.29.0.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.29.0.1, http-session-id=7558EAA9E1C6612AB7A2B78EE02B0948, http-session-last-accessed-time=1641905689436, kc-category-name=ACCESS, kc-iat=1641905669, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.29.0.1:65330 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 12:54:49.457  INFO 14 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 12:54:49.462  INFO 14 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3684058d
2022-01-11 12:54:49.464  INFO 14 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3684058d
2022-01-11 12:54:49.503  INFO 14 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3684058d
2022-01-11 12:54:49.506  INFO 14 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3684058d
2022-01-11 12:54:49.543  INFO 14 --- [https-jsse-nio-7071-exec-7] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-4869043379675-231346, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:b90c11d7-db11-4fad-aaae-8c841010ad99:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=b90c11d7-db11-4fad-aaae-8c841010ad99, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time before Shift end, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-11 12:54:49.546  INFO 14 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=66e88e6e-f2b7-4722-9aac-3e6dc53dc421, content=DENY, timestamp=1641905689546, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:b90c11d7-db11-4fad-aaae-8c841010ad99:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=b90c11d7-db11-4fad-aaae-8c841010ad99, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time before Shift end, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-11 12:54:49.549  INFO 14 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=86ms, Total=100ms
2022-01-11 12:54:49.597  INFO 14 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=2330f6fe-3961-4f9e-8a23-7284728af52c, content=null, timestamp=1641905689587, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=65332, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=eb230e1d0f5c, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.29.0.1, kc-session-state=5479e8ce-ab30-4375-a9ec-31812ab40e37, http-req-server-port=80, http-header-accept=*/*, kc-id=3f3eb186-3198-4309-999b-06de29e30711, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641905689584, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd1/MXNxAH4AEQAAAABh3X4FdAAkM2YzZWIxODYtMzE5OC00MzA5LTk5OWItMDZkZTI5ZTMwNzExdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkNTQ3OWU4Y2UtYWIzMC00Mzc1LWE5ZWMtMzE4MTJhYjQwZTM3cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJIWlNtUmxVS3VKU2sxNUJ6ZEt5UGdzcW90aHA1ZEtYRlVDZmluNi1qVDlNIn0.eyJleHAiOjE2NDE5MDU5NjksImlhdCI6MTY0MTkwNTY2OSwianRpIjoiM2YzZWIxODYtMzE5OC00MzA5LTk5OWItMDZkZTI5ZTMwNzExIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiNTQ3OWU4Y2UtYWIzMC00Mzc1LWE5ZWMtMzE4MTJhYjQwZTM3IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Qo2snvszM0ZptvUZiRHLSSO4nz1K0HwEkVPSMfl64bUpFF7dFqQatXHINmKGObf_HLuTviCYih0aDatO_ipy06Y4tSx-aQoewxxEkeGWRmVOlyiyrp9j-XJN3TfhF57Y_19HdtT3yLszqb0mJeIPLO66K0ls96aqjCfn6YfyylVsBiWomsvHUxklb_mZZG8pJiQ82iyMA9KVgkGo68ujHKEGB8BLP7kfxEgM45fP2DCeuElpkQXJGWVhoQITnrDPYnX1L5RBBl1Sy_HFgupsV5mv6e-qEj8poRZxLJqEYv3n762T5wWyc230vjqeenX7NuDmygQK97M3dJdqg3rVQA, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641905969, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=172.29.0.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.29.0.1, http-session-id=380B610246F0B0B99D9C8B8DD75EE814, http-session-last-accessed-time=1641905689584, kc-category-name=ACCESS, kc-iat=1641905669, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.29.0.1:65332 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 12:54:49.602  INFO 14 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 12:54:49.607  INFO 14 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@17acdf0b
2022-01-11 12:54:49.610  INFO 14 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@17acdf0b
2022-01-11 12:54:49.683  INFO 14 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@17acdf0b
2022-01-11 12:54:49.685  INFO 14 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@17acdf0b
2022-01-11 12:54:49.714  INFO 14 --- [https-jsse-nio-7071-exec-8] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-4869187685375-50167, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:b90c11d7-db11-4fad-aaae-8c841010ad99:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=b90c11d7-db11-4fad-aaae-8c841010ad99, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time before Shift end, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-11 12:54:49.719  INFO 14 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=2330f6fe-3961-4f9e-8a23-7284728af52c, content=DENY, timestamp=1641905689719, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:b90c11d7-db11-4fad-aaae-8c841010ad99:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=b90c11d7-db11-4fad-aaae-8c841010ad99, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time before Shift end, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-11 12:54:49.724  INFO 14 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=114ms, Total=129ms
2022-01-11 12:54:49.766  INFO 14 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=d2957f1a-523a-41c8-b1aa-c6aec346f0e3, content=null, timestamp=1641905689757, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=65334, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=eb230e1d0f5c, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.29.0.1, kc-session-state=5479e8ce-ab30-4375-a9ec-31812ab40e37, http-req-server-port=80, http-header-accept=*/*, kc-id=3f3eb186-3198-4309-999b-06de29e30711, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641905689755, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd1/MXNxAH4AEQAAAABh3X4FdAAkM2YzZWIxODYtMzE5OC00MzA5LTk5OWItMDZkZTI5ZTMwNzExdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkNTQ3OWU4Y2UtYWIzMC00Mzc1LWE5ZWMtMzE4MTJhYjQwZTM3cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJIWlNtUmxVS3VKU2sxNUJ6ZEt5UGdzcW90aHA1ZEtYRlVDZmluNi1qVDlNIn0.eyJleHAiOjE2NDE5MDU5NjksImlhdCI6MTY0MTkwNTY2OSwianRpIjoiM2YzZWIxODYtMzE5OC00MzA5LTk5OWItMDZkZTI5ZTMwNzExIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiNTQ3OWU4Y2UtYWIzMC00Mzc1LWE5ZWMtMzE4MTJhYjQwZTM3IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Qo2snvszM0ZptvUZiRHLSSO4nz1K0HwEkVPSMfl64bUpFF7dFqQatXHINmKGObf_HLuTviCYih0aDatO_ipy06Y4tSx-aQoewxxEkeGWRmVOlyiyrp9j-XJN3TfhF57Y_19HdtT3yLszqb0mJeIPLO66K0ls96aqjCfn6YfyylVsBiWomsvHUxklb_mZZG8pJiQ82iyMA9KVgkGo68ujHKEGB8BLP7kfxEgM45fP2DCeuElpkQXJGWVhoQITnrDPYnX1L5RBBl1Sy_HFgupsV5mv6e-qEj8poRZxLJqEYv3n762T5wWyc230vjqeenX7NuDmygQK97M3dJdqg3rVQA, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641905969, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=172.29.0.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.29.0.1, http-session-id=E6025AA86B904A0AF054DD0ACA9D1EE2, http-session-last-accessed-time=1641905689755, kc-category-name=ACCESS, kc-iat=1641905669, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.29.0.1:65334 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 12:54:49.769  INFO 14 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 12:54:49.774  INFO 14 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5ddc4456
2022-01-11 12:54:49.781  INFO 14 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5ddc4456
2022-01-11 12:54:49.811  INFO 14 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5ddc4456
2022-01-11 12:54:49.815  INFO 14 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5ddc4456
2022-01-11 12:54:49.850  INFO 14 --- [https-jsse-nio-7071-exec-9] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-4869355059875-395046, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:b90c11d7-db11-4fad-aaae-8c841010ad99:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=b90c11d7-db11-4fad-aaae-8c841010ad99, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time before Shift end, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-11 12:54:49.853  INFO 14 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=d2957f1a-523a-41c8-b1aa-c6aec346f0e3, content=DENY, timestamp=1641905689853, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:b90c11d7-db11-4fad-aaae-8c841010ad99:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=b90c11d7-db11-4fad-aaae-8c841010ad99, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time before Shift end, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-11 12:54:49.856  INFO 14 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=81ms, Total=92ms
2022-01-11 12:54:49.926  INFO 14 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=7447e801-b20f-477f-99ac-039d9fe951e1, content=null, timestamp=1641905689916, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=65336, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=eb230e1d0f5c, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.29.0.1, kc-session-state=5479e8ce-ab30-4375-a9ec-31812ab40e37, http-req-server-port=80, http-header-accept=*/*, kc-id=3f3eb186-3198-4309-999b-06de29e30711, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641905689911, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd1/MXNxAH4AEQAAAABh3X4FdAAkM2YzZWIxODYtMzE5OC00MzA5LTk5OWItMDZkZTI5ZTMwNzExdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkNTQ3OWU4Y2UtYWIzMC00Mzc1LWE5ZWMtMzE4MTJhYjQwZTM3cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJIWlNtUmxVS3VKU2sxNUJ6ZEt5UGdzcW90aHA1ZEtYRlVDZmluNi1qVDlNIn0.eyJleHAiOjE2NDE5MDU5NjksImlhdCI6MTY0MTkwNTY2OSwianRpIjoiM2YzZWIxODYtMzE5OC00MzA5LTk5OWItMDZkZTI5ZTMwNzExIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiNTQ3OWU4Y2UtYWIzMC00Mzc1LWE5ZWMtMzE4MTJhYjQwZTM3IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Qo2snvszM0ZptvUZiRHLSSO4nz1K0HwEkVPSMfl64bUpFF7dFqQatXHINmKGObf_HLuTviCYih0aDatO_ipy06Y4tSx-aQoewxxEkeGWRmVOlyiyrp9j-XJN3TfhF57Y_19HdtT3yLszqb0mJeIPLO66K0ls96aqjCfn6YfyylVsBiWomsvHUxklb_mZZG8pJiQ82iyMA9KVgkGo68ujHKEGB8BLP7kfxEgM45fP2DCeuElpkQXJGWVhoQITnrDPYnX1L5RBBl1Sy_HFgupsV5mv6e-qEj8poRZxLJqEYv3n762T5wWyc230vjqeenX7NuDmygQK97M3dJdqg3rVQA, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641905969, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=172.29.0.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.29.0.1, http-session-id=6A44A31FAB30BBA9052A887CE3223F86, http-session-last-accessed-time=1641905689911, kc-category-name=ACCESS, kc-iat=1641905669, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.29.0.1:65336 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 12:54:49.934  INFO 14 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 12:54:49.940  INFO 14 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4435ffe3
2022-01-11 12:54:49.944  INFO 14 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4435ffe3
2022-01-11 12:54:49.973  INFO 14 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4435ffe3
2022-01-11 12:54:49.980  INFO 14 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4435ffe3
2022-01-11 12:54:50.055  INFO 14 --- [https-jsse-nio-7071-exec-10] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-4869520565075-67354, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:b90c11d7-db11-4fad-aaae-8c841010ad99:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=b90c11d7-db11-4fad-aaae-8c841010ad99, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time before Shift end, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-11 12:54:50.058  INFO 14 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=7447e801-b20f-477f-99ac-039d9fe951e1, content=DENY, timestamp=1641905690058, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:b90c11d7-db11-4fad-aaae-8c841010ad99:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=b90c11d7-db11-4fad-aaae-8c841010ad99, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time before Shift end, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-11 12:54:50.065  INFO 14 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=121ms, Total=141ms
2022-01-11 12:54:50.109  INFO 14 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=3067825a-c8e2-45f4-9a8b-78dc2379c915, content=null, timestamp=1641905690099, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=65338, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=eb230e1d0f5c, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.29.0.1, kc-session-state=5479e8ce-ab30-4375-a9ec-31812ab40e37, http-req-server-port=80, http-header-accept=*/*, kc-id=3f3eb186-3198-4309-999b-06de29e30711, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641905690097, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd1/MXNxAH4AEQAAAABh3X4FdAAkM2YzZWIxODYtMzE5OC00MzA5LTk5OWItMDZkZTI5ZTMwNzExdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkNTQ3OWU4Y2UtYWIzMC00Mzc1LWE5ZWMtMzE4MTJhYjQwZTM3cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJIWlNtUmxVS3VKU2sxNUJ6ZEt5UGdzcW90aHA1ZEtYRlVDZmluNi1qVDlNIn0.eyJleHAiOjE2NDE5MDU5NjksImlhdCI6MTY0MTkwNTY2OSwianRpIjoiM2YzZWIxODYtMzE5OC00MzA5LTk5OWItMDZkZTI5ZTMwNzExIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiNTQ3OWU4Y2UtYWIzMC00Mzc1LWE5ZWMtMzE4MTJhYjQwZTM3IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Qo2snvszM0ZptvUZiRHLSSO4nz1K0HwEkVPSMfl64bUpFF7dFqQatXHINmKGObf_HLuTviCYih0aDatO_ipy06Y4tSx-aQoewxxEkeGWRmVOlyiyrp9j-XJN3TfhF57Y_19HdtT3yLszqb0mJeIPLO66K0ls96aqjCfn6YfyylVsBiWomsvHUxklb_mZZG8pJiQ82iyMA9KVgkGo68ujHKEGB8BLP7kfxEgM45fP2DCeuElpkQXJGWVhoQITnrDPYnX1L5RBBl1Sy_HFgupsV5mv6e-qEj8poRZxLJqEYv3n762T5wWyc230vjqeenX7NuDmygQK97M3dJdqg3rVQA, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641905969, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=172.29.0.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.29.0.1, http-session-id=07660DC58F27CC72ABFB60EB492267F0, http-session-last-accessed-time=1641905690097, kc-category-name=ACCESS, kc-iat=1641905669, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.29.0.1:65338 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 12:54:50.114  INFO 14 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 12:54:50.121  INFO 14 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3f69cb00
2022-01-11 12:54:50.126  INFO 14 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3f69cb00
2022-01-11 12:54:50.167  INFO 14 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3f69cb00
2022-01-11 12:54:50.174  INFO 14 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3f69cb00
2022-01-11 12:54:50.204  INFO 14 --- [https-jsse-nio-7071-exec-1] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-4869700868475-918519, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:b90c11d7-db11-4fad-aaae-8c841010ad99:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=b90c11d7-db11-4fad-aaae-8c841010ad99, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time before Shift end, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-11 12:54:50.207  INFO 14 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=3067825a-c8e2-45f4-9a8b-78dc2379c915, content=DENY, timestamp=1641905690207, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:b90c11d7-db11-4fad-aaae-8c841010ad99:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=b90c11d7-db11-4fad-aaae-8c841010ad99, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time before Shift end, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-11 12:54:50.210  INFO 14 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=89ms, Total=103ms
2022-01-11 12:54:50.335  INFO 14 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=bb4a24e2-3563-4d94-bc63-b9897b1885be, content=null, timestamp=1641905690258, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=65340, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=eb230e1d0f5c, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.29.0.1, kc-session-state=5479e8ce-ab30-4375-a9ec-31812ab40e37, http-req-server-port=80, http-header-accept=*/*, kc-id=3f3eb186-3198-4309-999b-06de29e30711, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641905690256, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd1/MXNxAH4AEQAAAABh3X4FdAAkM2YzZWIxODYtMzE5OC00MzA5LTk5OWItMDZkZTI5ZTMwNzExdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkNTQ3OWU4Y2UtYWIzMC00Mzc1LWE5ZWMtMzE4MTJhYjQwZTM3cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJIWlNtUmxVS3VKU2sxNUJ6ZEt5UGdzcW90aHA1ZEtYRlVDZmluNi1qVDlNIn0.eyJleHAiOjE2NDE5MDU5NjksImlhdCI6MTY0MTkwNTY2OSwianRpIjoiM2YzZWIxODYtMzE5OC00MzA5LTk5OWItMDZkZTI5ZTMwNzExIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiNTQ3OWU4Y2UtYWIzMC00Mzc1LWE5ZWMtMzE4MTJhYjQwZTM3IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Qo2snvszM0ZptvUZiRHLSSO4nz1K0HwEkVPSMfl64bUpFF7dFqQatXHINmKGObf_HLuTviCYih0aDatO_ipy06Y4tSx-aQoewxxEkeGWRmVOlyiyrp9j-XJN3TfhF57Y_19HdtT3yLszqb0mJeIPLO66K0ls96aqjCfn6YfyylVsBiWomsvHUxklb_mZZG8pJiQ82iyMA9KVgkGo68ujHKEGB8BLP7kfxEgM45fP2DCeuElpkQXJGWVhoQITnrDPYnX1L5RBBl1Sy_HFgupsV5mv6e-qEj8poRZxLJqEYv3n762T5wWyc230vjqeenX7NuDmygQK97M3dJdqg3rVQA, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641905969, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=172.29.0.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.29.0.1, http-session-id=7CE3B66F4ACAA5DE200D2093F2E18E28, http-session-last-accessed-time=1641905690256, kc-category-name=ACCESS, kc-iat=1641905669, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.29.0.1:65340 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 12:54:50.340  INFO 14 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 12:54:50.359  INFO 14 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@33d1a7a2
2022-01-11 12:54:50.363  INFO 14 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@33d1a7a2
2022-01-11 12:54:50.408  INFO 14 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@33d1a7a2
2022-01-11 12:54:50.412  INFO 14 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@33d1a7a2
2022-01-11 12:54:50.468  INFO 14 --- [https-jsse-nio-7071-exec-5] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-4869927312575-693161, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:b90c11d7-db11-4fad-aaae-8c841010ad99:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=b90c11d7-db11-4fad-aaae-8c841010ad99, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time before Shift end, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-11 12:54:50.472  INFO 14 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=bb4a24e2-3563-4d94-bc63-b9897b1885be, content=DENY, timestamp=1641905690472, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:b90c11d7-db11-4fad-aaae-8c841010ad99:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=b90c11d7-db11-4fad-aaae-8c841010ad99, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time before Shift end, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-11 12:54:50.480  INFO 14 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=128ms, Total=161ms
2022-01-11 12:54:50.543  INFO 14 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=61a688ca-ceb2-4437-a85b-1926c9f207ed, content=null, timestamp=1641905690527, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=65344, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=eb230e1d0f5c, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.29.0.1, kc-session-state=5479e8ce-ab30-4375-a9ec-31812ab40e37, http-req-server-port=80, http-header-accept=*/*, kc-id=3f3eb186-3198-4309-999b-06de29e30711, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641905690518, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd1/MXNxAH4AEQAAAABh3X4FdAAkM2YzZWIxODYtMzE5OC00MzA5LTk5OWItMDZkZTI5ZTMwNzExdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkNTQ3OWU4Y2UtYWIzMC00Mzc1LWE5ZWMtMzE4MTJhYjQwZTM3cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJIWlNtUmxVS3VKU2sxNUJ6ZEt5UGdzcW90aHA1ZEtYRlVDZmluNi1qVDlNIn0.eyJleHAiOjE2NDE5MDU5NjksImlhdCI6MTY0MTkwNTY2OSwianRpIjoiM2YzZWIxODYtMzE5OC00MzA5LTk5OWItMDZkZTI5ZTMwNzExIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiNTQ3OWU4Y2UtYWIzMC00Mzc1LWE5ZWMtMzE4MTJhYjQwZTM3IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Qo2snvszM0ZptvUZiRHLSSO4nz1K0HwEkVPSMfl64bUpFF7dFqQatXHINmKGObf_HLuTviCYih0aDatO_ipy06Y4tSx-aQoewxxEkeGWRmVOlyiyrp9j-XJN3TfhF57Y_19HdtT3yLszqb0mJeIPLO66K0ls96aqjCfn6YfyylVsBiWomsvHUxklb_mZZG8pJiQ82iyMA9KVgkGo68ujHKEGB8BLP7kfxEgM45fP2DCeuElpkQXJGWVhoQITnrDPYnX1L5RBBl1Sy_HFgupsV5mv6e-qEj8poRZxLJqEYv3n762T5wWyc230vjqeenX7NuDmygQK97M3dJdqg3rVQA, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641905969, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=172.29.0.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.29.0.1, http-session-id=61190F7D8D634579A7E3E92070A70B19, http-session-last-accessed-time=1641905690518, kc-category-name=ACCESS, kc-iat=1641905669, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.29.0.1:65344 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 12:54:50.551  INFO 14 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 12:54:50.563  INFO 14 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4aa40046
2022-01-11 12:54:50.571  INFO 14 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4aa40046
2022-01-11 12:54:50.590  INFO 14 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4aa40046
2022-01-11 12:54:50.595  INFO 14 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4aa40046
2022-01-11 12:54:50.665  INFO 14 --- [https-jsse-nio-7071-exec-6] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-4870139618175-84389, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:b90c11d7-db11-4fad-aaae-8c841010ad99:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=b90c11d7-db11-4fad-aaae-8c841010ad99, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time before Shift end, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-11 12:54:50.672  INFO 14 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=61a688ca-ceb2-4437-a85b-1926c9f207ed, content=DENY, timestamp=1641905690672, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:b90c11d7-db11-4fad-aaae-8c841010ad99:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=b90c11d7-db11-4fad-aaae-8c841010ad99, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time before Shift end, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-11 12:54:50.678  INFO 14 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=116ms, Total=137ms
2022-01-11 12:54:50.728  INFO 14 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=19798b92-9f7a-4031-901a-1bb583f11629, content=null, timestamp=1641905690719, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=65346, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=eb230e1d0f5c, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.29.0.1, kc-session-state=5479e8ce-ab30-4375-a9ec-31812ab40e37, http-req-server-port=80, http-header-accept=*/*, kc-id=3f3eb186-3198-4309-999b-06de29e30711, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641905690718, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd1/MXNxAH4AEQAAAABh3X4FdAAkM2YzZWIxODYtMzE5OC00MzA5LTk5OWItMDZkZTI5ZTMwNzExdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkNTQ3OWU4Y2UtYWIzMC00Mzc1LWE5ZWMtMzE4MTJhYjQwZTM3cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJIWlNtUmxVS3VKU2sxNUJ6ZEt5UGdzcW90aHA1ZEtYRlVDZmluNi1qVDlNIn0.eyJleHAiOjE2NDE5MDU5NjksImlhdCI6MTY0MTkwNTY2OSwianRpIjoiM2YzZWIxODYtMzE5OC00MzA5LTk5OWItMDZkZTI5ZTMwNzExIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiNTQ3OWU4Y2UtYWIzMC00Mzc1LWE5ZWMtMzE4MTJhYjQwZTM3IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Qo2snvszM0ZptvUZiRHLSSO4nz1K0HwEkVPSMfl64bUpFF7dFqQatXHINmKGObf_HLuTviCYih0aDatO_ipy06Y4tSx-aQoewxxEkeGWRmVOlyiyrp9j-XJN3TfhF57Y_19HdtT3yLszqb0mJeIPLO66K0ls96aqjCfn6YfyylVsBiWomsvHUxklb_mZZG8pJiQ82iyMA9KVgkGo68ujHKEGB8BLP7kfxEgM45fP2DCeuElpkQXJGWVhoQITnrDPYnX1L5RBBl1Sy_HFgupsV5mv6e-qEj8poRZxLJqEYv3n762T5wWyc230vjqeenX7NuDmygQK97M3dJdqg3rVQA, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641905969, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=172.29.0.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.29.0.1, http-session-id=05418A057E28C3584D350B5148137CEC, http-session-last-accessed-time=1641905690718, kc-category-name=ACCESS, kc-iat=1641905669, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.29.0.1:65346 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 12:54:50.743  INFO 14 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 12:54:50.749  INFO 14 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@24783be8
2022-01-11 12:54:50.752  INFO 14 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@24783be8
2022-01-11 12:54:50.809  INFO 14 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@24783be8
2022-01-11 12:54:50.811  INFO 14 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@24783be8
2022-01-11 12:54:50.854  INFO 14 --- [https-jsse-nio-7071-exec-7] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-4870330252375-558450, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:b90c11d7-db11-4fad-aaae-8c841010ad99:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=b90c11d7-db11-4fad-aaae-8c841010ad99, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time before Shift end, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-11 12:54:50.860  INFO 14 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=19798b92-9f7a-4031-901a-1bb583f11629, content=DENY, timestamp=1641905690860, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:b90c11d7-db11-4fad-aaae-8c841010ad99:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=b90c11d7-db11-4fad-aaae-8c841010ad99, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time before Shift end, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-11 12:54:50.863  INFO 14 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=113ms, Total=137ms
2022-01-11 12:54:50.930  INFO 14 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=9a22119c-ced6-4127-ac81-2e0a16587b29, content=null, timestamp=1641905690919, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=65348, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=eb230e1d0f5c, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.29.0.1, kc-session-state=5479e8ce-ab30-4375-a9ec-31812ab40e37, http-req-server-port=80, http-header-accept=*/*, kc-id=3f3eb186-3198-4309-999b-06de29e30711, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641905690917, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd1/MXNxAH4AEQAAAABh3X4FdAAkM2YzZWIxODYtMzE5OC00MzA5LTk5OWItMDZkZTI5ZTMwNzExdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkNTQ3OWU4Y2UtYWIzMC00Mzc1LWE5ZWMtMzE4MTJhYjQwZTM3cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJIWlNtUmxVS3VKU2sxNUJ6ZEt5UGdzcW90aHA1ZEtYRlVDZmluNi1qVDlNIn0.eyJleHAiOjE2NDE5MDU5NjksImlhdCI6MTY0MTkwNTY2OSwianRpIjoiM2YzZWIxODYtMzE5OC00MzA5LTk5OWItMDZkZTI5ZTMwNzExIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiNTQ3OWU4Y2UtYWIzMC00Mzc1LWE5ZWMtMzE4MTJhYjQwZTM3IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Qo2snvszM0ZptvUZiRHLSSO4nz1K0HwEkVPSMfl64bUpFF7dFqQatXHINmKGObf_HLuTviCYih0aDatO_ipy06Y4tSx-aQoewxxEkeGWRmVOlyiyrp9j-XJN3TfhF57Y_19HdtT3yLszqb0mJeIPLO66K0ls96aqjCfn6YfyylVsBiWomsvHUxklb_mZZG8pJiQ82iyMA9KVgkGo68ujHKEGB8BLP7kfxEgM45fP2DCeuElpkQXJGWVhoQITnrDPYnX1L5RBBl1Sy_HFgupsV5mv6e-qEj8poRZxLJqEYv3n762T5wWyc230vjqeenX7NuDmygQK97M3dJdqg3rVQA, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641905969, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=172.29.0.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.29.0.1, http-session-id=C9A0609C410F44F7A6C0319D5B227451, http-session-last-accessed-time=1641905690917, kc-category-name=ACCESS, kc-iat=1641905669, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.29.0.1:65348 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 12:54:50.934  INFO 14 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 12:54:50.948  INFO 14 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@40349a66
2022-01-11 12:54:50.952  INFO 14 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@40349a66
2022-01-11 12:54:50.976  INFO 14 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@40349a66
2022-01-11 12:54:50.980  INFO 14 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@40349a66
2022-01-11 12:54:51.026  INFO 14 --- [https-jsse-nio-7071-exec-8] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-4870522470975-103690, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:b90c11d7-db11-4fad-aaae-8c841010ad99:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=b90c11d7-db11-4fad-aaae-8c841010ad99, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time before Shift end, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-11 12:54:51.028  INFO 14 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=9a22119c-ced6-4127-ac81-2e0a16587b29, content=DENY, timestamp=1641905691028, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:b90c11d7-db11-4fad-aaae-8c841010ad99:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=b90c11d7-db11-4fad-aaae-8c841010ad99, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time before Shift end, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-11 12:54:51.034  INFO 14 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=89ms, Total=105ms
2022-01-11 12:54:51.119  INFO 14 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=41828d72-5249-4d85-8a3c-960820bcf84d, content=null, timestamp=1641905691094, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=65350, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=eb230e1d0f5c, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.29.0.1, kc-session-state=5479e8ce-ab30-4375-a9ec-31812ab40e37, http-req-server-port=80, http-header-accept=*/*, kc-id=3f3eb186-3198-4309-999b-06de29e30711, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641905691087, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd1/MXNxAH4AEQAAAABh3X4FdAAkM2YzZWIxODYtMzE5OC00MzA5LTk5OWItMDZkZTI5ZTMwNzExdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkNTQ3OWU4Y2UtYWIzMC00Mzc1LWE5ZWMtMzE4MTJhYjQwZTM3cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJIWlNtUmxVS3VKU2sxNUJ6ZEt5UGdzcW90aHA1ZEtYRlVDZmluNi1qVDlNIn0.eyJleHAiOjE2NDE5MDU5NjksImlhdCI6MTY0MTkwNTY2OSwianRpIjoiM2YzZWIxODYtMzE5OC00MzA5LTk5OWItMDZkZTI5ZTMwNzExIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiNTQ3OWU4Y2UtYWIzMC00Mzc1LWE5ZWMtMzE4MTJhYjQwZTM3IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Qo2snvszM0ZptvUZiRHLSSO4nz1K0HwEkVPSMfl64bUpFF7dFqQatXHINmKGObf_HLuTviCYih0aDatO_ipy06Y4tSx-aQoewxxEkeGWRmVOlyiyrp9j-XJN3TfhF57Y_19HdtT3yLszqb0mJeIPLO66K0ls96aqjCfn6YfyylVsBiWomsvHUxklb_mZZG8pJiQ82iyMA9KVgkGo68ujHKEGB8BLP7kfxEgM45fP2DCeuElpkQXJGWVhoQITnrDPYnX1L5RBBl1Sy_HFgupsV5mv6e-qEj8poRZxLJqEYv3n762T5wWyc230vjqeenX7NuDmygQK97M3dJdqg3rVQA, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641905969, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=172.29.0.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.29.0.1, http-session-id=221EFB15AB06D47C489DD11912301272, http-session-last-accessed-time=1641905691087, kc-category-name=ACCESS, kc-iat=1641905669, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.29.0.1:65350 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 12:54:51.126  INFO 14 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 12:54:51.129  INFO 14 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6a7cc13a
2022-01-11 12:54:51.133  INFO 14 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6a7cc13a
2022-01-11 12:54:51.188  INFO 14 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6a7cc13a
2022-01-11 12:54:51.193  INFO 14 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6a7cc13a
2022-01-11 12:54:51.274  INFO 14 --- [https-jsse-nio-7071-exec-9] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-4870711334275-373810, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:b90c11d7-db11-4fad-aaae-8c841010ad99:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=b90c11d7-db11-4fad-aaae-8c841010ad99, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time before Shift end, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-11 12:54:51.279  INFO 14 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=41828d72-5249-4d85-8a3c-960820bcf84d, content=DENY, timestamp=1641905691279, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:b90c11d7-db11-4fad-aaae-8c841010ad99:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=b90c11d7-db11-4fad-aaae-8c841010ad99, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time before Shift end, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-11 12:54:51.284  INFO 14 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=151ms, Total=166ms
2022-01-11 12:54:51.332  INFO 14 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=4aa4b438-9a76-452e-ac76-b607c63507e5, content=null, timestamp=1641905691318, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=65352, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=eb230e1d0f5c, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.29.0.1, kc-session-state=5479e8ce-ab30-4375-a9ec-31812ab40e37, http-req-server-port=80, http-header-accept=*/*, kc-id=3f3eb186-3198-4309-999b-06de29e30711, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641905691312, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd1/MXNxAH4AEQAAAABh3X4FdAAkM2YzZWIxODYtMzE5OC00MzA5LTk5OWItMDZkZTI5ZTMwNzExdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkNTQ3OWU4Y2UtYWIzMC00Mzc1LWE5ZWMtMzE4MTJhYjQwZTM3cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJIWlNtUmxVS3VKU2sxNUJ6ZEt5UGdzcW90aHA1ZEtYRlVDZmluNi1qVDlNIn0.eyJleHAiOjE2NDE5MDU5NjksImlhdCI6MTY0MTkwNTY2OSwianRpIjoiM2YzZWIxODYtMzE5OC00MzA5LTk5OWItMDZkZTI5ZTMwNzExIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiNTQ3OWU4Y2UtYWIzMC00Mzc1LWE5ZWMtMzE4MTJhYjQwZTM3IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Qo2snvszM0ZptvUZiRHLSSO4nz1K0HwEkVPSMfl64bUpFF7dFqQatXHINmKGObf_HLuTviCYih0aDatO_ipy06Y4tSx-aQoewxxEkeGWRmVOlyiyrp9j-XJN3TfhF57Y_19HdtT3yLszqb0mJeIPLO66K0ls96aqjCfn6YfyylVsBiWomsvHUxklb_mZZG8pJiQ82iyMA9KVgkGo68ujHKEGB8BLP7kfxEgM45fP2DCeuElpkQXJGWVhoQITnrDPYnX1L5RBBl1Sy_HFgupsV5mv6e-qEj8poRZxLJqEYv3n762T5wWyc230vjqeenX7NuDmygQK97M3dJdqg3rVQA, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641905969, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=172.29.0.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.29.0.1, http-session-id=304AAC23EE935B70331E8B9961C85B71, http-session-last-accessed-time=1641905691312, kc-category-name=ACCESS, kc-iat=1641905669, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.29.0.1:65352 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 12:54:51.339  INFO 14 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 12:54:51.349  INFO 14 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@847a3b6
2022-01-11 12:54:51.353  INFO 14 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@847a3b6
2022-01-11 12:54:51.394  INFO 14 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@847a3b6
2022-01-11 12:54:51.400  INFO 14 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@847a3b6
2022-01-11 12:54:51.439  INFO 14 --- [https-jsse-nio-7071-exec-10] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-4870926144575-165543, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:b90c11d7-db11-4fad-aaae-8c841010ad99:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=b90c11d7-db11-4fad-aaae-8c841010ad99, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time before Shift end, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-11 12:54:51.445  INFO 14 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=4aa4b438-9a76-452e-ac76-b607c63507e5, content=DENY, timestamp=1641905691445, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:b90c11d7-db11-4fad-aaae-8c841010ad99:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=b90c11d7-db11-4fad-aaae-8c841010ad99, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time before Shift end, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-11 12:54:51.449  INFO 14 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=102ms, Total=119ms
2022-01-11 12:54:51.516  INFO 14 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=9a528ee7-e973-41c0-9a04-1301c908771c, content=null, timestamp=1641905691501, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=65354, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=eb230e1d0f5c, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.29.0.1, kc-session-state=5479e8ce-ab30-4375-a9ec-31812ab40e37, http-req-server-port=80, http-header-accept=*/*, kc-id=3f3eb186-3198-4309-999b-06de29e30711, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641905691495, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd1/MXNxAH4AEQAAAABh3X4FdAAkM2YzZWIxODYtMzE5OC00MzA5LTk5OWItMDZkZTI5ZTMwNzExdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkNTQ3OWU4Y2UtYWIzMC00Mzc1LWE5ZWMtMzE4MTJhYjQwZTM3cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJIWlNtUmxVS3VKU2sxNUJ6ZEt5UGdzcW90aHA1ZEtYRlVDZmluNi1qVDlNIn0.eyJleHAiOjE2NDE5MDU5NjksImlhdCI6MTY0MTkwNTY2OSwianRpIjoiM2YzZWIxODYtMzE5OC00MzA5LTk5OWItMDZkZTI5ZTMwNzExIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiNTQ3OWU4Y2UtYWIzMC00Mzc1LWE5ZWMtMzE4MTJhYjQwZTM3IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Qo2snvszM0ZptvUZiRHLSSO4nz1K0HwEkVPSMfl64bUpFF7dFqQatXHINmKGObf_HLuTviCYih0aDatO_ipy06Y4tSx-aQoewxxEkeGWRmVOlyiyrp9j-XJN3TfhF57Y_19HdtT3yLszqb0mJeIPLO66K0ls96aqjCfn6YfyylVsBiWomsvHUxklb_mZZG8pJiQ82iyMA9KVgkGo68ujHKEGB8BLP7kfxEgM45fP2DCeuElpkQXJGWVhoQITnrDPYnX1L5RBBl1Sy_HFgupsV5mv6e-qEj8poRZxLJqEYv3n762T5wWyc230vjqeenX7NuDmygQK97M3dJdqg3rVQA, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641905969, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=172.29.0.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.29.0.1, http-session-id=FB2170FED749390C4CB7F6314868FD5F, http-session-last-accessed-time=1641905691495, kc-category-name=ACCESS, kc-iat=1641905669, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.29.0.1:65354 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 12:54:51.521  INFO 14 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 12:54:51.527  INFO 14 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@58c54046
2022-01-11 12:54:51.530  INFO 14 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@58c54046
2022-01-11 12:54:51.599  INFO 14 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@58c54046
2022-01-11 12:54:51.602  INFO 14 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@58c54046
2022-01-11 12:54:51.702  INFO 14 --- [https-jsse-nio-7071-exec-1] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-4871109070475-844333, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:b90c11d7-db11-4fad-aaae-8c841010ad99:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=b90c11d7-db11-4fad-aaae-8c841010ad99, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time before Shift end, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-11 12:54:51.708  INFO 14 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=9a528ee7-e973-41c0-9a04-1301c908771c, content=DENY, timestamp=1641905691708, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:b90c11d7-db11-4fad-aaae-8c841010ad99:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=b90c11d7-db11-4fad-aaae-8c841010ad99, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time before Shift end, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-11 12:54:51.712  INFO 14 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=182ms, Total=197ms
2022-01-11 12:54:51.754  INFO 14 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=6c930c43-45a0-4992-8cd2-c5f3140271a2, content=null, timestamp=1641905691745, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=65356, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=eb230e1d0f5c, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.29.0.1, kc-session-state=5479e8ce-ab30-4375-a9ec-31812ab40e37, http-req-server-port=80, http-header-accept=*/*, kc-id=3f3eb186-3198-4309-999b-06de29e30711, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641905691742, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd1/MXNxAH4AEQAAAABh3X4FdAAkM2YzZWIxODYtMzE5OC00MzA5LTk5OWItMDZkZTI5ZTMwNzExdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkNTQ3OWU4Y2UtYWIzMC00Mzc1LWE5ZWMtMzE4MTJhYjQwZTM3cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJIWlNtUmxVS3VKU2sxNUJ6ZEt5UGdzcW90aHA1ZEtYRlVDZmluNi1qVDlNIn0.eyJleHAiOjE2NDE5MDU5NjksImlhdCI6MTY0MTkwNTY2OSwianRpIjoiM2YzZWIxODYtMzE5OC00MzA5LTk5OWItMDZkZTI5ZTMwNzExIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiNTQ3OWU4Y2UtYWIzMC00Mzc1LWE5ZWMtMzE4MTJhYjQwZTM3IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Qo2snvszM0ZptvUZiRHLSSO4nz1K0HwEkVPSMfl64bUpFF7dFqQatXHINmKGObf_HLuTviCYih0aDatO_ipy06Y4tSx-aQoewxxEkeGWRmVOlyiyrp9j-XJN3TfhF57Y_19HdtT3yLszqb0mJeIPLO66K0ls96aqjCfn6YfyylVsBiWomsvHUxklb_mZZG8pJiQ82iyMA9KVgkGo68ujHKEGB8BLP7kfxEgM45fP2DCeuElpkQXJGWVhoQITnrDPYnX1L5RBBl1Sy_HFgupsV5mv6e-qEj8poRZxLJqEYv3n762T5wWyc230vjqeenX7NuDmygQK97M3dJdqg3rVQA, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641905969, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=172.29.0.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.29.0.1, http-session-id=32895A99A758FAD1895A4E27705403CC, http-session-last-accessed-time=1641905691742, kc-category-name=ACCESS, kc-iat=1641905669, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.29.0.1:65356 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 12:54:51.760  INFO 14 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 12:54:51.767  INFO 14 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@53f70848
2022-01-11 12:54:51.770  INFO 14 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@53f70848
2022-01-11 12:54:51.821  INFO 14 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@53f70848
2022-01-11 12:54:51.827  INFO 14 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@53f70848
2022-01-11 12:54:51.896  INFO 14 --- [https-jsse-nio-7071-exec-2] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-4871347268075-538422, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:b90c11d7-db11-4fad-aaae-8c841010ad99:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=b90c11d7-db11-4fad-aaae-8c841010ad99, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time before Shift end, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-11 12:54:51.901  INFO 14 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=6c930c43-45a0-4992-8cd2-c5f3140271a2, content=DENY, timestamp=1641905691900, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:b90c11d7-db11-4fad-aaae-8c841010ad99:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=b90c11d7-db11-4fad-aaae-8c841010ad99, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time before Shift end, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-11 12:54:51.905  INFO 14 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=136ms, Total=152ms
2022-01-11 12:54:51.964  INFO 14 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=dd291132-f75a-4b97-9059-0cd788b8dedf, content=null, timestamp=1641905691946, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=65358, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=eb230e1d0f5c, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.29.0.1, kc-session-state=5479e8ce-ab30-4375-a9ec-31812ab40e37, http-req-server-port=80, http-header-accept=*/*, kc-id=3f3eb186-3198-4309-999b-06de29e30711, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641905691944, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd1/MXNxAH4AEQAAAABh3X4FdAAkM2YzZWIxODYtMzE5OC00MzA5LTk5OWItMDZkZTI5ZTMwNzExdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkNTQ3OWU4Y2UtYWIzMC00Mzc1LWE5ZWMtMzE4MTJhYjQwZTM3cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJIWlNtUmxVS3VKU2sxNUJ6ZEt5UGdzcW90aHA1ZEtYRlVDZmluNi1qVDlNIn0.eyJleHAiOjE2NDE5MDU5NjksImlhdCI6MTY0MTkwNTY2OSwianRpIjoiM2YzZWIxODYtMzE5OC00MzA5LTk5OWItMDZkZTI5ZTMwNzExIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiNTQ3OWU4Y2UtYWIzMC00Mzc1LWE5ZWMtMzE4MTJhYjQwZTM3IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Qo2snvszM0ZptvUZiRHLSSO4nz1K0HwEkVPSMfl64bUpFF7dFqQatXHINmKGObf_HLuTviCYih0aDatO_ipy06Y4tSx-aQoewxxEkeGWRmVOlyiyrp9j-XJN3TfhF57Y_19HdtT3yLszqb0mJeIPLO66K0ls96aqjCfn6YfyylVsBiWomsvHUxklb_mZZG8pJiQ82iyMA9KVgkGo68ujHKEGB8BLP7kfxEgM45fP2DCeuElpkQXJGWVhoQITnrDPYnX1L5RBBl1Sy_HFgupsV5mv6e-qEj8poRZxLJqEYv3n762T5wWyc230vjqeenX7NuDmygQK97M3dJdqg3rVQA, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641905969, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=172.29.0.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.29.0.1, http-session-id=93A901C9315B54C1631367B1017E6A78, http-session-last-accessed-time=1641905691944, kc-category-name=ACCESS, kc-iat=1641905669, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.29.0.1:65358 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 12:54:51.969  INFO 14 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 12:54:51.973  INFO 14 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5f3aa806
2022-01-11 12:54:51.975  INFO 14 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5f3aa806
2022-01-11 12:54:52.009  INFO 14 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5f3aa806
2022-01-11 12:54:52.012  INFO 14 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5f3aa806
2022-01-11 12:54:52.074  INFO 14 --- [https-jsse-nio-7071-exec-3] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-4871554916075-332852, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:b90c11d7-db11-4fad-aaae-8c841010ad99:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=b90c11d7-db11-4fad-aaae-8c841010ad99, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time before Shift end, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-11 12:54:52.077  INFO 14 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=dd291132-f75a-4b97-9059-0cd788b8dedf, content=DENY, timestamp=1641905692077, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:b90c11d7-db11-4fad-aaae-8c841010ad99:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=b90c11d7-db11-4fad-aaae-8c841010ad99, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time before Shift end, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-11 12:54:52.083  INFO 14 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=105ms, Total=120ms
2022-01-11 12:54:52.129  INFO 14 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=3e2abb2f-1c8c-4ce4-822d-60f3ee35b94c, content=null, timestamp=1641905692120, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=65360, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=eb230e1d0f5c, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.29.0.1, kc-session-state=5479e8ce-ab30-4375-a9ec-31812ab40e37, http-req-server-port=80, http-header-accept=*/*, kc-id=3f3eb186-3198-4309-999b-06de29e30711, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641905692118, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd1/MXNxAH4AEQAAAABh3X4FdAAkM2YzZWIxODYtMzE5OC00MzA5LTk5OWItMDZkZTI5ZTMwNzExdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkNTQ3OWU4Y2UtYWIzMC00Mzc1LWE5ZWMtMzE4MTJhYjQwZTM3cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJIWlNtUmxVS3VKU2sxNUJ6ZEt5UGdzcW90aHA1ZEtYRlVDZmluNi1qVDlNIn0.eyJleHAiOjE2NDE5MDU5NjksImlhdCI6MTY0MTkwNTY2OSwianRpIjoiM2YzZWIxODYtMzE5OC00MzA5LTk5OWItMDZkZTI5ZTMwNzExIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiNTQ3OWU4Y2UtYWIzMC00Mzc1LWE5ZWMtMzE4MTJhYjQwZTM3IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Qo2snvszM0ZptvUZiRHLSSO4nz1K0HwEkVPSMfl64bUpFF7dFqQatXHINmKGObf_HLuTviCYih0aDatO_ipy06Y4tSx-aQoewxxEkeGWRmVOlyiyrp9j-XJN3TfhF57Y_19HdtT3yLszqb0mJeIPLO66K0ls96aqjCfn6YfyylVsBiWomsvHUxklb_mZZG8pJiQ82iyMA9KVgkGo68ujHKEGB8BLP7kfxEgM45fP2DCeuElpkQXJGWVhoQITnrDPYnX1L5RBBl1Sy_HFgupsV5mv6e-qEj8poRZxLJqEYv3n762T5wWyc230vjqeenX7NuDmygQK97M3dJdqg3rVQA, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641905969, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=172.29.0.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.29.0.1, http-session-id=AF31AD2D6A20B0D9CAB0D0E922991104, http-session-last-accessed-time=1641905692118, kc-category-name=ACCESS, kc-iat=1641905669, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.29.0.1:65360 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 12:54:52.134  INFO 14 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 12:54:52.145  INFO 14 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@28621131
2022-01-11 12:54:52.148  INFO 14 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@28621131
2022-01-11 12:54:52.183  INFO 14 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@28621131
2022-01-11 12:54:52.187  INFO 14 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@28621131
2022-01-11 12:54:52.231  INFO 14 --- [https-jsse-nio-7071-exec-4] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-4871723392775-287702, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:b90c11d7-db11-4fad-aaae-8c841010ad99:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=b90c11d7-db11-4fad-aaae-8c841010ad99, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time before Shift end, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-11 12:54:52.234  INFO 14 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=3e2abb2f-1c8c-4ce4-822d-60f3ee35b94c, content=DENY, timestamp=1641905692234, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:b90c11d7-db11-4fad-aaae-8c841010ad99:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=b90c11d7-db11-4fad-aaae-8c841010ad99, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 1 - Current Time before Shift end, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-11 12:54:52.239  INFO 14 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=93ms, Total=112ms
