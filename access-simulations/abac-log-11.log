2022-01-16 11:46:12.867  INFO 14 --- [main] .a.a.a.s.AuthorizationServiceApplication : Starting AuthorizationServiceApplication v3.0.4 using Java 1.8.0_212 on 4a8a4892479f with PID 14 (/abac-server/abac-authorization-server-exec.jar started by root in /abac-server)
2022-01-16 11:46:12.946  INFO 14 --- [main] .a.a.a.s.AuthorizationServiceApplication : No active profile set, falling back to default profiles: default
2022-01-16 11:46:16.507  INFO 14 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2022-01-16 11:46:16.794  INFO 14 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 258 ms. Found 3 JPA repository interfaces.
2022-01-16 11:46:19.255  INFO 14 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port(s): 7071 (https)
2022-01-16 11:46:19.299  INFO 14 --- [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2022-01-16 11:46:19.305  INFO 14 --- [main] org.apache.catalina.core.StandardEngine  : Starting Servlet engine: [Apache Tomcat/9.0.56]
2022-01-16 11:46:19.491  INFO 14 --- [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2022-01-16 11:46:19.491  INFO 14 --- [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 6263 ms
2022-01-16 11:46:20.026  INFO 14 --- [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
2022-01-16 11:46:20.046  WARN 14 --- [main] com.zaxxer.hikari.util.DriverDataSource  : Registered driver with driverClassName=com.mysql.jdbc.Driver was not found, trying direct instantiation.
2022-01-16 11:46:20.659  INFO 14 --- [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
2022-01-16 11:46:20.680  INFO 14 --- [main] o.s.b.a.h2.H2ConsoleAutoConfiguration    : H2 console available at '/h2-console'. Database available at 'jdbc:mysql://mysql:3306/apam_db?createDatabaseIfNotExist=true'
2022-01-16 11:46:21.422  INFO 14 --- [main] o.hibernate.jpa.internal.util.LogHelper  : HHH000204: Processing PersistenceUnitInfo [name: default]
2022-01-16 11:46:21.634  INFO 14 --- [main] org.hibernate.Version                    : HHH000412: Hibernate ORM core version 5.6.3.Final
2022-01-16 11:46:22.188  INFO 14 --- [main] o.hibernate.annotations.common.Version   : HCANN000001: Hibernate Commons Annotations {5.1.2.Final}
2022-01-16 11:46:22.713  INFO 14 --- [main] org.hibernate.dialect.Dialect            : HHH000400: Using dialect: org.hibernate.dialect.MySQL5InnoDBDialect
2022-01-16 11:46:24.333  INFO 14 --- [main] o.h.e.t.j.p.i.JtaPlatformInitiator       : HHH000490: Using JtaPlatform implementation: [org.hibernate.engine.transaction.jta.platform.internal.NoJtaPlatform]
2022-01-16 11:46:24.343  INFO 14 --- [main] j.LocalContainerEntityManagerFactoryBean : Initialized JPA EntityManagerFactory for persistence unit 'default'
2022-01-16 11:46:24.761  INFO 14 --- [main] e.a.a.abac.server.pap.PapProperties      : ABAC Policies directory: ./config/../policies
2022-01-16 11:46:24.761  INFO 14 --- [main] e.a.a.abac.server.pap.PapProperties      : ABE Policies directory: ./config/../policies
2022-01-16 11:46:26.098  INFO 14 --- [main] e.a.a.abac.server.pdp.DirectoryWatcher   : Policy dir. watcher initialized
2022-01-16 11:46:26.099  INFO 14 --- [main] e.a.a.a.s.pdp.AuthorizationServicePDP    : Initializing PDP...
2022-01-16 11:46:26.100  INFO 14 --- [main] e.a.a.a.s.pdp.AuthorizationServicePDP    : Getting policy files from: ./config/../policies
2022-01-16 11:46:26.114  INFO 14 --- [main] e.a.a.a.s.pdp.AuthorizationServicePDP    : Policy files found: 5
2022-01-16 11:46:26.924  INFO 14 --- [main] org.wso2.balana.ConfigurationStore       : Loading runtime configuration
2022-01-16 11:46:27.254  INFO 14 --- [main] e.a.a.a.s.pdp.AuthorizationServicePDP    : Configured attribute finder module classes: [eu.asclepios.authorization.abac.server.pdp.finder.LoggingAttributeFinderModule, eu.asclepios.authorization.abac.server.pdp.finder.WeekdayAttributeFinderModule, eu.asclepios.authorization.abac.server.pdp.finder.IpAddressAttributeFinderModule, eu.asclepios.authorization.abac.server.pdp.finder.DeviceAttributeFinderModule, eu.asclepios.authorization.abac.server.pdp.finder.GeolocationAttributeFinderModule, eu.asclepios.authorization.abac.server.pdp.finder.KeycloackAttributeFinderModule, eu.asclepios.authorization.abac.server.pdp.finder.NoopAttributeFinderModule, eu.asclepios.example.contexthandlers.CustomDbAttributeFinder, eu.asclepios.example.contexthandlers.CustomRestAttrFinder]
2022-01-16 11:46:27.264  INFO 14 --- [main] e.a.a.a.s.pdp.AuthorizationServicePDP    :   Instantiating attribute finder module: eu.asclepios.authorization.abac.server.pdp.finder.LoggingAttributeFinderModule@45905bff
2022-01-16 11:46:27.265  INFO 14 --- [main] e.a.a.a.s.pdp.AuthorizationServicePDP    :   Instantiating attribute finder module: eu.asclepios.authorization.abac.server.pdp.finder.WeekdayAttributeFinderModule@2a2c13a8
2022-01-16 11:46:27.266  INFO 14 --- [main] e.a.a.a.s.pdp.AuthorizationServicePDP    :   Instantiating attribute finder module: eu.asclepios.authorization.abac.server.pdp.finder.IpAddressAttributeFinderModule@b6b1987
2022-01-16 11:46:27.267  INFO 14 --- [main] e.a.a.a.s.pdp.AuthorizationServicePDP    :   Instantiating attribute finder module: eu.asclepios.authorization.abac.server.pdp.finder.DeviceAttributeFinderModule@6b44435b
2022-01-16 11:46:27.308  INFO 14 --- [main] e.a.a.a.s.pdp.AuthorizationServicePDP    :   Instantiating attribute finder module: eu.asclepios.authorization.abac.server.pdp.finder.GeolocationAttributeFinderModule@2ccca26f
2022-01-16 11:46:27.316  INFO 14 --- [main] e.a.a.a.s.pdp.AuthorizationServicePDP    :   Instantiating attribute finder module: eu.asclepios.authorization.abac.server.pdp.finder.KeycloackAttributeFinderModule@66b7550d
2022-01-16 11:46:27.317  INFO 14 --- [main] e.a.a.a.s.pdp.AuthorizationServicePDP    :   Instantiating attribute finder module: eu.asclepios.authorization.abac.server.pdp.finder.NoopAttributeFinderModule@3543df7d
2022-01-16 11:46:27.318  INFO 14 --- [main] e.a.e.c.CustomDbAttributeFinder          : CustomDbAttributeFinder: DB settings: url=jdbc:mysql://mysql:3306/keycloak, driver=com.mysql.jdbc.Driver, username=keycloak
2022-01-16 11:46:27.337  INFO 14 --- [main] e.a.e.c.CustomDbAttributeFinder          : CustomDbAttributeFinder: Processing entry: 12345:600000:ambulance-crew-id-1234
2022-01-16 11:46:27.340  INFO 14 --- [main] e.a.e.c.CustomDbAttributeFinder          : CustomDbAttributeFinder: Processing entry:  23456:600000:ambulance-crew-id-2345
2022-01-16 11:46:27.344  INFO 14 --- [main] e.a.e.c.CustomDbAttributeFinder          : CustomDbAttributeFinder: Processing entry:  34567:600000:ambulance-crew-id-3456
2022-01-16 11:46:27.345  INFO 14 --- [main] e.a.e.c.CustomDbAttributeFinder          : CustomDbAttributeFinder: Added 3 entries in DB
2022-01-16 11:46:27.345  INFO 14 --- [main] e.a.a.a.s.pdp.AuthorizationServicePDP    :   Instantiating attribute finder module: eu.asclepios.example.contexthandlers.CustomDbAttributeFinder@4212a0c8
2022-01-16 11:46:27.349  INFO 14 --- [main] e.a.e.c.CustomRestAttrFinder             : CustomRestAttrFinder: REST URL template: http://django-rest:8000/attribute-provider/getinfov2?ES-ID={{es-id}}&format=json&patient-ID={{patient-id}}&user-ID={{user-id}}
2022-01-16 11:46:27.419  INFO 14 --- [main] e.a.a.a.s.pdp.AuthorizationServicePDP    :   Instantiating attribute finder module: eu.asclepios.example.contexthandlers.CustomRestAttrFinder@1080b026
2022-01-16 11:46:27.542  INFO 14 --- [main] e.a.a.a.s.pdp.AuthorizationServicePDP    : PDP initialized
2022-01-16 11:46:27.543  INFO 14 --- [main] e.a.a.abac.server.PdpServerController    : Authorization Service configuration: AuthorizationServiceProperties(pdp=AuthorizationServiceProperties.PdpConfig(enable=true, balanaConfigFile=./config/balana.cfg.xml, policiesDir=./config/../policies, policiesExtension=.xml, restartPollingInterval=1000, accessKey=7235687126587231675321756752657236156321765723, attributeFinderClasses=[eu.asclepios.authorization.abac.server.pdp.finder.LoggingAttributeFinderModule, eu.asclepios.authorization.abac.server.pdp.finder.WeekdayAttributeFinderModule, eu.asclepios.authorization.abac.server.pdp.finder.IpAddressAttributeFinderModule, eu.asclepios.authorization.abac.server.pdp.finder.DeviceAttributeFinderModule, eu.asclepios.authorization.abac.server.pdp.finder.GeolocationAttributeFinderModule, eu.asclepios.authorization.abac.server.pdp.finder.KeycloackAttributeFinderModule, eu.asclepios.authorization.abac.server.pdp.finder.NoopAttributeFinderModule, eu.asclepios.example.contexthandlers.CustomDbAttributeFinder, eu.asclepios.example.contexthandlers.CustomRestAttrFinder]), context=null, pip=[], requestContext=null)
2022-01-16 11:46:27.544  INFO 14 --- [main] e.a.a.abac.server.PdpServerController    : Server-side request context extraction: false
2022-01-16 11:46:27.675  WARN 14 --- [main] JpaBaseConfiguration$JpaWebConfiguration : spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2022-01-16 11:46:28.089  INFO 14 --- [main] e.a.a.abac.server.util.WebMvcConfig      : Using API Key authentication in PDP
2022-01-16 11:46:28.099  INFO 14 --- [main] e.a.a.abac.server.util.WebMvcConfig      : Using API Key authentication in PAP
2022-01-16 11:46:29.920  INFO 14 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port(s): 7071 (https) with context path ''
2022-01-16 11:46:29.942  INFO 14 --- [main] .a.a.a.s.AuthorizationServiceApplication : Started AuthorizationServiceApplication in 19.35 seconds (JVM running for 20.528)
2022-01-16 11:47:08.564  INFO 14 --- [https-jsse-nio-7071-exec-6] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring DispatcherServlet 'dispatcherServlet'
2022-01-16 11:47:08.565  INFO 14 --- [https-jsse-nio-7071-exec-6] o.s.web.servlet.DispatcherServlet        : Initializing Servlet 'dispatcherServlet'
2022-01-16 11:47:08.571  INFO 14 --- [https-jsse-nio-7071-exec-6] o.s.web.servlet.DispatcherServlet        : Completed initialization in 6 ms
2022-01-16 11:47:08.672  INFO 14 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=138dc719-6e38-446c-9846-1e05b35466a3, content=null, timestamp=1642333628184, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=53134, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=4cbbcf975445, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=b07dfbf9-a4f5-4455-8203-a2cec4d67eff, http-req-server-port=80, http-header-accept=*/*, kc-id=6cb35628-1a35-4ce0-a796-86bb2026243f, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642333628157, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQG53NxAH4AEQAAAABh5AW7dAAkNmNiMzU2MjgtMWEzNS00Y2UwLWE3OTYtODZiYjIwMjYyNDNmdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRiMDdkZmJmOS1hNGY1LTQ0NTUtODIwMy1hMmNlYzRkNjdlZmZwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJEdC1tdDI0aWkxQ3VWUnBvbnRqazZNTFA4NFVOZDJDSnVVbTNzQXpGZXVVIn0.eyJleHAiOjE2NDIzMzM5MjcsImlhdCI6MTY0MjMzMzYyNywianRpIjoiNmNiMzU2MjgtMWEzNS00Y2UwLWE3OTYtODZiYjIwMjYyNDNmIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiJiMDdkZmJmOS1hNGY1LTQ0NTUtODIwMy1hMmNlYzRkNjdlZmYiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.LfQC6pOzHJwRKWJa93ShDgM_MdHoxnk9eyFbHPoREooqpMT3SMjbXwdLkCNCA1uopGCigRpu-rVC9ccTKnQlTDgnhvQem_tEjdzsYd5uMdjz4QlUMfilGKUWG6WO3balqXcCrl-G8-mb57iZhC2hQiX9z610oFRxfoiN6aHjOPbc3b5kLm37QHObSimyN-S1yTLGW4ut7qSpExXmOpDwje3DX8jhJWOJP852tpL4ihL6bOf0qaaYNartB524T1ibMy5pfYK7ayKYeVpBgw6f4U2R7IEK9owz6IFXQoP-VTCMEWrV0gnKBWbW0G6tosI4UBcwX_OETTaxyTxc26I4cw, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642333927, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.25.0.10, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=70C3A6DB62D25F4906AA5870F69E7F44, http-session-last-accessed-time=1642333628157, kc-category-name=ACCESS, kc-iat=1642333627, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:53134 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:47:08.674  INFO 14 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:47:08.680  INFO 14 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.util.AttributeUtil     : XACML Attribute Categories:
{urn:oasis:names:tc:xacml:1.0:environment:current-date=urn:oasis:names:tc:xacml:3.0:attribute-category:environment, urn:oasis:names:tc:xacml:1.0:environment:current-dateTime=urn:oasis:names:tc:xacml:3.0:attribute-category:environment, actionId=urn:oasis:names:tc:xacml:3.0:attribute-category:action, user.identifier=urn:oasis:names:tc:xacml:1.0:subject-category:access-subject, urn:oasis:names:tc:xacml:1.0:environment:current-time=urn:oasis:names:tc:xacml:3.0:attribute-category:environment, request-id=urn:oasis:names:tc:xacml:3.0:attribute-category:environment, resource-id=urn:oasis:names:tc:xacml:3.0:attribute-category:resource}
2022-01-16 11:47:08.681  INFO 14 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.util.AttributeUtil     : XACML Attribute Data Types:
{urn:oasis:names:tc:xacml:1.0:environment:current-date=http://www.w3.org/2001/XMLSchema#date, urn:oasis:names:tc:xacml:1.0:environment:current-dateTime=http://www.w3.org/2001/XMLSchema#dateTime, actionId=http://www.w3.org/2001/XMLSchema#string, user.identifier=http://www.w3.org/2001/XMLSchema#string, urn:oasis:names:tc:xacml:1.0:environment:current-time=http://www.w3.org/2001/XMLSchema#time, request-id=http://www.w3.org/2001/XMLSchema#string, resource-id=http://www.w3.org/2001/XMLSchema#string}
2022-01-16 11:47:08.700  INFO 14 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3e8557c3
2022-01-16 11:47:08.701  INFO 14 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3e8557c3
2022-01-16 11:47:08.810  INFO 14 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3e8557c3
2022-01-16 11:47:08.811  INFO 14 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3e8557c3
2022-01-16 11:47:08.823  INFO 14 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3e8557c3
2022-01-16 11:47:08.823  WARN 14 --- [https-jsse-nio-7071-exec-6] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:47:08.824  WARN 14 --- [https-jsse-nio-7071-exec-6] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:47:08.824  INFO 14 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3e8557c3
2022-01-16 11:47:08.826  INFO 14 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3e8557c3
2022-01-16 11:47:08.827  WARN 14 --- [https-jsse-nio-7071-exec-6] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:47:08.829  WARN 14 --- [https-jsse-nio-7071-exec-6] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:47:08.829  INFO 14 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3e8557c3
2022-01-16 11:47:08.841  INFO 14 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: emergency-active, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3e8557c3
2022-01-16 11:47:08.858  INFO 14 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3e8557c3
2022-01-16 11:47:08.859  INFO 14 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3e8557c3
2022-01-16 11:47:08.910  INFO 14 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3e8557c3
2022-01-16 11:47:08.910  INFO 14 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-revoke-extra, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3e8557c3
2022-01-16 11:47:08.931  INFO 14 --- [https-jsse-nio-7071-exec-6] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18912079775753170-475394, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=Deny}, TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:47:08.932  INFO 14 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=138dc719-6e38-446c-9846-1e05b35466a3, content=DENY, timestamp=1642333628932, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=Deny}, TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:47:08.936  INFO 14 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=257ms, Total=292ms
2022-01-16 11:47:09.057  INFO 14 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=aebc183b-80d1-47d0-b908-5ea2d0c0c1fb, content=null, timestamp=1642333629005, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=53144, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=4cbbcf975445, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=b07dfbf9-a4f5-4455-8203-a2cec4d67eff, http-req-server-port=80, http-header-accept=*/*, kc-id=6cb35628-1a35-4ce0-a796-86bb2026243f, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642333629002, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQG53NxAH4AEQAAAABh5AW7dAAkNmNiMzU2MjgtMWEzNS00Y2UwLWE3OTYtODZiYjIwMjYyNDNmdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRiMDdkZmJmOS1hNGY1LTQ0NTUtODIwMy1hMmNlYzRkNjdlZmZwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJEdC1tdDI0aWkxQ3VWUnBvbnRqazZNTFA4NFVOZDJDSnVVbTNzQXpGZXVVIn0.eyJleHAiOjE2NDIzMzM5MjcsImlhdCI6MTY0MjMzMzYyNywianRpIjoiNmNiMzU2MjgtMWEzNS00Y2UwLWE3OTYtODZiYjIwMjYyNDNmIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiJiMDdkZmJmOS1hNGY1LTQ0NTUtODIwMy1hMmNlYzRkNjdlZmYiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.LfQC6pOzHJwRKWJa93ShDgM_MdHoxnk9eyFbHPoREooqpMT3SMjbXwdLkCNCA1uopGCigRpu-rVC9ccTKnQlTDgnhvQem_tEjdzsYd5uMdjz4QlUMfilGKUWG6WO3balqXcCrl-G8-mb57iZhC2hQiX9z610oFRxfoiN6aHjOPbc3b5kLm37QHObSimyN-S1yTLGW4ut7qSpExXmOpDwje3DX8jhJWOJP852tpL4ihL6bOf0qaaYNartB524T1ibMy5pfYK7ayKYeVpBgw6f4U2R7IEK9owz6IFXQoP-VTCMEWrV0gnKBWbW0G6tosI4UBcwX_OETTaxyTxc26I4cw, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642333927, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.25.0.10, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=8458B38323214A6B81660054772A474D, http-session-last-accessed-time=1642333629002, kc-category-name=ACCESS, kc-iat=1642333627, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:53144 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:47:09.059  INFO 14 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:47:09.062  INFO 14 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@362959c5
2022-01-16 11:47:09.063  INFO 14 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@362959c5
2022-01-16 11:47:09.081  INFO 14 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@362959c5
2022-01-16 11:47:09.082  INFO 14 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@362959c5
2022-01-16 11:47:09.092  INFO 14 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@362959c5
2022-01-16 11:47:09.093  WARN 14 --- [https-jsse-nio-7071-exec-7] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:47:09.093  WARN 14 --- [https-jsse-nio-7071-exec-7] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:47:09.094  INFO 14 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@362959c5
2022-01-16 11:47:09.095  INFO 14 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@362959c5
2022-01-16 11:47:09.095  WARN 14 --- [https-jsse-nio-7071-exec-7] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:47:09.095  WARN 14 --- [https-jsse-nio-7071-exec-7] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:47:09.096  INFO 14 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@362959c5
2022-01-16 11:47:09.150  INFO 14 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: emergency-active, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@362959c5
2022-01-16 11:47:09.160  INFO 14 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@362959c5
2022-01-16 11:47:09.161  INFO 14 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@362959c5
2022-01-16 11:47:09.172  INFO 14 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@362959c5
2022-01-16 11:47:09.172  INFO 14 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-revoke-extra, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@362959c5
2022-01-16 11:47:09.228  INFO 14 --- [https-jsse-nio-7071-exec-7] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18912080161220817-579631, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=Deny}, TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:47:09.229  INFO 14 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=aebc183b-80d1-47d0-b908-5ea2d0c0c1fb, content=DENY, timestamp=1642333629229, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=Deny}, TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:47:09.231  INFO 14 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=169ms, Total=179ms
2022-01-16 11:47:09.272  INFO 14 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=b8f595ca-9adb-4e76-8db1-4eb1a90e523b, content=null, timestamp=1642333629258, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=53146, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=4cbbcf975445, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=b07dfbf9-a4f5-4455-8203-a2cec4d67eff, http-req-server-port=80, http-header-accept=*/*, kc-id=6cb35628-1a35-4ce0-a796-86bb2026243f, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642333629257, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQG53NxAH4AEQAAAABh5AW7dAAkNmNiMzU2MjgtMWEzNS00Y2UwLWE3OTYtODZiYjIwMjYyNDNmdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRiMDdkZmJmOS1hNGY1LTQ0NTUtODIwMy1hMmNlYzRkNjdlZmZwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJEdC1tdDI0aWkxQ3VWUnBvbnRqazZNTFA4NFVOZDJDSnVVbTNzQXpGZXVVIn0.eyJleHAiOjE2NDIzMzM5MjcsImlhdCI6MTY0MjMzMzYyNywianRpIjoiNmNiMzU2MjgtMWEzNS00Y2UwLWE3OTYtODZiYjIwMjYyNDNmIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiJiMDdkZmJmOS1hNGY1LTQ0NTUtODIwMy1hMmNlYzRkNjdlZmYiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.LfQC6pOzHJwRKWJa93ShDgM_MdHoxnk9eyFbHPoREooqpMT3SMjbXwdLkCNCA1uopGCigRpu-rVC9ccTKnQlTDgnhvQem_tEjdzsYd5uMdjz4QlUMfilGKUWG6WO3balqXcCrl-G8-mb57iZhC2hQiX9z610oFRxfoiN6aHjOPbc3b5kLm37QHObSimyN-S1yTLGW4ut7qSpExXmOpDwje3DX8jhJWOJP852tpL4ihL6bOf0qaaYNartB524T1ibMy5pfYK7ayKYeVpBgw6f4U2R7IEK9owz6IFXQoP-VTCMEWrV0gnKBWbW0G6tosI4UBcwX_OETTaxyTxc26I4cw, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642333927, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.25.0.10, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=29999180AE4759FD7B79474C4DB85995, http-session-last-accessed-time=1642333629257, kc-category-name=ACCESS, kc-iat=1642333627, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:53146 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:47:09.272  INFO 14 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:47:09.274  INFO 14 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4868ca25
2022-01-16 11:47:09.274  INFO 14 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4868ca25
2022-01-16 11:47:09.285  INFO 14 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4868ca25
2022-01-16 11:47:09.285  INFO 14 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4868ca25
2022-01-16 11:47:09.293  INFO 14 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4868ca25
2022-01-16 11:47:09.294  WARN 14 --- [https-jsse-nio-7071-exec-8] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:47:09.294  WARN 14 --- [https-jsse-nio-7071-exec-8] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:47:09.294  INFO 14 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4868ca25
2022-01-16 11:47:09.295  INFO 14 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4868ca25
2022-01-16 11:47:09.295  WARN 14 --- [https-jsse-nio-7071-exec-8] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:47:09.295  WARN 14 --- [https-jsse-nio-7071-exec-8] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:47:09.295  INFO 14 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4868ca25
2022-01-16 11:47:09.345  INFO 14 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: emergency-active, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4868ca25
2022-01-16 11:47:09.356  INFO 14 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4868ca25
2022-01-16 11:47:09.356  INFO 14 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4868ca25
2022-01-16 11:47:09.373  INFO 14 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4868ca25
2022-01-16 11:47:09.374  INFO 14 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-revoke-extra, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4868ca25
2022-01-16 11:47:09.426  INFO 14 --- [https-jsse-nio-7071-exec-8] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18912080373948449-507492, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=Deny}, TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:47:09.427  INFO 14 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=b8f595ca-9adb-4e76-8db1-4eb1a90e523b, content=DENY, timestamp=1642333629427, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=Deny}, TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:47:09.427  INFO 14 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=155ms, Total=158ms
2022-01-16 11:47:09.474  INFO 14 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=c654a115-5cd4-49cd-9ccd-7f271cb871ee, content=null, timestamp=1642333629446, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=53148, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=4cbbcf975445, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=b07dfbf9-a4f5-4455-8203-a2cec4d67eff, http-req-server-port=80, http-header-accept=*/*, kc-id=6cb35628-1a35-4ce0-a796-86bb2026243f, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642333629441, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQG53NxAH4AEQAAAABh5AW7dAAkNmNiMzU2MjgtMWEzNS00Y2UwLWE3OTYtODZiYjIwMjYyNDNmdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRiMDdkZmJmOS1hNGY1LTQ0NTUtODIwMy1hMmNlYzRkNjdlZmZwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJEdC1tdDI0aWkxQ3VWUnBvbnRqazZNTFA4NFVOZDJDSnVVbTNzQXpGZXVVIn0.eyJleHAiOjE2NDIzMzM5MjcsImlhdCI6MTY0MjMzMzYyNywianRpIjoiNmNiMzU2MjgtMWEzNS00Y2UwLWE3OTYtODZiYjIwMjYyNDNmIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiJiMDdkZmJmOS1hNGY1LTQ0NTUtODIwMy1hMmNlYzRkNjdlZmYiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.LfQC6pOzHJwRKWJa93ShDgM_MdHoxnk9eyFbHPoREooqpMT3SMjbXwdLkCNCA1uopGCigRpu-rVC9ccTKnQlTDgnhvQem_tEjdzsYd5uMdjz4QlUMfilGKUWG6WO3balqXcCrl-G8-mb57iZhC2hQiX9z610oFRxfoiN6aHjOPbc3b5kLm37QHObSimyN-S1yTLGW4ut7qSpExXmOpDwje3DX8jhJWOJP852tpL4ihL6bOf0qaaYNartB524T1ibMy5pfYK7ayKYeVpBgw6f4U2R7IEK9owz6IFXQoP-VTCMEWrV0gnKBWbW0G6tosI4UBcwX_OETTaxyTxc26I4cw, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642333927, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.25.0.10, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=4F60738DC1626C4F8F06D06F95D6B763, http-session-last-accessed-time=1642333629441, kc-category-name=ACCESS, kc-iat=1642333627, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:53148 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:47:09.478  INFO 14 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:47:09.482  INFO 14 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@b27077e
2022-01-16 11:47:09.483  INFO 14 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@b27077e
2022-01-16 11:47:09.497  INFO 14 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@b27077e
2022-01-16 11:47:09.497  INFO 14 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@b27077e
2022-01-16 11:47:09.508  INFO 14 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@b27077e
2022-01-16 11:47:09.508  WARN 14 --- [https-jsse-nio-7071-exec-9] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:47:09.509  WARN 14 --- [https-jsse-nio-7071-exec-9] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:47:09.509  INFO 14 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@b27077e
2022-01-16 11:47:09.510  INFO 14 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@b27077e
2022-01-16 11:47:09.510  WARN 14 --- [https-jsse-nio-7071-exec-9] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:47:09.510  WARN 14 --- [https-jsse-nio-7071-exec-9] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:47:09.510  INFO 14 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@b27077e
2022-01-16 11:47:09.561  INFO 14 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: emergency-active, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@b27077e
2022-01-16 11:47:09.574  INFO 14 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@b27077e
2022-01-16 11:47:09.575  INFO 14 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@b27077e
2022-01-16 11:47:09.583  INFO 14 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@b27077e
2022-01-16 11:47:09.584  INFO 14 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-revoke-extra, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@b27077e
2022-01-16 11:47:09.634  INFO 14 --- [https-jsse-nio-7071-exec-9] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18912080580099064-781270, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=Deny}, TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:47:09.634  INFO 14 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=c654a115-5cd4-49cd-9ccd-7f271cb871ee, content=DENY, timestamp=1642333629634, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=Deny}, TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:47:09.635  INFO 14 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=155ms, Total=165ms
2022-01-16 11:47:09.674  INFO 14 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=623187e3-d34a-443a-874f-78c9a5c8edf2, content=null, timestamp=1642333629654, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=53150, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=4cbbcf975445, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=b07dfbf9-a4f5-4455-8203-a2cec4d67eff, http-req-server-port=80, http-header-accept=*/*, kc-id=6cb35628-1a35-4ce0-a796-86bb2026243f, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642333629651, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQG53NxAH4AEQAAAABh5AW7dAAkNmNiMzU2MjgtMWEzNS00Y2UwLWE3OTYtODZiYjIwMjYyNDNmdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRiMDdkZmJmOS1hNGY1LTQ0NTUtODIwMy1hMmNlYzRkNjdlZmZwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJEdC1tdDI0aWkxQ3VWUnBvbnRqazZNTFA4NFVOZDJDSnVVbTNzQXpGZXVVIn0.eyJleHAiOjE2NDIzMzM5MjcsImlhdCI6MTY0MjMzMzYyNywianRpIjoiNmNiMzU2MjgtMWEzNS00Y2UwLWE3OTYtODZiYjIwMjYyNDNmIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiJiMDdkZmJmOS1hNGY1LTQ0NTUtODIwMy1hMmNlYzRkNjdlZmYiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.LfQC6pOzHJwRKWJa93ShDgM_MdHoxnk9eyFbHPoREooqpMT3SMjbXwdLkCNCA1uopGCigRpu-rVC9ccTKnQlTDgnhvQem_tEjdzsYd5uMdjz4QlUMfilGKUWG6WO3balqXcCrl-G8-mb57iZhC2hQiX9z610oFRxfoiN6aHjOPbc3b5kLm37QHObSimyN-S1yTLGW4ut7qSpExXmOpDwje3DX8jhJWOJP852tpL4ihL6bOf0qaaYNartB524T1ibMy5pfYK7ayKYeVpBgw6f4U2R7IEK9owz6IFXQoP-VTCMEWrV0gnKBWbW0G6tosI4UBcwX_OETTaxyTxc26I4cw, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642333927, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.25.0.10, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=1DFF8BC567640B04FEF45DF1929DF4BB, http-session-last-accessed-time=1642333629651, kc-category-name=ACCESS, kc-iat=1642333627, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:53150 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:47:09.676  INFO 14 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:47:09.677  INFO 14 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@237e41da
2022-01-16 11:47:09.678  INFO 14 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@237e41da
2022-01-16 11:47:09.688  INFO 14 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@237e41da
2022-01-16 11:47:09.689  INFO 14 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@237e41da
2022-01-16 11:47:09.701  INFO 14 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@237e41da
2022-01-16 11:47:09.701  WARN 14 --- [https-jsse-nio-7071-exec-10] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:47:09.702  WARN 14 --- [https-jsse-nio-7071-exec-10] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:47:09.702  INFO 14 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@237e41da
2022-01-16 11:47:09.702  INFO 14 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@237e41da
2022-01-16 11:47:09.703  WARN 14 --- [https-jsse-nio-7071-exec-10] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:47:09.703  WARN 14 --- [https-jsse-nio-7071-exec-10] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:47:09.703  INFO 14 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@237e41da
2022-01-16 11:47:09.766  INFO 14 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: emergency-active, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@237e41da
2022-01-16 11:47:09.776  INFO 14 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@237e41da
2022-01-16 11:47:09.777  INFO 14 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@237e41da
2022-01-16 11:47:09.787  INFO 14 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@237e41da
2022-01-16 11:47:09.788  INFO 14 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-revoke-extra, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@237e41da
2022-01-16 11:47:09.838  INFO 14 --- [https-jsse-nio-7071-exec-10] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18912080777940341-905710, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=Deny}, TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:47:09.839  INFO 14 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=623187e3-d34a-443a-874f-78c9a5c8edf2, content=DENY, timestamp=1642333629839, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=Deny}, TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:47:09.839  INFO 14 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=163ms, Total=166ms
2022-01-16 11:47:09.872  INFO 14 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=c8dc71f1-6844-4def-8e31-dd9bf1162024, content=null, timestamp=1642333629862, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=53152, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=4cbbcf975445, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=b07dfbf9-a4f5-4455-8203-a2cec4d67eff, http-req-server-port=80, http-header-accept=*/*, kc-id=6cb35628-1a35-4ce0-a796-86bb2026243f, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642333629856, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQG53NxAH4AEQAAAABh5AW7dAAkNmNiMzU2MjgtMWEzNS00Y2UwLWE3OTYtODZiYjIwMjYyNDNmdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRiMDdkZmJmOS1hNGY1LTQ0NTUtODIwMy1hMmNlYzRkNjdlZmZwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJEdC1tdDI0aWkxQ3VWUnBvbnRqazZNTFA4NFVOZDJDSnVVbTNzQXpGZXVVIn0.eyJleHAiOjE2NDIzMzM5MjcsImlhdCI6MTY0MjMzMzYyNywianRpIjoiNmNiMzU2MjgtMWEzNS00Y2UwLWE3OTYtODZiYjIwMjYyNDNmIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiJiMDdkZmJmOS1hNGY1LTQ0NTUtODIwMy1hMmNlYzRkNjdlZmYiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.LfQC6pOzHJwRKWJa93ShDgM_MdHoxnk9eyFbHPoREooqpMT3SMjbXwdLkCNCA1uopGCigRpu-rVC9ccTKnQlTDgnhvQem_tEjdzsYd5uMdjz4QlUMfilGKUWG6WO3balqXcCrl-G8-mb57iZhC2hQiX9z610oFRxfoiN6aHjOPbc3b5kLm37QHObSimyN-S1yTLGW4ut7qSpExXmOpDwje3DX8jhJWOJP852tpL4ihL6bOf0qaaYNartB524T1ibMy5pfYK7ayKYeVpBgw6f4U2R7IEK9owz6IFXQoP-VTCMEWrV0gnKBWbW0G6tosI4UBcwX_OETTaxyTxc26I4cw, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642333927, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.25.0.10, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=22EF828BCEABBE87A25A822755C8A7A5, http-session-last-accessed-time=1642333629856, kc-category-name=ACCESS, kc-iat=1642333627, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:53152 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:47:09.873  INFO 14 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:47:09.874  INFO 14 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@401da3b7
2022-01-16 11:47:09.874  INFO 14 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@401da3b7
2022-01-16 11:47:09.889  INFO 14 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@401da3b7
2022-01-16 11:47:09.889  INFO 14 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@401da3b7
2022-01-16 11:47:09.904  INFO 14 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@401da3b7
2022-01-16 11:47:09.904  WARN 14 --- [https-jsse-nio-7071-exec-1] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:47:09.904  WARN 14 --- [https-jsse-nio-7071-exec-1] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:47:09.905  INFO 14 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@401da3b7
2022-01-16 11:47:09.905  INFO 14 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@401da3b7
2022-01-16 11:47:09.905  WARN 14 --- [https-jsse-nio-7071-exec-1] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:47:09.905  WARN 14 --- [https-jsse-nio-7071-exec-1] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:47:09.906  INFO 14 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@401da3b7
2022-01-16 11:47:09.961  INFO 14 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: emergency-active, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@401da3b7
2022-01-16 11:47:09.974  INFO 14 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@401da3b7
2022-01-16 11:47:09.974  INFO 14 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@401da3b7
2022-01-16 11:47:09.984  INFO 14 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@401da3b7
2022-01-16 11:47:09.984  INFO 14 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-revoke-extra, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@401da3b7
2022-01-16 11:47:10.039  INFO 14 --- [https-jsse-nio-7071-exec-1] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18912080974483915-866380, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=Deny}, TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:47:10.039  INFO 14 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=c8dc71f1-6844-4def-8e31-dd9bf1162024, content=DENY, timestamp=1642333630039, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=Deny}, TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:47:10.040  INFO 14 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=166ms, Total=170ms
2022-01-16 11:47:10.067  INFO 14 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=88e8c071-a39b-4485-bc4b-855e677de438, content=null, timestamp=1642333630060, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=53154, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=4cbbcf975445, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=b07dfbf9-a4f5-4455-8203-a2cec4d67eff, http-req-server-port=80, http-header-accept=*/*, kc-id=6cb35628-1a35-4ce0-a796-86bb2026243f, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642333630058, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQG53NxAH4AEQAAAABh5AW7dAAkNmNiMzU2MjgtMWEzNS00Y2UwLWE3OTYtODZiYjIwMjYyNDNmdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRiMDdkZmJmOS1hNGY1LTQ0NTUtODIwMy1hMmNlYzRkNjdlZmZwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJEdC1tdDI0aWkxQ3VWUnBvbnRqazZNTFA4NFVOZDJDSnVVbTNzQXpGZXVVIn0.eyJleHAiOjE2NDIzMzM5MjcsImlhdCI6MTY0MjMzMzYyNywianRpIjoiNmNiMzU2MjgtMWEzNS00Y2UwLWE3OTYtODZiYjIwMjYyNDNmIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiJiMDdkZmJmOS1hNGY1LTQ0NTUtODIwMy1hMmNlYzRkNjdlZmYiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.LfQC6pOzHJwRKWJa93ShDgM_MdHoxnk9eyFbHPoREooqpMT3SMjbXwdLkCNCA1uopGCigRpu-rVC9ccTKnQlTDgnhvQem_tEjdzsYd5uMdjz4QlUMfilGKUWG6WO3balqXcCrl-G8-mb57iZhC2hQiX9z610oFRxfoiN6aHjOPbc3b5kLm37QHObSimyN-S1yTLGW4ut7qSpExXmOpDwje3DX8jhJWOJP852tpL4ihL6bOf0qaaYNartB524T1ibMy5pfYK7ayKYeVpBgw6f4U2R7IEK9owz6IFXQoP-VTCMEWrV0gnKBWbW0G6tosI4UBcwX_OETTaxyTxc26I4cw, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642333927, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.25.0.10, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=5F83DB612C35287D0850DE44C3DDA526, http-session-last-accessed-time=1642333630058, kc-category-name=ACCESS, kc-iat=1642333627, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:53154 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:47:10.068  INFO 14 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:47:10.069  INFO 14 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@33f568d2
2022-01-16 11:47:10.070  INFO 14 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@33f568d2
2022-01-16 11:47:10.081  INFO 14 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@33f568d2
2022-01-16 11:47:10.081  INFO 14 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@33f568d2
2022-01-16 11:47:10.090  INFO 14 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@33f568d2
2022-01-16 11:47:10.090  WARN 14 --- [https-jsse-nio-7071-exec-2] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:47:10.090  WARN 14 --- [https-jsse-nio-7071-exec-2] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:47:10.091  INFO 14 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@33f568d2
2022-01-16 11:47:10.091  INFO 14 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@33f568d2
2022-01-16 11:47:10.092  WARN 14 --- [https-jsse-nio-7071-exec-2] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:47:10.092  WARN 14 --- [https-jsse-nio-7071-exec-2] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:47:10.092  INFO 14 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@33f568d2
2022-01-16 11:47:10.141  INFO 14 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: emergency-active, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@33f568d2
2022-01-16 11:47:10.150  INFO 14 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@33f568d2
2022-01-16 11:47:10.151  INFO 14 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@33f568d2
2022-01-16 11:47:10.160  INFO 14 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@33f568d2
2022-01-16 11:47:10.160  INFO 14 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-revoke-extra, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@33f568d2
2022-01-16 11:47:10.214  INFO 14 --- [https-jsse-nio-7071-exec-2] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18912081169369321-299259, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=Deny}, TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:47:10.215  INFO 14 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=88e8c071-a39b-4485-bc4b-855e677de438, content=DENY, timestamp=1642333630215, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=Deny}, TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:47:10.216  INFO 14 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=147ms, Total=151ms
2022-01-16 11:47:10.240  INFO 14 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=d955f9e2-9d74-44bf-887a-85296b20176d, content=null, timestamp=1642333630232, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=53156, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=4cbbcf975445, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=b07dfbf9-a4f5-4455-8203-a2cec4d67eff, http-req-server-port=80, http-header-accept=*/*, kc-id=6cb35628-1a35-4ce0-a796-86bb2026243f, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642333630230, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQG53NxAH4AEQAAAABh5AW7dAAkNmNiMzU2MjgtMWEzNS00Y2UwLWE3OTYtODZiYjIwMjYyNDNmdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRiMDdkZmJmOS1hNGY1LTQ0NTUtODIwMy1hMmNlYzRkNjdlZmZwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJEdC1tdDI0aWkxQ3VWUnBvbnRqazZNTFA4NFVOZDJDSnVVbTNzQXpGZXVVIn0.eyJleHAiOjE2NDIzMzM5MjcsImlhdCI6MTY0MjMzMzYyNywianRpIjoiNmNiMzU2MjgtMWEzNS00Y2UwLWE3OTYtODZiYjIwMjYyNDNmIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiJiMDdkZmJmOS1hNGY1LTQ0NTUtODIwMy1hMmNlYzRkNjdlZmYiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.LfQC6pOzHJwRKWJa93ShDgM_MdHoxnk9eyFbHPoREooqpMT3SMjbXwdLkCNCA1uopGCigRpu-rVC9ccTKnQlTDgnhvQem_tEjdzsYd5uMdjz4QlUMfilGKUWG6WO3balqXcCrl-G8-mb57iZhC2hQiX9z610oFRxfoiN6aHjOPbc3b5kLm37QHObSimyN-S1yTLGW4ut7qSpExXmOpDwje3DX8jhJWOJP852tpL4ihL6bOf0qaaYNartB524T1ibMy5pfYK7ayKYeVpBgw6f4U2R7IEK9owz6IFXQoP-VTCMEWrV0gnKBWbW0G6tosI4UBcwX_OETTaxyTxc26I4cw, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642333927, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.25.0.10, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=F3989B1EAB2A99CFBF778DEC1A114AE1, http-session-last-accessed-time=1642333630230, kc-category-name=ACCESS, kc-iat=1642333627, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:53156 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:47:10.243  INFO 14 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:47:10.244  INFO 14 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@48522df3
2022-01-16 11:47:10.245  INFO 14 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@48522df3
2022-01-16 11:47:10.256  INFO 14 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@48522df3
2022-01-16 11:47:10.256  INFO 14 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@48522df3
2022-01-16 11:47:10.265  INFO 14 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@48522df3
2022-01-16 11:47:10.267  WARN 14 --- [https-jsse-nio-7071-exec-3] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:47:10.267  WARN 14 --- [https-jsse-nio-7071-exec-3] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:47:10.268  INFO 14 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@48522df3
2022-01-16 11:47:10.268  INFO 14 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@48522df3
2022-01-16 11:47:10.269  WARN 14 --- [https-jsse-nio-7071-exec-3] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:47:10.269  WARN 14 --- [https-jsse-nio-7071-exec-3] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:47:10.269  INFO 14 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@48522df3
2022-01-16 11:47:10.329  INFO 14 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: emergency-active, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@48522df3
2022-01-16 11:47:10.341  INFO 14 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@48522df3
2022-01-16 11:47:10.341  INFO 14 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@48522df3
2022-01-16 11:47:10.352  INFO 14 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@48522df3
2022-01-16 11:47:10.353  INFO 14 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-revoke-extra, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@48522df3
2022-01-16 11:47:10.411  INFO 14 --- [https-jsse-nio-7071-exec-3] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18912081344605919-336249, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=Deny}, TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:47:10.411  INFO 14 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=d955f9e2-9d74-44bf-887a-85296b20176d, content=DENY, timestamp=1642333630411, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=Deny}, TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:47:10.412  INFO 14 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=168ms, Total=173ms
2022-01-16 11:47:10.467  INFO 14 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=deb295d1-936b-4422-9790-94c9481231bc, content=null, timestamp=1642333630447, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=53158, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=4cbbcf975445, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=b07dfbf9-a4f5-4455-8203-a2cec4d67eff, http-req-server-port=80, http-header-accept=*/*, kc-id=6cb35628-1a35-4ce0-a796-86bb2026243f, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642333630446, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQG53NxAH4AEQAAAABh5AW7dAAkNmNiMzU2MjgtMWEzNS00Y2UwLWE3OTYtODZiYjIwMjYyNDNmdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRiMDdkZmJmOS1hNGY1LTQ0NTUtODIwMy1hMmNlYzRkNjdlZmZwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJEdC1tdDI0aWkxQ3VWUnBvbnRqazZNTFA4NFVOZDJDSnVVbTNzQXpGZXVVIn0.eyJleHAiOjE2NDIzMzM5MjcsImlhdCI6MTY0MjMzMzYyNywianRpIjoiNmNiMzU2MjgtMWEzNS00Y2UwLWE3OTYtODZiYjIwMjYyNDNmIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiJiMDdkZmJmOS1hNGY1LTQ0NTUtODIwMy1hMmNlYzRkNjdlZmYiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.LfQC6pOzHJwRKWJa93ShDgM_MdHoxnk9eyFbHPoREooqpMT3SMjbXwdLkCNCA1uopGCigRpu-rVC9ccTKnQlTDgnhvQem_tEjdzsYd5uMdjz4QlUMfilGKUWG6WO3balqXcCrl-G8-mb57iZhC2hQiX9z610oFRxfoiN6aHjOPbc3b5kLm37QHObSimyN-S1yTLGW4ut7qSpExXmOpDwje3DX8jhJWOJP852tpL4ihL6bOf0qaaYNartB524T1ibMy5pfYK7ayKYeVpBgw6f4U2R7IEK9owz6IFXQoP-VTCMEWrV0gnKBWbW0G6tosI4UBcwX_OETTaxyTxc26I4cw, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642333927, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.25.0.10, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=FCFDB5F845B42AF7553140D2243384F9, http-session-last-accessed-time=1642333630446, kc-category-name=ACCESS, kc-iat=1642333627, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:53158 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:47:10.468  INFO 14 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:47:10.470  INFO 14 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@445b1ebc
2022-01-16 11:47:10.470  INFO 14 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@445b1ebc
2022-01-16 11:47:10.485  INFO 14 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@445b1ebc
2022-01-16 11:47:10.486  INFO 14 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@445b1ebc
2022-01-16 11:47:10.496  INFO 14 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@445b1ebc
2022-01-16 11:47:10.496  WARN 14 --- [https-jsse-nio-7071-exec-4] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:47:10.496  WARN 14 --- [https-jsse-nio-7071-exec-4] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:47:10.497  INFO 14 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@445b1ebc
2022-01-16 11:47:10.498  INFO 14 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@445b1ebc
2022-01-16 11:47:10.498  WARN 14 --- [https-jsse-nio-7071-exec-4] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:47:10.498  WARN 14 --- [https-jsse-nio-7071-exec-4] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:47:10.499  INFO 14 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@445b1ebc
2022-01-16 11:47:10.554  INFO 14 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: emergency-active, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@445b1ebc
2022-01-16 11:47:10.569  INFO 14 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@445b1ebc
2022-01-16 11:47:10.571  INFO 14 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@445b1ebc
2022-01-16 11:47:10.582  INFO 14 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@445b1ebc
2022-01-16 11:47:10.583  INFO 14 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-revoke-extra, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@445b1ebc
2022-01-16 11:47:10.634  INFO 14 --- [https-jsse-nio-7071-exec-4] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18912081569948693-413608, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=Deny}, TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:47:10.635  INFO 14 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=deb295d1-936b-4422-9790-94c9481231bc, content=DENY, timestamp=1642333630635, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=Deny}, TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:47:10.635  INFO 14 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=167ms, Total=169ms
2022-01-16 11:47:10.662  INFO 14 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=cabaaca5-3639-4aad-86ca-83e7117e1593, content=null, timestamp=1642333630655, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=53160, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=4cbbcf975445, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=b07dfbf9-a4f5-4455-8203-a2cec4d67eff, http-req-server-port=80, http-header-accept=*/*, kc-id=6cb35628-1a35-4ce0-a796-86bb2026243f, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642333630653, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQG53NxAH4AEQAAAABh5AW7dAAkNmNiMzU2MjgtMWEzNS00Y2UwLWE3OTYtODZiYjIwMjYyNDNmdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRiMDdkZmJmOS1hNGY1LTQ0NTUtODIwMy1hMmNlYzRkNjdlZmZwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJEdC1tdDI0aWkxQ3VWUnBvbnRqazZNTFA4NFVOZDJDSnVVbTNzQXpGZXVVIn0.eyJleHAiOjE2NDIzMzM5MjcsImlhdCI6MTY0MjMzMzYyNywianRpIjoiNmNiMzU2MjgtMWEzNS00Y2UwLWE3OTYtODZiYjIwMjYyNDNmIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiJiMDdkZmJmOS1hNGY1LTQ0NTUtODIwMy1hMmNlYzRkNjdlZmYiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.LfQC6pOzHJwRKWJa93ShDgM_MdHoxnk9eyFbHPoREooqpMT3SMjbXwdLkCNCA1uopGCigRpu-rVC9ccTKnQlTDgnhvQem_tEjdzsYd5uMdjz4QlUMfilGKUWG6WO3balqXcCrl-G8-mb57iZhC2hQiX9z610oFRxfoiN6aHjOPbc3b5kLm37QHObSimyN-S1yTLGW4ut7qSpExXmOpDwje3DX8jhJWOJP852tpL4ihL6bOf0qaaYNartB524T1ibMy5pfYK7ayKYeVpBgw6f4U2R7IEK9owz6IFXQoP-VTCMEWrV0gnKBWbW0G6tosI4UBcwX_OETTaxyTxc26I4cw, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642333927, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.25.0.10, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=E0C2594FCEA33475F3EFCE99FA97D14A, http-session-last-accessed-time=1642333630653, kc-category-name=ACCESS, kc-iat=1642333627, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:53160 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:47:10.663  INFO 14 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:47:10.664  INFO 14 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2306b3c4
2022-01-16 11:47:10.665  INFO 14 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2306b3c4
2022-01-16 11:47:10.676  INFO 14 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2306b3c4
2022-01-16 11:47:10.677  INFO 14 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2306b3c4
2022-01-16 11:47:10.688  INFO 14 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2306b3c4
2022-01-16 11:47:10.689  WARN 14 --- [https-jsse-nio-7071-exec-5] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:47:10.689  WARN 14 --- [https-jsse-nio-7071-exec-5] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:47:10.689  INFO 14 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2306b3c4
2022-01-16 11:47:10.691  INFO 14 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2306b3c4
2022-01-16 11:47:10.691  WARN 14 --- [https-jsse-nio-7071-exec-5] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:47:10.692  WARN 14 --- [https-jsse-nio-7071-exec-5] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:47:10.692  INFO 14 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2306b3c4
2022-01-16 11:47:10.742  INFO 14 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: emergency-active, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2306b3c4
2022-01-16 11:47:10.750  INFO 14 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2306b3c4
2022-01-16 11:47:10.750  INFO 14 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2306b3c4
2022-01-16 11:47:10.759  INFO 14 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2306b3c4
2022-01-16 11:47:10.759  INFO 14 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-revoke-extra, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2306b3c4
2022-01-16 11:47:10.814  INFO 14 --- [https-jsse-nio-7071-exec-5] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18912081764710846-602703, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=Deny}, TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:47:10.815  INFO 14 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=cabaaca5-3639-4aad-86ca-83e7117e1593, content=DENY, timestamp=1642333630815, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=Deny}, TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:47:10.815  INFO 14 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=152ms, Total=155ms
2022-01-16 11:47:10.839  INFO 14 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=461dd8b7-abb8-4bf1-9904-bc19d32b2a1a, content=null, timestamp=1642333630834, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=53162, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=4cbbcf975445, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=b07dfbf9-a4f5-4455-8203-a2cec4d67eff, http-req-server-port=80, http-header-accept=*/*, kc-id=6cb35628-1a35-4ce0-a796-86bb2026243f, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642333630831, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQG53NxAH4AEQAAAABh5AW7dAAkNmNiMzU2MjgtMWEzNS00Y2UwLWE3OTYtODZiYjIwMjYyNDNmdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRiMDdkZmJmOS1hNGY1LTQ0NTUtODIwMy1hMmNlYzRkNjdlZmZwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJEdC1tdDI0aWkxQ3VWUnBvbnRqazZNTFA4NFVOZDJDSnVVbTNzQXpGZXVVIn0.eyJleHAiOjE2NDIzMzM5MjcsImlhdCI6MTY0MjMzMzYyNywianRpIjoiNmNiMzU2MjgtMWEzNS00Y2UwLWE3OTYtODZiYjIwMjYyNDNmIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiJiMDdkZmJmOS1hNGY1LTQ0NTUtODIwMy1hMmNlYzRkNjdlZmYiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.LfQC6pOzHJwRKWJa93ShDgM_MdHoxnk9eyFbHPoREooqpMT3SMjbXwdLkCNCA1uopGCigRpu-rVC9ccTKnQlTDgnhvQem_tEjdzsYd5uMdjz4QlUMfilGKUWG6WO3balqXcCrl-G8-mb57iZhC2hQiX9z610oFRxfoiN6aHjOPbc3b5kLm37QHObSimyN-S1yTLGW4ut7qSpExXmOpDwje3DX8jhJWOJP852tpL4ihL6bOf0qaaYNartB524T1ibMy5pfYK7ayKYeVpBgw6f4U2R7IEK9owz6IFXQoP-VTCMEWrV0gnKBWbW0G6tosI4UBcwX_OETTaxyTxc26I4cw, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642333927, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.25.0.10, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=43A5F49634C40662ED632D2C40D7391F, http-session-last-accessed-time=1642333630831, kc-category-name=ACCESS, kc-iat=1642333627, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:53162 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:47:10.840  INFO 14 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:47:10.841  INFO 14 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@11d20fd5
2022-01-16 11:47:10.845  INFO 14 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@11d20fd5
2022-01-16 11:47:10.855  INFO 14 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@11d20fd5
2022-01-16 11:47:10.856  INFO 14 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@11d20fd5
2022-01-16 11:47:10.868  INFO 14 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@11d20fd5
2022-01-16 11:47:10.868  WARN 14 --- [https-jsse-nio-7071-exec-6] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:47:10.869  WARN 14 --- [https-jsse-nio-7071-exec-6] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:47:10.869  INFO 14 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@11d20fd5
2022-01-16 11:47:10.869  INFO 14 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@11d20fd5
2022-01-16 11:47:10.870  WARN 14 --- [https-jsse-nio-7071-exec-6] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:47:10.870  WARN 14 --- [https-jsse-nio-7071-exec-6] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:47:10.870  INFO 14 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@11d20fd5
2022-01-16 11:47:10.930  INFO 14 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: emergency-active, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@11d20fd5
2022-01-16 11:47:10.948  INFO 14 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@11d20fd5
2022-01-16 11:47:10.949  INFO 14 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@11d20fd5
2022-01-16 11:47:10.968  INFO 14 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@11d20fd5
2022-01-16 11:47:10.968  INFO 14 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-revoke-extra, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@11d20fd5
2022-01-16 11:47:11.026  INFO 14 --- [https-jsse-nio-7071-exec-6] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18912081941873557-648710, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=Deny}, TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:47:11.027  INFO 14 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=461dd8b7-abb8-4bf1-9904-bc19d32b2a1a, content=DENY, timestamp=1642333631027, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=Deny}, TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:47:11.027  INFO 14 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=187ms, Total=189ms
2022-01-16 11:47:11.048  INFO 14 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=fa763388-7122-4f08-bb27-5abad8d3dcb1, content=null, timestamp=1642333631043, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=53164, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=4cbbcf975445, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=b07dfbf9-a4f5-4455-8203-a2cec4d67eff, http-req-server-port=80, http-header-accept=*/*, kc-id=6cb35628-1a35-4ce0-a796-86bb2026243f, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642333631041, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQG53NxAH4AEQAAAABh5AW7dAAkNmNiMzU2MjgtMWEzNS00Y2UwLWE3OTYtODZiYjIwMjYyNDNmdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRiMDdkZmJmOS1hNGY1LTQ0NTUtODIwMy1hMmNlYzRkNjdlZmZwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJEdC1tdDI0aWkxQ3VWUnBvbnRqazZNTFA4NFVOZDJDSnVVbTNzQXpGZXVVIn0.eyJleHAiOjE2NDIzMzM5MjcsImlhdCI6MTY0MjMzMzYyNywianRpIjoiNmNiMzU2MjgtMWEzNS00Y2UwLWE3OTYtODZiYjIwMjYyNDNmIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiJiMDdkZmJmOS1hNGY1LTQ0NTUtODIwMy1hMmNlYzRkNjdlZmYiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.LfQC6pOzHJwRKWJa93ShDgM_MdHoxnk9eyFbHPoREooqpMT3SMjbXwdLkCNCA1uopGCigRpu-rVC9ccTKnQlTDgnhvQem_tEjdzsYd5uMdjz4QlUMfilGKUWG6WO3balqXcCrl-G8-mb57iZhC2hQiX9z610oFRxfoiN6aHjOPbc3b5kLm37QHObSimyN-S1yTLGW4ut7qSpExXmOpDwje3DX8jhJWOJP852tpL4ihL6bOf0qaaYNartB524T1ibMy5pfYK7ayKYeVpBgw6f4U2R7IEK9owz6IFXQoP-VTCMEWrV0gnKBWbW0G6tosI4UBcwX_OETTaxyTxc26I4cw, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642333927, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.25.0.10, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=AA2707F70C920DE411200DEDC45A6B3E, http-session-last-accessed-time=1642333631041, kc-category-name=ACCESS, kc-iat=1642333627, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:53164 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:47:11.049  INFO 14 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:47:11.050  INFO 14 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4de4c4f1
2022-01-16 11:47:11.050  INFO 14 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4de4c4f1
2022-01-16 11:47:11.073  INFO 14 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4de4c4f1
2022-01-16 11:47:11.074  INFO 14 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4de4c4f1
2022-01-16 11:47:11.087  INFO 14 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4de4c4f1
2022-01-16 11:47:11.087  WARN 14 --- [https-jsse-nio-7071-exec-7] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:47:11.087  WARN 14 --- [https-jsse-nio-7071-exec-7] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:47:11.087  INFO 14 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4de4c4f1
2022-01-16 11:47:11.087  INFO 14 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4de4c4f1
2022-01-16 11:47:11.088  WARN 14 --- [https-jsse-nio-7071-exec-7] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:47:11.088  WARN 14 --- [https-jsse-nio-7071-exec-7] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:47:11.088  INFO 14 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4de4c4f1
2022-01-16 11:47:11.137  INFO 14 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: emergency-active, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4de4c4f1
2022-01-16 11:47:11.150  INFO 14 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4de4c4f1
2022-01-16 11:47:11.150  INFO 14 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4de4c4f1
2022-01-16 11:47:11.162  INFO 14 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4de4c4f1
2022-01-16 11:47:11.162  INFO 14 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-revoke-extra, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4de4c4f1
2022-01-16 11:47:11.222  INFO 14 --- [https-jsse-nio-7071-exec-7] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18912082150375045-321182, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=Deny}, TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:47:11.223  INFO 14 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=fa763388-7122-4f08-bb27-5abad8d3dcb1, content=DENY, timestamp=1642333631223, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=Deny}, TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:47:11.224  INFO 14 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=174ms, Total=177ms
2022-01-16 11:47:11.250  INFO 14 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=d1ce93c3-3366-4eb0-831d-42ce33c8a568, content=null, timestamp=1642333631244, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=53166, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=4cbbcf975445, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=b07dfbf9-a4f5-4455-8203-a2cec4d67eff, http-req-server-port=80, http-header-accept=*/*, kc-id=6cb35628-1a35-4ce0-a796-86bb2026243f, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642333631242, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQG53NxAH4AEQAAAABh5AW7dAAkNmNiMzU2MjgtMWEzNS00Y2UwLWE3OTYtODZiYjIwMjYyNDNmdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRiMDdkZmJmOS1hNGY1LTQ0NTUtODIwMy1hMmNlYzRkNjdlZmZwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJEdC1tdDI0aWkxQ3VWUnBvbnRqazZNTFA4NFVOZDJDSnVVbTNzQXpGZXVVIn0.eyJleHAiOjE2NDIzMzM5MjcsImlhdCI6MTY0MjMzMzYyNywianRpIjoiNmNiMzU2MjgtMWEzNS00Y2UwLWE3OTYtODZiYjIwMjYyNDNmIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiJiMDdkZmJmOS1hNGY1LTQ0NTUtODIwMy1hMmNlYzRkNjdlZmYiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.LfQC6pOzHJwRKWJa93ShDgM_MdHoxnk9eyFbHPoREooqpMT3SMjbXwdLkCNCA1uopGCigRpu-rVC9ccTKnQlTDgnhvQem_tEjdzsYd5uMdjz4QlUMfilGKUWG6WO3balqXcCrl-G8-mb57iZhC2hQiX9z610oFRxfoiN6aHjOPbc3b5kLm37QHObSimyN-S1yTLGW4ut7qSpExXmOpDwje3DX8jhJWOJP852tpL4ihL6bOf0qaaYNartB524T1ibMy5pfYK7ayKYeVpBgw6f4U2R7IEK9owz6IFXQoP-VTCMEWrV0gnKBWbW0G6tosI4UBcwX_OETTaxyTxc26I4cw, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642333927, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.25.0.10, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=62BBEAF3858D67F661234BAB4D2579EC, http-session-last-accessed-time=1642333631242, kc-category-name=ACCESS, kc-iat=1642333627, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:53166 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:47:11.256  INFO 14 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:47:11.258  INFO 14 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1ec0c108
2022-01-16 11:47:11.260  INFO 14 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1ec0c108
2022-01-16 11:47:11.273  INFO 14 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1ec0c108
2022-01-16 11:47:11.274  INFO 14 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1ec0c108
2022-01-16 11:47:11.288  INFO 14 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1ec0c108
2022-01-16 11:47:11.289  WARN 14 --- [https-jsse-nio-7071-exec-8] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:47:11.289  WARN 14 --- [https-jsse-nio-7071-exec-8] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:47:11.289  INFO 14 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1ec0c108
2022-01-16 11:47:11.289  INFO 14 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1ec0c108
2022-01-16 11:47:11.289  WARN 14 --- [https-jsse-nio-7071-exec-8] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:47:11.289  WARN 14 --- [https-jsse-nio-7071-exec-8] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:47:11.289  INFO 14 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1ec0c108
2022-01-16 11:47:11.298  INFO 14 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: emergency-active, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1ec0c108
2022-01-16 11:47:11.346  INFO 14 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1ec0c108
2022-01-16 11:47:11.346  INFO 14 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1ec0c108
2022-01-16 11:47:11.360  INFO 14 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1ec0c108
2022-01-16 11:47:11.360  INFO 14 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-revoke-extra, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1ec0c108
2022-01-16 11:47:11.368  INFO 14 --- [https-jsse-nio-7071-exec-8] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18912082357598070-630183, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=Deny}, TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:47:11.368  INFO 14 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=d1ce93c3-3366-4eb0-831d-42ce33c8a568, content=DENY, timestamp=1642333631368, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=Deny}, TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:47:11.369  INFO 14 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=112ms, Total=120ms
2022-01-16 11:47:11.388  INFO 14 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=b76c7f6a-bf5c-47bf-ad1d-927676bff381, content=null, timestamp=1642333631382, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=53168, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=4cbbcf975445, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=b07dfbf9-a4f5-4455-8203-a2cec4d67eff, http-req-server-port=80, http-header-accept=*/*, kc-id=6cb35628-1a35-4ce0-a796-86bb2026243f, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642333631379, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQG53NxAH4AEQAAAABh5AW7dAAkNmNiMzU2MjgtMWEzNS00Y2UwLWE3OTYtODZiYjIwMjYyNDNmdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRiMDdkZmJmOS1hNGY1LTQ0NTUtODIwMy1hMmNlYzRkNjdlZmZwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJEdC1tdDI0aWkxQ3VWUnBvbnRqazZNTFA4NFVOZDJDSnVVbTNzQXpGZXVVIn0.eyJleHAiOjE2NDIzMzM5MjcsImlhdCI6MTY0MjMzMzYyNywianRpIjoiNmNiMzU2MjgtMWEzNS00Y2UwLWE3OTYtODZiYjIwMjYyNDNmIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiJiMDdkZmJmOS1hNGY1LTQ0NTUtODIwMy1hMmNlYzRkNjdlZmYiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.LfQC6pOzHJwRKWJa93ShDgM_MdHoxnk9eyFbHPoREooqpMT3SMjbXwdLkCNCA1uopGCigRpu-rVC9ccTKnQlTDgnhvQem_tEjdzsYd5uMdjz4QlUMfilGKUWG6WO3balqXcCrl-G8-mb57iZhC2hQiX9z610oFRxfoiN6aHjOPbc3b5kLm37QHObSimyN-S1yTLGW4ut7qSpExXmOpDwje3DX8jhJWOJP852tpL4ihL6bOf0qaaYNartB524T1ibMy5pfYK7ayKYeVpBgw6f4U2R7IEK9owz6IFXQoP-VTCMEWrV0gnKBWbW0G6tosI4UBcwX_OETTaxyTxc26I4cw, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642333927, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.25.0.10, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=CE59676A6D592C22F3574319D37D1691, http-session-last-accessed-time=1642333631379, kc-category-name=ACCESS, kc-iat=1642333627, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:53168 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:47:11.389  INFO 14 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:47:11.390  INFO 14 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@fbbee0a
2022-01-16 11:47:11.390  INFO 14 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@fbbee0a
2022-01-16 11:47:11.442  INFO 14 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@fbbee0a
2022-01-16 11:47:11.442  INFO 14 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@fbbee0a
2022-01-16 11:47:11.456  INFO 14 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@fbbee0a
2022-01-16 11:47:11.460  WARN 14 --- [https-jsse-nio-7071-exec-9] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:47:11.460  WARN 14 --- [https-jsse-nio-7071-exec-9] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:47:11.461  INFO 14 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@fbbee0a
2022-01-16 11:47:11.461  INFO 14 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@fbbee0a
2022-01-16 11:47:11.461  WARN 14 --- [https-jsse-nio-7071-exec-9] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:47:11.462  WARN 14 --- [https-jsse-nio-7071-exec-9] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:47:11.462  INFO 14 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@fbbee0a
2022-01-16 11:47:11.471  INFO 14 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: emergency-active, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@fbbee0a
2022-01-16 11:47:11.521  INFO 14 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@fbbee0a
2022-01-16 11:47:11.522  INFO 14 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@fbbee0a
2022-01-16 11:47:11.537  INFO 14 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@fbbee0a
2022-01-16 11:47:11.537  INFO 14 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-revoke-extra, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@fbbee0a
2022-01-16 11:47:11.545  INFO 14 --- [https-jsse-nio-7071-exec-9] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18912082490564049-586046, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=Deny}, TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:47:11.546  INFO 14 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=b76c7f6a-bf5c-47bf-ad1d-927676bff381, content=DENY, timestamp=1642333631546, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=Deny}, TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:47:11.546  INFO 14 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=157ms, Total=159ms
2022-01-16 11:47:11.570  INFO 14 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=1f85fb0b-2f94-4efb-a5e1-79a177da141e, content=null, timestamp=1642333631564, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=53170, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=4cbbcf975445, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=b07dfbf9-a4f5-4455-8203-a2cec4d67eff, http-req-server-port=80, http-header-accept=*/*, kc-id=6cb35628-1a35-4ce0-a796-86bb2026243f, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642333631562, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQG53NxAH4AEQAAAABh5AW7dAAkNmNiMzU2MjgtMWEzNS00Y2UwLWE3OTYtODZiYjIwMjYyNDNmdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRiMDdkZmJmOS1hNGY1LTQ0NTUtODIwMy1hMmNlYzRkNjdlZmZwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJEdC1tdDI0aWkxQ3VWUnBvbnRqazZNTFA4NFVOZDJDSnVVbTNzQXpGZXVVIn0.eyJleHAiOjE2NDIzMzM5MjcsImlhdCI6MTY0MjMzMzYyNywianRpIjoiNmNiMzU2MjgtMWEzNS00Y2UwLWE3OTYtODZiYjIwMjYyNDNmIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiJiMDdkZmJmOS1hNGY1LTQ0NTUtODIwMy1hMmNlYzRkNjdlZmYiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.LfQC6pOzHJwRKWJa93ShDgM_MdHoxnk9eyFbHPoREooqpMT3SMjbXwdLkCNCA1uopGCigRpu-rVC9ccTKnQlTDgnhvQem_tEjdzsYd5uMdjz4QlUMfilGKUWG6WO3balqXcCrl-G8-mb57iZhC2hQiX9z610oFRxfoiN6aHjOPbc3b5kLm37QHObSimyN-S1yTLGW4ut7qSpExXmOpDwje3DX8jhJWOJP852tpL4ihL6bOf0qaaYNartB524T1ibMy5pfYK7ayKYeVpBgw6f4U2R7IEK9owz6IFXQoP-VTCMEWrV0gnKBWbW0G6tosI4UBcwX_OETTaxyTxc26I4cw, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642333927, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.25.0.10, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=EC18F021C9BA947DE7EFFD438AB4CC3B, http-session-last-accessed-time=1642333631562, kc-category-name=ACCESS, kc-iat=1642333627, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:53170 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:47:11.570  INFO 14 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:47:11.571  INFO 14 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@36c3131c
2022-01-16 11:47:11.572  INFO 14 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@36c3131c
2022-01-16 11:47:11.630  INFO 14 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@36c3131c
2022-01-16 11:47:11.631  INFO 14 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@36c3131c
2022-01-16 11:47:11.649  INFO 14 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@36c3131c
2022-01-16 11:47:11.649  WARN 14 --- [https-jsse-nio-7071-exec-10] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:47:11.650  WARN 14 --- [https-jsse-nio-7071-exec-10] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:47:11.651  INFO 14 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@36c3131c
2022-01-16 11:47:11.652  INFO 14 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@36c3131c
2022-01-16 11:47:11.652  WARN 14 --- [https-jsse-nio-7071-exec-10] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:47:11.652  WARN 14 --- [https-jsse-nio-7071-exec-10] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:47:11.653  INFO 14 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@36c3131c
2022-01-16 11:47:11.665  INFO 14 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: emergency-active, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@36c3131c
2022-01-16 11:47:11.718  INFO 14 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@36c3131c
2022-01-16 11:47:11.718  INFO 14 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@36c3131c
2022-01-16 11:47:11.738  INFO 14 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@36c3131c
2022-01-16 11:47:11.738  INFO 14 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-revoke-extra, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@36c3131c
2022-01-16 11:47:11.749  INFO 14 --- [https-jsse-nio-7071-exec-10] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18912082672030847-305074, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=Deny}, TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:47:11.750  INFO 14 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=1f85fb0b-2f94-4efb-a5e1-79a177da141e, content=DENY, timestamp=1642333631750, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=Deny}, TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:47:11.750  INFO 14 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=179ms, Total=182ms
2022-01-16 11:47:11.783  INFO 14 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=26ff66eb-938a-47a8-9372-4926de1d2eda, content=null, timestamp=1642333631767, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=53172, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=4cbbcf975445, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=b07dfbf9-a4f5-4455-8203-a2cec4d67eff, http-req-server-port=80, http-header-accept=*/*, kc-id=6cb35628-1a35-4ce0-a796-86bb2026243f, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642333631766, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQG53NxAH4AEQAAAABh5AW7dAAkNmNiMzU2MjgtMWEzNS00Y2UwLWE3OTYtODZiYjIwMjYyNDNmdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRiMDdkZmJmOS1hNGY1LTQ0NTUtODIwMy1hMmNlYzRkNjdlZmZwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJEdC1tdDI0aWkxQ3VWUnBvbnRqazZNTFA4NFVOZDJDSnVVbTNzQXpGZXVVIn0.eyJleHAiOjE2NDIzMzM5MjcsImlhdCI6MTY0MjMzMzYyNywianRpIjoiNmNiMzU2MjgtMWEzNS00Y2UwLWE3OTYtODZiYjIwMjYyNDNmIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiJiMDdkZmJmOS1hNGY1LTQ0NTUtODIwMy1hMmNlYzRkNjdlZmYiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.LfQC6pOzHJwRKWJa93ShDgM_MdHoxnk9eyFbHPoREooqpMT3SMjbXwdLkCNCA1uopGCigRpu-rVC9ccTKnQlTDgnhvQem_tEjdzsYd5uMdjz4QlUMfilGKUWG6WO3balqXcCrl-G8-mb57iZhC2hQiX9z610oFRxfoiN6aHjOPbc3b5kLm37QHObSimyN-S1yTLGW4ut7qSpExXmOpDwje3DX8jhJWOJP852tpL4ihL6bOf0qaaYNartB524T1ibMy5pfYK7ayKYeVpBgw6f4U2R7IEK9owz6IFXQoP-VTCMEWrV0gnKBWbW0G6tosI4UBcwX_OETTaxyTxc26I4cw, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642333927, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.25.0.10, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=E0676B27097D06EE0B7AB469B438AACC, http-session-last-accessed-time=1642333631766, kc-category-name=ACCESS, kc-iat=1642333627, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:53172 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:47:11.784  INFO 14 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:47:11.785  INFO 14 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7da4dfed
2022-01-16 11:47:11.785  INFO 14 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7da4dfed
2022-01-16 11:47:11.795  INFO 14 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7da4dfed
2022-01-16 11:47:11.795  INFO 14 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7da4dfed
2022-01-16 11:47:11.845  INFO 14 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7da4dfed
2022-01-16 11:47:11.846  WARN 14 --- [https-jsse-nio-7071-exec-1] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:47:11.846  WARN 14 --- [https-jsse-nio-7071-exec-1] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:47:11.846  INFO 14 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7da4dfed
2022-01-16 11:47:11.846  INFO 14 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7da4dfed
2022-01-16 11:47:11.846  WARN 14 --- [https-jsse-nio-7071-exec-1] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:47:11.846  WARN 14 --- [https-jsse-nio-7071-exec-1] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:47:11.846  INFO 14 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7da4dfed
2022-01-16 11:47:11.857  INFO 14 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: emergency-active, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7da4dfed
2022-01-16 11:47:11.869  INFO 14 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7da4dfed
2022-01-16 11:47:11.870  INFO 14 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7da4dfed
2022-01-16 11:47:11.930  INFO 14 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7da4dfed
2022-01-16 11:47:11.930  INFO 14 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-revoke-extra, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7da4dfed
2022-01-16 11:47:11.939  INFO 14 --- [https-jsse-nio-7071-exec-1] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18912082885390267-932255, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=Deny}, TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:47:11.939  INFO 14 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=26ff66eb-938a-47a8-9372-4926de1d2eda, content=DENY, timestamp=1642333631939, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=Deny}, TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:47:11.941  INFO 14 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=155ms, Total=167ms
2022-01-16 11:47:11.964  INFO 14 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=3a75a80e-a87a-4f97-9a1d-d786ad979538, content=null, timestamp=1642333631958, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=53174, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=4cbbcf975445, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=b07dfbf9-a4f5-4455-8203-a2cec4d67eff, http-req-server-port=80, http-header-accept=*/*, kc-id=6cb35628-1a35-4ce0-a796-86bb2026243f, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642333631956, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQG53NxAH4AEQAAAABh5AW7dAAkNmNiMzU2MjgtMWEzNS00Y2UwLWE3OTYtODZiYjIwMjYyNDNmdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRiMDdkZmJmOS1hNGY1LTQ0NTUtODIwMy1hMmNlYzRkNjdlZmZwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJEdC1tdDI0aWkxQ3VWUnBvbnRqazZNTFA4NFVOZDJDSnVVbTNzQXpGZXVVIn0.eyJleHAiOjE2NDIzMzM5MjcsImlhdCI6MTY0MjMzMzYyNywianRpIjoiNmNiMzU2MjgtMWEzNS00Y2UwLWE3OTYtODZiYjIwMjYyNDNmIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiJiMDdkZmJmOS1hNGY1LTQ0NTUtODIwMy1hMmNlYzRkNjdlZmYiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.LfQC6pOzHJwRKWJa93ShDgM_MdHoxnk9eyFbHPoREooqpMT3SMjbXwdLkCNCA1uopGCigRpu-rVC9ccTKnQlTDgnhvQem_tEjdzsYd5uMdjz4QlUMfilGKUWG6WO3balqXcCrl-G8-mb57iZhC2hQiX9z610oFRxfoiN6aHjOPbc3b5kLm37QHObSimyN-S1yTLGW4ut7qSpExXmOpDwje3DX8jhJWOJP852tpL4ihL6bOf0qaaYNartB524T1ibMy5pfYK7ayKYeVpBgw6f4U2R7IEK9owz6IFXQoP-VTCMEWrV0gnKBWbW0G6tosI4UBcwX_OETTaxyTxc26I4cw, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642333927, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.25.0.10, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=A6608C0DB2C84DD72D1B31E99D96159C, http-session-last-accessed-time=1642333631956, kc-category-name=ACCESS, kc-iat=1642333627, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:53174 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:47:11.966  INFO 14 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:47:11.967  INFO 14 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6bed6c6b
2022-01-16 11:47:11.967  INFO 14 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6bed6c6b
2022-01-16 11:47:11.977  INFO 14 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6bed6c6b
2022-01-16 11:47:11.978  INFO 14 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6bed6c6b
2022-01-16 11:47:12.037  INFO 14 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6bed6c6b
2022-01-16 11:47:12.038  WARN 14 --- [https-jsse-nio-7071-exec-2] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:47:12.038  WARN 14 --- [https-jsse-nio-7071-exec-2] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:47:12.039  INFO 14 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6bed6c6b
2022-01-16 11:47:12.039  INFO 14 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6bed6c6b
2022-01-16 11:47:12.040  WARN 14 --- [https-jsse-nio-7071-exec-2] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:47:12.040  WARN 14 --- [https-jsse-nio-7071-exec-2] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:47:12.040  INFO 14 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6bed6c6b
2022-01-16 11:47:12.053  INFO 14 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: emergency-active, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6bed6c6b
2022-01-16 11:47:12.061  INFO 14 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6bed6c6b
2022-01-16 11:47:12.061  INFO 14 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6bed6c6b
2022-01-16 11:47:12.110  INFO 14 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6bed6c6b
2022-01-16 11:47:12.110  INFO 14 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-revoke-extra, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6bed6c6b
2022-01-16 11:47:12.121  INFO 14 --- [https-jsse-nio-7071-exec-2] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18912083067582628-237449, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=Deny}, TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:47:12.122  INFO 14 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=3a75a80e-a87a-4f97-9a1d-d786ad979538, content=DENY, timestamp=1642333632122, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=Deny}, TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:47:12.122  INFO 14 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=156ms, Total=160ms
2022-01-16 11:47:12.141  INFO 14 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=b5e72f5c-0b01-4c6c-a5db-42e1c0b81106, content=null, timestamp=1642333632135, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=53176, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=4cbbcf975445, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=b07dfbf9-a4f5-4455-8203-a2cec4d67eff, http-req-server-port=80, http-header-accept=*/*, kc-id=6cb35628-1a35-4ce0-a796-86bb2026243f, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642333632133, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQG53NxAH4AEQAAAABh5AW7dAAkNmNiMzU2MjgtMWEzNS00Y2UwLWE3OTYtODZiYjIwMjYyNDNmdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRiMDdkZmJmOS1hNGY1LTQ0NTUtODIwMy1hMmNlYzRkNjdlZmZwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJEdC1tdDI0aWkxQ3VWUnBvbnRqazZNTFA4NFVOZDJDSnVVbTNzQXpGZXVVIn0.eyJleHAiOjE2NDIzMzM5MjcsImlhdCI6MTY0MjMzMzYyNywianRpIjoiNmNiMzU2MjgtMWEzNS00Y2UwLWE3OTYtODZiYjIwMjYyNDNmIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiJiMDdkZmJmOS1hNGY1LTQ0NTUtODIwMy1hMmNlYzRkNjdlZmYiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.LfQC6pOzHJwRKWJa93ShDgM_MdHoxnk9eyFbHPoREooqpMT3SMjbXwdLkCNCA1uopGCigRpu-rVC9ccTKnQlTDgnhvQem_tEjdzsYd5uMdjz4QlUMfilGKUWG6WO3balqXcCrl-G8-mb57iZhC2hQiX9z610oFRxfoiN6aHjOPbc3b5kLm37QHObSimyN-S1yTLGW4ut7qSpExXmOpDwje3DX8jhJWOJP852tpL4ihL6bOf0qaaYNartB524T1ibMy5pfYK7ayKYeVpBgw6f4U2R7IEK9owz6IFXQoP-VTCMEWrV0gnKBWbW0G6tosI4UBcwX_OETTaxyTxc26I4cw, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642333927, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.25.0.10, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=154E0B55D25B9A351BA72CB66F8BDFFE, http-session-last-accessed-time=1642333632133, kc-category-name=ACCESS, kc-iat=1642333627, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:53176 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:47:12.145  INFO 14 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:47:12.146  INFO 14 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2d05dc5d
2022-01-16 11:47:12.146  INFO 14 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2d05dc5d
2022-01-16 11:47:12.156  INFO 14 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2d05dc5d
2022-01-16 11:47:12.156  INFO 14 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2d05dc5d
2022-01-16 11:47:12.206  INFO 14 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2d05dc5d
2022-01-16 11:47:12.206  WARN 14 --- [https-jsse-nio-7071-exec-3] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:47:12.206  WARN 14 --- [https-jsse-nio-7071-exec-3] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:47:12.206  INFO 14 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2d05dc5d
2022-01-16 11:47:12.206  INFO 14 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2d05dc5d
2022-01-16 11:47:12.206  WARN 14 --- [https-jsse-nio-7071-exec-3] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:47:12.206  WARN 14 --- [https-jsse-nio-7071-exec-3] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:47:12.206  INFO 14 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2d05dc5d
2022-01-16 11:47:12.215  INFO 14 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: emergency-active, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2d05dc5d
2022-01-16 11:47:12.222  INFO 14 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2d05dc5d
2022-01-16 11:47:12.222  INFO 14 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2d05dc5d
2022-01-16 11:47:12.270  INFO 14 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2d05dc5d
2022-01-16 11:47:12.270  INFO 14 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-revoke-extra, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2d05dc5d
2022-01-16 11:47:12.281  INFO 14 --- [https-jsse-nio-7071-exec-3] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18912083246378673-818143, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=Deny}, TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:47:12.281  INFO 14 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=b5e72f5c-0b01-4c6c-a5db-42e1c0b81106, content=DENY, timestamp=1642333632281, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=Deny}, TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:47:12.281  INFO 14 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=136ms, Total=142ms
2022-01-16 11:47:12.300  INFO 14 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=d395e44d-2447-419b-bd67-e1a8ce924ede, content=null, timestamp=1642333632294, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=53178, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=4cbbcf975445, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=b07dfbf9-a4f5-4455-8203-a2cec4d67eff, http-req-server-port=80, http-header-accept=*/*, kc-id=6cb35628-1a35-4ce0-a796-86bb2026243f, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642333632292, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQG53NxAH4AEQAAAABh5AW7dAAkNmNiMzU2MjgtMWEzNS00Y2UwLWE3OTYtODZiYjIwMjYyNDNmdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRiMDdkZmJmOS1hNGY1LTQ0NTUtODIwMy1hMmNlYzRkNjdlZmZwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJEdC1tdDI0aWkxQ3VWUnBvbnRqazZNTFA4NFVOZDJDSnVVbTNzQXpGZXVVIn0.eyJleHAiOjE2NDIzMzM5MjcsImlhdCI6MTY0MjMzMzYyNywianRpIjoiNmNiMzU2MjgtMWEzNS00Y2UwLWE3OTYtODZiYjIwMjYyNDNmIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiJiMDdkZmJmOS1hNGY1LTQ0NTUtODIwMy1hMmNlYzRkNjdlZmYiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.LfQC6pOzHJwRKWJa93ShDgM_MdHoxnk9eyFbHPoREooqpMT3SMjbXwdLkCNCA1uopGCigRpu-rVC9ccTKnQlTDgnhvQem_tEjdzsYd5uMdjz4QlUMfilGKUWG6WO3balqXcCrl-G8-mb57iZhC2hQiX9z610oFRxfoiN6aHjOPbc3b5kLm37QHObSimyN-S1yTLGW4ut7qSpExXmOpDwje3DX8jhJWOJP852tpL4ihL6bOf0qaaYNartB524T1ibMy5pfYK7ayKYeVpBgw6f4U2R7IEK9owz6IFXQoP-VTCMEWrV0gnKBWbW0G6tosI4UBcwX_OETTaxyTxc26I4cw, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642333927, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.25.0.10, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=5388426714F3291BEBE49A2D796E708B, http-session-last-accessed-time=1642333632292, kc-category-name=ACCESS, kc-iat=1642333627, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:53178 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:47:12.301  INFO 14 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:47:12.302  INFO 14 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@110c6c42
2022-01-16 11:47:12.302  INFO 14 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@110c6c42
2022-01-16 11:47:12.311  INFO 14 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@110c6c42
2022-01-16 11:47:12.312  INFO 14 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@110c6c42
2022-01-16 11:47:12.370  INFO 14 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@110c6c42
2022-01-16 11:47:12.370  WARN 14 --- [https-jsse-nio-7071-exec-4] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:47:12.370  WARN 14 --- [https-jsse-nio-7071-exec-4] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:47:12.371  INFO 14 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@110c6c42
2022-01-16 11:47:12.371  INFO 14 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@110c6c42
2022-01-16 11:47:12.371  WARN 14 --- [https-jsse-nio-7071-exec-4] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:47:12.371  WARN 14 --- [https-jsse-nio-7071-exec-4] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:47:12.372  INFO 14 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@110c6c42
2022-01-16 11:47:12.380  INFO 14 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: emergency-active, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@110c6c42
2022-01-16 11:47:12.391  INFO 14 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@110c6c42
2022-01-16 11:47:12.391  INFO 14 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@110c6c42
2022-01-16 11:47:12.442  INFO 14 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@110c6c42
2022-01-16 11:47:12.442  INFO 14 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-revoke-extra, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@110c6c42
2022-01-16 11:47:12.460  INFO 14 --- [https-jsse-nio-7071-exec-4] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18912083402832683-753054, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=Deny}, TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:47:12.461  INFO 14 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=d395e44d-2447-419b-bd67-e1a8ce924ede, content=DENY, timestamp=1642333632461, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=Deny}, TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:47:12.462  INFO 14 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=160ms, Total=163ms
2022-01-16 11:47:12.489  INFO 14 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=901824ec-a784-4f22-abe6-577ec54839fc, content=null, timestamp=1642333632477, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=53180, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=4cbbcf975445, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=b07dfbf9-a4f5-4455-8203-a2cec4d67eff, http-req-server-port=80, http-header-accept=*/*, kc-id=6cb35628-1a35-4ce0-a796-86bb2026243f, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642333632475, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQG53NxAH4AEQAAAABh5AW7dAAkNmNiMzU2MjgtMWEzNS00Y2UwLWE3OTYtODZiYjIwMjYyNDNmdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRiMDdkZmJmOS1hNGY1LTQ0NTUtODIwMy1hMmNlYzRkNjdlZmZwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJEdC1tdDI0aWkxQ3VWUnBvbnRqazZNTFA4NFVOZDJDSnVVbTNzQXpGZXVVIn0.eyJleHAiOjE2NDIzMzM5MjcsImlhdCI6MTY0MjMzMzYyNywianRpIjoiNmNiMzU2MjgtMWEzNS00Y2UwLWE3OTYtODZiYjIwMjYyNDNmIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiJiMDdkZmJmOS1hNGY1LTQ0NTUtODIwMy1hMmNlYzRkNjdlZmYiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.LfQC6pOzHJwRKWJa93ShDgM_MdHoxnk9eyFbHPoREooqpMT3SMjbXwdLkCNCA1uopGCigRpu-rVC9ccTKnQlTDgnhvQem_tEjdzsYd5uMdjz4QlUMfilGKUWG6WO3balqXcCrl-G8-mb57iZhC2hQiX9z610oFRxfoiN6aHjOPbc3b5kLm37QHObSimyN-S1yTLGW4ut7qSpExXmOpDwje3DX8jhJWOJP852tpL4ihL6bOf0qaaYNartB524T1ibMy5pfYK7ayKYeVpBgw6f4U2R7IEK9owz6IFXQoP-VTCMEWrV0gnKBWbW0G6tosI4UBcwX_OETTaxyTxc26I4cw, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642333927, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.25.0.10, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=B6E33199E6DA531B9FF5E21B0642159B, http-session-last-accessed-time=1642333632475, kc-category-name=ACCESS, kc-iat=1642333627, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:53180 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:47:12.490  INFO 14 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:47:12.492  INFO 14 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@16d6922e
2022-01-16 11:47:12.495  INFO 14 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@16d6922e
2022-01-16 11:47:12.504  INFO 14 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@16d6922e
2022-01-16 11:47:12.505  INFO 14 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@16d6922e
2022-01-16 11:47:12.558  INFO 14 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@16d6922e
2022-01-16 11:47:12.559  WARN 14 --- [https-jsse-nio-7071-exec-5] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:47:12.559  WARN 14 --- [https-jsse-nio-7071-exec-5] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:47:12.560  INFO 14 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@16d6922e
2022-01-16 11:47:12.560  INFO 14 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@16d6922e
2022-01-16 11:47:12.561  WARN 14 --- [https-jsse-nio-7071-exec-5] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:47:12.561  WARN 14 --- [https-jsse-nio-7071-exec-5] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:47:12.561  INFO 14 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@16d6922e
2022-01-16 11:47:12.575  INFO 14 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: emergency-active, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@16d6922e
2022-01-16 11:47:12.585  INFO 14 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@16d6922e
2022-01-16 11:47:12.586  INFO 14 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@16d6922e
2022-01-16 11:47:12.638  INFO 14 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@16d6922e
2022-01-16 11:47:12.638  INFO 14 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-revoke-extra, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@16d6922e
2022-01-16 11:47:12.655  INFO 14 --- [https-jsse-nio-7071-exec-5] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18912083592644890-374302, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=Deny}, TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:47:12.656  INFO 14 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=901824ec-a784-4f22-abe6-577ec54839fc, content=DENY, timestamp=1642333632656, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=Deny}, TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:47:12.657  INFO 14 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=165ms, Total=173ms
2022-01-16 11:47:12.675  INFO 14 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=9e91f5ba-98fd-4e7d-8a51-16b0a74c5069, content=null, timestamp=1642333632670, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=53182, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=4cbbcf975445, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=b07dfbf9-a4f5-4455-8203-a2cec4d67eff, http-req-server-port=80, http-header-accept=*/*, kc-id=6cb35628-1a35-4ce0-a796-86bb2026243f, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642333632669, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQG53NxAH4AEQAAAABh5AW7dAAkNmNiMzU2MjgtMWEzNS00Y2UwLWE3OTYtODZiYjIwMjYyNDNmdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRiMDdkZmJmOS1hNGY1LTQ0NTUtODIwMy1hMmNlYzRkNjdlZmZwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJEdC1tdDI0aWkxQ3VWUnBvbnRqazZNTFA4NFVOZDJDSnVVbTNzQXpGZXVVIn0.eyJleHAiOjE2NDIzMzM5MjcsImlhdCI6MTY0MjMzMzYyNywianRpIjoiNmNiMzU2MjgtMWEzNS00Y2UwLWE3OTYtODZiYjIwMjYyNDNmIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiJiMDdkZmJmOS1hNGY1LTQ0NTUtODIwMy1hMmNlYzRkNjdlZmYiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.LfQC6pOzHJwRKWJa93ShDgM_MdHoxnk9eyFbHPoREooqpMT3SMjbXwdLkCNCA1uopGCigRpu-rVC9ccTKnQlTDgnhvQem_tEjdzsYd5uMdjz4QlUMfilGKUWG6WO3balqXcCrl-G8-mb57iZhC2hQiX9z610oFRxfoiN6aHjOPbc3b5kLm37QHObSimyN-S1yTLGW4ut7qSpExXmOpDwje3DX8jhJWOJP852tpL4ihL6bOf0qaaYNartB524T1ibMy5pfYK7ayKYeVpBgw6f4U2R7IEK9owz6IFXQoP-VTCMEWrV0gnKBWbW0G6tosI4UBcwX_OETTaxyTxc26I4cw, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642333927, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.25.0.10, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=6218CEC5C8CC987E598DE9CAE4502F9E, http-session-last-accessed-time=1642333632669, kc-category-name=ACCESS, kc-iat=1642333627, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:53182 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:47:12.676  INFO 14 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:47:12.677  INFO 14 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3a214138
2022-01-16 11:47:12.678  INFO 14 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3a214138
2022-01-16 11:47:12.689  INFO 14 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3a214138
2022-01-16 11:47:12.689  INFO 14 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3a214138
2022-01-16 11:47:12.745  INFO 14 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3a214138
2022-01-16 11:47:12.746  WARN 14 --- [https-jsse-nio-7071-exec-6] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:47:12.746  WARN 14 --- [https-jsse-nio-7071-exec-6] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:47:12.746  INFO 14 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3a214138
2022-01-16 11:47:12.746  INFO 14 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3a214138
2022-01-16 11:47:12.747  WARN 14 --- [https-jsse-nio-7071-exec-6] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:47:12.747  WARN 14 --- [https-jsse-nio-7071-exec-6] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:47:12.747  INFO 14 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3a214138
2022-01-16 11:47:12.764  INFO 14 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: emergency-active, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3a214138
2022-01-16 11:47:12.776  INFO 14 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3a214138
2022-01-16 11:47:12.777  INFO 14 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3a214138
2022-01-16 11:47:12.837  INFO 14 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3a214138
2022-01-16 11:47:12.838  INFO 14 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-revoke-extra, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3a214138
2022-01-16 11:47:12.852  INFO 14 --- [https-jsse-nio-7071-exec-6] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18912083777817557-476081, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=Deny}, TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:47:12.852  INFO 14 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=9e91f5ba-98fd-4e7d-8a51-16b0a74c5069, content=DENY, timestamp=1642333632852, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=Deny}, TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:47:12.853  INFO 14 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=176ms, Total=179ms
2022-01-16 11:47:12.874  INFO 14 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=2a7e16c9-2a0e-4b66-bacc-27918114353f, content=null, timestamp=1642333632868, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=53184, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=4cbbcf975445, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=b07dfbf9-a4f5-4455-8203-a2cec4d67eff, http-req-server-port=80, http-header-accept=*/*, kc-id=6cb35628-1a35-4ce0-a796-86bb2026243f, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642333632867, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQG53NxAH4AEQAAAABh5AW7dAAkNmNiMzU2MjgtMWEzNS00Y2UwLWE3OTYtODZiYjIwMjYyNDNmdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRiMDdkZmJmOS1hNGY1LTQ0NTUtODIwMy1hMmNlYzRkNjdlZmZwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJEdC1tdDI0aWkxQ3VWUnBvbnRqazZNTFA4NFVOZDJDSnVVbTNzQXpGZXVVIn0.eyJleHAiOjE2NDIzMzM5MjcsImlhdCI6MTY0MjMzMzYyNywianRpIjoiNmNiMzU2MjgtMWEzNS00Y2UwLWE3OTYtODZiYjIwMjYyNDNmIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiJiMDdkZmJmOS1hNGY1LTQ0NTUtODIwMy1hMmNlYzRkNjdlZmYiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.LfQC6pOzHJwRKWJa93ShDgM_MdHoxnk9eyFbHPoREooqpMT3SMjbXwdLkCNCA1uopGCigRpu-rVC9ccTKnQlTDgnhvQem_tEjdzsYd5uMdjz4QlUMfilGKUWG6WO3balqXcCrl-G8-mb57iZhC2hQiX9z610oFRxfoiN6aHjOPbc3b5kLm37QHObSimyN-S1yTLGW4ut7qSpExXmOpDwje3DX8jhJWOJP852tpL4ihL6bOf0qaaYNartB524T1ibMy5pfYK7ayKYeVpBgw6f4U2R7IEK9owz6IFXQoP-VTCMEWrV0gnKBWbW0G6tosI4UBcwX_OETTaxyTxc26I4cw, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642333927, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.25.0.10, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=8889747A9D9ACA309BAFAF6451D57BFD, http-session-last-accessed-time=1642333632867, kc-category-name=ACCESS, kc-iat=1642333627, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:53184 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:47:12.875  INFO 14 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:47:12.876  INFO 14 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5f57e27
2022-01-16 11:47:12.877  INFO 14 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5f57e27
2022-01-16 11:47:12.888  INFO 14 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5f57e27
2022-01-16 11:47:12.888  INFO 14 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5f57e27
2022-01-16 11:47:12.941  INFO 14 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5f57e27
2022-01-16 11:47:12.942  WARN 14 --- [https-jsse-nio-7071-exec-7] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:47:12.942  WARN 14 --- [https-jsse-nio-7071-exec-7] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:47:12.942  INFO 14 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5f57e27
2022-01-16 11:47:12.943  INFO 14 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5f57e27
2022-01-16 11:47:12.943  WARN 14 --- [https-jsse-nio-7071-exec-7] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:47:12.944  WARN 14 --- [https-jsse-nio-7071-exec-7] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:47:12.944  INFO 14 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5f57e27
2022-01-16 11:47:12.957  INFO 14 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: emergency-active, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5f57e27
2022-01-16 11:47:12.967  INFO 14 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5f57e27
2022-01-16 11:47:12.967  INFO 14 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5f57e27
2022-01-16 11:47:13.017  INFO 14 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5f57e27
2022-01-16 11:47:13.017  INFO 14 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-revoke-extra, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5f57e27
2022-01-16 11:47:13.027  INFO 14 --- [https-jsse-nio-7071-exec-7] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18912083976429983-65628, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=Deny}, TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:47:13.028  INFO 14 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=2a7e16c9-2a0e-4b66-bacc-27918114353f, content=DENY, timestamp=1642333633028, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=Deny}, TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:47:13.029  INFO 14 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=153ms, Total=156ms
2022-01-16 11:47:13.046  INFO 14 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=aacade7f-4f22-4706-8209-4bfdd511372d, content=null, timestamp=1642333633040, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=53186, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=4cbbcf975445, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=b07dfbf9-a4f5-4455-8203-a2cec4d67eff, http-req-server-port=80, http-header-accept=*/*, kc-id=6cb35628-1a35-4ce0-a796-86bb2026243f, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642333633039, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQG53NxAH4AEQAAAABh5AW7dAAkNmNiMzU2MjgtMWEzNS00Y2UwLWE3OTYtODZiYjIwMjYyNDNmdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRiMDdkZmJmOS1hNGY1LTQ0NTUtODIwMy1hMmNlYzRkNjdlZmZwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJEdC1tdDI0aWkxQ3VWUnBvbnRqazZNTFA4NFVOZDJDSnVVbTNzQXpGZXVVIn0.eyJleHAiOjE2NDIzMzM5MjcsImlhdCI6MTY0MjMzMzYyNywianRpIjoiNmNiMzU2MjgtMWEzNS00Y2UwLWE3OTYtODZiYjIwMjYyNDNmIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiJiMDdkZmJmOS1hNGY1LTQ0NTUtODIwMy1hMmNlYzRkNjdlZmYiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.LfQC6pOzHJwRKWJa93ShDgM_MdHoxnk9eyFbHPoREooqpMT3SMjbXwdLkCNCA1uopGCigRpu-rVC9ccTKnQlTDgnhvQem_tEjdzsYd5uMdjz4QlUMfilGKUWG6WO3balqXcCrl-G8-mb57iZhC2hQiX9z610oFRxfoiN6aHjOPbc3b5kLm37QHObSimyN-S1yTLGW4ut7qSpExXmOpDwje3DX8jhJWOJP852tpL4ihL6bOf0qaaYNartB524T1ibMy5pfYK7ayKYeVpBgw6f4U2R7IEK9owz6IFXQoP-VTCMEWrV0gnKBWbW0G6tosI4UBcwX_OETTaxyTxc26I4cw, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642333927, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.25.0.10, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=51A08FAFB366110FD2A2D0AA3B048F1F, http-session-last-accessed-time=1642333633039, kc-category-name=ACCESS, kc-iat=1642333627, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:53186 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:47:13.047  INFO 14 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:47:13.049  INFO 14 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@593adb36
2022-01-16 11:47:13.049  INFO 14 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@593adb36
2022-01-16 11:47:13.060  INFO 14 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@593adb36
2022-01-16 11:47:13.060  INFO 14 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@593adb36
2022-01-16 11:47:13.114  INFO 14 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@593adb36
2022-01-16 11:47:13.114  WARN 14 --- [https-jsse-nio-7071-exec-8] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:47:13.114  WARN 14 --- [https-jsse-nio-7071-exec-8] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:47:13.115  INFO 14 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@593adb36
2022-01-16 11:47:13.115  INFO 14 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@593adb36
2022-01-16 11:47:13.116  WARN 14 --- [https-jsse-nio-7071-exec-8] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:47:13.116  WARN 14 --- [https-jsse-nio-7071-exec-8] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:47:13.116  INFO 14 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@593adb36
2022-01-16 11:47:13.128  INFO 14 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: emergency-active, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@593adb36
2022-01-16 11:47:13.143  INFO 14 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@593adb36
2022-01-16 11:47:13.144  INFO 14 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@593adb36
2022-01-16 11:47:13.197  INFO 14 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@593adb36
2022-01-16 11:47:13.198  INFO 14 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-revoke-extra, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@593adb36
2022-01-16 11:47:13.213  INFO 14 --- [https-jsse-nio-7071-exec-8] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18912084149133814-161911, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=Deny}, TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:47:13.214  INFO 14 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=aacade7f-4f22-4706-8209-4bfdd511372d, content=DENY, timestamp=1642333633214, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=Deny}, TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:47:13.215  INFO 14 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=166ms, Total=170ms
2022-01-16 11:47:13.232  INFO 14 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=51f56519-dd8b-43de-ba4b-2dad28e2c248, content=null, timestamp=1642333633227, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=53188, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=4cbbcf975445, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=b07dfbf9-a4f5-4455-8203-a2cec4d67eff, http-req-server-port=80, http-header-accept=*/*, kc-id=6cb35628-1a35-4ce0-a796-86bb2026243f, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642333633225, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQG53NxAH4AEQAAAABh5AW7dAAkNmNiMzU2MjgtMWEzNS00Y2UwLWE3OTYtODZiYjIwMjYyNDNmdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRiMDdkZmJmOS1hNGY1LTQ0NTUtODIwMy1hMmNlYzRkNjdlZmZwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJEdC1tdDI0aWkxQ3VWUnBvbnRqazZNTFA4NFVOZDJDSnVVbTNzQXpGZXVVIn0.eyJleHAiOjE2NDIzMzM5MjcsImlhdCI6MTY0MjMzMzYyNywianRpIjoiNmNiMzU2MjgtMWEzNS00Y2UwLWE3OTYtODZiYjIwMjYyNDNmIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiJiMDdkZmJmOS1hNGY1LTQ0NTUtODIwMy1hMmNlYzRkNjdlZmYiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.LfQC6pOzHJwRKWJa93ShDgM_MdHoxnk9eyFbHPoREooqpMT3SMjbXwdLkCNCA1uopGCigRpu-rVC9ccTKnQlTDgnhvQem_tEjdzsYd5uMdjz4QlUMfilGKUWG6WO3balqXcCrl-G8-mb57iZhC2hQiX9z610oFRxfoiN6aHjOPbc3b5kLm37QHObSimyN-S1yTLGW4ut7qSpExXmOpDwje3DX8jhJWOJP852tpL4ihL6bOf0qaaYNartB524T1ibMy5pfYK7ayKYeVpBgw6f4U2R7IEK9owz6IFXQoP-VTCMEWrV0gnKBWbW0G6tosI4UBcwX_OETTaxyTxc26I4cw, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642333927, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.25.0.10, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=706C2DCA460A2CD487A337F4257277AB, http-session-last-accessed-time=1642333633225, kc-category-name=ACCESS, kc-iat=1642333627, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:53188 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:47:13.233  INFO 14 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:47:13.234  INFO 14 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@71453008
2022-01-16 11:47:13.234  INFO 14 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@71453008
2022-01-16 11:47:13.246  INFO 14 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@71453008
2022-01-16 11:47:13.247  INFO 14 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@71453008
2022-01-16 11:47:13.298  INFO 14 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@71453008
2022-01-16 11:47:13.298  WARN 14 --- [https-jsse-nio-7071-exec-9] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:47:13.299  WARN 14 --- [https-jsse-nio-7071-exec-9] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:47:13.299  INFO 14 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@71453008
2022-01-16 11:47:13.299  INFO 14 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@71453008
2022-01-16 11:47:13.300  WARN 14 --- [https-jsse-nio-7071-exec-9] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:47:13.300  WARN 14 --- [https-jsse-nio-7071-exec-9] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:47:13.300  INFO 14 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@71453008
2022-01-16 11:47:13.314  INFO 14 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: emergency-active, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@71453008
2022-01-16 11:47:13.326  INFO 14 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@71453008
2022-01-16 11:47:13.327  INFO 14 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@71453008
2022-01-16 11:47:13.381  INFO 14 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@71453008
2022-01-16 11:47:13.382  INFO 14 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-revoke-extra, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@71453008
2022-01-16 11:47:13.396  INFO 14 --- [https-jsse-nio-7071-exec-9] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18912084334675784-602595, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=Deny}, TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:47:13.396  INFO 14 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=51f56519-dd8b-43de-ba4b-2dad28e2c248, content=DENY, timestamp=1642333633396, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=Deny}, TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:47:13.397  INFO 14 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=163ms, Total=167ms
2022-01-16 11:47:13.418  INFO 14 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=1ecc3d4d-7381-4f93-965c-9fde59784bbe, content=null, timestamp=1642333633412, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=53190, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=4cbbcf975445, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=b07dfbf9-a4f5-4455-8203-a2cec4d67eff, http-req-server-port=80, http-header-accept=*/*, kc-id=6cb35628-1a35-4ce0-a796-86bb2026243f, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642333633410, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQG53NxAH4AEQAAAABh5AW7dAAkNmNiMzU2MjgtMWEzNS00Y2UwLWE3OTYtODZiYjIwMjYyNDNmdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRiMDdkZmJmOS1hNGY1LTQ0NTUtODIwMy1hMmNlYzRkNjdlZmZwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJEdC1tdDI0aWkxQ3VWUnBvbnRqazZNTFA4NFVOZDJDSnVVbTNzQXpGZXVVIn0.eyJleHAiOjE2NDIzMzM5MjcsImlhdCI6MTY0MjMzMzYyNywianRpIjoiNmNiMzU2MjgtMWEzNS00Y2UwLWE3OTYtODZiYjIwMjYyNDNmIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiJiMDdkZmJmOS1hNGY1LTQ0NTUtODIwMy1hMmNlYzRkNjdlZmYiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.LfQC6pOzHJwRKWJa93ShDgM_MdHoxnk9eyFbHPoREooqpMT3SMjbXwdLkCNCA1uopGCigRpu-rVC9ccTKnQlTDgnhvQem_tEjdzsYd5uMdjz4QlUMfilGKUWG6WO3balqXcCrl-G8-mb57iZhC2hQiX9z610oFRxfoiN6aHjOPbc3b5kLm37QHObSimyN-S1yTLGW4ut7qSpExXmOpDwje3DX8jhJWOJP852tpL4ihL6bOf0qaaYNartB524T1ibMy5pfYK7ayKYeVpBgw6f4U2R7IEK9owz6IFXQoP-VTCMEWrV0gnKBWbW0G6tosI4UBcwX_OETTaxyTxc26I4cw, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642333927, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.25.0.10, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=8D6CF6912E444CB922A5BA3BED8FE280, http-session-last-accessed-time=1642333633410, kc-category-name=ACCESS, kc-iat=1642333627, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:53190 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:47:13.419  INFO 14 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:47:13.420  INFO 14 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@76f55733
2022-01-16 11:47:13.420  INFO 14 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@76f55733
2022-01-16 11:47:13.430  INFO 14 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@76f55733
2022-01-16 11:47:13.430  INFO 14 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@76f55733
2022-01-16 11:47:13.489  INFO 14 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@76f55733
2022-01-16 11:47:13.490  WARN 14 --- [https-jsse-nio-7071-exec-10] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:47:13.490  WARN 14 --- [https-jsse-nio-7071-exec-10] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:47:13.491  INFO 14 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@76f55733
2022-01-16 11:47:13.491  INFO 14 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@76f55733
2022-01-16 11:47:13.491  WARN 14 --- [https-jsse-nio-7071-exec-10] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:47:13.492  WARN 14 --- [https-jsse-nio-7071-exec-10] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:47:13.492  INFO 14 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@76f55733
2022-01-16 11:47:13.501  INFO 14 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: emergency-active, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@76f55733
2022-01-16 11:47:13.510  INFO 14 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@76f55733
2022-01-16 11:47:13.510  INFO 14 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@76f55733
2022-01-16 11:47:13.562  INFO 14 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@76f55733
2022-01-16 11:47:13.562  INFO 14 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-revoke-extra, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@76f55733
2022-01-16 11:47:13.573  INFO 14 --- [https-jsse-nio-7071-exec-10] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18912084520764800-953177, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=Deny}, TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:47:13.573  INFO 14 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=1ecc3d4d-7381-4f93-965c-9fde59784bbe, content=DENY, timestamp=1642333633573, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=Deny}, TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:47:13.574  INFO 14 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=154ms, Total=157ms
2022-01-16 11:47:13.592  INFO 14 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=8b1c4d1b-8f0c-4c75-853d-adc9b596d0f2, content=null, timestamp=1642333633586, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=53192, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=4cbbcf975445, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=b07dfbf9-a4f5-4455-8203-a2cec4d67eff, http-req-server-port=80, http-header-accept=*/*, kc-id=6cb35628-1a35-4ce0-a796-86bb2026243f, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642333633584, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQG53NxAH4AEQAAAABh5AW7dAAkNmNiMzU2MjgtMWEzNS00Y2UwLWE3OTYtODZiYjIwMjYyNDNmdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRiMDdkZmJmOS1hNGY1LTQ0NTUtODIwMy1hMmNlYzRkNjdlZmZwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJEdC1tdDI0aWkxQ3VWUnBvbnRqazZNTFA4NFVOZDJDSnVVbTNzQXpGZXVVIn0.eyJleHAiOjE2NDIzMzM5MjcsImlhdCI6MTY0MjMzMzYyNywianRpIjoiNmNiMzU2MjgtMWEzNS00Y2UwLWE3OTYtODZiYjIwMjYyNDNmIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiJiMDdkZmJmOS1hNGY1LTQ0NTUtODIwMy1hMmNlYzRkNjdlZmYiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.LfQC6pOzHJwRKWJa93ShDgM_MdHoxnk9eyFbHPoREooqpMT3SMjbXwdLkCNCA1uopGCigRpu-rVC9ccTKnQlTDgnhvQem_tEjdzsYd5uMdjz4QlUMfilGKUWG6WO3balqXcCrl-G8-mb57iZhC2hQiX9z610oFRxfoiN6aHjOPbc3b5kLm37QHObSimyN-S1yTLGW4ut7qSpExXmOpDwje3DX8jhJWOJP852tpL4ihL6bOf0qaaYNartB524T1ibMy5pfYK7ayKYeVpBgw6f4U2R7IEK9owz6IFXQoP-VTCMEWrV0gnKBWbW0G6tosI4UBcwX_OETTaxyTxc26I4cw, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642333927, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.25.0.10, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=554701AA3D956A96B3EADD0818D66F71, http-session-last-accessed-time=1642333633584, kc-category-name=ACCESS, kc-iat=1642333627, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:53192 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:47:13.598  INFO 14 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:47:13.599  INFO 14 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@579e407f
2022-01-16 11:47:13.602  INFO 14 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@579e407f
2022-01-16 11:47:13.612  INFO 14 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@579e407f
2022-01-16 11:47:13.613  INFO 14 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@579e407f
2022-01-16 11:47:13.669  INFO 14 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@579e407f
2022-01-16 11:47:13.670  WARN 14 --- [https-jsse-nio-7071-exec-1] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:47:13.670  WARN 14 --- [https-jsse-nio-7071-exec-1] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:47:13.670  INFO 14 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@579e407f
2022-01-16 11:47:13.671  INFO 14 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@579e407f
2022-01-16 11:47:13.671  WARN 14 --- [https-jsse-nio-7071-exec-1] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:47:13.671  WARN 14 --- [https-jsse-nio-7071-exec-1] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:47:13.671  INFO 14 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@579e407f
2022-01-16 11:47:13.687  INFO 14 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: emergency-active, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@579e407f
2022-01-16 11:47:13.697  INFO 14 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@579e407f
2022-01-16 11:47:13.697  INFO 14 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@579e407f
2022-01-16 11:47:13.750  INFO 14 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@579e407f
2022-01-16 11:47:13.751  INFO 14 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-revoke-extra, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@579e407f
2022-01-16 11:47:13.767  INFO 14 --- [https-jsse-nio-7071-exec-1] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18912084699280666-982142, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=Deny}, TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:47:13.768  INFO 14 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=8b1c4d1b-8f0c-4c75-853d-adc9b596d0f2, content=DENY, timestamp=1642333633768, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=Deny}, TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:47:13.769  INFO 14 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=170ms, Total=179ms
2022-01-16 11:47:13.798  INFO 14 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=79cac471-52c1-4024-a822-066c616c8783, content=null, timestamp=1642333633784, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=53194, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=4cbbcf975445, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=b07dfbf9-a4f5-4455-8203-a2cec4d67eff, http-req-server-port=80, http-header-accept=*/*, kc-id=6cb35628-1a35-4ce0-a796-86bb2026243f, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642333633783, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQG53NxAH4AEQAAAABh5AW7dAAkNmNiMzU2MjgtMWEzNS00Y2UwLWE3OTYtODZiYjIwMjYyNDNmdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRiMDdkZmJmOS1hNGY1LTQ0NTUtODIwMy1hMmNlYzRkNjdlZmZwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJEdC1tdDI0aWkxQ3VWUnBvbnRqazZNTFA4NFVOZDJDSnVVbTNzQXpGZXVVIn0.eyJleHAiOjE2NDIzMzM5MjcsImlhdCI6MTY0MjMzMzYyNywianRpIjoiNmNiMzU2MjgtMWEzNS00Y2UwLWE3OTYtODZiYjIwMjYyNDNmIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiJiMDdkZmJmOS1hNGY1LTQ0NTUtODIwMy1hMmNlYzRkNjdlZmYiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.LfQC6pOzHJwRKWJa93ShDgM_MdHoxnk9eyFbHPoREooqpMT3SMjbXwdLkCNCA1uopGCigRpu-rVC9ccTKnQlTDgnhvQem_tEjdzsYd5uMdjz4QlUMfilGKUWG6WO3balqXcCrl-G8-mb57iZhC2hQiX9z610oFRxfoiN6aHjOPbc3b5kLm37QHObSimyN-S1yTLGW4ut7qSpExXmOpDwje3DX8jhJWOJP852tpL4ihL6bOf0qaaYNartB524T1ibMy5pfYK7ayKYeVpBgw6f4U2R7IEK9owz6IFXQoP-VTCMEWrV0gnKBWbW0G6tosI4UBcwX_OETTaxyTxc26I4cw, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642333927, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.25.0.10, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=DBBCAEA09BA7160125E24BD724777BA5, http-session-last-accessed-time=1642333633783, kc-category-name=ACCESS, kc-iat=1642333627, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:53194 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:47:13.799  INFO 14 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:47:13.800  INFO 14 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@60f9a0cb
2022-01-16 11:47:13.800  INFO 14 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@60f9a0cb
2022-01-16 11:47:13.811  INFO 14 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@60f9a0cb
2022-01-16 11:47:13.812  INFO 14 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@60f9a0cb
2022-01-16 11:47:13.863  INFO 14 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@60f9a0cb
2022-01-16 11:47:13.863  WARN 14 --- [https-jsse-nio-7071-exec-2] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:47:13.863  WARN 14 --- [https-jsse-nio-7071-exec-2] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:47:13.864  INFO 14 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@60f9a0cb
2022-01-16 11:47:13.864  INFO 14 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@60f9a0cb
2022-01-16 11:47:13.864  WARN 14 --- [https-jsse-nio-7071-exec-2] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:47:13.865  WARN 14 --- [https-jsse-nio-7071-exec-2] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:47:13.865  INFO 14 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@60f9a0cb
2022-01-16 11:47:13.878  INFO 14 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: emergency-active, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@60f9a0cb
2022-01-16 11:47:13.891  INFO 14 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@60f9a0cb
2022-01-16 11:47:13.892  INFO 14 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@60f9a0cb
2022-01-16 11:47:13.942  INFO 14 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@60f9a0cb
2022-01-16 11:47:13.942  INFO 14 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-revoke-extra, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@60f9a0cb
2022-01-16 11:47:13.959  INFO 14 --- [https-jsse-nio-7071-exec-2] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18912084900850547-746219, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=Deny}, TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:47:13.960  INFO 14 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=79cac471-52c1-4024-a822-066c616c8783, content=DENY, timestamp=1642333633960, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=Deny}, TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:47:13.962  INFO 14 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=161ms, Total=165ms
2022-01-16 11:47:14.025  INFO 14 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=d80d2583-0581-4679-9cc6-c54f53456b67, content=null, timestamp=1642333634019, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=53196, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=4cbbcf975445, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=b07dfbf9-a4f5-4455-8203-a2cec4d67eff, http-req-server-port=80, http-header-accept=*/*, kc-id=6cb35628-1a35-4ce0-a796-86bb2026243f, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642333634018, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQG53NxAH4AEQAAAABh5AW7dAAkNmNiMzU2MjgtMWEzNS00Y2UwLWE3OTYtODZiYjIwMjYyNDNmdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRiMDdkZmJmOS1hNGY1LTQ0NTUtODIwMy1hMmNlYzRkNjdlZmZwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJEdC1tdDI0aWkxQ3VWUnBvbnRqazZNTFA4NFVOZDJDSnVVbTNzQXpGZXVVIn0.eyJleHAiOjE2NDIzMzM5MjcsImlhdCI6MTY0MjMzMzYyNywianRpIjoiNmNiMzU2MjgtMWEzNS00Y2UwLWE3OTYtODZiYjIwMjYyNDNmIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiJiMDdkZmJmOS1hNGY1LTQ0NTUtODIwMy1hMmNlYzRkNjdlZmYiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.LfQC6pOzHJwRKWJa93ShDgM_MdHoxnk9eyFbHPoREooqpMT3SMjbXwdLkCNCA1uopGCigRpu-rVC9ccTKnQlTDgnhvQem_tEjdzsYd5uMdjz4QlUMfilGKUWG6WO3balqXcCrl-G8-mb57iZhC2hQiX9z610oFRxfoiN6aHjOPbc3b5kLm37QHObSimyN-S1yTLGW4ut7qSpExXmOpDwje3DX8jhJWOJP852tpL4ihL6bOf0qaaYNartB524T1ibMy5pfYK7ayKYeVpBgw6f4U2R7IEK9owz6IFXQoP-VTCMEWrV0gnKBWbW0G6tosI4UBcwX_OETTaxyTxc26I4cw, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642333927, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.25.0.10, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=2A8E4B5A5B18E0311B0ACD8819D17303, http-session-last-accessed-time=1642333634018, kc-category-name=ACCESS, kc-iat=1642333627, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:53196 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:47:14.025  INFO 14 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:47:14.026  INFO 14 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@48ac8450
2022-01-16 11:47:14.026  INFO 14 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@48ac8450
2022-01-16 11:47:14.040  INFO 14 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@48ac8450
2022-01-16 11:47:14.041  INFO 14 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@48ac8450
2022-01-16 11:47:14.093  INFO 14 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@48ac8450
2022-01-16 11:47:14.093  WARN 14 --- [https-jsse-nio-7071-exec-3] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:47:14.093  WARN 14 --- [https-jsse-nio-7071-exec-3] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:47:14.093  INFO 14 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@48ac8450
2022-01-16 11:47:14.094  INFO 14 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@48ac8450
2022-01-16 11:47:14.094  WARN 14 --- [https-jsse-nio-7071-exec-3] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:47:14.094  WARN 14 --- [https-jsse-nio-7071-exec-3] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:47:14.094  INFO 14 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@48ac8450
2022-01-16 11:47:14.110  INFO 14 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: emergency-active, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@48ac8450
2022-01-16 11:47:14.122  INFO 14 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@48ac8450
2022-01-16 11:47:14.123  INFO 14 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@48ac8450
2022-01-16 11:47:14.178  INFO 14 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@48ac8450
2022-01-16 11:47:14.178  INFO 14 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-revoke-extra, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@48ac8450
2022-01-16 11:47:14.193  INFO 14 --- [https-jsse-nio-7071-exec-3] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18912085126906393-169550, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=Deny}, TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:47:14.193  INFO 14 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=d80d2583-0581-4679-9cc6-c54f53456b67, content=DENY, timestamp=1642333634193, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=Deny}, TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:47:14.194  INFO 14 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=168ms, Total=170ms
2022-01-16 11:47:14.220  INFO 14 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=bb47a0d1-f87e-42b9-98a9-37ce68a04e02, content=null, timestamp=1642333634207, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=53198, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=4cbbcf975445, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=b07dfbf9-a4f5-4455-8203-a2cec4d67eff, http-req-server-port=80, http-header-accept=*/*, kc-id=6cb35628-1a35-4ce0-a796-86bb2026243f, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642333634206, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQG53NxAH4AEQAAAABh5AW7dAAkNmNiMzU2MjgtMWEzNS00Y2UwLWE3OTYtODZiYjIwMjYyNDNmdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRiMDdkZmJmOS1hNGY1LTQ0NTUtODIwMy1hMmNlYzRkNjdlZmZwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJEdC1tdDI0aWkxQ3VWUnBvbnRqazZNTFA4NFVOZDJDSnVVbTNzQXpGZXVVIn0.eyJleHAiOjE2NDIzMzM5MjcsImlhdCI6MTY0MjMzMzYyNywianRpIjoiNmNiMzU2MjgtMWEzNS00Y2UwLWE3OTYtODZiYjIwMjYyNDNmIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiJiMDdkZmJmOS1hNGY1LTQ0NTUtODIwMy1hMmNlYzRkNjdlZmYiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.LfQC6pOzHJwRKWJa93ShDgM_MdHoxnk9eyFbHPoREooqpMT3SMjbXwdLkCNCA1uopGCigRpu-rVC9ccTKnQlTDgnhvQem_tEjdzsYd5uMdjz4QlUMfilGKUWG6WO3balqXcCrl-G8-mb57iZhC2hQiX9z610oFRxfoiN6aHjOPbc3b5kLm37QHObSimyN-S1yTLGW4ut7qSpExXmOpDwje3DX8jhJWOJP852tpL4ihL6bOf0qaaYNartB524T1ibMy5pfYK7ayKYeVpBgw6f4U2R7IEK9owz6IFXQoP-VTCMEWrV0gnKBWbW0G6tosI4UBcwX_OETTaxyTxc26I4cw, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642333927, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.25.0.10, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=72B782AB0D1ACA69BCF1561C5F50A3AE, http-session-last-accessed-time=1642333634206, kc-category-name=ACCESS, kc-iat=1642333627, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:53198 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:47:14.221  INFO 14 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:47:14.222  INFO 14 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@69b94588
2022-01-16 11:47:14.222  INFO 14 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@69b94588
2022-01-16 11:47:14.233  INFO 14 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@69b94588
2022-01-16 11:47:14.233  INFO 14 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@69b94588
2022-01-16 11:47:14.293  INFO 14 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@69b94588
2022-01-16 11:47:14.294  WARN 14 --- [https-jsse-nio-7071-exec-4] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:47:14.294  WARN 14 --- [https-jsse-nio-7071-exec-4] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:47:14.295  INFO 14 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@69b94588
2022-01-16 11:47:14.295  INFO 14 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@69b94588
2022-01-16 11:47:14.295  WARN 14 --- [https-jsse-nio-7071-exec-4] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:47:14.295  WARN 14 --- [https-jsse-nio-7071-exec-4] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:47:14.296  INFO 14 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@69b94588
2022-01-16 11:47:14.305  INFO 14 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: emergency-active, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@69b94588
2022-01-16 11:47:14.315  INFO 14 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@69b94588
2022-01-16 11:47:14.315  INFO 14 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@69b94588
2022-01-16 11:47:14.366  INFO 14 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@69b94588
2022-01-16 11:47:14.366  INFO 14 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-revoke-extra, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@69b94588
2022-01-16 11:47:14.387  INFO 14 --- [https-jsse-nio-7071-exec-4] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18912085322588562-52684, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=Deny}, TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:47:14.387  INFO 14 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=bb47a0d1-f87e-42b9-98a9-37ce68a04e02, content=DENY, timestamp=1642333634387, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=Deny}, TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:47:14.388  INFO 14 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=166ms, Total=169ms
2022-01-16 11:47:14.406  INFO 14 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=ad95873c-7ed3-44c0-817d-15b4045d6a86, content=null, timestamp=1642333634401, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=53200, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=4cbbcf975445, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=b07dfbf9-a4f5-4455-8203-a2cec4d67eff, http-req-server-port=80, http-header-accept=*/*, kc-id=6cb35628-1a35-4ce0-a796-86bb2026243f, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642333634400, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQG53NxAH4AEQAAAABh5AW7dAAkNmNiMzU2MjgtMWEzNS00Y2UwLWE3OTYtODZiYjIwMjYyNDNmdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRiMDdkZmJmOS1hNGY1LTQ0NTUtODIwMy1hMmNlYzRkNjdlZmZwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJEdC1tdDI0aWkxQ3VWUnBvbnRqazZNTFA4NFVOZDJDSnVVbTNzQXpGZXVVIn0.eyJleHAiOjE2NDIzMzM5MjcsImlhdCI6MTY0MjMzMzYyNywianRpIjoiNmNiMzU2MjgtMWEzNS00Y2UwLWE3OTYtODZiYjIwMjYyNDNmIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiJiMDdkZmJmOS1hNGY1LTQ0NTUtODIwMy1hMmNlYzRkNjdlZmYiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.LfQC6pOzHJwRKWJa93ShDgM_MdHoxnk9eyFbHPoREooqpMT3SMjbXwdLkCNCA1uopGCigRpu-rVC9ccTKnQlTDgnhvQem_tEjdzsYd5uMdjz4QlUMfilGKUWG6WO3balqXcCrl-G8-mb57iZhC2hQiX9z610oFRxfoiN6aHjOPbc3b5kLm37QHObSimyN-S1yTLGW4ut7qSpExXmOpDwje3DX8jhJWOJP852tpL4ihL6bOf0qaaYNartB524T1ibMy5pfYK7ayKYeVpBgw6f4U2R7IEK9owz6IFXQoP-VTCMEWrV0gnKBWbW0G6tosI4UBcwX_OETTaxyTxc26I4cw, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642333927, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.25.0.10, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=C98EDE2A422844B0835C5EBED8FCB126, http-session-last-accessed-time=1642333634400, kc-category-name=ACCESS, kc-iat=1642333627, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:53200 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:47:14.407  INFO 14 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:47:14.408  INFO 14 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@77d59171
2022-01-16 11:47:14.409  INFO 14 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@77d59171
2022-01-16 11:47:14.419  INFO 14 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@77d59171
2022-01-16 11:47:14.419  INFO 14 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@77d59171
2022-01-16 11:47:14.473  INFO 14 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@77d59171
2022-01-16 11:47:14.474  WARN 14 --- [https-jsse-nio-7071-exec-5] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:47:14.474  WARN 14 --- [https-jsse-nio-7071-exec-5] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:47:14.474  INFO 14 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@77d59171
2022-01-16 11:47:14.474  INFO 14 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@77d59171
2022-01-16 11:47:14.474  WARN 14 --- [https-jsse-nio-7071-exec-5] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:47:14.474  WARN 14 --- [https-jsse-nio-7071-exec-5] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:47:14.474  INFO 14 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@77d59171
2022-01-16 11:47:14.503  INFO 14 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: emergency-active, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@77d59171
2022-01-16 11:47:14.512  INFO 14 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@77d59171
2022-01-16 11:47:14.512  INFO 14 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@77d59171
2022-01-16 11:47:14.562  INFO 14 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@77d59171
2022-01-16 11:47:14.562  INFO 14 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-revoke-extra, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@77d59171
2022-01-16 11:47:14.580  INFO 14 --- [https-jsse-nio-7071-exec-5] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18912085508470960-335071, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=Deny}, TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:47:14.580  INFO 14 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=ad95873c-7ed3-44c0-817d-15b4045d6a86, content=DENY, timestamp=1642333634580, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=Deny}, TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:47:14.581  INFO 14 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=173ms, Total=177ms
2022-01-16 11:47:14.610  INFO 14 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=5a5b8cf5-6728-4c45-ab4c-8853367a9680, content=null, timestamp=1642333634596, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=53202, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=4cbbcf975445, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=b07dfbf9-a4f5-4455-8203-a2cec4d67eff, http-req-server-port=80, http-header-accept=*/*, kc-id=6cb35628-1a35-4ce0-a796-86bb2026243f, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642333634595, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQG53NxAH4AEQAAAABh5AW7dAAkNmNiMzU2MjgtMWEzNS00Y2UwLWE3OTYtODZiYjIwMjYyNDNmdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRiMDdkZmJmOS1hNGY1LTQ0NTUtODIwMy1hMmNlYzRkNjdlZmZwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJEdC1tdDI0aWkxQ3VWUnBvbnRqazZNTFA4NFVOZDJDSnVVbTNzQXpGZXVVIn0.eyJleHAiOjE2NDIzMzM5MjcsImlhdCI6MTY0MjMzMzYyNywianRpIjoiNmNiMzU2MjgtMWEzNS00Y2UwLWE3OTYtODZiYjIwMjYyNDNmIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiJiMDdkZmJmOS1hNGY1LTQ0NTUtODIwMy1hMmNlYzRkNjdlZmYiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.LfQC6pOzHJwRKWJa93ShDgM_MdHoxnk9eyFbHPoREooqpMT3SMjbXwdLkCNCA1uopGCigRpu-rVC9ccTKnQlTDgnhvQem_tEjdzsYd5uMdjz4QlUMfilGKUWG6WO3balqXcCrl-G8-mb57iZhC2hQiX9z610oFRxfoiN6aHjOPbc3b5kLm37QHObSimyN-S1yTLGW4ut7qSpExXmOpDwje3DX8jhJWOJP852tpL4ihL6bOf0qaaYNartB524T1ibMy5pfYK7ayKYeVpBgw6f4U2R7IEK9owz6IFXQoP-VTCMEWrV0gnKBWbW0G6tosI4UBcwX_OETTaxyTxc26I4cw, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642333927, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.25.0.10, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=38557822DD2C390983F9747A9E5CB7A3, http-session-last-accessed-time=1642333634595, kc-category-name=ACCESS, kc-iat=1642333627, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:53202 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:47:14.610  INFO 14 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:47:14.611  INFO 14 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1dbe2147
2022-01-16 11:47:14.612  INFO 14 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1dbe2147
2022-01-16 11:47:14.630  INFO 14 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1dbe2147
2022-01-16 11:47:14.630  INFO 14 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1dbe2147
2022-01-16 11:47:14.681  INFO 14 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1dbe2147
2022-01-16 11:47:14.682  WARN 14 --- [https-jsse-nio-7071-exec-6] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:47:14.682  WARN 14 --- [https-jsse-nio-7071-exec-6] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:47:14.682  INFO 14 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1dbe2147
2022-01-16 11:47:14.683  INFO 14 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1dbe2147
2022-01-16 11:47:14.683  WARN 14 --- [https-jsse-nio-7071-exec-6] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:47:14.683  WARN 14 --- [https-jsse-nio-7071-exec-6] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:47:14.683  INFO 14 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1dbe2147
2022-01-16 11:47:14.698  INFO 14 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: emergency-active, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1dbe2147
2022-01-16 11:47:14.706  INFO 14 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1dbe2147
2022-01-16 11:47:14.706  INFO 14 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1dbe2147
2022-01-16 11:47:14.754  INFO 14 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1dbe2147
2022-01-16 11:47:14.754  INFO 14 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-revoke-extra, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1dbe2147
2022-01-16 11:47:14.765  INFO 14 --- [https-jsse-nio-7071-exec-6] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18912085711902701-956653, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=Deny}, TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:47:14.765  INFO 14 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=5a5b8cf5-6728-4c45-ab4c-8853367a9680, content=DENY, timestamp=1642333634765, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=Deny}, TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:47:14.766  INFO 14 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=155ms, Total=158ms
2022-01-16 11:47:14.788  INFO 14 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=40f37269-be2c-405f-bf95-b6b15f766f1d, content=null, timestamp=1642333634782, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=53204, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=4cbbcf975445, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=b07dfbf9-a4f5-4455-8203-a2cec4d67eff, http-req-server-port=80, http-header-accept=*/*, kc-id=6cb35628-1a35-4ce0-a796-86bb2026243f, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642333634780, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQG53NxAH4AEQAAAABh5AW7dAAkNmNiMzU2MjgtMWEzNS00Y2UwLWE3OTYtODZiYjIwMjYyNDNmdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRiMDdkZmJmOS1hNGY1LTQ0NTUtODIwMy1hMmNlYzRkNjdlZmZwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJEdC1tdDI0aWkxQ3VWUnBvbnRqazZNTFA4NFVOZDJDSnVVbTNzQXpGZXVVIn0.eyJleHAiOjE2NDIzMzM5MjcsImlhdCI6MTY0MjMzMzYyNywianRpIjoiNmNiMzU2MjgtMWEzNS00Y2UwLWE3OTYtODZiYjIwMjYyNDNmIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiJiMDdkZmJmOS1hNGY1LTQ0NTUtODIwMy1hMmNlYzRkNjdlZmYiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.LfQC6pOzHJwRKWJa93ShDgM_MdHoxnk9eyFbHPoREooqpMT3SMjbXwdLkCNCA1uopGCigRpu-rVC9ccTKnQlTDgnhvQem_tEjdzsYd5uMdjz4QlUMfilGKUWG6WO3balqXcCrl-G8-mb57iZhC2hQiX9z610oFRxfoiN6aHjOPbc3b5kLm37QHObSimyN-S1yTLGW4ut7qSpExXmOpDwje3DX8jhJWOJP852tpL4ihL6bOf0qaaYNartB524T1ibMy5pfYK7ayKYeVpBgw6f4U2R7IEK9owz6IFXQoP-VTCMEWrV0gnKBWbW0G6tosI4UBcwX_OETTaxyTxc26I4cw, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642333927, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.25.0.10, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=51B02419F63B10BDBD9155DD2FDB671C, http-session-last-accessed-time=1642333634780, kc-category-name=ACCESS, kc-iat=1642333627, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:53204 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:47:14.789  INFO 14 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:47:14.790  INFO 14 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@18e832ba
2022-01-16 11:47:14.791  INFO 14 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@18e832ba
2022-01-16 11:47:14.799  INFO 14 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@18e832ba
2022-01-16 11:47:14.799  INFO 14 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@18e832ba
2022-01-16 11:47:14.850  INFO 14 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@18e832ba
2022-01-16 11:47:14.850  WARN 14 --- [https-jsse-nio-7071-exec-7] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:47:14.850  WARN 14 --- [https-jsse-nio-7071-exec-7] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:47:14.850  INFO 14 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@18e832ba
2022-01-16 11:47:14.850  INFO 14 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@18e832ba
2022-01-16 11:47:14.850  WARN 14 --- [https-jsse-nio-7071-exec-7] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:47:14.850  WARN 14 --- [https-jsse-nio-7071-exec-7] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:47:14.851  INFO 14 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@18e832ba
2022-01-16 11:47:14.862  INFO 14 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: emergency-active, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@18e832ba
2022-01-16 11:47:14.871  INFO 14 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@18e832ba
2022-01-16 11:47:14.872  INFO 14 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@18e832ba
2022-01-16 11:47:14.922  INFO 14 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@18e832ba
2022-01-16 11:47:14.922  INFO 14 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-revoke-extra, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@18e832ba
2022-01-16 11:47:14.938  INFO 14 --- [https-jsse-nio-7071-exec-7] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18912085890794756-120348, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=Deny}, TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:47:14.939  INFO 14 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=40f37269-be2c-405f-bf95-b6b15f766f1d, content=DENY, timestamp=1642333634939, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=Deny}, TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:47:14.943  INFO 14 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=150ms, Total=157ms
2022-01-16 11:47:14.968  INFO 14 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=748012a0-8645-4d19-8ba7-e61506ca3f54, content=null, timestamp=1642333634956, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=53206, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=4cbbcf975445, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=b07dfbf9-a4f5-4455-8203-a2cec4d67eff, http-req-server-port=80, http-header-accept=*/*, kc-id=6cb35628-1a35-4ce0-a796-86bb2026243f, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642333634955, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQG53NxAH4AEQAAAABh5AW7dAAkNmNiMzU2MjgtMWEzNS00Y2UwLWE3OTYtODZiYjIwMjYyNDNmdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRiMDdkZmJmOS1hNGY1LTQ0NTUtODIwMy1hMmNlYzRkNjdlZmZwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJEdC1tdDI0aWkxQ3VWUnBvbnRqazZNTFA4NFVOZDJDSnVVbTNzQXpGZXVVIn0.eyJleHAiOjE2NDIzMzM5MjcsImlhdCI6MTY0MjMzMzYyNywianRpIjoiNmNiMzU2MjgtMWEzNS00Y2UwLWE3OTYtODZiYjIwMjYyNDNmIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiJiMDdkZmJmOS1hNGY1LTQ0NTUtODIwMy1hMmNlYzRkNjdlZmYiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.LfQC6pOzHJwRKWJa93ShDgM_MdHoxnk9eyFbHPoREooqpMT3SMjbXwdLkCNCA1uopGCigRpu-rVC9ccTKnQlTDgnhvQem_tEjdzsYd5uMdjz4QlUMfilGKUWG6WO3balqXcCrl-G8-mb57iZhC2hQiX9z610oFRxfoiN6aHjOPbc3b5kLm37QHObSimyN-S1yTLGW4ut7qSpExXmOpDwje3DX8jhJWOJP852tpL4ihL6bOf0qaaYNartB524T1ibMy5pfYK7ayKYeVpBgw6f4U2R7IEK9owz6IFXQoP-VTCMEWrV0gnKBWbW0G6tosI4UBcwX_OETTaxyTxc26I4cw, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642333927, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.25.0.10, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=A40FFBF8F9B505B4E2BBABA7B727DFCA, http-session-last-accessed-time=1642333634955, kc-category-name=ACCESS, kc-iat=1642333627, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:53206 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:47:14.968  INFO 14 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:47:14.969  INFO 14 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6326de9b
2022-01-16 11:47:14.969  INFO 14 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6326de9b
2022-01-16 11:47:14.983  INFO 14 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6326de9b
2022-01-16 11:47:14.984  INFO 14 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6326de9b
2022-01-16 11:47:15.034  INFO 14 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6326de9b
2022-01-16 11:47:15.035  WARN 14 --- [https-jsse-nio-7071-exec-7] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:47:15.035  WARN 14 --- [https-jsse-nio-7071-exec-7] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:47:15.035  INFO 14 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6326de9b
2022-01-16 11:47:15.036  INFO 14 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6326de9b
2022-01-16 11:47:15.036  WARN 14 --- [https-jsse-nio-7071-exec-7] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:47:15.037  WARN 14 --- [https-jsse-nio-7071-exec-7] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:47:15.037  INFO 14 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6326de9b
2022-01-16 11:47:15.049  INFO 14 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: emergency-active, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6326de9b
2022-01-16 11:47:15.058  INFO 14 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6326de9b
2022-01-16 11:47:15.058  INFO 14 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6326de9b
2022-01-16 11:47:15.110  INFO 14 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6326de9b
2022-01-16 11:47:15.111  INFO 14 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-revoke-extra, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6326de9b
2022-01-16 11:47:15.124  INFO 14 --- [https-jsse-nio-7071-exec-7] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18912086069464692-709140, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=Deny}, TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:47:15.126  INFO 14 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=748012a0-8645-4d19-8ba7-e61506ca3f54, content=DENY, timestamp=1642333635126, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=Deny}, TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:47:15.127  INFO 14 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=158ms, Total=162ms
2022-01-16 11:47:15.146  INFO 14 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=650513e8-9b16-426a-825f-26d88a38910e, content=null, timestamp=1642333635140, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=53208, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=4cbbcf975445, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=b07dfbf9-a4f5-4455-8203-a2cec4d67eff, http-req-server-port=80, http-header-accept=*/*, kc-id=6cb35628-1a35-4ce0-a796-86bb2026243f, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642333635139, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQG53NxAH4AEQAAAABh5AW7dAAkNmNiMzU2MjgtMWEzNS00Y2UwLWE3OTYtODZiYjIwMjYyNDNmdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRiMDdkZmJmOS1hNGY1LTQ0NTUtODIwMy1hMmNlYzRkNjdlZmZwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJEdC1tdDI0aWkxQ3VWUnBvbnRqazZNTFA4NFVOZDJDSnVVbTNzQXpGZXVVIn0.eyJleHAiOjE2NDIzMzM5MjcsImlhdCI6MTY0MjMzMzYyNywianRpIjoiNmNiMzU2MjgtMWEzNS00Y2UwLWE3OTYtODZiYjIwMjYyNDNmIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiJiMDdkZmJmOS1hNGY1LTQ0NTUtODIwMy1hMmNlYzRkNjdlZmYiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.LfQC6pOzHJwRKWJa93ShDgM_MdHoxnk9eyFbHPoREooqpMT3SMjbXwdLkCNCA1uopGCigRpu-rVC9ccTKnQlTDgnhvQem_tEjdzsYd5uMdjz4QlUMfilGKUWG6WO3balqXcCrl-G8-mb57iZhC2hQiX9z610oFRxfoiN6aHjOPbc3b5kLm37QHObSimyN-S1yTLGW4ut7qSpExXmOpDwje3DX8jhJWOJP852tpL4ihL6bOf0qaaYNartB524T1ibMy5pfYK7ayKYeVpBgw6f4U2R7IEK9owz6IFXQoP-VTCMEWrV0gnKBWbW0G6tosI4UBcwX_OETTaxyTxc26I4cw, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642333927, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.25.0.10, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=3296790CE79CDFD09D011633BA1D4F36, http-session-last-accessed-time=1642333635139, kc-category-name=ACCESS, kc-iat=1642333627, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:53208 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:47:15.147  INFO 14 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:47:15.149  INFO 14 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@a940b42
2022-01-16 11:47:15.150  INFO 14 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@a940b42
2022-01-16 11:47:15.158  INFO 14 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@a940b42
2022-01-16 11:47:15.159  INFO 14 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@a940b42
2022-01-16 11:47:15.209  INFO 14 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@a940b42
2022-01-16 11:47:15.209  WARN 14 --- [https-jsse-nio-7071-exec-8] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:47:15.210  WARN 14 --- [https-jsse-nio-7071-exec-8] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:47:15.210  INFO 14 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@a940b42
2022-01-16 11:47:15.210  INFO 14 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@a940b42
2022-01-16 11:47:15.210  WARN 14 --- [https-jsse-nio-7071-exec-8] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:47:15.210  WARN 14 --- [https-jsse-nio-7071-exec-8] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:47:15.210  INFO 14 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@a940b42
2022-01-16 11:47:15.221  INFO 14 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: emergency-active, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@a940b42
2022-01-16 11:47:15.230  INFO 14 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@a940b42
2022-01-16 11:47:15.231  INFO 14 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@a940b42
2022-01-16 11:47:15.282  INFO 14 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@a940b42
2022-01-16 11:47:15.282  INFO 14 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-revoke-extra, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@a940b42
2022-01-16 11:47:15.295  INFO 14 --- [https-jsse-nio-7071-exec-8] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18912086249280316-470850, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=Deny}, TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:47:15.296  INFO 14 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=650513e8-9b16-426a-825f-26d88a38910e, content=DENY, timestamp=1642333635296, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=Deny}, TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:47:15.296  INFO 14 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=148ms, Total=152ms
2022-01-16 11:47:15.320  INFO 14 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=c2d67bb3-6f77-498f-a5ad-62eeeda613d8, content=null, timestamp=1642333635310, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=53210, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=4cbbcf975445, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=b07dfbf9-a4f5-4455-8203-a2cec4d67eff, http-req-server-port=80, http-header-accept=*/*, kc-id=6cb35628-1a35-4ce0-a796-86bb2026243f, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642333635309, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQG53NxAH4AEQAAAABh5AW7dAAkNmNiMzU2MjgtMWEzNS00Y2UwLWE3OTYtODZiYjIwMjYyNDNmdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRiMDdkZmJmOS1hNGY1LTQ0NTUtODIwMy1hMmNlYzRkNjdlZmZwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJEdC1tdDI0aWkxQ3VWUnBvbnRqazZNTFA4NFVOZDJDSnVVbTNzQXpGZXVVIn0.eyJleHAiOjE2NDIzMzM5MjcsImlhdCI6MTY0MjMzMzYyNywianRpIjoiNmNiMzU2MjgtMWEzNS00Y2UwLWE3OTYtODZiYjIwMjYyNDNmIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiJiMDdkZmJmOS1hNGY1LTQ0NTUtODIwMy1hMmNlYzRkNjdlZmYiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.LfQC6pOzHJwRKWJa93ShDgM_MdHoxnk9eyFbHPoREooqpMT3SMjbXwdLkCNCA1uopGCigRpu-rVC9ccTKnQlTDgnhvQem_tEjdzsYd5uMdjz4QlUMfilGKUWG6WO3balqXcCrl-G8-mb57iZhC2hQiX9z610oFRxfoiN6aHjOPbc3b5kLm37QHObSimyN-S1yTLGW4ut7qSpExXmOpDwje3DX8jhJWOJP852tpL4ihL6bOf0qaaYNartB524T1ibMy5pfYK7ayKYeVpBgw6f4U2R7IEK9owz6IFXQoP-VTCMEWrV0gnKBWbW0G6tosI4UBcwX_OETTaxyTxc26I4cw, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642333927, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.25.0.10, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=224EB4A4CBE425F945EFC31178C13687, http-session-last-accessed-time=1642333635309, kc-category-name=ACCESS, kc-iat=1642333627, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:53210 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:47:15.324  INFO 14 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:47:15.325  INFO 14 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@715aeeae
2022-01-16 11:47:15.326  INFO 14 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@715aeeae
2022-01-16 11:47:15.338  INFO 14 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@715aeeae
2022-01-16 11:47:15.339  INFO 14 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@715aeeae
2022-01-16 11:47:15.390  INFO 14 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@715aeeae
2022-01-16 11:47:15.390  WARN 14 --- [https-jsse-nio-7071-exec-9] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:47:15.390  WARN 14 --- [https-jsse-nio-7071-exec-9] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:47:15.394  INFO 14 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@715aeeae
2022-01-16 11:47:15.395  INFO 14 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@715aeeae
2022-01-16 11:47:15.397  WARN 14 --- [https-jsse-nio-7071-exec-9] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:47:15.397  WARN 14 --- [https-jsse-nio-7071-exec-9] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:47:15.399  INFO 14 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@715aeeae
2022-01-16 11:47:15.415  INFO 14 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: emergency-active, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@715aeeae
2022-01-16 11:47:15.423  INFO 14 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@715aeeae
2022-01-16 11:47:15.423  INFO 14 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@715aeeae
2022-01-16 11:47:15.481  INFO 14 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@715aeeae
2022-01-16 11:47:15.482  INFO 14 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-revoke-extra, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@715aeeae
2022-01-16 11:47:15.498  INFO 14 --- [https-jsse-nio-7071-exec-9] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18912086425916403-455319, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=Deny}, TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:47:15.498  INFO 14 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=c2d67bb3-6f77-498f-a5ad-62eeeda613d8, content=DENY, timestamp=1642333635498, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=Deny}, TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:47:15.499  INFO 14 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=174ms, Total=180ms
2022-01-16 11:47:15.517  INFO 14 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=57383d2b-ae07-468e-93d0-41eda3006e41, content=null, timestamp=1642333635510, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=53212, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=4cbbcf975445, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=b07dfbf9-a4f5-4455-8203-a2cec4d67eff, http-req-server-port=80, http-header-accept=*/*, kc-id=6cb35628-1a35-4ce0-a796-86bb2026243f, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642333635509, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQG53NxAH4AEQAAAABh5AW7dAAkNmNiMzU2MjgtMWEzNS00Y2UwLWE3OTYtODZiYjIwMjYyNDNmdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRiMDdkZmJmOS1hNGY1LTQ0NTUtODIwMy1hMmNlYzRkNjdlZmZwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJEdC1tdDI0aWkxQ3VWUnBvbnRqazZNTFA4NFVOZDJDSnVVbTNzQXpGZXVVIn0.eyJleHAiOjE2NDIzMzM5MjcsImlhdCI6MTY0MjMzMzYyNywianRpIjoiNmNiMzU2MjgtMWEzNS00Y2UwLWE3OTYtODZiYjIwMjYyNDNmIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiJiMDdkZmJmOS1hNGY1LTQ0NTUtODIwMy1hMmNlYzRkNjdlZmYiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.LfQC6pOzHJwRKWJa93ShDgM_MdHoxnk9eyFbHPoREooqpMT3SMjbXwdLkCNCA1uopGCigRpu-rVC9ccTKnQlTDgnhvQem_tEjdzsYd5uMdjz4QlUMfilGKUWG6WO3balqXcCrl-G8-mb57iZhC2hQiX9z610oFRxfoiN6aHjOPbc3b5kLm37QHObSimyN-S1yTLGW4ut7qSpExXmOpDwje3DX8jhJWOJP852tpL4ihL6bOf0qaaYNartB524T1ibMy5pfYK7ayKYeVpBgw6f4U2R7IEK9owz6IFXQoP-VTCMEWrV0gnKBWbW0G6tosI4UBcwX_OETTaxyTxc26I4cw, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642333927, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.25.0.10, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=C8367EDD7B9E4E7E27D8099E22AA7CE4, http-session-last-accessed-time=1642333635509, kc-category-name=ACCESS, kc-iat=1642333627, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:53212 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:47:15.517  INFO 14 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:47:15.518  INFO 14 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@374d214f
2022-01-16 11:47:15.518  INFO 14 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@374d214f
2022-01-16 11:47:15.531  INFO 14 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@374d214f
2022-01-16 11:47:15.531  INFO 14 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@374d214f
2022-01-16 11:47:15.586  INFO 14 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@374d214f
2022-01-16 11:47:15.586  WARN 14 --- [https-jsse-nio-7071-exec-10] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:47:15.586  WARN 14 --- [https-jsse-nio-7071-exec-10] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:47:15.586  INFO 14 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@374d214f
2022-01-16 11:47:15.587  INFO 14 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@374d214f
2022-01-16 11:47:15.587  WARN 14 --- [https-jsse-nio-7071-exec-10] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:47:15.587  WARN 14 --- [https-jsse-nio-7071-exec-10] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:47:15.588  INFO 14 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@374d214f
2022-01-16 11:47:15.600  INFO 14 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: emergency-active, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@374d214f
2022-01-16 11:47:15.608  INFO 14 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@374d214f
2022-01-16 11:47:15.608  INFO 14 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@374d214f
2022-01-16 11:47:15.657  INFO 14 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@374d214f
2022-01-16 11:47:15.657  INFO 14 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-revoke-extra, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@374d214f
2022-01-16 11:47:15.674  INFO 14 --- [https-jsse-nio-7071-exec-10] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18912086618982909-675426, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=Deny}, TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:47:15.674  INFO 14 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=57383d2b-ae07-468e-93d0-41eda3006e41, content=DENY, timestamp=1642333635674, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=Deny}, TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:47:15.675  INFO 14 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=157ms, Total=160ms
2022-01-16 11:47:15.693  INFO 14 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=6b626708-3aef-4008-8537-00bc3eb48e5c, content=null, timestamp=1642333635685, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=53214, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=4cbbcf975445, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=b07dfbf9-a4f5-4455-8203-a2cec4d67eff, http-req-server-port=80, http-header-accept=*/*, kc-id=6cb35628-1a35-4ce0-a796-86bb2026243f, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642333635684, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQG53NxAH4AEQAAAABh5AW7dAAkNmNiMzU2MjgtMWEzNS00Y2UwLWE3OTYtODZiYjIwMjYyNDNmdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRiMDdkZmJmOS1hNGY1LTQ0NTUtODIwMy1hMmNlYzRkNjdlZmZwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJEdC1tdDI0aWkxQ3VWUnBvbnRqazZNTFA4NFVOZDJDSnVVbTNzQXpGZXVVIn0.eyJleHAiOjE2NDIzMzM5MjcsImlhdCI6MTY0MjMzMzYyNywianRpIjoiNmNiMzU2MjgtMWEzNS00Y2UwLWE3OTYtODZiYjIwMjYyNDNmIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiJiMDdkZmJmOS1hNGY1LTQ0NTUtODIwMy1hMmNlYzRkNjdlZmYiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.LfQC6pOzHJwRKWJa93ShDgM_MdHoxnk9eyFbHPoREooqpMT3SMjbXwdLkCNCA1uopGCigRpu-rVC9ccTKnQlTDgnhvQem_tEjdzsYd5uMdjz4QlUMfilGKUWG6WO3balqXcCrl-G8-mb57iZhC2hQiX9z610oFRxfoiN6aHjOPbc3b5kLm37QHObSimyN-S1yTLGW4ut7qSpExXmOpDwje3DX8jhJWOJP852tpL4ihL6bOf0qaaYNartB524T1ibMy5pfYK7ayKYeVpBgw6f4U2R7IEK9owz6IFXQoP-VTCMEWrV0gnKBWbW0G6tosI4UBcwX_OETTaxyTxc26I4cw, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642333927, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.25.0.10, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=CBB17E9504C89B6E1FE27DF16D6A388C, http-session-last-accessed-time=1642333635684, kc-category-name=ACCESS, kc-iat=1642333627, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:53214 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:47:15.694  INFO 14 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:47:15.695  INFO 14 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5ce4d5c2
2022-01-16 11:47:15.696  INFO 14 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5ce4d5c2
2022-01-16 11:47:15.708  INFO 14 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5ce4d5c2
2022-01-16 11:47:15.708  INFO 14 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5ce4d5c2
2022-01-16 11:47:15.761  INFO 14 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5ce4d5c2
2022-01-16 11:47:15.762  WARN 14 --- [https-jsse-nio-7071-exec-1] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:47:15.762  WARN 14 --- [https-jsse-nio-7071-exec-1] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:47:15.763  INFO 14 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5ce4d5c2
2022-01-16 11:47:15.764  INFO 14 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5ce4d5c2
2022-01-16 11:47:15.764  WARN 14 --- [https-jsse-nio-7071-exec-1] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:47:15.764  WARN 14 --- [https-jsse-nio-7071-exec-1] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:47:15.765  INFO 14 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5ce4d5c2
2022-01-16 11:47:15.777  INFO 14 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: emergency-active, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5ce4d5c2
2022-01-16 11:47:15.786  INFO 14 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5ce4d5c2
2022-01-16 11:47:15.786  INFO 14 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5ce4d5c2
2022-01-16 11:47:15.838  INFO 14 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5ce4d5c2
2022-01-16 11:47:15.838  INFO 14 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-revoke-extra, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5ce4d5c2
2022-01-16 11:47:15.859  INFO 14 --- [https-jsse-nio-7071-exec-1] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18912086796043503-169648, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=Deny}, TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:47:15.861  INFO 14 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=6b626708-3aef-4008-8537-00bc3eb48e5c, content=DENY, timestamp=1642333635861, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=Deny}, TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:47:15.862  INFO 14 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=166ms, Total=170ms
2022-01-16 11:47:15.886  INFO 14 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=61b4e4af-aa9c-48c3-abc5-ef9d74b4c28b, content=null, timestamp=1642333635875, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=53216, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=4cbbcf975445, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=b07dfbf9-a4f5-4455-8203-a2cec4d67eff, http-req-server-port=80, http-header-accept=*/*, kc-id=6cb35628-1a35-4ce0-a796-86bb2026243f, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642333635874, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQG53NxAH4AEQAAAABh5AW7dAAkNmNiMzU2MjgtMWEzNS00Y2UwLWE3OTYtODZiYjIwMjYyNDNmdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRiMDdkZmJmOS1hNGY1LTQ0NTUtODIwMy1hMmNlYzRkNjdlZmZwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJEdC1tdDI0aWkxQ3VWUnBvbnRqazZNTFA4NFVOZDJDSnVVbTNzQXpGZXVVIn0.eyJleHAiOjE2NDIzMzM5MjcsImlhdCI6MTY0MjMzMzYyNywianRpIjoiNmNiMzU2MjgtMWEzNS00Y2UwLWE3OTYtODZiYjIwMjYyNDNmIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiJiMDdkZmJmOS1hNGY1LTQ0NTUtODIwMy1hMmNlYzRkNjdlZmYiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.LfQC6pOzHJwRKWJa93ShDgM_MdHoxnk9eyFbHPoREooqpMT3SMjbXwdLkCNCA1uopGCigRpu-rVC9ccTKnQlTDgnhvQem_tEjdzsYd5uMdjz4QlUMfilGKUWG6WO3balqXcCrl-G8-mb57iZhC2hQiX9z610oFRxfoiN6aHjOPbc3b5kLm37QHObSimyN-S1yTLGW4ut7qSpExXmOpDwje3DX8jhJWOJP852tpL4ihL6bOf0qaaYNartB524T1ibMy5pfYK7ayKYeVpBgw6f4U2R7IEK9owz6IFXQoP-VTCMEWrV0gnKBWbW0G6tosI4UBcwX_OETTaxyTxc26I4cw, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642333927, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.25.0.10, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=18EF25D3E15A6F9A63F528E7FC55D263, http-session-last-accessed-time=1642333635874, kc-category-name=ACCESS, kc-iat=1642333627, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:53216 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:47:15.887  INFO 14 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:47:15.888  INFO 14 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5ff1eddb
2022-01-16 11:47:15.888  INFO 14 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5ff1eddb
2022-01-16 11:47:15.905  INFO 14 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5ff1eddb
2022-01-16 11:47:15.906  INFO 14 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5ff1eddb
2022-01-16 11:47:15.957  INFO 14 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5ff1eddb
2022-01-16 11:47:15.958  WARN 14 --- [https-jsse-nio-7071-exec-2] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:47:15.958  WARN 14 --- [https-jsse-nio-7071-exec-2] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:47:15.959  INFO 14 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5ff1eddb
2022-01-16 11:47:15.960  INFO 14 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5ff1eddb
2022-01-16 11:47:15.960  WARN 14 --- [https-jsse-nio-7071-exec-2] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:47:15.960  WARN 14 --- [https-jsse-nio-7071-exec-2] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:47:15.961  INFO 14 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5ff1eddb
2022-01-16 11:47:15.973  INFO 14 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: emergency-active, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5ff1eddb
2022-01-16 11:47:15.981  INFO 14 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5ff1eddb
2022-01-16 11:47:15.981  INFO 14 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5ff1eddb
2022-01-16 11:47:16.033  INFO 14 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5ff1eddb
2022-01-16 11:47:16.034  INFO 14 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-revoke-extra, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5ff1eddb
2022-01-16 11:47:16.049  INFO 14 --- [https-jsse-nio-7071-exec-2] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18912086988703687-399848, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=Deny}, TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:47:16.049  INFO 14 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=61b4e4af-aa9c-48c3-abc5-ef9d74b4c28b, content=DENY, timestamp=1642333636049, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=Deny}, TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:47:16.050  INFO 14 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=162ms, Total=165ms
2022-01-16 11:47:16.066  INFO 14 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=c33fa2da-3ddf-4c86-b431-bd5cecca18e0, content=null, timestamp=1642333636061, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=53218, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=4cbbcf975445, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=b07dfbf9-a4f5-4455-8203-a2cec4d67eff, http-req-server-port=80, http-header-accept=*/*, kc-id=6cb35628-1a35-4ce0-a796-86bb2026243f, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642333636060, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQG53NxAH4AEQAAAABh5AW7dAAkNmNiMzU2MjgtMWEzNS00Y2UwLWE3OTYtODZiYjIwMjYyNDNmdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRiMDdkZmJmOS1hNGY1LTQ0NTUtODIwMy1hMmNlYzRkNjdlZmZwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJEdC1tdDI0aWkxQ3VWUnBvbnRqazZNTFA4NFVOZDJDSnVVbTNzQXpGZXVVIn0.eyJleHAiOjE2NDIzMzM5MjcsImlhdCI6MTY0MjMzMzYyNywianRpIjoiNmNiMzU2MjgtMWEzNS00Y2UwLWE3OTYtODZiYjIwMjYyNDNmIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiJiMDdkZmJmOS1hNGY1LTQ0NTUtODIwMy1hMmNlYzRkNjdlZmYiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.LfQC6pOzHJwRKWJa93ShDgM_MdHoxnk9eyFbHPoREooqpMT3SMjbXwdLkCNCA1uopGCigRpu-rVC9ccTKnQlTDgnhvQem_tEjdzsYd5uMdjz4QlUMfilGKUWG6WO3balqXcCrl-G8-mb57iZhC2hQiX9z610oFRxfoiN6aHjOPbc3b5kLm37QHObSimyN-S1yTLGW4ut7qSpExXmOpDwje3DX8jhJWOJP852tpL4ihL6bOf0qaaYNartB524T1ibMy5pfYK7ayKYeVpBgw6f4U2R7IEK9owz6IFXQoP-VTCMEWrV0gnKBWbW0G6tosI4UBcwX_OETTaxyTxc26I4cw, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642333927, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.25.0.10, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=41C1519B71F55BE14DC802C3EABE9326, http-session-last-accessed-time=1642333636060, kc-category-name=ACCESS, kc-iat=1642333627, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:53218 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:47:16.067  INFO 14 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:47:16.068  INFO 14 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@430c3bda
2022-01-16 11:47:16.068  INFO 14 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@430c3bda
2022-01-16 11:47:16.084  INFO 14 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@430c3bda
2022-01-16 11:47:16.085  INFO 14 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@430c3bda
2022-01-16 11:47:16.138  INFO 14 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@430c3bda
2022-01-16 11:47:16.138  WARN 14 --- [https-jsse-nio-7071-exec-3] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:47:16.138  WARN 14 --- [https-jsse-nio-7071-exec-3] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:47:16.138  INFO 14 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@430c3bda
2022-01-16 11:47:16.138  INFO 14 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@430c3bda
2022-01-16 11:47:16.139  WARN 14 --- [https-jsse-nio-7071-exec-3] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:47:16.139  WARN 14 --- [https-jsse-nio-7071-exec-3] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:47:16.139  INFO 14 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@430c3bda
2022-01-16 11:47:16.156  INFO 14 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: emergency-active, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@430c3bda
2022-01-16 11:47:16.169  INFO 14 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@430c3bda
2022-01-16 11:47:16.170  INFO 14 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@430c3bda
2022-01-16 11:47:16.222  INFO 14 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@430c3bda
2022-01-16 11:47:16.222  INFO 14 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-revoke-extra, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@430c3bda
2022-01-16 11:47:16.239  INFO 14 --- [https-jsse-nio-7071-exec-3] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18912087168893348-272492, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=Deny}, TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:47:16.239  INFO 14 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=c33fa2da-3ddf-4c86-b431-bd5cecca18e0, content=DENY, timestamp=1642333636239, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=Deny}, TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:47:16.241  INFO 14 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=172ms, Total=176ms
2022-01-16 11:47:16.265  INFO 14 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=167a45f0-ed64-4134-a389-f603cd59f1cf, content=null, timestamp=1642333636256, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=53220, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=4cbbcf975445, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=b07dfbf9-a4f5-4455-8203-a2cec4d67eff, http-req-server-port=80, http-header-accept=*/*, kc-id=6cb35628-1a35-4ce0-a796-86bb2026243f, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642333636255, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQG53NxAH4AEQAAAABh5AW7dAAkNmNiMzU2MjgtMWEzNS00Y2UwLWE3OTYtODZiYjIwMjYyNDNmdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRiMDdkZmJmOS1hNGY1LTQ0NTUtODIwMy1hMmNlYzRkNjdlZmZwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJEdC1tdDI0aWkxQ3VWUnBvbnRqazZNTFA4NFVOZDJDSnVVbTNzQXpGZXVVIn0.eyJleHAiOjE2NDIzMzM5MjcsImlhdCI6MTY0MjMzMzYyNywianRpIjoiNmNiMzU2MjgtMWEzNS00Y2UwLWE3OTYtODZiYjIwMjYyNDNmIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiJiMDdkZmJmOS1hNGY1LTQ0NTUtODIwMy1hMmNlYzRkNjdlZmYiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.LfQC6pOzHJwRKWJa93ShDgM_MdHoxnk9eyFbHPoREooqpMT3SMjbXwdLkCNCA1uopGCigRpu-rVC9ccTKnQlTDgnhvQem_tEjdzsYd5uMdjz4QlUMfilGKUWG6WO3balqXcCrl-G8-mb57iZhC2hQiX9z610oFRxfoiN6aHjOPbc3b5kLm37QHObSimyN-S1yTLGW4ut7qSpExXmOpDwje3DX8jhJWOJP852tpL4ihL6bOf0qaaYNartB524T1ibMy5pfYK7ayKYeVpBgw6f4U2R7IEK9owz6IFXQoP-VTCMEWrV0gnKBWbW0G6tosI4UBcwX_OETTaxyTxc26I4cw, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642333927, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.25.0.10, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=E5184E017BD7C752E2532D5C7793475B, http-session-last-accessed-time=1642333636255, kc-category-name=ACCESS, kc-iat=1642333627, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:53220 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:47:16.267  INFO 14 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:47:16.268  INFO 14 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3040845d
2022-01-16 11:47:16.268  INFO 14 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3040845d
2022-01-16 11:47:16.283  INFO 14 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3040845d
2022-01-16 11:47:16.283  INFO 14 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3040845d
2022-01-16 11:47:16.333  INFO 14 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3040845d
2022-01-16 11:47:16.334  WARN 14 --- [https-jsse-nio-7071-exec-4] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:47:16.334  WARN 14 --- [https-jsse-nio-7071-exec-4] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:47:16.335  INFO 14 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3040845d
2022-01-16 11:47:16.335  INFO 14 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3040845d
2022-01-16 11:47:16.335  WARN 14 --- [https-jsse-nio-7071-exec-4] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:47:16.335  WARN 14 --- [https-jsse-nio-7071-exec-4] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:47:16.336  INFO 14 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3040845d
2022-01-16 11:47:16.352  INFO 14 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: emergency-active, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3040845d
2022-01-16 11:47:16.360  INFO 14 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3040845d
2022-01-16 11:47:16.361  INFO 14 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3040845d
2022-01-16 11:47:16.409  INFO 14 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3040845d
2022-01-16 11:47:16.410  INFO 14 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-revoke-extra, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3040845d
2022-01-16 11:47:16.424  INFO 14 --- [https-jsse-nio-7071-exec-4] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18912087368627789-387959, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=Deny}, TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:47:16.424  INFO 14 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=167a45f0-ed64-4134-a389-f603cd59f1cf, content=DENY, timestamp=1642333636424, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=Deny}, TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:47:16.425  INFO 14 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=157ms, Total=161ms
2022-01-16 11:47:16.441  INFO 14 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=6b045536-bad2-491a-b386-c9a668dfe599, content=null, timestamp=1642333636436, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=53222, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=4cbbcf975445, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=b07dfbf9-a4f5-4455-8203-a2cec4d67eff, http-req-server-port=80, http-header-accept=*/*, kc-id=6cb35628-1a35-4ce0-a796-86bb2026243f, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642333636435, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQG53NxAH4AEQAAAABh5AW7dAAkNmNiMzU2MjgtMWEzNS00Y2UwLWE3OTYtODZiYjIwMjYyNDNmdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRiMDdkZmJmOS1hNGY1LTQ0NTUtODIwMy1hMmNlYzRkNjdlZmZwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJEdC1tdDI0aWkxQ3VWUnBvbnRqazZNTFA4NFVOZDJDSnVVbTNzQXpGZXVVIn0.eyJleHAiOjE2NDIzMzM5MjcsImlhdCI6MTY0MjMzMzYyNywianRpIjoiNmNiMzU2MjgtMWEzNS00Y2UwLWE3OTYtODZiYjIwMjYyNDNmIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiJiMDdkZmJmOS1hNGY1LTQ0NTUtODIwMy1hMmNlYzRkNjdlZmYiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.LfQC6pOzHJwRKWJa93ShDgM_MdHoxnk9eyFbHPoREooqpMT3SMjbXwdLkCNCA1uopGCigRpu-rVC9ccTKnQlTDgnhvQem_tEjdzsYd5uMdjz4QlUMfilGKUWG6WO3balqXcCrl-G8-mb57iZhC2hQiX9z610oFRxfoiN6aHjOPbc3b5kLm37QHObSimyN-S1yTLGW4ut7qSpExXmOpDwje3DX8jhJWOJP852tpL4ihL6bOf0qaaYNartB524T1ibMy5pfYK7ayKYeVpBgw6f4U2R7IEK9owz6IFXQoP-VTCMEWrV0gnKBWbW0G6tosI4UBcwX_OETTaxyTxc26I4cw, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642333927, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.25.0.10, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=818CC5C9AC271F7C4E85F6BF120938EF, http-session-last-accessed-time=1642333636435, kc-category-name=ACCESS, kc-iat=1642333627, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:53222 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:47:16.441  INFO 14 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:47:16.442  INFO 14 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@66a32d4f
2022-01-16 11:47:16.442  INFO 14 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@66a32d4f
2022-01-16 11:47:16.452  INFO 14 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@66a32d4f
2022-01-16 11:47:16.452  INFO 14 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@66a32d4f
2022-01-16 11:47:16.502  INFO 14 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@66a32d4f
2022-01-16 11:47:16.502  WARN 14 --- [https-jsse-nio-7071-exec-5] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:47:16.502  WARN 14 --- [https-jsse-nio-7071-exec-5] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:47:16.503  INFO 14 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@66a32d4f
2022-01-16 11:47:16.503  INFO 14 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@66a32d4f
2022-01-16 11:47:16.503  WARN 14 --- [https-jsse-nio-7071-exec-5] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:47:16.503  WARN 14 --- [https-jsse-nio-7071-exec-5] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:47:16.504  INFO 14 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@66a32d4f
2022-01-16 11:47:16.514  INFO 14 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: emergency-active, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@66a32d4f
2022-01-16 11:47:16.522  INFO 14 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@66a32d4f
2022-01-16 11:47:16.522  INFO 14 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@66a32d4f
2022-01-16 11:47:16.577  INFO 14 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@66a32d4f
2022-01-16 11:47:16.577  INFO 14 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-revoke-extra, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@66a32d4f
2022-01-16 11:47:16.587  INFO 14 --- [https-jsse-nio-7071-exec-5] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18912087542876939-639483, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=Deny}, TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:47:16.587  INFO 14 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=6b045536-bad2-491a-b386-c9a668dfe599, content=DENY, timestamp=1642333636587, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=Deny}, TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:47:16.588  INFO 14 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=146ms, Total=149ms
2022-01-16 11:47:16.608  INFO 14 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=c828d8af-f0b3-49a9-a715-494eaa52e58f, content=null, timestamp=1642333636599, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=53224, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=4cbbcf975445, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=b07dfbf9-a4f5-4455-8203-a2cec4d67eff, http-req-server-port=80, http-header-accept=*/*, kc-id=6cb35628-1a35-4ce0-a796-86bb2026243f, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642333636598, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQG53NxAH4AEQAAAABh5AW7dAAkNmNiMzU2MjgtMWEzNS00Y2UwLWE3OTYtODZiYjIwMjYyNDNmdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRiMDdkZmJmOS1hNGY1LTQ0NTUtODIwMy1hMmNlYzRkNjdlZmZwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJEdC1tdDI0aWkxQ3VWUnBvbnRqazZNTFA4NFVOZDJDSnVVbTNzQXpGZXVVIn0.eyJleHAiOjE2NDIzMzM5MjcsImlhdCI6MTY0MjMzMzYyNywianRpIjoiNmNiMzU2MjgtMWEzNS00Y2UwLWE3OTYtODZiYjIwMjYyNDNmIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiJiMDdkZmJmOS1hNGY1LTQ0NTUtODIwMy1hMmNlYzRkNjdlZmYiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.LfQC6pOzHJwRKWJa93ShDgM_MdHoxnk9eyFbHPoREooqpMT3SMjbXwdLkCNCA1uopGCigRpu-rVC9ccTKnQlTDgnhvQem_tEjdzsYd5uMdjz4QlUMfilGKUWG6WO3balqXcCrl-G8-mb57iZhC2hQiX9z610oFRxfoiN6aHjOPbc3b5kLm37QHObSimyN-S1yTLGW4ut7qSpExXmOpDwje3DX8jhJWOJP852tpL4ihL6bOf0qaaYNartB524T1ibMy5pfYK7ayKYeVpBgw6f4U2R7IEK9owz6IFXQoP-VTCMEWrV0gnKBWbW0G6tosI4UBcwX_OETTaxyTxc26I4cw, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642333927, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.25.0.10, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=2C48FF7793CE7683F26B35A789A9A2D9, http-session-last-accessed-time=1642333636598, kc-category-name=ACCESS, kc-iat=1642333627, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:53224 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:47:16.609  INFO 14 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:47:16.609  INFO 14 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1d84842c
2022-01-16 11:47:16.610  INFO 14 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1d84842c
2022-01-16 11:47:16.620  INFO 14 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1d84842c
2022-01-16 11:47:16.620  INFO 14 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1d84842c
2022-01-16 11:47:16.669  INFO 14 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1d84842c
2022-01-16 11:47:16.670  WARN 14 --- [https-jsse-nio-7071-exec-6] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:47:16.670  WARN 14 --- [https-jsse-nio-7071-exec-6] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:47:16.670  INFO 14 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1d84842c
2022-01-16 11:47:16.670  INFO 14 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1d84842c
2022-01-16 11:47:16.670  WARN 14 --- [https-jsse-nio-7071-exec-6] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:47:16.671  WARN 14 --- [https-jsse-nio-7071-exec-6] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:47:16.671  INFO 14 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1d84842c
2022-01-16 11:47:16.681  INFO 14 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: emergency-active, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1d84842c
2022-01-16 11:47:16.690  INFO 14 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1d84842c
2022-01-16 11:47:16.690  INFO 14 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1d84842c
2022-01-16 11:47:16.741  INFO 14 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1d84842c
2022-01-16 11:47:16.742  INFO 14 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-revoke-extra, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1d84842c
2022-01-16 11:47:16.754  INFO 14 --- [https-jsse-nio-7071-exec-6] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18912087710403997-785168, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=Deny}, TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:47:16.755  INFO 14 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=c828d8af-f0b3-49a9-a715-494eaa52e58f, content=DENY, timestamp=1642333636755, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=Deny}, TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:47:16.755  INFO 14 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=146ms, Total=149ms
2022-01-16 11:47:16.773  INFO 14 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=90fd932e-2ebe-4317-8ce6-1edd3f81d2a9, content=null, timestamp=1642333636768, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=53226, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=4cbbcf975445, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=b07dfbf9-a4f5-4455-8203-a2cec4d67eff, http-req-server-port=80, http-header-accept=*/*, kc-id=6cb35628-1a35-4ce0-a796-86bb2026243f, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642333636767, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQG53NxAH4AEQAAAABh5AW7dAAkNmNiMzU2MjgtMWEzNS00Y2UwLWE3OTYtODZiYjIwMjYyNDNmdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRiMDdkZmJmOS1hNGY1LTQ0NTUtODIwMy1hMmNlYzRkNjdlZmZwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJEdC1tdDI0aWkxQ3VWUnBvbnRqazZNTFA4NFVOZDJDSnVVbTNzQXpGZXVVIn0.eyJleHAiOjE2NDIzMzM5MjcsImlhdCI6MTY0MjMzMzYyNywianRpIjoiNmNiMzU2MjgtMWEzNS00Y2UwLWE3OTYtODZiYjIwMjYyNDNmIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiJiMDdkZmJmOS1hNGY1LTQ0NTUtODIwMy1hMmNlYzRkNjdlZmYiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.LfQC6pOzHJwRKWJa93ShDgM_MdHoxnk9eyFbHPoREooqpMT3SMjbXwdLkCNCA1uopGCigRpu-rVC9ccTKnQlTDgnhvQem_tEjdzsYd5uMdjz4QlUMfilGKUWG6WO3balqXcCrl-G8-mb57iZhC2hQiX9z610oFRxfoiN6aHjOPbc3b5kLm37QHObSimyN-S1yTLGW4ut7qSpExXmOpDwje3DX8jhJWOJP852tpL4ihL6bOf0qaaYNartB524T1ibMy5pfYK7ayKYeVpBgw6f4U2R7IEK9owz6IFXQoP-VTCMEWrV0gnKBWbW0G6tosI4UBcwX_OETTaxyTxc26I4cw, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642333927, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.25.0.10, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=D50A78684D8F1FB90205CD08B5899E4C, http-session-last-accessed-time=1642333636767, kc-category-name=ACCESS, kc-iat=1642333627, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:53226 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:47:16.778  INFO 14 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:47:16.779  INFO 14 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@55a8372
2022-01-16 11:47:16.779  INFO 14 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@55a8372
2022-01-16 11:47:16.790  INFO 14 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@55a8372
2022-01-16 11:47:16.790  INFO 14 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@55a8372
2022-01-16 11:47:16.842  INFO 14 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@55a8372
2022-01-16 11:47:16.843  WARN 14 --- [https-jsse-nio-7071-exec-7] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:47:16.843  WARN 14 --- [https-jsse-nio-7071-exec-7] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:47:16.845  INFO 14 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@55a8372
2022-01-16 11:47:16.845  INFO 14 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@55a8372
2022-01-16 11:47:16.846  WARN 14 --- [https-jsse-nio-7071-exec-7] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:47:16.847  WARN 14 --- [https-jsse-nio-7071-exec-7] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:47:16.848  INFO 14 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@55a8372
2022-01-16 11:47:16.858  INFO 14 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: emergency-active, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@55a8372
2022-01-16 11:47:16.868  INFO 14 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@55a8372
2022-01-16 11:47:16.868  INFO 14 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@55a8372
2022-01-16 11:47:16.918  INFO 14 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@55a8372
2022-01-16 11:47:16.918  INFO 14 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-revoke-extra, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@55a8372
2022-01-16 11:47:16.932  INFO 14 --- [https-jsse-nio-7071-exec-7] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18912087879572997-890296, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=Deny}, TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:47:16.932  INFO 14 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=90fd932e-2ebe-4317-8ce6-1edd3f81d2a9, content=DENY, timestamp=1642333636932, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=Deny}, TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:47:16.933  INFO 14 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=154ms, Total=161ms
2022-01-16 11:47:16.950  INFO 14 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=789a13d7-21d3-426f-8d82-a3f9aea42cc2, content=null, timestamp=1642333636945, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=53228, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=4cbbcf975445, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=b07dfbf9-a4f5-4455-8203-a2cec4d67eff, http-req-server-port=80, http-header-accept=*/*, kc-id=6cb35628-1a35-4ce0-a796-86bb2026243f, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642333636943, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQG53NxAH4AEQAAAABh5AW7dAAkNmNiMzU2MjgtMWEzNS00Y2UwLWE3OTYtODZiYjIwMjYyNDNmdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRiMDdkZmJmOS1hNGY1LTQ0NTUtODIwMy1hMmNlYzRkNjdlZmZwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJEdC1tdDI0aWkxQ3VWUnBvbnRqazZNTFA4NFVOZDJDSnVVbTNzQXpGZXVVIn0.eyJleHAiOjE2NDIzMzM5MjcsImlhdCI6MTY0MjMzMzYyNywianRpIjoiNmNiMzU2MjgtMWEzNS00Y2UwLWE3OTYtODZiYjIwMjYyNDNmIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiJiMDdkZmJmOS1hNGY1LTQ0NTUtODIwMy1hMmNlYzRkNjdlZmYiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.LfQC6pOzHJwRKWJa93ShDgM_MdHoxnk9eyFbHPoREooqpMT3SMjbXwdLkCNCA1uopGCigRpu-rVC9ccTKnQlTDgnhvQem_tEjdzsYd5uMdjz4QlUMfilGKUWG6WO3balqXcCrl-G8-mb57iZhC2hQiX9z610oFRxfoiN6aHjOPbc3b5kLm37QHObSimyN-S1yTLGW4ut7qSpExXmOpDwje3DX8jhJWOJP852tpL4ihL6bOf0qaaYNartB524T1ibMy5pfYK7ayKYeVpBgw6f4U2R7IEK9owz6IFXQoP-VTCMEWrV0gnKBWbW0G6tosI4UBcwX_OETTaxyTxc26I4cw, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642333927, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.25.0.10, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=3687AE2C037110FDE1473A2D11DDA8BB, http-session-last-accessed-time=1642333636943, kc-category-name=ACCESS, kc-iat=1642333627, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:53228 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:47:16.951  INFO 14 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:47:16.952  INFO 14 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1b0cf7bb
2022-01-16 11:47:16.952  INFO 14 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1b0cf7bb
2022-01-16 11:47:16.961  INFO 14 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1b0cf7bb
2022-01-16 11:47:16.962  INFO 14 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1b0cf7bb
2022-01-16 11:47:17.009  INFO 14 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1b0cf7bb
2022-01-16 11:47:17.013  WARN 14 --- [https-jsse-nio-7071-exec-8] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:47:17.013  WARN 14 --- [https-jsse-nio-7071-exec-8] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:47:17.014  INFO 14 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1b0cf7bb
2022-01-16 11:47:17.014  INFO 14 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1b0cf7bb
2022-01-16 11:47:17.014  WARN 14 --- [https-jsse-nio-7071-exec-8] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:47:17.014  WARN 14 --- [https-jsse-nio-7071-exec-8] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:47:17.015  INFO 14 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1b0cf7bb
2022-01-16 11:47:17.027  INFO 14 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: emergency-active, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1b0cf7bb
2022-01-16 11:47:17.037  INFO 14 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1b0cf7bb
2022-01-16 11:47:17.037  INFO 14 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1b0cf7bb
2022-01-16 11:47:17.086  INFO 14 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1b0cf7bb
2022-01-16 11:47:17.086  INFO 14 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-revoke-extra, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1b0cf7bb
2022-01-16 11:47:17.099  INFO 14 --- [https-jsse-nio-7071-exec-8] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18912088052469455-570947, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=Deny}, TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:47:17.099  INFO 14 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=789a13d7-21d3-426f-8d82-a3f9aea42cc2, content=DENY, timestamp=1642333637099, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=Deny}, TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:47:17.100  INFO 14 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=148ms, Total=151ms
2022-01-16 11:47:17.115  INFO 14 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=08cc46e7-29f9-4a6d-94fa-a55018140750, content=null, timestamp=1642333637110, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=53230, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=4cbbcf975445, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=b07dfbf9-a4f5-4455-8203-a2cec4d67eff, http-req-server-port=80, http-header-accept=*/*, kc-id=6cb35628-1a35-4ce0-a796-86bb2026243f, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642333637109, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQG53NxAH4AEQAAAABh5AW7dAAkNmNiMzU2MjgtMWEzNS00Y2UwLWE3OTYtODZiYjIwMjYyNDNmdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRiMDdkZmJmOS1hNGY1LTQ0NTUtODIwMy1hMmNlYzRkNjdlZmZwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJEdC1tdDI0aWkxQ3VWUnBvbnRqazZNTFA4NFVOZDJDSnVVbTNzQXpGZXVVIn0.eyJleHAiOjE2NDIzMzM5MjcsImlhdCI6MTY0MjMzMzYyNywianRpIjoiNmNiMzU2MjgtMWEzNS00Y2UwLWE3OTYtODZiYjIwMjYyNDNmIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiJiMDdkZmJmOS1hNGY1LTQ0NTUtODIwMy1hMmNlYzRkNjdlZmYiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.LfQC6pOzHJwRKWJa93ShDgM_MdHoxnk9eyFbHPoREooqpMT3SMjbXwdLkCNCA1uopGCigRpu-rVC9ccTKnQlTDgnhvQem_tEjdzsYd5uMdjz4QlUMfilGKUWG6WO3balqXcCrl-G8-mb57iZhC2hQiX9z610oFRxfoiN6aHjOPbc3b5kLm37QHObSimyN-S1yTLGW4ut7qSpExXmOpDwje3DX8jhJWOJP852tpL4ihL6bOf0qaaYNartB524T1ibMy5pfYK7ayKYeVpBgw6f4U2R7IEK9owz6IFXQoP-VTCMEWrV0gnKBWbW0G6tosI4UBcwX_OETTaxyTxc26I4cw, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642333927, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.25.0.10, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=BB65401B5F18FABF881C62D08DB86390, http-session-last-accessed-time=1642333637109, kc-category-name=ACCESS, kc-iat=1642333627, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:53230 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:47:17.115  INFO 14 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:47:17.116  INFO 14 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5bc5a9a5
2022-01-16 11:47:17.116  INFO 14 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5bc5a9a5
2022-01-16 11:47:17.125  INFO 14 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5bc5a9a5
2022-01-16 11:47:17.125  INFO 14 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5bc5a9a5
2022-01-16 11:47:17.182  INFO 14 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5bc5a9a5
2022-01-16 11:47:17.182  WARN 14 --- [https-jsse-nio-7071-exec-9] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:47:17.183  WARN 14 --- [https-jsse-nio-7071-exec-9] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:47:17.183  INFO 14 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5bc5a9a5
2022-01-16 11:47:17.184  INFO 14 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5bc5a9a5
2022-01-16 11:47:17.184  WARN 14 --- [https-jsse-nio-7071-exec-9] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:47:17.185  WARN 14 --- [https-jsse-nio-7071-exec-9] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:47:17.185  INFO 14 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5bc5a9a5
2022-01-16 11:47:17.201  INFO 14 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: emergency-active, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5bc5a9a5
2022-01-16 11:47:17.210  INFO 14 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5bc5a9a5
2022-01-16 11:47:17.210  INFO 14 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5bc5a9a5
2022-01-16 11:47:17.262  INFO 14 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5bc5a9a5
2022-01-16 11:47:17.263  INFO 14 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-revoke-extra, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5bc5a9a5
2022-01-16 11:47:17.274  INFO 14 --- [https-jsse-nio-7071-exec-9] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18912088216984075-383515, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=Deny}, TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:47:17.275  INFO 14 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=08cc46e7-29f9-4a6d-94fa-a55018140750, content=DENY, timestamp=1642333637275, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=Deny}, TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:47:17.276  INFO 14 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=160ms, Total=162ms
2022-01-16 11:47:17.300  INFO 14 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=e18e554c-ed1a-4c99-8083-c955ce191982, content=null, timestamp=1642333637288, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=53232, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=4cbbcf975445, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=b07dfbf9-a4f5-4455-8203-a2cec4d67eff, http-req-server-port=80, http-header-accept=*/*, kc-id=6cb35628-1a35-4ce0-a796-86bb2026243f, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642333637286, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQG53NxAH4AEQAAAABh5AW7dAAkNmNiMzU2MjgtMWEzNS00Y2UwLWE3OTYtODZiYjIwMjYyNDNmdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRiMDdkZmJmOS1hNGY1LTQ0NTUtODIwMy1hMmNlYzRkNjdlZmZwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJEdC1tdDI0aWkxQ3VWUnBvbnRqazZNTFA4NFVOZDJDSnVVbTNzQXpGZXVVIn0.eyJleHAiOjE2NDIzMzM5MjcsImlhdCI6MTY0MjMzMzYyNywianRpIjoiNmNiMzU2MjgtMWEzNS00Y2UwLWE3OTYtODZiYjIwMjYyNDNmIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiJiMDdkZmJmOS1hNGY1LTQ0NTUtODIwMy1hMmNlYzRkNjdlZmYiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.LfQC6pOzHJwRKWJa93ShDgM_MdHoxnk9eyFbHPoREooqpMT3SMjbXwdLkCNCA1uopGCigRpu-rVC9ccTKnQlTDgnhvQem_tEjdzsYd5uMdjz4QlUMfilGKUWG6WO3balqXcCrl-G8-mb57iZhC2hQiX9z610oFRxfoiN6aHjOPbc3b5kLm37QHObSimyN-S1yTLGW4ut7qSpExXmOpDwje3DX8jhJWOJP852tpL4ihL6bOf0qaaYNartB524T1ibMy5pfYK7ayKYeVpBgw6f4U2R7IEK9owz6IFXQoP-VTCMEWrV0gnKBWbW0G6tosI4UBcwX_OETTaxyTxc26I4cw, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642333927, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.25.0.10, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=DE45595231B52E2B06441022E47C1D5A, http-session-last-accessed-time=1642333637286, kc-category-name=ACCESS, kc-iat=1642333627, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:53232 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:47:17.301  INFO 14 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:47:17.302  INFO 14 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1b608ed7
2022-01-16 11:47:17.303  INFO 14 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1b608ed7
2022-01-16 11:47:17.313  INFO 14 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1b608ed7
2022-01-16 11:47:17.314  INFO 14 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1b608ed7
2022-01-16 11:47:17.361  INFO 14 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1b608ed7
2022-01-16 11:47:17.362  WARN 14 --- [https-jsse-nio-7071-exec-10] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:47:17.362  WARN 14 --- [https-jsse-nio-7071-exec-10] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:47:17.362  INFO 14 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1b608ed7
2022-01-16 11:47:17.362  INFO 14 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1b608ed7
2022-01-16 11:47:17.362  WARN 14 --- [https-jsse-nio-7071-exec-10] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:47:17.362  WARN 14 --- [https-jsse-nio-7071-exec-10] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:47:17.362  INFO 14 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1b608ed7
2022-01-16 11:47:17.376  INFO 14 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: emergency-active, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1b608ed7
2022-01-16 11:47:17.383  INFO 14 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1b608ed7
2022-01-16 11:47:17.384  INFO 14 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1b608ed7
2022-01-16 11:47:17.434  INFO 14 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1b608ed7
2022-01-16 11:47:17.434  INFO 14 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-revoke-extra, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1b608ed7
2022-01-16 11:47:17.442  INFO 14 --- [https-jsse-nio-7071-exec-10] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18912088403147517-679256, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=Deny}, TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:47:17.442  INFO 14 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=e18e554c-ed1a-4c99-8083-c955ce191982, content=DENY, timestamp=1642333637442, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=Deny}, TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:47:17.443  INFO 14 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=140ms, Total=145ms
2022-01-16 11:47:17.461  INFO 14 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=dcdbdca4-4c09-4e20-a601-44da368d8e43, content=null, timestamp=1642333637456, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=53234, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=4cbbcf975445, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=b07dfbf9-a4f5-4455-8203-a2cec4d67eff, http-req-server-port=80, http-header-accept=*/*, kc-id=6cb35628-1a35-4ce0-a796-86bb2026243f, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642333637454, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQG53NxAH4AEQAAAABh5AW7dAAkNmNiMzU2MjgtMWEzNS00Y2UwLWE3OTYtODZiYjIwMjYyNDNmdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRiMDdkZmJmOS1hNGY1LTQ0NTUtODIwMy1hMmNlYzRkNjdlZmZwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJEdC1tdDI0aWkxQ3VWUnBvbnRqazZNTFA4NFVOZDJDSnVVbTNzQXpGZXVVIn0.eyJleHAiOjE2NDIzMzM5MjcsImlhdCI6MTY0MjMzMzYyNywianRpIjoiNmNiMzU2MjgtMWEzNS00Y2UwLWE3OTYtODZiYjIwMjYyNDNmIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiJiMDdkZmJmOS1hNGY1LTQ0NTUtODIwMy1hMmNlYzRkNjdlZmYiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.LfQC6pOzHJwRKWJa93ShDgM_MdHoxnk9eyFbHPoREooqpMT3SMjbXwdLkCNCA1uopGCigRpu-rVC9ccTKnQlTDgnhvQem_tEjdzsYd5uMdjz4QlUMfilGKUWG6WO3balqXcCrl-G8-mb57iZhC2hQiX9z610oFRxfoiN6aHjOPbc3b5kLm37QHObSimyN-S1yTLGW4ut7qSpExXmOpDwje3DX8jhJWOJP852tpL4ihL6bOf0qaaYNartB524T1ibMy5pfYK7ayKYeVpBgw6f4U2R7IEK9owz6IFXQoP-VTCMEWrV0gnKBWbW0G6tosI4UBcwX_OETTaxyTxc26I4cw, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642333927, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.25.0.10, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=9A57D5FAD630FB1C4C202E8406EC77A3, http-session-last-accessed-time=1642333637454, kc-category-name=ACCESS, kc-iat=1642333627, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:53234 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:47:17.462  INFO 14 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:47:17.463  INFO 14 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4b8a9fa4
2022-01-16 11:47:17.463  INFO 14 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4b8a9fa4
2022-01-16 11:47:17.472  INFO 14 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4b8a9fa4
2022-01-16 11:47:17.472  INFO 14 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4b8a9fa4
2022-01-16 11:47:17.521  INFO 14 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4b8a9fa4
2022-01-16 11:47:17.521  WARN 14 --- [https-jsse-nio-7071-exec-1] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:47:17.522  WARN 14 --- [https-jsse-nio-7071-exec-1] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:47:17.522  INFO 14 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4b8a9fa4
2022-01-16 11:47:17.522  INFO 14 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4b8a9fa4
2022-01-16 11:47:17.522  WARN 14 --- [https-jsse-nio-7071-exec-1] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:47:17.522  WARN 14 --- [https-jsse-nio-7071-exec-1] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:47:17.522  INFO 14 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4b8a9fa4
2022-01-16 11:47:17.538  INFO 14 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: emergency-active, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4b8a9fa4
2022-01-16 11:47:17.551  INFO 14 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4b8a9fa4
2022-01-16 11:47:17.552  INFO 14 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4b8a9fa4
2022-01-16 11:47:17.601  INFO 14 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4b8a9fa4
2022-01-16 11:47:17.602  INFO 14 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-revoke-extra, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4b8a9fa4
2022-01-16 11:47:17.615  INFO 14 --- [https-jsse-nio-7071-exec-1] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18912088563284876-253697, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=Deny}, TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:47:17.615  INFO 14 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=dcdbdca4-4c09-4e20-a601-44da368d8e43, content=DENY, timestamp=1642333637615, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=Deny}, TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:47:17.615  INFO 14 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=153ms, Total=155ms
2022-01-16 11:47:17.631  INFO 14 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=86dd2308-0111-4ff3-9c52-4cb7a2efe031, content=null, timestamp=1642333637626, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=53236, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=4cbbcf975445, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=b07dfbf9-a4f5-4455-8203-a2cec4d67eff, http-req-server-port=80, http-header-accept=*/*, kc-id=6cb35628-1a35-4ce0-a796-86bb2026243f, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642333637625, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQG53NxAH4AEQAAAABh5AW7dAAkNmNiMzU2MjgtMWEzNS00Y2UwLWE3OTYtODZiYjIwMjYyNDNmdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRiMDdkZmJmOS1hNGY1LTQ0NTUtODIwMy1hMmNlYzRkNjdlZmZwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJEdC1tdDI0aWkxQ3VWUnBvbnRqazZNTFA4NFVOZDJDSnVVbTNzQXpGZXVVIn0.eyJleHAiOjE2NDIzMzM5MjcsImlhdCI6MTY0MjMzMzYyNywianRpIjoiNmNiMzU2MjgtMWEzNS00Y2UwLWE3OTYtODZiYjIwMjYyNDNmIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiJiMDdkZmJmOS1hNGY1LTQ0NTUtODIwMy1hMmNlYzRkNjdlZmYiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.LfQC6pOzHJwRKWJa93ShDgM_MdHoxnk9eyFbHPoREooqpMT3SMjbXwdLkCNCA1uopGCigRpu-rVC9ccTKnQlTDgnhvQem_tEjdzsYd5uMdjz4QlUMfilGKUWG6WO3balqXcCrl-G8-mb57iZhC2hQiX9z610oFRxfoiN6aHjOPbc3b5kLm37QHObSimyN-S1yTLGW4ut7qSpExXmOpDwje3DX8jhJWOJP852tpL4ihL6bOf0qaaYNartB524T1ibMy5pfYK7ayKYeVpBgw6f4U2R7IEK9owz6IFXQoP-VTCMEWrV0gnKBWbW0G6tosI4UBcwX_OETTaxyTxc26I4cw, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642333927, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.25.0.10, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=02E7684470A1D7A421B19F31B730C8C4, http-session-last-accessed-time=1642333637625, kc-category-name=ACCESS, kc-iat=1642333627, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:53236 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:47:17.632  INFO 14 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:47:17.633  INFO 14 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@461a2d2a
2022-01-16 11:47:17.633  INFO 14 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@461a2d2a
2022-01-16 11:47:17.642  INFO 14 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@461a2d2a
2022-01-16 11:47:17.642  INFO 14 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@461a2d2a
2022-01-16 11:47:17.693  INFO 14 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@461a2d2a
2022-01-16 11:47:17.694  WARN 14 --- [https-jsse-nio-7071-exec-2] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:47:17.694  WARN 14 --- [https-jsse-nio-7071-exec-2] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:47:17.694  INFO 14 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@461a2d2a
2022-01-16 11:47:17.694  INFO 14 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@461a2d2a
2022-01-16 11:47:17.695  WARN 14 --- [https-jsse-nio-7071-exec-2] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:47:17.695  WARN 14 --- [https-jsse-nio-7071-exec-2] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:47:17.695  INFO 14 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@461a2d2a
2022-01-16 11:47:17.708  INFO 14 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: emergency-active, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@461a2d2a
2022-01-16 11:47:17.729  INFO 14 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@461a2d2a
2022-01-16 11:47:17.729  INFO 14 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@461a2d2a
2022-01-16 11:47:17.785  INFO 14 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@461a2d2a
2022-01-16 11:47:17.785  INFO 14 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-revoke-extra, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@461a2d2a
2022-01-16 11:47:17.793  INFO 14 --- [https-jsse-nio-7071-exec-2] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18912088733316981-51154, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=Deny}, TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:47:17.794  INFO 14 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=86dd2308-0111-4ff3-9c52-4cb7a2efe031, content=DENY, timestamp=1642333637794, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=Deny}, TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:47:17.794  INFO 14 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=162ms, Total=164ms
2022-01-16 11:47:17.812  INFO 14 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=a954b5b2-75d0-4c6d-8652-b3d37a21a30a, content=null, timestamp=1642333637806, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=53238, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=4cbbcf975445, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=b07dfbf9-a4f5-4455-8203-a2cec4d67eff, http-req-server-port=80, http-header-accept=*/*, kc-id=6cb35628-1a35-4ce0-a796-86bb2026243f, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642333637804, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQG53NxAH4AEQAAAABh5AW7dAAkNmNiMzU2MjgtMWEzNS00Y2UwLWE3OTYtODZiYjIwMjYyNDNmdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRiMDdkZmJmOS1hNGY1LTQ0NTUtODIwMy1hMmNlYzRkNjdlZmZwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJEdC1tdDI0aWkxQ3VWUnBvbnRqazZNTFA4NFVOZDJDSnVVbTNzQXpGZXVVIn0.eyJleHAiOjE2NDIzMzM5MjcsImlhdCI6MTY0MjMzMzYyNywianRpIjoiNmNiMzU2MjgtMWEzNS00Y2UwLWE3OTYtODZiYjIwMjYyNDNmIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiJiMDdkZmJmOS1hNGY1LTQ0NTUtODIwMy1hMmNlYzRkNjdlZmYiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.LfQC6pOzHJwRKWJa93ShDgM_MdHoxnk9eyFbHPoREooqpMT3SMjbXwdLkCNCA1uopGCigRpu-rVC9ccTKnQlTDgnhvQem_tEjdzsYd5uMdjz4QlUMfilGKUWG6WO3balqXcCrl-G8-mb57iZhC2hQiX9z610oFRxfoiN6aHjOPbc3b5kLm37QHObSimyN-S1yTLGW4ut7qSpExXmOpDwje3DX8jhJWOJP852tpL4ihL6bOf0qaaYNartB524T1ibMy5pfYK7ayKYeVpBgw6f4U2R7IEK9owz6IFXQoP-VTCMEWrV0gnKBWbW0G6tosI4UBcwX_OETTaxyTxc26I4cw, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642333927, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.25.0.10, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=0C81094CBFB28548ED77AFF53D2513E7, http-session-last-accessed-time=1642333637804, kc-category-name=ACCESS, kc-iat=1642333627, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:53238 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:47:17.813  INFO 14 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:47:17.814  INFO 14 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4e96f72c
2022-01-16 11:47:17.814  INFO 14 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4e96f72c
2022-01-16 11:47:17.830  INFO 14 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4e96f72c
2022-01-16 11:47:17.830  INFO 14 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4e96f72c
2022-01-16 11:47:17.881  INFO 14 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4e96f72c
2022-01-16 11:47:17.882  WARN 14 --- [https-jsse-nio-7071-exec-3] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:47:17.882  WARN 14 --- [https-jsse-nio-7071-exec-3] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:47:17.884  INFO 14 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4e96f72c
2022-01-16 11:47:17.884  INFO 14 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4e96f72c
2022-01-16 11:47:17.885  WARN 14 --- [https-jsse-nio-7071-exec-3] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:47:17.885  WARN 14 --- [https-jsse-nio-7071-exec-3] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:47:17.886  INFO 14 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4e96f72c
2022-01-16 11:47:17.896  INFO 14 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: emergency-active, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4e96f72c
2022-01-16 11:47:17.905  INFO 14 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4e96f72c
2022-01-16 11:47:17.905  INFO 14 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4e96f72c
2022-01-16 11:47:17.953  INFO 14 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4e96f72c
2022-01-16 11:47:17.954  INFO 14 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-revoke-extra, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4e96f72c
2022-01-16 11:47:17.968  INFO 14 --- [https-jsse-nio-7071-exec-3] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18912088914261731-938640, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=Deny}, TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:47:17.968  INFO 14 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=a954b5b2-75d0-4c6d-8652-b3d37a21a30a, content=DENY, timestamp=1642333637968, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=Deny}, TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:47:17.969  INFO 14 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=155ms, Total=158ms
2022-01-16 11:47:17.989  INFO 14 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=f0660150-1e2d-4997-aeb4-d94b830ebda1, content=null, timestamp=1642333637982, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=53240, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=4cbbcf975445, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=b07dfbf9-a4f5-4455-8203-a2cec4d67eff, http-req-server-port=80, http-header-accept=*/*, kc-id=6cb35628-1a35-4ce0-a796-86bb2026243f, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642333637981, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQG53NxAH4AEQAAAABh5AW7dAAkNmNiMzU2MjgtMWEzNS00Y2UwLWE3OTYtODZiYjIwMjYyNDNmdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRiMDdkZmJmOS1hNGY1LTQ0NTUtODIwMy1hMmNlYzRkNjdlZmZwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJEdC1tdDI0aWkxQ3VWUnBvbnRqazZNTFA4NFVOZDJDSnVVbTNzQXpGZXVVIn0.eyJleHAiOjE2NDIzMzM5MjcsImlhdCI6MTY0MjMzMzYyNywianRpIjoiNmNiMzU2MjgtMWEzNS00Y2UwLWE3OTYtODZiYjIwMjYyNDNmIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiJiMDdkZmJmOS1hNGY1LTQ0NTUtODIwMy1hMmNlYzRkNjdlZmYiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.LfQC6pOzHJwRKWJa93ShDgM_MdHoxnk9eyFbHPoREooqpMT3SMjbXwdLkCNCA1uopGCigRpu-rVC9ccTKnQlTDgnhvQem_tEjdzsYd5uMdjz4QlUMfilGKUWG6WO3balqXcCrl-G8-mb57iZhC2hQiX9z610oFRxfoiN6aHjOPbc3b5kLm37QHObSimyN-S1yTLGW4ut7qSpExXmOpDwje3DX8jhJWOJP852tpL4ihL6bOf0qaaYNartB524T1ibMy5pfYK7ayKYeVpBgw6f4U2R7IEK9owz6IFXQoP-VTCMEWrV0gnKBWbW0G6tosI4UBcwX_OETTaxyTxc26I4cw, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642333927, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.25.0.10, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=6C150A0CF02D8D0F629C89010CF4F1CB, http-session-last-accessed-time=1642333637981, kc-category-name=ACCESS, kc-iat=1642333627, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:53240 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:47:17.994  INFO 14 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:47:17.994  INFO 14 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6825df85
2022-01-16 11:47:17.998  INFO 14 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6825df85
2022-01-16 11:47:18.006  INFO 14 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6825df85
2022-01-16 11:47:18.007  INFO 14 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6825df85
2022-01-16 11:47:18.057  INFO 14 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6825df85
2022-01-16 11:47:18.057  WARN 14 --- [https-jsse-nio-7071-exec-4] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:47:18.057  WARN 14 --- [https-jsse-nio-7071-exec-4] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:47:18.058  INFO 14 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6825df85
2022-01-16 11:47:18.058  INFO 14 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6825df85
2022-01-16 11:47:18.058  WARN 14 --- [https-jsse-nio-7071-exec-4] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:47:18.058  WARN 14 --- [https-jsse-nio-7071-exec-4] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:47:18.058  INFO 14 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6825df85
2022-01-16 11:47:18.068  INFO 14 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: emergency-active, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6825df85
2022-01-16 11:47:18.082  INFO 14 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6825df85
2022-01-16 11:47:18.082  INFO 14 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6825df85
2022-01-16 11:47:18.133  INFO 14 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6825df85
2022-01-16 11:47:18.133  INFO 14 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-revoke-extra, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6825df85
2022-01-16 11:47:18.147  INFO 14 --- [https-jsse-nio-7071-exec-4] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18912089095224214-68057, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=Deny}, TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:47:18.147  INFO 14 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=f0660150-1e2d-4997-aeb4-d94b830ebda1, content=DENY, timestamp=1642333638147, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=Deny}, TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:47:18.148  INFO 14 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=153ms, Total=160ms
2022-01-16 11:47:18.165  INFO 14 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=6430c4cf-4929-4cc0-af18-8c6778b6ac2a, content=null, timestamp=1642333638159, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=53242, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=4cbbcf975445, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=b07dfbf9-a4f5-4455-8203-a2cec4d67eff, http-req-server-port=80, http-header-accept=*/*, kc-id=6cb35628-1a35-4ce0-a796-86bb2026243f, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642333638158, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQG53NxAH4AEQAAAABh5AW7dAAkNmNiMzU2MjgtMWEzNS00Y2UwLWE3OTYtODZiYjIwMjYyNDNmdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRiMDdkZmJmOS1hNGY1LTQ0NTUtODIwMy1hMmNlYzRkNjdlZmZwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJEdC1tdDI0aWkxQ3VWUnBvbnRqazZNTFA4NFVOZDJDSnVVbTNzQXpGZXVVIn0.eyJleHAiOjE2NDIzMzM5MjcsImlhdCI6MTY0MjMzMzYyNywianRpIjoiNmNiMzU2MjgtMWEzNS00Y2UwLWE3OTYtODZiYjIwMjYyNDNmIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiJiMDdkZmJmOS1hNGY1LTQ0NTUtODIwMy1hMmNlYzRkNjdlZmYiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.LfQC6pOzHJwRKWJa93ShDgM_MdHoxnk9eyFbHPoREooqpMT3SMjbXwdLkCNCA1uopGCigRpu-rVC9ccTKnQlTDgnhvQem_tEjdzsYd5uMdjz4QlUMfilGKUWG6WO3balqXcCrl-G8-mb57iZhC2hQiX9z610oFRxfoiN6aHjOPbc3b5kLm37QHObSimyN-S1yTLGW4ut7qSpExXmOpDwje3DX8jhJWOJP852tpL4ihL6bOf0qaaYNartB524T1ibMy5pfYK7ayKYeVpBgw6f4U2R7IEK9owz6IFXQoP-VTCMEWrV0gnKBWbW0G6tosI4UBcwX_OETTaxyTxc26I4cw, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642333927, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.25.0.10, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=9912AF57C9C5A895AC352695CEC731AF, http-session-last-accessed-time=1642333638158, kc-category-name=ACCESS, kc-iat=1642333627, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:53242 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:47:18.166  INFO 14 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:47:18.166  INFO 14 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4bf57e79
2022-01-16 11:47:18.166  INFO 14 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4bf57e79
2022-01-16 11:47:18.174  INFO 14 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4bf57e79
2022-01-16 11:47:18.174  INFO 14 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4bf57e79
2022-01-16 11:47:18.225  INFO 14 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4bf57e79
2022-01-16 11:47:18.225  WARN 14 --- [https-jsse-nio-7071-exec-5] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:47:18.226  WARN 14 --- [https-jsse-nio-7071-exec-5] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:47:18.226  INFO 14 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4bf57e79
2022-01-16 11:47:18.226  INFO 14 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4bf57e79
2022-01-16 11:47:18.226  WARN 14 --- [https-jsse-nio-7071-exec-5] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:47:18.227  WARN 14 --- [https-jsse-nio-7071-exec-5] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:47:18.227  INFO 14 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4bf57e79
2022-01-16 11:47:18.241  INFO 14 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: emergency-active, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4bf57e79
2022-01-16 11:47:18.249  INFO 14 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4bf57e79
2022-01-16 11:47:18.249  INFO 14 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4bf57e79
2022-01-16 11:47:18.301  INFO 14 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4bf57e79
2022-01-16 11:47:18.302  INFO 14 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-revoke-extra, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4bf57e79
2022-01-16 11:47:18.317  INFO 14 --- [https-jsse-nio-7071-exec-5] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18912089267252156-870368, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=Deny}, TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:47:18.317  INFO 14 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=6430c4cf-4929-4cc0-af18-8c6778b6ac2a, content=DENY, timestamp=1642333638317, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=Deny}, TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:47:18.317  INFO 14 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=151ms, Total=153ms
2022-01-16 11:47:18.332  INFO 14 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=fcc83ca6-1731-4edb-ab38-c51c31106a79, content=null, timestamp=1642333638328, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=53244, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=4cbbcf975445, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=b07dfbf9-a4f5-4455-8203-a2cec4d67eff, http-req-server-port=80, http-header-accept=*/*, kc-id=6cb35628-1a35-4ce0-a796-86bb2026243f, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642333638327, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQG53NxAH4AEQAAAABh5AW7dAAkNmNiMzU2MjgtMWEzNS00Y2UwLWE3OTYtODZiYjIwMjYyNDNmdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRiMDdkZmJmOS1hNGY1LTQ0NTUtODIwMy1hMmNlYzRkNjdlZmZwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJEdC1tdDI0aWkxQ3VWUnBvbnRqazZNTFA4NFVOZDJDSnVVbTNzQXpGZXVVIn0.eyJleHAiOjE2NDIzMzM5MjcsImlhdCI6MTY0MjMzMzYyNywianRpIjoiNmNiMzU2MjgtMWEzNS00Y2UwLWE3OTYtODZiYjIwMjYyNDNmIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiJiMDdkZmJmOS1hNGY1LTQ0NTUtODIwMy1hMmNlYzRkNjdlZmYiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.LfQC6pOzHJwRKWJa93ShDgM_MdHoxnk9eyFbHPoREooqpMT3SMjbXwdLkCNCA1uopGCigRpu-rVC9ccTKnQlTDgnhvQem_tEjdzsYd5uMdjz4QlUMfilGKUWG6WO3balqXcCrl-G8-mb57iZhC2hQiX9z610oFRxfoiN6aHjOPbc3b5kLm37QHObSimyN-S1yTLGW4ut7qSpExXmOpDwje3DX8jhJWOJP852tpL4ihL6bOf0qaaYNartB524T1ibMy5pfYK7ayKYeVpBgw6f4U2R7IEK9owz6IFXQoP-VTCMEWrV0gnKBWbW0G6tosI4UBcwX_OETTaxyTxc26I4cw, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642333927, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.25.0.10, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=C746A6A7B4CB9F927AE03CEE17373764, http-session-last-accessed-time=1642333638327, kc-category-name=ACCESS, kc-iat=1642333627, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:53244 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:47:18.333  INFO 14 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:47:18.333  INFO 14 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@14d6d947
2022-01-16 11:47:18.334  INFO 14 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@14d6d947
2022-01-16 11:47:18.343  INFO 14 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@14d6d947
2022-01-16 11:47:18.343  INFO 14 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@14d6d947
2022-01-16 11:47:18.397  INFO 14 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@14d6d947
2022-01-16 11:47:18.397  WARN 14 --- [https-jsse-nio-7071-exec-6] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:47:18.397  WARN 14 --- [https-jsse-nio-7071-exec-6] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:47:18.398  INFO 14 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@14d6d947
2022-01-16 11:47:18.398  INFO 14 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@14d6d947
2022-01-16 11:47:18.398  WARN 14 --- [https-jsse-nio-7071-exec-6] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:47:18.398  WARN 14 --- [https-jsse-nio-7071-exec-6] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:47:18.398  INFO 14 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@14d6d947
2022-01-16 11:47:18.412  INFO 14 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: emergency-active, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@14d6d947
2022-01-16 11:47:18.423  INFO 14 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@14d6d947
2022-01-16 11:47:18.423  INFO 14 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@14d6d947
2022-01-16 11:47:18.477  INFO 14 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@14d6d947
2022-01-16 11:47:18.477  INFO 14 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-revoke-extra, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@14d6d947
2022-01-16 11:47:18.492  INFO 14 --- [https-jsse-nio-7071-exec-6] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18912089434376061-726166, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=Deny}, TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:47:18.492  INFO 14 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=fcc83ca6-1731-4edb-ab38-c51c31106a79, content=DENY, timestamp=1642333638492, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=Deny}, TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:47:18.493  INFO 14 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=159ms, Total=162ms
2022-01-16 11:47:18.512  INFO 14 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=36134633-e44e-46fb-990b-ed6dc4061f22, content=null, timestamp=1642333638506, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=53246, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=4cbbcf975445, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=b07dfbf9-a4f5-4455-8203-a2cec4d67eff, http-req-server-port=80, http-header-accept=*/*, kc-id=6cb35628-1a35-4ce0-a796-86bb2026243f, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642333638504, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQG53NxAH4AEQAAAABh5AW7dAAkNmNiMzU2MjgtMWEzNS00Y2UwLWE3OTYtODZiYjIwMjYyNDNmdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRiMDdkZmJmOS1hNGY1LTQ0NTUtODIwMy1hMmNlYzRkNjdlZmZwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJEdC1tdDI0aWkxQ3VWUnBvbnRqazZNTFA4NFVOZDJDSnVVbTNzQXpGZXVVIn0.eyJleHAiOjE2NDIzMzM5MjcsImlhdCI6MTY0MjMzMzYyNywianRpIjoiNmNiMzU2MjgtMWEzNS00Y2UwLWE3OTYtODZiYjIwMjYyNDNmIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiJiMDdkZmJmOS1hNGY1LTQ0NTUtODIwMy1hMmNlYzRkNjdlZmYiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.LfQC6pOzHJwRKWJa93ShDgM_MdHoxnk9eyFbHPoREooqpMT3SMjbXwdLkCNCA1uopGCigRpu-rVC9ccTKnQlTDgnhvQem_tEjdzsYd5uMdjz4QlUMfilGKUWG6WO3balqXcCrl-G8-mb57iZhC2hQiX9z610oFRxfoiN6aHjOPbc3b5kLm37QHObSimyN-S1yTLGW4ut7qSpExXmOpDwje3DX8jhJWOJP852tpL4ihL6bOf0qaaYNartB524T1ibMy5pfYK7ayKYeVpBgw6f4U2R7IEK9owz6IFXQoP-VTCMEWrV0gnKBWbW0G6tosI4UBcwX_OETTaxyTxc26I4cw, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642333927, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.25.0.10, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=4F14129F48F48EE8517A7AC4CF3A95FA, http-session-last-accessed-time=1642333638504, kc-category-name=ACCESS, kc-iat=1642333627, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:53246 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:47:18.512  INFO 14 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:47:18.513  INFO 14 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1edbb0a6
2022-01-16 11:47:18.513  INFO 14 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1edbb0a6
2022-01-16 11:47:18.524  INFO 14 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1edbb0a6
2022-01-16 11:47:18.524  INFO 14 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1edbb0a6
2022-01-16 11:47:18.577  INFO 14 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1edbb0a6
2022-01-16 11:47:18.577  WARN 14 --- [https-jsse-nio-7071-exec-7] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:47:18.577  WARN 14 --- [https-jsse-nio-7071-exec-7] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:47:18.577  INFO 14 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1edbb0a6
2022-01-16 11:47:18.578  INFO 14 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1edbb0a6
2022-01-16 11:47:18.578  WARN 14 --- [https-jsse-nio-7071-exec-7] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:47:18.578  WARN 14 --- [https-jsse-nio-7071-exec-7] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:47:18.578  INFO 14 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1edbb0a6
2022-01-16 11:47:18.588  INFO 14 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: emergency-active, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1edbb0a6
2022-01-16 11:47:18.598  INFO 14 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1edbb0a6
2022-01-16 11:47:18.599  INFO 14 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1edbb0a6
2022-01-16 11:47:18.653  INFO 14 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1edbb0a6
2022-01-16 11:47:18.653  INFO 14 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-revoke-extra, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1edbb0a6
2022-01-16 11:47:18.665  INFO 14 --- [https-jsse-nio-7071-exec-7] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18912089613488095-581630, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=Deny}, TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:47:18.666  INFO 14 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=36134633-e44e-46fb-990b-ed6dc4061f22, content=DENY, timestamp=1642333638666, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=Deny}, TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:47:18.667  INFO 14 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=154ms, Total=156ms
2022-01-16 11:47:18.686  INFO 14 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=eda5b2c7-dd11-42f4-a96e-faee1d6e6e82, content=null, timestamp=1642333638681, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=53248, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=4cbbcf975445, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=b07dfbf9-a4f5-4455-8203-a2cec4d67eff, http-req-server-port=80, http-header-accept=*/*, kc-id=6cb35628-1a35-4ce0-a796-86bb2026243f, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642333638679, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQG53NxAH4AEQAAAABh5AW7dAAkNmNiMzU2MjgtMWEzNS00Y2UwLWE3OTYtODZiYjIwMjYyNDNmdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRiMDdkZmJmOS1hNGY1LTQ0NTUtODIwMy1hMmNlYzRkNjdlZmZwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJEdC1tdDI0aWkxQ3VWUnBvbnRqazZNTFA4NFVOZDJDSnVVbTNzQXpGZXVVIn0.eyJleHAiOjE2NDIzMzM5MjcsImlhdCI6MTY0MjMzMzYyNywianRpIjoiNmNiMzU2MjgtMWEzNS00Y2UwLWE3OTYtODZiYjIwMjYyNDNmIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiJiMDdkZmJmOS1hNGY1LTQ0NTUtODIwMy1hMmNlYzRkNjdlZmYiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.LfQC6pOzHJwRKWJa93ShDgM_MdHoxnk9eyFbHPoREooqpMT3SMjbXwdLkCNCA1uopGCigRpu-rVC9ccTKnQlTDgnhvQem_tEjdzsYd5uMdjz4QlUMfilGKUWG6WO3balqXcCrl-G8-mb57iZhC2hQiX9z610oFRxfoiN6aHjOPbc3b5kLm37QHObSimyN-S1yTLGW4ut7qSpExXmOpDwje3DX8jhJWOJP852tpL4ihL6bOf0qaaYNartB524T1ibMy5pfYK7ayKYeVpBgw6f4U2R7IEK9owz6IFXQoP-VTCMEWrV0gnKBWbW0G6tosI4UBcwX_OETTaxyTxc26I4cw, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642333927, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.25.0.10, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=0524D4F605CA36CCB8357668992F897A, http-session-last-accessed-time=1642333638679, kc-category-name=ACCESS, kc-iat=1642333627, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:53248 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:47:18.687  INFO 14 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:47:18.688  INFO 14 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@20b54947
2022-01-16 11:47:18.688  INFO 14 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@20b54947
2022-01-16 11:47:18.698  INFO 14 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@20b54947
2022-01-16 11:47:18.698  INFO 14 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@20b54947
2022-01-16 11:47:18.750  INFO 14 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@20b54947
2022-01-16 11:47:18.750  WARN 14 --- [https-jsse-nio-7071-exec-8] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:47:18.751  WARN 14 --- [https-jsse-nio-7071-exec-8] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:47:18.751  INFO 14 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@20b54947
2022-01-16 11:47:18.752  INFO 14 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@20b54947
2022-01-16 11:47:18.752  WARN 14 --- [https-jsse-nio-7071-exec-8] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:47:18.752  WARN 14 --- [https-jsse-nio-7071-exec-8] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:47:18.753  INFO 14 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@20b54947
2022-01-16 11:47:18.769  INFO 14 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: emergency-active, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@20b54947
2022-01-16 11:47:18.777  INFO 14 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@20b54947
2022-01-16 11:47:18.777  INFO 14 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@20b54947
2022-01-16 11:47:18.830  INFO 14 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@20b54947
2022-01-16 11:47:18.831  INFO 14 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-revoke-extra, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@20b54947
2022-01-16 11:47:18.854  INFO 14 --- [https-jsse-nio-7071-exec-8] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18912089788875822-154493, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=Deny}, TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:47:18.854  INFO 14 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=eda5b2c7-dd11-42f4-a96e-faee1d6e6e82, content=DENY, timestamp=1642333638854, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=Deny}, TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:47:18.855  INFO 14 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=167ms, Total=170ms
2022-01-16 11:47:18.875  INFO 14 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=148c5c2b-a171-4cc4-8c64-7ed83004b5c2, content=null, timestamp=1642333638868, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=53250, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=4cbbcf975445, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=b07dfbf9-a4f5-4455-8203-a2cec4d67eff, http-req-server-port=80, http-header-accept=*/*, kc-id=6cb35628-1a35-4ce0-a796-86bb2026243f, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642333638867, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQG53NxAH4AEQAAAABh5AW7dAAkNmNiMzU2MjgtMWEzNS00Y2UwLWE3OTYtODZiYjIwMjYyNDNmdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRiMDdkZmJmOS1hNGY1LTQ0NTUtODIwMy1hMmNlYzRkNjdlZmZwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJEdC1tdDI0aWkxQ3VWUnBvbnRqazZNTFA4NFVOZDJDSnVVbTNzQXpGZXVVIn0.eyJleHAiOjE2NDIzMzM5MjcsImlhdCI6MTY0MjMzMzYyNywianRpIjoiNmNiMzU2MjgtMWEzNS00Y2UwLWE3OTYtODZiYjIwMjYyNDNmIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiJiMDdkZmJmOS1hNGY1LTQ0NTUtODIwMy1hMmNlYzRkNjdlZmYiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.LfQC6pOzHJwRKWJa93ShDgM_MdHoxnk9eyFbHPoREooqpMT3SMjbXwdLkCNCA1uopGCigRpu-rVC9ccTKnQlTDgnhvQem_tEjdzsYd5uMdjz4QlUMfilGKUWG6WO3balqXcCrl-G8-mb57iZhC2hQiX9z610oFRxfoiN6aHjOPbc3b5kLm37QHObSimyN-S1yTLGW4ut7qSpExXmOpDwje3DX8jhJWOJP852tpL4ihL6bOf0qaaYNartB524T1ibMy5pfYK7ayKYeVpBgw6f4U2R7IEK9owz6IFXQoP-VTCMEWrV0gnKBWbW0G6tosI4UBcwX_OETTaxyTxc26I4cw, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642333927, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.25.0.10, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=467F4A7E9BFAADC677B14ACE8769BC60, http-session-last-accessed-time=1642333638867, kc-category-name=ACCESS, kc-iat=1642333627, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:53250 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:47:18.875  INFO 14 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:47:18.876  INFO 14 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2066ad75
2022-01-16 11:47:18.876  INFO 14 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2066ad75
2022-01-16 11:47:18.894  INFO 14 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2066ad75
2022-01-16 11:47:18.894  INFO 14 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2066ad75
2022-01-16 11:47:18.961  INFO 14 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2066ad75
2022-01-16 11:47:18.962  WARN 14 --- [https-jsse-nio-7071-exec-9] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:47:18.962  WARN 14 --- [https-jsse-nio-7071-exec-9] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:47:18.962  INFO 14 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2066ad75
2022-01-16 11:47:18.963  INFO 14 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2066ad75
2022-01-16 11:47:18.963  WARN 14 --- [https-jsse-nio-7071-exec-9] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:47:18.963  WARN 14 --- [https-jsse-nio-7071-exec-9] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:47:18.963  INFO 14 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2066ad75
2022-01-16 11:47:18.978  INFO 14 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: emergency-active, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2066ad75
2022-01-16 11:47:18.987  INFO 14 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2066ad75
2022-01-16 11:47:18.988  INFO 14 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2066ad75
2022-01-16 11:47:19.049  INFO 14 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2066ad75
2022-01-16 11:47:19.049  INFO 14 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-revoke-extra, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2066ad75
2022-01-16 11:47:19.065  INFO 14 --- [https-jsse-nio-7071-exec-9] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18912089976535916-228309, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=Deny}, TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:47:19.065  INFO 14 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=148c5c2b-a171-4cc4-8c64-7ed83004b5c2, content=DENY, timestamp=1642333639065, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=Deny}, TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:47:19.066  INFO 14 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=190ms, Total=192ms
2022-01-16 11:47:19.089  INFO 14 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=90bf8e90-06ff-4a4f-b497-33b12ee17041, content=null, timestamp=1642333639083, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=53252, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=4cbbcf975445, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=b07dfbf9-a4f5-4455-8203-a2cec4d67eff, http-req-server-port=80, http-header-accept=*/*, kc-id=6cb35628-1a35-4ce0-a796-86bb2026243f, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642333639080, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQG53NxAH4AEQAAAABh5AW7dAAkNmNiMzU2MjgtMWEzNS00Y2UwLWE3OTYtODZiYjIwMjYyNDNmdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRiMDdkZmJmOS1hNGY1LTQ0NTUtODIwMy1hMmNlYzRkNjdlZmZwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJEdC1tdDI0aWkxQ3VWUnBvbnRqazZNTFA4NFVOZDJDSnVVbTNzQXpGZXVVIn0.eyJleHAiOjE2NDIzMzM5MjcsImlhdCI6MTY0MjMzMzYyNywianRpIjoiNmNiMzU2MjgtMWEzNS00Y2UwLWE3OTYtODZiYjIwMjYyNDNmIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiJiMDdkZmJmOS1hNGY1LTQ0NTUtODIwMy1hMmNlYzRkNjdlZmYiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.LfQC6pOzHJwRKWJa93ShDgM_MdHoxnk9eyFbHPoREooqpMT3SMjbXwdLkCNCA1uopGCigRpu-rVC9ccTKnQlTDgnhvQem_tEjdzsYd5uMdjz4QlUMfilGKUWG6WO3balqXcCrl-G8-mb57iZhC2hQiX9z610oFRxfoiN6aHjOPbc3b5kLm37QHObSimyN-S1yTLGW4ut7qSpExXmOpDwje3DX8jhJWOJP852tpL4ihL6bOf0qaaYNartB524T1ibMy5pfYK7ayKYeVpBgw6f4U2R7IEK9owz6IFXQoP-VTCMEWrV0gnKBWbW0G6tosI4UBcwX_OETTaxyTxc26I4cw, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642333927, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.25.0.10, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=0C3C77436E8D7C2602F7B8DCB3C04115, http-session-last-accessed-time=1642333639080, kc-category-name=ACCESS, kc-iat=1642333627, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:53252 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:47:19.089  INFO 14 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:47:19.091  INFO 14 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7437e610
2022-01-16 11:47:19.091  INFO 14 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7437e610
2022-01-16 11:47:19.102  INFO 14 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7437e610
2022-01-16 11:47:19.103  INFO 14 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7437e610
2022-01-16 11:47:19.170  INFO 14 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7437e610
2022-01-16 11:47:19.170  WARN 14 --- [https-jsse-nio-7071-exec-10] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:47:19.170  WARN 14 --- [https-jsse-nio-7071-exec-10] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:47:19.171  INFO 14 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7437e610
2022-01-16 11:47:19.171  INFO 14 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7437e610
2022-01-16 11:47:19.172  WARN 14 --- [https-jsse-nio-7071-exec-10] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:47:19.172  WARN 14 --- [https-jsse-nio-7071-exec-10] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:47:19.172  INFO 14 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7437e610
2022-01-16 11:47:19.184  INFO 14 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: emergency-active, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7437e610
2022-01-16 11:47:19.193  INFO 14 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7437e610
2022-01-16 11:47:19.193  INFO 14 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7437e610
2022-01-16 11:47:19.246  INFO 14 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7437e610
2022-01-16 11:47:19.246  INFO 14 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-revoke-extra, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7437e610
2022-01-16 11:47:19.262  INFO 14 --- [https-jsse-nio-7071-exec-10] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18912090190776589-975949, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=Deny}, TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:47:19.262  INFO 14 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=90bf8e90-06ff-4a4f-b497-33b12ee17041, content=DENY, timestamp=1642333639262, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=Deny}, TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:47:19.263  INFO 14 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=173ms, Total=175ms
2022-01-16 11:47:19.283  INFO 14 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=f82925b9-c014-4b11-bd95-409f6329b958, content=null, timestamp=1642333639277, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=53254, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=4cbbcf975445, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=b07dfbf9-a4f5-4455-8203-a2cec4d67eff, http-req-server-port=80, http-header-accept=*/*, kc-id=6cb35628-1a35-4ce0-a796-86bb2026243f, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642333639276, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQG53NxAH4AEQAAAABh5AW7dAAkNmNiMzU2MjgtMWEzNS00Y2UwLWE3OTYtODZiYjIwMjYyNDNmdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRiMDdkZmJmOS1hNGY1LTQ0NTUtODIwMy1hMmNlYzRkNjdlZmZwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJEdC1tdDI0aWkxQ3VWUnBvbnRqazZNTFA4NFVOZDJDSnVVbTNzQXpGZXVVIn0.eyJleHAiOjE2NDIzMzM5MjcsImlhdCI6MTY0MjMzMzYyNywianRpIjoiNmNiMzU2MjgtMWEzNS00Y2UwLWE3OTYtODZiYjIwMjYyNDNmIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiJiMDdkZmJmOS1hNGY1LTQ0NTUtODIwMy1hMmNlYzRkNjdlZmYiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.LfQC6pOzHJwRKWJa93ShDgM_MdHoxnk9eyFbHPoREooqpMT3SMjbXwdLkCNCA1uopGCigRpu-rVC9ccTKnQlTDgnhvQem_tEjdzsYd5uMdjz4QlUMfilGKUWG6WO3balqXcCrl-G8-mb57iZhC2hQiX9z610oFRxfoiN6aHjOPbc3b5kLm37QHObSimyN-S1yTLGW4ut7qSpExXmOpDwje3DX8jhJWOJP852tpL4ihL6bOf0qaaYNartB524T1ibMy5pfYK7ayKYeVpBgw6f4U2R7IEK9owz6IFXQoP-VTCMEWrV0gnKBWbW0G6tosI4UBcwX_OETTaxyTxc26I4cw, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642333927, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.25.0.10, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=DC8435CEE601B9A99C39A1633519D63C, http-session-last-accessed-time=1642333639276, kc-category-name=ACCESS, kc-iat=1642333627, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:53254 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:47:19.283  INFO 14 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:47:19.284  INFO 14 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3b1e6064
2022-01-16 11:47:19.285  INFO 14 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3b1e6064
2022-01-16 11:47:19.297  INFO 14 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3b1e6064
2022-01-16 11:47:19.297  INFO 14 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3b1e6064
2022-01-16 11:47:19.350  INFO 14 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3b1e6064
2022-01-16 11:47:19.351  WARN 14 --- [https-jsse-nio-7071-exec-1] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:47:19.351  WARN 14 --- [https-jsse-nio-7071-exec-1] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:47:19.351  INFO 14 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3b1e6064
2022-01-16 11:47:19.352  INFO 14 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3b1e6064
2022-01-16 11:47:19.352  WARN 14 --- [https-jsse-nio-7071-exec-1] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:47:19.353  WARN 14 --- [https-jsse-nio-7071-exec-1] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:47:19.353  INFO 14 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3b1e6064
2022-01-16 11:47:19.364  INFO 14 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: emergency-active, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3b1e6064
2022-01-16 11:47:19.372  INFO 14 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3b1e6064
2022-01-16 11:47:19.373  INFO 14 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3b1e6064
2022-01-16 11:47:19.422  INFO 14 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3b1e6064
2022-01-16 11:47:19.422  INFO 14 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-revoke-extra, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3b1e6064
2022-01-16 11:47:19.435  INFO 14 --- [https-jsse-nio-7071-exec-1] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18912090385018010-92384, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=Deny}, TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:47:19.436  INFO 14 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=f82925b9-c014-4b11-bd95-409f6329b958, content=DENY, timestamp=1642333639436, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=Deny}, TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:47:19.436  INFO 14 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=153ms, Total=155ms
2022-01-16 11:47:19.453  INFO 14 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=7e552f43-8cab-4452-b4b2-5e021c11a208, content=null, timestamp=1642333639448, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=53256, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=4cbbcf975445, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=b07dfbf9-a4f5-4455-8203-a2cec4d67eff, http-req-server-port=80, http-header-accept=*/*, kc-id=6cb35628-1a35-4ce0-a796-86bb2026243f, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642333639447, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQG53NxAH4AEQAAAABh5AW7dAAkNmNiMzU2MjgtMWEzNS00Y2UwLWE3OTYtODZiYjIwMjYyNDNmdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRiMDdkZmJmOS1hNGY1LTQ0NTUtODIwMy1hMmNlYzRkNjdlZmZwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJEdC1tdDI0aWkxQ3VWUnBvbnRqazZNTFA4NFVOZDJDSnVVbTNzQXpGZXVVIn0.eyJleHAiOjE2NDIzMzM5MjcsImlhdCI6MTY0MjMzMzYyNywianRpIjoiNmNiMzU2MjgtMWEzNS00Y2UwLWE3OTYtODZiYjIwMjYyNDNmIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiJiMDdkZmJmOS1hNGY1LTQ0NTUtODIwMy1hMmNlYzRkNjdlZmYiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.LfQC6pOzHJwRKWJa93ShDgM_MdHoxnk9eyFbHPoREooqpMT3SMjbXwdLkCNCA1uopGCigRpu-rVC9ccTKnQlTDgnhvQem_tEjdzsYd5uMdjz4QlUMfilGKUWG6WO3balqXcCrl-G8-mb57iZhC2hQiX9z610oFRxfoiN6aHjOPbc3b5kLm37QHObSimyN-S1yTLGW4ut7qSpExXmOpDwje3DX8jhJWOJP852tpL4ihL6bOf0qaaYNartB524T1ibMy5pfYK7ayKYeVpBgw6f4U2R7IEK9owz6IFXQoP-VTCMEWrV0gnKBWbW0G6tosI4UBcwX_OETTaxyTxc26I4cw, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642333927, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.25.0.10, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=70053FCF4B26E489D3FDFA135437CFAB, http-session-last-accessed-time=1642333639447, kc-category-name=ACCESS, kc-iat=1642333627, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:53256 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:47:19.453  INFO 14 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:47:19.454  INFO 14 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2af2de50
2022-01-16 11:47:19.455  INFO 14 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2af2de50
2022-01-16 11:47:19.466  INFO 14 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2af2de50
2022-01-16 11:47:19.466  INFO 14 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2af2de50
2022-01-16 11:47:19.522  INFO 14 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2af2de50
2022-01-16 11:47:19.522  WARN 14 --- [https-jsse-nio-7071-exec-2] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:47:19.522  WARN 14 --- [https-jsse-nio-7071-exec-2] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:47:19.523  INFO 14 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2af2de50
2022-01-16 11:47:19.523  INFO 14 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2af2de50
2022-01-16 11:47:19.524  WARN 14 --- [https-jsse-nio-7071-exec-2] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:47:19.524  WARN 14 --- [https-jsse-nio-7071-exec-2] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:47:19.524  INFO 14 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2af2de50
2022-01-16 11:47:19.537  INFO 14 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: emergency-active, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2af2de50
2022-01-16 11:47:19.546  INFO 14 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2af2de50
2022-01-16 11:47:19.546  INFO 14 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2af2de50
2022-01-16 11:47:19.598  INFO 14 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2af2de50
2022-01-16 11:47:19.598  INFO 14 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-revoke-extra, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2af2de50
2022-01-16 11:47:19.611  INFO 14 --- [https-jsse-nio-7071-exec-2] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18912090555065812-841391, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=Deny}, TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:47:19.612  INFO 14 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=7e552f43-8cab-4452-b4b2-5e021c11a208, content=DENY, timestamp=1642333639612, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=Deny}, TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:47:19.612  INFO 14 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=158ms, Total=160ms
2022-01-16 11:47:19.631  INFO 14 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=37925fb9-3379-45b5-90ab-39c915a01c7a, content=null, timestamp=1642333639624, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=53258, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=4cbbcf975445, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=b07dfbf9-a4f5-4455-8203-a2cec4d67eff, http-req-server-port=80, http-header-accept=*/*, kc-id=6cb35628-1a35-4ce0-a796-86bb2026243f, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642333639623, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQG53NxAH4AEQAAAABh5AW7dAAkNmNiMzU2MjgtMWEzNS00Y2UwLWE3OTYtODZiYjIwMjYyNDNmdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRiMDdkZmJmOS1hNGY1LTQ0NTUtODIwMy1hMmNlYzRkNjdlZmZwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJEdC1tdDI0aWkxQ3VWUnBvbnRqazZNTFA4NFVOZDJDSnVVbTNzQXpGZXVVIn0.eyJleHAiOjE2NDIzMzM5MjcsImlhdCI6MTY0MjMzMzYyNywianRpIjoiNmNiMzU2MjgtMWEzNS00Y2UwLWE3OTYtODZiYjIwMjYyNDNmIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiJiMDdkZmJmOS1hNGY1LTQ0NTUtODIwMy1hMmNlYzRkNjdlZmYiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.LfQC6pOzHJwRKWJa93ShDgM_MdHoxnk9eyFbHPoREooqpMT3SMjbXwdLkCNCA1uopGCigRpu-rVC9ccTKnQlTDgnhvQem_tEjdzsYd5uMdjz4QlUMfilGKUWG6WO3balqXcCrl-G8-mb57iZhC2hQiX9z610oFRxfoiN6aHjOPbc3b5kLm37QHObSimyN-S1yTLGW4ut7qSpExXmOpDwje3DX8jhJWOJP852tpL4ihL6bOf0qaaYNartB524T1ibMy5pfYK7ayKYeVpBgw6f4U2R7IEK9owz6IFXQoP-VTCMEWrV0gnKBWbW0G6tosI4UBcwX_OETTaxyTxc26I4cw, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642333927, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.25.0.10, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=B057499B867618845C2E2A39F53F759D, http-session-last-accessed-time=1642333639623, kc-category-name=ACCESS, kc-iat=1642333627, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:53258 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:47:19.633  INFO 14 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:47:19.635  INFO 14 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3f541019
2022-01-16 11:47:19.636  INFO 14 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3f541019
2022-01-16 11:47:19.651  INFO 14 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3f541019
2022-01-16 11:47:19.652  INFO 14 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3f541019
2022-01-16 11:47:19.701  INFO 14 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3f541019
2022-01-16 11:47:19.702  WARN 14 --- [https-jsse-nio-7071-exec-3] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:47:19.703  WARN 14 --- [https-jsse-nio-7071-exec-3] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:47:19.703  INFO 14 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3f541019
2022-01-16 11:47:19.704  INFO 14 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3f541019
2022-01-16 11:47:19.704  WARN 14 --- [https-jsse-nio-7071-exec-3] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:47:19.714  WARN 14 --- [https-jsse-nio-7071-exec-3] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:47:19.714  INFO 14 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3f541019
2022-01-16 11:47:19.726  INFO 14 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: emergency-active, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3f541019
2022-01-16 11:47:19.735  INFO 14 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3f541019
2022-01-16 11:47:19.736  INFO 14 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3f541019
2022-01-16 11:47:19.785  INFO 14 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3f541019
2022-01-16 11:47:19.786  INFO 14 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-revoke-extra, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3f541019
2022-01-16 11:47:19.803  INFO 14 --- [https-jsse-nio-7071-exec-3] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18912090734623624-733791, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=Deny}, TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:47:19.804  INFO 14 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=37925fb9-3379-45b5-90ab-39c915a01c7a, content=DENY, timestamp=1642333639804, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=Deny}, TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:47:19.805  INFO 14 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=171ms, Total=176ms
2022-01-16 11:47:19.826  INFO 14 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=cb379caf-8f7e-4fb8-9727-07f459b60819, content=null, timestamp=1642333639818, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=53260, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=4cbbcf975445, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=b07dfbf9-a4f5-4455-8203-a2cec4d67eff, http-req-server-port=80, http-header-accept=*/*, kc-id=6cb35628-1a35-4ce0-a796-86bb2026243f, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642333639817, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQG53NxAH4AEQAAAABh5AW7dAAkNmNiMzU2MjgtMWEzNS00Y2UwLWE3OTYtODZiYjIwMjYyNDNmdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRiMDdkZmJmOS1hNGY1LTQ0NTUtODIwMy1hMmNlYzRkNjdlZmZwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJEdC1tdDI0aWkxQ3VWUnBvbnRqazZNTFA4NFVOZDJDSnVVbTNzQXpGZXVVIn0.eyJleHAiOjE2NDIzMzM5MjcsImlhdCI6MTY0MjMzMzYyNywianRpIjoiNmNiMzU2MjgtMWEzNS00Y2UwLWE3OTYtODZiYjIwMjYyNDNmIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiJiMDdkZmJmOS1hNGY1LTQ0NTUtODIwMy1hMmNlYzRkNjdlZmYiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.LfQC6pOzHJwRKWJa93ShDgM_MdHoxnk9eyFbHPoREooqpMT3SMjbXwdLkCNCA1uopGCigRpu-rVC9ccTKnQlTDgnhvQem_tEjdzsYd5uMdjz4QlUMfilGKUWG6WO3balqXcCrl-G8-mb57iZhC2hQiX9z610oFRxfoiN6aHjOPbc3b5kLm37QHObSimyN-S1yTLGW4ut7qSpExXmOpDwje3DX8jhJWOJP852tpL4ihL6bOf0qaaYNartB524T1ibMy5pfYK7ayKYeVpBgw6f4U2R7IEK9owz6IFXQoP-VTCMEWrV0gnKBWbW0G6tosI4UBcwX_OETTaxyTxc26I4cw, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642333927, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.25.0.10, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=6FE72CB6C2FE9A46C0B32C23C6CD2E58, http-session-last-accessed-time=1642333639817, kc-category-name=ACCESS, kc-iat=1642333627, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:53260 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:47:19.826  INFO 14 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:47:19.827  INFO 14 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@647ad89b
2022-01-16 11:47:19.828  INFO 14 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@647ad89b
2022-01-16 11:47:19.841  INFO 14 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@647ad89b
2022-01-16 11:47:19.841  INFO 14 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@647ad89b
2022-01-16 11:47:19.901  INFO 14 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@647ad89b
2022-01-16 11:47:19.901  WARN 14 --- [https-jsse-nio-7071-exec-4] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:47:19.902  WARN 14 --- [https-jsse-nio-7071-exec-4] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:47:19.902  INFO 14 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@647ad89b
2022-01-16 11:47:19.902  INFO 14 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@647ad89b
2022-01-16 11:47:19.902  WARN 14 --- [https-jsse-nio-7071-exec-4] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:47:19.902  WARN 14 --- [https-jsse-nio-7071-exec-4] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:47:19.903  INFO 14 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@647ad89b
2022-01-16 11:47:19.910  INFO 14 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: emergency-active, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@647ad89b
2022-01-16 11:47:19.918  INFO 14 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@647ad89b
2022-01-16 11:47:19.919  INFO 14 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@647ad89b
2022-01-16 11:47:19.969  INFO 14 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@647ad89b
2022-01-16 11:47:19.970  INFO 14 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-revoke-extra, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@647ad89b
2022-01-16 11:47:19.985  INFO 14 --- [https-jsse-nio-7071-exec-4] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18912090927973323-711807, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=Deny}, TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:47:19.986  INFO 14 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=cb379caf-8f7e-4fb8-9727-07f459b60819, content=DENY, timestamp=1642333639986, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=Deny}, TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:47:19.986  INFO 14 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=160ms, Total=163ms
2022-01-16 11:47:20.003  INFO 14 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=0e44aeaf-91af-421f-8290-d7eab72170fa, content=null, timestamp=1642333639997, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=53262, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=4cbbcf975445, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=b07dfbf9-a4f5-4455-8203-a2cec4d67eff, http-req-server-port=80, http-header-accept=*/*, kc-id=6cb35628-1a35-4ce0-a796-86bb2026243f, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642333639996, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQG53NxAH4AEQAAAABh5AW7dAAkNmNiMzU2MjgtMWEzNS00Y2UwLWE3OTYtODZiYjIwMjYyNDNmdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRiMDdkZmJmOS1hNGY1LTQ0NTUtODIwMy1hMmNlYzRkNjdlZmZwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJEdC1tdDI0aWkxQ3VWUnBvbnRqazZNTFA4NFVOZDJDSnVVbTNzQXpGZXVVIn0.eyJleHAiOjE2NDIzMzM5MjcsImlhdCI6MTY0MjMzMzYyNywianRpIjoiNmNiMzU2MjgtMWEzNS00Y2UwLWE3OTYtODZiYjIwMjYyNDNmIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiJiMDdkZmJmOS1hNGY1LTQ0NTUtODIwMy1hMmNlYzRkNjdlZmYiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.LfQC6pOzHJwRKWJa93ShDgM_MdHoxnk9eyFbHPoREooqpMT3SMjbXwdLkCNCA1uopGCigRpu-rVC9ccTKnQlTDgnhvQem_tEjdzsYd5uMdjz4QlUMfilGKUWG6WO3balqXcCrl-G8-mb57iZhC2hQiX9z610oFRxfoiN6aHjOPbc3b5kLm37QHObSimyN-S1yTLGW4ut7qSpExXmOpDwje3DX8jhJWOJP852tpL4ihL6bOf0qaaYNartB524T1ibMy5pfYK7ayKYeVpBgw6f4U2R7IEK9owz6IFXQoP-VTCMEWrV0gnKBWbW0G6tosI4UBcwX_OETTaxyTxc26I4cw, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642333927, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.25.0.10, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=037F013788C44F640103B1740BF39F0F, http-session-last-accessed-time=1642333639996, kc-category-name=ACCESS, kc-iat=1642333627, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:53262 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:47:20.004  INFO 14 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:47:20.004  INFO 14 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5cc99f58
2022-01-16 11:47:20.004  INFO 14 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5cc99f58
2022-01-16 11:47:20.013  INFO 14 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5cc99f58
2022-01-16 11:47:20.013  INFO 14 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5cc99f58
2022-01-16 11:47:20.061  INFO 14 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5cc99f58
2022-01-16 11:47:20.061  WARN 14 --- [https-jsse-nio-7071-exec-5] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:47:20.061  WARN 14 --- [https-jsse-nio-7071-exec-5] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:47:20.062  INFO 14 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5cc99f58
2022-01-16 11:47:20.062  INFO 14 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5cc99f58
2022-01-16 11:47:20.062  WARN 14 --- [https-jsse-nio-7071-exec-5] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:47:20.062  WARN 14 --- [https-jsse-nio-7071-exec-5] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:47:20.062  INFO 14 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5cc99f58
2022-01-16 11:47:20.074  INFO 14 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: emergency-active, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5cc99f58
2022-01-16 11:47:20.081  INFO 14 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5cc99f58
2022-01-16 11:47:20.082  INFO 14 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5cc99f58
2022-01-16 11:47:20.130  INFO 14 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5cc99f58
2022-01-16 11:47:20.130  INFO 14 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-revoke-extra, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5cc99f58
2022-01-16 11:47:20.142  INFO 14 --- [https-jsse-nio-7071-exec-5] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18912091105058825-154258, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=Deny}, TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:47:20.142  INFO 14 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=0e44aeaf-91af-421f-8290-d7eab72170fa, content=DENY, timestamp=1642333640142, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=Deny}, TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:47:20.142  INFO 14 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=138ms, Total=140ms
2022-01-16 11:47:20.158  INFO 14 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=e8234ba9-2237-41f5-91ec-fb5467a6c45d, content=null, timestamp=1642333640153, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=53264, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=4cbbcf975445, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=b07dfbf9-a4f5-4455-8203-a2cec4d67eff, http-req-server-port=80, http-header-accept=*/*, kc-id=6cb35628-1a35-4ce0-a796-86bb2026243f, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642333640152, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQG53NxAH4AEQAAAABh5AW7dAAkNmNiMzU2MjgtMWEzNS00Y2UwLWE3OTYtODZiYjIwMjYyNDNmdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRiMDdkZmJmOS1hNGY1LTQ0NTUtODIwMy1hMmNlYzRkNjdlZmZwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJEdC1tdDI0aWkxQ3VWUnBvbnRqazZNTFA4NFVOZDJDSnVVbTNzQXpGZXVVIn0.eyJleHAiOjE2NDIzMzM5MjcsImlhdCI6MTY0MjMzMzYyNywianRpIjoiNmNiMzU2MjgtMWEzNS00Y2UwLWE3OTYtODZiYjIwMjYyNDNmIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiJiMDdkZmJmOS1hNGY1LTQ0NTUtODIwMy1hMmNlYzRkNjdlZmYiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.LfQC6pOzHJwRKWJa93ShDgM_MdHoxnk9eyFbHPoREooqpMT3SMjbXwdLkCNCA1uopGCigRpu-rVC9ccTKnQlTDgnhvQem_tEjdzsYd5uMdjz4QlUMfilGKUWG6WO3balqXcCrl-G8-mb57iZhC2hQiX9z610oFRxfoiN6aHjOPbc3b5kLm37QHObSimyN-S1yTLGW4ut7qSpExXmOpDwje3DX8jhJWOJP852tpL4ihL6bOf0qaaYNartB524T1ibMy5pfYK7ayKYeVpBgw6f4U2R7IEK9owz6IFXQoP-VTCMEWrV0gnKBWbW0G6tosI4UBcwX_OETTaxyTxc26I4cw, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642333927, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.25.0.10, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=A16AC7146DCDAA84B4184A9E43D47C58, http-session-last-accessed-time=1642333640152, kc-category-name=ACCESS, kc-iat=1642333627, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:53264 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:47:20.158  INFO 14 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:47:20.159  INFO 14 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@44c20b51
2022-01-16 11:47:20.159  INFO 14 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@44c20b51
2022-01-16 11:47:20.168  INFO 14 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@44c20b51
2022-01-16 11:47:20.170  INFO 14 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@44c20b51
2022-01-16 11:47:20.222  INFO 14 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@44c20b51
2022-01-16 11:47:20.222  WARN 14 --- [https-jsse-nio-7071-exec-6] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:47:20.222  WARN 14 --- [https-jsse-nio-7071-exec-6] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:47:20.223  INFO 14 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@44c20b51
2022-01-16 11:47:20.223  INFO 14 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@44c20b51
2022-01-16 11:47:20.223  WARN 14 --- [https-jsse-nio-7071-exec-6] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:47:20.223  WARN 14 --- [https-jsse-nio-7071-exec-6] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:47:20.224  INFO 14 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@44c20b51
2022-01-16 11:47:20.234  INFO 14 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: emergency-active, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@44c20b51
2022-01-16 11:47:20.242  INFO 14 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@44c20b51
2022-01-16 11:47:20.242  INFO 14 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@44c20b51
2022-01-16 11:47:20.293  INFO 14 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@44c20b51
2022-01-16 11:47:20.293  INFO 14 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-revoke-extra, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@44c20b51
2022-01-16 11:47:20.316  INFO 14 --- [https-jsse-nio-7071-exec-6] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18912091259794367-58540, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=Deny}, TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:47:20.317  INFO 14 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=e8234ba9-2237-41f5-91ec-fb5467a6c45d, content=DENY, timestamp=1642333640317, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=Deny}, TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:47:20.318  INFO 14 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=159ms, Total=162ms
2022-01-16 11:47:20.344  INFO 14 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=f94fa36e-bb90-4c09-aa50-981c2951d684, content=null, timestamp=1642333640333, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=53266, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=4cbbcf975445, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=b07dfbf9-a4f5-4455-8203-a2cec4d67eff, http-req-server-port=80, http-header-accept=*/*, kc-id=6cb35628-1a35-4ce0-a796-86bb2026243f, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642333640332, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQG53NxAH4AEQAAAABh5AW7dAAkNmNiMzU2MjgtMWEzNS00Y2UwLWE3OTYtODZiYjIwMjYyNDNmdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRiMDdkZmJmOS1hNGY1LTQ0NTUtODIwMy1hMmNlYzRkNjdlZmZwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJEdC1tdDI0aWkxQ3VWUnBvbnRqazZNTFA4NFVOZDJDSnVVbTNzQXpGZXVVIn0.eyJleHAiOjE2NDIzMzM5MjcsImlhdCI6MTY0MjMzMzYyNywianRpIjoiNmNiMzU2MjgtMWEzNS00Y2UwLWE3OTYtODZiYjIwMjYyNDNmIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiJiMDdkZmJmOS1hNGY1LTQ0NTUtODIwMy1hMmNlYzRkNjdlZmYiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.LfQC6pOzHJwRKWJa93ShDgM_MdHoxnk9eyFbHPoREooqpMT3SMjbXwdLkCNCA1uopGCigRpu-rVC9ccTKnQlTDgnhvQem_tEjdzsYd5uMdjz4QlUMfilGKUWG6WO3balqXcCrl-G8-mb57iZhC2hQiX9z610oFRxfoiN6aHjOPbc3b5kLm37QHObSimyN-S1yTLGW4ut7qSpExXmOpDwje3DX8jhJWOJP852tpL4ihL6bOf0qaaYNartB524T1ibMy5pfYK7ayKYeVpBgw6f4U2R7IEK9owz6IFXQoP-VTCMEWrV0gnKBWbW0G6tosI4UBcwX_OETTaxyTxc26I4cw, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642333927, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.25.0.10, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=7B7247E606F86CBA02D9C3FA76CF712B, http-session-last-accessed-time=1642333640332, kc-category-name=ACCESS, kc-iat=1642333627, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:53266 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:47:20.345  INFO 14 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:47:20.347  INFO 14 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4d5eff88
2022-01-16 11:47:20.347  INFO 14 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4d5eff88
2022-01-16 11:47:20.362  INFO 14 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4d5eff88
2022-01-16 11:47:20.363  INFO 14 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4d5eff88
2022-01-16 11:47:20.417  INFO 14 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4d5eff88
2022-01-16 11:47:20.418  WARN 14 --- [https-jsse-nio-7071-exec-7] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:47:20.418  WARN 14 --- [https-jsse-nio-7071-exec-7] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:47:20.418  INFO 14 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4d5eff88
2022-01-16 11:47:20.419  INFO 14 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4d5eff88
2022-01-16 11:47:20.419  WARN 14 --- [https-jsse-nio-7071-exec-7] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:47:20.420  WARN 14 --- [https-jsse-nio-7071-exec-7] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:47:20.420  INFO 14 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4d5eff88
2022-01-16 11:47:20.432  INFO 14 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: emergency-active, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4d5eff88
2022-01-16 11:47:20.440  INFO 14 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4d5eff88
2022-01-16 11:47:20.440  INFO 14 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4d5eff88
2022-01-16 11:47:20.489  INFO 14 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4d5eff88
2022-01-16 11:47:20.490  INFO 14 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-revoke-extra, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4d5eff88
2022-01-16 11:47:20.506  INFO 14 --- [https-jsse-nio-7071-exec-7] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18912091447411999-252037, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=Deny}, TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:47:20.506  INFO 14 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=f94fa36e-bb90-4c09-aa50-981c2951d684, content=DENY, timestamp=1642333640506, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=Deny}, TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:47:20.508  INFO 14 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=160ms, Total=166ms
2022-01-16 11:47:20.537  INFO 14 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=00ea59a3-5433-4c6e-a8d4-2ce0772e7016, content=null, timestamp=1642333640520, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=53268, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=4cbbcf975445, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=b07dfbf9-a4f5-4455-8203-a2cec4d67eff, http-req-server-port=80, http-header-accept=*/*, kc-id=6cb35628-1a35-4ce0-a796-86bb2026243f, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642333640519, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQG53NxAH4AEQAAAABh5AW7dAAkNmNiMzU2MjgtMWEzNS00Y2UwLWE3OTYtODZiYjIwMjYyNDNmdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRiMDdkZmJmOS1hNGY1LTQ0NTUtODIwMy1hMmNlYzRkNjdlZmZwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJEdC1tdDI0aWkxQ3VWUnBvbnRqazZNTFA4NFVOZDJDSnVVbTNzQXpGZXVVIn0.eyJleHAiOjE2NDIzMzM5MjcsImlhdCI6MTY0MjMzMzYyNywianRpIjoiNmNiMzU2MjgtMWEzNS00Y2UwLWE3OTYtODZiYjIwMjYyNDNmIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiJiMDdkZmJmOS1hNGY1LTQ0NTUtODIwMy1hMmNlYzRkNjdlZmYiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.LfQC6pOzHJwRKWJa93ShDgM_MdHoxnk9eyFbHPoREooqpMT3SMjbXwdLkCNCA1uopGCigRpu-rVC9ccTKnQlTDgnhvQem_tEjdzsYd5uMdjz4QlUMfilGKUWG6WO3balqXcCrl-G8-mb57iZhC2hQiX9z610oFRxfoiN6aHjOPbc3b5kLm37QHObSimyN-S1yTLGW4ut7qSpExXmOpDwje3DX8jhJWOJP852tpL4ihL6bOf0qaaYNartB524T1ibMy5pfYK7ayKYeVpBgw6f4U2R7IEK9owz6IFXQoP-VTCMEWrV0gnKBWbW0G6tosI4UBcwX_OETTaxyTxc26I4cw, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642333927, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.25.0.10, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=92999A2FBC953CC3A54FEF6CF9B85D2A, http-session-last-accessed-time=1642333640519, kc-category-name=ACCESS, kc-iat=1642333627, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:53268 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:47:20.538  INFO 14 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:47:20.539  INFO 14 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3c4bd118
2022-01-16 11:47:20.540  INFO 14 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3c4bd118
2022-01-16 11:47:20.551  INFO 14 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3c4bd118
2022-01-16 11:47:20.551  INFO 14 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3c4bd118
2022-01-16 11:47:20.559  INFO 14 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3c4bd118
2022-01-16 11:47:20.559  WARN 14 --- [https-jsse-nio-7071-exec-8] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:47:20.559  WARN 14 --- [https-jsse-nio-7071-exec-8] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:47:20.560  INFO 14 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3c4bd118
2022-01-16 11:47:20.560  INFO 14 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3c4bd118
2022-01-16 11:47:20.560  WARN 14 --- [https-jsse-nio-7071-exec-8] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:47:20.560  WARN 14 --- [https-jsse-nio-7071-exec-8] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:47:20.560  INFO 14 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3c4bd118
2022-01-16 11:47:20.609  INFO 14 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: emergency-active, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3c4bd118
2022-01-16 11:47:20.630  INFO 14 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3c4bd118
2022-01-16 11:47:20.630  INFO 14 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3c4bd118
2022-01-16 11:47:20.638  INFO 14 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3c4bd118
2022-01-16 11:47:20.639  INFO 14 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-revoke-extra, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3c4bd118
2022-01-16 11:47:20.690  INFO 14 --- [https-jsse-nio-7071-exec-8] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18912091640162515-733287, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=Deny}, TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:47:20.690  INFO 14 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=00ea59a3-5433-4c6e-a8d4-2ce0772e7016, content=DENY, timestamp=1642333640690, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=Deny}, TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:47:20.691  INFO 14 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=151ms, Total=156ms
2022-01-16 11:47:20.711  INFO 14 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=941a7128-3017-4e87-b5d1-23185d78da45, content=null, timestamp=1642333640704, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=53270, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=4cbbcf975445, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=b07dfbf9-a4f5-4455-8203-a2cec4d67eff, http-req-server-port=80, http-header-accept=*/*, kc-id=6cb35628-1a35-4ce0-a796-86bb2026243f, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642333640703, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQG53NxAH4AEQAAAABh5AW7dAAkNmNiMzU2MjgtMWEzNS00Y2UwLWE3OTYtODZiYjIwMjYyNDNmdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRiMDdkZmJmOS1hNGY1LTQ0NTUtODIwMy1hMmNlYzRkNjdlZmZwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJEdC1tdDI0aWkxQ3VWUnBvbnRqazZNTFA4NFVOZDJDSnVVbTNzQXpGZXVVIn0.eyJleHAiOjE2NDIzMzM5MjcsImlhdCI6MTY0MjMzMzYyNywianRpIjoiNmNiMzU2MjgtMWEzNS00Y2UwLWE3OTYtODZiYjIwMjYyNDNmIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiJiMDdkZmJmOS1hNGY1LTQ0NTUtODIwMy1hMmNlYzRkNjdlZmYiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.LfQC6pOzHJwRKWJa93ShDgM_MdHoxnk9eyFbHPoREooqpMT3SMjbXwdLkCNCA1uopGCigRpu-rVC9ccTKnQlTDgnhvQem_tEjdzsYd5uMdjz4QlUMfilGKUWG6WO3balqXcCrl-G8-mb57iZhC2hQiX9z610oFRxfoiN6aHjOPbc3b5kLm37QHObSimyN-S1yTLGW4ut7qSpExXmOpDwje3DX8jhJWOJP852tpL4ihL6bOf0qaaYNartB524T1ibMy5pfYK7ayKYeVpBgw6f4U2R7IEK9owz6IFXQoP-VTCMEWrV0gnKBWbW0G6tosI4UBcwX_OETTaxyTxc26I4cw, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642333927, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.25.0.10, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=6E2278768FA4142AC347A047F70A068F, http-session-last-accessed-time=1642333640703, kc-category-name=ACCESS, kc-iat=1642333627, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:53270 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:47:20.716  INFO 14 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:47:20.717  INFO 14 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7f5bedb3
2022-01-16 11:47:20.718  INFO 14 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7f5bedb3
2022-01-16 11:47:20.731  INFO 14 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7f5bedb3
2022-01-16 11:47:20.731  INFO 14 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7f5bedb3
2022-01-16 11:47:20.742  INFO 14 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7f5bedb3
2022-01-16 11:47:20.742  WARN 14 --- [https-jsse-nio-7071-exec-9] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:47:20.743  WARN 14 --- [https-jsse-nio-7071-exec-9] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:47:20.743  INFO 14 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7f5bedb3
2022-01-16 11:47:20.744  INFO 14 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7f5bedb3
2022-01-16 11:47:20.744  WARN 14 --- [https-jsse-nio-7071-exec-9] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:47:20.744  WARN 14 --- [https-jsse-nio-7071-exec-9] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:47:20.744  INFO 14 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7f5bedb3
2022-01-16 11:47:20.797  INFO 14 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: emergency-active, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7f5bedb3
2022-01-16 11:47:20.810  INFO 14 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7f5bedb3
2022-01-16 11:47:20.810  INFO 14 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7f5bedb3
2022-01-16 11:47:20.819  INFO 14 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7f5bedb3
2022-01-16 11:47:20.819  INFO 14 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-revoke-extra, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7f5bedb3
2022-01-16 11:47:20.870  INFO 14 --- [https-jsse-nio-7071-exec-9] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18912091817615383-441204, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=Deny}, TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:47:20.871  INFO 14 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=941a7128-3017-4e87-b5d1-23185d78da45, content=DENY, timestamp=1642333640871, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=Deny}, TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:47:20.871  INFO 14 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=155ms, Total=162ms
2022-01-16 11:47:20.891  INFO 14 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=b11c3e1f-c154-408c-9268-e5854e519508, content=null, timestamp=1642333640887, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=53272, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=4cbbcf975445, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=b07dfbf9-a4f5-4455-8203-a2cec4d67eff, http-req-server-port=80, http-header-accept=*/*, kc-id=6cb35628-1a35-4ce0-a796-86bb2026243f, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642333640886, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQG53NxAH4AEQAAAABh5AW7dAAkNmNiMzU2MjgtMWEzNS00Y2UwLWE3OTYtODZiYjIwMjYyNDNmdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRiMDdkZmJmOS1hNGY1LTQ0NTUtODIwMy1hMmNlYzRkNjdlZmZwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJEdC1tdDI0aWkxQ3VWUnBvbnRqazZNTFA4NFVOZDJDSnVVbTNzQXpGZXVVIn0.eyJleHAiOjE2NDIzMzM5MjcsImlhdCI6MTY0MjMzMzYyNywianRpIjoiNmNiMzU2MjgtMWEzNS00Y2UwLWE3OTYtODZiYjIwMjYyNDNmIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiJiMDdkZmJmOS1hNGY1LTQ0NTUtODIwMy1hMmNlYzRkNjdlZmYiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.LfQC6pOzHJwRKWJa93ShDgM_MdHoxnk9eyFbHPoREooqpMT3SMjbXwdLkCNCA1uopGCigRpu-rVC9ccTKnQlTDgnhvQem_tEjdzsYd5uMdjz4QlUMfilGKUWG6WO3balqXcCrl-G8-mb57iZhC2hQiX9z610oFRxfoiN6aHjOPbc3b5kLm37QHObSimyN-S1yTLGW4ut7qSpExXmOpDwje3DX8jhJWOJP852tpL4ihL6bOf0qaaYNartB524T1ibMy5pfYK7ayKYeVpBgw6f4U2R7IEK9owz6IFXQoP-VTCMEWrV0gnKBWbW0G6tosI4UBcwX_OETTaxyTxc26I4cw, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642333927, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.25.0.10, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=48489F51B8750A14A89071F1845FCE56, http-session-last-accessed-time=1642333640886, kc-category-name=ACCESS, kc-iat=1642333627, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:53272 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:47:20.892  INFO 14 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:47:20.892  INFO 14 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@65de8042
2022-01-16 11:47:20.892  INFO 14 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@65de8042
2022-01-16 11:47:20.902  INFO 14 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@65de8042
2022-01-16 11:47:20.902  INFO 14 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@65de8042
2022-01-16 11:47:20.910  INFO 14 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@65de8042
2022-01-16 11:47:20.911  WARN 14 --- [https-jsse-nio-7071-exec-10] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:47:20.911  WARN 14 --- [https-jsse-nio-7071-exec-10] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:47:20.911  INFO 14 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@65de8042
2022-01-16 11:47:20.911  INFO 14 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@65de8042
2022-01-16 11:47:20.911  WARN 14 --- [https-jsse-nio-7071-exec-10] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:47:20.911  WARN 14 --- [https-jsse-nio-7071-exec-10] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:47:20.912  INFO 14 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@65de8042
2022-01-16 11:47:20.961  INFO 14 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: emergency-active, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@65de8042
2022-01-16 11:47:20.969  INFO 14 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@65de8042
2022-01-16 11:47:20.970  INFO 14 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@65de8042
2022-01-16 11:47:20.978  INFO 14 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@65de8042
2022-01-16 11:47:20.978  INFO 14 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-revoke-extra, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@65de8042
2022-01-16 11:47:21.030  INFO 14 --- [https-jsse-nio-7071-exec-10] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18912091993162103-419380, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=Deny}, TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:47:21.030  INFO 14 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=b11c3e1f-c154-408c-9268-e5854e519508, content=DENY, timestamp=1642333641030, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=Deny}, TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:47:21.031  INFO 14 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=138ms, Total=140ms
2022-01-16 11:47:21.046  INFO 14 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=883e6aee-7eee-4117-97f6-60f80037f899, content=null, timestamp=1642333641043, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=53274, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=4cbbcf975445, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=b07dfbf9-a4f5-4455-8203-a2cec4d67eff, http-req-server-port=80, http-header-accept=*/*, kc-id=6cb35628-1a35-4ce0-a796-86bb2026243f, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642333641041, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQG53NxAH4AEQAAAABh5AW7dAAkNmNiMzU2MjgtMWEzNS00Y2UwLWE3OTYtODZiYjIwMjYyNDNmdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRiMDdkZmJmOS1hNGY1LTQ0NTUtODIwMy1hMmNlYzRkNjdlZmZwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJEdC1tdDI0aWkxQ3VWUnBvbnRqazZNTFA4NFVOZDJDSnVVbTNzQXpGZXVVIn0.eyJleHAiOjE2NDIzMzM5MjcsImlhdCI6MTY0MjMzMzYyNywianRpIjoiNmNiMzU2MjgtMWEzNS00Y2UwLWE3OTYtODZiYjIwMjYyNDNmIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiJiMDdkZmJmOS1hNGY1LTQ0NTUtODIwMy1hMmNlYzRkNjdlZmYiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.LfQC6pOzHJwRKWJa93ShDgM_MdHoxnk9eyFbHPoREooqpMT3SMjbXwdLkCNCA1uopGCigRpu-rVC9ccTKnQlTDgnhvQem_tEjdzsYd5uMdjz4QlUMfilGKUWG6WO3balqXcCrl-G8-mb57iZhC2hQiX9z610oFRxfoiN6aHjOPbc3b5kLm37QHObSimyN-S1yTLGW4ut7qSpExXmOpDwje3DX8jhJWOJP852tpL4ihL6bOf0qaaYNartB524T1ibMy5pfYK7ayKYeVpBgw6f4U2R7IEK9owz6IFXQoP-VTCMEWrV0gnKBWbW0G6tosI4UBcwX_OETTaxyTxc26I4cw, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642333927, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.25.0.10, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=197FDF244C95A2A9E660A2658DF8B9FD, http-session-last-accessed-time=1642333641041, kc-category-name=ACCESS, kc-iat=1642333627, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:53274 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:47:21.047  INFO 14 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:47:21.047  INFO 14 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@ec06ed4
2022-01-16 11:47:21.048  INFO 14 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@ec06ed4
2022-01-16 11:47:21.063  INFO 14 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@ec06ed4
2022-01-16 11:47:21.063  INFO 14 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@ec06ed4
2022-01-16 11:47:21.084  INFO 14 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@ec06ed4
2022-01-16 11:47:21.085  WARN 14 --- [https-jsse-nio-7071-exec-1] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:47:21.085  WARN 14 --- [https-jsse-nio-7071-exec-1] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:47:21.085  INFO 14 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@ec06ed4
2022-01-16 11:47:21.086  INFO 14 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@ec06ed4
2022-01-16 11:47:21.086  WARN 14 --- [https-jsse-nio-7071-exec-1] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:47:21.086  WARN 14 --- [https-jsse-nio-7071-exec-1] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:47:21.086  INFO 14 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@ec06ed4
2022-01-16 11:47:21.141  INFO 14 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: emergency-active, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@ec06ed4
2022-01-16 11:47:21.152  INFO 14 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@ec06ed4
2022-01-16 11:47:21.152  INFO 14 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@ec06ed4
2022-01-16 11:47:21.161  INFO 14 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@ec06ed4
2022-01-16 11:47:21.161  INFO 14 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-revoke-extra, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@ec06ed4
2022-01-16 11:47:21.214  INFO 14 --- [https-jsse-nio-7071-exec-1] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18912092148096132-119210, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=Deny}, TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:47:21.214  INFO 14 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=883e6aee-7eee-4117-97f6-60f80037f899, content=DENY, timestamp=1642333641214, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=Deny}, TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:47:21.215  INFO 14 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=167ms, Total=170ms
2022-01-16 11:47:21.236  INFO 14 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=7e16b0a3-d3ed-4a04-bcfc-9992a389cb64, content=null, timestamp=1642333641228, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=53276, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=4cbbcf975445, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=b07dfbf9-a4f5-4455-8203-a2cec4d67eff, http-req-server-port=80, http-header-accept=*/*, kc-id=6cb35628-1a35-4ce0-a796-86bb2026243f, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642333641227, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQG53NxAH4AEQAAAABh5AW7dAAkNmNiMzU2MjgtMWEzNS00Y2UwLWE3OTYtODZiYjIwMjYyNDNmdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRiMDdkZmJmOS1hNGY1LTQ0NTUtODIwMy1hMmNlYzRkNjdlZmZwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJEdC1tdDI0aWkxQ3VWUnBvbnRqazZNTFA4NFVOZDJDSnVVbTNzQXpGZXVVIn0.eyJleHAiOjE2NDIzMzM5MjcsImlhdCI6MTY0MjMzMzYyNywianRpIjoiNmNiMzU2MjgtMWEzNS00Y2UwLWE3OTYtODZiYjIwMjYyNDNmIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiJiMDdkZmJmOS1hNGY1LTQ0NTUtODIwMy1hMmNlYzRkNjdlZmYiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.LfQC6pOzHJwRKWJa93ShDgM_MdHoxnk9eyFbHPoREooqpMT3SMjbXwdLkCNCA1uopGCigRpu-rVC9ccTKnQlTDgnhvQem_tEjdzsYd5uMdjz4QlUMfilGKUWG6WO3balqXcCrl-G8-mb57iZhC2hQiX9z610oFRxfoiN6aHjOPbc3b5kLm37QHObSimyN-S1yTLGW4ut7qSpExXmOpDwje3DX8jhJWOJP852tpL4ihL6bOf0qaaYNartB524T1ibMy5pfYK7ayKYeVpBgw6f4U2R7IEK9owz6IFXQoP-VTCMEWrV0gnKBWbW0G6tosI4UBcwX_OETTaxyTxc26I4cw, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642333927, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.25.0.10, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=4EA08A86A8F497F36ACF4B93D656EF06, http-session-last-accessed-time=1642333641227, kc-category-name=ACCESS, kc-iat=1642333627, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:53276 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:47:21.236  INFO 14 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:47:21.237  INFO 14 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@65d316be
2022-01-16 11:47:21.237  INFO 14 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@65d316be
2022-01-16 11:47:21.259  INFO 14 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@65d316be
2022-01-16 11:47:21.259  INFO 14 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@65d316be
2022-01-16 11:47:21.269  INFO 14 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@65d316be
2022-01-16 11:47:21.269  WARN 14 --- [https-jsse-nio-7071-exec-2] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:47:21.269  WARN 14 --- [https-jsse-nio-7071-exec-2] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:47:21.269  INFO 14 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@65d316be
2022-01-16 11:47:21.269  INFO 14 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@65d316be
2022-01-16 11:47:21.269  WARN 14 --- [https-jsse-nio-7071-exec-2] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:47:21.270  WARN 14 --- [https-jsse-nio-7071-exec-2] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:47:21.270  INFO 14 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@65d316be
2022-01-16 11:47:21.325  INFO 14 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: emergency-active, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@65d316be
2022-01-16 11:47:21.338  INFO 14 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@65d316be
2022-01-16 11:47:21.339  INFO 14 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@65d316be
2022-01-16 11:47:21.347  INFO 14 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@65d316be
2022-01-16 11:47:21.347  INFO 14 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-revoke-extra, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@65d316be
2022-01-16 11:47:21.397  INFO 14 --- [https-jsse-nio-7071-exec-2] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18912092337749832-107540, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=Deny}, TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:47:21.398  INFO 14 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=7e16b0a3-d3ed-4a04-bcfc-9992a389cb64, content=DENY, timestamp=1642333641398, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=Deny}, TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:47:21.398  INFO 14 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=162ms, Total=163ms
2022-01-16 11:47:21.415  INFO 14 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=69122b48-1c74-46fe-88f2-5b4658cf2482, content=null, timestamp=1642333641411, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=53278, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=4cbbcf975445, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=b07dfbf9-a4f5-4455-8203-a2cec4d67eff, http-req-server-port=80, http-header-accept=*/*, kc-id=6cb35628-1a35-4ce0-a796-86bb2026243f, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642333641410, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQG53NxAH4AEQAAAABh5AW7dAAkNmNiMzU2MjgtMWEzNS00Y2UwLWE3OTYtODZiYjIwMjYyNDNmdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRiMDdkZmJmOS1hNGY1LTQ0NTUtODIwMy1hMmNlYzRkNjdlZmZwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJEdC1tdDI0aWkxQ3VWUnBvbnRqazZNTFA4NFVOZDJDSnVVbTNzQXpGZXVVIn0.eyJleHAiOjE2NDIzMzM5MjcsImlhdCI6MTY0MjMzMzYyNywianRpIjoiNmNiMzU2MjgtMWEzNS00Y2UwLWE3OTYtODZiYjIwMjYyNDNmIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiJiMDdkZmJmOS1hNGY1LTQ0NTUtODIwMy1hMmNlYzRkNjdlZmYiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.LfQC6pOzHJwRKWJa93ShDgM_MdHoxnk9eyFbHPoREooqpMT3SMjbXwdLkCNCA1uopGCigRpu-rVC9ccTKnQlTDgnhvQem_tEjdzsYd5uMdjz4QlUMfilGKUWG6WO3balqXcCrl-G8-mb57iZhC2hQiX9z610oFRxfoiN6aHjOPbc3b5kLm37QHObSimyN-S1yTLGW4ut7qSpExXmOpDwje3DX8jhJWOJP852tpL4ihL6bOf0qaaYNartB524T1ibMy5pfYK7ayKYeVpBgw6f4U2R7IEK9owz6IFXQoP-VTCMEWrV0gnKBWbW0G6tosI4UBcwX_OETTaxyTxc26I4cw, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642333927, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.25.0.10, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=16E31E78F0A1AB0CCA732F53ADDC5211, http-session-last-accessed-time=1642333641410, kc-category-name=ACCESS, kc-iat=1642333627, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:53278 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:47:21.416  INFO 14 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:47:21.416  INFO 14 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@640991e4
2022-01-16 11:47:21.417  INFO 14 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@640991e4
2022-01-16 11:47:21.426  INFO 14 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@640991e4
2022-01-16 11:47:21.426  INFO 14 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@640991e4
2022-01-16 11:47:21.434  INFO 14 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@640991e4
2022-01-16 11:47:21.434  WARN 14 --- [https-jsse-nio-7071-exec-3] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:47:21.434  WARN 14 --- [https-jsse-nio-7071-exec-3] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:47:21.435  INFO 14 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@640991e4
2022-01-16 11:47:21.435  INFO 14 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@640991e4
2022-01-16 11:47:21.435  WARN 14 --- [https-jsse-nio-7071-exec-3] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:47:21.435  WARN 14 --- [https-jsse-nio-7071-exec-3] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:47:21.435  INFO 14 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@640991e4
2022-01-16 11:47:21.485  INFO 14 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: emergency-active, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@640991e4
2022-01-16 11:47:21.497  INFO 14 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@640991e4
2022-01-16 11:47:21.498  INFO 14 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@640991e4
2022-01-16 11:47:21.507  INFO 14 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@640991e4
2022-01-16 11:47:21.507  INFO 14 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-revoke-extra, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@640991e4
2022-01-16 11:47:21.557  INFO 14 --- [https-jsse-nio-7071-exec-3] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18912092517096270-555679, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=Deny}, TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:47:21.558  INFO 14 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=69122b48-1c74-46fe-88f2-5b4658cf2482, content=DENY, timestamp=1642333641558, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=Deny}, TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:47:21.558  INFO 14 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=142ms, Total=143ms
2022-01-16 11:47:21.578  INFO 14 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=ab180daa-d3c1-4ce4-b410-f24f0f107532, content=null, timestamp=1642333641573, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=53280, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=4cbbcf975445, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=b07dfbf9-a4f5-4455-8203-a2cec4d67eff, http-req-server-port=80, http-header-accept=*/*, kc-id=6cb35628-1a35-4ce0-a796-86bb2026243f, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642333641572, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQG53NxAH4AEQAAAABh5AW7dAAkNmNiMzU2MjgtMWEzNS00Y2UwLWE3OTYtODZiYjIwMjYyNDNmdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRiMDdkZmJmOS1hNGY1LTQ0NTUtODIwMy1hMmNlYzRkNjdlZmZwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJEdC1tdDI0aWkxQ3VWUnBvbnRqazZNTFA4NFVOZDJDSnVVbTNzQXpGZXVVIn0.eyJleHAiOjE2NDIzMzM5MjcsImlhdCI6MTY0MjMzMzYyNywianRpIjoiNmNiMzU2MjgtMWEzNS00Y2UwLWE3OTYtODZiYjIwMjYyNDNmIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiJiMDdkZmJmOS1hNGY1LTQ0NTUtODIwMy1hMmNlYzRkNjdlZmYiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.LfQC6pOzHJwRKWJa93ShDgM_MdHoxnk9eyFbHPoREooqpMT3SMjbXwdLkCNCA1uopGCigRpu-rVC9ccTKnQlTDgnhvQem_tEjdzsYd5uMdjz4QlUMfilGKUWG6WO3balqXcCrl-G8-mb57iZhC2hQiX9z610oFRxfoiN6aHjOPbc3b5kLm37QHObSimyN-S1yTLGW4ut7qSpExXmOpDwje3DX8jhJWOJP852tpL4ihL6bOf0qaaYNartB524T1ibMy5pfYK7ayKYeVpBgw6f4U2R7IEK9owz6IFXQoP-VTCMEWrV0gnKBWbW0G6tosI4UBcwX_OETTaxyTxc26I4cw, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642333927, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.25.0.10, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=A8CD1A999A643EB5718B11EFC1F9779E, http-session-last-accessed-time=1642333641572, kc-category-name=ACCESS, kc-iat=1642333627, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:53280 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:47:21.578  INFO 14 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:47:21.579  INFO 14 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@619decdd
2022-01-16 11:47:21.580  INFO 14 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@619decdd
2022-01-16 11:47:21.590  INFO 14 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@619decdd
2022-01-16 11:47:21.590  INFO 14 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@619decdd
2022-01-16 11:47:21.601  INFO 14 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@619decdd
2022-01-16 11:47:21.602  WARN 14 --- [https-jsse-nio-7071-exec-4] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:47:21.602  WARN 14 --- [https-jsse-nio-7071-exec-4] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:47:21.603  INFO 14 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@619decdd
2022-01-16 11:47:21.603  INFO 14 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@619decdd
2022-01-16 11:47:21.604  WARN 14 --- [https-jsse-nio-7071-exec-4] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:47:21.604  WARN 14 --- [https-jsse-nio-7071-exec-4] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:47:21.604  INFO 14 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@619decdd
2022-01-16 11:47:21.665  INFO 14 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: emergency-active, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@619decdd
2022-01-16 11:47:21.678  INFO 14 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@619decdd
2022-01-16 11:47:21.679  INFO 14 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@619decdd
2022-01-16 11:47:21.693  INFO 14 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@619decdd
2022-01-16 11:47:21.693  INFO 14 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-revoke-extra, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@619decdd
2022-01-16 11:47:21.746  INFO 14 --- [https-jsse-nio-7071-exec-4] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18912092680189813-189893, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=Deny}, TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:47:21.746  INFO 14 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=ab180daa-d3c1-4ce4-b410-f24f0f107532, content=DENY, timestamp=1642333641746, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=Deny}, TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:47:21.746  INFO 14 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=167ms, Total=169ms
2022-01-16 11:47:21.771  INFO 14 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=c11e68a2-7c94-48a8-acb8-0ef2b8a79e70, content=null, timestamp=1642333641764, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=53282, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=4cbbcf975445, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=b07dfbf9-a4f5-4455-8203-a2cec4d67eff, http-req-server-port=80, http-header-accept=*/*, kc-id=6cb35628-1a35-4ce0-a796-86bb2026243f, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642333641761, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQG53NxAH4AEQAAAABh5AW7dAAkNmNiMzU2MjgtMWEzNS00Y2UwLWE3OTYtODZiYjIwMjYyNDNmdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRiMDdkZmJmOS1hNGY1LTQ0NTUtODIwMy1hMmNlYzRkNjdlZmZwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJEdC1tdDI0aWkxQ3VWUnBvbnRqazZNTFA4NFVOZDJDSnVVbTNzQXpGZXVVIn0.eyJleHAiOjE2NDIzMzM5MjcsImlhdCI6MTY0MjMzMzYyNywianRpIjoiNmNiMzU2MjgtMWEzNS00Y2UwLWE3OTYtODZiYjIwMjYyNDNmIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiJiMDdkZmJmOS1hNGY1LTQ0NTUtODIwMy1hMmNlYzRkNjdlZmYiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.LfQC6pOzHJwRKWJa93ShDgM_MdHoxnk9eyFbHPoREooqpMT3SMjbXwdLkCNCA1uopGCigRpu-rVC9ccTKnQlTDgnhvQem_tEjdzsYd5uMdjz4QlUMfilGKUWG6WO3balqXcCrl-G8-mb57iZhC2hQiX9z610oFRxfoiN6aHjOPbc3b5kLm37QHObSimyN-S1yTLGW4ut7qSpExXmOpDwje3DX8jhJWOJP852tpL4ihL6bOf0qaaYNartB524T1ibMy5pfYK7ayKYeVpBgw6f4U2R7IEK9owz6IFXQoP-VTCMEWrV0gnKBWbW0G6tosI4UBcwX_OETTaxyTxc26I4cw, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642333927, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.25.0.10, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=322701DBBDA6318BB33080F8446FBEC8, http-session-last-accessed-time=1642333641761, kc-category-name=ACCESS, kc-iat=1642333627, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:53282 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:47:21.771  INFO 14 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:47:21.772  INFO 14 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2f888ac8
2022-01-16 11:47:21.772  INFO 14 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2f888ac8
2022-01-16 11:47:21.785  INFO 14 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2f888ac8
2022-01-16 11:47:21.785  INFO 14 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2f888ac8
2022-01-16 11:47:21.794  INFO 14 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2f888ac8
2022-01-16 11:47:21.794  WARN 14 --- [https-jsse-nio-7071-exec-5] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:47:21.795  WARN 14 --- [https-jsse-nio-7071-exec-5] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:47:21.795  INFO 14 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2f888ac8
2022-01-16 11:47:21.795  INFO 14 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2f888ac8
2022-01-16 11:47:21.795  WARN 14 --- [https-jsse-nio-7071-exec-5] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:47:21.795  WARN 14 --- [https-jsse-nio-7071-exec-5] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:47:21.795  INFO 14 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2f888ac8
2022-01-16 11:47:21.845  INFO 14 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: emergency-active, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2f888ac8
2022-01-16 11:47:21.858  INFO 14 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2f888ac8
2022-01-16 11:47:21.859  INFO 14 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2f888ac8
2022-01-16 11:47:21.869  INFO 14 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2f888ac8
2022-01-16 11:47:21.869  INFO 14 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-revoke-extra, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2f888ac8
2022-01-16 11:47:21.922  INFO 14 --- [https-jsse-nio-7071-exec-5] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18912092872741912-186642, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=Deny}, TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:47:21.922  INFO 14 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=c11e68a2-7c94-48a8-acb8-0ef2b8a79e70, content=DENY, timestamp=1642333641922, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=Deny}, TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:47:21.924  INFO 14 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=151ms, Total=154ms
2022-01-16 11:47:21.941  INFO 14 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=a7fa42e2-49dd-4925-8b1b-b365441780b9, content=null, timestamp=1642333641937, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=53284, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=4cbbcf975445, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=b07dfbf9-a4f5-4455-8203-a2cec4d67eff, http-req-server-port=80, http-header-accept=*/*, kc-id=6cb35628-1a35-4ce0-a796-86bb2026243f, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642333641935, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQG53NxAH4AEQAAAABh5AW7dAAkNmNiMzU2MjgtMWEzNS00Y2UwLWE3OTYtODZiYjIwMjYyNDNmdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRiMDdkZmJmOS1hNGY1LTQ0NTUtODIwMy1hMmNlYzRkNjdlZmZwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJEdC1tdDI0aWkxQ3VWUnBvbnRqazZNTFA4NFVOZDJDSnVVbTNzQXpGZXVVIn0.eyJleHAiOjE2NDIzMzM5MjcsImlhdCI6MTY0MjMzMzYyNywianRpIjoiNmNiMzU2MjgtMWEzNS00Y2UwLWE3OTYtODZiYjIwMjYyNDNmIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiJiMDdkZmJmOS1hNGY1LTQ0NTUtODIwMy1hMmNlYzRkNjdlZmYiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.LfQC6pOzHJwRKWJa93ShDgM_MdHoxnk9eyFbHPoREooqpMT3SMjbXwdLkCNCA1uopGCigRpu-rVC9ccTKnQlTDgnhvQem_tEjdzsYd5uMdjz4QlUMfilGKUWG6WO3balqXcCrl-G8-mb57iZhC2hQiX9z610oFRxfoiN6aHjOPbc3b5kLm37QHObSimyN-S1yTLGW4ut7qSpExXmOpDwje3DX8jhJWOJP852tpL4ihL6bOf0qaaYNartB524T1ibMy5pfYK7ayKYeVpBgw6f4U2R7IEK9owz6IFXQoP-VTCMEWrV0gnKBWbW0G6tosI4UBcwX_OETTaxyTxc26I4cw, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642333927, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.25.0.10, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=75B35C5EA6A85609599D86EE241CF719, http-session-last-accessed-time=1642333641935, kc-category-name=ACCESS, kc-iat=1642333627, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:53284 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:47:21.942  INFO 14 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:47:21.943  INFO 14 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@24b47717
2022-01-16 11:47:21.944  INFO 14 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@24b47717
2022-01-16 11:47:21.964  INFO 14 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@24b47717
2022-01-16 11:47:21.965  INFO 14 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@24b47717
2022-01-16 11:47:21.985  INFO 14 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@24b47717
2022-01-16 11:47:21.986  WARN 14 --- [https-jsse-nio-7071-exec-6] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:47:21.986  WARN 14 --- [https-jsse-nio-7071-exec-6] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:47:21.986  INFO 14 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@24b47717
2022-01-16 11:47:21.989  INFO 14 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@24b47717
2022-01-16 11:47:21.989  WARN 14 --- [https-jsse-nio-7071-exec-6] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:47:21.990  WARN 14 --- [https-jsse-nio-7071-exec-6] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:47:21.990  INFO 14 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@24b47717
2022-01-16 11:47:22.045  INFO 14 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: emergency-active, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@24b47717
2022-01-16 11:47:22.058  INFO 14 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@24b47717
2022-01-16 11:47:22.058  INFO 14 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@24b47717
2022-01-16 11:47:22.069  INFO 14 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@24b47717
2022-01-16 11:47:22.069  INFO 14 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-revoke-extra, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@24b47717
2022-01-16 11:47:22.125  INFO 14 --- [https-jsse-nio-7071-exec-6] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18912093043837782-485843, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=Deny}, TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:47:22.126  INFO 14 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=a7fa42e2-49dd-4925-8b1b-b365441780b9, content=DENY, timestamp=1642333642126, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=Deny}, TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:47:22.126  INFO 14 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=184ms, Total=186ms
2022-01-16 11:47:22.144  INFO 14 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=f8acbdc5-719b-4127-9eff-5f3649a3c50e, content=null, timestamp=1642333642140, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=53286, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=4cbbcf975445, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=b07dfbf9-a4f5-4455-8203-a2cec4d67eff, http-req-server-port=80, http-header-accept=*/*, kc-id=6cb35628-1a35-4ce0-a796-86bb2026243f, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642333642139, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQG53NxAH4AEQAAAABh5AW7dAAkNmNiMzU2MjgtMWEzNS00Y2UwLWE3OTYtODZiYjIwMjYyNDNmdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRiMDdkZmJmOS1hNGY1LTQ0NTUtODIwMy1hMmNlYzRkNjdlZmZwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJEdC1tdDI0aWkxQ3VWUnBvbnRqazZNTFA4NFVOZDJDSnVVbTNzQXpGZXVVIn0.eyJleHAiOjE2NDIzMzM5MjcsImlhdCI6MTY0MjMzMzYyNywianRpIjoiNmNiMzU2MjgtMWEzNS00Y2UwLWE3OTYtODZiYjIwMjYyNDNmIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiJiMDdkZmJmOS1hNGY1LTQ0NTUtODIwMy1hMmNlYzRkNjdlZmYiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.LfQC6pOzHJwRKWJa93ShDgM_MdHoxnk9eyFbHPoREooqpMT3SMjbXwdLkCNCA1uopGCigRpu-rVC9ccTKnQlTDgnhvQem_tEjdzsYd5uMdjz4QlUMfilGKUWG6WO3balqXcCrl-G8-mb57iZhC2hQiX9z610oFRxfoiN6aHjOPbc3b5kLm37QHObSimyN-S1yTLGW4ut7qSpExXmOpDwje3DX8jhJWOJP852tpL4ihL6bOf0qaaYNartB524T1ibMy5pfYK7ayKYeVpBgw6f4U2R7IEK9owz6IFXQoP-VTCMEWrV0gnKBWbW0G6tosI4UBcwX_OETTaxyTxc26I4cw, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642333927, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.25.0.10, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=37D6A9D8A2D6333C435778DD42322D62, http-session-last-accessed-time=1642333642139, kc-category-name=ACCESS, kc-iat=1642333627, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:53286 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:47:22.145  INFO 14 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:47:22.145  INFO 14 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@212fd616
2022-01-16 11:47:22.145  INFO 14 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@212fd616
2022-01-16 11:47:22.169  INFO 14 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@212fd616
2022-01-16 11:47:22.169  INFO 14 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@212fd616
2022-01-16 11:47:22.187  INFO 14 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@212fd616
2022-01-16 11:47:22.187  WARN 14 --- [https-jsse-nio-7071-exec-7] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:47:22.188  WARN 14 --- [https-jsse-nio-7071-exec-7] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:47:22.190  INFO 14 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@212fd616
2022-01-16 11:47:22.190  INFO 14 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@212fd616
2022-01-16 11:47:22.191  WARN 14 --- [https-jsse-nio-7071-exec-7] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:47:22.191  WARN 14 --- [https-jsse-nio-7071-exec-7] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:47:22.191  INFO 14 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@212fd616
2022-01-16 11:47:22.250  INFO 14 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: emergency-active, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@212fd616
2022-01-16 11:47:22.262  INFO 14 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@212fd616
2022-01-16 11:47:22.263  INFO 14 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@212fd616
2022-01-16 11:47:22.272  INFO 14 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@212fd616
2022-01-16 11:47:22.272  INFO 14 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-revoke-extra, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@212fd616
2022-01-16 11:47:22.325  INFO 14 --- [https-jsse-nio-7071-exec-7] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18912093246188701-501808, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=Deny}, TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:47:22.325  INFO 14 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=f8acbdc5-719b-4127-9eff-5f3649a3c50e, content=DENY, timestamp=1642333642325, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=Deny}, TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:47:22.326  INFO 14 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=180ms, Total=182ms
2022-01-16 11:47:22.351  INFO 14 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=5cda44c6-6397-4369-8b15-4cceca8325ae, content=null, timestamp=1642333642343, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=53288, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=4cbbcf975445, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=b07dfbf9-a4f5-4455-8203-a2cec4d67eff, http-req-server-port=80, http-header-accept=*/*, kc-id=6cb35628-1a35-4ce0-a796-86bb2026243f, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642333642341, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQG53NxAH4AEQAAAABh5AW7dAAkNmNiMzU2MjgtMWEzNS00Y2UwLWE3OTYtODZiYjIwMjYyNDNmdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRiMDdkZmJmOS1hNGY1LTQ0NTUtODIwMy1hMmNlYzRkNjdlZmZwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJEdC1tdDI0aWkxQ3VWUnBvbnRqazZNTFA4NFVOZDJDSnVVbTNzQXpGZXVVIn0.eyJleHAiOjE2NDIzMzM5MjcsImlhdCI6MTY0MjMzMzYyNywianRpIjoiNmNiMzU2MjgtMWEzNS00Y2UwLWE3OTYtODZiYjIwMjYyNDNmIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiJiMDdkZmJmOS1hNGY1LTQ0NTUtODIwMy1hMmNlYzRkNjdlZmYiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.LfQC6pOzHJwRKWJa93ShDgM_MdHoxnk9eyFbHPoREooqpMT3SMjbXwdLkCNCA1uopGCigRpu-rVC9ccTKnQlTDgnhvQem_tEjdzsYd5uMdjz4QlUMfilGKUWG6WO3balqXcCrl-G8-mb57iZhC2hQiX9z610oFRxfoiN6aHjOPbc3b5kLm37QHObSimyN-S1yTLGW4ut7qSpExXmOpDwje3DX8jhJWOJP852tpL4ihL6bOf0qaaYNartB524T1ibMy5pfYK7ayKYeVpBgw6f4U2R7IEK9owz6IFXQoP-VTCMEWrV0gnKBWbW0G6tosI4UBcwX_OETTaxyTxc26I4cw, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642333927, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.25.0.10, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=9EAD0A06D2F36E145C68B35501997781, http-session-last-accessed-time=1642333642341, kc-category-name=ACCESS, kc-iat=1642333627, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:53288 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:47:22.352  INFO 14 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:47:22.353  INFO 14 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5ab7f736
2022-01-16 11:47:22.353  INFO 14 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5ab7f736
2022-01-16 11:47:22.361  INFO 14 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5ab7f736
2022-01-16 11:47:22.361  INFO 14 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5ab7f736
2022-01-16 11:47:22.369  INFO 14 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5ab7f736
2022-01-16 11:47:22.369  WARN 14 --- [https-jsse-nio-7071-exec-8] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:47:22.369  WARN 14 --- [https-jsse-nio-7071-exec-8] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:47:22.370  INFO 14 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5ab7f736
2022-01-16 11:47:22.370  INFO 14 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5ab7f736
2022-01-16 11:47:22.370  WARN 14 --- [https-jsse-nio-7071-exec-8] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:47:22.370  WARN 14 --- [https-jsse-nio-7071-exec-8] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:47:22.370  INFO 14 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5ab7f736
2022-01-16 11:47:22.421  INFO 14 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: emergency-active, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5ab7f736
2022-01-16 11:47:22.438  INFO 14 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5ab7f736
2022-01-16 11:47:22.439  INFO 14 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5ab7f736
2022-01-16 11:47:22.449  INFO 14 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5ab7f736
2022-01-16 11:47:22.450  INFO 14 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-revoke-extra, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5ab7f736
2022-01-16 11:47:22.502  INFO 14 --- [https-jsse-nio-7071-exec-8] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18912093453227522-705607, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=Deny}, TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:47:22.502  INFO 14 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=5cda44c6-6397-4369-8b15-4cceca8325ae, content=DENY, timestamp=1642333642502, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=Deny}, TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:47:22.503  INFO 14 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=150ms, Total=153ms
2022-01-16 11:47:22.523  INFO 14 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=6659cc7c-3bd4-48f1-93ac-a24d6148c3bc, content=null, timestamp=1642333642518, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=53290, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=4cbbcf975445, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=b07dfbf9-a4f5-4455-8203-a2cec4d67eff, http-req-server-port=80, http-header-accept=*/*, kc-id=6cb35628-1a35-4ce0-a796-86bb2026243f, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642333642516, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQG53NxAH4AEQAAAABh5AW7dAAkNmNiMzU2MjgtMWEzNS00Y2UwLWE3OTYtODZiYjIwMjYyNDNmdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRiMDdkZmJmOS1hNGY1LTQ0NTUtODIwMy1hMmNlYzRkNjdlZmZwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJEdC1tdDI0aWkxQ3VWUnBvbnRqazZNTFA4NFVOZDJDSnVVbTNzQXpGZXVVIn0.eyJleHAiOjE2NDIzMzM5MjcsImlhdCI6MTY0MjMzMzYyNywianRpIjoiNmNiMzU2MjgtMWEzNS00Y2UwLWE3OTYtODZiYjIwMjYyNDNmIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiJiMDdkZmJmOS1hNGY1LTQ0NTUtODIwMy1hMmNlYzRkNjdlZmYiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.LfQC6pOzHJwRKWJa93ShDgM_MdHoxnk9eyFbHPoREooqpMT3SMjbXwdLkCNCA1uopGCigRpu-rVC9ccTKnQlTDgnhvQem_tEjdzsYd5uMdjz4QlUMfilGKUWG6WO3balqXcCrl-G8-mb57iZhC2hQiX9z610oFRxfoiN6aHjOPbc3b5kLm37QHObSimyN-S1yTLGW4ut7qSpExXmOpDwje3DX8jhJWOJP852tpL4ihL6bOf0qaaYNartB524T1ibMy5pfYK7ayKYeVpBgw6f4U2R7IEK9owz6IFXQoP-VTCMEWrV0gnKBWbW0G6tosI4UBcwX_OETTaxyTxc26I4cw, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642333927, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.25.0.10, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=2496EE5E7B1194F35E7A7AB822B1D870, http-session-last-accessed-time=1642333642516, kc-category-name=ACCESS, kc-iat=1642333627, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:53290 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:47:22.523  INFO 14 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:47:22.525  INFO 14 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@20bf9f45
2022-01-16 11:47:22.525  INFO 14 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@20bf9f45
2022-01-16 11:47:22.535  INFO 14 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@20bf9f45
2022-01-16 11:47:22.536  INFO 14 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@20bf9f45
2022-01-16 11:47:22.545  INFO 14 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@20bf9f45
2022-01-16 11:47:22.545  WARN 14 --- [https-jsse-nio-7071-exec-9] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:47:22.545  WARN 14 --- [https-jsse-nio-7071-exec-9] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:47:22.546  INFO 14 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@20bf9f45
2022-01-16 11:47:22.546  INFO 14 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@20bf9f45
2022-01-16 11:47:22.546  WARN 14 --- [https-jsse-nio-7071-exec-9] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:47:22.546  WARN 14 --- [https-jsse-nio-7071-exec-9] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:47:22.546  INFO 14 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@20bf9f45
2022-01-16 11:47:22.597  INFO 14 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: emergency-active, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@20bf9f45
2022-01-16 11:47:22.611  INFO 14 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@20bf9f45
2022-01-16 11:47:22.611  INFO 14 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@20bf9f45
2022-01-16 11:47:22.625  INFO 14 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@20bf9f45
2022-01-16 11:47:22.625  INFO 14 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-revoke-extra, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@20bf9f45
2022-01-16 11:47:22.682  INFO 14 --- [https-jsse-nio-7071-exec-9] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18912093625136250-56891, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=Deny}, TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:47:22.682  INFO 14 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=6659cc7c-3bd4-48f1-93ac-a24d6148c3bc, content=DENY, timestamp=1642333642682, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=Deny}, TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:47:22.684  INFO 14 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=158ms, Total=162ms
2022-01-16 11:47:22.705  INFO 14 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=395f2f0b-8211-4cd0-a75a-4b45bf4eecff, content=null, timestamp=1642333642701, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=53292, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=4cbbcf975445, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=b07dfbf9-a4f5-4455-8203-a2cec4d67eff, http-req-server-port=80, http-header-accept=*/*, kc-id=6cb35628-1a35-4ce0-a796-86bb2026243f, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642333642699, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQG53NxAH4AEQAAAABh5AW7dAAkNmNiMzU2MjgtMWEzNS00Y2UwLWE3OTYtODZiYjIwMjYyNDNmdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRiMDdkZmJmOS1hNGY1LTQ0NTUtODIwMy1hMmNlYzRkNjdlZmZwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJEdC1tdDI0aWkxQ3VWUnBvbnRqazZNTFA4NFVOZDJDSnVVbTNzQXpGZXVVIn0.eyJleHAiOjE2NDIzMzM5MjcsImlhdCI6MTY0MjMzMzYyNywianRpIjoiNmNiMzU2MjgtMWEzNS00Y2UwLWE3OTYtODZiYjIwMjYyNDNmIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiJiMDdkZmJmOS1hNGY1LTQ0NTUtODIwMy1hMmNlYzRkNjdlZmYiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.LfQC6pOzHJwRKWJa93ShDgM_MdHoxnk9eyFbHPoREooqpMT3SMjbXwdLkCNCA1uopGCigRpu-rVC9ccTKnQlTDgnhvQem_tEjdzsYd5uMdjz4QlUMfilGKUWG6WO3balqXcCrl-G8-mb57iZhC2hQiX9z610oFRxfoiN6aHjOPbc3b5kLm37QHObSimyN-S1yTLGW4ut7qSpExXmOpDwje3DX8jhJWOJP852tpL4ihL6bOf0qaaYNartB524T1ibMy5pfYK7ayKYeVpBgw6f4U2R7IEK9owz6IFXQoP-VTCMEWrV0gnKBWbW0G6tosI4UBcwX_OETTaxyTxc26I4cw, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642333927, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.25.0.10, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=C5D0BE3AB06B1511790E48C5A1795503, http-session-last-accessed-time=1642333642699, kc-category-name=ACCESS, kc-iat=1642333627, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:53292 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:47:22.705  INFO 14 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:47:22.706  INFO 14 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3a0420bd
2022-01-16 11:47:22.706  INFO 14 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3a0420bd
2022-01-16 11:47:22.716  INFO 14 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3a0420bd
2022-01-16 11:47:22.716  INFO 14 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3a0420bd
2022-01-16 11:47:22.724  INFO 14 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3a0420bd
2022-01-16 11:47:22.724  WARN 14 --- [https-jsse-nio-7071-exec-10] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:47:22.724  WARN 14 --- [https-jsse-nio-7071-exec-10] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:47:22.724  INFO 14 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3a0420bd
2022-01-16 11:47:22.724  INFO 14 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3a0420bd
2022-01-16 11:47:22.725  WARN 14 --- [https-jsse-nio-7071-exec-10] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:47:22.725  WARN 14 --- [https-jsse-nio-7071-exec-10] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:47:22.725  INFO 14 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3a0420bd
2022-01-16 11:47:22.773  INFO 14 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: emergency-active, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3a0420bd
2022-01-16 11:47:22.787  INFO 14 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3a0420bd
2022-01-16 11:47:22.788  INFO 14 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3a0420bd
2022-01-16 11:47:22.796  INFO 14 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3a0420bd
2022-01-16 11:47:22.797  INFO 14 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-revoke-extra, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3a0420bd
2022-01-16 11:47:22.845  INFO 14 --- [https-jsse-nio-7071-exec-10] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18912093807030592-628437, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=Deny}, TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:47:22.846  INFO 14 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=395f2f0b-8211-4cd0-a75a-4b45bf4eecff, content=DENY, timestamp=1642333642846, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=Deny}, TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:47:22.847  INFO 14 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=140ms, Total=143ms
2022-01-16 11:47:22.867  INFO 14 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=fa7b594d-29b5-4e0c-a6e0-4f5ed622805e, content=null, timestamp=1642333642859, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=53294, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=4cbbcf975445, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=b07dfbf9-a4f5-4455-8203-a2cec4d67eff, http-req-server-port=80, http-header-accept=*/*, kc-id=6cb35628-1a35-4ce0-a796-86bb2026243f, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642333642858, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQG53NxAH4AEQAAAABh5AW7dAAkNmNiMzU2MjgtMWEzNS00Y2UwLWE3OTYtODZiYjIwMjYyNDNmdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRiMDdkZmJmOS1hNGY1LTQ0NTUtODIwMy1hMmNlYzRkNjdlZmZwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJEdC1tdDI0aWkxQ3VWUnBvbnRqazZNTFA4NFVOZDJDSnVVbTNzQXpGZXVVIn0.eyJleHAiOjE2NDIzMzM5MjcsImlhdCI6MTY0MjMzMzYyNywianRpIjoiNmNiMzU2MjgtMWEzNS00Y2UwLWE3OTYtODZiYjIwMjYyNDNmIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiJiMDdkZmJmOS1hNGY1LTQ0NTUtODIwMy1hMmNlYzRkNjdlZmYiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.LfQC6pOzHJwRKWJa93ShDgM_MdHoxnk9eyFbHPoREooqpMT3SMjbXwdLkCNCA1uopGCigRpu-rVC9ccTKnQlTDgnhvQem_tEjdzsYd5uMdjz4QlUMfilGKUWG6WO3balqXcCrl-G8-mb57iZhC2hQiX9z610oFRxfoiN6aHjOPbc3b5kLm37QHObSimyN-S1yTLGW4ut7qSpExXmOpDwje3DX8jhJWOJP852tpL4ihL6bOf0qaaYNartB524T1ibMy5pfYK7ayKYeVpBgw6f4U2R7IEK9owz6IFXQoP-VTCMEWrV0gnKBWbW0G6tosI4UBcwX_OETTaxyTxc26I4cw, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642333927, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.25.0.10, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=CB047580F6CE7A4610E5B8C4F391D0B3, http-session-last-accessed-time=1642333642858, kc-category-name=ACCESS, kc-iat=1642333627, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:53294 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:47:22.868  INFO 14 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:47:22.869  INFO 14 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@29c9ce61
2022-01-16 11:47:22.869  INFO 14 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@29c9ce61
2022-01-16 11:47:22.881  INFO 14 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@29c9ce61
2022-01-16 11:47:22.882  INFO 14 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@29c9ce61
2022-01-16 11:47:22.890  INFO 14 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@29c9ce61
2022-01-16 11:47:22.891  WARN 14 --- [https-jsse-nio-7071-exec-1] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:47:22.891  WARN 14 --- [https-jsse-nio-7071-exec-1] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:47:22.891  INFO 14 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@29c9ce61
2022-01-16 11:47:22.892  INFO 14 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@29c9ce61
2022-01-16 11:47:22.892  WARN 14 --- [https-jsse-nio-7071-exec-1] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:47:22.892  WARN 14 --- [https-jsse-nio-7071-exec-1] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:47:22.892  INFO 14 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@29c9ce61
2022-01-16 11:47:22.941  INFO 14 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: emergency-active, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@29c9ce61
2022-01-16 11:47:22.955  INFO 14 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@29c9ce61
2022-01-16 11:47:22.956  INFO 14 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@29c9ce61
2022-01-16 11:47:22.968  INFO 14 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@29c9ce61
2022-01-16 11:47:22.969  INFO 14 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-revoke-extra, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@29c9ce61
2022-01-16 11:47:23.022  INFO 14 --- [https-jsse-nio-7071-exec-1] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18912093969879591-305037, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=Deny}, TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:47:23.022  INFO 14 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=fa7b594d-29b5-4e0c-a6e0-4f5ed622805e, content=DENY, timestamp=1642333643022, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=Deny}, TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:47:23.023  INFO 14 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=154ms, Total=157ms
2022-01-16 11:47:23.043  INFO 14 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=bd8b2878-071e-4e57-9028-3e1d1bf9f496, content=null, timestamp=1642333643037, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=53296, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=4cbbcf975445, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=b07dfbf9-a4f5-4455-8203-a2cec4d67eff, http-req-server-port=80, http-header-accept=*/*, kc-id=6cb35628-1a35-4ce0-a796-86bb2026243f, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642333643035, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQG53NxAH4AEQAAAABh5AW7dAAkNmNiMzU2MjgtMWEzNS00Y2UwLWE3OTYtODZiYjIwMjYyNDNmdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRiMDdkZmJmOS1hNGY1LTQ0NTUtODIwMy1hMmNlYzRkNjdlZmZwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJEdC1tdDI0aWkxQ3VWUnBvbnRqazZNTFA4NFVOZDJDSnVVbTNzQXpGZXVVIn0.eyJleHAiOjE2NDIzMzM5MjcsImlhdCI6MTY0MjMzMzYyNywianRpIjoiNmNiMzU2MjgtMWEzNS00Y2UwLWE3OTYtODZiYjIwMjYyNDNmIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiJiMDdkZmJmOS1hNGY1LTQ0NTUtODIwMy1hMmNlYzRkNjdlZmYiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.LfQC6pOzHJwRKWJa93ShDgM_MdHoxnk9eyFbHPoREooqpMT3SMjbXwdLkCNCA1uopGCigRpu-rVC9ccTKnQlTDgnhvQem_tEjdzsYd5uMdjz4QlUMfilGKUWG6WO3balqXcCrl-G8-mb57iZhC2hQiX9z610oFRxfoiN6aHjOPbc3b5kLm37QHObSimyN-S1yTLGW4ut7qSpExXmOpDwje3DX8jhJWOJP852tpL4ihL6bOf0qaaYNartB524T1ibMy5pfYK7ayKYeVpBgw6f4U2R7IEK9owz6IFXQoP-VTCMEWrV0gnKBWbW0G6tosI4UBcwX_OETTaxyTxc26I4cw, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642333927, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.25.0.10, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=9C64FDDC470E856D7BC187A0B9236AA4, http-session-last-accessed-time=1642333643035, kc-category-name=ACCESS, kc-iat=1642333627, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:53296 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:47:23.043  INFO 14 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:47:23.044  INFO 14 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@18b0ffe7
2022-01-16 11:47:23.044  INFO 14 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@18b0ffe7
2022-01-16 11:47:23.056  INFO 14 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@18b0ffe7
2022-01-16 11:47:23.056  INFO 14 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@18b0ffe7
2022-01-16 11:47:23.064  INFO 14 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@18b0ffe7
2022-01-16 11:47:23.064  WARN 14 --- [https-jsse-nio-7071-exec-2] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:47:23.064  WARN 14 --- [https-jsse-nio-7071-exec-2] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:47:23.064  INFO 14 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@18b0ffe7
2022-01-16 11:47:23.065  INFO 14 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@18b0ffe7
2022-01-16 11:47:23.065  WARN 14 --- [https-jsse-nio-7071-exec-2] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:47:23.065  WARN 14 --- [https-jsse-nio-7071-exec-2] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:47:23.065  INFO 14 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@18b0ffe7
2022-01-16 11:47:23.117  INFO 14 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: emergency-active, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@18b0ffe7
2022-01-16 11:47:23.127  INFO 14 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@18b0ffe7
2022-01-16 11:47:23.127  INFO 14 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@18b0ffe7
2022-01-16 11:47:23.137  INFO 14 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@18b0ffe7
2022-01-16 11:47:23.137  INFO 14 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-revoke-extra, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@18b0ffe7
2022-01-16 11:47:23.189  INFO 14 --- [https-jsse-nio-7071-exec-2] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18912094144824752-182154, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=Deny}, TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:47:23.190  INFO 14 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=bd8b2878-071e-4e57-9028-3e1d1bf9f496, content=DENY, timestamp=1642333643190, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=Deny}, TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:47:23.191  INFO 14 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=147ms, Total=149ms
2022-01-16 11:47:23.209  INFO 14 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=c40aa882-c043-4911-8e6f-1a63cb072d41, content=null, timestamp=1642333643204, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=53298, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=4cbbcf975445, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=b07dfbf9-a4f5-4455-8203-a2cec4d67eff, http-req-server-port=80, http-header-accept=*/*, kc-id=6cb35628-1a35-4ce0-a796-86bb2026243f, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642333643203, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQG53NxAH4AEQAAAABh5AW7dAAkNmNiMzU2MjgtMWEzNS00Y2UwLWE3OTYtODZiYjIwMjYyNDNmdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRiMDdkZmJmOS1hNGY1LTQ0NTUtODIwMy1hMmNlYzRkNjdlZmZwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJEdC1tdDI0aWkxQ3VWUnBvbnRqazZNTFA4NFVOZDJDSnVVbTNzQXpGZXVVIn0.eyJleHAiOjE2NDIzMzM5MjcsImlhdCI6MTY0MjMzMzYyNywianRpIjoiNmNiMzU2MjgtMWEzNS00Y2UwLWE3OTYtODZiYjIwMjYyNDNmIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiJiMDdkZmJmOS1hNGY1LTQ0NTUtODIwMy1hMmNlYzRkNjdlZmYiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.LfQC6pOzHJwRKWJa93ShDgM_MdHoxnk9eyFbHPoREooqpMT3SMjbXwdLkCNCA1uopGCigRpu-rVC9ccTKnQlTDgnhvQem_tEjdzsYd5uMdjz4QlUMfilGKUWG6WO3balqXcCrl-G8-mb57iZhC2hQiX9z610oFRxfoiN6aHjOPbc3b5kLm37QHObSimyN-S1yTLGW4ut7qSpExXmOpDwje3DX8jhJWOJP852tpL4ihL6bOf0qaaYNartB524T1ibMy5pfYK7ayKYeVpBgw6f4U2R7IEK9owz6IFXQoP-VTCMEWrV0gnKBWbW0G6tosI4UBcwX_OETTaxyTxc26I4cw, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642333927, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.25.0.10, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=8682C576E2D8058B80A9224F9F366E8A, http-session-last-accessed-time=1642333643203, kc-category-name=ACCESS, kc-iat=1642333627, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:53298 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:47:23.209  INFO 14 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:47:23.210  INFO 14 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@51845688
2022-01-16 11:47:23.210  INFO 14 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@51845688
2022-01-16 11:47:23.218  INFO 14 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@51845688
2022-01-16 11:47:23.218  INFO 14 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@51845688
2022-01-16 11:47:23.226  INFO 14 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@51845688
2022-01-16 11:47:23.226  WARN 14 --- [https-jsse-nio-7071-exec-3] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:47:23.226  WARN 14 --- [https-jsse-nio-7071-exec-3] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:47:23.226  INFO 14 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@51845688
2022-01-16 11:47:23.226  INFO 14 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@51845688
2022-01-16 11:47:23.226  WARN 14 --- [https-jsse-nio-7071-exec-3] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:47:23.226  WARN 14 --- [https-jsse-nio-7071-exec-3] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:47:23.226  INFO 14 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@51845688
2022-01-16 11:47:23.277  INFO 14 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: emergency-active, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@51845688
2022-01-16 11:47:23.293  INFO 14 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@51845688
2022-01-16 11:47:23.293  INFO 14 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@51845688
2022-01-16 11:47:23.301  INFO 14 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@51845688
2022-01-16 11:47:23.301  INFO 14 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-revoke-extra, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@51845688
2022-01-16 11:47:23.354  INFO 14 --- [https-jsse-nio-7071-exec-3] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18912094310758194-176079, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=Deny}, TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:47:23.354  INFO 14 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=c40aa882-c043-4911-8e6f-1a63cb072d41, content=DENY, timestamp=1642333643354, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=Deny}, TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:47:23.355  INFO 14 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=145ms, Total=147ms
2022-01-16 11:47:23.376  INFO 14 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=e46f8731-8afd-46e5-8451-44698fb39820, content=null, timestamp=1642333643372, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=53300, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=4cbbcf975445, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=b07dfbf9-a4f5-4455-8203-a2cec4d67eff, http-req-server-port=80, http-header-accept=*/*, kc-id=6cb35628-1a35-4ce0-a796-86bb2026243f, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642333643370, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQG53NxAH4AEQAAAABh5AW7dAAkNmNiMzU2MjgtMWEzNS00Y2UwLWE3OTYtODZiYjIwMjYyNDNmdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRiMDdkZmJmOS1hNGY1LTQ0NTUtODIwMy1hMmNlYzRkNjdlZmZwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJEdC1tdDI0aWkxQ3VWUnBvbnRqazZNTFA4NFVOZDJDSnVVbTNzQXpGZXVVIn0.eyJleHAiOjE2NDIzMzM5MjcsImlhdCI6MTY0MjMzMzYyNywianRpIjoiNmNiMzU2MjgtMWEzNS00Y2UwLWE3OTYtODZiYjIwMjYyNDNmIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiJiMDdkZmJmOS1hNGY1LTQ0NTUtODIwMy1hMmNlYzRkNjdlZmYiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.LfQC6pOzHJwRKWJa93ShDgM_MdHoxnk9eyFbHPoREooqpMT3SMjbXwdLkCNCA1uopGCigRpu-rVC9ccTKnQlTDgnhvQem_tEjdzsYd5uMdjz4QlUMfilGKUWG6WO3balqXcCrl-G8-mb57iZhC2hQiX9z610oFRxfoiN6aHjOPbc3b5kLm37QHObSimyN-S1yTLGW4ut7qSpExXmOpDwje3DX8jhJWOJP852tpL4ihL6bOf0qaaYNartB524T1ibMy5pfYK7ayKYeVpBgw6f4U2R7IEK9owz6IFXQoP-VTCMEWrV0gnKBWbW0G6tosI4UBcwX_OETTaxyTxc26I4cw, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642333927, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.25.0.10, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=7D984A6689932F16D84BE3E49A230C41, http-session-last-accessed-time=1642333643370, kc-category-name=ACCESS, kc-iat=1642333627, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:53300 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:47:23.376  INFO 14 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:47:23.377  INFO 14 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@28e33ae1
2022-01-16 11:47:23.377  INFO 14 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@28e33ae1
2022-01-16 11:47:23.386  INFO 14 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@28e33ae1
2022-01-16 11:47:23.386  INFO 14 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@28e33ae1
2022-01-16 11:47:23.395  INFO 14 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@28e33ae1
2022-01-16 11:47:23.396  WARN 14 --- [https-jsse-nio-7071-exec-4] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:47:23.396  WARN 14 --- [https-jsse-nio-7071-exec-4] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:47:23.396  INFO 14 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@28e33ae1
2022-01-16 11:47:23.397  INFO 14 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@28e33ae1
2022-01-16 11:47:23.397  WARN 14 --- [https-jsse-nio-7071-exec-4] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:47:23.397  WARN 14 --- [https-jsse-nio-7071-exec-4] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:47:23.397  INFO 14 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@28e33ae1
2022-01-16 11:47:23.449  INFO 14 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: emergency-active, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@28e33ae1
2022-01-16 11:47:23.460  INFO 14 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@28e33ae1
2022-01-16 11:47:23.461  INFO 14 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@28e33ae1
2022-01-16 11:47:23.469  INFO 14 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@28e33ae1
2022-01-16 11:47:23.469  INFO 14 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-revoke-extra, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@28e33ae1
2022-01-16 11:47:23.518  INFO 14 --- [https-jsse-nio-7071-exec-4] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18912094477849354-921510, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=Deny}, TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:47:23.518  INFO 14 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=e46f8731-8afd-46e5-8451-44698fb39820, content=DENY, timestamp=1642333643518, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=Deny}, TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:47:23.519  INFO 14 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=142ms, Total=144ms
2022-01-16 11:47:23.538  INFO 14 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=7dd0bdcf-5751-44d3-8d74-3708cda383f0, content=null, timestamp=1642333643533, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=53302, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=4cbbcf975445, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=b07dfbf9-a4f5-4455-8203-a2cec4d67eff, http-req-server-port=80, http-header-accept=*/*, kc-id=6cb35628-1a35-4ce0-a796-86bb2026243f, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642333643531, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQG53NxAH4AEQAAAABh5AW7dAAkNmNiMzU2MjgtMWEzNS00Y2UwLWE3OTYtODZiYjIwMjYyNDNmdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRiMDdkZmJmOS1hNGY1LTQ0NTUtODIwMy1hMmNlYzRkNjdlZmZwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJEdC1tdDI0aWkxQ3VWUnBvbnRqazZNTFA4NFVOZDJDSnVVbTNzQXpGZXVVIn0.eyJleHAiOjE2NDIzMzM5MjcsImlhdCI6MTY0MjMzMzYyNywianRpIjoiNmNiMzU2MjgtMWEzNS00Y2UwLWE3OTYtODZiYjIwMjYyNDNmIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiJiMDdkZmJmOS1hNGY1LTQ0NTUtODIwMy1hMmNlYzRkNjdlZmYiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.LfQC6pOzHJwRKWJa93ShDgM_MdHoxnk9eyFbHPoREooqpMT3SMjbXwdLkCNCA1uopGCigRpu-rVC9ccTKnQlTDgnhvQem_tEjdzsYd5uMdjz4QlUMfilGKUWG6WO3balqXcCrl-G8-mb57iZhC2hQiX9z610oFRxfoiN6aHjOPbc3b5kLm37QHObSimyN-S1yTLGW4ut7qSpExXmOpDwje3DX8jhJWOJP852tpL4ihL6bOf0qaaYNartB524T1ibMy5pfYK7ayKYeVpBgw6f4U2R7IEK9owz6IFXQoP-VTCMEWrV0gnKBWbW0G6tosI4UBcwX_OETTaxyTxc26I4cw, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642333927, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.25.0.10, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=5EE8008A78402C7ED2B4F841B8D5520E, http-session-last-accessed-time=1642333643531, kc-category-name=ACCESS, kc-iat=1642333627, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:53302 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:47:23.538  INFO 14 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:47:23.540  INFO 14 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@24052381
2022-01-16 11:47:23.540  INFO 14 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@24052381
2022-01-16 11:47:23.551  INFO 14 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@24052381
2022-01-16 11:47:23.552  INFO 14 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@24052381
2022-01-16 11:47:23.560  INFO 14 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@24052381
2022-01-16 11:47:23.560  WARN 14 --- [https-jsse-nio-7071-exec-5] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:47:23.560  WARN 14 --- [https-jsse-nio-7071-exec-5] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:47:23.561  INFO 14 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@24052381
2022-01-16 11:47:23.561  INFO 14 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@24052381
2022-01-16 11:47:23.561  WARN 14 --- [https-jsse-nio-7071-exec-5] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:47:23.561  WARN 14 --- [https-jsse-nio-7071-exec-5] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:47:23.561  INFO 14 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@24052381
2022-01-16 11:47:23.613  INFO 14 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: emergency-active, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@24052381
2022-01-16 11:47:23.627  INFO 14 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@24052381
2022-01-16 11:47:23.627  INFO 14 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@24052381
2022-01-16 11:47:23.636  INFO 14 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@24052381
2022-01-16 11:47:23.636  INFO 14 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-revoke-extra, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@24052381
2022-01-16 11:47:23.690  INFO 14 --- [https-jsse-nio-7071-exec-5] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18912094640552234-722519, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=Deny}, TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:47:23.691  INFO 14 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=7dd0bdcf-5751-44d3-8d74-3708cda383f0, content=DENY, timestamp=1642333643691, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=Deny}, TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:47:23.691  INFO 14 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=152ms, Total=154ms
2022-01-16 11:47:23.712  INFO 14 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=701784fc-f18c-4c3a-b71b-147f6a05a873, content=null, timestamp=1642333643704, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=53304, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=4cbbcf975445, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=b07dfbf9-a4f5-4455-8203-a2cec4d67eff, http-req-server-port=80, http-header-accept=*/*, kc-id=6cb35628-1a35-4ce0-a796-86bb2026243f, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642333643703, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQG53NxAH4AEQAAAABh5AW7dAAkNmNiMzU2MjgtMWEzNS00Y2UwLWE3OTYtODZiYjIwMjYyNDNmdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRiMDdkZmJmOS1hNGY1LTQ0NTUtODIwMy1hMmNlYzRkNjdlZmZwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJEdC1tdDI0aWkxQ3VWUnBvbnRqazZNTFA4NFVOZDJDSnVVbTNzQXpGZXVVIn0.eyJleHAiOjE2NDIzMzM5MjcsImlhdCI6MTY0MjMzMzYyNywianRpIjoiNmNiMzU2MjgtMWEzNS00Y2UwLWE3OTYtODZiYjIwMjYyNDNmIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiJiMDdkZmJmOS1hNGY1LTQ0NTUtODIwMy1hMmNlYzRkNjdlZmYiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.LfQC6pOzHJwRKWJa93ShDgM_MdHoxnk9eyFbHPoREooqpMT3SMjbXwdLkCNCA1uopGCigRpu-rVC9ccTKnQlTDgnhvQem_tEjdzsYd5uMdjz4QlUMfilGKUWG6WO3balqXcCrl-G8-mb57iZhC2hQiX9z610oFRxfoiN6aHjOPbc3b5kLm37QHObSimyN-S1yTLGW4ut7qSpExXmOpDwje3DX8jhJWOJP852tpL4ihL6bOf0qaaYNartB524T1ibMy5pfYK7ayKYeVpBgw6f4U2R7IEK9owz6IFXQoP-VTCMEWrV0gnKBWbW0G6tosI4UBcwX_OETTaxyTxc26I4cw, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642333927, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.25.0.10, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=8D0F305781DE071BA6BC58291AE6CBEB, http-session-last-accessed-time=1642333643703, kc-category-name=ACCESS, kc-iat=1642333627, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:53304 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:47:23.712  INFO 14 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:47:23.712  INFO 14 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1645e760
2022-01-16 11:47:23.712  INFO 14 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1645e760
2022-01-16 11:47:23.725  INFO 14 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1645e760
2022-01-16 11:47:23.725  INFO 14 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1645e760
2022-01-16 11:47:23.734  INFO 14 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1645e760
2022-01-16 11:47:23.734  WARN 14 --- [https-jsse-nio-7071-exec-6] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:47:23.734  WARN 14 --- [https-jsse-nio-7071-exec-6] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:47:23.734  INFO 14 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1645e760
2022-01-16 11:47:23.734  INFO 14 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1645e760
2022-01-16 11:47:23.734  WARN 14 --- [https-jsse-nio-7071-exec-6] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:47:23.734  WARN 14 --- [https-jsse-nio-7071-exec-6] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:47:23.734  INFO 14 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1645e760
2022-01-16 11:47:23.785  INFO 14 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: emergency-active, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1645e760
2022-01-16 11:47:23.797  INFO 14 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1645e760
2022-01-16 11:47:23.797  INFO 14 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1645e760
2022-01-16 11:47:23.805  INFO 14 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1645e760
2022-01-16 11:47:23.805  INFO 14 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-revoke-extra, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1645e760
2022-01-16 11:47:23.854  INFO 14 --- [https-jsse-nio-7071-exec-6] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18912094813378116-330694, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=Deny}, TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:47:23.854  INFO 14 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=701784fc-f18c-4c3a-b71b-147f6a05a873, content=DENY, timestamp=1642333643854, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=Deny}, TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:47:23.855  INFO 14 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=142ms, Total=144ms
2022-01-16 11:47:23.872  INFO 14 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=0fa31dbf-c940-460d-88e9-d0f91f7064cc, content=null, timestamp=1642333643866, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=53306, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=4cbbcf975445, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=b07dfbf9-a4f5-4455-8203-a2cec4d67eff, http-req-server-port=80, http-header-accept=*/*, kc-id=6cb35628-1a35-4ce0-a796-86bb2026243f, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642333643864, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQG53NxAH4AEQAAAABh5AW7dAAkNmNiMzU2MjgtMWEzNS00Y2UwLWE3OTYtODZiYjIwMjYyNDNmdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRiMDdkZmJmOS1hNGY1LTQ0NTUtODIwMy1hMmNlYzRkNjdlZmZwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJEdC1tdDI0aWkxQ3VWUnBvbnRqazZNTFA4NFVOZDJDSnVVbTNzQXpGZXVVIn0.eyJleHAiOjE2NDIzMzM5MjcsImlhdCI6MTY0MjMzMzYyNywianRpIjoiNmNiMzU2MjgtMWEzNS00Y2UwLWE3OTYtODZiYjIwMjYyNDNmIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiJiMDdkZmJmOS1hNGY1LTQ0NTUtODIwMy1hMmNlYzRkNjdlZmYiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.LfQC6pOzHJwRKWJa93ShDgM_MdHoxnk9eyFbHPoREooqpMT3SMjbXwdLkCNCA1uopGCigRpu-rVC9ccTKnQlTDgnhvQem_tEjdzsYd5uMdjz4QlUMfilGKUWG6WO3balqXcCrl-G8-mb57iZhC2hQiX9z610oFRxfoiN6aHjOPbc3b5kLm37QHObSimyN-S1yTLGW4ut7qSpExXmOpDwje3DX8jhJWOJP852tpL4ihL6bOf0qaaYNartB524T1ibMy5pfYK7ayKYeVpBgw6f4U2R7IEK9owz6IFXQoP-VTCMEWrV0gnKBWbW0G6tosI4UBcwX_OETTaxyTxc26I4cw, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642333927, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.25.0.10, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=D52CAD42D50A74F15293E4B5692D97D0, http-session-last-accessed-time=1642333643864, kc-category-name=ACCESS, kc-iat=1642333627, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:53306 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:47:23.873  INFO 14 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:47:23.874  INFO 14 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@62531160
2022-01-16 11:47:23.875  INFO 14 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@62531160
2022-01-16 11:47:23.884  INFO 14 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@62531160
2022-01-16 11:47:23.885  INFO 14 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@62531160
2022-01-16 11:47:23.892  INFO 14 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@62531160
2022-01-16 11:47:23.892  WARN 14 --- [https-jsse-nio-7071-exec-7] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:47:23.892  WARN 14 --- [https-jsse-nio-7071-exec-7] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:47:23.892  INFO 14 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@62531160
2022-01-16 11:47:23.892  INFO 14 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@62531160
2022-01-16 11:47:23.893  WARN 14 --- [https-jsse-nio-7071-exec-7] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:47:23.893  WARN 14 --- [https-jsse-nio-7071-exec-7] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:47:23.893  INFO 14 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@62531160
2022-01-16 11:47:23.941  INFO 14 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: emergency-active, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@62531160
2022-01-16 11:47:23.952  INFO 14 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@62531160
2022-01-16 11:47:23.953  INFO 14 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@62531160
2022-01-16 11:47:23.961  INFO 14 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@62531160
2022-01-16 11:47:23.961  INFO 14 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-revoke-extra, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@62531160
2022-01-16 11:47:24.009  INFO 14 --- [https-jsse-nio-7071-exec-7] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18912094974641310-858104, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=Deny}, TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:47:24.009  INFO 14 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=0fa31dbf-c940-460d-88e9-d0f91f7064cc, content=DENY, timestamp=1642333644009, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=Deny}, TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:47:24.010  INFO 14 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=136ms, Total=139ms
2022-01-16 11:47:24.025  INFO 14 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=5f039791-c771-4cc1-bf84-50c760990971, content=null, timestamp=1642333644022, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=53308, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=4cbbcf975445, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=b07dfbf9-a4f5-4455-8203-a2cec4d67eff, http-req-server-port=80, http-header-accept=*/*, kc-id=6cb35628-1a35-4ce0-a796-86bb2026243f, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642333644020, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQG53NxAH4AEQAAAABh5AW7dAAkNmNiMzU2MjgtMWEzNS00Y2UwLWE3OTYtODZiYjIwMjYyNDNmdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRiMDdkZmJmOS1hNGY1LTQ0NTUtODIwMy1hMmNlYzRkNjdlZmZwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJEdC1tdDI0aWkxQ3VWUnBvbnRqazZNTFA4NFVOZDJDSnVVbTNzQXpGZXVVIn0.eyJleHAiOjE2NDIzMzM5MjcsImlhdCI6MTY0MjMzMzYyNywianRpIjoiNmNiMzU2MjgtMWEzNS00Y2UwLWE3OTYtODZiYjIwMjYyNDNmIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiJiMDdkZmJmOS1hNGY1LTQ0NTUtODIwMy1hMmNlYzRkNjdlZmYiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.LfQC6pOzHJwRKWJa93ShDgM_MdHoxnk9eyFbHPoREooqpMT3SMjbXwdLkCNCA1uopGCigRpu-rVC9ccTKnQlTDgnhvQem_tEjdzsYd5uMdjz4QlUMfilGKUWG6WO3balqXcCrl-G8-mb57iZhC2hQiX9z610oFRxfoiN6aHjOPbc3b5kLm37QHObSimyN-S1yTLGW4ut7qSpExXmOpDwje3DX8jhJWOJP852tpL4ihL6bOf0qaaYNartB524T1ibMy5pfYK7ayKYeVpBgw6f4U2R7IEK9owz6IFXQoP-VTCMEWrV0gnKBWbW0G6tosI4UBcwX_OETTaxyTxc26I4cw, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642333927, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.25.0.10, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=6EBA00F6D07555B666317CCDF616D071, http-session-last-accessed-time=1642333644020, kc-category-name=ACCESS, kc-iat=1642333627, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:53308 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:47:24.026  INFO 14 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:47:24.027  INFO 14 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@311f9f6a
2022-01-16 11:47:24.027  INFO 14 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@311f9f6a
2022-01-16 11:47:24.043  INFO 14 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@311f9f6a
2022-01-16 11:47:24.043  INFO 14 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@311f9f6a
2022-01-16 11:47:24.051  INFO 14 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@311f9f6a
2022-01-16 11:47:24.052  WARN 14 --- [https-jsse-nio-7071-exec-8] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:47:24.052  WARN 14 --- [https-jsse-nio-7071-exec-8] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:47:24.052  INFO 14 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@311f9f6a
2022-01-16 11:47:24.052  INFO 14 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@311f9f6a
2022-01-16 11:47:24.053  WARN 14 --- [https-jsse-nio-7071-exec-8] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:47:24.053  WARN 14 --- [https-jsse-nio-7071-exec-8] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:47:24.053  INFO 14 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@311f9f6a
2022-01-16 11:47:24.101  INFO 14 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: emergency-active, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@311f9f6a
2022-01-16 11:47:24.114  INFO 14 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@311f9f6a
2022-01-16 11:47:24.115  INFO 14 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@311f9f6a
2022-01-16 11:47:24.123  INFO 14 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@311f9f6a
2022-01-16 11:47:24.123  INFO 14 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-revoke-extra, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@311f9f6a
2022-01-16 11:47:24.173  INFO 14 --- [https-jsse-nio-7071-exec-8] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18912095127186316-339134, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=Deny}, TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:47:24.174  INFO 14 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=5f039791-c771-4cc1-bf84-50c760990971, content=DENY, timestamp=1642333644173, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=Deny}, TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:47:24.175  INFO 14 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=147ms, Total=150ms
2022-01-16 11:47:24.200  INFO 14 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=87e3f662-deb2-4ebb-bf5a-f864fb473668, content=null, timestamp=1642333644193, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=53310, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=4cbbcf975445, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=b07dfbf9-a4f5-4455-8203-a2cec4d67eff, http-req-server-port=80, http-header-accept=*/*, kc-id=6cb35628-1a35-4ce0-a796-86bb2026243f, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642333644191, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQG53NxAH4AEQAAAABh5AW7dAAkNmNiMzU2MjgtMWEzNS00Y2UwLWE3OTYtODZiYjIwMjYyNDNmdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRiMDdkZmJmOS1hNGY1LTQ0NTUtODIwMy1hMmNlYzRkNjdlZmZwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJEdC1tdDI0aWkxQ3VWUnBvbnRqazZNTFA4NFVOZDJDSnVVbTNzQXpGZXVVIn0.eyJleHAiOjE2NDIzMzM5MjcsImlhdCI6MTY0MjMzMzYyNywianRpIjoiNmNiMzU2MjgtMWEzNS00Y2UwLWE3OTYtODZiYjIwMjYyNDNmIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiJiMDdkZmJmOS1hNGY1LTQ0NTUtODIwMy1hMmNlYzRkNjdlZmYiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.LfQC6pOzHJwRKWJa93ShDgM_MdHoxnk9eyFbHPoREooqpMT3SMjbXwdLkCNCA1uopGCigRpu-rVC9ccTKnQlTDgnhvQem_tEjdzsYd5uMdjz4QlUMfilGKUWG6WO3balqXcCrl-G8-mb57iZhC2hQiX9z610oFRxfoiN6aHjOPbc3b5kLm37QHObSimyN-S1yTLGW4ut7qSpExXmOpDwje3DX8jhJWOJP852tpL4ihL6bOf0qaaYNartB524T1ibMy5pfYK7ayKYeVpBgw6f4U2R7IEK9owz6IFXQoP-VTCMEWrV0gnKBWbW0G6tosI4UBcwX_OETTaxyTxc26I4cw, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642333927, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.25.0.10, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=EFF0C56A4FD0E82CBFBCC9C2A0BEAD59, http-session-last-accessed-time=1642333644191, kc-category-name=ACCESS, kc-iat=1642333627, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:53310 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:47:24.200  INFO 14 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:47:24.200  INFO 14 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@770c42be
2022-01-16 11:47:24.201  INFO 14 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@770c42be
2022-01-16 11:47:24.212  INFO 14 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@770c42be
2022-01-16 11:47:24.212  INFO 14 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@770c42be
2022-01-16 11:47:24.219  INFO 14 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@770c42be
2022-01-16 11:47:24.219  WARN 14 --- [https-jsse-nio-7071-exec-9] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:47:24.219  WARN 14 --- [https-jsse-nio-7071-exec-9] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:47:24.220  INFO 14 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@770c42be
2022-01-16 11:47:24.220  INFO 14 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@770c42be
2022-01-16 11:47:24.220  WARN 14 --- [https-jsse-nio-7071-exec-9] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:47:24.220  WARN 14 --- [https-jsse-nio-7071-exec-9] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:47:24.220  INFO 14 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@770c42be
2022-01-16 11:47:24.269  INFO 14 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: emergency-active, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@770c42be
2022-01-16 11:47:24.283  INFO 14 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@770c42be
2022-01-16 11:47:24.283  INFO 14 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@770c42be
2022-01-16 11:47:24.290  INFO 14 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@770c42be
2022-01-16 11:47:24.290  INFO 14 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-revoke-extra, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@770c42be
2022-01-16 11:47:24.341  INFO 14 --- [https-jsse-nio-7071-exec-9] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18912095301405001-727734, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=Deny}, TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:47:24.341  INFO 14 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=87e3f662-deb2-4ebb-bf5a-f864fb473668, content=DENY, timestamp=1642333644341, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=Deny}, TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:47:24.342  INFO 14 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=141ms, Total=143ms
2022-01-16 11:47:24.355  INFO 14 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=5a218e66-726d-4265-a363-bd9c1256205d, content=null, timestamp=1642333644351, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=53312, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=4cbbcf975445, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=b07dfbf9-a4f5-4455-8203-a2cec4d67eff, http-req-server-port=80, http-header-accept=*/*, kc-id=6cb35628-1a35-4ce0-a796-86bb2026243f, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642333644350, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQG53NxAH4AEQAAAABh5AW7dAAkNmNiMzU2MjgtMWEzNS00Y2UwLWE3OTYtODZiYjIwMjYyNDNmdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRiMDdkZmJmOS1hNGY1LTQ0NTUtODIwMy1hMmNlYzRkNjdlZmZwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJEdC1tdDI0aWkxQ3VWUnBvbnRqazZNTFA4NFVOZDJDSnVVbTNzQXpGZXVVIn0.eyJleHAiOjE2NDIzMzM5MjcsImlhdCI6MTY0MjMzMzYyNywianRpIjoiNmNiMzU2MjgtMWEzNS00Y2UwLWE3OTYtODZiYjIwMjYyNDNmIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiJiMDdkZmJmOS1hNGY1LTQ0NTUtODIwMy1hMmNlYzRkNjdlZmYiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.LfQC6pOzHJwRKWJa93ShDgM_MdHoxnk9eyFbHPoREooqpMT3SMjbXwdLkCNCA1uopGCigRpu-rVC9ccTKnQlTDgnhvQem_tEjdzsYd5uMdjz4QlUMfilGKUWG6WO3balqXcCrl-G8-mb57iZhC2hQiX9z610oFRxfoiN6aHjOPbc3b5kLm37QHObSimyN-S1yTLGW4ut7qSpExXmOpDwje3DX8jhJWOJP852tpL4ihL6bOf0qaaYNartB524T1ibMy5pfYK7ayKYeVpBgw6f4U2R7IEK9owz6IFXQoP-VTCMEWrV0gnKBWbW0G6tosI4UBcwX_OETTaxyTxc26I4cw, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642333927, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.25.0.10, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=29606578F6864AB01D8A615B3037CC0F, http-session-last-accessed-time=1642333644350, kc-category-name=ACCESS, kc-iat=1642333627, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:53312 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:47:24.355  INFO 14 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:47:24.360  INFO 14 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5351640e
2022-01-16 11:47:24.360  INFO 14 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5351640e
2022-01-16 11:47:24.382  INFO 14 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5351640e
2022-01-16 11:47:24.383  INFO 14 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5351640e
2022-01-16 11:47:24.394  INFO 14 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5351640e
2022-01-16 11:47:24.394  WARN 14 --- [https-jsse-nio-7071-exec-9] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:47:24.394  WARN 14 --- [https-jsse-nio-7071-exec-9] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:47:24.394  INFO 14 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5351640e
2022-01-16 11:47:24.394  INFO 14 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5351640e
2022-01-16 11:47:24.394  WARN 14 --- [https-jsse-nio-7071-exec-9] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:47:24.394  WARN 14 --- [https-jsse-nio-7071-exec-9] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:47:24.394  INFO 14 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5351640e
2022-01-16 11:47:24.450  INFO 14 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: emergency-active, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5351640e
2022-01-16 11:47:24.463  INFO 14 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5351640e
2022-01-16 11:47:24.463  INFO 14 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5351640e
2022-01-16 11:47:24.474  INFO 14 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5351640e
2022-01-16 11:47:24.474  INFO 14 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-revoke-extra, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5351640e
2022-01-16 11:47:24.525  INFO 14 --- [https-jsse-nio-7071-exec-9] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18912095456509574-311534, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=Deny}, TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:47:24.525  INFO 14 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=5a218e66-726d-4265-a363-bd9c1256205d, content=DENY, timestamp=1642333644525, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=Deny}, TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:47:24.526  INFO 14 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=170ms, Total=172ms
2022-01-16 11:47:24.541  INFO 14 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=0185adcd-4f37-4609-b37d-85f7c75772a9, content=null, timestamp=1642333644537, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=53314, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=4cbbcf975445, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=b07dfbf9-a4f5-4455-8203-a2cec4d67eff, http-req-server-port=80, http-header-accept=*/*, kc-id=6cb35628-1a35-4ce0-a796-86bb2026243f, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642333644536, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQG53NxAH4AEQAAAABh5AW7dAAkNmNiMzU2MjgtMWEzNS00Y2UwLWE3OTYtODZiYjIwMjYyNDNmdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRiMDdkZmJmOS1hNGY1LTQ0NTUtODIwMy1hMmNlYzRkNjdlZmZwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJEdC1tdDI0aWkxQ3VWUnBvbnRqazZNTFA4NFVOZDJDSnVVbTNzQXpGZXVVIn0.eyJleHAiOjE2NDIzMzM5MjcsImlhdCI6MTY0MjMzMzYyNywianRpIjoiNmNiMzU2MjgtMWEzNS00Y2UwLWE3OTYtODZiYjIwMjYyNDNmIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiJiMDdkZmJmOS1hNGY1LTQ0NTUtODIwMy1hMmNlYzRkNjdlZmYiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.LfQC6pOzHJwRKWJa93ShDgM_MdHoxnk9eyFbHPoREooqpMT3SMjbXwdLkCNCA1uopGCigRpu-rVC9ccTKnQlTDgnhvQem_tEjdzsYd5uMdjz4QlUMfilGKUWG6WO3balqXcCrl-G8-mb57iZhC2hQiX9z610oFRxfoiN6aHjOPbc3b5kLm37QHObSimyN-S1yTLGW4ut7qSpExXmOpDwje3DX8jhJWOJP852tpL4ihL6bOf0qaaYNartB524T1ibMy5pfYK7ayKYeVpBgw6f4U2R7IEK9owz6IFXQoP-VTCMEWrV0gnKBWbW0G6tosI4UBcwX_OETTaxyTxc26I4cw, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642333927, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.25.0.10, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=BA56DEC029FECCA28108C97CA6E8BF4E, http-session-last-accessed-time=1642333644536, kc-category-name=ACCESS, kc-iat=1642333627, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:53314 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:47:24.542  INFO 14 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:47:24.543  INFO 14 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@38010900
2022-01-16 11:47:24.543  INFO 14 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@38010900
2022-01-16 11:47:24.552  INFO 14 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@38010900
2022-01-16 11:47:24.553  INFO 14 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@38010900
2022-01-16 11:47:24.561  INFO 14 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@38010900
2022-01-16 11:47:24.562  WARN 14 --- [https-jsse-nio-7071-exec-10] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:47:24.562  WARN 14 --- [https-jsse-nio-7071-exec-10] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:47:24.562  INFO 14 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@38010900
2022-01-16 11:47:24.562  INFO 14 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@38010900
2022-01-16 11:47:24.563  WARN 14 --- [https-jsse-nio-7071-exec-10] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:47:24.563  WARN 14 --- [https-jsse-nio-7071-exec-10] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:47:24.563  INFO 14 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@38010900
2022-01-16 11:47:24.613  INFO 14 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: emergency-active, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@38010900
2022-01-16 11:47:24.625  INFO 14 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@38010900
2022-01-16 11:47:24.626  INFO 14 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@38010900
2022-01-16 11:47:24.635  INFO 14 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@38010900
2022-01-16 11:47:24.636  INFO 14 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-revoke-extra, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@38010900
2022-01-16 11:47:24.686  INFO 14 --- [https-jsse-nio-7071-exec-10] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18912095643388573-633700, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=Deny}, TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:47:24.686  INFO 14 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=0185adcd-4f37-4609-b37d-85f7c75772a9, content=DENY, timestamp=1642333644686, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=Deny}, TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:47:24.687  INFO 14 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=144ms, Total=147ms
2022-01-16 11:47:24.706  INFO 14 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=e457e6e7-5cd1-4512-ad58-2d3e3900be97, content=null, timestamp=1642333644701, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=53316, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=4cbbcf975445, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=b07dfbf9-a4f5-4455-8203-a2cec4d67eff, http-req-server-port=80, http-header-accept=*/*, kc-id=6cb35628-1a35-4ce0-a796-86bb2026243f, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642333644700, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQG53NxAH4AEQAAAABh5AW7dAAkNmNiMzU2MjgtMWEzNS00Y2UwLWE3OTYtODZiYjIwMjYyNDNmdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRiMDdkZmJmOS1hNGY1LTQ0NTUtODIwMy1hMmNlYzRkNjdlZmZwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJEdC1tdDI0aWkxQ3VWUnBvbnRqazZNTFA4NFVOZDJDSnVVbTNzQXpGZXVVIn0.eyJleHAiOjE2NDIzMzM5MjcsImlhdCI6MTY0MjMzMzYyNywianRpIjoiNmNiMzU2MjgtMWEzNS00Y2UwLWE3OTYtODZiYjIwMjYyNDNmIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiJiMDdkZmJmOS1hNGY1LTQ0NTUtODIwMy1hMmNlYzRkNjdlZmYiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.LfQC6pOzHJwRKWJa93ShDgM_MdHoxnk9eyFbHPoREooqpMT3SMjbXwdLkCNCA1uopGCigRpu-rVC9ccTKnQlTDgnhvQem_tEjdzsYd5uMdjz4QlUMfilGKUWG6WO3balqXcCrl-G8-mb57iZhC2hQiX9z610oFRxfoiN6aHjOPbc3b5kLm37QHObSimyN-S1yTLGW4ut7qSpExXmOpDwje3DX8jhJWOJP852tpL4ihL6bOf0qaaYNartB524T1ibMy5pfYK7ayKYeVpBgw6f4U2R7IEK9owz6IFXQoP-VTCMEWrV0gnKBWbW0G6tosI4UBcwX_OETTaxyTxc26I4cw, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642333927, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.25.0.10, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=801170DBA38A284C1F22C32A8AE276B1, http-session-last-accessed-time=1642333644700, kc-category-name=ACCESS, kc-iat=1642333627, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:53316 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:47:24.706  INFO 14 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:47:24.707  INFO 14 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@192a7ae1
2022-01-16 11:47:24.707  INFO 14 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@192a7ae1
2022-01-16 11:47:24.716  INFO 14 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@192a7ae1
2022-01-16 11:47:24.717  INFO 14 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@192a7ae1
2022-01-16 11:47:24.725  INFO 14 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@192a7ae1
2022-01-16 11:47:24.725  WARN 14 --- [https-jsse-nio-7071-exec-1] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:47:24.725  WARN 14 --- [https-jsse-nio-7071-exec-1] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:47:24.725  INFO 14 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@192a7ae1
2022-01-16 11:47:24.726  INFO 14 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@192a7ae1
2022-01-16 11:47:24.726  WARN 14 --- [https-jsse-nio-7071-exec-1] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:47:24.727  WARN 14 --- [https-jsse-nio-7071-exec-1] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:47:24.727  INFO 14 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@192a7ae1
2022-01-16 11:47:24.777  INFO 14 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: emergency-active, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@192a7ae1
2022-01-16 11:47:24.789  INFO 14 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@192a7ae1
2022-01-16 11:47:24.789  INFO 14 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@192a7ae1
2022-01-16 11:47:24.802  INFO 14 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@192a7ae1
2022-01-16 11:47:24.802  INFO 14 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-revoke-extra, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@192a7ae1
2022-01-16 11:47:24.858  INFO 14 --- [https-jsse-nio-7071-exec-1] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18912095807922978-128119, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=Deny}, TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:47:24.858  INFO 14 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=e457e6e7-5cd1-4512-ad58-2d3e3900be97, content=DENY, timestamp=1642333644858, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=Deny}, TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:47:24.859  INFO 14 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=152ms, Total=154ms
2022-01-16 11:47:24.881  INFO 14 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=4c0c27f4-27f9-4fe1-9dda-c5489d81253d, content=null, timestamp=1642333644877, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=53318, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=4cbbcf975445, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=b07dfbf9-a4f5-4455-8203-a2cec4d67eff, http-req-server-port=80, http-header-accept=*/*, kc-id=6cb35628-1a35-4ce0-a796-86bb2026243f, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642333644875, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQG53NxAH4AEQAAAABh5AW7dAAkNmNiMzU2MjgtMWEzNS00Y2UwLWE3OTYtODZiYjIwMjYyNDNmdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRiMDdkZmJmOS1hNGY1LTQ0NTUtODIwMy1hMmNlYzRkNjdlZmZwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJEdC1tdDI0aWkxQ3VWUnBvbnRqazZNTFA4NFVOZDJDSnVVbTNzQXpGZXVVIn0.eyJleHAiOjE2NDIzMzM5MjcsImlhdCI6MTY0MjMzMzYyNywianRpIjoiNmNiMzU2MjgtMWEzNS00Y2UwLWE3OTYtODZiYjIwMjYyNDNmIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiJiMDdkZmJmOS1hNGY1LTQ0NTUtODIwMy1hMmNlYzRkNjdlZmYiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.LfQC6pOzHJwRKWJa93ShDgM_MdHoxnk9eyFbHPoREooqpMT3SMjbXwdLkCNCA1uopGCigRpu-rVC9ccTKnQlTDgnhvQem_tEjdzsYd5uMdjz4QlUMfilGKUWG6WO3balqXcCrl-G8-mb57iZhC2hQiX9z610oFRxfoiN6aHjOPbc3b5kLm37QHObSimyN-S1yTLGW4ut7qSpExXmOpDwje3DX8jhJWOJP852tpL4ihL6bOf0qaaYNartB524T1ibMy5pfYK7ayKYeVpBgw6f4U2R7IEK9owz6IFXQoP-VTCMEWrV0gnKBWbW0G6tosI4UBcwX_OETTaxyTxc26I4cw, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642333927, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.25.0.10, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=0D673914AE7EB45332B29B6C97F70D15, http-session-last-accessed-time=1642333644875, kc-category-name=ACCESS, kc-iat=1642333627, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:53318 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:47:24.882  INFO 14 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:47:24.883  INFO 14 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@114a3ccc
2022-01-16 11:47:24.883  INFO 14 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@114a3ccc
2022-01-16 11:47:24.893  INFO 14 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@114a3ccc
2022-01-16 11:47:24.893  INFO 14 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@114a3ccc
2022-01-16 11:47:24.901  INFO 14 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@114a3ccc
2022-01-16 11:47:24.901  WARN 14 --- [https-jsse-nio-7071-exec-2] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:47:24.901  WARN 14 --- [https-jsse-nio-7071-exec-2] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:47:24.901  INFO 14 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@114a3ccc
2022-01-16 11:47:24.901  INFO 14 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@114a3ccc
2022-01-16 11:47:24.901  WARN 14 --- [https-jsse-nio-7071-exec-2] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:47:24.901  WARN 14 --- [https-jsse-nio-7071-exec-2] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:47:24.901  INFO 14 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@114a3ccc
2022-01-16 11:47:24.953  INFO 14 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: emergency-active, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@114a3ccc
2022-01-16 11:47:24.965  INFO 14 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@114a3ccc
2022-01-16 11:47:24.965  INFO 14 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@114a3ccc
2022-01-16 11:47:24.975  INFO 14 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@114a3ccc
2022-01-16 11:47:24.976  INFO 14 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-revoke-extra, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@114a3ccc
2022-01-16 11:47:25.030  INFO 14 --- [https-jsse-nio-7071-exec-2] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18912095983578236-598357, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=Deny}, TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:47:25.030  INFO 14 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=4c0c27f4-27f9-4fe1-9dda-c5489d81253d, content=DENY, timestamp=1642333645030, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=Deny}, TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:47:25.031  INFO 14 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=148ms, Total=151ms
2022-01-16 11:47:25.052  INFO 14 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=53c67965-94a5-4cf0-b1ef-1077c0558c72, content=null, timestamp=1642333645046, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=53320, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=4cbbcf975445, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=b07dfbf9-a4f5-4455-8203-a2cec4d67eff, http-req-server-port=80, http-header-accept=*/*, kc-id=6cb35628-1a35-4ce0-a796-86bb2026243f, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642333645044, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQG53NxAH4AEQAAAABh5AW7dAAkNmNiMzU2MjgtMWEzNS00Y2UwLWE3OTYtODZiYjIwMjYyNDNmdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRiMDdkZmJmOS1hNGY1LTQ0NTUtODIwMy1hMmNlYzRkNjdlZmZwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJEdC1tdDI0aWkxQ3VWUnBvbnRqazZNTFA4NFVOZDJDSnVVbTNzQXpGZXVVIn0.eyJleHAiOjE2NDIzMzM5MjcsImlhdCI6MTY0MjMzMzYyNywianRpIjoiNmNiMzU2MjgtMWEzNS00Y2UwLWE3OTYtODZiYjIwMjYyNDNmIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiJiMDdkZmJmOS1hNGY1LTQ0NTUtODIwMy1hMmNlYzRkNjdlZmYiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.LfQC6pOzHJwRKWJa93ShDgM_MdHoxnk9eyFbHPoREooqpMT3SMjbXwdLkCNCA1uopGCigRpu-rVC9ccTKnQlTDgnhvQem_tEjdzsYd5uMdjz4QlUMfilGKUWG6WO3balqXcCrl-G8-mb57iZhC2hQiX9z610oFRxfoiN6aHjOPbc3b5kLm37QHObSimyN-S1yTLGW4ut7qSpExXmOpDwje3DX8jhJWOJP852tpL4ihL6bOf0qaaYNartB524T1ibMy5pfYK7ayKYeVpBgw6f4U2R7IEK9owz6IFXQoP-VTCMEWrV0gnKBWbW0G6tosI4UBcwX_OETTaxyTxc26I4cw, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642333927, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.25.0.10, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=4DB74A90773FFDA18C4311F6C3185DCC, http-session-last-accessed-time=1642333645044, kc-category-name=ACCESS, kc-iat=1642333627, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:53320 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:47:25.052  INFO 14 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:47:25.052  INFO 14 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@162db871
2022-01-16 11:47:25.053  INFO 14 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@162db871
2022-01-16 11:47:25.062  INFO 14 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@162db871
2022-01-16 11:47:25.063  INFO 14 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@162db871
2022-01-16 11:47:25.077  INFO 14 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@162db871
2022-01-16 11:47:25.077  WARN 14 --- [https-jsse-nio-7071-exec-3] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:47:25.077  WARN 14 --- [https-jsse-nio-7071-exec-3] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:47:25.077  INFO 14 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@162db871
2022-01-16 11:47:25.077  INFO 14 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@162db871
2022-01-16 11:47:25.077  WARN 14 --- [https-jsse-nio-7071-exec-3] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:47:25.077  WARN 14 --- [https-jsse-nio-7071-exec-3] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:47:25.077  INFO 14 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@162db871
2022-01-16 11:47:25.129  INFO 14 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: emergency-active, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@162db871
2022-01-16 11:47:25.144  INFO 14 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@162db871
2022-01-16 11:47:25.144  INFO 14 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@162db871
2022-01-16 11:47:25.152  INFO 14 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@162db871
2022-01-16 11:47:25.152  INFO 14 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-revoke-extra, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@162db871
2022-01-16 11:47:25.202  INFO 14 --- [https-jsse-nio-7071-exec-3] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18912096153557639-337642, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=Deny}, TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:47:25.202  INFO 14 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=53c67965-94a5-4cf0-b1ef-1077c0558c72, content=DENY, timestamp=1642333645202, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=Deny}, TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:47:25.202  INFO 14 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=150ms, Total=151ms
2022-01-16 11:47:25.218  INFO 14 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=ef86fe4c-2d02-4818-9dea-a891ab8ca742, content=null, timestamp=1642333645214, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=53322, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=4cbbcf975445, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=b07dfbf9-a4f5-4455-8203-a2cec4d67eff, http-req-server-port=80, http-header-accept=*/*, kc-id=6cb35628-1a35-4ce0-a796-86bb2026243f, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642333645213, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQG53NxAH4AEQAAAABh5AW7dAAkNmNiMzU2MjgtMWEzNS00Y2UwLWE3OTYtODZiYjIwMjYyNDNmdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRiMDdkZmJmOS1hNGY1LTQ0NTUtODIwMy1hMmNlYzRkNjdlZmZwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJEdC1tdDI0aWkxQ3VWUnBvbnRqazZNTFA4NFVOZDJDSnVVbTNzQXpGZXVVIn0.eyJleHAiOjE2NDIzMzM5MjcsImlhdCI6MTY0MjMzMzYyNywianRpIjoiNmNiMzU2MjgtMWEzNS00Y2UwLWE3OTYtODZiYjIwMjYyNDNmIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiJiMDdkZmJmOS1hNGY1LTQ0NTUtODIwMy1hMmNlYzRkNjdlZmYiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.LfQC6pOzHJwRKWJa93ShDgM_MdHoxnk9eyFbHPoREooqpMT3SMjbXwdLkCNCA1uopGCigRpu-rVC9ccTKnQlTDgnhvQem_tEjdzsYd5uMdjz4QlUMfilGKUWG6WO3balqXcCrl-G8-mb57iZhC2hQiX9z610oFRxfoiN6aHjOPbc3b5kLm37QHObSimyN-S1yTLGW4ut7qSpExXmOpDwje3DX8jhJWOJP852tpL4ihL6bOf0qaaYNartB524T1ibMy5pfYK7ayKYeVpBgw6f4U2R7IEK9owz6IFXQoP-VTCMEWrV0gnKBWbW0G6tosI4UBcwX_OETTaxyTxc26I4cw, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642333927, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.25.0.10, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=48DBFAD6D3FCD5022992A79EC172CA2D, http-session-last-accessed-time=1642333645213, kc-category-name=ACCESS, kc-iat=1642333627, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:53322 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:47:25.218  INFO 14 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:47:25.219  INFO 14 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@590d5d95
2022-01-16 11:47:25.219  INFO 14 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@590d5d95
2022-01-16 11:47:25.229  INFO 14 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@590d5d95
2022-01-16 11:47:25.229  INFO 14 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@590d5d95
2022-01-16 11:47:25.237  INFO 14 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@590d5d95
2022-01-16 11:47:25.237  WARN 14 --- [https-jsse-nio-7071-exec-4] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:47:25.237  WARN 14 --- [https-jsse-nio-7071-exec-4] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:47:25.238  INFO 14 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@590d5d95
2022-01-16 11:47:25.238  INFO 14 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@590d5d95
2022-01-16 11:47:25.238  WARN 14 --- [https-jsse-nio-7071-exec-4] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:47:25.239  WARN 14 --- [https-jsse-nio-7071-exec-4] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:47:25.239  INFO 14 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@590d5d95
2022-01-16 11:47:25.289  INFO 14 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: emergency-active, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@590d5d95
2022-01-16 11:47:25.305  INFO 14 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@590d5d95
2022-01-16 11:47:25.305  INFO 14 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@590d5d95
2022-01-16 11:47:25.314  INFO 14 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@590d5d95
2022-01-16 11:47:25.314  INFO 14 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-revoke-extra, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@590d5d95
2022-01-16 11:47:25.366  INFO 14 --- [https-jsse-nio-7071-exec-4] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18912096320052755-540952, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=Deny}, TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:47:25.366  INFO 14 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=ef86fe4c-2d02-4818-9dea-a891ab8ca742, content=DENY, timestamp=1642333645366, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=Deny}, TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:47:25.367  INFO 14 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=147ms, Total=150ms
2022-01-16 11:47:25.390  INFO 14 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=23be4e20-e0d4-4007-bb54-328f63c86a3d, content=null, timestamp=1642333645382, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=53324, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=4cbbcf975445, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=b07dfbf9-a4f5-4455-8203-a2cec4d67eff, http-req-server-port=80, http-header-accept=*/*, kc-id=6cb35628-1a35-4ce0-a796-86bb2026243f, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642333645381, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQG53NxAH4AEQAAAABh5AW7dAAkNmNiMzU2MjgtMWEzNS00Y2UwLWE3OTYtODZiYjIwMjYyNDNmdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRiMDdkZmJmOS1hNGY1LTQ0NTUtODIwMy1hMmNlYzRkNjdlZmZwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJEdC1tdDI0aWkxQ3VWUnBvbnRqazZNTFA4NFVOZDJDSnVVbTNzQXpGZXVVIn0.eyJleHAiOjE2NDIzMzM5MjcsImlhdCI6MTY0MjMzMzYyNywianRpIjoiNmNiMzU2MjgtMWEzNS00Y2UwLWE3OTYtODZiYjIwMjYyNDNmIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiJiMDdkZmJmOS1hNGY1LTQ0NTUtODIwMy1hMmNlYzRkNjdlZmYiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.LfQC6pOzHJwRKWJa93ShDgM_MdHoxnk9eyFbHPoREooqpMT3SMjbXwdLkCNCA1uopGCigRpu-rVC9ccTKnQlTDgnhvQem_tEjdzsYd5uMdjz4QlUMfilGKUWG6WO3balqXcCrl-G8-mb57iZhC2hQiX9z610oFRxfoiN6aHjOPbc3b5kLm37QHObSimyN-S1yTLGW4ut7qSpExXmOpDwje3DX8jhJWOJP852tpL4ihL6bOf0qaaYNartB524T1ibMy5pfYK7ayKYeVpBgw6f4U2R7IEK9owz6IFXQoP-VTCMEWrV0gnKBWbW0G6tosI4UBcwX_OETTaxyTxc26I4cw, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642333927, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.25.0.10, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=7BE5CC9446206B1CFBF284CD73AC8BD1, http-session-last-accessed-time=1642333645381, kc-category-name=ACCESS, kc-iat=1642333627, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:53324 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:47:25.390  INFO 14 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:47:25.391  INFO 14 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@717b194d
2022-01-16 11:47:25.391  INFO 14 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@717b194d
2022-01-16 11:47:25.402  INFO 14 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@717b194d
2022-01-16 11:47:25.402  INFO 14 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@717b194d
2022-01-16 11:47:25.413  INFO 14 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@717b194d
2022-01-16 11:47:25.413  WARN 14 --- [https-jsse-nio-7071-exec-5] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:47:25.413  WARN 14 --- [https-jsse-nio-7071-exec-5] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:47:25.414  INFO 14 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@717b194d
2022-01-16 11:47:25.414  INFO 14 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@717b194d
2022-01-16 11:47:25.414  WARN 14 --- [https-jsse-nio-7071-exec-5] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:47:25.414  WARN 14 --- [https-jsse-nio-7071-exec-5] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:47:25.414  INFO 14 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@717b194d
2022-01-16 11:47:25.465  INFO 14 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: emergency-active, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@717b194d
2022-01-16 11:47:25.473  INFO 14 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@717b194d
2022-01-16 11:47:25.473  INFO 14 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@717b194d
2022-01-16 11:47:25.481  INFO 14 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@717b194d
2022-01-16 11:47:25.481  INFO 14 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-revoke-extra, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@717b194d
2022-01-16 11:47:25.541  INFO 14 --- [https-jsse-nio-7071-exec-5] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18912096491836779-475233, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=Deny}, TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:47:25.541  INFO 14 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=23be4e20-e0d4-4007-bb54-328f63c86a3d, content=DENY, timestamp=1642333645541, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=Deny}, TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:47:25.541  INFO 14 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=151ms, Total=155ms
2022-01-16 11:47:25.557  INFO 14 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=1be9bef4-6d26-42e3-9cf6-6f69c711442b, content=null, timestamp=1642333645552, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=53326, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=4cbbcf975445, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=b07dfbf9-a4f5-4455-8203-a2cec4d67eff, http-req-server-port=80, http-header-accept=*/*, kc-id=6cb35628-1a35-4ce0-a796-86bb2026243f, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642333645550, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQG53NxAH4AEQAAAABh5AW7dAAkNmNiMzU2MjgtMWEzNS00Y2UwLWE3OTYtODZiYjIwMjYyNDNmdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRiMDdkZmJmOS1hNGY1LTQ0NTUtODIwMy1hMmNlYzRkNjdlZmZwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJEdC1tdDI0aWkxQ3VWUnBvbnRqazZNTFA4NFVOZDJDSnVVbTNzQXpGZXVVIn0.eyJleHAiOjE2NDIzMzM5MjcsImlhdCI6MTY0MjMzMzYyNywianRpIjoiNmNiMzU2MjgtMWEzNS00Y2UwLWE3OTYtODZiYjIwMjYyNDNmIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiJiMDdkZmJmOS1hNGY1LTQ0NTUtODIwMy1hMmNlYzRkNjdlZmYiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.LfQC6pOzHJwRKWJa93ShDgM_MdHoxnk9eyFbHPoREooqpMT3SMjbXwdLkCNCA1uopGCigRpu-rVC9ccTKnQlTDgnhvQem_tEjdzsYd5uMdjz4QlUMfilGKUWG6WO3balqXcCrl-G8-mb57iZhC2hQiX9z610oFRxfoiN6aHjOPbc3b5kLm37QHObSimyN-S1yTLGW4ut7qSpExXmOpDwje3DX8jhJWOJP852tpL4ihL6bOf0qaaYNartB524T1ibMy5pfYK7ayKYeVpBgw6f4U2R7IEK9owz6IFXQoP-VTCMEWrV0gnKBWbW0G6tosI4UBcwX_OETTaxyTxc26I4cw, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642333927, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.25.0.10, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=2F6F2B68AF1E2471FECDCF24EC6B7403, http-session-last-accessed-time=1642333645550, kc-category-name=ACCESS, kc-iat=1642333627, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:53326 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:47:25.557  INFO 14 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:47:25.558  INFO 14 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@18f48d69
2022-01-16 11:47:25.558  INFO 14 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@18f48d69
2022-01-16 11:47:25.569  INFO 14 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@18f48d69
2022-01-16 11:47:25.569  INFO 14 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@18f48d69
2022-01-16 11:47:25.587  INFO 14 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@18f48d69
2022-01-16 11:47:25.588  WARN 14 --- [https-jsse-nio-7071-exec-6] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:47:25.588  WARN 14 --- [https-jsse-nio-7071-exec-6] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:47:25.588  INFO 14 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@18f48d69
2022-01-16 11:47:25.589  INFO 14 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@18f48d69
2022-01-16 11:47:25.589  WARN 14 --- [https-jsse-nio-7071-exec-6] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:47:25.589  WARN 14 --- [https-jsse-nio-7071-exec-6] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:47:25.589  INFO 14 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@18f48d69
2022-01-16 11:47:25.637  INFO 14 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: emergency-active, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@18f48d69
2022-01-16 11:47:25.648  INFO 14 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@18f48d69
2022-01-16 11:47:25.649  INFO 14 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@18f48d69
2022-01-16 11:47:25.657  INFO 14 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@18f48d69
2022-01-16 11:47:25.657  INFO 14 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-revoke-extra, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@18f48d69
2022-01-16 11:47:25.709  INFO 14 --- [https-jsse-nio-7071-exec-6] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18912096658444904-988140, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=Deny}, TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:47:25.710  INFO 14 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=1be9bef4-6d26-42e3-9cf6-6f69c711442b, content=DENY, timestamp=1642333645710, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=Deny}, TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:47:25.710  INFO 14 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=153ms, Total=154ms
2022-01-16 11:47:25.735  INFO 14 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=174b7d84-987a-4806-9e9d-7511d7637a62, content=null, timestamp=1642333645731, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=53328, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=4cbbcf975445, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=b07dfbf9-a4f5-4455-8203-a2cec4d67eff, http-req-server-port=80, http-header-accept=*/*, kc-id=6cb35628-1a35-4ce0-a796-86bb2026243f, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642333645730, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQG53NxAH4AEQAAAABh5AW7dAAkNmNiMzU2MjgtMWEzNS00Y2UwLWE3OTYtODZiYjIwMjYyNDNmdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRiMDdkZmJmOS1hNGY1LTQ0NTUtODIwMy1hMmNlYzRkNjdlZmZwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJEdC1tdDI0aWkxQ3VWUnBvbnRqazZNTFA4NFVOZDJDSnVVbTNzQXpGZXVVIn0.eyJleHAiOjE2NDIzMzM5MjcsImlhdCI6MTY0MjMzMzYyNywianRpIjoiNmNiMzU2MjgtMWEzNS00Y2UwLWE3OTYtODZiYjIwMjYyNDNmIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiJiMDdkZmJmOS1hNGY1LTQ0NTUtODIwMy1hMmNlYzRkNjdlZmYiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.LfQC6pOzHJwRKWJa93ShDgM_MdHoxnk9eyFbHPoREooqpMT3SMjbXwdLkCNCA1uopGCigRpu-rVC9ccTKnQlTDgnhvQem_tEjdzsYd5uMdjz4QlUMfilGKUWG6WO3balqXcCrl-G8-mb57iZhC2hQiX9z610oFRxfoiN6aHjOPbc3b5kLm37QHObSimyN-S1yTLGW4ut7qSpExXmOpDwje3DX8jhJWOJP852tpL4ihL6bOf0qaaYNartB524T1ibMy5pfYK7ayKYeVpBgw6f4U2R7IEK9owz6IFXQoP-VTCMEWrV0gnKBWbW0G6tosI4UBcwX_OETTaxyTxc26I4cw, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642333927, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.25.0.10, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=7FCFB12ABE099A35F2FA71220F437843, http-session-last-accessed-time=1642333645730, kc-category-name=ACCESS, kc-iat=1642333627, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:53328 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:47:25.735  INFO 14 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:47:25.736  INFO 14 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@38d74a37
2022-01-16 11:47:25.736  INFO 14 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@38d74a37
2022-01-16 11:47:25.744  INFO 14 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@38d74a37
2022-01-16 11:47:25.745  INFO 14 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@38d74a37
2022-01-16 11:47:25.755  INFO 14 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@38d74a37
2022-01-16 11:47:25.756  WARN 14 --- [https-jsse-nio-7071-exec-7] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:47:25.756  WARN 14 --- [https-jsse-nio-7071-exec-7] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:47:25.756  INFO 14 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@38d74a37
2022-01-16 11:47:25.757  INFO 14 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@38d74a37
2022-01-16 11:47:25.757  WARN 14 --- [https-jsse-nio-7071-exec-7] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:47:25.758  WARN 14 --- [https-jsse-nio-7071-exec-7] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:47:25.758  INFO 14 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@38d74a37
2022-01-16 11:47:25.813  INFO 14 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: emergency-active, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@38d74a37
2022-01-16 11:47:25.825  INFO 14 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@38d74a37
2022-01-16 11:47:25.825  INFO 14 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@38d74a37
2022-01-16 11:47:25.835  INFO 14 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@38d74a37
2022-01-16 11:47:25.835  INFO 14 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-revoke-extra, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@38d74a37
2022-01-16 11:47:25.893  INFO 14 --- [https-jsse-nio-7071-exec-7] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18912096836634614-674285, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=Deny}, TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:47:25.894  INFO 14 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=174b7d84-987a-4806-9e9d-7511d7637a62, content=DENY, timestamp=1642333645894, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=Deny}, TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:47:25.894  INFO 14 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=159ms, Total=160ms
2022-01-16 11:47:25.915  INFO 14 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=9c7d42c9-1de6-46d8-926c-14ae9f577ed3, content=null, timestamp=1642333645906, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=53330, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=4cbbcf975445, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=b07dfbf9-a4f5-4455-8203-a2cec4d67eff, http-req-server-port=80, http-header-accept=*/*, kc-id=6cb35628-1a35-4ce0-a796-86bb2026243f, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642333645905, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQG53NxAH4AEQAAAABh5AW7dAAkNmNiMzU2MjgtMWEzNS00Y2UwLWE3OTYtODZiYjIwMjYyNDNmdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRiMDdkZmJmOS1hNGY1LTQ0NTUtODIwMy1hMmNlYzRkNjdlZmZwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJEdC1tdDI0aWkxQ3VWUnBvbnRqazZNTFA4NFVOZDJDSnVVbTNzQXpGZXVVIn0.eyJleHAiOjE2NDIzMzM5MjcsImlhdCI6MTY0MjMzMzYyNywianRpIjoiNmNiMzU2MjgtMWEzNS00Y2UwLWE3OTYtODZiYjIwMjYyNDNmIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiJiMDdkZmJmOS1hNGY1LTQ0NTUtODIwMy1hMmNlYzRkNjdlZmYiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.LfQC6pOzHJwRKWJa93ShDgM_MdHoxnk9eyFbHPoREooqpMT3SMjbXwdLkCNCA1uopGCigRpu-rVC9ccTKnQlTDgnhvQem_tEjdzsYd5uMdjz4QlUMfilGKUWG6WO3balqXcCrl-G8-mb57iZhC2hQiX9z610oFRxfoiN6aHjOPbc3b5kLm37QHObSimyN-S1yTLGW4ut7qSpExXmOpDwje3DX8jhJWOJP852tpL4ihL6bOf0qaaYNartB524T1ibMy5pfYK7ayKYeVpBgw6f4U2R7IEK9owz6IFXQoP-VTCMEWrV0gnKBWbW0G6tosI4UBcwX_OETTaxyTxc26I4cw, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642333927, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.25.0.10, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=38ED547A3C356FF05221280B66D1AE22, http-session-last-accessed-time=1642333645905, kc-category-name=ACCESS, kc-iat=1642333627, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:53330 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:47:25.915  INFO 14 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:47:25.916  INFO 14 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@75a20f8e
2022-01-16 11:47:25.916  INFO 14 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@75a20f8e
2022-01-16 11:47:25.927  INFO 14 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@75a20f8e
2022-01-16 11:47:25.927  INFO 14 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@75a20f8e
2022-01-16 11:47:25.938  INFO 14 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@75a20f8e
2022-01-16 11:47:25.939  WARN 14 --- [https-jsse-nio-7071-exec-8] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:47:25.939  WARN 14 --- [https-jsse-nio-7071-exec-8] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:47:25.939  INFO 14 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@75a20f8e
2022-01-16 11:47:25.939  INFO 14 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@75a20f8e
2022-01-16 11:47:25.939  WARN 14 --- [https-jsse-nio-7071-exec-8] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:47:25.940  WARN 14 --- [https-jsse-nio-7071-exec-8] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:47:25.940  INFO 14 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@75a20f8e
2022-01-16 11:47:25.993  INFO 14 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: emergency-active, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@75a20f8e
2022-01-16 11:47:26.004  INFO 14 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@75a20f8e
2022-01-16 11:47:26.005  INFO 14 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@75a20f8e
2022-01-16 11:47:26.015  INFO 14 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@75a20f8e
2022-01-16 11:47:26.015  INFO 14 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-revoke-extra, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@75a20f8e
2022-01-16 11:47:26.073  INFO 14 --- [https-jsse-nio-7071-exec-8] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18912097016756148-103768, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=Deny}, TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:47:26.073  INFO 14 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=9c7d42c9-1de6-46d8-926c-14ae9f577ed3, content=DENY, timestamp=1642333646073, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=Deny}, TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:47:26.074  INFO 14 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=158ms, Total=160ms
2022-01-16 11:47:26.104  INFO 14 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=9e37f91c-dba1-4a17-b990-ee3dde452f69, content=null, timestamp=1642333646099, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=53332, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=4cbbcf975445, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=b07dfbf9-a4f5-4455-8203-a2cec4d67eff, http-req-server-port=80, http-header-accept=*/*, kc-id=6cb35628-1a35-4ce0-a796-86bb2026243f, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642333646097, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQG53NxAH4AEQAAAABh5AW7dAAkNmNiMzU2MjgtMWEzNS00Y2UwLWE3OTYtODZiYjIwMjYyNDNmdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRiMDdkZmJmOS1hNGY1LTQ0NTUtODIwMy1hMmNlYzRkNjdlZmZwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJEdC1tdDI0aWkxQ3VWUnBvbnRqazZNTFA4NFVOZDJDSnVVbTNzQXpGZXVVIn0.eyJleHAiOjE2NDIzMzM5MjcsImlhdCI6MTY0MjMzMzYyNywianRpIjoiNmNiMzU2MjgtMWEzNS00Y2UwLWE3OTYtODZiYjIwMjYyNDNmIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiJiMDdkZmJmOS1hNGY1LTQ0NTUtODIwMy1hMmNlYzRkNjdlZmYiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.LfQC6pOzHJwRKWJa93ShDgM_MdHoxnk9eyFbHPoREooqpMT3SMjbXwdLkCNCA1uopGCigRpu-rVC9ccTKnQlTDgnhvQem_tEjdzsYd5uMdjz4QlUMfilGKUWG6WO3balqXcCrl-G8-mb57iZhC2hQiX9z610oFRxfoiN6aHjOPbc3b5kLm37QHObSimyN-S1yTLGW4ut7qSpExXmOpDwje3DX8jhJWOJP852tpL4ihL6bOf0qaaYNartB524T1ibMy5pfYK7ayKYeVpBgw6f4U2R7IEK9owz6IFXQoP-VTCMEWrV0gnKBWbW0G6tosI4UBcwX_OETTaxyTxc26I4cw, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642333927, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.25.0.10, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=F0A5555B96A8EE0BAF287EF06F8E7FAE, http-session-last-accessed-time=1642333646097, kc-category-name=ACCESS, kc-iat=1642333627, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:53332 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:47:26.104  INFO 14 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:47:26.104  INFO 14 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7b2e0f6
2022-01-16 11:47:26.104  INFO 14 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7b2e0f6
2022-01-16 11:47:26.114  INFO 14 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7b2e0f6
2022-01-16 11:47:26.114  INFO 14 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7b2e0f6
2022-01-16 11:47:26.123  INFO 14 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7b2e0f6
2022-01-16 11:47:26.123  WARN 14 --- [https-jsse-nio-7071-exec-9] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:47:26.123  WARN 14 --- [https-jsse-nio-7071-exec-9] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:47:26.123  INFO 14 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7b2e0f6
2022-01-16 11:47:26.123  INFO 14 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7b2e0f6
2022-01-16 11:47:26.123  WARN 14 --- [https-jsse-nio-7071-exec-9] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:47:26.123  WARN 14 --- [https-jsse-nio-7071-exec-9] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:47:26.123  INFO 14 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7b2e0f6
2022-01-16 11:47:26.173  INFO 14 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: emergency-active, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7b2e0f6
2022-01-16 11:47:26.185  INFO 14 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7b2e0f6
2022-01-16 11:47:26.185  INFO 14 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7b2e0f6
2022-01-16 11:47:26.193  INFO 14 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7b2e0f6
2022-01-16 11:47:26.193  INFO 14 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-revoke-extra, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7b2e0f6
2022-01-16 11:47:26.242  INFO 14 --- [https-jsse-nio-7071-exec-9] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18912097205521528-553904, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=Deny}, TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:47:26.242  INFO 14 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=9e37f91c-dba1-4a17-b990-ee3dde452f69, content=DENY, timestamp=1642333646242, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=Deny}, TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:47:26.242  INFO 14 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=138ms, Total=139ms
2022-01-16 11:47:26.257  INFO 14 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=a3e2214e-34bb-48db-a9c4-61e5cd653d05, content=null, timestamp=1642333646253, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=53334, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=4cbbcf975445, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=b07dfbf9-a4f5-4455-8203-a2cec4d67eff, http-req-server-port=80, http-header-accept=*/*, kc-id=6cb35628-1a35-4ce0-a796-86bb2026243f, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642333646252, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQG53NxAH4AEQAAAABh5AW7dAAkNmNiMzU2MjgtMWEzNS00Y2UwLWE3OTYtODZiYjIwMjYyNDNmdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRiMDdkZmJmOS1hNGY1LTQ0NTUtODIwMy1hMmNlYzRkNjdlZmZwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJEdC1tdDI0aWkxQ3VWUnBvbnRqazZNTFA4NFVOZDJDSnVVbTNzQXpGZXVVIn0.eyJleHAiOjE2NDIzMzM5MjcsImlhdCI6MTY0MjMzMzYyNywianRpIjoiNmNiMzU2MjgtMWEzNS00Y2UwLWE3OTYtODZiYjIwMjYyNDNmIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiJiMDdkZmJmOS1hNGY1LTQ0NTUtODIwMy1hMmNlYzRkNjdlZmYiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.LfQC6pOzHJwRKWJa93ShDgM_MdHoxnk9eyFbHPoREooqpMT3SMjbXwdLkCNCA1uopGCigRpu-rVC9ccTKnQlTDgnhvQem_tEjdzsYd5uMdjz4QlUMfilGKUWG6WO3balqXcCrl-G8-mb57iZhC2hQiX9z610oFRxfoiN6aHjOPbc3b5kLm37QHObSimyN-S1yTLGW4ut7qSpExXmOpDwje3DX8jhJWOJP852tpL4ihL6bOf0qaaYNartB524T1ibMy5pfYK7ayKYeVpBgw6f4U2R7IEK9owz6IFXQoP-VTCMEWrV0gnKBWbW0G6tosI4UBcwX_OETTaxyTxc26I4cw, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642333927, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.25.0.10, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=A51897B1AA31125AE8E21D3E2A0399E2, http-session-last-accessed-time=1642333646252, kc-category-name=ACCESS, kc-iat=1642333627, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:53334 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:47:26.257  INFO 14 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:47:26.258  INFO 14 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@64e3c241
2022-01-16 11:47:26.258  INFO 14 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@64e3c241
2022-01-16 11:47:26.268  INFO 14 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@64e3c241
2022-01-16 11:47:26.268  INFO 14 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@64e3c241
2022-01-16 11:47:26.279  INFO 14 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@64e3c241
2022-01-16 11:47:26.279  WARN 14 --- [https-jsse-nio-7071-exec-10] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:47:26.279  WARN 14 --- [https-jsse-nio-7071-exec-10] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:47:26.280  INFO 14 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@64e3c241
2022-01-16 11:47:26.280  INFO 14 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@64e3c241
2022-01-16 11:47:26.280  WARN 14 --- [https-jsse-nio-7071-exec-10] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:47:26.281  WARN 14 --- [https-jsse-nio-7071-exec-10] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:47:26.281  INFO 14 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@64e3c241
2022-01-16 11:47:26.337  INFO 14 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: emergency-active, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@64e3c241
2022-01-16 11:47:26.346  INFO 14 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@64e3c241
2022-01-16 11:47:26.347  INFO 14 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@64e3c241
2022-01-16 11:47:26.355  INFO 14 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@64e3c241
2022-01-16 11:47:26.356  INFO 14 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-revoke-extra, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@64e3c241
2022-01-16 11:47:26.405  INFO 14 --- [https-jsse-nio-7071-exec-10] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18912097358730937-321578, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=Deny}, TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:47:26.406  INFO 14 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=a3e2214e-34bb-48db-a9c4-61e5cd653d05, content=DENY, timestamp=1642333646406, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=Deny}, TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:47:26.406  INFO 14 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=149ms, Total=150ms
2022-01-16 11:47:26.425  INFO 14 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=e4272f6d-5c91-40f6-ba9f-f9e597389a56, content=null, timestamp=1642333646420, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=53336, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=4cbbcf975445, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=b07dfbf9-a4f5-4455-8203-a2cec4d67eff, http-req-server-port=80, http-header-accept=*/*, kc-id=6cb35628-1a35-4ce0-a796-86bb2026243f, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642333646419, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQG53NxAH4AEQAAAABh5AW7dAAkNmNiMzU2MjgtMWEzNS00Y2UwLWE3OTYtODZiYjIwMjYyNDNmdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRiMDdkZmJmOS1hNGY1LTQ0NTUtODIwMy1hMmNlYzRkNjdlZmZwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJEdC1tdDI0aWkxQ3VWUnBvbnRqazZNTFA4NFVOZDJDSnVVbTNzQXpGZXVVIn0.eyJleHAiOjE2NDIzMzM5MjcsImlhdCI6MTY0MjMzMzYyNywianRpIjoiNmNiMzU2MjgtMWEzNS00Y2UwLWE3OTYtODZiYjIwMjYyNDNmIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiJiMDdkZmJmOS1hNGY1LTQ0NTUtODIwMy1hMmNlYzRkNjdlZmYiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.LfQC6pOzHJwRKWJa93ShDgM_MdHoxnk9eyFbHPoREooqpMT3SMjbXwdLkCNCA1uopGCigRpu-rVC9ccTKnQlTDgnhvQem_tEjdzsYd5uMdjz4QlUMfilGKUWG6WO3balqXcCrl-G8-mb57iZhC2hQiX9z610oFRxfoiN6aHjOPbc3b5kLm37QHObSimyN-S1yTLGW4ut7qSpExXmOpDwje3DX8jhJWOJP852tpL4ihL6bOf0qaaYNartB524T1ibMy5pfYK7ayKYeVpBgw6f4U2R7IEK9owz6IFXQoP-VTCMEWrV0gnKBWbW0G6tosI4UBcwX_OETTaxyTxc26I4cw, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642333927, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.25.0.10, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=B4E4B1AB8D86291F6D89F6D9A6A17E8C, http-session-last-accessed-time=1642333646419, kc-category-name=ACCESS, kc-iat=1642333627, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:53336 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:47:26.425  INFO 14 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:47:26.426  INFO 14 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3c42bcce
2022-01-16 11:47:26.426  INFO 14 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3c42bcce
2022-01-16 11:47:26.436  INFO 14 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3c42bcce
2022-01-16 11:47:26.437  INFO 14 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3c42bcce
2022-01-16 11:47:26.445  INFO 14 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3c42bcce
2022-01-16 11:47:26.445  WARN 14 --- [https-jsse-nio-7071-exec-1] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:47:26.445  WARN 14 --- [https-jsse-nio-7071-exec-1] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:47:26.445  INFO 14 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3c42bcce
2022-01-16 11:47:26.446  INFO 14 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3c42bcce
2022-01-16 11:47:26.446  WARN 14 --- [https-jsse-nio-7071-exec-1] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:47:26.446  WARN 14 --- [https-jsse-nio-7071-exec-1] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:47:26.447  INFO 14 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3c42bcce
2022-01-16 11:47:26.497  INFO 14 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: emergency-active, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3c42bcce
2022-01-16 11:47:26.512  INFO 14 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3c42bcce
2022-01-16 11:47:26.512  INFO 14 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3c42bcce
2022-01-16 11:47:26.521  INFO 14 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3c42bcce
2022-01-16 11:47:26.521  INFO 14 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-revoke-extra, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3c42bcce
2022-01-16 11:47:26.574  INFO 14 --- [https-jsse-nio-7071-exec-1] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18912097526543916-871868, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=Deny}, TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:47:26.574  INFO 14 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=e4272f6d-5c91-40f6-ba9f-f9e597389a56, content=DENY, timestamp=1642333646574, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=Deny}, TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:47:26.575  INFO 14 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=149ms, Total=151ms
2022-01-16 11:47:26.600  INFO 14 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=0487a90d-7ed8-432d-b8f4-dfe4d7383cb1, content=null, timestamp=1642333646594, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=53338, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=4cbbcf975445, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=b07dfbf9-a4f5-4455-8203-a2cec4d67eff, http-req-server-port=80, http-header-accept=*/*, kc-id=6cb35628-1a35-4ce0-a796-86bb2026243f, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642333646592, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQG53NxAH4AEQAAAABh5AW7dAAkNmNiMzU2MjgtMWEzNS00Y2UwLWE3OTYtODZiYjIwMjYyNDNmdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRiMDdkZmJmOS1hNGY1LTQ0NTUtODIwMy1hMmNlYzRkNjdlZmZwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJEdC1tdDI0aWkxQ3VWUnBvbnRqazZNTFA4NFVOZDJDSnVVbTNzQXpGZXVVIn0.eyJleHAiOjE2NDIzMzM5MjcsImlhdCI6MTY0MjMzMzYyNywianRpIjoiNmNiMzU2MjgtMWEzNS00Y2UwLWE3OTYtODZiYjIwMjYyNDNmIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiJiMDdkZmJmOS1hNGY1LTQ0NTUtODIwMy1hMmNlYzRkNjdlZmYiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.LfQC6pOzHJwRKWJa93ShDgM_MdHoxnk9eyFbHPoREooqpMT3SMjbXwdLkCNCA1uopGCigRpu-rVC9ccTKnQlTDgnhvQem_tEjdzsYd5uMdjz4QlUMfilGKUWG6WO3balqXcCrl-G8-mb57iZhC2hQiX9z610oFRxfoiN6aHjOPbc3b5kLm37QHObSimyN-S1yTLGW4ut7qSpExXmOpDwje3DX8jhJWOJP852tpL4ihL6bOf0qaaYNartB524T1ibMy5pfYK7ayKYeVpBgw6f4U2R7IEK9owz6IFXQoP-VTCMEWrV0gnKBWbW0G6tosI4UBcwX_OETTaxyTxc26I4cw, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642333927, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.25.0.10, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=FBF59198D7C81F40F74E9C6AA4CDCE80, http-session-last-accessed-time=1642333646592, kc-category-name=ACCESS, kc-iat=1642333627, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:53338 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:47:26.601  INFO 14 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:47:26.602  INFO 14 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@19d82f0f
2022-01-16 11:47:26.602  INFO 14 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@19d82f0f
2022-01-16 11:47:26.620  INFO 14 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@19d82f0f
2022-01-16 11:47:26.620  INFO 14 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@19d82f0f
2022-01-16 11:47:26.632  INFO 14 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@19d82f0f
2022-01-16 11:47:26.632  WARN 14 --- [https-jsse-nio-7071-exec-2] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:47:26.632  WARN 14 --- [https-jsse-nio-7071-exec-2] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:47:26.632  INFO 14 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@19d82f0f
2022-01-16 11:47:26.633  INFO 14 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@19d82f0f
2022-01-16 11:47:26.633  WARN 14 --- [https-jsse-nio-7071-exec-2] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:47:26.633  WARN 14 --- [https-jsse-nio-7071-exec-2] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:47:26.633  INFO 14 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@19d82f0f
2022-01-16 11:47:26.693  INFO 14 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: emergency-active, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@19d82f0f
2022-01-16 11:47:26.702  INFO 14 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@19d82f0f
2022-01-16 11:47:26.703  INFO 14 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@19d82f0f
2022-01-16 11:47:26.711  INFO 14 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@19d82f0f
2022-01-16 11:47:26.711  INFO 14 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-revoke-extra, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@19d82f0f
2022-01-16 11:47:26.761  INFO 14 --- [https-jsse-nio-7071-exec-2] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18912097702142518-780909, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=Deny}, TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:47:26.762  INFO 14 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=0487a90d-7ed8-432d-b8f4-dfe4d7383cb1, content=DENY, timestamp=1642333646762, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=Deny}, TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:47:26.762  INFO 14 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=161ms, Total=162ms
2022-01-16 11:47:26.779  INFO 14 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=b3c28eab-778d-4180-993e-8d105b23ce2c, content=null, timestamp=1642333646774, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=53340, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=4cbbcf975445, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=b07dfbf9-a4f5-4455-8203-a2cec4d67eff, http-req-server-port=80, http-header-accept=*/*, kc-id=6cb35628-1a35-4ce0-a796-86bb2026243f, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642333646773, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQG53NxAH4AEQAAAABh5AW7dAAkNmNiMzU2MjgtMWEzNS00Y2UwLWE3OTYtODZiYjIwMjYyNDNmdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRiMDdkZmJmOS1hNGY1LTQ0NTUtODIwMy1hMmNlYzRkNjdlZmZwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJEdC1tdDI0aWkxQ3VWUnBvbnRqazZNTFA4NFVOZDJDSnVVbTNzQXpGZXVVIn0.eyJleHAiOjE2NDIzMzM5MjcsImlhdCI6MTY0MjMzMzYyNywianRpIjoiNmNiMzU2MjgtMWEzNS00Y2UwLWE3OTYtODZiYjIwMjYyNDNmIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiJiMDdkZmJmOS1hNGY1LTQ0NTUtODIwMy1hMmNlYzRkNjdlZmYiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.LfQC6pOzHJwRKWJa93ShDgM_MdHoxnk9eyFbHPoREooqpMT3SMjbXwdLkCNCA1uopGCigRpu-rVC9ccTKnQlTDgnhvQem_tEjdzsYd5uMdjz4QlUMfilGKUWG6WO3balqXcCrl-G8-mb57iZhC2hQiX9z610oFRxfoiN6aHjOPbc3b5kLm37QHObSimyN-S1yTLGW4ut7qSpExXmOpDwje3DX8jhJWOJP852tpL4ihL6bOf0qaaYNartB524T1ibMy5pfYK7ayKYeVpBgw6f4U2R7IEK9owz6IFXQoP-VTCMEWrV0gnKBWbW0G6tosI4UBcwX_OETTaxyTxc26I4cw, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642333927, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.25.0.10, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=B6A91009FA75344F77AA1A87CDEF78B4, http-session-last-accessed-time=1642333646773, kc-category-name=ACCESS, kc-iat=1642333627, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:53340 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:47:26.779  INFO 14 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:47:26.780  INFO 14 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@35f09dd5
2022-01-16 11:47:26.780  INFO 14 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@35f09dd5
2022-01-16 11:47:26.789  INFO 14 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@35f09dd5
2022-01-16 11:47:26.789  INFO 14 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@35f09dd5
2022-01-16 11:47:26.796  INFO 14 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@35f09dd5
2022-01-16 11:47:26.796  WARN 14 --- [https-jsse-nio-7071-exec-3] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:47:26.797  WARN 14 --- [https-jsse-nio-7071-exec-3] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:47:26.797  INFO 14 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@35f09dd5
2022-01-16 11:47:26.797  INFO 14 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@35f09dd5
2022-01-16 11:47:26.797  WARN 14 --- [https-jsse-nio-7071-exec-3] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:47:26.797  WARN 14 --- [https-jsse-nio-7071-exec-3] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:47:26.797  INFO 14 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@35f09dd5
2022-01-16 11:47:26.845  INFO 14 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: emergency-active, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@35f09dd5
2022-01-16 11:47:26.868  INFO 14 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@35f09dd5
2022-01-16 11:47:26.869  INFO 14 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@35f09dd5
2022-01-16 11:47:26.882  INFO 14 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@35f09dd5
2022-01-16 11:47:26.883  INFO 14 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-revoke-extra, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@35f09dd5
2022-01-16 11:47:26.933  INFO 14 --- [https-jsse-nio-7071-exec-3] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18912097880591272-641469, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=Deny}, TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:47:26.934  INFO 14 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=b3c28eab-778d-4180-993e-8d105b23ce2c, content=DENY, timestamp=1642333646934, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=Deny}, TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:47:26.934  INFO 14 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=155ms, Total=156ms
2022-01-16 11:47:26.984  INFO 14 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=8f2df5a5-ee2b-4e8b-a08c-645363f640e5, content=null, timestamp=1642333646948, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=53342, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=4cbbcf975445, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=b07dfbf9-a4f5-4455-8203-a2cec4d67eff, http-req-server-port=80, http-header-accept=*/*, kc-id=6cb35628-1a35-4ce0-a796-86bb2026243f, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642333646947, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQG53NxAH4AEQAAAABh5AW7dAAkNmNiMzU2MjgtMWEzNS00Y2UwLWE3OTYtODZiYjIwMjYyNDNmdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRiMDdkZmJmOS1hNGY1LTQ0NTUtODIwMy1hMmNlYzRkNjdlZmZwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJEdC1tdDI0aWkxQ3VWUnBvbnRqazZNTFA4NFVOZDJDSnVVbTNzQXpGZXVVIn0.eyJleHAiOjE2NDIzMzM5MjcsImlhdCI6MTY0MjMzMzYyNywianRpIjoiNmNiMzU2MjgtMWEzNS00Y2UwLWE3OTYtODZiYjIwMjYyNDNmIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiJiMDdkZmJmOS1hNGY1LTQ0NTUtODIwMy1hMmNlYzRkNjdlZmYiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.LfQC6pOzHJwRKWJa93ShDgM_MdHoxnk9eyFbHPoREooqpMT3SMjbXwdLkCNCA1uopGCigRpu-rVC9ccTKnQlTDgnhvQem_tEjdzsYd5uMdjz4QlUMfilGKUWG6WO3balqXcCrl-G8-mb57iZhC2hQiX9z610oFRxfoiN6aHjOPbc3b5kLm37QHObSimyN-S1yTLGW4ut7qSpExXmOpDwje3DX8jhJWOJP852tpL4ihL6bOf0qaaYNartB524T1ibMy5pfYK7ayKYeVpBgw6f4U2R7IEK9owz6IFXQoP-VTCMEWrV0gnKBWbW0G6tosI4UBcwX_OETTaxyTxc26I4cw, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642333927, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.25.0.10, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=81401578AB7A45AED6616DAB6E32F4AA, http-session-last-accessed-time=1642333646947, kc-category-name=ACCESS, kc-iat=1642333627, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:53342 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:47:26.985  INFO 14 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:47:26.985  INFO 14 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7c8c005a
2022-01-16 11:47:26.986  INFO 14 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7c8c005a
2022-01-16 11:47:26.995  INFO 14 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7c8c005a
2022-01-16 11:47:26.995  INFO 14 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7c8c005a
2022-01-16 11:47:27.005  INFO 14 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7c8c005a
2022-01-16 11:47:27.005  WARN 14 --- [https-jsse-nio-7071-exec-7] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:47:27.006  WARN 14 --- [https-jsse-nio-7071-exec-7] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:47:27.006  INFO 14 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7c8c005a
2022-01-16 11:47:27.006  INFO 14 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7c8c005a
2022-01-16 11:47:27.006  WARN 14 --- [https-jsse-nio-7071-exec-7] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:47:27.006  WARN 14 --- [https-jsse-nio-7071-exec-7] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:47:27.006  INFO 14 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7c8c005a
2022-01-16 11:47:27.061  INFO 14 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: emergency-active, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7c8c005a
2022-01-16 11:47:27.072  INFO 14 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7c8c005a
2022-01-16 11:47:27.072  INFO 14 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7c8c005a
2022-01-16 11:47:27.079  INFO 14 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7c8c005a
2022-01-16 11:47:27.080  INFO 14 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-revoke-extra, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7c8c005a
2022-01-16 11:47:27.129  INFO 14 --- [https-jsse-nio-7071-exec-7] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18912098086461350-214407, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=Deny}, TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:47:27.130  INFO 14 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=8f2df5a5-ee2b-4e8b-a08c-645363f640e5, content=DENY, timestamp=1642333647130, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=Deny}, TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:47:27.130  INFO 14 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=145ms, Total=146ms
2022-01-16 11:47:27.149  INFO 14 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=ebb49419-0cfe-41cf-a414-a6df7d1ddcbb, content=null, timestamp=1642333647143, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=53346, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=4cbbcf975445, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=b07dfbf9-a4f5-4455-8203-a2cec4d67eff, http-req-server-port=80, http-header-accept=*/*, kc-id=6cb35628-1a35-4ce0-a796-86bb2026243f, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642333647142, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQG53NxAH4AEQAAAABh5AW7dAAkNmNiMzU2MjgtMWEzNS00Y2UwLWE3OTYtODZiYjIwMjYyNDNmdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRiMDdkZmJmOS1hNGY1LTQ0NTUtODIwMy1hMmNlYzRkNjdlZmZwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJEdC1tdDI0aWkxQ3VWUnBvbnRqazZNTFA4NFVOZDJDSnVVbTNzQXpGZXVVIn0.eyJleHAiOjE2NDIzMzM5MjcsImlhdCI6MTY0MjMzMzYyNywianRpIjoiNmNiMzU2MjgtMWEzNS00Y2UwLWE3OTYtODZiYjIwMjYyNDNmIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiJiMDdkZmJmOS1hNGY1LTQ0NTUtODIwMy1hMmNlYzRkNjdlZmYiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.LfQC6pOzHJwRKWJa93ShDgM_MdHoxnk9eyFbHPoREooqpMT3SMjbXwdLkCNCA1uopGCigRpu-rVC9ccTKnQlTDgnhvQem_tEjdzsYd5uMdjz4QlUMfilGKUWG6WO3balqXcCrl-G8-mb57iZhC2hQiX9z610oFRxfoiN6aHjOPbc3b5kLm37QHObSimyN-S1yTLGW4ut7qSpExXmOpDwje3DX8jhJWOJP852tpL4ihL6bOf0qaaYNartB524T1ibMy5pfYK7ayKYeVpBgw6f4U2R7IEK9owz6IFXQoP-VTCMEWrV0gnKBWbW0G6tosI4UBcwX_OETTaxyTxc26I4cw, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642333927, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.25.0.10, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=71A55DC9821C1E77535614CB270C79FB, http-session-last-accessed-time=1642333647142, kc-category-name=ACCESS, kc-iat=1642333627, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:53346 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:47:27.150  INFO 14 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:47:27.150  INFO 14 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@57480e81
2022-01-16 11:47:27.151  INFO 14 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@57480e81
2022-01-16 11:47:27.161  INFO 14 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@57480e81
2022-01-16 11:47:27.162  INFO 14 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@57480e81
2022-01-16 11:47:27.175  INFO 14 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@57480e81
2022-01-16 11:47:27.175  WARN 14 --- [https-jsse-nio-7071-exec-8] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:47:27.175  WARN 14 --- [https-jsse-nio-7071-exec-8] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:47:27.176  INFO 14 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@57480e81
2022-01-16 11:47:27.176  INFO 14 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@57480e81
2022-01-16 11:47:27.176  WARN 14 --- [https-jsse-nio-7071-exec-8] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:47:27.176  WARN 14 --- [https-jsse-nio-7071-exec-8] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:47:27.176  INFO 14 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@57480e81
2022-01-16 11:47:27.229  INFO 14 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: emergency-active, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@57480e81
2022-01-16 11:47:27.238  INFO 14 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@57480e81
2022-01-16 11:47:27.238  INFO 14 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@57480e81
2022-01-16 11:47:27.246  INFO 14 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@57480e81
2022-01-16 11:47:27.246  INFO 14 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-revoke-extra, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@57480e81
2022-01-16 11:47:27.297  INFO 14 --- [https-jsse-nio-7071-exec-8] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18912098251392216-816102, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=Deny}, TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:47:27.298  INFO 14 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=ebb49419-0cfe-41cf-a414-a6df7d1ddcbb, content=DENY, timestamp=1642333647298, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=Deny}, TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:47:27.298  INFO 14 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=148ms, Total=149ms
2022-01-16 11:47:27.320  INFO 14 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=8265281d-03ac-46f9-a45a-ed31b1153a8d, content=null, timestamp=1642333647312, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=53348, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=4cbbcf975445, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=b07dfbf9-a4f5-4455-8203-a2cec4d67eff, http-req-server-port=80, http-header-accept=*/*, kc-id=6cb35628-1a35-4ce0-a796-86bb2026243f, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642333647311, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQG53NxAH4AEQAAAABh5AW7dAAkNmNiMzU2MjgtMWEzNS00Y2UwLWE3OTYtODZiYjIwMjYyNDNmdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRiMDdkZmJmOS1hNGY1LTQ0NTUtODIwMy1hMmNlYzRkNjdlZmZwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJEdC1tdDI0aWkxQ3VWUnBvbnRqazZNTFA4NFVOZDJDSnVVbTNzQXpGZXVVIn0.eyJleHAiOjE2NDIzMzM5MjcsImlhdCI6MTY0MjMzMzYyNywianRpIjoiNmNiMzU2MjgtMWEzNS00Y2UwLWE3OTYtODZiYjIwMjYyNDNmIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiJiMDdkZmJmOS1hNGY1LTQ0NTUtODIwMy1hMmNlYzRkNjdlZmYiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.LfQC6pOzHJwRKWJa93ShDgM_MdHoxnk9eyFbHPoREooqpMT3SMjbXwdLkCNCA1uopGCigRpu-rVC9ccTKnQlTDgnhvQem_tEjdzsYd5uMdjz4QlUMfilGKUWG6WO3balqXcCrl-G8-mb57iZhC2hQiX9z610oFRxfoiN6aHjOPbc3b5kLm37QHObSimyN-S1yTLGW4ut7qSpExXmOpDwje3DX8jhJWOJP852tpL4ihL6bOf0qaaYNartB524T1ibMy5pfYK7ayKYeVpBgw6f4U2R7IEK9owz6IFXQoP-VTCMEWrV0gnKBWbW0G6tosI4UBcwX_OETTaxyTxc26I4cw, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642333927, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.25.0.10, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=3F5671D7532225F49EC3B34E0F963EC7, http-session-last-accessed-time=1642333647311, kc-category-name=ACCESS, kc-iat=1642333627, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:53348 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:47:27.321  INFO 14 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:47:27.330  INFO 14 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@38282066
2022-01-16 11:47:27.330  INFO 14 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@38282066
2022-01-16 11:47:27.341  INFO 14 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@38282066
2022-01-16 11:47:27.341  INFO 14 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@38282066
2022-01-16 11:47:27.349  INFO 14 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@38282066
2022-01-16 11:47:27.349  WARN 14 --- [https-jsse-nio-7071-exec-9] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:47:27.350  WARN 14 --- [https-jsse-nio-7071-exec-9] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:47:27.350  INFO 14 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@38282066
2022-01-16 11:47:27.350  INFO 14 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@38282066
2022-01-16 11:47:27.351  WARN 14 --- [https-jsse-nio-7071-exec-9] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:47:27.351  WARN 14 --- [https-jsse-nio-7071-exec-9] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:47:27.351  INFO 14 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@38282066
2022-01-16 11:47:27.401  INFO 14 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: emergency-active, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@38282066
2022-01-16 11:47:27.417  INFO 14 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@38282066
2022-01-16 11:47:27.417  INFO 14 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@38282066
2022-01-16 11:47:27.426  INFO 14 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@38282066
2022-01-16 11:47:27.427  INFO 14 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-revoke-extra, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@38282066
2022-01-16 11:47:27.478  INFO 14 --- [https-jsse-nio-7071-exec-9] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18912098430550300-610601, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=Deny}, TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:47:27.478  INFO 14 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=8265281d-03ac-46f9-a45a-ed31b1153a8d, content=DENY, timestamp=1642333647478, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=Deny}, TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:47:27.479  INFO 14 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=149ms, Total=161ms
2022-01-16 11:47:27.497  INFO 14 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=c7ee3564-3352-48a0-8922-21cfc8c98920, content=null, timestamp=1642333647493, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=53350, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=4cbbcf975445, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=b07dfbf9-a4f5-4455-8203-a2cec4d67eff, http-req-server-port=80, http-header-accept=*/*, kc-id=6cb35628-1a35-4ce0-a796-86bb2026243f, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642333647492, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQG53NxAH4AEQAAAABh5AW7dAAkNmNiMzU2MjgtMWEzNS00Y2UwLWE3OTYtODZiYjIwMjYyNDNmdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRiMDdkZmJmOS1hNGY1LTQ0NTUtODIwMy1hMmNlYzRkNjdlZmZwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJEdC1tdDI0aWkxQ3VWUnBvbnRqazZNTFA4NFVOZDJDSnVVbTNzQXpGZXVVIn0.eyJleHAiOjE2NDIzMzM5MjcsImlhdCI6MTY0MjMzMzYyNywianRpIjoiNmNiMzU2MjgtMWEzNS00Y2UwLWE3OTYtODZiYjIwMjYyNDNmIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiJiMDdkZmJmOS1hNGY1LTQ0NTUtODIwMy1hMmNlYzRkNjdlZmYiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.LfQC6pOzHJwRKWJa93ShDgM_MdHoxnk9eyFbHPoREooqpMT3SMjbXwdLkCNCA1uopGCigRpu-rVC9ccTKnQlTDgnhvQem_tEjdzsYd5uMdjz4QlUMfilGKUWG6WO3balqXcCrl-G8-mb57iZhC2hQiX9z610oFRxfoiN6aHjOPbc3b5kLm37QHObSimyN-S1yTLGW4ut7qSpExXmOpDwje3DX8jhJWOJP852tpL4ihL6bOf0qaaYNartB524T1ibMy5pfYK7ayKYeVpBgw6f4U2R7IEK9owz6IFXQoP-VTCMEWrV0gnKBWbW0G6tosI4UBcwX_OETTaxyTxc26I4cw, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642333927, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.25.0.10, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=7198FC5C8C8D4712FA4693DE683AF54B, http-session-last-accessed-time=1642333647492, kc-category-name=ACCESS, kc-iat=1642333627, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:53350 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:47:27.497  INFO 14 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:47:27.498  INFO 14 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2d346b76
2022-01-16 11:47:27.498  INFO 14 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2d346b76
2022-01-16 11:47:27.508  INFO 14 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2d346b76
2022-01-16 11:47:27.508  INFO 14 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2d346b76
2022-01-16 11:47:27.516  INFO 14 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2d346b76
2022-01-16 11:47:27.516  WARN 14 --- [https-jsse-nio-7071-exec-10] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:47:27.516  WARN 14 --- [https-jsse-nio-7071-exec-10] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:47:27.516  INFO 14 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2d346b76
2022-01-16 11:47:27.516  INFO 14 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2d346b76
2022-01-16 11:47:27.516  WARN 14 --- [https-jsse-nio-7071-exec-10] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:47:27.517  WARN 14 --- [https-jsse-nio-7071-exec-10] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:47:27.517  INFO 14 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2d346b76
2022-01-16 11:47:27.565  INFO 14 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: emergency-active, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2d346b76
2022-01-16 11:47:27.572  INFO 14 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2d346b76
2022-01-16 11:47:27.573  INFO 14 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2d346b76
2022-01-16 11:47:27.580  INFO 14 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2d346b76
2022-01-16 11:47:27.581  INFO 14 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-revoke-extra, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2d346b76
2022-01-16 11:47:27.634  INFO 14 --- [https-jsse-nio-7071-exec-10] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18912098598806519-448257, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=Deny}, TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:47:27.634  INFO 14 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=c7ee3564-3352-48a0-8922-21cfc8c98920, content=DENY, timestamp=1642333647634, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=Deny}, TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:47:27.635  INFO 14 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=137ms, Total=139ms
2022-01-16 11:47:27.652  INFO 14 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=02cd8b68-0014-4921-956c-36ef729f03f7, content=null, timestamp=1642333647648, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=53352, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=4cbbcf975445, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=b07dfbf9-a4f5-4455-8203-a2cec4d67eff, http-req-server-port=80, http-header-accept=*/*, kc-id=6cb35628-1a35-4ce0-a796-86bb2026243f, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642333647647, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQG53NxAH4AEQAAAABh5AW7dAAkNmNiMzU2MjgtMWEzNS00Y2UwLWE3OTYtODZiYjIwMjYyNDNmdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRiMDdkZmJmOS1hNGY1LTQ0NTUtODIwMy1hMmNlYzRkNjdlZmZwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJEdC1tdDI0aWkxQ3VWUnBvbnRqazZNTFA4NFVOZDJDSnVVbTNzQXpGZXVVIn0.eyJleHAiOjE2NDIzMzM5MjcsImlhdCI6MTY0MjMzMzYyNywianRpIjoiNmNiMzU2MjgtMWEzNS00Y2UwLWE3OTYtODZiYjIwMjYyNDNmIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiJiMDdkZmJmOS1hNGY1LTQ0NTUtODIwMy1hMmNlYzRkNjdlZmYiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.LfQC6pOzHJwRKWJa93ShDgM_MdHoxnk9eyFbHPoREooqpMT3SMjbXwdLkCNCA1uopGCigRpu-rVC9ccTKnQlTDgnhvQem_tEjdzsYd5uMdjz4QlUMfilGKUWG6WO3balqXcCrl-G8-mb57iZhC2hQiX9z610oFRxfoiN6aHjOPbc3b5kLm37QHObSimyN-S1yTLGW4ut7qSpExXmOpDwje3DX8jhJWOJP852tpL4ihL6bOf0qaaYNartB524T1ibMy5pfYK7ayKYeVpBgw6f4U2R7IEK9owz6IFXQoP-VTCMEWrV0gnKBWbW0G6tosI4UBcwX_OETTaxyTxc26I4cw, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642333927, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.25.0.10, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=2BF9EF01E8458360EEF532BF919CD494, http-session-last-accessed-time=1642333647647, kc-category-name=ACCESS, kc-iat=1642333627, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:53352 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:47:27.653  INFO 14 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:47:27.653  INFO 14 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@189dadc7
2022-01-16 11:47:27.653  INFO 14 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@189dadc7
2022-01-16 11:47:27.663  INFO 14 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@189dadc7
2022-01-16 11:47:27.663  INFO 14 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@189dadc7
2022-01-16 11:47:27.670  INFO 14 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@189dadc7
2022-01-16 11:47:27.670  WARN 14 --- [https-jsse-nio-7071-exec-1] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:47:27.670  WARN 14 --- [https-jsse-nio-7071-exec-1] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:47:27.670  INFO 14 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@189dadc7
2022-01-16 11:47:27.670  INFO 14 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@189dadc7
2022-01-16 11:47:27.670  WARN 14 --- [https-jsse-nio-7071-exec-1] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:47:27.670  WARN 14 --- [https-jsse-nio-7071-exec-1] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:47:27.670  INFO 14 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@189dadc7
2022-01-16 11:47:27.721  INFO 14 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: emergency-active, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@189dadc7
2022-01-16 11:47:27.730  INFO 14 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@189dadc7
2022-01-16 11:47:27.730  INFO 14 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@189dadc7
2022-01-16 11:47:27.739  INFO 14 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@189dadc7
2022-01-16 11:47:27.739  INFO 14 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-revoke-extra, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@189dadc7
2022-01-16 11:47:27.790  INFO 14 --- [https-jsse-nio-7071-exec-1] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18912098754075934-393455, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=Deny}, TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:47:27.790  INFO 14 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=02cd8b68-0014-4921-956c-36ef729f03f7, content=DENY, timestamp=1642333647790, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=Deny}, TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:47:27.790  INFO 14 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=137ms, Total=138ms
2022-01-16 11:47:27.807  INFO 14 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=0e21e117-a10c-45ab-a2e2-24971b78f287, content=null, timestamp=1642333647801, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=53354, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=4cbbcf975445, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=b07dfbf9-a4f5-4455-8203-a2cec4d67eff, http-req-server-port=80, http-header-accept=*/*, kc-id=6cb35628-1a35-4ce0-a796-86bb2026243f, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642333647800, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQG53NxAH4AEQAAAABh5AW7dAAkNmNiMzU2MjgtMWEzNS00Y2UwLWE3OTYtODZiYjIwMjYyNDNmdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRiMDdkZmJmOS1hNGY1LTQ0NTUtODIwMy1hMmNlYzRkNjdlZmZwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJEdC1tdDI0aWkxQ3VWUnBvbnRqazZNTFA4NFVOZDJDSnVVbTNzQXpGZXVVIn0.eyJleHAiOjE2NDIzMzM5MjcsImlhdCI6MTY0MjMzMzYyNywianRpIjoiNmNiMzU2MjgtMWEzNS00Y2UwLWE3OTYtODZiYjIwMjYyNDNmIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiJiMDdkZmJmOS1hNGY1LTQ0NTUtODIwMy1hMmNlYzRkNjdlZmYiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.LfQC6pOzHJwRKWJa93ShDgM_MdHoxnk9eyFbHPoREooqpMT3SMjbXwdLkCNCA1uopGCigRpu-rVC9ccTKnQlTDgnhvQem_tEjdzsYd5uMdjz4QlUMfilGKUWG6WO3balqXcCrl-G8-mb57iZhC2hQiX9z610oFRxfoiN6aHjOPbc3b5kLm37QHObSimyN-S1yTLGW4ut7qSpExXmOpDwje3DX8jhJWOJP852tpL4ihL6bOf0qaaYNartB524T1ibMy5pfYK7ayKYeVpBgw6f4U2R7IEK9owz6IFXQoP-VTCMEWrV0gnKBWbW0G6tosI4UBcwX_OETTaxyTxc26I4cw, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642333927, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.25.0.10, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=1CEB162702D975D627266792C4449F63, http-session-last-accessed-time=1642333647800, kc-category-name=ACCESS, kc-iat=1642333627, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:53354 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:47:27.808  INFO 14 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:47:27.808  INFO 14 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@394b224
2022-01-16 11:47:27.808  INFO 14 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@394b224
2022-01-16 11:47:27.856  INFO 14 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@394b224
2022-01-16 11:47:27.856  INFO 14 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@394b224
2022-01-16 11:47:27.894  INFO 14 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@394b224
2022-01-16 11:47:27.895  WARN 14 --- [https-jsse-nio-7071-exec-2] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:47:27.895  WARN 14 --- [https-jsse-nio-7071-exec-2] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:47:27.895  INFO 14 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@394b224
2022-01-16 11:47:27.896  INFO 14 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@394b224
2022-01-16 11:47:27.896  WARN 14 --- [https-jsse-nio-7071-exec-2] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:47:27.896  WARN 14 --- [https-jsse-nio-7071-exec-2] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:47:27.896  INFO 14 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@394b224
2022-01-16 11:47:27.949  INFO 14 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: emergency-active, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@394b224
2022-01-16 11:47:27.963  INFO 14 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@394b224
2022-01-16 11:47:27.963  INFO 14 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@394b224
2022-01-16 11:47:27.973  INFO 14 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@394b224
2022-01-16 11:47:27.973  INFO 14 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-revoke-extra, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@394b224
2022-01-16 11:47:28.025  INFO 14 --- [https-jsse-nio-7071-exec-2] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18912098909125257-582972, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=Deny}, TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:47:28.026  INFO 14 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=0e21e117-a10c-45ab-a2e2-24971b78f287, content=DENY, timestamp=1642333648026, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=Deny}, TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:47:28.026  INFO 14 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=218ms, Total=221ms
2022-01-16 11:47:28.046  INFO 14 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=3b757e07-b8b5-4d32-ac2b-3d7b756fa39e, content=null, timestamp=1642333648037, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=53356, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=4cbbcf975445, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=b07dfbf9-a4f5-4455-8203-a2cec4d67eff, http-req-server-port=80, http-header-accept=*/*, kc-id=6cb35628-1a35-4ce0-a796-86bb2026243f, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642333648036, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQG53NxAH4AEQAAAABh5AW7dAAkNmNiMzU2MjgtMWEzNS00Y2UwLWE3OTYtODZiYjIwMjYyNDNmdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRiMDdkZmJmOS1hNGY1LTQ0NTUtODIwMy1hMmNlYzRkNjdlZmZwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJEdC1tdDI0aWkxQ3VWUnBvbnRqazZNTFA4NFVOZDJDSnVVbTNzQXpGZXVVIn0.eyJleHAiOjE2NDIzMzM5MjcsImlhdCI6MTY0MjMzMzYyNywianRpIjoiNmNiMzU2MjgtMWEzNS00Y2UwLWE3OTYtODZiYjIwMjYyNDNmIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiJiMDdkZmJmOS1hNGY1LTQ0NTUtODIwMy1hMmNlYzRkNjdlZmYiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.LfQC6pOzHJwRKWJa93ShDgM_MdHoxnk9eyFbHPoREooqpMT3SMjbXwdLkCNCA1uopGCigRpu-rVC9ccTKnQlTDgnhvQem_tEjdzsYd5uMdjz4QlUMfilGKUWG6WO3balqXcCrl-G8-mb57iZhC2hQiX9z610oFRxfoiN6aHjOPbc3b5kLm37QHObSimyN-S1yTLGW4ut7qSpExXmOpDwje3DX8jhJWOJP852tpL4ihL6bOf0qaaYNartB524T1ibMy5pfYK7ayKYeVpBgw6f4U2R7IEK9owz6IFXQoP-VTCMEWrV0gnKBWbW0G6tosI4UBcwX_OETTaxyTxc26I4cw, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642333927, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.25.0.10, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=146BECBC926F6D8DA3B26F13FE322039, http-session-last-accessed-time=1642333648036, kc-category-name=ACCESS, kc-iat=1642333627, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:53356 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:47:28.058  INFO 14 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:47:28.058  INFO 14 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@c776d9e
2022-01-16 11:47:28.059  INFO 14 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@c776d9e
2022-01-16 11:47:28.068  INFO 14 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@c776d9e
2022-01-16 11:47:28.068  INFO 14 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@c776d9e
2022-01-16 11:47:28.077  INFO 14 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@c776d9e
2022-01-16 11:47:28.077  WARN 14 --- [https-jsse-nio-7071-exec-3] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:47:28.077  WARN 14 --- [https-jsse-nio-7071-exec-3] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:47:28.077  INFO 14 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@c776d9e
2022-01-16 11:47:28.077  INFO 14 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@c776d9e
2022-01-16 11:47:28.077  WARN 14 --- [https-jsse-nio-7071-exec-3] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:47:28.077  WARN 14 --- [https-jsse-nio-7071-exec-3] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:47:28.077  INFO 14 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@c776d9e
2022-01-16 11:47:28.125  INFO 14 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: emergency-active, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@c776d9e
2022-01-16 11:47:28.135  INFO 14 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@c776d9e
2022-01-16 11:47:28.135  INFO 14 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@c776d9e
2022-01-16 11:47:28.147  INFO 14 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@c776d9e
2022-01-16 11:47:28.147  INFO 14 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-revoke-extra, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@c776d9e
2022-01-16 11:47:28.202  INFO 14 --- [https-jsse-nio-7071-exec-3] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18912099159345621-624366, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=Deny}, TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:47:28.202  INFO 14 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=3b757e07-b8b5-4d32-ac2b-3d7b756fa39e, content=DENY, timestamp=1642333648202, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=Deny}, TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:47:28.203  INFO 14 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=144ms, Total=158ms
2022-01-16 11:47:28.224  INFO 14 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=4edeec72-5d67-4cf8-827f-1844298bc7c4, content=null, timestamp=1642333648215, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=53358, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=4cbbcf975445, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=b07dfbf9-a4f5-4455-8203-a2cec4d67eff, http-req-server-port=80, http-header-accept=*/*, kc-id=6cb35628-1a35-4ce0-a796-86bb2026243f, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642333648214, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQG53NxAH4AEQAAAABh5AW7dAAkNmNiMzU2MjgtMWEzNS00Y2UwLWE3OTYtODZiYjIwMjYyNDNmdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRiMDdkZmJmOS1hNGY1LTQ0NTUtODIwMy1hMmNlYzRkNjdlZmZwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJEdC1tdDI0aWkxQ3VWUnBvbnRqazZNTFA4NFVOZDJDSnVVbTNzQXpGZXVVIn0.eyJleHAiOjE2NDIzMzM5MjcsImlhdCI6MTY0MjMzMzYyNywianRpIjoiNmNiMzU2MjgtMWEzNS00Y2UwLWE3OTYtODZiYjIwMjYyNDNmIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiJiMDdkZmJmOS1hNGY1LTQ0NTUtODIwMy1hMmNlYzRkNjdlZmYiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.LfQC6pOzHJwRKWJa93ShDgM_MdHoxnk9eyFbHPoREooqpMT3SMjbXwdLkCNCA1uopGCigRpu-rVC9ccTKnQlTDgnhvQem_tEjdzsYd5uMdjz4QlUMfilGKUWG6WO3balqXcCrl-G8-mb57iZhC2hQiX9z610oFRxfoiN6aHjOPbc3b5kLm37QHObSimyN-S1yTLGW4ut7qSpExXmOpDwje3DX8jhJWOJP852tpL4ihL6bOf0qaaYNartB524T1ibMy5pfYK7ayKYeVpBgw6f4U2R7IEK9owz6IFXQoP-VTCMEWrV0gnKBWbW0G6tosI4UBcwX_OETTaxyTxc26I4cw, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642333927, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.25.0.10, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=80D5EB844609DA7DE33B89BD34370529, http-session-last-accessed-time=1642333648214, kc-category-name=ACCESS, kc-iat=1642333627, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:53358 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:47:28.225  INFO 14 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:47:28.225  INFO 14 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5bb35779
2022-01-16 11:47:28.226  INFO 14 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5bb35779
2022-01-16 11:47:28.237  INFO 14 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5bb35779
2022-01-16 11:47:28.238  INFO 14 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5bb35779
2022-01-16 11:47:28.248  INFO 14 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5bb35779
2022-01-16 11:47:28.248  WARN 14 --- [https-jsse-nio-7071-exec-4] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:47:28.248  WARN 14 --- [https-jsse-nio-7071-exec-4] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:47:28.249  INFO 14 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5bb35779
2022-01-16 11:47:28.249  INFO 14 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5bb35779
2022-01-16 11:47:28.249  WARN 14 --- [https-jsse-nio-7071-exec-4] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:47:28.249  WARN 14 --- [https-jsse-nio-7071-exec-4] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:47:28.249  INFO 14 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5bb35779
2022-01-16 11:47:28.306  INFO 14 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: emergency-active, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5bb35779
2022-01-16 11:47:28.320  INFO 14 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5bb35779
2022-01-16 11:47:28.321  INFO 14 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5bb35779
2022-01-16 11:47:28.330  INFO 14 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5bb35779
2022-01-16 11:47:28.330  INFO 14 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-revoke-extra, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5bb35779
2022-01-16 11:47:28.382  INFO 14 --- [https-jsse-nio-7071-exec-4] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18912099326160608-406185, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=Deny}, TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:47:28.382  INFO 14 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=4edeec72-5d67-4cf8-827f-1844298bc7c4, content=DENY, timestamp=1642333648382, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=Deny}, TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:47:28.383  INFO 14 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=157ms, Total=160ms
2022-01-16 11:47:28.396  INFO 14 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=a6f43fb4-a97b-46a7-8bd7-98d5afab9067, content=null, timestamp=1642333648392, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=53360, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=4cbbcf975445, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=b07dfbf9-a4f5-4455-8203-a2cec4d67eff, http-req-server-port=80, http-header-accept=*/*, kc-id=6cb35628-1a35-4ce0-a796-86bb2026243f, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642333648391, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQG53NxAH4AEQAAAABh5AW7dAAkNmNiMzU2MjgtMWEzNS00Y2UwLWE3OTYtODZiYjIwMjYyNDNmdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRiMDdkZmJmOS1hNGY1LTQ0NTUtODIwMy1hMmNlYzRkNjdlZmZwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJEdC1tdDI0aWkxQ3VWUnBvbnRqazZNTFA4NFVOZDJDSnVVbTNzQXpGZXVVIn0.eyJleHAiOjE2NDIzMzM5MjcsImlhdCI6MTY0MjMzMzYyNywianRpIjoiNmNiMzU2MjgtMWEzNS00Y2UwLWE3OTYtODZiYjIwMjYyNDNmIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiJiMDdkZmJmOS1hNGY1LTQ0NTUtODIwMy1hMmNlYzRkNjdlZmYiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.LfQC6pOzHJwRKWJa93ShDgM_MdHoxnk9eyFbHPoREooqpMT3SMjbXwdLkCNCA1uopGCigRpu-rVC9ccTKnQlTDgnhvQem_tEjdzsYd5uMdjz4QlUMfilGKUWG6WO3balqXcCrl-G8-mb57iZhC2hQiX9z610oFRxfoiN6aHjOPbc3b5kLm37QHObSimyN-S1yTLGW4ut7qSpExXmOpDwje3DX8jhJWOJP852tpL4ihL6bOf0qaaYNartB524T1ibMy5pfYK7ayKYeVpBgw6f4U2R7IEK9owz6IFXQoP-VTCMEWrV0gnKBWbW0G6tosI4UBcwX_OETTaxyTxc26I4cw, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642333927, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.25.0.10, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=93A484BB918F267E820BF3B4E3ACC10A, http-session-last-accessed-time=1642333648391, kc-category-name=ACCESS, kc-iat=1642333627, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:53360 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:47:28.397  INFO 14 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:47:28.397  INFO 14 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3fd7901a
2022-01-16 11:47:28.397  INFO 14 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3fd7901a
2022-01-16 11:47:28.411  INFO 14 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3fd7901a
2022-01-16 11:47:28.411  INFO 14 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3fd7901a
2022-01-16 11:47:28.420  INFO 14 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3fd7901a
2022-01-16 11:47:28.420  WARN 14 --- [https-jsse-nio-7071-exec-5] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:47:28.420  WARN 14 --- [https-jsse-nio-7071-exec-5] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:47:28.421  INFO 14 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3fd7901a
2022-01-16 11:47:28.421  INFO 14 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3fd7901a
2022-01-16 11:47:28.421  WARN 14 --- [https-jsse-nio-7071-exec-5] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:47:28.422  WARN 14 --- [https-jsse-nio-7071-exec-5] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:47:28.422  INFO 14 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3fd7901a
2022-01-16 11:47:28.473  INFO 14 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: emergency-active, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3fd7901a
2022-01-16 11:47:28.490  INFO 14 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3fd7901a
2022-01-16 11:47:28.491  INFO 14 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3fd7901a
2022-01-16 11:47:28.501  INFO 14 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3fd7901a
2022-01-16 11:47:28.502  INFO 14 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-revoke-extra, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3fd7901a
2022-01-16 11:47:28.554  INFO 14 --- [https-jsse-nio-7071-exec-5] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18912099498143348-766168, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=Deny}, TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:47:28.555  INFO 14 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=a6f43fb4-a97b-46a7-8bd7-98d5afab9067, content=DENY, timestamp=1642333648555, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=Deny}, TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:47:28.555  INFO 14 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=158ms, Total=161ms
2022-01-16 11:47:28.575  INFO 14 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=41ee920b-3905-41d4-b6b5-a96aceb7cf52, content=null, timestamp=1642333648571, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=53362, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=4cbbcf975445, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=b07dfbf9-a4f5-4455-8203-a2cec4d67eff, http-req-server-port=80, http-header-accept=*/*, kc-id=6cb35628-1a35-4ce0-a796-86bb2026243f, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642333648570, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQG53NxAH4AEQAAAABh5AW7dAAkNmNiMzU2MjgtMWEzNS00Y2UwLWE3OTYtODZiYjIwMjYyNDNmdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRiMDdkZmJmOS1hNGY1LTQ0NTUtODIwMy1hMmNlYzRkNjdlZmZwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJEdC1tdDI0aWkxQ3VWUnBvbnRqazZNTFA4NFVOZDJDSnVVbTNzQXpGZXVVIn0.eyJleHAiOjE2NDIzMzM5MjcsImlhdCI6MTY0MjMzMzYyNywianRpIjoiNmNiMzU2MjgtMWEzNS00Y2UwLWE3OTYtODZiYjIwMjYyNDNmIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiJiMDdkZmJmOS1hNGY1LTQ0NTUtODIwMy1hMmNlYzRkNjdlZmYiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.LfQC6pOzHJwRKWJa93ShDgM_MdHoxnk9eyFbHPoREooqpMT3SMjbXwdLkCNCA1uopGCigRpu-rVC9ccTKnQlTDgnhvQem_tEjdzsYd5uMdjz4QlUMfilGKUWG6WO3balqXcCrl-G8-mb57iZhC2hQiX9z610oFRxfoiN6aHjOPbc3b5kLm37QHObSimyN-S1yTLGW4ut7qSpExXmOpDwje3DX8jhJWOJP852tpL4ihL6bOf0qaaYNartB524T1ibMy5pfYK7ayKYeVpBgw6f4U2R7IEK9owz6IFXQoP-VTCMEWrV0gnKBWbW0G6tosI4UBcwX_OETTaxyTxc26I4cw, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642333927, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.25.0.10, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=2D7D6881ABE4A7C0A260A1680D9E7D57, http-session-last-accessed-time=1642333648570, kc-category-name=ACCESS, kc-iat=1642333627, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:53362 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:47:28.576  INFO 14 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:47:28.577  INFO 14 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@42bf50c8
2022-01-16 11:47:28.577  INFO 14 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@42bf50c8
2022-01-16 11:47:28.589  INFO 14 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@42bf50c8
2022-01-16 11:47:28.589  INFO 14 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@42bf50c8
2022-01-16 11:47:28.611  INFO 14 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@42bf50c8
2022-01-16 11:47:28.611  WARN 14 --- [https-jsse-nio-7071-exec-6] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:47:28.611  WARN 14 --- [https-jsse-nio-7071-exec-6] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:47:28.612  INFO 14 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@42bf50c8
2022-01-16 11:47:28.612  INFO 14 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@42bf50c8
2022-01-16 11:47:28.613  WARN 14 --- [https-jsse-nio-7071-exec-6] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:47:28.613  WARN 14 --- [https-jsse-nio-7071-exec-6] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:47:28.613  INFO 14 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@42bf50c8
2022-01-16 11:47:28.665  INFO 14 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: emergency-active, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@42bf50c8
2022-01-16 11:47:28.681  INFO 14 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@42bf50c8
2022-01-16 11:47:28.681  INFO 14 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@42bf50c8
2022-01-16 11:47:28.696  INFO 14 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@42bf50c8
2022-01-16 11:47:28.696  INFO 14 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-revoke-extra, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@42bf50c8
2022-01-16 11:47:28.759  INFO 14 --- [https-jsse-nio-7071-exec-6] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18912099677755840-145515, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=Deny}, TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:47:28.760  INFO 14 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=41ee920b-3905-41d4-b6b5-a96aceb7cf52, content=DENY, timestamp=1642333648760, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=Deny}, TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:47:28.762  INFO 14 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=184ms, Total=188ms
