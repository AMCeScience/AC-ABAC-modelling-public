2022-01-16 11:26:46.088  INFO 15 --- [main] .a.a.a.s.AuthorizationServiceApplication : Starting AuthorizationServiceApplication v3.0.4 using Java 1.8.0_212 on bd0b86c9d29a with PID 15 (/abac-server/abac-authorization-server-exec.jar started by root in /abac-server)
2022-01-16 11:26:46.106  INFO 15 --- [main] .a.a.a.s.AuthorizationServiceApplication : No active profile set, falling back to default profiles: default
2022-01-16 11:26:50.333  INFO 15 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2022-01-16 11:26:50.527  INFO 15 --- [main] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 169 ms. Found 3 JPA repository interfaces.
2022-01-16 11:26:52.754  INFO 15 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port(s): 7071 (https)
2022-01-16 11:26:52.792  INFO 15 --- [main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2022-01-16 11:26:52.793  INFO 15 --- [main] org.apache.catalina.core.StandardEngine  : Starting Servlet engine: [Apache Tomcat/9.0.56]
2022-01-16 11:26:53.281  INFO 15 --- [main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2022-01-16 11:26:53.282  INFO 15 --- [main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 6854 ms
2022-01-16 11:26:53.481  INFO 15 --- [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
2022-01-16 11:26:53.492  WARN 15 --- [main] com.zaxxer.hikari.util.DriverDataSource  : Registered driver with driverClassName=com.mysql.jdbc.Driver was not found, trying direct instantiation.
2022-01-16 11:26:54.087  INFO 15 --- [main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
2022-01-16 11:26:54.105  INFO 15 --- [main] o.s.b.a.h2.H2ConsoleAutoConfiguration    : H2 console available at '/h2-console'. Database available at 'jdbc:mysql://mysql:3306/apam_db?createDatabaseIfNotExist=true'
2022-01-16 11:26:54.621  INFO 15 --- [main] o.hibernate.jpa.internal.util.LogHelper  : HHH000204: Processing PersistenceUnitInfo [name: default]
2022-01-16 11:26:54.863  INFO 15 --- [main] org.hibernate.Version                    : HHH000412: Hibernate ORM core version 5.6.3.Final
2022-01-16 11:26:55.481  INFO 15 --- [main] o.hibernate.annotations.common.Version   : HCANN000001: Hibernate Commons Annotations {5.1.2.Final}
2022-01-16 11:26:56.101  INFO 15 --- [main] org.hibernate.dialect.Dialect            : HHH000400: Using dialect: org.hibernate.dialect.MySQL5InnoDBDialect
2022-01-16 11:26:57.855  INFO 15 --- [main] o.h.e.t.j.p.i.JtaPlatformInitiator       : HHH000490: Using JtaPlatform implementation: [org.hibernate.engine.transaction.jta.platform.internal.NoJtaPlatform]
2022-01-16 11:26:57.870  INFO 15 --- [main] j.LocalContainerEntityManagerFactoryBean : Initialized JPA EntityManagerFactory for persistence unit 'default'
2022-01-16 11:26:58.353  INFO 15 --- [main] e.a.a.abac.server.pap.PapProperties      : ABAC Policies directory: ./config/../policies
2022-01-16 11:26:58.354  INFO 15 --- [main] e.a.a.abac.server.pap.PapProperties      : ABE Policies directory: ./config/../policies
2022-01-16 11:26:59.821  INFO 15 --- [main] e.a.a.abac.server.pdp.DirectoryWatcher   : Policy dir. watcher initialized
2022-01-16 11:26:59.822  INFO 15 --- [main] e.a.a.a.s.pdp.AuthorizationServicePDP    : Initializing PDP...
2022-01-16 11:26:59.822  INFO 15 --- [main] e.a.a.a.s.pdp.AuthorizationServicePDP    : Getting policy files from: ./config/../policies
2022-01-16 11:26:59.828  INFO 15 --- [main] e.a.a.a.s.pdp.AuthorizationServicePDP    : Policy files found: 5
2022-01-16 11:27:00.555  INFO 15 --- [main] org.wso2.balana.ConfigurationStore       : Loading runtime configuration
2022-01-16 11:27:00.851  INFO 15 --- [main] e.a.a.a.s.pdp.AuthorizationServicePDP    : Configured attribute finder module classes: [eu.asclepios.authorization.abac.server.pdp.finder.LoggingAttributeFinderModule, eu.asclepios.authorization.abac.server.pdp.finder.WeekdayAttributeFinderModule, eu.asclepios.authorization.abac.server.pdp.finder.IpAddressAttributeFinderModule, eu.asclepios.authorization.abac.server.pdp.finder.DeviceAttributeFinderModule, eu.asclepios.authorization.abac.server.pdp.finder.GeolocationAttributeFinderModule, eu.asclepios.authorization.abac.server.pdp.finder.KeycloackAttributeFinderModule, eu.asclepios.authorization.abac.server.pdp.finder.NoopAttributeFinderModule, eu.asclepios.example.contexthandlers.CustomDbAttributeFinder, eu.asclepios.example.contexthandlers.CustomRestAttrFinder]
2022-01-16 11:27:00.853  INFO 15 --- [main] e.a.a.a.s.pdp.AuthorizationServicePDP    :   Instantiating attribute finder module: eu.asclepios.authorization.abac.server.pdp.finder.LoggingAttributeFinderModule@55342f40
2022-01-16 11:27:00.860  INFO 15 --- [main] e.a.a.a.s.pdp.AuthorizationServicePDP    :   Instantiating attribute finder module: eu.asclepios.authorization.abac.server.pdp.finder.WeekdayAttributeFinderModule@a4ca3f6
2022-01-16 11:27:00.867  INFO 15 --- [main] e.a.a.a.s.pdp.AuthorizationServicePDP    :   Instantiating attribute finder module: eu.asclepios.authorization.abac.server.pdp.finder.IpAddressAttributeFinderModule@72ea6193
2022-01-16 11:27:00.868  INFO 15 --- [main] e.a.a.a.s.pdp.AuthorizationServicePDP    :   Instantiating attribute finder module: eu.asclepios.authorization.abac.server.pdp.finder.DeviceAttributeFinderModule@31aa3ca5
2022-01-16 11:27:00.918  INFO 15 --- [main] e.a.a.a.s.pdp.AuthorizationServicePDP    :   Instantiating attribute finder module: eu.asclepios.authorization.abac.server.pdp.finder.GeolocationAttributeFinderModule@45905bff
2022-01-16 11:27:00.919  INFO 15 --- [main] e.a.a.a.s.pdp.AuthorizationServicePDP    :   Instantiating attribute finder module: eu.asclepios.authorization.abac.server.pdp.finder.KeycloackAttributeFinderModule@2a2c13a8
2022-01-16 11:27:00.920  INFO 15 --- [main] e.a.a.a.s.pdp.AuthorizationServicePDP    :   Instantiating attribute finder module: eu.asclepios.authorization.abac.server.pdp.finder.NoopAttributeFinderModule@b6b1987
2022-01-16 11:27:00.929  INFO 15 --- [main] e.a.e.c.CustomDbAttributeFinder          : CustomDbAttributeFinder: DB settings: url=jdbc:mysql://mysql:3306/keycloak, driver=com.mysql.jdbc.Driver, username=keycloak
2022-01-16 11:27:00.977  INFO 15 --- [main] e.a.e.c.CustomDbAttributeFinder          : CustomDbAttributeFinder: Processing entry: 12345:600000:ambulance-crew-id-1234
2022-01-16 11:27:00.981  INFO 15 --- [main] e.a.e.c.CustomDbAttributeFinder          : CustomDbAttributeFinder: Processing entry:  23456:600000:ambulance-crew-id-2345
2022-01-16 11:27:00.985  INFO 15 --- [main] e.a.e.c.CustomDbAttributeFinder          : CustomDbAttributeFinder: Processing entry:  34567:600000:ambulance-crew-id-3456
2022-01-16 11:27:00.989  INFO 15 --- [main] e.a.e.c.CustomDbAttributeFinder          : CustomDbAttributeFinder: Added 3 entries in DB
2022-01-16 11:27:00.989  INFO 15 --- [main] e.a.a.a.s.pdp.AuthorizationServicePDP    :   Instantiating attribute finder module: eu.asclepios.example.contexthandlers.CustomDbAttributeFinder@3543df7d
2022-01-16 11:27:00.995  INFO 15 --- [main] e.a.e.c.CustomRestAttrFinder             : CustomRestAttrFinder: REST URL template: http://django-rest:8000/attribute-provider/getinfov2?ES-ID={{es-id}}&format=json&patient-ID={{patient-id}}&user-ID={{user-id}}
2022-01-16 11:27:01.091  INFO 15 --- [main] e.a.a.a.s.pdp.AuthorizationServicePDP    :   Instantiating attribute finder module: eu.asclepios.example.contexthandlers.CustomRestAttrFinder@354fc8f0
2022-01-16 11:27:01.174  INFO 15 --- [main] e.a.a.a.s.pdp.AuthorizationServicePDP    : PDP initialized
2022-01-16 11:27:01.183  INFO 15 --- [main] e.a.a.abac.server.PdpServerController    : Authorization Service configuration: AuthorizationServiceProperties(pdp=AuthorizationServiceProperties.PdpConfig(enable=true, balanaConfigFile=./config/balana.cfg.xml, policiesDir=./config/../policies, policiesExtension=.xml, restartPollingInterval=1000, accessKey=7235687126587231675321756752657236156321765723, attributeFinderClasses=[eu.asclepios.authorization.abac.server.pdp.finder.LoggingAttributeFinderModule, eu.asclepios.authorization.abac.server.pdp.finder.WeekdayAttributeFinderModule, eu.asclepios.authorization.abac.server.pdp.finder.IpAddressAttributeFinderModule, eu.asclepios.authorization.abac.server.pdp.finder.DeviceAttributeFinderModule, eu.asclepios.authorization.abac.server.pdp.finder.GeolocationAttributeFinderModule, eu.asclepios.authorization.abac.server.pdp.finder.KeycloackAttributeFinderModule, eu.asclepios.authorization.abac.server.pdp.finder.NoopAttributeFinderModule, eu.asclepios.example.contexthandlers.CustomDbAttributeFinder, eu.asclepios.example.contexthandlers.CustomRestAttrFinder]), context=null, pip=[], requestContext=null)
2022-01-16 11:27:01.184  INFO 15 --- [main] e.a.a.abac.server.PdpServerController    : Server-side request context extraction: false
2022-01-16 11:27:01.325  WARN 15 --- [main] JpaBaseConfiguration$JpaWebConfiguration : spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2022-01-16 11:27:01.856  INFO 15 --- [main] e.a.a.abac.server.util.WebMvcConfig      : Using API Key authentication in PDP
2022-01-16 11:27:01.862  INFO 15 --- [main] e.a.a.abac.server.util.WebMvcConfig      : Using API Key authentication in PAP
2022-01-16 11:27:03.239  INFO 15 --- [main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port(s): 7071 (https) with context path ''
2022-01-16 11:27:03.267  INFO 15 --- [main] .a.a.a.s.AuthorizationServiceApplication : Started AuthorizationServiceApplication in 19.204 seconds (JVM running for 20.531)
2022-01-16 11:28:17.178  INFO 15 --- [https-jsse-nio-7071-exec-6] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring DispatcherServlet 'dispatcherServlet'
2022-01-16 11:28:17.179  INFO 15 --- [https-jsse-nio-7071-exec-6] o.s.web.servlet.DispatcherServlet        : Initializing Servlet 'dispatcherServlet'
2022-01-16 11:28:17.184  INFO 15 --- [https-jsse-nio-7071-exec-6] o.s.web.servlet.DispatcherServlet        : Completed initialization in 4 ms
2022-01-16 11:28:17.285  INFO 15 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=28f78781-f76e-4ad6-b958-8cb44915e165, content=null, timestamp=1642332496790, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=51594, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=5eea89d14d1a, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=999d21b7-cecf-4b75-ae67-bd5c244cfd50, http-req-server-port=80, http-header-accept=*/*, kc-id=917038d1-218a-4de3-bc21-524ee9b1ec1f, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642332496761, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQCfHNxAH4AEQAAAABh5AFQdAAkOTE3MDM4ZDEtMjE4YS00ZGUzLWJjMjEtNTI0ZWU5YjFlYzFmdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ5OTlkMjFiNy1jZWNmLTRiNzUtYWU2Ny1iZDVjMjQ0Y2ZkNTBwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJKS2NmeHpNR3dHQmVVTmNCczVvZ2tZclhKNlRJX0hyQi04Y3BuakZDa0lZIn0.eyJleHAiOjE2NDIzMzI3OTYsImlhdCI6MTY0MjMzMjQ5NiwianRpIjoiOTE3MDM4ZDEtMjE4YS00ZGUzLWJjMjEtNTI0ZWU5YjFlYzFmIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiI5OTlkMjFiNy1jZWNmLTRiNzUtYWU2Ny1iZDVjMjQ0Y2ZkNTAiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.TNPdGgstBT5KMl1zUUFYUdWBWAX1vTqDRLObIX6Hfm6TD1yNq3YIfGvVs8ew9FkCUjHZv2RxDXwap4ZBgU1XWNfgbY7lRnbcXLwKQVYJ_UngYNYkyfIeNM6f6obFgnYgUZWmuKJPNDWSwOXgaOQYUKn2Kwg84g2RElqDZmS17N-Zrmrpfozma14xSG38xXRYv-xLzM1EYvvOzmGuxWAUpVDlg0H-jAo7M5on-TNuilMfy2lmX-fR8QdyJczEmqrtLszHB-gRh60Vzm3zoDrkhMJEU1EZKqYn9jSEl8QuQahpjS-rHQw5sSk-pQAr0VHiulVAKkKycSls-Wms7_8olg, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre/read, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642332796, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.240.10, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=04F2CA3A6D908DA84E09F117E9131155, http-session-last-accessed-time=1642332496761, kc-category-name=ACCESS, kc-iat=1642332496, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:51594 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:28:17.286  INFO 15 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:28:17.293  INFO 15 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.util.AttributeUtil     : XACML Attribute Categories:
{urn:oasis:names:tc:xacml:1.0:environment:current-date=urn:oasis:names:tc:xacml:3.0:attribute-category:environment, urn:oasis:names:tc:xacml:1.0:environment:current-dateTime=urn:oasis:names:tc:xacml:3.0:attribute-category:environment, actionId=urn:oasis:names:tc:xacml:3.0:attribute-category:action, user.identifier=urn:oasis:names:tc:xacml:1.0:subject-category:access-subject, urn:oasis:names:tc:xacml:1.0:environment:current-time=urn:oasis:names:tc:xacml:3.0:attribute-category:environment, request-id=urn:oasis:names:tc:xacml:3.0:attribute-category:environment, resource-id=urn:oasis:names:tc:xacml:3.0:attribute-category:resource}
2022-01-16 11:28:17.293  INFO 15 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.util.AttributeUtil     : XACML Attribute Data Types:
{urn:oasis:names:tc:xacml:1.0:environment:current-date=http://www.w3.org/2001/XMLSchema#date, urn:oasis:names:tc:xacml:1.0:environment:current-dateTime=http://www.w3.org/2001/XMLSchema#dateTime, actionId=http://www.w3.org/2001/XMLSchema#string, user.identifier=http://www.w3.org/2001/XMLSchema#string, urn:oasis:names:tc:xacml:1.0:environment:current-time=http://www.w3.org/2001/XMLSchema#time, request-id=http://www.w3.org/2001/XMLSchema#string, resource-id=http://www.w3.org/2001/XMLSchema#string}
2022-01-16 11:28:17.309  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@231918ad
2022-01-16 11:28:17.310  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@231918ad
2022-01-16 11:28:17.438  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@231918ad
2022-01-16 11:28:17.439  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@231918ad
2022-01-16 11:28:17.450  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@231918ad
2022-01-16 11:28:17.451  WARN 15 --- [https-jsse-nio-7071-exec-6] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:28:17.451  WARN 15 --- [https-jsse-nio-7071-exec-6] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:28:17.452  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: under-emergency, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@231918ad
2022-01-16 11:28:17.465  INFO 15 --- [https-jsse-nio-7071-exec-6] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18910948388037530-644869, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:patient-under-active-emergency:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=patient-under-active-emergency, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 3 - Patient under active emergency, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:28:17.467  INFO 15 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=28f78781-f76e-4ad6-b958-8cb44915e165, content=DENY, timestamp=1642332497467, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:patient-under-active-emergency:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=patient-under-active-emergency, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 3 - Patient under active emergency, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:28:17.474  INFO 15 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=180ms, Total=221ms
2022-01-16 11:28:17.596  INFO 15 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=f30ecb44-a019-4fc6-9024-3fdd2d253adc, content=null, timestamp=1642332497547, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=51600, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=5eea89d14d1a, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=999d21b7-cecf-4b75-ae67-bd5c244cfd50, http-req-server-port=80, http-header-accept=*/*, kc-id=917038d1-218a-4de3-bc21-524ee9b1ec1f, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642332497545, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQCfHNxAH4AEQAAAABh5AFQdAAkOTE3MDM4ZDEtMjE4YS00ZGUzLWJjMjEtNTI0ZWU5YjFlYzFmdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ5OTlkMjFiNy1jZWNmLTRiNzUtYWU2Ny1iZDVjMjQ0Y2ZkNTBwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJKS2NmeHpNR3dHQmVVTmNCczVvZ2tZclhKNlRJX0hyQi04Y3BuakZDa0lZIn0.eyJleHAiOjE2NDIzMzI3OTYsImlhdCI6MTY0MjMzMjQ5NiwianRpIjoiOTE3MDM4ZDEtMjE4YS00ZGUzLWJjMjEtNTI0ZWU5YjFlYzFmIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiI5OTlkMjFiNy1jZWNmLTRiNzUtYWU2Ny1iZDVjMjQ0Y2ZkNTAiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.TNPdGgstBT5KMl1zUUFYUdWBWAX1vTqDRLObIX6Hfm6TD1yNq3YIfGvVs8ew9FkCUjHZv2RxDXwap4ZBgU1XWNfgbY7lRnbcXLwKQVYJ_UngYNYkyfIeNM6f6obFgnYgUZWmuKJPNDWSwOXgaOQYUKn2Kwg84g2RElqDZmS17N-Zrmrpfozma14xSG38xXRYv-xLzM1EYvvOzmGuxWAUpVDlg0H-jAo7M5on-TNuilMfy2lmX-fR8QdyJczEmqrtLszHB-gRh60Vzm3zoDrkhMJEU1EZKqYn9jSEl8QuQahpjS-rHQw5sSk-pQAr0VHiulVAKkKycSls-Wms7_8olg, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre/read, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642332796, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.240.10, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=33980EEB558F0EA6E710181253D95290, http-session-last-accessed-time=1642332497545, kc-category-name=ACCESS, kc-iat=1642332496, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:51600 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:28:17.597  INFO 15 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:28:17.598  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1c4aeeee
2022-01-16 11:28:17.599  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1c4aeeee
2022-01-16 11:28:17.619  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1c4aeeee
2022-01-16 11:28:17.620  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1c4aeeee
2022-01-16 11:28:17.670  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1c4aeeee
2022-01-16 11:28:17.670  WARN 15 --- [https-jsse-nio-7071-exec-7] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:28:17.671  WARN 15 --- [https-jsse-nio-7071-exec-7] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:28:17.671  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: under-emergency, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1c4aeeee
2022-01-16 11:28:17.687  INFO 15 --- [https-jsse-nio-7071-exec-7] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18910948698591956-665784, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:patient-under-active-emergency:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=patient-under-active-emergency, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 3 - Patient under active emergency, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:28:17.687  INFO 15 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=f30ecb44-a019-4fc6-9024-3fdd2d253adc, content=DENY, timestamp=1642332497687, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:patient-under-active-emergency:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=patient-under-active-emergency, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 3 - Patient under active emergency, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:28:17.688  INFO 15 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=90ms, Total=95ms
2022-01-16 11:28:17.728  INFO 15 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=8dafbf55-9a9b-42cd-a017-17591a404c02, content=null, timestamp=1642332497708, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=51602, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=5eea89d14d1a, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=999d21b7-cecf-4b75-ae67-bd5c244cfd50, http-req-server-port=80, http-header-accept=*/*, kc-id=917038d1-218a-4de3-bc21-524ee9b1ec1f, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642332497706, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQCfHNxAH4AEQAAAABh5AFQdAAkOTE3MDM4ZDEtMjE4YS00ZGUzLWJjMjEtNTI0ZWU5YjFlYzFmdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ5OTlkMjFiNy1jZWNmLTRiNzUtYWU2Ny1iZDVjMjQ0Y2ZkNTBwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJKS2NmeHpNR3dHQmVVTmNCczVvZ2tZclhKNlRJX0hyQi04Y3BuakZDa0lZIn0.eyJleHAiOjE2NDIzMzI3OTYsImlhdCI6MTY0MjMzMjQ5NiwianRpIjoiOTE3MDM4ZDEtMjE4YS00ZGUzLWJjMjEtNTI0ZWU5YjFlYzFmIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiI5OTlkMjFiNy1jZWNmLTRiNzUtYWU2Ny1iZDVjMjQ0Y2ZkNTAiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.TNPdGgstBT5KMl1zUUFYUdWBWAX1vTqDRLObIX6Hfm6TD1yNq3YIfGvVs8ew9FkCUjHZv2RxDXwap4ZBgU1XWNfgbY7lRnbcXLwKQVYJ_UngYNYkyfIeNM6f6obFgnYgUZWmuKJPNDWSwOXgaOQYUKn2Kwg84g2RElqDZmS17N-Zrmrpfozma14xSG38xXRYv-xLzM1EYvvOzmGuxWAUpVDlg0H-jAo7M5on-TNuilMfy2lmX-fR8QdyJczEmqrtLszHB-gRh60Vzm3zoDrkhMJEU1EZKqYn9jSEl8QuQahpjS-rHQw5sSk-pQAr0VHiulVAKkKycSls-Wms7_8olg, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre/read, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642332796, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.240.10, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=A5DE785462FFA40B7A2421E8666E0B0D, http-session-last-accessed-time=1642332497706, kc-category-name=ACCESS, kc-iat=1642332496, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:51602 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:28:17.729  INFO 15 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:28:17.738  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@58eb2cae
2022-01-16 11:28:17.739  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@58eb2cae
2022-01-16 11:28:17.750  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@58eb2cae
2022-01-16 11:28:17.751  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@58eb2cae
2022-01-16 11:28:17.766  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@58eb2cae
2022-01-16 11:28:17.766  WARN 15 --- [https-jsse-nio-7071-exec-8] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:28:17.767  WARN 15 --- [https-jsse-nio-7071-exec-8] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:28:17.768  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: under-emergency, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@58eb2cae
2022-01-16 11:28:17.830  INFO 15 --- [https-jsse-nio-7071-exec-8] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18910948830628551-530141, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:patient-under-active-emergency:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=patient-under-active-emergency, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 3 - Patient under active emergency, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:28:17.831  INFO 15 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=8dafbf55-9a9b-42cd-a017-17591a404c02, content=DENY, timestamp=1642332497831, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:patient-under-active-emergency:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=patient-under-active-emergency, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 3 - Patient under active emergency, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:28:17.831  INFO 15 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=102ms, Total=106ms
2022-01-16 11:28:17.869  INFO 15 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=b25ef20e-391c-4e76-bdad-63ae9fc379a2, content=null, timestamp=1642332497850, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=51604, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=5eea89d14d1a, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=999d21b7-cecf-4b75-ae67-bd5c244cfd50, http-req-server-port=80, http-header-accept=*/*, kc-id=917038d1-218a-4de3-bc21-524ee9b1ec1f, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642332497848, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQCfHNxAH4AEQAAAABh5AFQdAAkOTE3MDM4ZDEtMjE4YS00ZGUzLWJjMjEtNTI0ZWU5YjFlYzFmdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ5OTlkMjFiNy1jZWNmLTRiNzUtYWU2Ny1iZDVjMjQ0Y2ZkNTBwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJKS2NmeHpNR3dHQmVVTmNCczVvZ2tZclhKNlRJX0hyQi04Y3BuakZDa0lZIn0.eyJleHAiOjE2NDIzMzI3OTYsImlhdCI6MTY0MjMzMjQ5NiwianRpIjoiOTE3MDM4ZDEtMjE4YS00ZGUzLWJjMjEtNTI0ZWU5YjFlYzFmIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiI5OTlkMjFiNy1jZWNmLTRiNzUtYWU2Ny1iZDVjMjQ0Y2ZkNTAiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.TNPdGgstBT5KMl1zUUFYUdWBWAX1vTqDRLObIX6Hfm6TD1yNq3YIfGvVs8ew9FkCUjHZv2RxDXwap4ZBgU1XWNfgbY7lRnbcXLwKQVYJ_UngYNYkyfIeNM6f6obFgnYgUZWmuKJPNDWSwOXgaOQYUKn2Kwg84g2RElqDZmS17N-Zrmrpfozma14xSG38xXRYv-xLzM1EYvvOzmGuxWAUpVDlg0H-jAo7M5on-TNuilMfy2lmX-fR8QdyJczEmqrtLszHB-gRh60Vzm3zoDrkhMJEU1EZKqYn9jSEl8QuQahpjS-rHQw5sSk-pQAr0VHiulVAKkKycSls-Wms7_8olg, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre/read, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642332796, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.240.10, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=5502C3C2D0DF4EF171B02D644D309545, http-session-last-accessed-time=1642332497848, kc-category-name=ACCESS, kc-iat=1642332496, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:51604 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:28:17.870  INFO 15 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:28:17.872  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@793f0738
2022-01-16 11:28:17.872  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@793f0738
2022-01-16 11:28:17.905  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@793f0738
2022-01-16 11:28:17.906  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@793f0738
2022-01-16 11:28:17.935  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@793f0738
2022-01-16 11:28:17.935  WARN 15 --- [https-jsse-nio-7071-exec-9] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:28:17.935  WARN 15 --- [https-jsse-nio-7071-exec-9] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:28:17.935  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: under-emergency, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@793f0738
2022-01-16 11:28:17.964  INFO 15 --- [https-jsse-nio-7071-exec-9] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18910948971937781-38094, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:patient-under-active-emergency:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=patient-under-active-emergency, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 3 - Patient under active emergency, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:28:17.965  INFO 15 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=b25ef20e-391c-4e76-bdad-63ae9fc379a2, content=DENY, timestamp=1642332497965, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:patient-under-active-emergency:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=patient-under-active-emergency, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 3 - Patient under active emergency, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:28:17.966  INFO 15 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=95ms, Total=100ms
2022-01-16 11:28:18.009  INFO 15 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=3eeec81d-f92b-41d8-94c9-9bb1202e9e2f, content=null, timestamp=1642332497989, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=51606, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=5eea89d14d1a, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=999d21b7-cecf-4b75-ae67-bd5c244cfd50, http-req-server-port=80, http-header-accept=*/*, kc-id=917038d1-218a-4de3-bc21-524ee9b1ec1f, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642332497986, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQCfHNxAH4AEQAAAABh5AFQdAAkOTE3MDM4ZDEtMjE4YS00ZGUzLWJjMjEtNTI0ZWU5YjFlYzFmdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ5OTlkMjFiNy1jZWNmLTRiNzUtYWU2Ny1iZDVjMjQ0Y2ZkNTBwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJKS2NmeHpNR3dHQmVVTmNCczVvZ2tZclhKNlRJX0hyQi04Y3BuakZDa0lZIn0.eyJleHAiOjE2NDIzMzI3OTYsImlhdCI6MTY0MjMzMjQ5NiwianRpIjoiOTE3MDM4ZDEtMjE4YS00ZGUzLWJjMjEtNTI0ZWU5YjFlYzFmIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiI5OTlkMjFiNy1jZWNmLTRiNzUtYWU2Ny1iZDVjMjQ0Y2ZkNTAiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.TNPdGgstBT5KMl1zUUFYUdWBWAX1vTqDRLObIX6Hfm6TD1yNq3YIfGvVs8ew9FkCUjHZv2RxDXwap4ZBgU1XWNfgbY7lRnbcXLwKQVYJ_UngYNYkyfIeNM6f6obFgnYgUZWmuKJPNDWSwOXgaOQYUKn2Kwg84g2RElqDZmS17N-Zrmrpfozma14xSG38xXRYv-xLzM1EYvvOzmGuxWAUpVDlg0H-jAo7M5on-TNuilMfy2lmX-fR8QdyJczEmqrtLszHB-gRh60Vzm3zoDrkhMJEU1EZKqYn9jSEl8QuQahpjS-rHQw5sSk-pQAr0VHiulVAKkKycSls-Wms7_8olg, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre/read, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642332796, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.240.10, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=C6BEE26D24F2A7C8C9EBAAD35E837BF9, http-session-last-accessed-time=1642332497986, kc-category-name=ACCESS, kc-iat=1642332496, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:51606 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:28:18.012  INFO 15 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:28:18.013  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1699bd3c
2022-01-16 11:28:18.015  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1699bd3c
2022-01-16 11:28:18.026  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1699bd3c
2022-01-16 11:28:18.026  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1699bd3c
2022-01-16 11:28:18.086  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1699bd3c
2022-01-16 11:28:18.086  WARN 15 --- [https-jsse-nio-7071-exec-10] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:28:18.087  WARN 15 --- [https-jsse-nio-7071-exec-10] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:28:18.087  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: under-emergency, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1699bd3c
2022-01-16 11:28:18.098  INFO 15 --- [https-jsse-nio-7071-exec-10] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18910949113877606-787753, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:patient-under-active-emergency:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=patient-under-active-emergency, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 3 - Patient under active emergency, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:28:18.099  INFO 15 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=3eeec81d-f92b-41d8-94c9-9bb1202e9e2f, content=DENY, timestamp=1642332498099, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:patient-under-active-emergency:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=patient-under-active-emergency, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 3 - Patient under active emergency, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:28:18.099  INFO 15 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=87ms, Total=92ms
2022-01-16 11:28:18.136  INFO 15 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=4ed2fb54-1f6a-4ee2-a658-2c47e047bd7f, content=null, timestamp=1642332498122, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=51608, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=5eea89d14d1a, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=999d21b7-cecf-4b75-ae67-bd5c244cfd50, http-req-server-port=80, http-header-accept=*/*, kc-id=917038d1-218a-4de3-bc21-524ee9b1ec1f, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642332498118, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQCfHNxAH4AEQAAAABh5AFQdAAkOTE3MDM4ZDEtMjE4YS00ZGUzLWJjMjEtNTI0ZWU5YjFlYzFmdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ5OTlkMjFiNy1jZWNmLTRiNzUtYWU2Ny1iZDVjMjQ0Y2ZkNTBwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJKS2NmeHpNR3dHQmVVTmNCczVvZ2tZclhKNlRJX0hyQi04Y3BuakZDa0lZIn0.eyJleHAiOjE2NDIzMzI3OTYsImlhdCI6MTY0MjMzMjQ5NiwianRpIjoiOTE3MDM4ZDEtMjE4YS00ZGUzLWJjMjEtNTI0ZWU5YjFlYzFmIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiI5OTlkMjFiNy1jZWNmLTRiNzUtYWU2Ny1iZDVjMjQ0Y2ZkNTAiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.TNPdGgstBT5KMl1zUUFYUdWBWAX1vTqDRLObIX6Hfm6TD1yNq3YIfGvVs8ew9FkCUjHZv2RxDXwap4ZBgU1XWNfgbY7lRnbcXLwKQVYJ_UngYNYkyfIeNM6f6obFgnYgUZWmuKJPNDWSwOXgaOQYUKn2Kwg84g2RElqDZmS17N-Zrmrpfozma14xSG38xXRYv-xLzM1EYvvOzmGuxWAUpVDlg0H-jAo7M5on-TNuilMfy2lmX-fR8QdyJczEmqrtLszHB-gRh60Vzm3zoDrkhMJEU1EZKqYn9jSEl8QuQahpjS-rHQw5sSk-pQAr0VHiulVAKkKycSls-Wms7_8olg, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre/read, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642332796, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.240.10, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=764FDEA891F87709682A394DFEB4CE62, http-session-last-accessed-time=1642332498118, kc-category-name=ACCESS, kc-iat=1642332496, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:51608 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:28:18.138  INFO 15 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:28:18.140  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2804fb2e
2022-01-16 11:28:18.141  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2804fb2e
2022-01-16 11:28:18.153  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2804fb2e
2022-01-16 11:28:18.153  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2804fb2e
2022-01-16 11:28:18.164  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2804fb2e
2022-01-16 11:28:18.165  WARN 15 --- [https-jsse-nio-7071-exec-1] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:28:18.165  WARN 15 --- [https-jsse-nio-7071-exec-1] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:28:18.165  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: under-emergency, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2804fb2e
2022-01-16 11:28:18.222  INFO 15 --- [https-jsse-nio-7071-exec-1] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18910949240049650-529224, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:patient-under-active-emergency:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=patient-under-active-emergency, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 3 - Patient under active emergency, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:28:18.223  INFO 15 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=4ed2fb54-1f6a-4ee2-a658-2c47e047bd7f, content=DENY, timestamp=1642332498223, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:patient-under-active-emergency:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=patient-under-active-emergency, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 3 - Patient under active emergency, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:28:18.224  INFO 15 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=84ms, Total=91ms
2022-01-16 11:28:18.251  INFO 15 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=8710f32b-0e1c-4159-a040-526678bb4ced, content=null, timestamp=1642332498242, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=51610, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=5eea89d14d1a, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=999d21b7-cecf-4b75-ae67-bd5c244cfd50, http-req-server-port=80, http-header-accept=*/*, kc-id=917038d1-218a-4de3-bc21-524ee9b1ec1f, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642332498240, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQCfHNxAH4AEQAAAABh5AFQdAAkOTE3MDM4ZDEtMjE4YS00ZGUzLWJjMjEtNTI0ZWU5YjFlYzFmdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ5OTlkMjFiNy1jZWNmLTRiNzUtYWU2Ny1iZDVjMjQ0Y2ZkNTBwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJKS2NmeHpNR3dHQmVVTmNCczVvZ2tZclhKNlRJX0hyQi04Y3BuakZDa0lZIn0.eyJleHAiOjE2NDIzMzI3OTYsImlhdCI6MTY0MjMzMjQ5NiwianRpIjoiOTE3MDM4ZDEtMjE4YS00ZGUzLWJjMjEtNTI0ZWU5YjFlYzFmIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiI5OTlkMjFiNy1jZWNmLTRiNzUtYWU2Ny1iZDVjMjQ0Y2ZkNTAiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.TNPdGgstBT5KMl1zUUFYUdWBWAX1vTqDRLObIX6Hfm6TD1yNq3YIfGvVs8ew9FkCUjHZv2RxDXwap4ZBgU1XWNfgbY7lRnbcXLwKQVYJ_UngYNYkyfIeNM6f6obFgnYgUZWmuKJPNDWSwOXgaOQYUKn2Kwg84g2RElqDZmS17N-Zrmrpfozma14xSG38xXRYv-xLzM1EYvvOzmGuxWAUpVDlg0H-jAo7M5on-TNuilMfy2lmX-fR8QdyJczEmqrtLszHB-gRh60Vzm3zoDrkhMJEU1EZKqYn9jSEl8QuQahpjS-rHQw5sSk-pQAr0VHiulVAKkKycSls-Wms7_8olg, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre/read, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642332796, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.240.10, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=E61E95328CD3C3307AC36227D4AF0384, http-session-last-accessed-time=1642332498240, kc-category-name=ACCESS, kc-iat=1642332496, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:51610 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:28:18.252  INFO 15 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:28:18.253  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@54d2150f
2022-01-16 11:28:18.254  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@54d2150f
2022-01-16 11:28:18.264  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@54d2150f
2022-01-16 11:28:18.265  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@54d2150f
2022-01-16 11:28:18.273  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@54d2150f
2022-01-16 11:28:18.274  WARN 15 --- [https-jsse-nio-7071-exec-2] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:28:18.274  WARN 15 --- [https-jsse-nio-7071-exec-2] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:28:18.275  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: under-emergency, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@54d2150f
2022-01-16 11:28:18.326  INFO 15 --- [https-jsse-nio-7071-exec-2] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18910949353893862-87854, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:patient-under-active-emergency:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=patient-under-active-emergency, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 3 - Patient under active emergency, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:28:18.327  INFO 15 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=8710f32b-0e1c-4159-a040-526678bb4ced, content=DENY, timestamp=1642332498327, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:patient-under-active-emergency:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=patient-under-active-emergency, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 3 - Patient under active emergency, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:28:18.328  INFO 15 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=75ms, Total=79ms
2022-01-16 11:28:18.350  INFO 15 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=78c0b8fe-be0e-49e2-9294-616600102d19, content=null, timestamp=1642332498343, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=51612, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=5eea89d14d1a, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=999d21b7-cecf-4b75-ae67-bd5c244cfd50, http-req-server-port=80, http-header-accept=*/*, kc-id=917038d1-218a-4de3-bc21-524ee9b1ec1f, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642332498341, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQCfHNxAH4AEQAAAABh5AFQdAAkOTE3MDM4ZDEtMjE4YS00ZGUzLWJjMjEtNTI0ZWU5YjFlYzFmdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ5OTlkMjFiNy1jZWNmLTRiNzUtYWU2Ny1iZDVjMjQ0Y2ZkNTBwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJKS2NmeHpNR3dHQmVVTmNCczVvZ2tZclhKNlRJX0hyQi04Y3BuakZDa0lZIn0.eyJleHAiOjE2NDIzMzI3OTYsImlhdCI6MTY0MjMzMjQ5NiwianRpIjoiOTE3MDM4ZDEtMjE4YS00ZGUzLWJjMjEtNTI0ZWU5YjFlYzFmIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiI5OTlkMjFiNy1jZWNmLTRiNzUtYWU2Ny1iZDVjMjQ0Y2ZkNTAiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.TNPdGgstBT5KMl1zUUFYUdWBWAX1vTqDRLObIX6Hfm6TD1yNq3YIfGvVs8ew9FkCUjHZv2RxDXwap4ZBgU1XWNfgbY7lRnbcXLwKQVYJ_UngYNYkyfIeNM6f6obFgnYgUZWmuKJPNDWSwOXgaOQYUKn2Kwg84g2RElqDZmS17N-Zrmrpfozma14xSG38xXRYv-xLzM1EYvvOzmGuxWAUpVDlg0H-jAo7M5on-TNuilMfy2lmX-fR8QdyJczEmqrtLszHB-gRh60Vzm3zoDrkhMJEU1EZKqYn9jSEl8QuQahpjS-rHQw5sSk-pQAr0VHiulVAKkKycSls-Wms7_8olg, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre/read, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642332796, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.240.10, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=7E802FD5AF82623210FD56B4E6659213, http-session-last-accessed-time=1642332498341, kc-category-name=ACCESS, kc-iat=1642332496, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:51612 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:28:18.351  INFO 15 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:28:18.353  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@71c9e91f
2022-01-16 11:28:18.353  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@71c9e91f
2022-01-16 11:28:18.363  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@71c9e91f
2022-01-16 11:28:18.364  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@71c9e91f
2022-01-16 11:28:18.371  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@71c9e91f
2022-01-16 11:28:18.371  WARN 15 --- [https-jsse-nio-7071-exec-3] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:28:18.372  WARN 15 --- [https-jsse-nio-7071-exec-3] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:28:18.372  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: under-emergency, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@71c9e91f
2022-01-16 11:28:18.427  INFO 15 --- [https-jsse-nio-7071-exec-3] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18910949453094735-677604, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:patient-under-active-emergency:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=patient-under-active-emergency, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 3 - Patient under active emergency, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:28:18.427  INFO 15 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=78c0b8fe-be0e-49e2-9294-616600102d19, content=DENY, timestamp=1642332498427, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:patient-under-active-emergency:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=patient-under-active-emergency, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 3 - Patient under active emergency, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:28:18.428  INFO 15 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=75ms, Total=81ms
2022-01-16 11:28:18.451  INFO 15 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=5a72a178-ab73-403c-9e83-8c814b38c3f3, content=null, timestamp=1642332498443, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=51614, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=5eea89d14d1a, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=999d21b7-cecf-4b75-ae67-bd5c244cfd50, http-req-server-port=80, http-header-accept=*/*, kc-id=917038d1-218a-4de3-bc21-524ee9b1ec1f, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642332498441, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQCfHNxAH4AEQAAAABh5AFQdAAkOTE3MDM4ZDEtMjE4YS00ZGUzLWJjMjEtNTI0ZWU5YjFlYzFmdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ5OTlkMjFiNy1jZWNmLTRiNzUtYWU2Ny1iZDVjMjQ0Y2ZkNTBwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJKS2NmeHpNR3dHQmVVTmNCczVvZ2tZclhKNlRJX0hyQi04Y3BuakZDa0lZIn0.eyJleHAiOjE2NDIzMzI3OTYsImlhdCI6MTY0MjMzMjQ5NiwianRpIjoiOTE3MDM4ZDEtMjE4YS00ZGUzLWJjMjEtNTI0ZWU5YjFlYzFmIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiI5OTlkMjFiNy1jZWNmLTRiNzUtYWU2Ny1iZDVjMjQ0Y2ZkNTAiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.TNPdGgstBT5KMl1zUUFYUdWBWAX1vTqDRLObIX6Hfm6TD1yNq3YIfGvVs8ew9FkCUjHZv2RxDXwap4ZBgU1XWNfgbY7lRnbcXLwKQVYJ_UngYNYkyfIeNM6f6obFgnYgUZWmuKJPNDWSwOXgaOQYUKn2Kwg84g2RElqDZmS17N-Zrmrpfozma14xSG38xXRYv-xLzM1EYvvOzmGuxWAUpVDlg0H-jAo7M5on-TNuilMfy2lmX-fR8QdyJczEmqrtLszHB-gRh60Vzm3zoDrkhMJEU1EZKqYn9jSEl8QuQahpjS-rHQw5sSk-pQAr0VHiulVAKkKycSls-Wms7_8olg, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre/read, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642332796, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.240.10, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=B1DB9D1BFBC47462593DB538912699BA, http-session-last-accessed-time=1642332498441, kc-category-name=ACCESS, kc-iat=1642332496, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:51614 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:28:18.461  INFO 15 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:28:18.463  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@32f58d1e
2022-01-16 11:28:18.463  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@32f58d1e
2022-01-16 11:28:18.475  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@32f58d1e
2022-01-16 11:28:18.476  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@32f58d1e
2022-01-16 11:28:18.483  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@32f58d1e
2022-01-16 11:28:18.484  WARN 15 --- [https-jsse-nio-7071-exec-3] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:28:18.484  WARN 15 --- [https-jsse-nio-7071-exec-3] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:28:18.485  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: under-emergency, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@32f58d1e
2022-01-16 11:28:18.534  INFO 15 --- [https-jsse-nio-7071-exec-3] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18910949562562912-22865, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:patient-under-active-emergency:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=patient-under-active-emergency, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 3 - Patient under active emergency, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:28:18.535  INFO 15 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=5a72a178-ab73-403c-9e83-8c814b38c3f3, content=DENY, timestamp=1642332498535, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:patient-under-active-emergency:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=patient-under-active-emergency, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 3 - Patient under active emergency, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:28:18.536  INFO 15 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=74ms, Total=88ms
2022-01-16 11:28:18.562  INFO 15 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=15cf7e87-e076-48d0-9d6f-fb67295154e2, content=null, timestamp=1642332498550, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=51616, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=5eea89d14d1a, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=999d21b7-cecf-4b75-ae67-bd5c244cfd50, http-req-server-port=80, http-header-accept=*/*, kc-id=917038d1-218a-4de3-bc21-524ee9b1ec1f, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642332498548, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQCfHNxAH4AEQAAAABh5AFQdAAkOTE3MDM4ZDEtMjE4YS00ZGUzLWJjMjEtNTI0ZWU5YjFlYzFmdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ5OTlkMjFiNy1jZWNmLTRiNzUtYWU2Ny1iZDVjMjQ0Y2ZkNTBwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJKS2NmeHpNR3dHQmVVTmNCczVvZ2tZclhKNlRJX0hyQi04Y3BuakZDa0lZIn0.eyJleHAiOjE2NDIzMzI3OTYsImlhdCI6MTY0MjMzMjQ5NiwianRpIjoiOTE3MDM4ZDEtMjE4YS00ZGUzLWJjMjEtNTI0ZWU5YjFlYzFmIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiI5OTlkMjFiNy1jZWNmLTRiNzUtYWU2Ny1iZDVjMjQ0Y2ZkNTAiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.TNPdGgstBT5KMl1zUUFYUdWBWAX1vTqDRLObIX6Hfm6TD1yNq3YIfGvVs8ew9FkCUjHZv2RxDXwap4ZBgU1XWNfgbY7lRnbcXLwKQVYJ_UngYNYkyfIeNM6f6obFgnYgUZWmuKJPNDWSwOXgaOQYUKn2Kwg84g2RElqDZmS17N-Zrmrpfozma14xSG38xXRYv-xLzM1EYvvOzmGuxWAUpVDlg0H-jAo7M5on-TNuilMfy2lmX-fR8QdyJczEmqrtLszHB-gRh60Vzm3zoDrkhMJEU1EZKqYn9jSEl8QuQahpjS-rHQw5sSk-pQAr0VHiulVAKkKycSls-Wms7_8olg, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre/read, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642332796, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.240.10, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=43D73CA793F9BB818DADCFB823516051, http-session-last-accessed-time=1642332498548, kc-category-name=ACCESS, kc-iat=1642332496, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:51616 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:28:18.563  INFO 15 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:28:18.565  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@23431fe
2022-01-16 11:28:18.566  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@23431fe
2022-01-16 11:28:18.576  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@23431fe
2022-01-16 11:28:18.577  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@23431fe
2022-01-16 11:28:18.585  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@23431fe
2022-01-16 11:28:18.585  WARN 15 --- [https-jsse-nio-7071-exec-4] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:28:18.585  WARN 15 --- [https-jsse-nio-7071-exec-4] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:28:18.586  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: under-emergency, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@23431fe
2022-01-16 11:28:18.634  INFO 15 --- [https-jsse-nio-7071-exec-4] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18910949665319296-608675, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:patient-under-active-emergency:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=patient-under-active-emergency, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 3 - Patient under active emergency, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:28:18.634  INFO 15 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=15cf7e87-e076-48d0-9d6f-fb67295154e2, content=DENY, timestamp=1642332498634, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:patient-under-active-emergency:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=patient-under-active-emergency, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 3 - Patient under active emergency, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:28:18.635  INFO 15 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=70ms, Total=77ms
2022-01-16 11:28:18.663  INFO 15 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=7e777989-797f-411a-9cf4-d7e0acacde45, content=null, timestamp=1642332498652, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=51618, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=5eea89d14d1a, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=999d21b7-cecf-4b75-ae67-bd5c244cfd50, http-req-server-port=80, http-header-accept=*/*, kc-id=917038d1-218a-4de3-bc21-524ee9b1ec1f, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642332498651, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQCfHNxAH4AEQAAAABh5AFQdAAkOTE3MDM4ZDEtMjE4YS00ZGUzLWJjMjEtNTI0ZWU5YjFlYzFmdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ5OTlkMjFiNy1jZWNmLTRiNzUtYWU2Ny1iZDVjMjQ0Y2ZkNTBwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJKS2NmeHpNR3dHQmVVTmNCczVvZ2tZclhKNlRJX0hyQi04Y3BuakZDa0lZIn0.eyJleHAiOjE2NDIzMzI3OTYsImlhdCI6MTY0MjMzMjQ5NiwianRpIjoiOTE3MDM4ZDEtMjE4YS00ZGUzLWJjMjEtNTI0ZWU5YjFlYzFmIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiI5OTlkMjFiNy1jZWNmLTRiNzUtYWU2Ny1iZDVjMjQ0Y2ZkNTAiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.TNPdGgstBT5KMl1zUUFYUdWBWAX1vTqDRLObIX6Hfm6TD1yNq3YIfGvVs8ew9FkCUjHZv2RxDXwap4ZBgU1XWNfgbY7lRnbcXLwKQVYJ_UngYNYkyfIeNM6f6obFgnYgUZWmuKJPNDWSwOXgaOQYUKn2Kwg84g2RElqDZmS17N-Zrmrpfozma14xSG38xXRYv-xLzM1EYvvOzmGuxWAUpVDlg0H-jAo7M5on-TNuilMfy2lmX-fR8QdyJczEmqrtLszHB-gRh60Vzm3zoDrkhMJEU1EZKqYn9jSEl8QuQahpjS-rHQw5sSk-pQAr0VHiulVAKkKycSls-Wms7_8olg, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre/read, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642332796, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.240.10, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=7CAA0354196D10D038F350AF3F1EA408, http-session-last-accessed-time=1642332498651, kc-category-name=ACCESS, kc-iat=1642332496, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:51618 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:28:18.664  INFO 15 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:28:18.665  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5b0059f6
2022-01-16 11:28:18.665  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5b0059f6
2022-01-16 11:28:18.675  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5b0059f6
2022-01-16 11:28:18.676  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5b0059f6
2022-01-16 11:28:18.683  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5b0059f6
2022-01-16 11:28:18.684  WARN 15 --- [https-jsse-nio-7071-exec-5] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:28:18.684  WARN 15 --- [https-jsse-nio-7071-exec-5] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:28:18.685  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: under-emergency, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5b0059f6
2022-01-16 11:28:18.734  INFO 15 --- [https-jsse-nio-7071-exec-5] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18910949765466005-819996, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:patient-under-active-emergency:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=patient-under-active-emergency, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 3 - Patient under active emergency, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:28:18.734  INFO 15 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=7e777989-797f-411a-9cf4-d7e0acacde45, content=DENY, timestamp=1642332498734, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:patient-under-active-emergency:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=patient-under-active-emergency, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 3 - Patient under active emergency, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:28:18.735  INFO 15 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=70ms, Total=74ms
2022-01-16 11:28:18.757  INFO 15 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=bf66b935-ac3f-446c-ad6b-792b757b9413, content=null, timestamp=1642332498750, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=51620, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=5eea89d14d1a, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=999d21b7-cecf-4b75-ae67-bd5c244cfd50, http-req-server-port=80, http-header-accept=*/*, kc-id=917038d1-218a-4de3-bc21-524ee9b1ec1f, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642332498749, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQCfHNxAH4AEQAAAABh5AFQdAAkOTE3MDM4ZDEtMjE4YS00ZGUzLWJjMjEtNTI0ZWU5YjFlYzFmdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ5OTlkMjFiNy1jZWNmLTRiNzUtYWU2Ny1iZDVjMjQ0Y2ZkNTBwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJKS2NmeHpNR3dHQmVVTmNCczVvZ2tZclhKNlRJX0hyQi04Y3BuakZDa0lZIn0.eyJleHAiOjE2NDIzMzI3OTYsImlhdCI6MTY0MjMzMjQ5NiwianRpIjoiOTE3MDM4ZDEtMjE4YS00ZGUzLWJjMjEtNTI0ZWU5YjFlYzFmIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiI5OTlkMjFiNy1jZWNmLTRiNzUtYWU2Ny1iZDVjMjQ0Y2ZkNTAiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.TNPdGgstBT5KMl1zUUFYUdWBWAX1vTqDRLObIX6Hfm6TD1yNq3YIfGvVs8ew9FkCUjHZv2RxDXwap4ZBgU1XWNfgbY7lRnbcXLwKQVYJ_UngYNYkyfIeNM6f6obFgnYgUZWmuKJPNDWSwOXgaOQYUKn2Kwg84g2RElqDZmS17N-Zrmrpfozma14xSG38xXRYv-xLzM1EYvvOzmGuxWAUpVDlg0H-jAo7M5on-TNuilMfy2lmX-fR8QdyJczEmqrtLszHB-gRh60Vzm3zoDrkhMJEU1EZKqYn9jSEl8QuQahpjS-rHQw5sSk-pQAr0VHiulVAKkKycSls-Wms7_8olg, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre/read, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642332796, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.240.10, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=DE4667039A4B10BC9EEAC6275B490D02, http-session-last-accessed-time=1642332498749, kc-category-name=ACCESS, kc-iat=1642332496, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:51620 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:28:18.758  INFO 15 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:28:18.759  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5f4fdfe2
2022-01-16 11:28:18.760  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5f4fdfe2
2022-01-16 11:28:18.769  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5f4fdfe2
2022-01-16 11:28:18.770  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5f4fdfe2
2022-01-16 11:28:18.777  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5f4fdfe2
2022-01-16 11:28:18.778  WARN 15 --- [https-jsse-nio-7071-exec-6] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:28:18.778  WARN 15 --- [https-jsse-nio-7071-exec-6] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:28:18.779  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: under-emergency, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5f4fdfe2
2022-01-16 11:28:18.834  INFO 15 --- [https-jsse-nio-7071-exec-6] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18910949859972215-583056, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:patient-under-active-emergency:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=patient-under-active-emergency, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 3 - Patient under active emergency, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:28:18.835  INFO 15 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=bf66b935-ac3f-446c-ad6b-792b757b9413, content=DENY, timestamp=1642332498835, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:patient-under-active-emergency:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=patient-under-active-emergency, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 3 - Patient under active emergency, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:28:18.836  INFO 15 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=77ms, Total=81ms
2022-01-16 11:28:18.856  INFO 15 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=63eb2d0e-9ca6-4e19-8d4d-28fff0469941, content=null, timestamp=1642332498850, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=51622, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=5eea89d14d1a, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=999d21b7-cecf-4b75-ae67-bd5c244cfd50, http-req-server-port=80, http-header-accept=*/*, kc-id=917038d1-218a-4de3-bc21-524ee9b1ec1f, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642332498848, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQCfHNxAH4AEQAAAABh5AFQdAAkOTE3MDM4ZDEtMjE4YS00ZGUzLWJjMjEtNTI0ZWU5YjFlYzFmdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ5OTlkMjFiNy1jZWNmLTRiNzUtYWU2Ny1iZDVjMjQ0Y2ZkNTBwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJKS2NmeHpNR3dHQmVVTmNCczVvZ2tZclhKNlRJX0hyQi04Y3BuakZDa0lZIn0.eyJleHAiOjE2NDIzMzI3OTYsImlhdCI6MTY0MjMzMjQ5NiwianRpIjoiOTE3MDM4ZDEtMjE4YS00ZGUzLWJjMjEtNTI0ZWU5YjFlYzFmIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiI5OTlkMjFiNy1jZWNmLTRiNzUtYWU2Ny1iZDVjMjQ0Y2ZkNTAiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.TNPdGgstBT5KMl1zUUFYUdWBWAX1vTqDRLObIX6Hfm6TD1yNq3YIfGvVs8ew9FkCUjHZv2RxDXwap4ZBgU1XWNfgbY7lRnbcXLwKQVYJ_UngYNYkyfIeNM6f6obFgnYgUZWmuKJPNDWSwOXgaOQYUKn2Kwg84g2RElqDZmS17N-Zrmrpfozma14xSG38xXRYv-xLzM1EYvvOzmGuxWAUpVDlg0H-jAo7M5on-TNuilMfy2lmX-fR8QdyJczEmqrtLszHB-gRh60Vzm3zoDrkhMJEU1EZKqYn9jSEl8QuQahpjS-rHQw5sSk-pQAr0VHiulVAKkKycSls-Wms7_8olg, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre/read, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642332796, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.240.10, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=DE28D4E87F985C76B7AC549FDAE074EA, http-session-last-accessed-time=1642332498848, kc-category-name=ACCESS, kc-iat=1642332496, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:51622 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:28:18.858  INFO 15 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:28:18.859  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2f9b33a1
2022-01-16 11:28:18.860  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2f9b33a1
2022-01-16 11:28:18.873  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2f9b33a1
2022-01-16 11:28:18.874  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2f9b33a1
2022-01-16 11:28:18.882  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2f9b33a1
2022-01-16 11:28:18.883  WARN 15 --- [https-jsse-nio-7071-exec-7] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:28:18.883  WARN 15 --- [https-jsse-nio-7071-exec-7] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:28:18.883  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: under-emergency, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2f9b33a1
2022-01-16 11:28:18.935  INFO 15 --- [https-jsse-nio-7071-exec-7] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18910949959750950-655190, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:patient-under-active-emergency:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=patient-under-active-emergency, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 3 - Patient under active emergency, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:28:18.935  INFO 15 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=63eb2d0e-9ca6-4e19-8d4d-28fff0469941, content=DENY, timestamp=1642332498935, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:patient-under-active-emergency:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=patient-under-active-emergency, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 3 - Patient under active emergency, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:28:18.936  INFO 15 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=77ms, Total=82ms
2022-01-16 11:28:18.995  INFO 15 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=78e7a9c4-7a5c-4953-90fd-1836877c9e9c, content=null, timestamp=1642332498984, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=51624, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=5eea89d14d1a, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=999d21b7-cecf-4b75-ae67-bd5c244cfd50, http-req-server-port=80, http-header-accept=*/*, kc-id=917038d1-218a-4de3-bc21-524ee9b1ec1f, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642332498980, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQCfHNxAH4AEQAAAABh5AFQdAAkOTE3MDM4ZDEtMjE4YS00ZGUzLWJjMjEtNTI0ZWU5YjFlYzFmdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ5OTlkMjFiNy1jZWNmLTRiNzUtYWU2Ny1iZDVjMjQ0Y2ZkNTBwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJKS2NmeHpNR3dHQmVVTmNCczVvZ2tZclhKNlRJX0hyQi04Y3BuakZDa0lZIn0.eyJleHAiOjE2NDIzMzI3OTYsImlhdCI6MTY0MjMzMjQ5NiwianRpIjoiOTE3MDM4ZDEtMjE4YS00ZGUzLWJjMjEtNTI0ZWU5YjFlYzFmIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiI5OTlkMjFiNy1jZWNmLTRiNzUtYWU2Ny1iZDVjMjQ0Y2ZkNTAiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.TNPdGgstBT5KMl1zUUFYUdWBWAX1vTqDRLObIX6Hfm6TD1yNq3YIfGvVs8ew9FkCUjHZv2RxDXwap4ZBgU1XWNfgbY7lRnbcXLwKQVYJ_UngYNYkyfIeNM6f6obFgnYgUZWmuKJPNDWSwOXgaOQYUKn2Kwg84g2RElqDZmS17N-Zrmrpfozma14xSG38xXRYv-xLzM1EYvvOzmGuxWAUpVDlg0H-jAo7M5on-TNuilMfy2lmX-fR8QdyJczEmqrtLszHB-gRh60Vzm3zoDrkhMJEU1EZKqYn9jSEl8QuQahpjS-rHQw5sSk-pQAr0VHiulVAKkKycSls-Wms7_8olg, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre/read, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642332796, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.240.10, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=3724C3A67C6DE98ECB2723E2796AB6CE, http-session-last-accessed-time=1642332498980, kc-category-name=ACCESS, kc-iat=1642332496, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:51624 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:28:18.999  INFO 15 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:28:19.000  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@32bd43bf
2022-01-16 11:28:19.001  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@32bd43bf
2022-01-16 11:28:19.023  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@32bd43bf
2022-01-16 11:28:19.024  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@32bd43bf
2022-01-16 11:28:19.041  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@32bd43bf
2022-01-16 11:28:19.042  WARN 15 --- [https-jsse-nio-7071-exec-8] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:28:19.042  WARN 15 --- [https-jsse-nio-7071-exec-8] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:28:19.043  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: under-emergency, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@32bd43bf
2022-01-16 11:28:19.052  INFO 15 --- [https-jsse-nio-7071-exec-8] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18910950100705651-227568, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:patient-under-active-emergency:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=patient-under-active-emergency, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 3 - Patient under active emergency, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:28:19.052  INFO 15 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=78e7a9c4-7a5c-4953-90fd-1836877c9e9c, content=DENY, timestamp=1642332499052, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:patient-under-active-emergency:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=patient-under-active-emergency, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 3 - Patient under active emergency, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:28:19.054  INFO 15 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=53ms, Total=62ms
2022-01-16 11:28:19.082  INFO 15 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=69202ace-6576-4fdf-9aa8-2f5064e10a46, content=null, timestamp=1642332499073, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=51626, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=5eea89d14d1a, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=999d21b7-cecf-4b75-ae67-bd5c244cfd50, http-req-server-port=80, http-header-accept=*/*, kc-id=917038d1-218a-4de3-bc21-524ee9b1ec1f, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642332499072, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQCfHNxAH4AEQAAAABh5AFQdAAkOTE3MDM4ZDEtMjE4YS00ZGUzLWJjMjEtNTI0ZWU5YjFlYzFmdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ5OTlkMjFiNy1jZWNmLTRiNzUtYWU2Ny1iZDVjMjQ0Y2ZkNTBwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJKS2NmeHpNR3dHQmVVTmNCczVvZ2tZclhKNlRJX0hyQi04Y3BuakZDa0lZIn0.eyJleHAiOjE2NDIzMzI3OTYsImlhdCI6MTY0MjMzMjQ5NiwianRpIjoiOTE3MDM4ZDEtMjE4YS00ZGUzLWJjMjEtNTI0ZWU5YjFlYzFmIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiI5OTlkMjFiNy1jZWNmLTRiNzUtYWU2Ny1iZDVjMjQ0Y2ZkNTAiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.TNPdGgstBT5KMl1zUUFYUdWBWAX1vTqDRLObIX6Hfm6TD1yNq3YIfGvVs8ew9FkCUjHZv2RxDXwap4ZBgU1XWNfgbY7lRnbcXLwKQVYJ_UngYNYkyfIeNM6f6obFgnYgUZWmuKJPNDWSwOXgaOQYUKn2Kwg84g2RElqDZmS17N-Zrmrpfozma14xSG38xXRYv-xLzM1EYvvOzmGuxWAUpVDlg0H-jAo7M5on-TNuilMfy2lmX-fR8QdyJczEmqrtLszHB-gRh60Vzm3zoDrkhMJEU1EZKqYn9jSEl8QuQahpjS-rHQw5sSk-pQAr0VHiulVAKkKycSls-Wms7_8olg, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre/read, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642332796, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.240.10, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=492CE1088C48F0BCB7401A566864C799, http-session-last-accessed-time=1642332499072, kc-category-name=ACCESS, kc-iat=1642332496, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:51626 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:28:19.082  INFO 15 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:28:19.083  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@58a7a327
2022-01-16 11:28:19.084  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@58a7a327
2022-01-16 11:28:19.142  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@58a7a327
2022-01-16 11:28:19.142  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@58a7a327
2022-01-16 11:28:19.157  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@58a7a327
2022-01-16 11:28:19.157  WARN 15 --- [https-jsse-nio-7071-exec-9] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:28:19.158  WARN 15 --- [https-jsse-nio-7071-exec-9] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:28:19.158  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: under-emergency, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@58a7a327
2022-01-16 11:28:19.169  INFO 15 --- [https-jsse-nio-7071-exec-9] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18910950183972132-362800, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:patient-under-active-emergency:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=patient-under-active-emergency, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 3 - Patient under active emergency, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:28:19.170  INFO 15 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=69202ace-6576-4fdf-9aa8-2f5064e10a46, content=DENY, timestamp=1642332499170, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:patient-under-active-emergency:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=patient-under-active-emergency, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 3 - Patient under active emergency, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:28:19.171  INFO 15 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=88ms, Total=91ms
2022-01-16 11:28:19.200  INFO 15 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=0d0081aa-4261-4d00-9906-8274b2f695ff, content=null, timestamp=1642332499188, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=51628, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=5eea89d14d1a, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=999d21b7-cecf-4b75-ae67-bd5c244cfd50, http-req-server-port=80, http-header-accept=*/*, kc-id=917038d1-218a-4de3-bc21-524ee9b1ec1f, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642332499187, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQCfHNxAH4AEQAAAABh5AFQdAAkOTE3MDM4ZDEtMjE4YS00ZGUzLWJjMjEtNTI0ZWU5YjFlYzFmdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ5OTlkMjFiNy1jZWNmLTRiNzUtYWU2Ny1iZDVjMjQ0Y2ZkNTBwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJKS2NmeHpNR3dHQmVVTmNCczVvZ2tZclhKNlRJX0hyQi04Y3BuakZDa0lZIn0.eyJleHAiOjE2NDIzMzI3OTYsImlhdCI6MTY0MjMzMjQ5NiwianRpIjoiOTE3MDM4ZDEtMjE4YS00ZGUzLWJjMjEtNTI0ZWU5YjFlYzFmIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiI5OTlkMjFiNy1jZWNmLTRiNzUtYWU2Ny1iZDVjMjQ0Y2ZkNTAiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.TNPdGgstBT5KMl1zUUFYUdWBWAX1vTqDRLObIX6Hfm6TD1yNq3YIfGvVs8ew9FkCUjHZv2RxDXwap4ZBgU1XWNfgbY7lRnbcXLwKQVYJ_UngYNYkyfIeNM6f6obFgnYgUZWmuKJPNDWSwOXgaOQYUKn2Kwg84g2RElqDZmS17N-Zrmrpfozma14xSG38xXRYv-xLzM1EYvvOzmGuxWAUpVDlg0H-jAo7M5on-TNuilMfy2lmX-fR8QdyJczEmqrtLszHB-gRh60Vzm3zoDrkhMJEU1EZKqYn9jSEl8QuQahpjS-rHQw5sSk-pQAr0VHiulVAKkKycSls-Wms7_8olg, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre/read, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642332796, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.240.10, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=8F812B496C134BFFD7566F1C38AECA12, http-session-last-accessed-time=1642332499187, kc-category-name=ACCESS, kc-iat=1642332496, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:51628 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:28:19.201  INFO 15 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:28:19.202  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@377ce3d7
2022-01-16 11:28:19.203  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@377ce3d7
2022-01-16 11:28:19.254  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@377ce3d7
2022-01-16 11:28:19.254  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@377ce3d7
2022-01-16 11:28:19.263  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@377ce3d7
2022-01-16 11:28:19.263  WARN 15 --- [https-jsse-nio-7071-exec-10] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:28:19.263  WARN 15 --- [https-jsse-nio-7071-exec-10] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:28:19.264  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: under-emergency, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@377ce3d7
2022-01-16 11:28:19.272  INFO 15 --- [https-jsse-nio-7071-exec-10] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18910950302786856-703541, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:patient-under-active-emergency:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=patient-under-active-emergency, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 3 - Patient under active emergency, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:28:19.272  INFO 15 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=0d0081aa-4261-4d00-9906-8274b2f695ff, content=DENY, timestamp=1642332499272, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:patient-under-active-emergency:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=patient-under-active-emergency, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 3 - Patient under active emergency, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:28:19.273  INFO 15 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=71ms, Total=80ms
2022-01-16 11:28:19.296  INFO 15 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=8b736a31-c9bd-4eee-b242-b706209c39ce, content=null, timestamp=1642332499287, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=51630, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=5eea89d14d1a, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=999d21b7-cecf-4b75-ae67-bd5c244cfd50, http-req-server-port=80, http-header-accept=*/*, kc-id=917038d1-218a-4de3-bc21-524ee9b1ec1f, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642332499286, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQCfHNxAH4AEQAAAABh5AFQdAAkOTE3MDM4ZDEtMjE4YS00ZGUzLWJjMjEtNTI0ZWU5YjFlYzFmdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ5OTlkMjFiNy1jZWNmLTRiNzUtYWU2Ny1iZDVjMjQ0Y2ZkNTBwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJKS2NmeHpNR3dHQmVVTmNCczVvZ2tZclhKNlRJX0hyQi04Y3BuakZDa0lZIn0.eyJleHAiOjE2NDIzMzI3OTYsImlhdCI6MTY0MjMzMjQ5NiwianRpIjoiOTE3MDM4ZDEtMjE4YS00ZGUzLWJjMjEtNTI0ZWU5YjFlYzFmIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiI5OTlkMjFiNy1jZWNmLTRiNzUtYWU2Ny1iZDVjMjQ0Y2ZkNTAiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.TNPdGgstBT5KMl1zUUFYUdWBWAX1vTqDRLObIX6Hfm6TD1yNq3YIfGvVs8ew9FkCUjHZv2RxDXwap4ZBgU1XWNfgbY7lRnbcXLwKQVYJ_UngYNYkyfIeNM6f6obFgnYgUZWmuKJPNDWSwOXgaOQYUKn2Kwg84g2RElqDZmS17N-Zrmrpfozma14xSG38xXRYv-xLzM1EYvvOzmGuxWAUpVDlg0H-jAo7M5on-TNuilMfy2lmX-fR8QdyJczEmqrtLszHB-gRh60Vzm3zoDrkhMJEU1EZKqYn9jSEl8QuQahpjS-rHQw5sSk-pQAr0VHiulVAKkKycSls-Wms7_8olg, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre/read, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642332796, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.240.10, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=FD83538756DB530E88DB5A51A86C34A1, http-session-last-accessed-time=1642332499286, kc-category-name=ACCESS, kc-iat=1642332496, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:51630 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:28:19.296  INFO 15 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:28:19.298  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@626ccaf0
2022-01-16 11:28:19.299  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@626ccaf0
2022-01-16 11:28:19.350  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@626ccaf0
2022-01-16 11:28:19.351  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@626ccaf0
2022-01-16 11:28:19.360  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@626ccaf0
2022-01-16 11:28:19.360  WARN 15 --- [https-jsse-nio-7071-exec-1] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:28:19.360  WARN 15 --- [https-jsse-nio-7071-exec-1] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:28:19.361  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: under-emergency, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@626ccaf0
2022-01-16 11:28:19.369  INFO 15 --- [https-jsse-nio-7071-exec-1] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18910950398221492-104697, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:patient-under-active-emergency:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=patient-under-active-emergency, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 3 - Patient under active emergency, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:28:19.369  INFO 15 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=8b736a31-c9bd-4eee-b242-b706209c39ce, content=DENY, timestamp=1642332499369, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:patient-under-active-emergency:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=patient-under-active-emergency, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 3 - Patient under active emergency, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:28:19.370  INFO 15 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=72ms, Total=76ms
2022-01-16 11:28:19.397  INFO 15 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=15a23638-dc1c-48a1-9389-5a73e9c3f903, content=null, timestamp=1642332499384, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=51632, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=5eea89d14d1a, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=999d21b7-cecf-4b75-ae67-bd5c244cfd50, http-req-server-port=80, http-header-accept=*/*, kc-id=917038d1-218a-4de3-bc21-524ee9b1ec1f, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642332499383, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQCfHNxAH4AEQAAAABh5AFQdAAkOTE3MDM4ZDEtMjE4YS00ZGUzLWJjMjEtNTI0ZWU5YjFlYzFmdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ5OTlkMjFiNy1jZWNmLTRiNzUtYWU2Ny1iZDVjMjQ0Y2ZkNTBwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJKS2NmeHpNR3dHQmVVTmNCczVvZ2tZclhKNlRJX0hyQi04Y3BuakZDa0lZIn0.eyJleHAiOjE2NDIzMzI3OTYsImlhdCI6MTY0MjMzMjQ5NiwianRpIjoiOTE3MDM4ZDEtMjE4YS00ZGUzLWJjMjEtNTI0ZWU5YjFlYzFmIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiI5OTlkMjFiNy1jZWNmLTRiNzUtYWU2Ny1iZDVjMjQ0Y2ZkNTAiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.TNPdGgstBT5KMl1zUUFYUdWBWAX1vTqDRLObIX6Hfm6TD1yNq3YIfGvVs8ew9FkCUjHZv2RxDXwap4ZBgU1XWNfgbY7lRnbcXLwKQVYJ_UngYNYkyfIeNM6f6obFgnYgUZWmuKJPNDWSwOXgaOQYUKn2Kwg84g2RElqDZmS17N-Zrmrpfozma14xSG38xXRYv-xLzM1EYvvOzmGuxWAUpVDlg0H-jAo7M5on-TNuilMfy2lmX-fR8QdyJczEmqrtLszHB-gRh60Vzm3zoDrkhMJEU1EZKqYn9jSEl8QuQahpjS-rHQw5sSk-pQAr0VHiulVAKkKycSls-Wms7_8olg, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre/read, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642332796, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.240.10, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=FC976160331EA63425520E3553190B1F, http-session-last-accessed-time=1642332499383, kc-category-name=ACCESS, kc-iat=1642332496, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:51632 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:28:19.400  INFO 15 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:28:19.402  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1e1274d6
2022-01-16 11:28:19.402  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1e1274d6
2022-01-16 11:28:19.453  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1e1274d6
2022-01-16 11:28:19.454  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1e1274d6
2022-01-16 11:28:19.462  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1e1274d6
2022-01-16 11:28:19.463  WARN 15 --- [https-jsse-nio-7071-exec-2] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:28:19.463  WARN 15 --- [https-jsse-nio-7071-exec-2] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:28:19.464  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: under-emergency, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1e1274d6
2022-01-16 11:28:19.472  INFO 15 --- [https-jsse-nio-7071-exec-2] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18910950502224613-633794, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:patient-under-active-emergency:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=patient-under-active-emergency, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 3 - Patient under active emergency, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:28:19.473  INFO 15 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=15a23638-dc1c-48a1-9389-5a73e9c3f903, content=DENY, timestamp=1642332499473, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:patient-under-active-emergency:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=patient-under-active-emergency, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 3 - Patient under active emergency, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:28:19.474  INFO 15 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=72ms, Total=79ms
2022-01-16 11:28:19.491  INFO 15 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=3f954053-99e7-4584-ac58-b65811a4891c, content=null, timestamp=1642332499487, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=51634, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=5eea89d14d1a, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=999d21b7-cecf-4b75-ae67-bd5c244cfd50, http-req-server-port=80, http-header-accept=*/*, kc-id=917038d1-218a-4de3-bc21-524ee9b1ec1f, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642332499486, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQCfHNxAH4AEQAAAABh5AFQdAAkOTE3MDM4ZDEtMjE4YS00ZGUzLWJjMjEtNTI0ZWU5YjFlYzFmdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ5OTlkMjFiNy1jZWNmLTRiNzUtYWU2Ny1iZDVjMjQ0Y2ZkNTBwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJKS2NmeHpNR3dHQmVVTmNCczVvZ2tZclhKNlRJX0hyQi04Y3BuakZDa0lZIn0.eyJleHAiOjE2NDIzMzI3OTYsImlhdCI6MTY0MjMzMjQ5NiwianRpIjoiOTE3MDM4ZDEtMjE4YS00ZGUzLWJjMjEtNTI0ZWU5YjFlYzFmIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiI5OTlkMjFiNy1jZWNmLTRiNzUtYWU2Ny1iZDVjMjQ0Y2ZkNTAiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.TNPdGgstBT5KMl1zUUFYUdWBWAX1vTqDRLObIX6Hfm6TD1yNq3YIfGvVs8ew9FkCUjHZv2RxDXwap4ZBgU1XWNfgbY7lRnbcXLwKQVYJ_UngYNYkyfIeNM6f6obFgnYgUZWmuKJPNDWSwOXgaOQYUKn2Kwg84g2RElqDZmS17N-Zrmrpfozma14xSG38xXRYv-xLzM1EYvvOzmGuxWAUpVDlg0H-jAo7M5on-TNuilMfy2lmX-fR8QdyJczEmqrtLszHB-gRh60Vzm3zoDrkhMJEU1EZKqYn9jSEl8QuQahpjS-rHQw5sSk-pQAr0VHiulVAKkKycSls-Wms7_8olg, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre/read, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642332796, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.240.10, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=80F54EA1D126FA2DACEB373FEFE70437, http-session-last-accessed-time=1642332499486, kc-category-name=ACCESS, kc-iat=1642332496, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:51634 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:28:19.493  INFO 15 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:28:19.495  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4aeed868
2022-01-16 11:28:19.495  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4aeed868
2022-01-16 11:28:19.546  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4aeed868
2022-01-16 11:28:19.547  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4aeed868
2022-01-16 11:28:19.558  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4aeed868
2022-01-16 11:28:19.559  WARN 15 --- [https-jsse-nio-7071-exec-2] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:28:19.559  WARN 15 --- [https-jsse-nio-7071-exec-2] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:28:19.559  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: under-emergency, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4aeed868
2022-01-16 11:28:19.568  INFO 15 --- [https-jsse-nio-7071-exec-2] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18910950595425796-509302, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:patient-under-active-emergency:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=patient-under-active-emergency, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 3 - Patient under active emergency, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:28:19.568  INFO 15 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=3f954053-99e7-4584-ac58-b65811a4891c, content=DENY, timestamp=1642332499568, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:patient-under-active-emergency:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=patient-under-active-emergency, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 3 - Patient under active emergency, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:28:19.569  INFO 15 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=74ms, Total=79ms
2022-01-16 11:28:19.590  INFO 15 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=90c03764-2448-41c3-857f-04ae401610c5, content=null, timestamp=1642332499584, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=51636, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=5eea89d14d1a, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=999d21b7-cecf-4b75-ae67-bd5c244cfd50, http-req-server-port=80, http-header-accept=*/*, kc-id=917038d1-218a-4de3-bc21-524ee9b1ec1f, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642332499583, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQCfHNxAH4AEQAAAABh5AFQdAAkOTE3MDM4ZDEtMjE4YS00ZGUzLWJjMjEtNTI0ZWU5YjFlYzFmdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ5OTlkMjFiNy1jZWNmLTRiNzUtYWU2Ny1iZDVjMjQ0Y2ZkNTBwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJKS2NmeHpNR3dHQmVVTmNCczVvZ2tZclhKNlRJX0hyQi04Y3BuakZDa0lZIn0.eyJleHAiOjE2NDIzMzI3OTYsImlhdCI6MTY0MjMzMjQ5NiwianRpIjoiOTE3MDM4ZDEtMjE4YS00ZGUzLWJjMjEtNTI0ZWU5YjFlYzFmIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiI5OTlkMjFiNy1jZWNmLTRiNzUtYWU2Ny1iZDVjMjQ0Y2ZkNTAiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.TNPdGgstBT5KMl1zUUFYUdWBWAX1vTqDRLObIX6Hfm6TD1yNq3YIfGvVs8ew9FkCUjHZv2RxDXwap4ZBgU1XWNfgbY7lRnbcXLwKQVYJ_UngYNYkyfIeNM6f6obFgnYgUZWmuKJPNDWSwOXgaOQYUKn2Kwg84g2RElqDZmS17N-Zrmrpfozma14xSG38xXRYv-xLzM1EYvvOzmGuxWAUpVDlg0H-jAo7M5on-TNuilMfy2lmX-fR8QdyJczEmqrtLszHB-gRh60Vzm3zoDrkhMJEU1EZKqYn9jSEl8QuQahpjS-rHQw5sSk-pQAr0VHiulVAKkKycSls-Wms7_8olg, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre/read, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642332796, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.240.10, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=851264677BCD118D2E21A30C51679947, http-session-last-accessed-time=1642332499583, kc-category-name=ACCESS, kc-iat=1642332496, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:51636 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:28:19.594  INFO 15 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:28:19.595  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@388edd2f
2022-01-16 11:28:19.596  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@388edd2f
2022-01-16 11:28:19.646  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@388edd2f
2022-01-16 11:28:19.647  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@388edd2f
2022-01-16 11:28:19.658  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@388edd2f
2022-01-16 11:28:19.658  WARN 15 --- [https-jsse-nio-7071-exec-4] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:28:19.659  WARN 15 --- [https-jsse-nio-7071-exec-4] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:28:19.659  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: under-emergency, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@388edd2f
2022-01-16 11:28:19.667  INFO 15 --- [https-jsse-nio-7071-exec-4] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18910950695961233-700156, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:patient-under-active-emergency:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=patient-under-active-emergency, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 3 - Patient under active emergency, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:28:19.667  INFO 15 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=90c03764-2448-41c3-857f-04ae401610c5, content=DENY, timestamp=1642332499667, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:patient-under-active-emergency:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=patient-under-active-emergency, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 3 - Patient under active emergency, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:28:19.668  INFO 15 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=73ms, Total=79ms
2022-01-16 11:28:19.685  INFO 15 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=2b8a1aa2-a374-417c-807d-15953c9a306b, content=null, timestamp=1642332499680, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=51638, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=5eea89d14d1a, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=999d21b7-cecf-4b75-ae67-bd5c244cfd50, http-req-server-port=80, http-header-accept=*/*, kc-id=917038d1-218a-4de3-bc21-524ee9b1ec1f, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642332499679, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQCfHNxAH4AEQAAAABh5AFQdAAkOTE3MDM4ZDEtMjE4YS00ZGUzLWJjMjEtNTI0ZWU5YjFlYzFmdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ5OTlkMjFiNy1jZWNmLTRiNzUtYWU2Ny1iZDVjMjQ0Y2ZkNTBwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJKS2NmeHpNR3dHQmVVTmNCczVvZ2tZclhKNlRJX0hyQi04Y3BuakZDa0lZIn0.eyJleHAiOjE2NDIzMzI3OTYsImlhdCI6MTY0MjMzMjQ5NiwianRpIjoiOTE3MDM4ZDEtMjE4YS00ZGUzLWJjMjEtNTI0ZWU5YjFlYzFmIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiI5OTlkMjFiNy1jZWNmLTRiNzUtYWU2Ny1iZDVjMjQ0Y2ZkNTAiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.TNPdGgstBT5KMl1zUUFYUdWBWAX1vTqDRLObIX6Hfm6TD1yNq3YIfGvVs8ew9FkCUjHZv2RxDXwap4ZBgU1XWNfgbY7lRnbcXLwKQVYJ_UngYNYkyfIeNM6f6obFgnYgUZWmuKJPNDWSwOXgaOQYUKn2Kwg84g2RElqDZmS17N-Zrmrpfozma14xSG38xXRYv-xLzM1EYvvOzmGuxWAUpVDlg0H-jAo7M5on-TNuilMfy2lmX-fR8QdyJczEmqrtLszHB-gRh60Vzm3zoDrkhMJEU1EZKqYn9jSEl8QuQahpjS-rHQw5sSk-pQAr0VHiulVAKkKycSls-Wms7_8olg, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre/read, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642332796, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.240.10, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=8FEC407212EB6742FFA4F66B59B2E905, http-session-last-accessed-time=1642332499679, kc-category-name=ACCESS, kc-iat=1642332496, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:51638 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:28:19.686  INFO 15 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:28:19.687  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@26dc29c4
2022-01-16 11:28:19.688  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@26dc29c4
2022-01-16 11:28:19.738  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@26dc29c4
2022-01-16 11:28:19.738  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@26dc29c4
2022-01-16 11:28:19.746  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@26dc29c4
2022-01-16 11:28:19.746  WARN 15 --- [https-jsse-nio-7071-exec-5] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:28:19.746  WARN 15 --- [https-jsse-nio-7071-exec-5] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:28:19.746  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: under-emergency, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@26dc29c4
2022-01-16 11:28:19.754  INFO 15 --- [https-jsse-nio-7071-exec-5] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18910950787970092-861353, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:patient-under-active-emergency:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=patient-under-active-emergency, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 3 - Patient under active emergency, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:28:19.754  INFO 15 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=2b8a1aa2-a374-417c-807d-15953c9a306b, content=DENY, timestamp=1642332499754, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:patient-under-active-emergency:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=patient-under-active-emergency, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 3 - Patient under active emergency, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:28:19.756  INFO 15 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=68ms, Total=72ms
2022-01-16 11:28:19.772  INFO 15 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=eaeffdc9-cad4-4fc3-a712-07e02d38b1b5, content=null, timestamp=1642332499767, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=51640, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=5eea89d14d1a, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=999d21b7-cecf-4b75-ae67-bd5c244cfd50, http-req-server-port=80, http-header-accept=*/*, kc-id=917038d1-218a-4de3-bc21-524ee9b1ec1f, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642332499766, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQCfHNxAH4AEQAAAABh5AFQdAAkOTE3MDM4ZDEtMjE4YS00ZGUzLWJjMjEtNTI0ZWU5YjFlYzFmdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ5OTlkMjFiNy1jZWNmLTRiNzUtYWU2Ny1iZDVjMjQ0Y2ZkNTBwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJKS2NmeHpNR3dHQmVVTmNCczVvZ2tZclhKNlRJX0hyQi04Y3BuakZDa0lZIn0.eyJleHAiOjE2NDIzMzI3OTYsImlhdCI6MTY0MjMzMjQ5NiwianRpIjoiOTE3MDM4ZDEtMjE4YS00ZGUzLWJjMjEtNTI0ZWU5YjFlYzFmIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiI5OTlkMjFiNy1jZWNmLTRiNzUtYWU2Ny1iZDVjMjQ0Y2ZkNTAiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.TNPdGgstBT5KMl1zUUFYUdWBWAX1vTqDRLObIX6Hfm6TD1yNq3YIfGvVs8ew9FkCUjHZv2RxDXwap4ZBgU1XWNfgbY7lRnbcXLwKQVYJ_UngYNYkyfIeNM6f6obFgnYgUZWmuKJPNDWSwOXgaOQYUKn2Kwg84g2RElqDZmS17N-Zrmrpfozma14xSG38xXRYv-xLzM1EYvvOzmGuxWAUpVDlg0H-jAo7M5on-TNuilMfy2lmX-fR8QdyJczEmqrtLszHB-gRh60Vzm3zoDrkhMJEU1EZKqYn9jSEl8QuQahpjS-rHQw5sSk-pQAr0VHiulVAKkKycSls-Wms7_8olg, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre/read, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642332796, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.240.10, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=29C8E8A3CBF6C23308D32E0788DF1623, http-session-last-accessed-time=1642332499766, kc-category-name=ACCESS, kc-iat=1642332496, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:51640 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:28:19.773  INFO 15 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:28:19.775  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6b763acb
2022-01-16 11:28:19.775  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6b763acb
2022-01-16 11:28:19.826  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6b763acb
2022-01-16 11:28:19.826  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6b763acb
2022-01-16 11:28:19.834  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6b763acb
2022-01-16 11:28:19.834  WARN 15 --- [https-jsse-nio-7071-exec-6] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:28:19.834  WARN 15 --- [https-jsse-nio-7071-exec-6] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:28:19.835  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: under-emergency, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6b763acb
2022-01-16 11:28:19.842  INFO 15 --- [https-jsse-nio-7071-exec-6] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18910950875519858-297659, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:patient-under-active-emergency:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=patient-under-active-emergency, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 3 - Patient under active emergency, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:28:19.842  INFO 15 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=eaeffdc9-cad4-4fc3-a712-07e02d38b1b5, content=DENY, timestamp=1642332499842, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:patient-under-active-emergency:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=patient-under-active-emergency, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 3 - Patient under active emergency, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:28:19.843  INFO 15 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=68ms, Total=72ms
2022-01-16 11:28:19.861  INFO 15 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=0fa92eef-b3c8-4256-86f1-53a50d6a037b, content=null, timestamp=1642332499856, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=51642, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=5eea89d14d1a, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=999d21b7-cecf-4b75-ae67-bd5c244cfd50, http-req-server-port=80, http-header-accept=*/*, kc-id=917038d1-218a-4de3-bc21-524ee9b1ec1f, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642332499855, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQCfHNxAH4AEQAAAABh5AFQdAAkOTE3MDM4ZDEtMjE4YS00ZGUzLWJjMjEtNTI0ZWU5YjFlYzFmdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ5OTlkMjFiNy1jZWNmLTRiNzUtYWU2Ny1iZDVjMjQ0Y2ZkNTBwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJKS2NmeHpNR3dHQmVVTmNCczVvZ2tZclhKNlRJX0hyQi04Y3BuakZDa0lZIn0.eyJleHAiOjE2NDIzMzI3OTYsImlhdCI6MTY0MjMzMjQ5NiwianRpIjoiOTE3MDM4ZDEtMjE4YS00ZGUzLWJjMjEtNTI0ZWU5YjFlYzFmIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiI5OTlkMjFiNy1jZWNmLTRiNzUtYWU2Ny1iZDVjMjQ0Y2ZkNTAiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.TNPdGgstBT5KMl1zUUFYUdWBWAX1vTqDRLObIX6Hfm6TD1yNq3YIfGvVs8ew9FkCUjHZv2RxDXwap4ZBgU1XWNfgbY7lRnbcXLwKQVYJ_UngYNYkyfIeNM6f6obFgnYgUZWmuKJPNDWSwOXgaOQYUKn2Kwg84g2RElqDZmS17N-Zrmrpfozma14xSG38xXRYv-xLzM1EYvvOzmGuxWAUpVDlg0H-jAo7M5on-TNuilMfy2lmX-fR8QdyJczEmqrtLszHB-gRh60Vzm3zoDrkhMJEU1EZKqYn9jSEl8QuQahpjS-rHQw5sSk-pQAr0VHiulVAKkKycSls-Wms7_8olg, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre/read, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642332796, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.240.10, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=3AEAC502C68C0F16D6DF6ACFA1FFBCA0, http-session-last-accessed-time=1642332499855, kc-category-name=ACCESS, kc-iat=1642332496, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:51642 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:28:19.862  INFO 15 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:28:19.863  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6cbf0f66
2022-01-16 11:28:19.863  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6cbf0f66
2022-01-16 11:28:19.914  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6cbf0f66
2022-01-16 11:28:19.914  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6cbf0f66
2022-01-16 11:28:19.926  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6cbf0f66
2022-01-16 11:28:19.927  WARN 15 --- [https-jsse-nio-7071-exec-7] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:28:19.927  WARN 15 --- [https-jsse-nio-7071-exec-7] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:28:19.928  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: under-emergency, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6cbf0f66
2022-01-16 11:28:19.935  INFO 15 --- [https-jsse-nio-7071-exec-7] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18910950963457051-954080, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:patient-under-active-emergency:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=patient-under-active-emergency, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 3 - Patient under active emergency, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:28:19.936  INFO 15 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=0fa92eef-b3c8-4256-86f1-53a50d6a037b, content=DENY, timestamp=1642332499936, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:patient-under-active-emergency:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=patient-under-active-emergency, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 3 - Patient under active emergency, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:28:19.937  INFO 15 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=74ms, Total=77ms
2022-01-16 11:28:19.956  INFO 15 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=c3dac061-e983-4e1e-85ec-027af9ae4a67, content=null, timestamp=1642332499949, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=51644, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=5eea89d14d1a, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=999d21b7-cecf-4b75-ae67-bd5c244cfd50, http-req-server-port=80, http-header-accept=*/*, kc-id=917038d1-218a-4de3-bc21-524ee9b1ec1f, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642332499948, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQCfHNxAH4AEQAAAABh5AFQdAAkOTE3MDM4ZDEtMjE4YS00ZGUzLWJjMjEtNTI0ZWU5YjFlYzFmdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ5OTlkMjFiNy1jZWNmLTRiNzUtYWU2Ny1iZDVjMjQ0Y2ZkNTBwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJKS2NmeHpNR3dHQmVVTmNCczVvZ2tZclhKNlRJX0hyQi04Y3BuakZDa0lZIn0.eyJleHAiOjE2NDIzMzI3OTYsImlhdCI6MTY0MjMzMjQ5NiwianRpIjoiOTE3MDM4ZDEtMjE4YS00ZGUzLWJjMjEtNTI0ZWU5YjFlYzFmIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiI5OTlkMjFiNy1jZWNmLTRiNzUtYWU2Ny1iZDVjMjQ0Y2ZkNTAiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.TNPdGgstBT5KMl1zUUFYUdWBWAX1vTqDRLObIX6Hfm6TD1yNq3YIfGvVs8ew9FkCUjHZv2RxDXwap4ZBgU1XWNfgbY7lRnbcXLwKQVYJ_UngYNYkyfIeNM6f6obFgnYgUZWmuKJPNDWSwOXgaOQYUKn2Kwg84g2RElqDZmS17N-Zrmrpfozma14xSG38xXRYv-xLzM1EYvvOzmGuxWAUpVDlg0H-jAo7M5on-TNuilMfy2lmX-fR8QdyJczEmqrtLszHB-gRh60Vzm3zoDrkhMJEU1EZKqYn9jSEl8QuQahpjS-rHQw5sSk-pQAr0VHiulVAKkKycSls-Wms7_8olg, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre/read, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642332796, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.240.10, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=FBCE25E63DBBF014EBE7C42B7E21DF5F, http-session-last-accessed-time=1642332499948, kc-category-name=ACCESS, kc-iat=1642332496, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:51644 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:28:19.956  INFO 15 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:28:19.957  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@c3ccdae
2022-01-16 11:28:19.958  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@c3ccdae
2022-01-16 11:28:20.010  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@c3ccdae
2022-01-16 11:28:20.010  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@c3ccdae
2022-01-16 11:28:20.024  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@c3ccdae
2022-01-16 11:28:20.024  WARN 15 --- [https-jsse-nio-7071-exec-8] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:28:20.025  WARN 15 --- [https-jsse-nio-7071-exec-8] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:28:20.025  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: under-emergency, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@c3ccdae
2022-01-16 11:28:20.034  INFO 15 --- [https-jsse-nio-7071-exec-8] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18910951057969125-865715, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:patient-under-active-emergency:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=patient-under-active-emergency, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 3 - Patient under active emergency, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:28:20.035  INFO 15 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=c3dac061-e983-4e1e-85ec-027af9ae4a67, content=DENY, timestamp=1642332500035, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:patient-under-active-emergency:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=patient-under-active-emergency, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 3 - Patient under active emergency, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:28:20.036  INFO 15 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=79ms, Total=81ms
2022-01-16 11:28:20.062  INFO 15 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=f397e7e9-170c-4b5e-b335-d2a1f13681b8, content=null, timestamp=1642332500053, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=51646, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=5eea89d14d1a, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=999d21b7-cecf-4b75-ae67-bd5c244cfd50, http-req-server-port=80, http-header-accept=*/*, kc-id=917038d1-218a-4de3-bc21-524ee9b1ec1f, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642332500052, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQCfHNxAH4AEQAAAABh5AFQdAAkOTE3MDM4ZDEtMjE4YS00ZGUzLWJjMjEtNTI0ZWU5YjFlYzFmdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ5OTlkMjFiNy1jZWNmLTRiNzUtYWU2Ny1iZDVjMjQ0Y2ZkNTBwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJKS2NmeHpNR3dHQmVVTmNCczVvZ2tZclhKNlRJX0hyQi04Y3BuakZDa0lZIn0.eyJleHAiOjE2NDIzMzI3OTYsImlhdCI6MTY0MjMzMjQ5NiwianRpIjoiOTE3MDM4ZDEtMjE4YS00ZGUzLWJjMjEtNTI0ZWU5YjFlYzFmIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiI5OTlkMjFiNy1jZWNmLTRiNzUtYWU2Ny1iZDVjMjQ0Y2ZkNTAiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.TNPdGgstBT5KMl1zUUFYUdWBWAX1vTqDRLObIX6Hfm6TD1yNq3YIfGvVs8ew9FkCUjHZv2RxDXwap4ZBgU1XWNfgbY7lRnbcXLwKQVYJ_UngYNYkyfIeNM6f6obFgnYgUZWmuKJPNDWSwOXgaOQYUKn2Kwg84g2RElqDZmS17N-Zrmrpfozma14xSG38xXRYv-xLzM1EYvvOzmGuxWAUpVDlg0H-jAo7M5on-TNuilMfy2lmX-fR8QdyJczEmqrtLszHB-gRh60Vzm3zoDrkhMJEU1EZKqYn9jSEl8QuQahpjS-rHQw5sSk-pQAr0VHiulVAKkKycSls-Wms7_8olg, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre/read, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642332796, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.240.10, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=851A4983539FBF050FE93CF0B3096A3C, http-session-last-accessed-time=1642332500052, kc-category-name=ACCESS, kc-iat=1642332496, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:51646 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:28:20.063  INFO 15 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:28:20.065  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@361b86b4
2022-01-16 11:28:20.066  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@361b86b4
2022-01-16 11:28:20.118  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@361b86b4
2022-01-16 11:28:20.119  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@361b86b4
2022-01-16 11:28:20.137  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@361b86b4
2022-01-16 11:28:20.137  WARN 15 --- [https-jsse-nio-7071-exec-9] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:28:20.137  WARN 15 --- [https-jsse-nio-7071-exec-9] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:28:20.138  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: under-emergency, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@361b86b4
2022-01-16 11:28:20.148  INFO 15 --- [https-jsse-nio-7071-exec-9] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18910951164359360-184391, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:patient-under-active-emergency:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=patient-under-active-emergency, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 3 - Patient under active emergency, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:28:20.148  INFO 15 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=f397e7e9-170c-4b5e-b335-d2a1f13681b8, content=DENY, timestamp=1642332500148, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:patient-under-active-emergency:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=patient-under-active-emergency, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 3 - Patient under active emergency, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:28:20.149  INFO 15 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=85ms, Total=88ms
2022-01-16 11:28:20.174  INFO 15 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=48f22e57-2612-465b-8b8c-06f1f0b49f90, content=null, timestamp=1642332500164, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=51648, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=5eea89d14d1a, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=999d21b7-cecf-4b75-ae67-bd5c244cfd50, http-req-server-port=80, http-header-accept=*/*, kc-id=917038d1-218a-4de3-bc21-524ee9b1ec1f, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642332500162, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQCfHNxAH4AEQAAAABh5AFQdAAkOTE3MDM4ZDEtMjE4YS00ZGUzLWJjMjEtNTI0ZWU5YjFlYzFmdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ5OTlkMjFiNy1jZWNmLTRiNzUtYWU2Ny1iZDVjMjQ0Y2ZkNTBwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJKS2NmeHpNR3dHQmVVTmNCczVvZ2tZclhKNlRJX0hyQi04Y3BuakZDa0lZIn0.eyJleHAiOjE2NDIzMzI3OTYsImlhdCI6MTY0MjMzMjQ5NiwianRpIjoiOTE3MDM4ZDEtMjE4YS00ZGUzLWJjMjEtNTI0ZWU5YjFlYzFmIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiI5OTlkMjFiNy1jZWNmLTRiNzUtYWU2Ny1iZDVjMjQ0Y2ZkNTAiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.TNPdGgstBT5KMl1zUUFYUdWBWAX1vTqDRLObIX6Hfm6TD1yNq3YIfGvVs8ew9FkCUjHZv2RxDXwap4ZBgU1XWNfgbY7lRnbcXLwKQVYJ_UngYNYkyfIeNM6f6obFgnYgUZWmuKJPNDWSwOXgaOQYUKn2Kwg84g2RElqDZmS17N-Zrmrpfozma14xSG38xXRYv-xLzM1EYvvOzmGuxWAUpVDlg0H-jAo7M5on-TNuilMfy2lmX-fR8QdyJczEmqrtLszHB-gRh60Vzm3zoDrkhMJEU1EZKqYn9jSEl8QuQahpjS-rHQw5sSk-pQAr0VHiulVAKkKycSls-Wms7_8olg, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre/read, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642332796, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.240.10, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=0B74F28BE9B75167246B23958852694C, http-session-last-accessed-time=1642332500162, kc-category-name=ACCESS, kc-iat=1642332496, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:51648 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:28:20.177  INFO 15 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:28:20.179  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5fbe010a
2022-01-16 11:28:20.181  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5fbe010a
2022-01-16 11:28:20.234  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5fbe010a
2022-01-16 11:28:20.234  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5fbe010a
2022-01-16 11:28:20.247  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5fbe010a
2022-01-16 11:28:20.248  WARN 15 --- [https-jsse-nio-7071-exec-10] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:28:20.248  WARN 15 --- [https-jsse-nio-7071-exec-10] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:28:20.248  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: under-emergency, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5fbe010a
2022-01-16 11:28:20.261  INFO 15 --- [https-jsse-nio-7071-exec-10] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18910951278324613-652134, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:patient-under-active-emergency:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=patient-under-active-emergency, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 3 - Patient under active emergency, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:28:20.261  INFO 15 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=48f22e57-2612-465b-8b8c-06f1f0b49f90, content=DENY, timestamp=1642332500261, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:patient-under-active-emergency:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=patient-under-active-emergency, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 3 - Patient under active emergency, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:28:20.262  INFO 15 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=84ms, Total=90ms
2022-01-16 11:28:20.290  INFO 15 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=356fe3e5-6064-4180-b170-cb326860fba5, content=null, timestamp=1642332500276, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=51650, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=5eea89d14d1a, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=999d21b7-cecf-4b75-ae67-bd5c244cfd50, http-req-server-port=80, http-header-accept=*/*, kc-id=917038d1-218a-4de3-bc21-524ee9b1ec1f, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642332500275, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQCfHNxAH4AEQAAAABh5AFQdAAkOTE3MDM4ZDEtMjE4YS00ZGUzLWJjMjEtNTI0ZWU5YjFlYzFmdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ5OTlkMjFiNy1jZWNmLTRiNzUtYWU2Ny1iZDVjMjQ0Y2ZkNTBwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJKS2NmeHpNR3dHQmVVTmNCczVvZ2tZclhKNlRJX0hyQi04Y3BuakZDa0lZIn0.eyJleHAiOjE2NDIzMzI3OTYsImlhdCI6MTY0MjMzMjQ5NiwianRpIjoiOTE3MDM4ZDEtMjE4YS00ZGUzLWJjMjEtNTI0ZWU5YjFlYzFmIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiI5OTlkMjFiNy1jZWNmLTRiNzUtYWU2Ny1iZDVjMjQ0Y2ZkNTAiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.TNPdGgstBT5KMl1zUUFYUdWBWAX1vTqDRLObIX6Hfm6TD1yNq3YIfGvVs8ew9FkCUjHZv2RxDXwap4ZBgU1XWNfgbY7lRnbcXLwKQVYJ_UngYNYkyfIeNM6f6obFgnYgUZWmuKJPNDWSwOXgaOQYUKn2Kwg84g2RElqDZmS17N-Zrmrpfozma14xSG38xXRYv-xLzM1EYvvOzmGuxWAUpVDlg0H-jAo7M5on-TNuilMfy2lmX-fR8QdyJczEmqrtLszHB-gRh60Vzm3zoDrkhMJEU1EZKqYn9jSEl8QuQahpjS-rHQw5sSk-pQAr0VHiulVAKkKycSls-Wms7_8olg, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre/read, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642332796, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.240.10, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=27D23692DA26672F4ACDD264A7CA820E, http-session-last-accessed-time=1642332500275, kc-category-name=ACCESS, kc-iat=1642332496, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:51650 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:28:20.290  INFO 15 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:28:20.292  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7a2833cf
2022-01-16 11:28:20.292  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7a2833cf
2022-01-16 11:28:20.342  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7a2833cf
2022-01-16 11:28:20.342  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7a2833cf
2022-01-16 11:28:20.356  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7a2833cf
2022-01-16 11:28:20.356  WARN 15 --- [https-jsse-nio-7071-exec-1] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:28:20.356  WARN 15 --- [https-jsse-nio-7071-exec-1] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:28:20.357  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: under-emergency, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7a2833cf
2022-01-16 11:28:20.370  INFO 15 --- [https-jsse-nio-7071-exec-1] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18910951391929521-746744, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:patient-under-active-emergency:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=patient-under-active-emergency, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 3 - Patient under active emergency, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:28:20.370  INFO 15 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=356fe3e5-6064-4180-b170-cb326860fba5, content=DENY, timestamp=1642332500370, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:patient-under-active-emergency:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=patient-under-active-emergency, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 3 - Patient under active emergency, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:28:20.371  INFO 15 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=80ms, Total=85ms
2022-01-16 11:28:20.395  INFO 15 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=446304ba-e020-4d8f-a037-c5cd38c003b1, content=null, timestamp=1642332500386, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=51652, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=5eea89d14d1a, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=999d21b7-cecf-4b75-ae67-bd5c244cfd50, http-req-server-port=80, http-header-accept=*/*, kc-id=917038d1-218a-4de3-bc21-524ee9b1ec1f, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642332500385, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQCfHNxAH4AEQAAAABh5AFQdAAkOTE3MDM4ZDEtMjE4YS00ZGUzLWJjMjEtNTI0ZWU5YjFlYzFmdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ5OTlkMjFiNy1jZWNmLTRiNzUtYWU2Ny1iZDVjMjQ0Y2ZkNTBwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJKS2NmeHpNR3dHQmVVTmNCczVvZ2tZclhKNlRJX0hyQi04Y3BuakZDa0lZIn0.eyJleHAiOjE2NDIzMzI3OTYsImlhdCI6MTY0MjMzMjQ5NiwianRpIjoiOTE3MDM4ZDEtMjE4YS00ZGUzLWJjMjEtNTI0ZWU5YjFlYzFmIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiI5OTlkMjFiNy1jZWNmLTRiNzUtYWU2Ny1iZDVjMjQ0Y2ZkNTAiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.TNPdGgstBT5KMl1zUUFYUdWBWAX1vTqDRLObIX6Hfm6TD1yNq3YIfGvVs8ew9FkCUjHZv2RxDXwap4ZBgU1XWNfgbY7lRnbcXLwKQVYJ_UngYNYkyfIeNM6f6obFgnYgUZWmuKJPNDWSwOXgaOQYUKn2Kwg84g2RElqDZmS17N-Zrmrpfozma14xSG38xXRYv-xLzM1EYvvOzmGuxWAUpVDlg0H-jAo7M5on-TNuilMfy2lmX-fR8QdyJczEmqrtLszHB-gRh60Vzm3zoDrkhMJEU1EZKqYn9jSEl8QuQahpjS-rHQw5sSk-pQAr0VHiulVAKkKycSls-Wms7_8olg, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre/read, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642332796, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.240.10, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=7E9971FF2FC87E17680503746D43869C, http-session-last-accessed-time=1642332500385, kc-category-name=ACCESS, kc-iat=1642332496, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:51652 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:28:20.395  INFO 15 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:28:20.396  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@443efd02
2022-01-16 11:28:20.397  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@443efd02
2022-01-16 11:28:20.446  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@443efd02
2022-01-16 11:28:20.446  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@443efd02
2022-01-16 11:28:20.456  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@443efd02
2022-01-16 11:28:20.457  WARN 15 --- [https-jsse-nio-7071-exec-3] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:28:20.457  WARN 15 --- [https-jsse-nio-7071-exec-3] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:28:20.457  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: under-emergency, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@443efd02
2022-01-16 11:28:20.465  INFO 15 --- [https-jsse-nio-7071-exec-3] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18910951496756968-860042, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:patient-under-active-emergency:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=patient-under-active-emergency, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 3 - Patient under active emergency, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:28:20.465  INFO 15 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=446304ba-e020-4d8f-a037-c5cd38c003b1, content=DENY, timestamp=1642332500465, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:patient-under-active-emergency:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=patient-under-active-emergency, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 3 - Patient under active emergency, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:28:20.466  INFO 15 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=70ms, Total=73ms
2022-01-16 11:28:20.485  INFO 15 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=96794288-703d-44e8-bee0-6e68a6b109ce, content=null, timestamp=1642332500479, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=51654, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=5eea89d14d1a, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=999d21b7-cecf-4b75-ae67-bd5c244cfd50, http-req-server-port=80, http-header-accept=*/*, kc-id=917038d1-218a-4de3-bc21-524ee9b1ec1f, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642332500478, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQCfHNxAH4AEQAAAABh5AFQdAAkOTE3MDM4ZDEtMjE4YS00ZGUzLWJjMjEtNTI0ZWU5YjFlYzFmdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ5OTlkMjFiNy1jZWNmLTRiNzUtYWU2Ny1iZDVjMjQ0Y2ZkNTBwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJKS2NmeHpNR3dHQmVVTmNCczVvZ2tZclhKNlRJX0hyQi04Y3BuakZDa0lZIn0.eyJleHAiOjE2NDIzMzI3OTYsImlhdCI6MTY0MjMzMjQ5NiwianRpIjoiOTE3MDM4ZDEtMjE4YS00ZGUzLWJjMjEtNTI0ZWU5YjFlYzFmIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiI5OTlkMjFiNy1jZWNmLTRiNzUtYWU2Ny1iZDVjMjQ0Y2ZkNTAiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.TNPdGgstBT5KMl1zUUFYUdWBWAX1vTqDRLObIX6Hfm6TD1yNq3YIfGvVs8ew9FkCUjHZv2RxDXwap4ZBgU1XWNfgbY7lRnbcXLwKQVYJ_UngYNYkyfIeNM6f6obFgnYgUZWmuKJPNDWSwOXgaOQYUKn2Kwg84g2RElqDZmS17N-Zrmrpfozma14xSG38xXRYv-xLzM1EYvvOzmGuxWAUpVDlg0H-jAo7M5on-TNuilMfy2lmX-fR8QdyJczEmqrtLszHB-gRh60Vzm3zoDrkhMJEU1EZKqYn9jSEl8QuQahpjS-rHQw5sSk-pQAr0VHiulVAKkKycSls-Wms7_8olg, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre/read, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642332796, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.240.10, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=6BA2CEB00340AD5B2B16E0C7830B27EF, http-session-last-accessed-time=1642332500478, kc-category-name=ACCESS, kc-iat=1642332496, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:51654 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:28:20.486  INFO 15 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:28:20.487  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5b156cc4
2022-01-16 11:28:20.488  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5b156cc4
2022-01-16 11:28:20.538  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5b156cc4
2022-01-16 11:28:20.539  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5b156cc4
2022-01-16 11:28:20.550  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5b156cc4
2022-01-16 11:28:20.550  WARN 15 --- [https-jsse-nio-7071-exec-2] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:28:20.550  WARN 15 --- [https-jsse-nio-7071-exec-2] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:28:20.551  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: under-emergency, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5b156cc4
2022-01-16 11:28:20.558  INFO 15 --- [https-jsse-nio-7071-exec-2] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18910951587798440-371554, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:patient-under-active-emergency:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=patient-under-active-emergency, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 3 - Patient under active emergency, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:28:20.558  INFO 15 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=96794288-703d-44e8-bee0-6e68a6b109ce, content=DENY, timestamp=1642332500558, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:patient-under-active-emergency:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=patient-under-active-emergency, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 3 - Patient under active emergency, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:28:20.558  INFO 15 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=72ms, Total=74ms
2022-01-16 11:28:20.576  INFO 15 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=a5f36c75-a727-453f-90c7-05bada38b566, content=null, timestamp=1642332500571, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=51656, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=5eea89d14d1a, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=999d21b7-cecf-4b75-ae67-bd5c244cfd50, http-req-server-port=80, http-header-accept=*/*, kc-id=917038d1-218a-4de3-bc21-524ee9b1ec1f, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642332500570, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQCfHNxAH4AEQAAAABh5AFQdAAkOTE3MDM4ZDEtMjE4YS00ZGUzLWJjMjEtNTI0ZWU5YjFlYzFmdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ5OTlkMjFiNy1jZWNmLTRiNzUtYWU2Ny1iZDVjMjQ0Y2ZkNTBwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJKS2NmeHpNR3dHQmVVTmNCczVvZ2tZclhKNlRJX0hyQi04Y3BuakZDa0lZIn0.eyJleHAiOjE2NDIzMzI3OTYsImlhdCI6MTY0MjMzMjQ5NiwianRpIjoiOTE3MDM4ZDEtMjE4YS00ZGUzLWJjMjEtNTI0ZWU5YjFlYzFmIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiI5OTlkMjFiNy1jZWNmLTRiNzUtYWU2Ny1iZDVjMjQ0Y2ZkNTAiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.TNPdGgstBT5KMl1zUUFYUdWBWAX1vTqDRLObIX6Hfm6TD1yNq3YIfGvVs8ew9FkCUjHZv2RxDXwap4ZBgU1XWNfgbY7lRnbcXLwKQVYJ_UngYNYkyfIeNM6f6obFgnYgUZWmuKJPNDWSwOXgaOQYUKn2Kwg84g2RElqDZmS17N-Zrmrpfozma14xSG38xXRYv-xLzM1EYvvOzmGuxWAUpVDlg0H-jAo7M5on-TNuilMfy2lmX-fR8QdyJczEmqrtLszHB-gRh60Vzm3zoDrkhMJEU1EZKqYn9jSEl8QuQahpjS-rHQw5sSk-pQAr0VHiulVAKkKycSls-Wms7_8olg, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre/read, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642332796, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.240.10, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=523CE7422475E48D5FF16067B7162505, http-session-last-accessed-time=1642332500570, kc-category-name=ACCESS, kc-iat=1642332496, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:51656 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:28:20.577  INFO 15 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:28:20.578  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4ee17974
2022-01-16 11:28:20.578  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4ee17974
2022-01-16 11:28:20.630  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4ee17974
2022-01-16 11:28:20.630  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4ee17974
2022-01-16 11:28:20.643  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4ee17974
2022-01-16 11:28:20.643  WARN 15 --- [https-jsse-nio-7071-exec-4] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:28:20.643  WARN 15 --- [https-jsse-nio-7071-exec-4] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:28:20.643  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: under-emergency, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4ee17974
2022-01-16 11:28:20.653  INFO 15 --- [https-jsse-nio-7071-exec-4] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18910951678088437-803507, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:patient-under-active-emergency:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=patient-under-active-emergency, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 3 - Patient under active emergency, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:28:20.653  INFO 15 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=a5f36c75-a727-453f-90c7-05bada38b566, content=DENY, timestamp=1642332500653, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:patient-under-active-emergency:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=patient-under-active-emergency, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 3 - Patient under active emergency, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:28:20.654  INFO 15 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=76ms, Total=80ms
2022-01-16 11:28:20.672  INFO 15 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=297ecc5e-33c8-4287-95e9-8ce9cbe1fc4e, content=null, timestamp=1642332500667, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=51658, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=5eea89d14d1a, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=999d21b7-cecf-4b75-ae67-bd5c244cfd50, http-req-server-port=80, http-header-accept=*/*, kc-id=917038d1-218a-4de3-bc21-524ee9b1ec1f, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642332500666, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQCfHNxAH4AEQAAAABh5AFQdAAkOTE3MDM4ZDEtMjE4YS00ZGUzLWJjMjEtNTI0ZWU5YjFlYzFmdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ5OTlkMjFiNy1jZWNmLTRiNzUtYWU2Ny1iZDVjMjQ0Y2ZkNTBwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJKS2NmeHpNR3dHQmVVTmNCczVvZ2tZclhKNlRJX0hyQi04Y3BuakZDa0lZIn0.eyJleHAiOjE2NDIzMzI3OTYsImlhdCI6MTY0MjMzMjQ5NiwianRpIjoiOTE3MDM4ZDEtMjE4YS00ZGUzLWJjMjEtNTI0ZWU5YjFlYzFmIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiI5OTlkMjFiNy1jZWNmLTRiNzUtYWU2Ny1iZDVjMjQ0Y2ZkNTAiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.TNPdGgstBT5KMl1zUUFYUdWBWAX1vTqDRLObIX6Hfm6TD1yNq3YIfGvVs8ew9FkCUjHZv2RxDXwap4ZBgU1XWNfgbY7lRnbcXLwKQVYJ_UngYNYkyfIeNM6f6obFgnYgUZWmuKJPNDWSwOXgaOQYUKn2Kwg84g2RElqDZmS17N-Zrmrpfozma14xSG38xXRYv-xLzM1EYvvOzmGuxWAUpVDlg0H-jAo7M5on-TNuilMfy2lmX-fR8QdyJczEmqrtLszHB-gRh60Vzm3zoDrkhMJEU1EZKqYn9jSEl8QuQahpjS-rHQw5sSk-pQAr0VHiulVAKkKycSls-Wms7_8olg, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre/read, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642332796, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.240.10, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=F4BEA90C06525207F9813D512C008DE4, http-session-last-accessed-time=1642332500666, kc-category-name=ACCESS, kc-iat=1642332496, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:51658 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:28:20.672  INFO 15 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:28:20.673  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@72ce5e88
2022-01-16 11:28:20.674  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@72ce5e88
2022-01-16 11:28:20.726  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@72ce5e88
2022-01-16 11:28:20.727  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@72ce5e88
2022-01-16 11:28:20.739  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@72ce5e88
2022-01-16 11:28:20.739  WARN 15 --- [https-jsse-nio-7071-exec-5] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:28:20.739  WARN 15 --- [https-jsse-nio-7071-exec-5] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:28:20.740  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: under-emergency, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@72ce5e88
2022-01-16 11:28:20.748  INFO 15 --- [https-jsse-nio-7071-exec-5] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18910951774024399-858497, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:patient-under-active-emergency:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=patient-under-active-emergency, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 3 - Patient under active emergency, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:28:20.748  INFO 15 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=297ecc5e-33c8-4287-95e9-8ce9cbe1fc4e, content=DENY, timestamp=1642332500748, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:patient-under-active-emergency:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=patient-under-active-emergency, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 3 - Patient under active emergency, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:28:20.748  INFO 15 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=75ms, Total=78ms
2022-01-16 11:28:20.770  INFO 15 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=fffcc064-ed91-42c8-9fe1-a38cdbd5a4f0, content=null, timestamp=1642332500761, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=51660, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=5eea89d14d1a, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=999d21b7-cecf-4b75-ae67-bd5c244cfd50, http-req-server-port=80, http-header-accept=*/*, kc-id=917038d1-218a-4de3-bc21-524ee9b1ec1f, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642332500760, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQCfHNxAH4AEQAAAABh5AFQdAAkOTE3MDM4ZDEtMjE4YS00ZGUzLWJjMjEtNTI0ZWU5YjFlYzFmdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ5OTlkMjFiNy1jZWNmLTRiNzUtYWU2Ny1iZDVjMjQ0Y2ZkNTBwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJKS2NmeHpNR3dHQmVVTmNCczVvZ2tZclhKNlRJX0hyQi04Y3BuakZDa0lZIn0.eyJleHAiOjE2NDIzMzI3OTYsImlhdCI6MTY0MjMzMjQ5NiwianRpIjoiOTE3MDM4ZDEtMjE4YS00ZGUzLWJjMjEtNTI0ZWU5YjFlYzFmIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiI5OTlkMjFiNy1jZWNmLTRiNzUtYWU2Ny1iZDVjMjQ0Y2ZkNTAiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.TNPdGgstBT5KMl1zUUFYUdWBWAX1vTqDRLObIX6Hfm6TD1yNq3YIfGvVs8ew9FkCUjHZv2RxDXwap4ZBgU1XWNfgbY7lRnbcXLwKQVYJ_UngYNYkyfIeNM6f6obFgnYgUZWmuKJPNDWSwOXgaOQYUKn2Kwg84g2RElqDZmS17N-Zrmrpfozma14xSG38xXRYv-xLzM1EYvvOzmGuxWAUpVDlg0H-jAo7M5on-TNuilMfy2lmX-fR8QdyJczEmqrtLszHB-gRh60Vzm3zoDrkhMJEU1EZKqYn9jSEl8QuQahpjS-rHQw5sSk-pQAr0VHiulVAKkKycSls-Wms7_8olg, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre/read, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642332796, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.240.10, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=EBAF79179B85B2D8FA26B550C0A3E04F, http-session-last-accessed-time=1642332500760, kc-category-name=ACCESS, kc-iat=1642332496, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:51660 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:28:20.771  INFO 15 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:28:20.772  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3630b070
2022-01-16 11:28:20.772  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3630b070
2022-01-16 11:28:20.822  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3630b070
2022-01-16 11:28:20.822  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3630b070
2022-01-16 11:28:20.836  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3630b070
2022-01-16 11:28:20.836  WARN 15 --- [https-jsse-nio-7071-exec-6] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:28:20.837  WARN 15 --- [https-jsse-nio-7071-exec-6] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:28:20.837  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: under-emergency, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3630b070
2022-01-16 11:28:20.845  INFO 15 --- [https-jsse-nio-7071-exec-6] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18910951872559162-793381, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:patient-under-active-emergency:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=patient-under-active-emergency, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 3 - Patient under active emergency, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:28:20.845  INFO 15 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=fffcc064-ed91-42c8-9fe1-a38cdbd5a4f0, content=DENY, timestamp=1642332500845, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:patient-under-active-emergency:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=patient-under-active-emergency, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 3 - Patient under active emergency, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:28:20.850  INFO 15 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=74ms, Total=81ms
2022-01-16 11:28:20.866  INFO 15 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=70e06ed6-8767-47d3-ad01-263382d8bf29, content=null, timestamp=1642332500861, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=51662, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=5eea89d14d1a, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=999d21b7-cecf-4b75-ae67-bd5c244cfd50, http-req-server-port=80, http-header-accept=*/*, kc-id=917038d1-218a-4de3-bc21-524ee9b1ec1f, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642332500860, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQCfHNxAH4AEQAAAABh5AFQdAAkOTE3MDM4ZDEtMjE4YS00ZGUzLWJjMjEtNTI0ZWU5YjFlYzFmdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ5OTlkMjFiNy1jZWNmLTRiNzUtYWU2Ny1iZDVjMjQ0Y2ZkNTBwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJKS2NmeHpNR3dHQmVVTmNCczVvZ2tZclhKNlRJX0hyQi04Y3BuakZDa0lZIn0.eyJleHAiOjE2NDIzMzI3OTYsImlhdCI6MTY0MjMzMjQ5NiwianRpIjoiOTE3MDM4ZDEtMjE4YS00ZGUzLWJjMjEtNTI0ZWU5YjFlYzFmIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiI5OTlkMjFiNy1jZWNmLTRiNzUtYWU2Ny1iZDVjMjQ0Y2ZkNTAiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.TNPdGgstBT5KMl1zUUFYUdWBWAX1vTqDRLObIX6Hfm6TD1yNq3YIfGvVs8ew9FkCUjHZv2RxDXwap4ZBgU1XWNfgbY7lRnbcXLwKQVYJ_UngYNYkyfIeNM6f6obFgnYgUZWmuKJPNDWSwOXgaOQYUKn2Kwg84g2RElqDZmS17N-Zrmrpfozma14xSG38xXRYv-xLzM1EYvvOzmGuxWAUpVDlg0H-jAo7M5on-TNuilMfy2lmX-fR8QdyJczEmqrtLszHB-gRh60Vzm3zoDrkhMJEU1EZKqYn9jSEl8QuQahpjS-rHQw5sSk-pQAr0VHiulVAKkKycSls-Wms7_8olg, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre/read, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642332796, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.240.10, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=C2924C9FF54FB16A395A695484FC2D82, http-session-last-accessed-time=1642332500860, kc-category-name=ACCESS, kc-iat=1642332496, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:51662 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:28:20.867  INFO 15 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:28:20.868  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2de54bd9
2022-01-16 11:28:20.868  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2de54bd9
2022-01-16 11:28:20.918  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2de54bd9
2022-01-16 11:28:20.918  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2de54bd9
2022-01-16 11:28:20.926  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2de54bd9
2022-01-16 11:28:20.927  WARN 15 --- [https-jsse-nio-7071-exec-7] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:28:20.927  WARN 15 --- [https-jsse-nio-7071-exec-7] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:28:20.927  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: under-emergency, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2de54bd9
2022-01-16 11:28:20.935  INFO 15 --- [https-jsse-nio-7071-exec-7] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18910951968401069-714052, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:patient-under-active-emergency:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=patient-under-active-emergency, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 3 - Patient under active emergency, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:28:20.936  INFO 15 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=70e06ed6-8767-47d3-ad01-263382d8bf29, content=DENY, timestamp=1642332500936, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:patient-under-active-emergency:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=patient-under-active-emergency, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 3 - Patient under active emergency, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:28:20.937  INFO 15 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=69ms, Total=72ms
2022-01-16 11:28:20.954  INFO 15 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=66cbd939-0da8-4de1-be87-c42dfe13c9a5, content=null, timestamp=1642332500949, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=51664, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=5eea89d14d1a, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=999d21b7-cecf-4b75-ae67-bd5c244cfd50, http-req-server-port=80, http-header-accept=*/*, kc-id=917038d1-218a-4de3-bc21-524ee9b1ec1f, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642332500948, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQCfHNxAH4AEQAAAABh5AFQdAAkOTE3MDM4ZDEtMjE4YS00ZGUzLWJjMjEtNTI0ZWU5YjFlYzFmdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ5OTlkMjFiNy1jZWNmLTRiNzUtYWU2Ny1iZDVjMjQ0Y2ZkNTBwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJKS2NmeHpNR3dHQmVVTmNCczVvZ2tZclhKNlRJX0hyQi04Y3BuakZDa0lZIn0.eyJleHAiOjE2NDIzMzI3OTYsImlhdCI6MTY0MjMzMjQ5NiwianRpIjoiOTE3MDM4ZDEtMjE4YS00ZGUzLWJjMjEtNTI0ZWU5YjFlYzFmIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiI5OTlkMjFiNy1jZWNmLTRiNzUtYWU2Ny1iZDVjMjQ0Y2ZkNTAiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.TNPdGgstBT5KMl1zUUFYUdWBWAX1vTqDRLObIX6Hfm6TD1yNq3YIfGvVs8ew9FkCUjHZv2RxDXwap4ZBgU1XWNfgbY7lRnbcXLwKQVYJ_UngYNYkyfIeNM6f6obFgnYgUZWmuKJPNDWSwOXgaOQYUKn2Kwg84g2RElqDZmS17N-Zrmrpfozma14xSG38xXRYv-xLzM1EYvvOzmGuxWAUpVDlg0H-jAo7M5on-TNuilMfy2lmX-fR8QdyJczEmqrtLszHB-gRh60Vzm3zoDrkhMJEU1EZKqYn9jSEl8QuQahpjS-rHQw5sSk-pQAr0VHiulVAKkKycSls-Wms7_8olg, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre/read, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642332796, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.240.10, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=AD0AF74E034DAEA1373E193F2DD78E88, http-session-last-accessed-time=1642332500948, kc-category-name=ACCESS, kc-iat=1642332496, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:51664 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:28:20.954  INFO 15 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:28:20.956  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@74f76eff
2022-01-16 11:28:20.956  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@74f76eff
2022-01-16 11:28:21.010  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@74f76eff
2022-01-16 11:28:21.011  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@74f76eff
2022-01-16 11:28:21.021  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@74f76eff
2022-01-16 11:28:21.022  WARN 15 --- [https-jsse-nio-7071-exec-8] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:28:21.022  WARN 15 --- [https-jsse-nio-7071-exec-8] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:28:21.023  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: under-emergency, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@74f76eff
2022-01-16 11:28:21.032  INFO 15 --- [https-jsse-nio-7071-exec-8] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18910952056270588-694637, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:patient-under-active-emergency:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=patient-under-active-emergency, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 3 - Patient under active emergency, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:28:21.032  INFO 15 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=66cbd939-0da8-4de1-be87-c42dfe13c9a5, content=DENY, timestamp=1642332501032, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:patient-under-active-emergency:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=patient-under-active-emergency, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 3 - Patient under active emergency, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:28:21.033  INFO 15 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=77ms, Total=81ms
2022-01-16 11:28:21.051  INFO 15 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=a9092d17-f1e2-438a-9dd2-3bb2bbb39de9, content=null, timestamp=1642332501046, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=51666, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=5eea89d14d1a, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=999d21b7-cecf-4b75-ae67-bd5c244cfd50, http-req-server-port=80, http-header-accept=*/*, kc-id=917038d1-218a-4de3-bc21-524ee9b1ec1f, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642332501045, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQCfHNxAH4AEQAAAABh5AFQdAAkOTE3MDM4ZDEtMjE4YS00ZGUzLWJjMjEtNTI0ZWU5YjFlYzFmdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ5OTlkMjFiNy1jZWNmLTRiNzUtYWU2Ny1iZDVjMjQ0Y2ZkNTBwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJKS2NmeHpNR3dHQmVVTmNCczVvZ2tZclhKNlRJX0hyQi04Y3BuakZDa0lZIn0.eyJleHAiOjE2NDIzMzI3OTYsImlhdCI6MTY0MjMzMjQ5NiwianRpIjoiOTE3MDM4ZDEtMjE4YS00ZGUzLWJjMjEtNTI0ZWU5YjFlYzFmIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiI5OTlkMjFiNy1jZWNmLTRiNzUtYWU2Ny1iZDVjMjQ0Y2ZkNTAiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.TNPdGgstBT5KMl1zUUFYUdWBWAX1vTqDRLObIX6Hfm6TD1yNq3YIfGvVs8ew9FkCUjHZv2RxDXwap4ZBgU1XWNfgbY7lRnbcXLwKQVYJ_UngYNYkyfIeNM6f6obFgnYgUZWmuKJPNDWSwOXgaOQYUKn2Kwg84g2RElqDZmS17N-Zrmrpfozma14xSG38xXRYv-xLzM1EYvvOzmGuxWAUpVDlg0H-jAo7M5on-TNuilMfy2lmX-fR8QdyJczEmqrtLszHB-gRh60Vzm3zoDrkhMJEU1EZKqYn9jSEl8QuQahpjS-rHQw5sSk-pQAr0VHiulVAKkKycSls-Wms7_8olg, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre/read, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642332796, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.240.10, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=C35C1733905208BB37587B601775CB29, http-session-last-accessed-time=1642332501045, kc-category-name=ACCESS, kc-iat=1642332496, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:51666 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:28:21.052  INFO 15 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:28:21.053  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@234681ef
2022-01-16 11:28:21.054  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@234681ef
2022-01-16 11:28:21.106  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@234681ef
2022-01-16 11:28:21.106  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@234681ef
2022-01-16 11:28:21.119  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@234681ef
2022-01-16 11:28:21.119  WARN 15 --- [https-jsse-nio-7071-exec-9] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:28:21.119  WARN 15 --- [https-jsse-nio-7071-exec-9] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:28:21.120  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: under-emergency, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@234681ef
2022-01-16 11:28:21.128  INFO 15 --- [https-jsse-nio-7071-exec-9] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18910952153557620-946776, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:patient-under-active-emergency:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=patient-under-active-emergency, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 3 - Patient under active emergency, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:28:21.128  INFO 15 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=a9092d17-f1e2-438a-9dd2-3bb2bbb39de9, content=DENY, timestamp=1642332501128, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:patient-under-active-emergency:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=patient-under-active-emergency, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 3 - Patient under active emergency, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:28:21.129  INFO 15 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=76ms, Total=79ms
2022-01-16 11:28:21.144  INFO 15 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=da32e8eb-6da4-4e6d-beb3-57276713eb02, content=null, timestamp=1642332501139, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=51668, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=5eea89d14d1a, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=999d21b7-cecf-4b75-ae67-bd5c244cfd50, http-req-server-port=80, http-header-accept=*/*, kc-id=917038d1-218a-4de3-bc21-524ee9b1ec1f, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642332501138, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQCfHNxAH4AEQAAAABh5AFQdAAkOTE3MDM4ZDEtMjE4YS00ZGUzLWJjMjEtNTI0ZWU5YjFlYzFmdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ5OTlkMjFiNy1jZWNmLTRiNzUtYWU2Ny1iZDVjMjQ0Y2ZkNTBwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJKS2NmeHpNR3dHQmVVTmNCczVvZ2tZclhKNlRJX0hyQi04Y3BuakZDa0lZIn0.eyJleHAiOjE2NDIzMzI3OTYsImlhdCI6MTY0MjMzMjQ5NiwianRpIjoiOTE3MDM4ZDEtMjE4YS00ZGUzLWJjMjEtNTI0ZWU5YjFlYzFmIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiI5OTlkMjFiNy1jZWNmLTRiNzUtYWU2Ny1iZDVjMjQ0Y2ZkNTAiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.TNPdGgstBT5KMl1zUUFYUdWBWAX1vTqDRLObIX6Hfm6TD1yNq3YIfGvVs8ew9FkCUjHZv2RxDXwap4ZBgU1XWNfgbY7lRnbcXLwKQVYJ_UngYNYkyfIeNM6f6obFgnYgUZWmuKJPNDWSwOXgaOQYUKn2Kwg84g2RElqDZmS17N-Zrmrpfozma14xSG38xXRYv-xLzM1EYvvOzmGuxWAUpVDlg0H-jAo7M5on-TNuilMfy2lmX-fR8QdyJczEmqrtLszHB-gRh60Vzm3zoDrkhMJEU1EZKqYn9jSEl8QuQahpjS-rHQw5sSk-pQAr0VHiulVAKkKycSls-Wms7_8olg, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre/read, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642332796, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.240.10, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=4F55CB2633BB8CE30106313E5995C800, http-session-last-accessed-time=1642332501138, kc-category-name=ACCESS, kc-iat=1642332496, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:51668 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:28:21.145  INFO 15 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:28:21.146  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1ab5fbf
2022-01-16 11:28:21.146  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1ab5fbf
2022-01-16 11:28:21.198  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1ab5fbf
2022-01-16 11:28:21.198  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1ab5fbf
2022-01-16 11:28:21.211  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1ab5fbf
2022-01-16 11:28:21.211  WARN 15 --- [https-jsse-nio-7071-exec-10] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:28:21.211  WARN 15 --- [https-jsse-nio-7071-exec-10] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:28:21.211  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: under-emergency, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1ab5fbf
2022-01-16 11:28:21.220  INFO 15 --- [https-jsse-nio-7071-exec-10] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18910952246763230-160123, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:patient-under-active-emergency:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=patient-under-active-emergency, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 3 - Patient under active emergency, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:28:21.220  INFO 15 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=da32e8eb-6da4-4e6d-beb3-57276713eb02, content=DENY, timestamp=1642332501220, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:patient-under-active-emergency:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=patient-under-active-emergency, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 3 - Patient under active emergency, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:28:21.221  INFO 15 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=75ms, Total=78ms
2022-01-16 11:28:21.243  INFO 15 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=d98a808f-ea16-4301-82b1-f24a55675f52, content=null, timestamp=1642332501238, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=51670, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=5eea89d14d1a, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=999d21b7-cecf-4b75-ae67-bd5c244cfd50, http-req-server-port=80, http-header-accept=*/*, kc-id=917038d1-218a-4de3-bc21-524ee9b1ec1f, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642332501237, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQCfHNxAH4AEQAAAABh5AFQdAAkOTE3MDM4ZDEtMjE4YS00ZGUzLWJjMjEtNTI0ZWU5YjFlYzFmdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ5OTlkMjFiNy1jZWNmLTRiNzUtYWU2Ny1iZDVjMjQ0Y2ZkNTBwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJKS2NmeHpNR3dHQmVVTmNCczVvZ2tZclhKNlRJX0hyQi04Y3BuakZDa0lZIn0.eyJleHAiOjE2NDIzMzI3OTYsImlhdCI6MTY0MjMzMjQ5NiwianRpIjoiOTE3MDM4ZDEtMjE4YS00ZGUzLWJjMjEtNTI0ZWU5YjFlYzFmIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiI5OTlkMjFiNy1jZWNmLTRiNzUtYWU2Ny1iZDVjMjQ0Y2ZkNTAiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.TNPdGgstBT5KMl1zUUFYUdWBWAX1vTqDRLObIX6Hfm6TD1yNq3YIfGvVs8ew9FkCUjHZv2RxDXwap4ZBgU1XWNfgbY7lRnbcXLwKQVYJ_UngYNYkyfIeNM6f6obFgnYgUZWmuKJPNDWSwOXgaOQYUKn2Kwg84g2RElqDZmS17N-Zrmrpfozma14xSG38xXRYv-xLzM1EYvvOzmGuxWAUpVDlg0H-jAo7M5on-TNuilMfy2lmX-fR8QdyJczEmqrtLszHB-gRh60Vzm3zoDrkhMJEU1EZKqYn9jSEl8QuQahpjS-rHQw5sSk-pQAr0VHiulVAKkKycSls-Wms7_8olg, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre/read, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642332796, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.240.10, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=FF50000802C6AB5E8A8B55D9A31FDEF6, http-session-last-accessed-time=1642332501237, kc-category-name=ACCESS, kc-iat=1642332496, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:51670 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:28:21.246  INFO 15 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:28:21.247  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3c69bf69
2022-01-16 11:28:21.248  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3c69bf69
2022-01-16 11:28:21.315  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3c69bf69
2022-01-16 11:28:21.315  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3c69bf69
2022-01-16 11:28:21.331  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3c69bf69
2022-01-16 11:28:21.331  WARN 15 --- [https-jsse-nio-7071-exec-1] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:28:21.332  WARN 15 --- [https-jsse-nio-7071-exec-1] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:28:21.332  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: under-emergency, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3c69bf69
2022-01-16 11:28:21.340  INFO 15 --- [https-jsse-nio-7071-exec-1] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18910952348122923-574294, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:patient-under-active-emergency:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=patient-under-active-emergency, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 3 - Patient under active emergency, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:28:21.340  INFO 15 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=d98a808f-ea16-4301-82b1-f24a55675f52, content=DENY, timestamp=1642332501340, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:patient-under-active-emergency:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=patient-under-active-emergency, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 3 - Patient under active emergency, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:28:21.341  INFO 15 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=93ms, Total=99ms
2022-01-16 11:28:21.361  INFO 15 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=1249dfc2-c6cf-4e2f-ba85-944848146b45, content=null, timestamp=1642332501356, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=51672, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=5eea89d14d1a, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=999d21b7-cecf-4b75-ae67-bd5c244cfd50, http-req-server-port=80, http-header-accept=*/*, kc-id=917038d1-218a-4de3-bc21-524ee9b1ec1f, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642332501355, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQCfHNxAH4AEQAAAABh5AFQdAAkOTE3MDM4ZDEtMjE4YS00ZGUzLWJjMjEtNTI0ZWU5YjFlYzFmdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ5OTlkMjFiNy1jZWNmLTRiNzUtYWU2Ny1iZDVjMjQ0Y2ZkNTBwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJKS2NmeHpNR3dHQmVVTmNCczVvZ2tZclhKNlRJX0hyQi04Y3BuakZDa0lZIn0.eyJleHAiOjE2NDIzMzI3OTYsImlhdCI6MTY0MjMzMjQ5NiwianRpIjoiOTE3MDM4ZDEtMjE4YS00ZGUzLWJjMjEtNTI0ZWU5YjFlYzFmIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiI5OTlkMjFiNy1jZWNmLTRiNzUtYWU2Ny1iZDVjMjQ0Y2ZkNTAiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.TNPdGgstBT5KMl1zUUFYUdWBWAX1vTqDRLObIX6Hfm6TD1yNq3YIfGvVs8ew9FkCUjHZv2RxDXwap4ZBgU1XWNfgbY7lRnbcXLwKQVYJ_UngYNYkyfIeNM6f6obFgnYgUZWmuKJPNDWSwOXgaOQYUKn2Kwg84g2RElqDZmS17N-Zrmrpfozma14xSG38xXRYv-xLzM1EYvvOzmGuxWAUpVDlg0H-jAo7M5on-TNuilMfy2lmX-fR8QdyJczEmqrtLszHB-gRh60Vzm3zoDrkhMJEU1EZKqYn9jSEl8QuQahpjS-rHQw5sSk-pQAr0VHiulVAKkKycSls-Wms7_8olg, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre/read, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642332796, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.240.10, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=7D99113AC008C70468125BE0E4D6D892, http-session-last-accessed-time=1642332501355, kc-category-name=ACCESS, kc-iat=1642332496, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:51672 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:28:21.361  INFO 15 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:28:21.362  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@798e9a9c
2022-01-16 11:28:21.362  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@798e9a9c
2022-01-16 11:28:21.414  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@798e9a9c
2022-01-16 11:28:21.414  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@798e9a9c
2022-01-16 11:28:21.429  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@798e9a9c
2022-01-16 11:28:21.429  WARN 15 --- [https-jsse-nio-7071-exec-3] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:28:21.430  WARN 15 --- [https-jsse-nio-7071-exec-3] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:28:21.431  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: under-emergency, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@798e9a9c
2022-01-16 11:28:21.442  INFO 15 --- [https-jsse-nio-7071-exec-3] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18910952462922731-438376, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:patient-under-active-emergency:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=patient-under-active-emergency, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 3 - Patient under active emergency, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:28:21.442  INFO 15 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=1249dfc2-c6cf-4e2f-ba85-944848146b45, content=DENY, timestamp=1642332501442, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:patient-under-active-emergency:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=patient-under-active-emergency, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 3 - Patient under active emergency, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:28:21.443  INFO 15 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=81ms, Total=84ms
2022-01-16 11:28:21.460  INFO 15 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=9782bf41-45e2-40b0-93df-3215fc1dee9a, content=null, timestamp=1642332501455, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=51674, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=5eea89d14d1a, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=999d21b7-cecf-4b75-ae67-bd5c244cfd50, http-req-server-port=80, http-header-accept=*/*, kc-id=917038d1-218a-4de3-bc21-524ee9b1ec1f, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642332501454, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQCfHNxAH4AEQAAAABh5AFQdAAkOTE3MDM4ZDEtMjE4YS00ZGUzLWJjMjEtNTI0ZWU5YjFlYzFmdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ5OTlkMjFiNy1jZWNmLTRiNzUtYWU2Ny1iZDVjMjQ0Y2ZkNTBwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJKS2NmeHpNR3dHQmVVTmNCczVvZ2tZclhKNlRJX0hyQi04Y3BuakZDa0lZIn0.eyJleHAiOjE2NDIzMzI3OTYsImlhdCI6MTY0MjMzMjQ5NiwianRpIjoiOTE3MDM4ZDEtMjE4YS00ZGUzLWJjMjEtNTI0ZWU5YjFlYzFmIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiI5OTlkMjFiNy1jZWNmLTRiNzUtYWU2Ny1iZDVjMjQ0Y2ZkNTAiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.TNPdGgstBT5KMl1zUUFYUdWBWAX1vTqDRLObIX6Hfm6TD1yNq3YIfGvVs8ew9FkCUjHZv2RxDXwap4ZBgU1XWNfgbY7lRnbcXLwKQVYJ_UngYNYkyfIeNM6f6obFgnYgUZWmuKJPNDWSwOXgaOQYUKn2Kwg84g2RElqDZmS17N-Zrmrpfozma14xSG38xXRYv-xLzM1EYvvOzmGuxWAUpVDlg0H-jAo7M5on-TNuilMfy2lmX-fR8QdyJczEmqrtLszHB-gRh60Vzm3zoDrkhMJEU1EZKqYn9jSEl8QuQahpjS-rHQw5sSk-pQAr0VHiulVAKkKycSls-Wms7_8olg, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre/read, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642332796, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.240.10, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=26E4336ECBC8BF988BB342AA224FDE78, http-session-last-accessed-time=1642332501454, kc-category-name=ACCESS, kc-iat=1642332496, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:51674 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:28:21.461  INFO 15 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:28:21.461  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5e81f15d
2022-01-16 11:28:21.462  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5e81f15d
2022-01-16 11:28:21.513  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5e81f15d
2022-01-16 11:28:21.514  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5e81f15d
2022-01-16 11:28:21.524  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5e81f15d
2022-01-16 11:28:21.524  WARN 15 --- [https-jsse-nio-7071-exec-2] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:28:21.524  WARN 15 --- [https-jsse-nio-7071-exec-2] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:28:21.525  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: under-emergency, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5e81f15d
2022-01-16 11:28:21.531  INFO 15 --- [https-jsse-nio-7071-exec-2] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18910952562173380-614849, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:patient-under-active-emergency:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=patient-under-active-emergency, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 3 - Patient under active emergency, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:28:21.532  INFO 15 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=9782bf41-45e2-40b0-93df-3215fc1dee9a, content=DENY, timestamp=1642332501532, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:patient-under-active-emergency:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=patient-under-active-emergency, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 3 - Patient under active emergency, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:28:21.532  INFO 15 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=71ms, Total=74ms
2022-01-16 11:28:21.555  INFO 15 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=9bea9315-9663-404c-b97b-b8d52d89cd68, content=null, timestamp=1642332501543, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=51676, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=5eea89d14d1a, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=999d21b7-cecf-4b75-ae67-bd5c244cfd50, http-req-server-port=80, http-header-accept=*/*, kc-id=917038d1-218a-4de3-bc21-524ee9b1ec1f, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642332501542, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQCfHNxAH4AEQAAAABh5AFQdAAkOTE3MDM4ZDEtMjE4YS00ZGUzLWJjMjEtNTI0ZWU5YjFlYzFmdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ5OTlkMjFiNy1jZWNmLTRiNzUtYWU2Ny1iZDVjMjQ0Y2ZkNTBwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJKS2NmeHpNR3dHQmVVTmNCczVvZ2tZclhKNlRJX0hyQi04Y3BuakZDa0lZIn0.eyJleHAiOjE2NDIzMzI3OTYsImlhdCI6MTY0MjMzMjQ5NiwianRpIjoiOTE3MDM4ZDEtMjE4YS00ZGUzLWJjMjEtNTI0ZWU5YjFlYzFmIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiI5OTlkMjFiNy1jZWNmLTRiNzUtYWU2Ny1iZDVjMjQ0Y2ZkNTAiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.TNPdGgstBT5KMl1zUUFYUdWBWAX1vTqDRLObIX6Hfm6TD1yNq3YIfGvVs8ew9FkCUjHZv2RxDXwap4ZBgU1XWNfgbY7lRnbcXLwKQVYJ_UngYNYkyfIeNM6f6obFgnYgUZWmuKJPNDWSwOXgaOQYUKn2Kwg84g2RElqDZmS17N-Zrmrpfozma14xSG38xXRYv-xLzM1EYvvOzmGuxWAUpVDlg0H-jAo7M5on-TNuilMfy2lmX-fR8QdyJczEmqrtLszHB-gRh60Vzm3zoDrkhMJEU1EZKqYn9jSEl8QuQahpjS-rHQw5sSk-pQAr0VHiulVAKkKycSls-Wms7_8olg, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre/read, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642332796, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.240.10, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=4E0E744C5DB2C20635530B6FCC674E1A, http-session-last-accessed-time=1642332501542, kc-category-name=ACCESS, kc-iat=1642332496, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:51676 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:28:21.556  INFO 15 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:28:21.558  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@35939202
2022-01-16 11:28:21.558  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@35939202
2022-01-16 11:28:21.610  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@35939202
2022-01-16 11:28:21.611  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@35939202
2022-01-16 11:28:21.618  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@35939202
2022-01-16 11:28:21.618  WARN 15 --- [https-jsse-nio-7071-exec-4] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:28:21.619  WARN 15 --- [https-jsse-nio-7071-exec-4] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:28:21.619  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: under-emergency, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@35939202
2022-01-16 11:28:21.626  INFO 15 --- [https-jsse-nio-7071-exec-4] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18910952658003068-876069, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:patient-under-active-emergency:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=patient-under-active-emergency, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 3 - Patient under active emergency, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:28:21.626  INFO 15 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=9bea9315-9663-404c-b97b-b8d52d89cd68, content=DENY, timestamp=1642332501626, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:patient-under-active-emergency:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=patient-under-active-emergency, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 3 - Patient under active emergency, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:28:21.627  INFO 15 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=69ms, Total=75ms
2022-01-16 11:28:21.646  INFO 15 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=24575fad-f5a8-45cf-bee9-4200a7e7aa53, content=null, timestamp=1642332501638, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=51678, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=5eea89d14d1a, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=999d21b7-cecf-4b75-ae67-bd5c244cfd50, http-req-server-port=80, http-header-accept=*/*, kc-id=917038d1-218a-4de3-bc21-524ee9b1ec1f, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642332501637, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQCfHNxAH4AEQAAAABh5AFQdAAkOTE3MDM4ZDEtMjE4YS00ZGUzLWJjMjEtNTI0ZWU5YjFlYzFmdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ5OTlkMjFiNy1jZWNmLTRiNzUtYWU2Ny1iZDVjMjQ0Y2ZkNTBwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJKS2NmeHpNR3dHQmVVTmNCczVvZ2tZclhKNlRJX0hyQi04Y3BuakZDa0lZIn0.eyJleHAiOjE2NDIzMzI3OTYsImlhdCI6MTY0MjMzMjQ5NiwianRpIjoiOTE3MDM4ZDEtMjE4YS00ZGUzLWJjMjEtNTI0ZWU5YjFlYzFmIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiI5OTlkMjFiNy1jZWNmLTRiNzUtYWU2Ny1iZDVjMjQ0Y2ZkNTAiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.TNPdGgstBT5KMl1zUUFYUdWBWAX1vTqDRLObIX6Hfm6TD1yNq3YIfGvVs8ew9FkCUjHZv2RxDXwap4ZBgU1XWNfgbY7lRnbcXLwKQVYJ_UngYNYkyfIeNM6f6obFgnYgUZWmuKJPNDWSwOXgaOQYUKn2Kwg84g2RElqDZmS17N-Zrmrpfozma14xSG38xXRYv-xLzM1EYvvOzmGuxWAUpVDlg0H-jAo7M5on-TNuilMfy2lmX-fR8QdyJczEmqrtLszHB-gRh60Vzm3zoDrkhMJEU1EZKqYn9jSEl8QuQahpjS-rHQw5sSk-pQAr0VHiulVAKkKycSls-Wms7_8olg, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre/read, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642332796, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.240.10, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=992C27E25A83A77C5BC1C102176AD9EF, http-session-last-accessed-time=1642332501637, kc-category-name=ACCESS, kc-iat=1642332496, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:51678 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:28:21.646  INFO 15 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:28:21.648  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@23c6bb63
2022-01-16 11:28:21.648  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@23c6bb63
2022-01-16 11:28:21.698  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@23c6bb63
2022-01-16 11:28:21.698  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@23c6bb63
2022-01-16 11:28:21.710  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@23c6bb63
2022-01-16 11:28:21.711  WARN 15 --- [https-jsse-nio-7071-exec-5] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:28:21.711  WARN 15 --- [https-jsse-nio-7071-exec-5] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:28:21.711  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: under-emergency, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@23c6bb63
2022-01-16 11:28:21.719  INFO 15 --- [https-jsse-nio-7071-exec-5] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18910952747969546-375960, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:patient-under-active-emergency:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=patient-under-active-emergency, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 3 - Patient under active emergency, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:28:21.720  INFO 15 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=24575fad-f5a8-45cf-bee9-4200a7e7aa53, content=DENY, timestamp=1642332501720, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:patient-under-active-emergency:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=patient-under-active-emergency, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 3 - Patient under active emergency, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:28:21.721  INFO 15 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=74ms, Total=77ms
2022-01-16 11:28:21.748  INFO 15 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=6e2d5a96-2b88-4a03-b577-a7da4e0546bc, content=null, timestamp=1642332501734, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=51680, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=5eea89d14d1a, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=999d21b7-cecf-4b75-ae67-bd5c244cfd50, http-req-server-port=80, http-header-accept=*/*, kc-id=917038d1-218a-4de3-bc21-524ee9b1ec1f, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642332501733, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQCfHNxAH4AEQAAAABh5AFQdAAkOTE3MDM4ZDEtMjE4YS00ZGUzLWJjMjEtNTI0ZWU5YjFlYzFmdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ5OTlkMjFiNy1jZWNmLTRiNzUtYWU2Ny1iZDVjMjQ0Y2ZkNTBwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJKS2NmeHpNR3dHQmVVTmNCczVvZ2tZclhKNlRJX0hyQi04Y3BuakZDa0lZIn0.eyJleHAiOjE2NDIzMzI3OTYsImlhdCI6MTY0MjMzMjQ5NiwianRpIjoiOTE3MDM4ZDEtMjE4YS00ZGUzLWJjMjEtNTI0ZWU5YjFlYzFmIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiI5OTlkMjFiNy1jZWNmLTRiNzUtYWU2Ny1iZDVjMjQ0Y2ZkNTAiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.TNPdGgstBT5KMl1zUUFYUdWBWAX1vTqDRLObIX6Hfm6TD1yNq3YIfGvVs8ew9FkCUjHZv2RxDXwap4ZBgU1XWNfgbY7lRnbcXLwKQVYJ_UngYNYkyfIeNM6f6obFgnYgUZWmuKJPNDWSwOXgaOQYUKn2Kwg84g2RElqDZmS17N-Zrmrpfozma14xSG38xXRYv-xLzM1EYvvOzmGuxWAUpVDlg0H-jAo7M5on-TNuilMfy2lmX-fR8QdyJczEmqrtLszHB-gRh60Vzm3zoDrkhMJEU1EZKqYn9jSEl8QuQahpjS-rHQw5sSk-pQAr0VHiulVAKkKycSls-Wms7_8olg, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre/read, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642332796, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.240.10, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=942C870550EF84458669B9BB94850619, http-session-last-accessed-time=1642332501733, kc-category-name=ACCESS, kc-iat=1642332496, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:51680 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:28:21.749  INFO 15 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:28:21.751  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@ae715dc
2022-01-16 11:28:21.751  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@ae715dc
2022-01-16 11:28:21.802  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@ae715dc
2022-01-16 11:28:21.802  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@ae715dc
2022-01-16 11:28:21.812  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@ae715dc
2022-01-16 11:28:21.812  WARN 15 --- [https-jsse-nio-7071-exec-6] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:28:21.812  WARN 15 --- [https-jsse-nio-7071-exec-6] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:28:21.812  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: under-emergency, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@ae715dc
2022-01-16 11:28:21.822  INFO 15 --- [https-jsse-nio-7071-exec-6] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18910952851110401-55320, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:patient-under-active-emergency:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=patient-under-active-emergency, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 3 - Patient under active emergency, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:28:21.823  INFO 15 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=6e2d5a96-2b88-4a03-b577-a7da4e0546bc, content=DENY, timestamp=1642332501823, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:patient-under-active-emergency:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=patient-under-active-emergency, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 3 - Patient under active emergency, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:28:21.823  INFO 15 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=73ms, Total=76ms
2022-01-16 11:28:21.842  INFO 15 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=cb948449-0f50-408c-a707-0b43f6538bb0, content=null, timestamp=1642332501836, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=51682, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=5eea89d14d1a, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=999d21b7-cecf-4b75-ae67-bd5c244cfd50, http-req-server-port=80, http-header-accept=*/*, kc-id=917038d1-218a-4de3-bc21-524ee9b1ec1f, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642332501835, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQCfHNxAH4AEQAAAABh5AFQdAAkOTE3MDM4ZDEtMjE4YS00ZGUzLWJjMjEtNTI0ZWU5YjFlYzFmdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ5OTlkMjFiNy1jZWNmLTRiNzUtYWU2Ny1iZDVjMjQ0Y2ZkNTBwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJKS2NmeHpNR3dHQmVVTmNCczVvZ2tZclhKNlRJX0hyQi04Y3BuakZDa0lZIn0.eyJleHAiOjE2NDIzMzI3OTYsImlhdCI6MTY0MjMzMjQ5NiwianRpIjoiOTE3MDM4ZDEtMjE4YS00ZGUzLWJjMjEtNTI0ZWU5YjFlYzFmIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiI5OTlkMjFiNy1jZWNmLTRiNzUtYWU2Ny1iZDVjMjQ0Y2ZkNTAiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.TNPdGgstBT5KMl1zUUFYUdWBWAX1vTqDRLObIX6Hfm6TD1yNq3YIfGvVs8ew9FkCUjHZv2RxDXwap4ZBgU1XWNfgbY7lRnbcXLwKQVYJ_UngYNYkyfIeNM6f6obFgnYgUZWmuKJPNDWSwOXgaOQYUKn2Kwg84g2RElqDZmS17N-Zrmrpfozma14xSG38xXRYv-xLzM1EYvvOzmGuxWAUpVDlg0H-jAo7M5on-TNuilMfy2lmX-fR8QdyJczEmqrtLszHB-gRh60Vzm3zoDrkhMJEU1EZKqYn9jSEl8QuQahpjS-rHQw5sSk-pQAr0VHiulVAKkKycSls-Wms7_8olg, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre/read, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642332796, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.240.10, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=883003C781704E8D40F8D3E042AEDFDE, http-session-last-accessed-time=1642332501835, kc-category-name=ACCESS, kc-iat=1642332496, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:51682 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:28:21.843  INFO 15 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:28:21.844  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1b5ee3d7
2022-01-16 11:28:21.844  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1b5ee3d7
2022-01-16 11:28:21.898  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1b5ee3d7
2022-01-16 11:28:21.899  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1b5ee3d7
2022-01-16 11:28:21.914  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1b5ee3d7
2022-01-16 11:28:21.914  WARN 15 --- [https-jsse-nio-7071-exec-7] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:28:21.914  WARN 15 --- [https-jsse-nio-7071-exec-7] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:28:21.915  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: under-emergency, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1b5ee3d7
2022-01-16 11:28:21.924  INFO 15 --- [https-jsse-nio-7071-exec-7] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18910952944579118-206469, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:patient-under-active-emergency:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=patient-under-active-emergency, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 3 - Patient under active emergency, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:28:21.924  INFO 15 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=cb948449-0f50-408c-a707-0b43f6538bb0, content=DENY, timestamp=1642332501924, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:patient-under-active-emergency:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=patient-under-active-emergency, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 3 - Patient under active emergency, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:28:21.925  INFO 15 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=81ms, Total=85ms
2022-01-16 11:28:21.945  INFO 15 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=5dfa0af5-1ef5-4b80-b720-b5c054cd866f, content=null, timestamp=1642332501939, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=51684, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=5eea89d14d1a, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=999d21b7-cecf-4b75-ae67-bd5c244cfd50, http-req-server-port=80, http-header-accept=*/*, kc-id=917038d1-218a-4de3-bc21-524ee9b1ec1f, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642332501938, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQCfHNxAH4AEQAAAABh5AFQdAAkOTE3MDM4ZDEtMjE4YS00ZGUzLWJjMjEtNTI0ZWU5YjFlYzFmdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ5OTlkMjFiNy1jZWNmLTRiNzUtYWU2Ny1iZDVjMjQ0Y2ZkNTBwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJKS2NmeHpNR3dHQmVVTmNCczVvZ2tZclhKNlRJX0hyQi04Y3BuakZDa0lZIn0.eyJleHAiOjE2NDIzMzI3OTYsImlhdCI6MTY0MjMzMjQ5NiwianRpIjoiOTE3MDM4ZDEtMjE4YS00ZGUzLWJjMjEtNTI0ZWU5YjFlYzFmIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiI5OTlkMjFiNy1jZWNmLTRiNzUtYWU2Ny1iZDVjMjQ0Y2ZkNTAiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.TNPdGgstBT5KMl1zUUFYUdWBWAX1vTqDRLObIX6Hfm6TD1yNq3YIfGvVs8ew9FkCUjHZv2RxDXwap4ZBgU1XWNfgbY7lRnbcXLwKQVYJ_UngYNYkyfIeNM6f6obFgnYgUZWmuKJPNDWSwOXgaOQYUKn2Kwg84g2RElqDZmS17N-Zrmrpfozma14xSG38xXRYv-xLzM1EYvvOzmGuxWAUpVDlg0H-jAo7M5on-TNuilMfy2lmX-fR8QdyJczEmqrtLszHB-gRh60Vzm3zoDrkhMJEU1EZKqYn9jSEl8QuQahpjS-rHQw5sSk-pQAr0VHiulVAKkKycSls-Wms7_8olg, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre/read, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642332796, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.240.10, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=446635D01493B9B34BF5B3350CCCA086, http-session-last-accessed-time=1642332501938, kc-category-name=ACCESS, kc-iat=1642332496, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:51684 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:28:21.946  INFO 15 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:28:21.947  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@17c73193
2022-01-16 11:28:21.947  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@17c73193
2022-01-16 11:28:22.038  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@17c73193
2022-01-16 11:28:22.039  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@17c73193
2022-01-16 11:28:22.068  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@17c73193
2022-01-16 11:28:22.077  WARN 15 --- [https-jsse-nio-7071-exec-8] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:28:22.077  WARN 15 --- [https-jsse-nio-7071-exec-8] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:28:22.077  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: under-emergency, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@17c73193
2022-01-16 11:28:22.086  INFO 15 --- [https-jsse-nio-7071-exec-8] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18910953047269001-204653, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:patient-under-active-emergency:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=patient-under-active-emergency, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 3 - Patient under active emergency, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:28:22.086  INFO 15 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=5dfa0af5-1ef5-4b80-b720-b5c054cd866f, content=DENY, timestamp=1642332502086, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:patient-under-active-emergency:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=patient-under-active-emergency, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 3 - Patient under active emergency, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:28:22.087  INFO 15 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=140ms, Total=144ms
2022-01-16 11:28:22.113  INFO 15 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=c2c7b292-1925-44c6-b142-03f56f0857c9, content=null, timestamp=1642332502101, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=51686, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=5eea89d14d1a, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=999d21b7-cecf-4b75-ae67-bd5c244cfd50, http-req-server-port=80, http-header-accept=*/*, kc-id=917038d1-218a-4de3-bc21-524ee9b1ec1f, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642332502100, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQCfHNxAH4AEQAAAABh5AFQdAAkOTE3MDM4ZDEtMjE4YS00ZGUzLWJjMjEtNTI0ZWU5YjFlYzFmdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ5OTlkMjFiNy1jZWNmLTRiNzUtYWU2Ny1iZDVjMjQ0Y2ZkNTBwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJKS2NmeHpNR3dHQmVVTmNCczVvZ2tZclhKNlRJX0hyQi04Y3BuakZDa0lZIn0.eyJleHAiOjE2NDIzMzI3OTYsImlhdCI6MTY0MjMzMjQ5NiwianRpIjoiOTE3MDM4ZDEtMjE4YS00ZGUzLWJjMjEtNTI0ZWU5YjFlYzFmIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiI5OTlkMjFiNy1jZWNmLTRiNzUtYWU2Ny1iZDVjMjQ0Y2ZkNTAiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.TNPdGgstBT5KMl1zUUFYUdWBWAX1vTqDRLObIX6Hfm6TD1yNq3YIfGvVs8ew9FkCUjHZv2RxDXwap4ZBgU1XWNfgbY7lRnbcXLwKQVYJ_UngYNYkyfIeNM6f6obFgnYgUZWmuKJPNDWSwOXgaOQYUKn2Kwg84g2RElqDZmS17N-Zrmrpfozma14xSG38xXRYv-xLzM1EYvvOzmGuxWAUpVDlg0H-jAo7M5on-TNuilMfy2lmX-fR8QdyJczEmqrtLszHB-gRh60Vzm3zoDrkhMJEU1EZKqYn9jSEl8QuQahpjS-rHQw5sSk-pQAr0VHiulVAKkKycSls-Wms7_8olg, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre/read, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642332796, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.240.10, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=B0B585E447F6AA88F6B6796788F41DF4, http-session-last-accessed-time=1642332502100, kc-category-name=ACCESS, kc-iat=1642332496, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:51686 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:28:22.121  INFO 15 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:28:22.122  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@78e8d82e
2022-01-16 11:28:22.133  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@78e8d82e
2022-01-16 11:28:22.143  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@78e8d82e
2022-01-16 11:28:22.143  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@78e8d82e
2022-01-16 11:28:22.198  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@78e8d82e
2022-01-16 11:28:22.199  WARN 15 --- [https-jsse-nio-7071-exec-9] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:28:22.199  WARN 15 --- [https-jsse-nio-7071-exec-9] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:28:22.199  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: under-emergency, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@78e8d82e
2022-01-16 11:28:22.244  INFO 15 --- [https-jsse-nio-7071-exec-9] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18910953222434971-679799, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:patient-under-active-emergency:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=patient-under-active-emergency, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 3 - Patient under active emergency, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:28:22.244  INFO 15 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=c2c7b292-1925-44c6-b142-03f56f0857c9, content=DENY, timestamp=1642332502244, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:patient-under-active-emergency:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=patient-under-active-emergency, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 3 - Patient under active emergency, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:28:22.245  INFO 15 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=123ms, Total=135ms
2022-01-16 11:28:22.260  INFO 15 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=cc959c41-c3dd-417d-a0ac-8b0e078e319d, content=null, timestamp=1642332502256, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=51688, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=5eea89d14d1a, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=999d21b7-cecf-4b75-ae67-bd5c244cfd50, http-req-server-port=80, http-header-accept=*/*, kc-id=917038d1-218a-4de3-bc21-524ee9b1ec1f, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642332502255, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQCfHNxAH4AEQAAAABh5AFQdAAkOTE3MDM4ZDEtMjE4YS00ZGUzLWJjMjEtNTI0ZWU5YjFlYzFmdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ5OTlkMjFiNy1jZWNmLTRiNzUtYWU2Ny1iZDVjMjQ0Y2ZkNTBwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJKS2NmeHpNR3dHQmVVTmNCczVvZ2tZclhKNlRJX0hyQi04Y3BuakZDa0lZIn0.eyJleHAiOjE2NDIzMzI3OTYsImlhdCI6MTY0MjMzMjQ5NiwianRpIjoiOTE3MDM4ZDEtMjE4YS00ZGUzLWJjMjEtNTI0ZWU5YjFlYzFmIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiI5OTlkMjFiNy1jZWNmLTRiNzUtYWU2Ny1iZDVjMjQ0Y2ZkNTAiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.TNPdGgstBT5KMl1zUUFYUdWBWAX1vTqDRLObIX6Hfm6TD1yNq3YIfGvVs8ew9FkCUjHZv2RxDXwap4ZBgU1XWNfgbY7lRnbcXLwKQVYJ_UngYNYkyfIeNM6f6obFgnYgUZWmuKJPNDWSwOXgaOQYUKn2Kwg84g2RElqDZmS17N-Zrmrpfozma14xSG38xXRYv-xLzM1EYvvOzmGuxWAUpVDlg0H-jAo7M5on-TNuilMfy2lmX-fR8QdyJczEmqrtLszHB-gRh60Vzm3zoDrkhMJEU1EZKqYn9jSEl8QuQahpjS-rHQw5sSk-pQAr0VHiulVAKkKycSls-Wms7_8olg, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre/read, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642332796, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.240.10, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=72A770E66660BDBACDB197E14B6060B6, http-session-last-accessed-time=1642332502255, kc-category-name=ACCESS, kc-iat=1642332496, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:51688 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:28:22.261  INFO 15 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:28:22.262  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3cac79d6
2022-01-16 11:28:22.262  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3cac79d6
2022-01-16 11:28:22.272  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3cac79d6
2022-01-16 11:28:22.272  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3cac79d6
2022-01-16 11:28:22.326  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3cac79d6
2022-01-16 11:28:22.326  WARN 15 --- [https-jsse-nio-7071-exec-10] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:28:22.326  WARN 15 --- [https-jsse-nio-7071-exec-10] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:28:22.326  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: under-emergency, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3cac79d6
2022-01-16 11:28:22.338  INFO 15 --- [https-jsse-nio-7071-exec-10] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18910953362742324-647905, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:patient-under-active-emergency:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=patient-under-active-emergency, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 3 - Patient under active emergency, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:28:22.339  INFO 15 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=cc959c41-c3dd-417d-a0ac-8b0e078e319d, content=DENY, timestamp=1642332502339, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:patient-under-active-emergency:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=patient-under-active-emergency, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 3 - Patient under active emergency, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:28:22.339  INFO 15 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=78ms, Total=80ms
2022-01-16 11:28:22.360  INFO 15 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=d2d8ceb4-0c9c-477c-b8f7-cdfa2f74a2c9, content=null, timestamp=1642332502352, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=51690, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=5eea89d14d1a, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=999d21b7-cecf-4b75-ae67-bd5c244cfd50, http-req-server-port=80, http-header-accept=*/*, kc-id=917038d1-218a-4de3-bc21-524ee9b1ec1f, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642332502350, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQCfHNxAH4AEQAAAABh5AFQdAAkOTE3MDM4ZDEtMjE4YS00ZGUzLWJjMjEtNTI0ZWU5YjFlYzFmdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ5OTlkMjFiNy1jZWNmLTRiNzUtYWU2Ny1iZDVjMjQ0Y2ZkNTBwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJKS2NmeHpNR3dHQmVVTmNCczVvZ2tZclhKNlRJX0hyQi04Y3BuakZDa0lZIn0.eyJleHAiOjE2NDIzMzI3OTYsImlhdCI6MTY0MjMzMjQ5NiwianRpIjoiOTE3MDM4ZDEtMjE4YS00ZGUzLWJjMjEtNTI0ZWU5YjFlYzFmIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiI5OTlkMjFiNy1jZWNmLTRiNzUtYWU2Ny1iZDVjMjQ0Y2ZkNTAiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.TNPdGgstBT5KMl1zUUFYUdWBWAX1vTqDRLObIX6Hfm6TD1yNq3YIfGvVs8ew9FkCUjHZv2RxDXwap4ZBgU1XWNfgbY7lRnbcXLwKQVYJ_UngYNYkyfIeNM6f6obFgnYgUZWmuKJPNDWSwOXgaOQYUKn2Kwg84g2RElqDZmS17N-Zrmrpfozma14xSG38xXRYv-xLzM1EYvvOzmGuxWAUpVDlg0H-jAo7M5on-TNuilMfy2lmX-fR8QdyJczEmqrtLszHB-gRh60Vzm3zoDrkhMJEU1EZKqYn9jSEl8QuQahpjS-rHQw5sSk-pQAr0VHiulVAKkKycSls-Wms7_8olg, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre/read, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642332796, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.240.10, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=03FCD75F699C09A0EC65712496DDEED3, http-session-last-accessed-time=1642332502350, kc-category-name=ACCESS, kc-iat=1642332496, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:51690 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:28:22.360  INFO 15 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:28:22.362  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3f9b29aa
2022-01-16 11:28:22.367  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3f9b29aa
2022-01-16 11:28:22.375  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3f9b29aa
2022-01-16 11:28:22.376  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3f9b29aa
2022-01-16 11:28:22.426  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3f9b29aa
2022-01-16 11:28:22.426  WARN 15 --- [https-jsse-nio-7071-exec-1] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:28:22.426  WARN 15 --- [https-jsse-nio-7071-exec-1] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:28:22.426  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: under-emergency, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3f9b29aa
2022-01-16 11:28:22.436  INFO 15 --- [https-jsse-nio-7071-exec-1] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18910953462411868-450047, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:patient-under-active-emergency:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=patient-under-active-emergency, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 3 - Patient under active emergency, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:28:22.436  INFO 15 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=d2d8ceb4-0c9c-477c-b8f7-cdfa2f74a2c9, content=DENY, timestamp=1642332502436, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:patient-under-active-emergency:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=patient-under-active-emergency, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 3 - Patient under active emergency, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:28:22.437  INFO 15 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=75ms, Total=78ms
2022-01-16 11:28:22.456  INFO 15 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=f267a974-d22b-4c7f-bd6f-906d8549f3d8, content=null, timestamp=1642332502449, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=51692, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=5eea89d14d1a, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=999d21b7-cecf-4b75-ae67-bd5c244cfd50, http-req-server-port=80, http-header-accept=*/*, kc-id=917038d1-218a-4de3-bc21-524ee9b1ec1f, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642332502448, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQCfHNxAH4AEQAAAABh5AFQdAAkOTE3MDM4ZDEtMjE4YS00ZGUzLWJjMjEtNTI0ZWU5YjFlYzFmdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ5OTlkMjFiNy1jZWNmLTRiNzUtYWU2Ny1iZDVjMjQ0Y2ZkNTBwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJKS2NmeHpNR3dHQmVVTmNCczVvZ2tZclhKNlRJX0hyQi04Y3BuakZDa0lZIn0.eyJleHAiOjE2NDIzMzI3OTYsImlhdCI6MTY0MjMzMjQ5NiwianRpIjoiOTE3MDM4ZDEtMjE4YS00ZGUzLWJjMjEtNTI0ZWU5YjFlYzFmIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiI5OTlkMjFiNy1jZWNmLTRiNzUtYWU2Ny1iZDVjMjQ0Y2ZkNTAiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.TNPdGgstBT5KMl1zUUFYUdWBWAX1vTqDRLObIX6Hfm6TD1yNq3YIfGvVs8ew9FkCUjHZv2RxDXwap4ZBgU1XWNfgbY7lRnbcXLwKQVYJ_UngYNYkyfIeNM6f6obFgnYgUZWmuKJPNDWSwOXgaOQYUKn2Kwg84g2RElqDZmS17N-Zrmrpfozma14xSG38xXRYv-xLzM1EYvvOzmGuxWAUpVDlg0H-jAo7M5on-TNuilMfy2lmX-fR8QdyJczEmqrtLszHB-gRh60Vzm3zoDrkhMJEU1EZKqYn9jSEl8QuQahpjS-rHQw5sSk-pQAr0VHiulVAKkKycSls-Wms7_8olg, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre/read, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642332796, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.240.10, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=DD422E91C0147D9FAE79A51F2552F495, http-session-last-accessed-time=1642332502448, kc-category-name=ACCESS, kc-iat=1642332496, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:51692 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:28:22.457  INFO 15 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:28:22.458  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@600fd4d
2022-01-16 11:28:22.458  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@600fd4d
2022-01-16 11:28:22.470  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@600fd4d
2022-01-16 11:28:22.470  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@600fd4d
2022-01-16 11:28:22.518  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@600fd4d
2022-01-16 11:28:22.518  WARN 15 --- [https-jsse-nio-7071-exec-1] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:28:22.519  WARN 15 --- [https-jsse-nio-7071-exec-1] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:28:22.519  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: under-emergency, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@600fd4d
2022-01-16 11:28:22.535  INFO 15 --- [https-jsse-nio-7071-exec-1] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18910953558625564-671036, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:patient-under-active-emergency:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=patient-under-active-emergency, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 3 - Patient under active emergency, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:28:22.535  INFO 15 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=f267a974-d22b-4c7f-bd6f-906d8549f3d8, content=DENY, timestamp=1642332502535, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:patient-under-active-emergency:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=patient-under-active-emergency, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 3 - Patient under active emergency, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:28:22.536  INFO 15 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=78ms, Total=82ms
2022-01-16 11:28:22.555  INFO 15 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=71f8ca95-96c0-469f-bd17-6a2276f1ec26, content=null, timestamp=1642332502548, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=51694, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=5eea89d14d1a, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=999d21b7-cecf-4b75-ae67-bd5c244cfd50, http-req-server-port=80, http-header-accept=*/*, kc-id=917038d1-218a-4de3-bc21-524ee9b1ec1f, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642332502547, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQCfHNxAH4AEQAAAABh5AFQdAAkOTE3MDM4ZDEtMjE4YS00ZGUzLWJjMjEtNTI0ZWU5YjFlYzFmdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ5OTlkMjFiNy1jZWNmLTRiNzUtYWU2Ny1iZDVjMjQ0Y2ZkNTBwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJKS2NmeHpNR3dHQmVVTmNCczVvZ2tZclhKNlRJX0hyQi04Y3BuakZDa0lZIn0.eyJleHAiOjE2NDIzMzI3OTYsImlhdCI6MTY0MjMzMjQ5NiwianRpIjoiOTE3MDM4ZDEtMjE4YS00ZGUzLWJjMjEtNTI0ZWU5YjFlYzFmIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiI5OTlkMjFiNy1jZWNmLTRiNzUtYWU2Ny1iZDVjMjQ0Y2ZkNTAiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.TNPdGgstBT5KMl1zUUFYUdWBWAX1vTqDRLObIX6Hfm6TD1yNq3YIfGvVs8ew9FkCUjHZv2RxDXwap4ZBgU1XWNfgbY7lRnbcXLwKQVYJ_UngYNYkyfIeNM6f6obFgnYgUZWmuKJPNDWSwOXgaOQYUKn2Kwg84g2RElqDZmS17N-Zrmrpfozma14xSG38xXRYv-xLzM1EYvvOzmGuxWAUpVDlg0H-jAo7M5on-TNuilMfy2lmX-fR8QdyJczEmqrtLszHB-gRh60Vzm3zoDrkhMJEU1EZKqYn9jSEl8QuQahpjS-rHQw5sSk-pQAr0VHiulVAKkKycSls-Wms7_8olg, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre/read, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642332796, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.240.10, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=C1B3049FC4A3FCFD6CA4C3F1423726BB, http-session-last-accessed-time=1642332502547, kc-category-name=ACCESS, kc-iat=1642332496, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:51694 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:28:22.555  INFO 15 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:28:22.556  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7c5bf523
2022-01-16 11:28:22.557  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7c5bf523
2022-01-16 11:28:22.572  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7c5bf523
2022-01-16 11:28:22.572  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7c5bf523
2022-01-16 11:28:22.622  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7c5bf523
2022-01-16 11:28:22.622  WARN 15 --- [https-jsse-nio-7071-exec-3] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:28:22.623  WARN 15 --- [https-jsse-nio-7071-exec-3] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:28:22.623  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: under-emergency, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7c5bf523
2022-01-16 11:28:22.632  INFO 15 --- [https-jsse-nio-7071-exec-3] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18910953656962408-933540, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:patient-under-active-emergency:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=patient-under-active-emergency, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 3 - Patient under active emergency, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:28:22.633  INFO 15 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=71f8ca95-96c0-469f-bd17-6a2276f1ec26, content=DENY, timestamp=1642332502633, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:patient-under-active-emergency:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=patient-under-active-emergency, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 3 - Patient under active emergency, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:28:22.634  INFO 15 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=78ms, Total=81ms
2022-01-16 11:28:22.659  INFO 15 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=1053db81-5f30-4eb5-bfc4-8286739671e3, content=null, timestamp=1642332502648, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=51696, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=5eea89d14d1a, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=999d21b7-cecf-4b75-ae67-bd5c244cfd50, http-req-server-port=80, http-header-accept=*/*, kc-id=917038d1-218a-4de3-bc21-524ee9b1ec1f, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642332502646, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQCfHNxAH4AEQAAAABh5AFQdAAkOTE3MDM4ZDEtMjE4YS00ZGUzLWJjMjEtNTI0ZWU5YjFlYzFmdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ5OTlkMjFiNy1jZWNmLTRiNzUtYWU2Ny1iZDVjMjQ0Y2ZkNTBwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJKS2NmeHpNR3dHQmVVTmNCczVvZ2tZclhKNlRJX0hyQi04Y3BuakZDa0lZIn0.eyJleHAiOjE2NDIzMzI3OTYsImlhdCI6MTY0MjMzMjQ5NiwianRpIjoiOTE3MDM4ZDEtMjE4YS00ZGUzLWJjMjEtNTI0ZWU5YjFlYzFmIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiI5OTlkMjFiNy1jZWNmLTRiNzUtYWU2Ny1iZDVjMjQ0Y2ZkNTAiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.TNPdGgstBT5KMl1zUUFYUdWBWAX1vTqDRLObIX6Hfm6TD1yNq3YIfGvVs8ew9FkCUjHZv2RxDXwap4ZBgU1XWNfgbY7lRnbcXLwKQVYJ_UngYNYkyfIeNM6f6obFgnYgUZWmuKJPNDWSwOXgaOQYUKn2Kwg84g2RElqDZmS17N-Zrmrpfozma14xSG38xXRYv-xLzM1EYvvOzmGuxWAUpVDlg0H-jAo7M5on-TNuilMfy2lmX-fR8QdyJczEmqrtLszHB-gRh60Vzm3zoDrkhMJEU1EZKqYn9jSEl8QuQahpjS-rHQw5sSk-pQAr0VHiulVAKkKycSls-Wms7_8olg, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre/read, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642332796, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.240.10, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=BF57DE40047C75EF06BF72B0898FDBE0, http-session-last-accessed-time=1642332502646, kc-category-name=ACCESS, kc-iat=1642332496, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:51696 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:28:22.659  INFO 15 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:28:22.661  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6609a011
2022-01-16 11:28:22.661  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6609a011
2022-01-16 11:28:22.671  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6609a011
2022-01-16 11:28:22.671  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6609a011
2022-01-16 11:28:22.726  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6609a011
2022-01-16 11:28:22.726  WARN 15 --- [https-jsse-nio-7071-exec-2] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:28:22.726  WARN 15 --- [https-jsse-nio-7071-exec-2] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:28:22.727  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: under-emergency, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6609a011
2022-01-16 11:28:22.739  INFO 15 --- [https-jsse-nio-7071-exec-2] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18910953760857678-121952, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:patient-under-active-emergency:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=patient-under-active-emergency, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 3 - Patient under active emergency, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:28:22.740  INFO 15 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=1053db81-5f30-4eb5-bfc4-8286739671e3, content=DENY, timestamp=1642332502740, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:patient-under-active-emergency:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=patient-under-active-emergency, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 3 - Patient under active emergency, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:28:22.741  INFO 15 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=81ms, Total=83ms
2022-01-16 11:28:22.758  INFO 15 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=185d59dd-010e-46e7-846e-093748d6aa4c, content=null, timestamp=1642332502752, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=51698, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=5eea89d14d1a, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=999d21b7-cecf-4b75-ae67-bd5c244cfd50, http-req-server-port=80, http-header-accept=*/*, kc-id=917038d1-218a-4de3-bc21-524ee9b1ec1f, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642332502751, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQCfHNxAH4AEQAAAABh5AFQdAAkOTE3MDM4ZDEtMjE4YS00ZGUzLWJjMjEtNTI0ZWU5YjFlYzFmdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ5OTlkMjFiNy1jZWNmLTRiNzUtYWU2Ny1iZDVjMjQ0Y2ZkNTBwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJKS2NmeHpNR3dHQmVVTmNCczVvZ2tZclhKNlRJX0hyQi04Y3BuakZDa0lZIn0.eyJleHAiOjE2NDIzMzI3OTYsImlhdCI6MTY0MjMzMjQ5NiwianRpIjoiOTE3MDM4ZDEtMjE4YS00ZGUzLWJjMjEtNTI0ZWU5YjFlYzFmIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiI5OTlkMjFiNy1jZWNmLTRiNzUtYWU2Ny1iZDVjMjQ0Y2ZkNTAiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.TNPdGgstBT5KMl1zUUFYUdWBWAX1vTqDRLObIX6Hfm6TD1yNq3YIfGvVs8ew9FkCUjHZv2RxDXwap4ZBgU1XWNfgbY7lRnbcXLwKQVYJ_UngYNYkyfIeNM6f6obFgnYgUZWmuKJPNDWSwOXgaOQYUKn2Kwg84g2RElqDZmS17N-Zrmrpfozma14xSG38xXRYv-xLzM1EYvvOzmGuxWAUpVDlg0H-jAo7M5on-TNuilMfy2lmX-fR8QdyJczEmqrtLszHB-gRh60Vzm3zoDrkhMJEU1EZKqYn9jSEl8QuQahpjS-rHQw5sSk-pQAr0VHiulVAKkKycSls-Wms7_8olg, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre/read, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642332796, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.240.10, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=64BF75362BA1111F0D878C768DA1608F, http-session-last-accessed-time=1642332502751, kc-category-name=ACCESS, kc-iat=1642332496, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:51698 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:28:22.758  INFO 15 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:28:22.773  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@509d7ac0
2022-01-16 11:28:22.773  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@509d7ac0
2022-01-16 11:28:22.785  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@509d7ac0
2022-01-16 11:28:22.785  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@509d7ac0
2022-01-16 11:28:22.841  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@509d7ac0
2022-01-16 11:28:22.842  WARN 15 --- [https-jsse-nio-7071-exec-4] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:28:22.842  WARN 15 --- [https-jsse-nio-7071-exec-4] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:28:22.843  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: under-emergency, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@509d7ac0
2022-01-16 11:28:22.853  INFO 15 --- [https-jsse-nio-7071-exec-4] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18910953874313851-72502, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:patient-under-active-emergency:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=patient-under-active-emergency, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 3 - Patient under active emergency, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:28:22.853  INFO 15 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=185d59dd-010e-46e7-846e-093748d6aa4c, content=DENY, timestamp=1642332502853, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:patient-under-active-emergency:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=patient-under-active-emergency, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 3 - Patient under active emergency, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:28:22.854  INFO 15 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=80ms, Total=97ms
2022-01-16 11:28:22.880  INFO 15 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=691eb761-1942-4896-a8e7-f45f85e1a860, content=null, timestamp=1642332502869, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=51700, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=5eea89d14d1a, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=999d21b7-cecf-4b75-ae67-bd5c244cfd50, http-req-server-port=80, http-header-accept=*/*, kc-id=917038d1-218a-4de3-bc21-524ee9b1ec1f, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642332502867, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQCfHNxAH4AEQAAAABh5AFQdAAkOTE3MDM4ZDEtMjE4YS00ZGUzLWJjMjEtNTI0ZWU5YjFlYzFmdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ5OTlkMjFiNy1jZWNmLTRiNzUtYWU2Ny1iZDVjMjQ0Y2ZkNTBwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJKS2NmeHpNR3dHQmVVTmNCczVvZ2tZclhKNlRJX0hyQi04Y3BuakZDa0lZIn0.eyJleHAiOjE2NDIzMzI3OTYsImlhdCI6MTY0MjMzMjQ5NiwianRpIjoiOTE3MDM4ZDEtMjE4YS00ZGUzLWJjMjEtNTI0ZWU5YjFlYzFmIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiI5OTlkMjFiNy1jZWNmLTRiNzUtYWU2Ny1iZDVjMjQ0Y2ZkNTAiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.TNPdGgstBT5KMl1zUUFYUdWBWAX1vTqDRLObIX6Hfm6TD1yNq3YIfGvVs8ew9FkCUjHZv2RxDXwap4ZBgU1XWNfgbY7lRnbcXLwKQVYJ_UngYNYkyfIeNM6f6obFgnYgUZWmuKJPNDWSwOXgaOQYUKn2Kwg84g2RElqDZmS17N-Zrmrpfozma14xSG38xXRYv-xLzM1EYvvOzmGuxWAUpVDlg0H-jAo7M5on-TNuilMfy2lmX-fR8QdyJczEmqrtLszHB-gRh60Vzm3zoDrkhMJEU1EZKqYn9jSEl8QuQahpjS-rHQw5sSk-pQAr0VHiulVAKkKycSls-Wms7_8olg, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre/read, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642332796, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.240.10, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=92D61F2C026C8F659C9BEC4C82717049, http-session-last-accessed-time=1642332502867, kc-category-name=ACCESS, kc-iat=1642332496, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:51700 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:28:22.881  INFO 15 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:28:22.882  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@66ce16c9
2022-01-16 11:28:22.882  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@66ce16c9
2022-01-16 11:28:22.890  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@66ce16c9
2022-01-16 11:28:22.890  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@66ce16c9
2022-01-16 11:28:22.942  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@66ce16c9
2022-01-16 11:28:22.942  WARN 15 --- [https-jsse-nio-7071-exec-5] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:28:22.942  WARN 15 --- [https-jsse-nio-7071-exec-5] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:28:22.942  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: under-emergency, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@66ce16c9
2022-01-16 11:28:22.956  INFO 15 --- [https-jsse-nio-7071-exec-5] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18910953982359773-157708, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:patient-under-active-emergency:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=patient-under-active-emergency, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 3 - Patient under active emergency, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:28:22.956  INFO 15 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=691eb761-1942-4896-a8e7-f45f85e1a860, content=DENY, timestamp=1642332502956, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:patient-under-active-emergency:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=patient-under-active-emergency, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 3 - Patient under active emergency, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:28:22.958  INFO 15 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=75ms, Total=79ms
2022-01-16 11:28:22.978  INFO 15 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=7b58a5d4-6f27-4d67-9363-2802f4eacb74, content=null, timestamp=1642332502972, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=51702, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=5eea89d14d1a, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=999d21b7-cecf-4b75-ae67-bd5c244cfd50, http-req-server-port=80, http-header-accept=*/*, kc-id=917038d1-218a-4de3-bc21-524ee9b1ec1f, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642332502970, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQCfHNxAH4AEQAAAABh5AFQdAAkOTE3MDM4ZDEtMjE4YS00ZGUzLWJjMjEtNTI0ZWU5YjFlYzFmdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ5OTlkMjFiNy1jZWNmLTRiNzUtYWU2Ny1iZDVjMjQ0Y2ZkNTBwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJKS2NmeHpNR3dHQmVVTmNCczVvZ2tZclhKNlRJX0hyQi04Y3BuakZDa0lZIn0.eyJleHAiOjE2NDIzMzI3OTYsImlhdCI6MTY0MjMzMjQ5NiwianRpIjoiOTE3MDM4ZDEtMjE4YS00ZGUzLWJjMjEtNTI0ZWU5YjFlYzFmIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiI5OTlkMjFiNy1jZWNmLTRiNzUtYWU2Ny1iZDVjMjQ0Y2ZkNTAiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.TNPdGgstBT5KMl1zUUFYUdWBWAX1vTqDRLObIX6Hfm6TD1yNq3YIfGvVs8ew9FkCUjHZv2RxDXwap4ZBgU1XWNfgbY7lRnbcXLwKQVYJ_UngYNYkyfIeNM6f6obFgnYgUZWmuKJPNDWSwOXgaOQYUKn2Kwg84g2RElqDZmS17N-Zrmrpfozma14xSG38xXRYv-xLzM1EYvvOzmGuxWAUpVDlg0H-jAo7M5on-TNuilMfy2lmX-fR8QdyJczEmqrtLszHB-gRh60Vzm3zoDrkhMJEU1EZKqYn9jSEl8QuQahpjS-rHQw5sSk-pQAr0VHiulVAKkKycSls-Wms7_8olg, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre/read, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642332796, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.240.10, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=5F0EB112F36769CF59228D2C8EED393D, http-session-last-accessed-time=1642332502970, kc-category-name=ACCESS, kc-iat=1642332496, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:51702 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:28:22.979  INFO 15 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:28:22.980  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6da270b9
2022-01-16 11:28:22.980  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6da270b9
2022-01-16 11:28:22.989  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6da270b9
2022-01-16 11:28:22.990  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6da270b9
2022-01-16 11:28:23.042  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6da270b9
2022-01-16 11:28:23.042  WARN 15 --- [https-jsse-nio-7071-exec-6] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:28:23.043  WARN 15 --- [https-jsse-nio-7071-exec-6] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:28:23.043  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: under-emergency, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6da270b9
2022-01-16 11:28:23.055  INFO 15 --- [https-jsse-nio-7071-exec-6] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18910954080829341-930644, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:patient-under-active-emergency:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=patient-under-active-emergency, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 3 - Patient under active emergency, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:28:23.056  INFO 15 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=7b58a5d4-6f27-4d67-9363-2802f4eacb74, content=DENY, timestamp=1642332503056, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:patient-under-active-emergency:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=patient-under-active-emergency, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 3 - Patient under active emergency, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:28:23.057  INFO 15 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=77ms, Total=81ms
2022-01-16 11:28:23.078  INFO 15 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=2da96008-05f2-4628-8763-e9e727b5925d, content=null, timestamp=1642332503072, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=51704, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=5eea89d14d1a, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=999d21b7-cecf-4b75-ae67-bd5c244cfd50, http-req-server-port=80, http-header-accept=*/*, kc-id=917038d1-218a-4de3-bc21-524ee9b1ec1f, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642332503070, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQCfHNxAH4AEQAAAABh5AFQdAAkOTE3MDM4ZDEtMjE4YS00ZGUzLWJjMjEtNTI0ZWU5YjFlYzFmdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ5OTlkMjFiNy1jZWNmLTRiNzUtYWU2Ny1iZDVjMjQ0Y2ZkNTBwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJKS2NmeHpNR3dHQmVVTmNCczVvZ2tZclhKNlRJX0hyQi04Y3BuakZDa0lZIn0.eyJleHAiOjE2NDIzMzI3OTYsImlhdCI6MTY0MjMzMjQ5NiwianRpIjoiOTE3MDM4ZDEtMjE4YS00ZGUzLWJjMjEtNTI0ZWU5YjFlYzFmIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiI5OTlkMjFiNy1jZWNmLTRiNzUtYWU2Ny1iZDVjMjQ0Y2ZkNTAiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.TNPdGgstBT5KMl1zUUFYUdWBWAX1vTqDRLObIX6Hfm6TD1yNq3YIfGvVs8ew9FkCUjHZv2RxDXwap4ZBgU1XWNfgbY7lRnbcXLwKQVYJ_UngYNYkyfIeNM6f6obFgnYgUZWmuKJPNDWSwOXgaOQYUKn2Kwg84g2RElqDZmS17N-Zrmrpfozma14xSG38xXRYv-xLzM1EYvvOzmGuxWAUpVDlg0H-jAo7M5on-TNuilMfy2lmX-fR8QdyJczEmqrtLszHB-gRh60Vzm3zoDrkhMJEU1EZKqYn9jSEl8QuQahpjS-rHQw5sSk-pQAr0VHiulVAKkKycSls-Wms7_8olg, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre/read, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642332796, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.240.10, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=ED6D782EECDA93A92ADCEEC32D594529, http-session-last-accessed-time=1642332503070, kc-category-name=ACCESS, kc-iat=1642332496, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:51704 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:28:23.079  INFO 15 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:28:23.079  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2aa4b898
2022-01-16 11:28:23.079  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2aa4b898
2022-01-16 11:28:23.091  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2aa4b898
2022-01-16 11:28:23.092  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2aa4b898
2022-01-16 11:28:23.142  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2aa4b898
2022-01-16 11:28:23.142  WARN 15 --- [https-jsse-nio-7071-exec-7] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:28:23.142  WARN 15 --- [https-jsse-nio-7071-exec-7] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:28:23.143  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: under-emergency, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2aa4b898
2022-01-16 11:28:23.157  INFO 15 --- [https-jsse-nio-7071-exec-7] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18910954180177659-927139, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:patient-under-active-emergency:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=patient-under-active-emergency, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 3 - Patient under active emergency, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:28:23.157  INFO 15 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=2da96008-05f2-4628-8763-e9e727b5925d, content=DENY, timestamp=1642332503157, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:patient-under-active-emergency:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=patient-under-active-emergency, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 3 - Patient under active emergency, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:28:23.158  INFO 15 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=78ms, Total=82ms
2022-01-16 11:28:23.175  INFO 15 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=e0e11510-bbc2-441d-8d17-f8fe078b8706, content=null, timestamp=1642332503169, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=51706, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=5eea89d14d1a, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=999d21b7-cecf-4b75-ae67-bd5c244cfd50, http-req-server-port=80, http-header-accept=*/*, kc-id=917038d1-218a-4de3-bc21-524ee9b1ec1f, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642332503168, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQCfHNxAH4AEQAAAABh5AFQdAAkOTE3MDM4ZDEtMjE4YS00ZGUzLWJjMjEtNTI0ZWU5YjFlYzFmdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ5OTlkMjFiNy1jZWNmLTRiNzUtYWU2Ny1iZDVjMjQ0Y2ZkNTBwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJKS2NmeHpNR3dHQmVVTmNCczVvZ2tZclhKNlRJX0hyQi04Y3BuakZDa0lZIn0.eyJleHAiOjE2NDIzMzI3OTYsImlhdCI6MTY0MjMzMjQ5NiwianRpIjoiOTE3MDM4ZDEtMjE4YS00ZGUzLWJjMjEtNTI0ZWU5YjFlYzFmIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiI5OTlkMjFiNy1jZWNmLTRiNzUtYWU2Ny1iZDVjMjQ0Y2ZkNTAiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.TNPdGgstBT5KMl1zUUFYUdWBWAX1vTqDRLObIX6Hfm6TD1yNq3YIfGvVs8ew9FkCUjHZv2RxDXwap4ZBgU1XWNfgbY7lRnbcXLwKQVYJ_UngYNYkyfIeNM6f6obFgnYgUZWmuKJPNDWSwOXgaOQYUKn2Kwg84g2RElqDZmS17N-Zrmrpfozma14xSG38xXRYv-xLzM1EYvvOzmGuxWAUpVDlg0H-jAo7M5on-TNuilMfy2lmX-fR8QdyJczEmqrtLszHB-gRh60Vzm3zoDrkhMJEU1EZKqYn9jSEl8QuQahpjS-rHQw5sSk-pQAr0VHiulVAKkKycSls-Wms7_8olg, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre/read, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642332796, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.240.10, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=7242889171CE73460B6E0A91806B454D, http-session-last-accessed-time=1642332503168, kc-category-name=ACCESS, kc-iat=1642332496, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:51706 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:28:23.176  INFO 15 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:28:23.176  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6c8db5e5
2022-01-16 11:28:23.177  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6c8db5e5
2022-01-16 11:28:23.185  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6c8db5e5
2022-01-16 11:28:23.185  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6c8db5e5
2022-01-16 11:28:23.233  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6c8db5e5
2022-01-16 11:28:23.234  WARN 15 --- [https-jsse-nio-7071-exec-8] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:28:23.234  WARN 15 --- [https-jsse-nio-7071-exec-8] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:28:23.234  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: under-emergency, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6c8db5e5
2022-01-16 11:28:23.246  INFO 15 --- [https-jsse-nio-7071-exec-8] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18910954277049675-839847, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:patient-under-active-emergency:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=patient-under-active-emergency, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 3 - Patient under active emergency, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:28:23.247  INFO 15 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=e0e11510-bbc2-441d-8d17-f8fe078b8706, content=DENY, timestamp=1642332503247, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:patient-under-active-emergency:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=patient-under-active-emergency, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 3 - Patient under active emergency, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:28:23.248  INFO 15 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=71ms, Total=74ms
2022-01-16 11:28:23.268  INFO 15 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=53b5c22d-aa61-4060-b3b1-4015a677bf8e, content=null, timestamp=1642332503262, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=51708, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=5eea89d14d1a, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=999d21b7-cecf-4b75-ae67-bd5c244cfd50, http-req-server-port=80, http-header-accept=*/*, kc-id=917038d1-218a-4de3-bc21-524ee9b1ec1f, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642332503260, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQCfHNxAH4AEQAAAABh5AFQdAAkOTE3MDM4ZDEtMjE4YS00ZGUzLWJjMjEtNTI0ZWU5YjFlYzFmdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ5OTlkMjFiNy1jZWNmLTRiNzUtYWU2Ny1iZDVjMjQ0Y2ZkNTBwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJKS2NmeHpNR3dHQmVVTmNCczVvZ2tZclhKNlRJX0hyQi04Y3BuakZDa0lZIn0.eyJleHAiOjE2NDIzMzI3OTYsImlhdCI6MTY0MjMzMjQ5NiwianRpIjoiOTE3MDM4ZDEtMjE4YS00ZGUzLWJjMjEtNTI0ZWU5YjFlYzFmIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiI5OTlkMjFiNy1jZWNmLTRiNzUtYWU2Ny1iZDVjMjQ0Y2ZkNTAiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.TNPdGgstBT5KMl1zUUFYUdWBWAX1vTqDRLObIX6Hfm6TD1yNq3YIfGvVs8ew9FkCUjHZv2RxDXwap4ZBgU1XWNfgbY7lRnbcXLwKQVYJ_UngYNYkyfIeNM6f6obFgnYgUZWmuKJPNDWSwOXgaOQYUKn2Kwg84g2RElqDZmS17N-Zrmrpfozma14xSG38xXRYv-xLzM1EYvvOzmGuxWAUpVDlg0H-jAo7M5on-TNuilMfy2lmX-fR8QdyJczEmqrtLszHB-gRh60Vzm3zoDrkhMJEU1EZKqYn9jSEl8QuQahpjS-rHQw5sSk-pQAr0VHiulVAKkKycSls-Wms7_8olg, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre/read, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642332796, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.240.10, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=2439E4338BE98DEA7F8413F5D043C609, http-session-last-accessed-time=1642332503260, kc-category-name=ACCESS, kc-iat=1642332496, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:51708 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:28:23.269  INFO 15 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:28:23.270  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5036fd80
2022-01-16 11:28:23.270  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5036fd80
2022-01-16 11:28:23.279  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5036fd80
2022-01-16 11:28:23.279  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5036fd80
2022-01-16 11:28:23.330  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5036fd80
2022-01-16 11:28:23.330  WARN 15 --- [https-jsse-nio-7071-exec-9] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:28:23.330  WARN 15 --- [https-jsse-nio-7071-exec-9] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:28:23.330  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: under-emergency, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5036fd80
2022-01-16 11:28:23.345  INFO 15 --- [https-jsse-nio-7071-exec-9] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18910954370538160-251200, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:patient-under-active-emergency:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=patient-under-active-emergency, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 3 - Patient under active emergency, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:28:23.345  INFO 15 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=53b5c22d-aa61-4060-b3b1-4015a677bf8e, content=DENY, timestamp=1642332503345, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:patient-under-active-emergency:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=patient-under-active-emergency, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 3 - Patient under active emergency, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:28:23.346  INFO 15 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=76ms, Total=79ms
2022-01-16 11:28:23.367  INFO 15 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=a3a8fedc-6ee6-4d0a-83b2-450669b1f97c, content=null, timestamp=1642332503362, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=51710, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=5eea89d14d1a, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=999d21b7-cecf-4b75-ae67-bd5c244cfd50, http-req-server-port=80, http-header-accept=*/*, kc-id=917038d1-218a-4de3-bc21-524ee9b1ec1f, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642332503360, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQCfHNxAH4AEQAAAABh5AFQdAAkOTE3MDM4ZDEtMjE4YS00ZGUzLWJjMjEtNTI0ZWU5YjFlYzFmdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ5OTlkMjFiNy1jZWNmLTRiNzUtYWU2Ny1iZDVjMjQ0Y2ZkNTBwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJKS2NmeHpNR3dHQmVVTmNCczVvZ2tZclhKNlRJX0hyQi04Y3BuakZDa0lZIn0.eyJleHAiOjE2NDIzMzI3OTYsImlhdCI6MTY0MjMzMjQ5NiwianRpIjoiOTE3MDM4ZDEtMjE4YS00ZGUzLWJjMjEtNTI0ZWU5YjFlYzFmIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiI5OTlkMjFiNy1jZWNmLTRiNzUtYWU2Ny1iZDVjMjQ0Y2ZkNTAiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.TNPdGgstBT5KMl1zUUFYUdWBWAX1vTqDRLObIX6Hfm6TD1yNq3YIfGvVs8ew9FkCUjHZv2RxDXwap4ZBgU1XWNfgbY7lRnbcXLwKQVYJ_UngYNYkyfIeNM6f6obFgnYgUZWmuKJPNDWSwOXgaOQYUKn2Kwg84g2RElqDZmS17N-Zrmrpfozma14xSG38xXRYv-xLzM1EYvvOzmGuxWAUpVDlg0H-jAo7M5on-TNuilMfy2lmX-fR8QdyJczEmqrtLszHB-gRh60Vzm3zoDrkhMJEU1EZKqYn9jSEl8QuQahpjS-rHQw5sSk-pQAr0VHiulVAKkKycSls-Wms7_8olg, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre/read, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642332796, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.240.10, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=F201D394BE3D96C9C7F1C6BA161FCFD5, http-session-last-accessed-time=1642332503360, kc-category-name=ACCESS, kc-iat=1642332496, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:51710 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:28:23.367  INFO 15 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:28:23.368  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4c7691de
2022-01-16 11:28:23.369  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4c7691de
2022-01-16 11:28:23.381  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4c7691de
2022-01-16 11:28:23.381  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4c7691de
2022-01-16 11:28:23.433  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4c7691de
2022-01-16 11:28:23.433  WARN 15 --- [https-jsse-nio-7071-exec-10] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:28:23.433  WARN 15 --- [https-jsse-nio-7071-exec-10] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:28:23.433  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: under-emergency, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4c7691de
2022-01-16 11:28:23.445  INFO 15 --- [https-jsse-nio-7071-exec-10] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18910954469196562-490105, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:patient-under-active-emergency:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=patient-under-active-emergency, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 3 - Patient under active emergency, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:28:23.445  INFO 15 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=a3a8fedc-6ee6-4d0a-83b2-450669b1f97c, content=DENY, timestamp=1642332503445, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:patient-under-active-emergency:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=patient-under-active-emergency, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 3 - Patient under active emergency, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:28:23.446  INFO 15 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=77ms, Total=80ms
2022-01-16 11:28:23.473  INFO 15 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=912886ab-d856-4043-8f57-656e48fd61d3, content=null, timestamp=1642332503469, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=51712, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=5eea89d14d1a, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=999d21b7-cecf-4b75-ae67-bd5c244cfd50, http-req-server-port=80, http-header-accept=*/*, kc-id=917038d1-218a-4de3-bc21-524ee9b1ec1f, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642332503468, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQCfHNxAH4AEQAAAABh5AFQdAAkOTE3MDM4ZDEtMjE4YS00ZGUzLWJjMjEtNTI0ZWU5YjFlYzFmdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ5OTlkMjFiNy1jZWNmLTRiNzUtYWU2Ny1iZDVjMjQ0Y2ZkNTBwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJKS2NmeHpNR3dHQmVVTmNCczVvZ2tZclhKNlRJX0hyQi04Y3BuakZDa0lZIn0.eyJleHAiOjE2NDIzMzI3OTYsImlhdCI6MTY0MjMzMjQ5NiwianRpIjoiOTE3MDM4ZDEtMjE4YS00ZGUzLWJjMjEtNTI0ZWU5YjFlYzFmIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiI5OTlkMjFiNy1jZWNmLTRiNzUtYWU2Ny1iZDVjMjQ0Y2ZkNTAiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.TNPdGgstBT5KMl1zUUFYUdWBWAX1vTqDRLObIX6Hfm6TD1yNq3YIfGvVs8ew9FkCUjHZv2RxDXwap4ZBgU1XWNfgbY7lRnbcXLwKQVYJ_UngYNYkyfIeNM6f6obFgnYgUZWmuKJPNDWSwOXgaOQYUKn2Kwg84g2RElqDZmS17N-Zrmrpfozma14xSG38xXRYv-xLzM1EYvvOzmGuxWAUpVDlg0H-jAo7M5on-TNuilMfy2lmX-fR8QdyJczEmqrtLszHB-gRh60Vzm3zoDrkhMJEU1EZKqYn9jSEl8QuQahpjS-rHQw5sSk-pQAr0VHiulVAKkKycSls-Wms7_8olg, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre/read, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642332796, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.240.10, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=BA6BF517F294AA296D0C9873C0DBD35A, http-session-last-accessed-time=1642332503468, kc-category-name=ACCESS, kc-iat=1642332496, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:51712 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:28:23.475  INFO 15 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:28:23.476  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@28c6d2ee
2022-01-16 11:28:23.476  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@28c6d2ee
2022-01-16 11:28:23.489  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@28c6d2ee
2022-01-16 11:28:23.489  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@28c6d2ee
2022-01-16 11:28:23.538  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@28c6d2ee
2022-01-16 11:28:23.538  WARN 15 --- [https-jsse-nio-7071-exec-1] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:28:23.538  WARN 15 --- [https-jsse-nio-7071-exec-1] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:28:23.538  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: under-emergency, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@28c6d2ee
2022-01-16 11:28:23.550  INFO 15 --- [https-jsse-nio-7071-exec-1] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18910954576104074-929459, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:patient-under-active-emergency:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=patient-under-active-emergency, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 3 - Patient under active emergency, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:28:23.550  INFO 15 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=912886ab-d856-4043-8f57-656e48fd61d3, content=DENY, timestamp=1642332503550, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:patient-under-active-emergency:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=patient-under-active-emergency, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 3 - Patient under active emergency, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:28:23.551  INFO 15 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=75ms, Total=79ms
2022-01-16 11:28:23.570  INFO 15 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=05c419a1-efb9-4610-a572-959e461dfca0, content=null, timestamp=1642332503564, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=51714, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=5eea89d14d1a, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=999d21b7-cecf-4b75-ae67-bd5c244cfd50, http-req-server-port=80, http-header-accept=*/*, kc-id=917038d1-218a-4de3-bc21-524ee9b1ec1f, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642332503563, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQCfHNxAH4AEQAAAABh5AFQdAAkOTE3MDM4ZDEtMjE4YS00ZGUzLWJjMjEtNTI0ZWU5YjFlYzFmdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ5OTlkMjFiNy1jZWNmLTRiNzUtYWU2Ny1iZDVjMjQ0Y2ZkNTBwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJKS2NmeHpNR3dHQmVVTmNCczVvZ2tZclhKNlRJX0hyQi04Y3BuakZDa0lZIn0.eyJleHAiOjE2NDIzMzI3OTYsImlhdCI6MTY0MjMzMjQ5NiwianRpIjoiOTE3MDM4ZDEtMjE4YS00ZGUzLWJjMjEtNTI0ZWU5YjFlYzFmIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiI5OTlkMjFiNy1jZWNmLTRiNzUtYWU2Ny1iZDVjMjQ0Y2ZkNTAiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.TNPdGgstBT5KMl1zUUFYUdWBWAX1vTqDRLObIX6Hfm6TD1yNq3YIfGvVs8ew9FkCUjHZv2RxDXwap4ZBgU1XWNfgbY7lRnbcXLwKQVYJ_UngYNYkyfIeNM6f6obFgnYgUZWmuKJPNDWSwOXgaOQYUKn2Kwg84g2RElqDZmS17N-Zrmrpfozma14xSG38xXRYv-xLzM1EYvvOzmGuxWAUpVDlg0H-jAo7M5on-TNuilMfy2lmX-fR8QdyJczEmqrtLszHB-gRh60Vzm3zoDrkhMJEU1EZKqYn9jSEl8QuQahpjS-rHQw5sSk-pQAr0VHiulVAKkKycSls-Wms7_8olg, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre/read, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642332796, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.240.10, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=FE905046F07982495DD9F1FA7A6FF921, http-session-last-accessed-time=1642332503563, kc-category-name=ACCESS, kc-iat=1642332496, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:51714 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:28:23.571  INFO 15 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:28:23.573  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2cc3888f
2022-01-16 11:28:23.573  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2cc3888f
2022-01-16 11:28:23.584  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2cc3888f
2022-01-16 11:28:23.585  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2cc3888f
2022-01-16 11:28:23.634  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2cc3888f
2022-01-16 11:28:23.634  WARN 15 --- [https-jsse-nio-7071-exec-3] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:28:23.635  WARN 15 --- [https-jsse-nio-7071-exec-3] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:28:23.635  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: under-emergency, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2cc3888f
2022-01-16 11:28:23.645  INFO 15 --- [https-jsse-nio-7071-exec-3] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18910954673102136-349734, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:patient-under-active-emergency:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=patient-under-active-emergency, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 3 - Patient under active emergency, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:28:23.645  INFO 15 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=05c419a1-efb9-4610-a572-959e461dfca0, content=DENY, timestamp=1642332503645, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:patient-under-active-emergency:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=patient-under-active-emergency, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 3 - Patient under active emergency, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:28:23.646  INFO 15 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=73ms, Total=77ms
2022-01-16 11:28:23.677  INFO 15 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=01c10c78-3bf9-41c7-b934-3e835fa5a792, content=null, timestamp=1642332503660, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=51716, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=5eea89d14d1a, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=999d21b7-cecf-4b75-ae67-bd5c244cfd50, http-req-server-port=80, http-header-accept=*/*, kc-id=917038d1-218a-4de3-bc21-524ee9b1ec1f, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642332503658, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQCfHNxAH4AEQAAAABh5AFQdAAkOTE3MDM4ZDEtMjE4YS00ZGUzLWJjMjEtNTI0ZWU5YjFlYzFmdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ5OTlkMjFiNy1jZWNmLTRiNzUtYWU2Ny1iZDVjMjQ0Y2ZkNTBwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJKS2NmeHpNR3dHQmVVTmNCczVvZ2tZclhKNlRJX0hyQi04Y3BuakZDa0lZIn0.eyJleHAiOjE2NDIzMzI3OTYsImlhdCI6MTY0MjMzMjQ5NiwianRpIjoiOTE3MDM4ZDEtMjE4YS00ZGUzLWJjMjEtNTI0ZWU5YjFlYzFmIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiI5OTlkMjFiNy1jZWNmLTRiNzUtYWU2Ny1iZDVjMjQ0Y2ZkNTAiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.TNPdGgstBT5KMl1zUUFYUdWBWAX1vTqDRLObIX6Hfm6TD1yNq3YIfGvVs8ew9FkCUjHZv2RxDXwap4ZBgU1XWNfgbY7lRnbcXLwKQVYJ_UngYNYkyfIeNM6f6obFgnYgUZWmuKJPNDWSwOXgaOQYUKn2Kwg84g2RElqDZmS17N-Zrmrpfozma14xSG38xXRYv-xLzM1EYvvOzmGuxWAUpVDlg0H-jAo7M5on-TNuilMfy2lmX-fR8QdyJczEmqrtLszHB-gRh60Vzm3zoDrkhMJEU1EZKqYn9jSEl8QuQahpjS-rHQw5sSk-pQAr0VHiulVAKkKycSls-Wms7_8olg, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre/read, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642332796, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.240.10, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=5FB2A530B639810563996704A0C27B0A, http-session-last-accessed-time=1642332503658, kc-category-name=ACCESS, kc-iat=1642332496, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:51716 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:28:23.678  INFO 15 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:28:23.679  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@af202b2
2022-01-16 11:28:23.679  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@af202b2
2022-01-16 11:28:23.687  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@af202b2
2022-01-16 11:28:23.687  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@af202b2
2022-01-16 11:28:23.737  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@af202b2
2022-01-16 11:28:23.738  WARN 15 --- [https-jsse-nio-7071-exec-2] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:28:23.739  WARN 15 --- [https-jsse-nio-7071-exec-2] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:28:23.739  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: under-emergency, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@af202b2
2022-01-16 11:28:23.752  INFO 15 --- [https-jsse-nio-7071-exec-2] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18910954779523977-566750, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:patient-under-active-emergency:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=patient-under-active-emergency, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 3 - Patient under active emergency, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:28:23.752  INFO 15 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=01c10c78-3bf9-41c7-b934-3e835fa5a792, content=DENY, timestamp=1642332503752, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:patient-under-active-emergency:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=patient-under-active-emergency, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 3 - Patient under active emergency, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:28:23.753  INFO 15 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=74ms, Total=89ms
2022-01-16 11:28:23.770  INFO 15 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=da03e074-05a1-4f9b-8406-ff1bac9c64da, content=null, timestamp=1642332503764, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=51718, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=5eea89d14d1a, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=999d21b7-cecf-4b75-ae67-bd5c244cfd50, http-req-server-port=80, http-header-accept=*/*, kc-id=917038d1-218a-4de3-bc21-524ee9b1ec1f, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642332503763, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQCfHNxAH4AEQAAAABh5AFQdAAkOTE3MDM4ZDEtMjE4YS00ZGUzLWJjMjEtNTI0ZWU5YjFlYzFmdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ5OTlkMjFiNy1jZWNmLTRiNzUtYWU2Ny1iZDVjMjQ0Y2ZkNTBwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJKS2NmeHpNR3dHQmVVTmNCczVvZ2tZclhKNlRJX0hyQi04Y3BuakZDa0lZIn0.eyJleHAiOjE2NDIzMzI3OTYsImlhdCI6MTY0MjMzMjQ5NiwianRpIjoiOTE3MDM4ZDEtMjE4YS00ZGUzLWJjMjEtNTI0ZWU5YjFlYzFmIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiI5OTlkMjFiNy1jZWNmLTRiNzUtYWU2Ny1iZDVjMjQ0Y2ZkNTAiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.TNPdGgstBT5KMl1zUUFYUdWBWAX1vTqDRLObIX6Hfm6TD1yNq3YIfGvVs8ew9FkCUjHZv2RxDXwap4ZBgU1XWNfgbY7lRnbcXLwKQVYJ_UngYNYkyfIeNM6f6obFgnYgUZWmuKJPNDWSwOXgaOQYUKn2Kwg84g2RElqDZmS17N-Zrmrpfozma14xSG38xXRYv-xLzM1EYvvOzmGuxWAUpVDlg0H-jAo7M5on-TNuilMfy2lmX-fR8QdyJczEmqrtLszHB-gRh60Vzm3zoDrkhMJEU1EZKqYn9jSEl8QuQahpjS-rHQw5sSk-pQAr0VHiulVAKkKycSls-Wms7_8olg, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre/read, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642332796, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.240.10, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=03A02E13FFB41047FAB5FDEFDC9EFA27, http-session-last-accessed-time=1642332503763, kc-category-name=ACCESS, kc-iat=1642332496, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:51718 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:28:23.770  INFO 15 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:28:23.771  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1f83335
2022-01-16 11:28:23.771  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1f83335
2022-01-16 11:28:23.779  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1f83335
2022-01-16 11:28:23.779  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1f83335
2022-01-16 11:28:23.830  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1f83335
2022-01-16 11:28:23.830  WARN 15 --- [https-jsse-nio-7071-exec-4] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:28:23.830  WARN 15 --- [https-jsse-nio-7071-exec-4] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:28:23.831  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: under-emergency, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1f83335
2022-01-16 11:28:23.842  INFO 15 --- [https-jsse-nio-7071-exec-4] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18910954871663111-378349, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:patient-under-active-emergency:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=patient-under-active-emergency, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 3 - Patient under active emergency, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:28:23.842  INFO 15 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=da03e074-05a1-4f9b-8406-ff1bac9c64da, content=DENY, timestamp=1642332503842, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:patient-under-active-emergency:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=patient-under-active-emergency, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 3 - Patient under active emergency, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:28:23.843  INFO 15 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=72ms, Total=75ms
2022-01-16 11:28:23.860  INFO 15 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=e5f5013d-99d5-45ed-951a-1af9bca21b0c, content=null, timestamp=1642332503855, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=51720, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=5eea89d14d1a, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=999d21b7-cecf-4b75-ae67-bd5c244cfd50, http-req-server-port=80, http-header-accept=*/*, kc-id=917038d1-218a-4de3-bc21-524ee9b1ec1f, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642332503854, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQCfHNxAH4AEQAAAABh5AFQdAAkOTE3MDM4ZDEtMjE4YS00ZGUzLWJjMjEtNTI0ZWU5YjFlYzFmdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ5OTlkMjFiNy1jZWNmLTRiNzUtYWU2Ny1iZDVjMjQ0Y2ZkNTBwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJKS2NmeHpNR3dHQmVVTmNCczVvZ2tZclhKNlRJX0hyQi04Y3BuakZDa0lZIn0.eyJleHAiOjE2NDIzMzI3OTYsImlhdCI6MTY0MjMzMjQ5NiwianRpIjoiOTE3MDM4ZDEtMjE4YS00ZGUzLWJjMjEtNTI0ZWU5YjFlYzFmIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiI5OTlkMjFiNy1jZWNmLTRiNzUtYWU2Ny1iZDVjMjQ0Y2ZkNTAiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.TNPdGgstBT5KMl1zUUFYUdWBWAX1vTqDRLObIX6Hfm6TD1yNq3YIfGvVs8ew9FkCUjHZv2RxDXwap4ZBgU1XWNfgbY7lRnbcXLwKQVYJ_UngYNYkyfIeNM6f6obFgnYgUZWmuKJPNDWSwOXgaOQYUKn2Kwg84g2RElqDZmS17N-Zrmrpfozma14xSG38xXRYv-xLzM1EYvvOzmGuxWAUpVDlg0H-jAo7M5on-TNuilMfy2lmX-fR8QdyJczEmqrtLszHB-gRh60Vzm3zoDrkhMJEU1EZKqYn9jSEl8QuQahpjS-rHQw5sSk-pQAr0VHiulVAKkKycSls-Wms7_8olg, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre/read, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642332796, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.240.10, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=EA26582DD19A98F3AE6991B76FA712EF, http-session-last-accessed-time=1642332503854, kc-category-name=ACCESS, kc-iat=1642332496, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:51720 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:28:23.861  INFO 15 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:28:23.862  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@35ab5bb0
2022-01-16 11:28:23.862  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@35ab5bb0
2022-01-16 11:28:23.870  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@35ab5bb0
2022-01-16 11:28:23.871  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@35ab5bb0
2022-01-16 11:28:23.922  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@35ab5bb0
2022-01-16 11:28:23.922  WARN 15 --- [https-jsse-nio-7071-exec-5] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:28:23.923  WARN 15 --- [https-jsse-nio-7071-exec-5] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:28:23.924  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: under-emergency, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@35ab5bb0
2022-01-16 11:28:23.938  INFO 15 --- [https-jsse-nio-7071-exec-5] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18910954962533157-451590, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:patient-under-active-emergency:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=patient-under-active-emergency, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 3 - Patient under active emergency, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:28:23.938  INFO 15 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=e5f5013d-99d5-45ed-951a-1af9bca21b0c, content=DENY, timestamp=1642332503938, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:patient-under-active-emergency:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=patient-under-active-emergency, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 3 - Patient under active emergency, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:28:23.939  INFO 15 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=77ms, Total=81ms
2022-01-16 11:28:23.958  INFO 15 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=8bb4444b-a87d-4b88-945d-8f9da5490a48, content=null, timestamp=1642332503953, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=51722, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=5eea89d14d1a, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=999d21b7-cecf-4b75-ae67-bd5c244cfd50, http-req-server-port=80, http-header-accept=*/*, kc-id=917038d1-218a-4de3-bc21-524ee9b1ec1f, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642332503952, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQCfHNxAH4AEQAAAABh5AFQdAAkOTE3MDM4ZDEtMjE4YS00ZGUzLWJjMjEtNTI0ZWU5YjFlYzFmdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ5OTlkMjFiNy1jZWNmLTRiNzUtYWU2Ny1iZDVjMjQ0Y2ZkNTBwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJKS2NmeHpNR3dHQmVVTmNCczVvZ2tZclhKNlRJX0hyQi04Y3BuakZDa0lZIn0.eyJleHAiOjE2NDIzMzI3OTYsImlhdCI6MTY0MjMzMjQ5NiwianRpIjoiOTE3MDM4ZDEtMjE4YS00ZGUzLWJjMjEtNTI0ZWU5YjFlYzFmIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiI5OTlkMjFiNy1jZWNmLTRiNzUtYWU2Ny1iZDVjMjQ0Y2ZkNTAiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.TNPdGgstBT5KMl1zUUFYUdWBWAX1vTqDRLObIX6Hfm6TD1yNq3YIfGvVs8ew9FkCUjHZv2RxDXwap4ZBgU1XWNfgbY7lRnbcXLwKQVYJ_UngYNYkyfIeNM6f6obFgnYgUZWmuKJPNDWSwOXgaOQYUKn2Kwg84g2RElqDZmS17N-Zrmrpfozma14xSG38xXRYv-xLzM1EYvvOzmGuxWAUpVDlg0H-jAo7M5on-TNuilMfy2lmX-fR8QdyJczEmqrtLszHB-gRh60Vzm3zoDrkhMJEU1EZKqYn9jSEl8QuQahpjS-rHQw5sSk-pQAr0VHiulVAKkKycSls-Wms7_8olg, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre/read, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642332796, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.240.10, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=D5428F7B90E6CC3AA005DDAD9E12CD50, http-session-last-accessed-time=1642332503952, kc-category-name=ACCESS, kc-iat=1642332496, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:51722 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:28:23.958  INFO 15 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:28:23.959  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@74f7e362
2022-01-16 11:28:23.960  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@74f7e362
2022-01-16 11:28:23.968  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@74f7e362
2022-01-16 11:28:23.968  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@74f7e362
2022-01-16 11:28:24.018  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@74f7e362
2022-01-16 11:28:24.018  WARN 15 --- [https-jsse-nio-7071-exec-6] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:28:24.018  WARN 15 --- [https-jsse-nio-7071-exec-6] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:28:24.018  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: under-emergency, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@74f7e362
2022-01-16 11:28:24.028  INFO 15 --- [https-jsse-nio-7071-exec-6] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18910955060183032-300602, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:patient-under-active-emergency:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=patient-under-active-emergency, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 3 - Patient under active emergency, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:28:24.028  INFO 15 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=8bb4444b-a87d-4b88-945d-8f9da5490a48, content=DENY, timestamp=1642332504028, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:patient-under-active-emergency:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=patient-under-active-emergency, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 3 - Patient under active emergency, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:28:24.029  INFO 15 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=69ms, Total=73ms
2022-01-16 11:28:24.046  INFO 15 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=65dd4f6d-8fff-4530-b489-34d3bf5d242f, content=null, timestamp=1642332504041, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=51724, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=5eea89d14d1a, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=999d21b7-cecf-4b75-ae67-bd5c244cfd50, http-req-server-port=80, http-header-accept=*/*, kc-id=917038d1-218a-4de3-bc21-524ee9b1ec1f, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642332504039, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQCfHNxAH4AEQAAAABh5AFQdAAkOTE3MDM4ZDEtMjE4YS00ZGUzLWJjMjEtNTI0ZWU5YjFlYzFmdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ5OTlkMjFiNy1jZWNmLTRiNzUtYWU2Ny1iZDVjMjQ0Y2ZkNTBwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJKS2NmeHpNR3dHQmVVTmNCczVvZ2tZclhKNlRJX0hyQi04Y3BuakZDa0lZIn0.eyJleHAiOjE2NDIzMzI3OTYsImlhdCI6MTY0MjMzMjQ5NiwianRpIjoiOTE3MDM4ZDEtMjE4YS00ZGUzLWJjMjEtNTI0ZWU5YjFlYzFmIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiI5OTlkMjFiNy1jZWNmLTRiNzUtYWU2Ny1iZDVjMjQ0Y2ZkNTAiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.TNPdGgstBT5KMl1zUUFYUdWBWAX1vTqDRLObIX6Hfm6TD1yNq3YIfGvVs8ew9FkCUjHZv2RxDXwap4ZBgU1XWNfgbY7lRnbcXLwKQVYJ_UngYNYkyfIeNM6f6obFgnYgUZWmuKJPNDWSwOXgaOQYUKn2Kwg84g2RElqDZmS17N-Zrmrpfozma14xSG38xXRYv-xLzM1EYvvOzmGuxWAUpVDlg0H-jAo7M5on-TNuilMfy2lmX-fR8QdyJczEmqrtLszHB-gRh60Vzm3zoDrkhMJEU1EZKqYn9jSEl8QuQahpjS-rHQw5sSk-pQAr0VHiulVAKkKycSls-Wms7_8olg, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre/read, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642332796, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.240.10, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=6AC3CEA618E4D90AAE9152E17D9F209E, http-session-last-accessed-time=1642332504039, kc-category-name=ACCESS, kc-iat=1642332496, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:51724 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:28:24.046  INFO 15 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:28:24.047  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@79a02fe4
2022-01-16 11:28:24.047  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@79a02fe4
2022-01-16 11:28:24.055  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@79a02fe4
2022-01-16 11:28:24.056  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@79a02fe4
2022-01-16 11:28:24.106  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@79a02fe4
2022-01-16 11:28:24.106  WARN 15 --- [https-jsse-nio-7071-exec-7] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:28:24.107  WARN 15 --- [https-jsse-nio-7071-exec-7] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:28:24.108  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: under-emergency, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@79a02fe4
2022-01-16 11:28:24.118  INFO 15 --- [https-jsse-nio-7071-exec-7] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18910955147768253-216234, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:patient-under-active-emergency:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=patient-under-active-emergency, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 3 - Patient under active emergency, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:28:24.118  INFO 15 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=65dd4f6d-8fff-4530-b489-34d3bf5d242f, content=DENY, timestamp=1642332504118, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:patient-under-active-emergency:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=patient-under-active-emergency, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 3 - Patient under active emergency, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:28:24.120  INFO 15 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=72ms, Total=75ms
2022-01-16 11:28:24.136  INFO 15 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=0c6860b8-3f2b-4da9-9aeb-cae85162d973, content=null, timestamp=1642332504131, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=51726, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=5eea89d14d1a, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=999d21b7-cecf-4b75-ae67-bd5c244cfd50, http-req-server-port=80, http-header-accept=*/*, kc-id=917038d1-218a-4de3-bc21-524ee9b1ec1f, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642332504130, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQCfHNxAH4AEQAAAABh5AFQdAAkOTE3MDM4ZDEtMjE4YS00ZGUzLWJjMjEtNTI0ZWU5YjFlYzFmdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ5OTlkMjFiNy1jZWNmLTRiNzUtYWU2Ny1iZDVjMjQ0Y2ZkNTBwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJKS2NmeHpNR3dHQmVVTmNCczVvZ2tZclhKNlRJX0hyQi04Y3BuakZDa0lZIn0.eyJleHAiOjE2NDIzMzI3OTYsImlhdCI6MTY0MjMzMjQ5NiwianRpIjoiOTE3MDM4ZDEtMjE4YS00ZGUzLWJjMjEtNTI0ZWU5YjFlYzFmIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiI5OTlkMjFiNy1jZWNmLTRiNzUtYWU2Ny1iZDVjMjQ0Y2ZkNTAiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.TNPdGgstBT5KMl1zUUFYUdWBWAX1vTqDRLObIX6Hfm6TD1yNq3YIfGvVs8ew9FkCUjHZv2RxDXwap4ZBgU1XWNfgbY7lRnbcXLwKQVYJ_UngYNYkyfIeNM6f6obFgnYgUZWmuKJPNDWSwOXgaOQYUKn2Kwg84g2RElqDZmS17N-Zrmrpfozma14xSG38xXRYv-xLzM1EYvvOzmGuxWAUpVDlg0H-jAo7M5on-TNuilMfy2lmX-fR8QdyJczEmqrtLszHB-gRh60Vzm3zoDrkhMJEU1EZKqYn9jSEl8QuQahpjS-rHQw5sSk-pQAr0VHiulVAKkKycSls-Wms7_8olg, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre/read, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642332796, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.240.10, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=3F0C0613914C9ABA5738547825DA710F, http-session-last-accessed-time=1642332504130, kc-category-name=ACCESS, kc-iat=1642332496, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:51726 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:28:24.136  INFO 15 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:28:24.138  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6f422c82
2022-01-16 11:28:24.138  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6f422c82
2022-01-16 11:28:24.147  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6f422c82
2022-01-16 11:28:24.147  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6f422c82
2022-01-16 11:28:24.198  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6f422c82
2022-01-16 11:28:24.198  WARN 15 --- [https-jsse-nio-7071-exec-8] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:28:24.199  WARN 15 --- [https-jsse-nio-7071-exec-8] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:28:24.199  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: under-emergency, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6f422c82
2022-01-16 11:28:24.212  INFO 15 --- [https-jsse-nio-7071-exec-8] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18910955238280310-34284, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:patient-under-active-emergency:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=patient-under-active-emergency, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 3 - Patient under active emergency, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:28:24.212  INFO 15 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=0c6860b8-3f2b-4da9-9aeb-cae85162d973, content=DENY, timestamp=1642332504212, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:patient-under-active-emergency:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=patient-under-active-emergency, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 3 - Patient under active emergency, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:28:24.213  INFO 15 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=75ms, Total=78ms
2022-01-16 11:28:24.235  INFO 15 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=0b21a369-b539-494d-ac81-2690cb2ab3e1, content=null, timestamp=1642332504230, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=51728, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=5eea89d14d1a, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=999d21b7-cecf-4b75-ae67-bd5c244cfd50, http-req-server-port=80, http-header-accept=*/*, kc-id=917038d1-218a-4de3-bc21-524ee9b1ec1f, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642332504228, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQCfHNxAH4AEQAAAABh5AFQdAAkOTE3MDM4ZDEtMjE4YS00ZGUzLWJjMjEtNTI0ZWU5YjFlYzFmdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ5OTlkMjFiNy1jZWNmLTRiNzUtYWU2Ny1iZDVjMjQ0Y2ZkNTBwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJKS2NmeHpNR3dHQmVVTmNCczVvZ2tZclhKNlRJX0hyQi04Y3BuakZDa0lZIn0.eyJleHAiOjE2NDIzMzI3OTYsImlhdCI6MTY0MjMzMjQ5NiwianRpIjoiOTE3MDM4ZDEtMjE4YS00ZGUzLWJjMjEtNTI0ZWU5YjFlYzFmIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiI5OTlkMjFiNy1jZWNmLTRiNzUtYWU2Ny1iZDVjMjQ0Y2ZkNTAiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.TNPdGgstBT5KMl1zUUFYUdWBWAX1vTqDRLObIX6Hfm6TD1yNq3YIfGvVs8ew9FkCUjHZv2RxDXwap4ZBgU1XWNfgbY7lRnbcXLwKQVYJ_UngYNYkyfIeNM6f6obFgnYgUZWmuKJPNDWSwOXgaOQYUKn2Kwg84g2RElqDZmS17N-Zrmrpfozma14xSG38xXRYv-xLzM1EYvvOzmGuxWAUpVDlg0H-jAo7M5on-TNuilMfy2lmX-fR8QdyJczEmqrtLszHB-gRh60Vzm3zoDrkhMJEU1EZKqYn9jSEl8QuQahpjS-rHQw5sSk-pQAr0VHiulVAKkKycSls-Wms7_8olg, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre/read, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642332796, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.240.10, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=26ABB61120AAF6A6D4FCF7C3AB019BA7, http-session-last-accessed-time=1642332504228, kc-category-name=ACCESS, kc-iat=1642332496, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:51728 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:28:24.235  INFO 15 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:28:24.236  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4ec25a20
2022-01-16 11:28:24.237  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4ec25a20
2022-01-16 11:28:24.245  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4ec25a20
2022-01-16 11:28:24.246  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4ec25a20
2022-01-16 11:28:24.293  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4ec25a20
2022-01-16 11:28:24.293  WARN 15 --- [https-jsse-nio-7071-exec-9] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:28:24.293  WARN 15 --- [https-jsse-nio-7071-exec-9] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:28:24.293  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: under-emergency, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4ec25a20
2022-01-16 11:28:24.305  INFO 15 --- [https-jsse-nio-7071-exec-9] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18910955336998657-721191, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:patient-under-active-emergency:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=patient-under-active-emergency, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 3 - Patient under active emergency, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:28:24.305  INFO 15 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=0b21a369-b539-494d-ac81-2690cb2ab3e1, content=DENY, timestamp=1642332504305, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:patient-under-active-emergency:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=patient-under-active-emergency, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 3 - Patient under active emergency, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:28:24.306  INFO 15 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=70ms, Total=72ms
2022-01-16 11:28:24.325  INFO 15 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=739f4312-e911-4d34-84de-b76f90f8bd33, content=null, timestamp=1642332504317, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=51730, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=5eea89d14d1a, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=999d21b7-cecf-4b75-ae67-bd5c244cfd50, http-req-server-port=80, http-header-accept=*/*, kc-id=917038d1-218a-4de3-bc21-524ee9b1ec1f, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642332504316, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQCfHNxAH4AEQAAAABh5AFQdAAkOTE3MDM4ZDEtMjE4YS00ZGUzLWJjMjEtNTI0ZWU5YjFlYzFmdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ5OTlkMjFiNy1jZWNmLTRiNzUtYWU2Ny1iZDVjMjQ0Y2ZkNTBwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJKS2NmeHpNR3dHQmVVTmNCczVvZ2tZclhKNlRJX0hyQi04Y3BuakZDa0lZIn0.eyJleHAiOjE2NDIzMzI3OTYsImlhdCI6MTY0MjMzMjQ5NiwianRpIjoiOTE3MDM4ZDEtMjE4YS00ZGUzLWJjMjEtNTI0ZWU5YjFlYzFmIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiI5OTlkMjFiNy1jZWNmLTRiNzUtYWU2Ny1iZDVjMjQ0Y2ZkNTAiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.TNPdGgstBT5KMl1zUUFYUdWBWAX1vTqDRLObIX6Hfm6TD1yNq3YIfGvVs8ew9FkCUjHZv2RxDXwap4ZBgU1XWNfgbY7lRnbcXLwKQVYJ_UngYNYkyfIeNM6f6obFgnYgUZWmuKJPNDWSwOXgaOQYUKn2Kwg84g2RElqDZmS17N-Zrmrpfozma14xSG38xXRYv-xLzM1EYvvOzmGuxWAUpVDlg0H-jAo7M5on-TNuilMfy2lmX-fR8QdyJczEmqrtLszHB-gRh60Vzm3zoDrkhMJEU1EZKqYn9jSEl8QuQahpjS-rHQw5sSk-pQAr0VHiulVAKkKycSls-Wms7_8olg, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre/read, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642332796, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.240.10, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=C032D24E1A5C66D86C6AB480AF423A19, http-session-last-accessed-time=1642332504316, kc-category-name=ACCESS, kc-iat=1642332496, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:51730 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:28:24.325  INFO 15 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:28:24.326  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7445ed20
2022-01-16 11:28:24.326  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7445ed20
2022-01-16 11:28:24.335  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7445ed20
2022-01-16 11:28:24.335  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7445ed20
2022-01-16 11:28:24.385  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7445ed20
2022-01-16 11:28:24.386  WARN 15 --- [https-jsse-nio-7071-exec-10] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:28:24.386  WARN 15 --- [https-jsse-nio-7071-exec-10] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:28:24.387  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: under-emergency, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7445ed20
2022-01-16 11:28:24.394  INFO 15 --- [https-jsse-nio-7071-exec-10] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18910955426597486-892733, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:patient-under-active-emergency:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=patient-under-active-emergency, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 3 - Patient under active emergency, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:28:24.394  INFO 15 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=739f4312-e911-4d34-84de-b76f90f8bd33, content=DENY, timestamp=1642332504394, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:patient-under-active-emergency:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=patient-under-active-emergency, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 3 - Patient under active emergency, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:28:24.395  INFO 15 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=69ms, Total=71ms
2022-01-16 11:28:24.412  INFO 15 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=b4620be9-febf-4273-982f-011c48f5660a, content=null, timestamp=1642332504406, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=51732, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=5eea89d14d1a, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=999d21b7-cecf-4b75-ae67-bd5c244cfd50, http-req-server-port=80, http-header-accept=*/*, kc-id=917038d1-218a-4de3-bc21-524ee9b1ec1f, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642332504405, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQCfHNxAH4AEQAAAABh5AFQdAAkOTE3MDM4ZDEtMjE4YS00ZGUzLWJjMjEtNTI0ZWU5YjFlYzFmdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ5OTlkMjFiNy1jZWNmLTRiNzUtYWU2Ny1iZDVjMjQ0Y2ZkNTBwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJKS2NmeHpNR3dHQmVVTmNCczVvZ2tZclhKNlRJX0hyQi04Y3BuakZDa0lZIn0.eyJleHAiOjE2NDIzMzI3OTYsImlhdCI6MTY0MjMzMjQ5NiwianRpIjoiOTE3MDM4ZDEtMjE4YS00ZGUzLWJjMjEtNTI0ZWU5YjFlYzFmIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiI5OTlkMjFiNy1jZWNmLTRiNzUtYWU2Ny1iZDVjMjQ0Y2ZkNTAiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.TNPdGgstBT5KMl1zUUFYUdWBWAX1vTqDRLObIX6Hfm6TD1yNq3YIfGvVs8ew9FkCUjHZv2RxDXwap4ZBgU1XWNfgbY7lRnbcXLwKQVYJ_UngYNYkyfIeNM6f6obFgnYgUZWmuKJPNDWSwOXgaOQYUKn2Kwg84g2RElqDZmS17N-Zrmrpfozma14xSG38xXRYv-xLzM1EYvvOzmGuxWAUpVDlg0H-jAo7M5on-TNuilMfy2lmX-fR8QdyJczEmqrtLszHB-gRh60Vzm3zoDrkhMJEU1EZKqYn9jSEl8QuQahpjS-rHQw5sSk-pQAr0VHiulVAKkKycSls-Wms7_8olg, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre/read, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642332796, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.240.10, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=6D3AB6BCE9BC764838201B408F858A5A, http-session-last-accessed-time=1642332504405, kc-category-name=ACCESS, kc-iat=1642332496, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:51732 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:28:24.412  INFO 15 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:28:24.414  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@33afce0e
2022-01-16 11:28:24.414  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@33afce0e
2022-01-16 11:28:24.421  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@33afce0e
2022-01-16 11:28:24.421  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@33afce0e
2022-01-16 11:28:24.477  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@33afce0e
2022-01-16 11:28:24.478  WARN 15 --- [https-jsse-nio-7071-exec-1] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:28:24.478  WARN 15 --- [https-jsse-nio-7071-exec-1] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:28:24.478  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: under-emergency, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@33afce0e
2022-01-16 11:28:24.485  INFO 15 --- [https-jsse-nio-7071-exec-1] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18910955513995954-804404, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:patient-under-active-emergency:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=patient-under-active-emergency, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 3 - Patient under active emergency, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:28:24.485  INFO 15 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=b4620be9-febf-4273-982f-011c48f5660a, content=DENY, timestamp=1642332504485, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:patient-under-active-emergency:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=patient-under-active-emergency, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 3 - Patient under active emergency, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:28:24.485  INFO 15 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=73ms, Total=75ms
2022-01-16 11:28:24.500  INFO 15 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=ffe4787d-4243-4bac-a380-967b75f526ee, content=null, timestamp=1642332504496, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=51734, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=5eea89d14d1a, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=999d21b7-cecf-4b75-ae67-bd5c244cfd50, http-req-server-port=80, http-header-accept=*/*, kc-id=917038d1-218a-4de3-bc21-524ee9b1ec1f, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642332504495, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQCfHNxAH4AEQAAAABh5AFQdAAkOTE3MDM4ZDEtMjE4YS00ZGUzLWJjMjEtNTI0ZWU5YjFlYzFmdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ5OTlkMjFiNy1jZWNmLTRiNzUtYWU2Ny1iZDVjMjQ0Y2ZkNTBwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJKS2NmeHpNR3dHQmVVTmNCczVvZ2tZclhKNlRJX0hyQi04Y3BuakZDa0lZIn0.eyJleHAiOjE2NDIzMzI3OTYsImlhdCI6MTY0MjMzMjQ5NiwianRpIjoiOTE3MDM4ZDEtMjE4YS00ZGUzLWJjMjEtNTI0ZWU5YjFlYzFmIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiI5OTlkMjFiNy1jZWNmLTRiNzUtYWU2Ny1iZDVjMjQ0Y2ZkNTAiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.TNPdGgstBT5KMl1zUUFYUdWBWAX1vTqDRLObIX6Hfm6TD1yNq3YIfGvVs8ew9FkCUjHZv2RxDXwap4ZBgU1XWNfgbY7lRnbcXLwKQVYJ_UngYNYkyfIeNM6f6obFgnYgUZWmuKJPNDWSwOXgaOQYUKn2Kwg84g2RElqDZmS17N-Zrmrpfozma14xSG38xXRYv-xLzM1EYvvOzmGuxWAUpVDlg0H-jAo7M5on-TNuilMfy2lmX-fR8QdyJczEmqrtLszHB-gRh60Vzm3zoDrkhMJEU1EZKqYn9jSEl8QuQahpjS-rHQw5sSk-pQAr0VHiulVAKkKycSls-Wms7_8olg, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre/read, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642332796, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.240.10, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=D52F34741CEADDFCAC6AC939DC8F85A9, http-session-last-accessed-time=1642332504495, kc-category-name=ACCESS, kc-iat=1642332496, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:51734 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:28:24.500  INFO 15 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:28:24.501  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5b1fed85
2022-01-16 11:28:24.502  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5b1fed85
2022-01-16 11:28:24.509  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5b1fed85
2022-01-16 11:28:24.509  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5b1fed85
2022-01-16 11:28:24.558  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5b1fed85
2022-01-16 11:28:24.558  WARN 15 --- [https-jsse-nio-7071-exec-3] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:28:24.559  WARN 15 --- [https-jsse-nio-7071-exec-3] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:28:24.559  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: under-emergency, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5b1fed85
2022-01-16 11:28:24.569  INFO 15 --- [https-jsse-nio-7071-exec-3] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18910955602279644-229859, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:patient-under-active-emergency:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=patient-under-active-emergency, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 3 - Patient under active emergency, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:28:24.570  INFO 15 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=ffe4787d-4243-4bac-a380-967b75f526ee, content=DENY, timestamp=1642332504570, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:patient-under-active-emergency:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=patient-under-active-emergency, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 3 - Patient under active emergency, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:28:24.570  INFO 15 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=69ms, Total=71ms
2022-01-16 11:28:24.589  INFO 15 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=017fbc60-c297-44e3-9803-8dd473303cc8, content=null, timestamp=1642332504583, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=51736, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=5eea89d14d1a, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=999d21b7-cecf-4b75-ae67-bd5c244cfd50, http-req-server-port=80, http-header-accept=*/*, kc-id=917038d1-218a-4de3-bc21-524ee9b1ec1f, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642332504581, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQCfHNxAH4AEQAAAABh5AFQdAAkOTE3MDM4ZDEtMjE4YS00ZGUzLWJjMjEtNTI0ZWU5YjFlYzFmdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ5OTlkMjFiNy1jZWNmLTRiNzUtYWU2Ny1iZDVjMjQ0Y2ZkNTBwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJKS2NmeHpNR3dHQmVVTmNCczVvZ2tZclhKNlRJX0hyQi04Y3BuakZDa0lZIn0.eyJleHAiOjE2NDIzMzI3OTYsImlhdCI6MTY0MjMzMjQ5NiwianRpIjoiOTE3MDM4ZDEtMjE4YS00ZGUzLWJjMjEtNTI0ZWU5YjFlYzFmIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiI5OTlkMjFiNy1jZWNmLTRiNzUtYWU2Ny1iZDVjMjQ0Y2ZkNTAiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.TNPdGgstBT5KMl1zUUFYUdWBWAX1vTqDRLObIX6Hfm6TD1yNq3YIfGvVs8ew9FkCUjHZv2RxDXwap4ZBgU1XWNfgbY7lRnbcXLwKQVYJ_UngYNYkyfIeNM6f6obFgnYgUZWmuKJPNDWSwOXgaOQYUKn2Kwg84g2RElqDZmS17N-Zrmrpfozma14xSG38xXRYv-xLzM1EYvvOzmGuxWAUpVDlg0H-jAo7M5on-TNuilMfy2lmX-fR8QdyJczEmqrtLszHB-gRh60Vzm3zoDrkhMJEU1EZKqYn9jSEl8QuQahpjS-rHQw5sSk-pQAr0VHiulVAKkKycSls-Wms7_8olg, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre/read, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642332796, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.240.10, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=13A1EA17C67FDB1CB8D6612029B9F2D0, http-session-last-accessed-time=1642332504581, kc-category-name=ACCESS, kc-iat=1642332496, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:51736 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:28:24.590  INFO 15 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:28:24.591  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@33749956
2022-01-16 11:28:24.593  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@33749956
2022-01-16 11:28:24.604  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@33749956
2022-01-16 11:28:24.605  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@33749956
2022-01-16 11:28:24.653  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@33749956
2022-01-16 11:28:24.654  WARN 15 --- [https-jsse-nio-7071-exec-2] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:28:24.654  WARN 15 --- [https-jsse-nio-7071-exec-2] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:28:24.655  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: under-emergency, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@33749956
2022-01-16 11:28:24.670  INFO 15 --- [https-jsse-nio-7071-exec-2] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18910955692166996-452504, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:patient-under-active-emergency:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=patient-under-active-emergency, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 3 - Patient under active emergency, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:28:24.671  INFO 15 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=017fbc60-c297-44e3-9803-8dd473303cc8, content=DENY, timestamp=1642332504671, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:patient-under-active-emergency:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=patient-under-active-emergency, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 3 - Patient under active emergency, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:28:24.672  INFO 15 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=80ms, Total=84ms
2022-01-16 11:28:24.693  INFO 15 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=e831ee28-29af-4516-9774-2060b83b6313, content=null, timestamp=1642332504685, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=51738, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=5eea89d14d1a, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=999d21b7-cecf-4b75-ae67-bd5c244cfd50, http-req-server-port=80, http-header-accept=*/*, kc-id=917038d1-218a-4de3-bc21-524ee9b1ec1f, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642332504684, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQCfHNxAH4AEQAAAABh5AFQdAAkOTE3MDM4ZDEtMjE4YS00ZGUzLWJjMjEtNTI0ZWU5YjFlYzFmdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ5OTlkMjFiNy1jZWNmLTRiNzUtYWU2Ny1iZDVjMjQ0Y2ZkNTBwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJKS2NmeHpNR3dHQmVVTmNCczVvZ2tZclhKNlRJX0hyQi04Y3BuakZDa0lZIn0.eyJleHAiOjE2NDIzMzI3OTYsImlhdCI6MTY0MjMzMjQ5NiwianRpIjoiOTE3MDM4ZDEtMjE4YS00ZGUzLWJjMjEtNTI0ZWU5YjFlYzFmIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiI5OTlkMjFiNy1jZWNmLTRiNzUtYWU2Ny1iZDVjMjQ0Y2ZkNTAiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.TNPdGgstBT5KMl1zUUFYUdWBWAX1vTqDRLObIX6Hfm6TD1yNq3YIfGvVs8ew9FkCUjHZv2RxDXwap4ZBgU1XWNfgbY7lRnbcXLwKQVYJ_UngYNYkyfIeNM6f6obFgnYgUZWmuKJPNDWSwOXgaOQYUKn2Kwg84g2RElqDZmS17N-Zrmrpfozma14xSG38xXRYv-xLzM1EYvvOzmGuxWAUpVDlg0H-jAo7M5on-TNuilMfy2lmX-fR8QdyJczEmqrtLszHB-gRh60Vzm3zoDrkhMJEU1EZKqYn9jSEl8QuQahpjS-rHQw5sSk-pQAr0VHiulVAKkKycSls-Wms7_8olg, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre/read, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642332796, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.240.10, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=68950D4A02167BE69B34D466573C3DA9, http-session-last-accessed-time=1642332504684, kc-category-name=ACCESS, kc-iat=1642332496, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:51738 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:28:24.694  INFO 15 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:28:24.695  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@f39cd9
2022-01-16 11:28:24.695  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@f39cd9
2022-01-16 11:28:24.705  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@f39cd9
2022-01-16 11:28:24.705  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@f39cd9
2022-01-16 11:28:24.765  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@f39cd9
2022-01-16 11:28:24.766  WARN 15 --- [https-jsse-nio-7071-exec-4] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:28:24.767  WARN 15 --- [https-jsse-nio-7071-exec-4] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:28:24.767  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: under-emergency, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@f39cd9
2022-01-16 11:28:24.778  INFO 15 --- [https-jsse-nio-7071-exec-4] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18910955795763919-478428, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:patient-under-active-emergency:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=patient-under-active-emergency, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 3 - Patient under active emergency, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:28:24.779  INFO 15 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=e831ee28-29af-4516-9774-2060b83b6313, content=DENY, timestamp=1642332504779, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:patient-under-active-emergency:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=patient-under-active-emergency, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 3 - Patient under active emergency, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:28:24.779  INFO 15 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=85ms, Total=87ms
2022-01-16 11:28:24.798  INFO 15 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=d53b027d-d349-45d6-aa89-6d88c2d0ae60, content=null, timestamp=1642332504794, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=51740, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=5eea89d14d1a, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=999d21b7-cecf-4b75-ae67-bd5c244cfd50, http-req-server-port=80, http-header-accept=*/*, kc-id=917038d1-218a-4de3-bc21-524ee9b1ec1f, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642332504793, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQCfHNxAH4AEQAAAABh5AFQdAAkOTE3MDM4ZDEtMjE4YS00ZGUzLWJjMjEtNTI0ZWU5YjFlYzFmdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ5OTlkMjFiNy1jZWNmLTRiNzUtYWU2Ny1iZDVjMjQ0Y2ZkNTBwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJKS2NmeHpNR3dHQmVVTmNCczVvZ2tZclhKNlRJX0hyQi04Y3BuakZDa0lZIn0.eyJleHAiOjE2NDIzMzI3OTYsImlhdCI6MTY0MjMzMjQ5NiwianRpIjoiOTE3MDM4ZDEtMjE4YS00ZGUzLWJjMjEtNTI0ZWU5YjFlYzFmIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiI5OTlkMjFiNy1jZWNmLTRiNzUtYWU2Ny1iZDVjMjQ0Y2ZkNTAiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.TNPdGgstBT5KMl1zUUFYUdWBWAX1vTqDRLObIX6Hfm6TD1yNq3YIfGvVs8ew9FkCUjHZv2RxDXwap4ZBgU1XWNfgbY7lRnbcXLwKQVYJ_UngYNYkyfIeNM6f6obFgnYgUZWmuKJPNDWSwOXgaOQYUKn2Kwg84g2RElqDZmS17N-Zrmrpfozma14xSG38xXRYv-xLzM1EYvvOzmGuxWAUpVDlg0H-jAo7M5on-TNuilMfy2lmX-fR8QdyJczEmqrtLszHB-gRh60Vzm3zoDrkhMJEU1EZKqYn9jSEl8QuQahpjS-rHQw5sSk-pQAr0VHiulVAKkKycSls-Wms7_8olg, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre/read, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642332796, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.240.10, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=376BF6BF6732413A069B4E467FA3167F, http-session-last-accessed-time=1642332504793, kc-category-name=ACCESS, kc-iat=1642332496, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:51740 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:28:24.799  INFO 15 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:28:24.800  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@70a4a866
2022-01-16 11:28:24.800  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@70a4a866
2022-01-16 11:28:24.810  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@70a4a866
2022-01-16 11:28:24.811  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@70a4a866
2022-01-16 11:28:24.861  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@70a4a866
2022-01-16 11:28:24.862  WARN 15 --- [https-jsse-nio-7071-exec-5] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:28:24.862  WARN 15 --- [https-jsse-nio-7071-exec-5] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:28:24.862  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: under-emergency, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@70a4a866
2022-01-16 11:28:24.872  INFO 15 --- [https-jsse-nio-7071-exec-5] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18910955900910862-339449, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:patient-under-active-emergency:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=patient-under-active-emergency, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 3 - Patient under active emergency, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:28:24.872  INFO 15 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=d53b027d-d349-45d6-aa89-6d88c2d0ae60, content=DENY, timestamp=1642332504872, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:patient-under-active-emergency:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=patient-under-active-emergency, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 3 - Patient under active emergency, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:28:24.873  INFO 15 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=73ms, Total=76ms
2022-01-16 11:28:24.893  INFO 15 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=df99f09a-23b2-4b1a-9d77-d9689addf071, content=null, timestamp=1642332504886, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=51742, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=5eea89d14d1a, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=999d21b7-cecf-4b75-ae67-bd5c244cfd50, http-req-server-port=80, http-header-accept=*/*, kc-id=917038d1-218a-4de3-bc21-524ee9b1ec1f, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642332504884, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQCfHNxAH4AEQAAAABh5AFQdAAkOTE3MDM4ZDEtMjE4YS00ZGUzLWJjMjEtNTI0ZWU5YjFlYzFmdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ5OTlkMjFiNy1jZWNmLTRiNzUtYWU2Ny1iZDVjMjQ0Y2ZkNTBwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJKS2NmeHpNR3dHQmVVTmNCczVvZ2tZclhKNlRJX0hyQi04Y3BuakZDa0lZIn0.eyJleHAiOjE2NDIzMzI3OTYsImlhdCI6MTY0MjMzMjQ5NiwianRpIjoiOTE3MDM4ZDEtMjE4YS00ZGUzLWJjMjEtNTI0ZWU5YjFlYzFmIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiI5OTlkMjFiNy1jZWNmLTRiNzUtYWU2Ny1iZDVjMjQ0Y2ZkNTAiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.TNPdGgstBT5KMl1zUUFYUdWBWAX1vTqDRLObIX6Hfm6TD1yNq3YIfGvVs8ew9FkCUjHZv2RxDXwap4ZBgU1XWNfgbY7lRnbcXLwKQVYJ_UngYNYkyfIeNM6f6obFgnYgUZWmuKJPNDWSwOXgaOQYUKn2Kwg84g2RElqDZmS17N-Zrmrpfozma14xSG38xXRYv-xLzM1EYvvOzmGuxWAUpVDlg0H-jAo7M5on-TNuilMfy2lmX-fR8QdyJczEmqrtLszHB-gRh60Vzm3zoDrkhMJEU1EZKqYn9jSEl8QuQahpjS-rHQw5sSk-pQAr0VHiulVAKkKycSls-Wms7_8olg, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre/read, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642332796, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.240.10, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=E744F178647E054D77E4D4E474CD1BF3, http-session-last-accessed-time=1642332504884, kc-category-name=ACCESS, kc-iat=1642332496, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:51742 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:28:24.894  INFO 15 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:28:24.896  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4c4c74c7
2022-01-16 11:28:24.896  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4c4c74c7
2022-01-16 11:28:24.908  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4c4c74c7
2022-01-16 11:28:24.908  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4c4c74c7
2022-01-16 11:28:24.958  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4c4c74c7
2022-01-16 11:28:24.958  WARN 15 --- [https-jsse-nio-7071-exec-6] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:28:24.958  WARN 15 --- [https-jsse-nio-7071-exec-6] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:28:24.958  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: under-emergency, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4c4c74c7
2022-01-16 11:28:24.973  INFO 15 --- [https-jsse-nio-7071-exec-6] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18910955996294476-401034, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:patient-under-active-emergency:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=patient-under-active-emergency, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 3 - Patient under active emergency, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:28:24.974  INFO 15 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=df99f09a-23b2-4b1a-9d77-d9689addf071, content=DENY, timestamp=1642332504974, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:patient-under-active-emergency:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=patient-under-active-emergency, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 3 - Patient under active emergency, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:28:24.974  INFO 15 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=79ms, Total=83ms
2022-01-16 11:28:24.995  INFO 15 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=b29486c5-a877-4dd4-a49b-b82737903fc4, content=null, timestamp=1642332504987, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=51744, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=5eea89d14d1a, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=999d21b7-cecf-4b75-ae67-bd5c244cfd50, http-req-server-port=80, http-header-accept=*/*, kc-id=917038d1-218a-4de3-bc21-524ee9b1ec1f, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642332504986, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQCfHNxAH4AEQAAAABh5AFQdAAkOTE3MDM4ZDEtMjE4YS00ZGUzLWJjMjEtNTI0ZWU5YjFlYzFmdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ5OTlkMjFiNy1jZWNmLTRiNzUtYWU2Ny1iZDVjMjQ0Y2ZkNTBwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJKS2NmeHpNR3dHQmVVTmNCczVvZ2tZclhKNlRJX0hyQi04Y3BuakZDa0lZIn0.eyJleHAiOjE2NDIzMzI3OTYsImlhdCI6MTY0MjMzMjQ5NiwianRpIjoiOTE3MDM4ZDEtMjE4YS00ZGUzLWJjMjEtNTI0ZWU5YjFlYzFmIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiI5OTlkMjFiNy1jZWNmLTRiNzUtYWU2Ny1iZDVjMjQ0Y2ZkNTAiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.TNPdGgstBT5KMl1zUUFYUdWBWAX1vTqDRLObIX6Hfm6TD1yNq3YIfGvVs8ew9FkCUjHZv2RxDXwap4ZBgU1XWNfgbY7lRnbcXLwKQVYJ_UngYNYkyfIeNM6f6obFgnYgUZWmuKJPNDWSwOXgaOQYUKn2Kwg84g2RElqDZmS17N-Zrmrpfozma14xSG38xXRYv-xLzM1EYvvOzmGuxWAUpVDlg0H-jAo7M5on-TNuilMfy2lmX-fR8QdyJczEmqrtLszHB-gRh60Vzm3zoDrkhMJEU1EZKqYn9jSEl8QuQahpjS-rHQw5sSk-pQAr0VHiulVAKkKycSls-Wms7_8olg, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre/read, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642332796, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.240.10, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=BA6F2A069C2A53ABCC73713C8965D28D, http-session-last-accessed-time=1642332504986, kc-category-name=ACCESS, kc-iat=1642332496, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:51744 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:28:24.995  INFO 15 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:28:24.996  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1bb252bc
2022-01-16 11:28:24.997  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1bb252bc
2022-01-16 11:28:25.006  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1bb252bc
2022-01-16 11:28:25.006  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1bb252bc
2022-01-16 11:28:25.057  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1bb252bc
2022-01-16 11:28:25.057  WARN 15 --- [https-jsse-nio-7071-exec-7] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:28:25.057  WARN 15 --- [https-jsse-nio-7071-exec-7] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:28:25.057  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: under-emergency, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1bb252bc
2022-01-16 11:28:25.069  INFO 15 --- [https-jsse-nio-7071-exec-7] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18910956097352970-53226, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:patient-under-active-emergency:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=patient-under-active-emergency, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 3 - Patient under active emergency, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:28:25.069  INFO 15 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=b29486c5-a877-4dd4-a49b-b82737903fc4, content=DENY, timestamp=1642332505069, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:patient-under-active-emergency:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=patient-under-active-emergency, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 3 - Patient under active emergency, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:28:25.070  INFO 15 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=73ms, Total=76ms
2022-01-16 11:28:25.086  INFO 15 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=4825b1d1-7db4-4f63-823f-0725f75e41a0, content=null, timestamp=1642332505081, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=51746, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=5eea89d14d1a, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=999d21b7-cecf-4b75-ae67-bd5c244cfd50, http-req-server-port=80, http-header-accept=*/*, kc-id=917038d1-218a-4de3-bc21-524ee9b1ec1f, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642332505080, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQCfHNxAH4AEQAAAABh5AFQdAAkOTE3MDM4ZDEtMjE4YS00ZGUzLWJjMjEtNTI0ZWU5YjFlYzFmdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ5OTlkMjFiNy1jZWNmLTRiNzUtYWU2Ny1iZDVjMjQ0Y2ZkNTBwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJKS2NmeHpNR3dHQmVVTmNCczVvZ2tZclhKNlRJX0hyQi04Y3BuakZDa0lZIn0.eyJleHAiOjE2NDIzMzI3OTYsImlhdCI6MTY0MjMzMjQ5NiwianRpIjoiOTE3MDM4ZDEtMjE4YS00ZGUzLWJjMjEtNTI0ZWU5YjFlYzFmIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiI5OTlkMjFiNy1jZWNmLTRiNzUtYWU2Ny1iZDVjMjQ0Y2ZkNTAiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.TNPdGgstBT5KMl1zUUFYUdWBWAX1vTqDRLObIX6Hfm6TD1yNq3YIfGvVs8ew9FkCUjHZv2RxDXwap4ZBgU1XWNfgbY7lRnbcXLwKQVYJ_UngYNYkyfIeNM6f6obFgnYgUZWmuKJPNDWSwOXgaOQYUKn2Kwg84g2RElqDZmS17N-Zrmrpfozma14xSG38xXRYv-xLzM1EYvvOzmGuxWAUpVDlg0H-jAo7M5on-TNuilMfy2lmX-fR8QdyJczEmqrtLszHB-gRh60Vzm3zoDrkhMJEU1EZKqYn9jSEl8QuQahpjS-rHQw5sSk-pQAr0VHiulVAKkKycSls-Wms7_8olg, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre/read, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642332796, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.240.10, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=AD30C047AB416FDAC22A9E4A03A87C4F, http-session-last-accessed-time=1642332505080, kc-category-name=ACCESS, kc-iat=1642332496, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:51746 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:28:25.087  INFO 15 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:28:25.088  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@71c8dd45
2022-01-16 11:28:25.088  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@71c8dd45
2022-01-16 11:28:25.098  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@71c8dd45
2022-01-16 11:28:25.098  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@71c8dd45
2022-01-16 11:28:25.149  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@71c8dd45
2022-01-16 11:28:25.150  WARN 15 --- [https-jsse-nio-7071-exec-8] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:28:25.151  WARN 15 --- [https-jsse-nio-7071-exec-8] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:28:25.151  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: under-emergency, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@71c8dd45
2022-01-16 11:28:25.159  INFO 15 --- [https-jsse-nio-7071-exec-8] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18910956188590050-571692, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:patient-under-active-emergency:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=patient-under-active-emergency, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 3 - Patient under active emergency, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:28:25.159  INFO 15 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=4825b1d1-7db4-4f63-823f-0725f75e41a0, content=DENY, timestamp=1642332505159, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:patient-under-active-emergency:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=patient-under-active-emergency, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 3 - Patient under active emergency, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:28:25.160  INFO 15 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=72ms, Total=75ms
2022-01-16 11:28:25.176  INFO 15 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=a76ef951-c861-4c56-aaf4-d0c3c18c0c08, content=null, timestamp=1642332505171, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=51748, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=5eea89d14d1a, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=999d21b7-cecf-4b75-ae67-bd5c244cfd50, http-req-server-port=80, http-header-accept=*/*, kc-id=917038d1-218a-4de3-bc21-524ee9b1ec1f, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642332505170, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQCfHNxAH4AEQAAAABh5AFQdAAkOTE3MDM4ZDEtMjE4YS00ZGUzLWJjMjEtNTI0ZWU5YjFlYzFmdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ5OTlkMjFiNy1jZWNmLTRiNzUtYWU2Ny1iZDVjMjQ0Y2ZkNTBwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJKS2NmeHpNR3dHQmVVTmNCczVvZ2tZclhKNlRJX0hyQi04Y3BuakZDa0lZIn0.eyJleHAiOjE2NDIzMzI3OTYsImlhdCI6MTY0MjMzMjQ5NiwianRpIjoiOTE3MDM4ZDEtMjE4YS00ZGUzLWJjMjEtNTI0ZWU5YjFlYzFmIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiI5OTlkMjFiNy1jZWNmLTRiNzUtYWU2Ny1iZDVjMjQ0Y2ZkNTAiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.TNPdGgstBT5KMl1zUUFYUdWBWAX1vTqDRLObIX6Hfm6TD1yNq3YIfGvVs8ew9FkCUjHZv2RxDXwap4ZBgU1XWNfgbY7lRnbcXLwKQVYJ_UngYNYkyfIeNM6f6obFgnYgUZWmuKJPNDWSwOXgaOQYUKn2Kwg84g2RElqDZmS17N-Zrmrpfozma14xSG38xXRYv-xLzM1EYvvOzmGuxWAUpVDlg0H-jAo7M5on-TNuilMfy2lmX-fR8QdyJczEmqrtLszHB-gRh60Vzm3zoDrkhMJEU1EZKqYn9jSEl8QuQahpjS-rHQw5sSk-pQAr0VHiulVAKkKycSls-Wms7_8olg, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre/read, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642332796, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.240.10, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=0955BBC7121624C92A6D152F90CA0040, http-session-last-accessed-time=1642332505170, kc-category-name=ACCESS, kc-iat=1642332496, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:51748 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:28:25.176  INFO 15 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:28:25.177  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@67e383ec
2022-01-16 11:28:25.177  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@67e383ec
2022-01-16 11:28:25.187  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@67e383ec
2022-01-16 11:28:25.188  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@67e383ec
2022-01-16 11:28:25.238  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@67e383ec
2022-01-16 11:28:25.238  WARN 15 --- [https-jsse-nio-7071-exec-9] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:28:25.239  WARN 15 --- [https-jsse-nio-7071-exec-9] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:28:25.239  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: under-emergency, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@67e383ec
2022-01-16 11:28:25.253  INFO 15 --- [https-jsse-nio-7071-exec-9] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18910956277960616-226121, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:patient-under-active-emergency:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=patient-under-active-emergency, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 3 - Patient under active emergency, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:28:25.253  INFO 15 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=a76ef951-c861-4c56-aaf4-d0c3c18c0c08, content=DENY, timestamp=1642332505253, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:patient-under-active-emergency:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=patient-under-active-emergency, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 3 - Patient under active emergency, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:28:25.254  INFO 15 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=77ms, Total=79ms
2022-01-16 11:28:25.275  INFO 15 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=74aac9e8-cf33-4761-a96a-cf92827bb488, content=null, timestamp=1642332505267, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=51750, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=5eea89d14d1a, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=999d21b7-cecf-4b75-ae67-bd5c244cfd50, http-req-server-port=80, http-header-accept=*/*, kc-id=917038d1-218a-4de3-bc21-524ee9b1ec1f, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642332505266, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQCfHNxAH4AEQAAAABh5AFQdAAkOTE3MDM4ZDEtMjE4YS00ZGUzLWJjMjEtNTI0ZWU5YjFlYzFmdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ5OTlkMjFiNy1jZWNmLTRiNzUtYWU2Ny1iZDVjMjQ0Y2ZkNTBwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJKS2NmeHpNR3dHQmVVTmNCczVvZ2tZclhKNlRJX0hyQi04Y3BuakZDa0lZIn0.eyJleHAiOjE2NDIzMzI3OTYsImlhdCI6MTY0MjMzMjQ5NiwianRpIjoiOTE3MDM4ZDEtMjE4YS00ZGUzLWJjMjEtNTI0ZWU5YjFlYzFmIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiI5OTlkMjFiNy1jZWNmLTRiNzUtYWU2Ny1iZDVjMjQ0Y2ZkNTAiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.TNPdGgstBT5KMl1zUUFYUdWBWAX1vTqDRLObIX6Hfm6TD1yNq3YIfGvVs8ew9FkCUjHZv2RxDXwap4ZBgU1XWNfgbY7lRnbcXLwKQVYJ_UngYNYkyfIeNM6f6obFgnYgUZWmuKJPNDWSwOXgaOQYUKn2Kwg84g2RElqDZmS17N-Zrmrpfozma14xSG38xXRYv-xLzM1EYvvOzmGuxWAUpVDlg0H-jAo7M5on-TNuilMfy2lmX-fR8QdyJczEmqrtLszHB-gRh60Vzm3zoDrkhMJEU1EZKqYn9jSEl8QuQahpjS-rHQw5sSk-pQAr0VHiulVAKkKycSls-Wms7_8olg, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre/read, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642332796, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.240.10, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=9D344776DAD3EED0F05B933D8E13D3C9, http-session-last-accessed-time=1642332505266, kc-category-name=ACCESS, kc-iat=1642332496, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:51750 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:28:25.276  INFO 15 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:28:25.278  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@62af52ed
2022-01-16 11:28:25.278  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@62af52ed
2022-01-16 11:28:25.289  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@62af52ed
2022-01-16 11:28:25.289  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@62af52ed
2022-01-16 11:28:25.343  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@62af52ed
2022-01-16 11:28:25.344  WARN 15 --- [https-jsse-nio-7071-exec-10] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:28:25.344  WARN 15 --- [https-jsse-nio-7071-exec-10] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:28:25.344  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: under-emergency, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@62af52ed
2022-01-16 11:28:25.354  INFO 15 --- [https-jsse-nio-7071-exec-10] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18910956377561387-17822, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:patient-under-active-emergency:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=patient-under-active-emergency, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 3 - Patient under active emergency, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:28:25.354  INFO 15 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=74aac9e8-cf33-4761-a96a-cf92827bb488, content=DENY, timestamp=1642332505354, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:patient-under-active-emergency:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=patient-under-active-emergency, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 3 - Patient under active emergency, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:28:25.355  INFO 15 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=78ms, Total=81ms
2022-01-16 11:28:25.371  INFO 15 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=ee1a3f4e-2bf2-489f-9d4f-811c19130873, content=null, timestamp=1642332505367, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=51752, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=5eea89d14d1a, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=999d21b7-cecf-4b75-ae67-bd5c244cfd50, http-req-server-port=80, http-header-accept=*/*, kc-id=917038d1-218a-4de3-bc21-524ee9b1ec1f, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642332505366, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQCfHNxAH4AEQAAAABh5AFQdAAkOTE3MDM4ZDEtMjE4YS00ZGUzLWJjMjEtNTI0ZWU5YjFlYzFmdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ5OTlkMjFiNy1jZWNmLTRiNzUtYWU2Ny1iZDVjMjQ0Y2ZkNTBwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJKS2NmeHpNR3dHQmVVTmNCczVvZ2tZclhKNlRJX0hyQi04Y3BuakZDa0lZIn0.eyJleHAiOjE2NDIzMzI3OTYsImlhdCI6MTY0MjMzMjQ5NiwianRpIjoiOTE3MDM4ZDEtMjE4YS00ZGUzLWJjMjEtNTI0ZWU5YjFlYzFmIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiI5OTlkMjFiNy1jZWNmLTRiNzUtYWU2Ny1iZDVjMjQ0Y2ZkNTAiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.TNPdGgstBT5KMl1zUUFYUdWBWAX1vTqDRLObIX6Hfm6TD1yNq3YIfGvVs8ew9FkCUjHZv2RxDXwap4ZBgU1XWNfgbY7lRnbcXLwKQVYJ_UngYNYkyfIeNM6f6obFgnYgUZWmuKJPNDWSwOXgaOQYUKn2Kwg84g2RElqDZmS17N-Zrmrpfozma14xSG38xXRYv-xLzM1EYvvOzmGuxWAUpVDlg0H-jAo7M5on-TNuilMfy2lmX-fR8QdyJczEmqrtLszHB-gRh60Vzm3zoDrkhMJEU1EZKqYn9jSEl8QuQahpjS-rHQw5sSk-pQAr0VHiulVAKkKycSls-Wms7_8olg, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre/read, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642332796, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.240.10, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=3DB9C70DFA18B7C16270629EFECC96C9, http-session-last-accessed-time=1642332505366, kc-category-name=ACCESS, kc-iat=1642332496, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:51752 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:28:25.372  INFO 15 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:28:25.372  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@29a4ee18
2022-01-16 11:28:25.372  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@29a4ee18
2022-01-16 11:28:25.382  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@29a4ee18
2022-01-16 11:28:25.382  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@29a4ee18
2022-01-16 11:28:25.433  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@29a4ee18
2022-01-16 11:28:25.434  WARN 15 --- [https-jsse-nio-7071-exec-1] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:28:25.434  WARN 15 --- [https-jsse-nio-7071-exec-1] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:28:25.434  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: under-emergency, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@29a4ee18
2022-01-16 11:28:25.447  INFO 15 --- [https-jsse-nio-7071-exec-1] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18910956473123181-996489, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:patient-under-active-emergency:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=patient-under-active-emergency, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 3 - Patient under active emergency, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:28:25.447  INFO 15 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=ee1a3f4e-2bf2-489f-9d4f-811c19130873, content=DENY, timestamp=1642332505447, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:patient-under-active-emergency:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=patient-under-active-emergency, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 3 - Patient under active emergency, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:28:25.447  INFO 15 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=75ms, Total=77ms
2022-01-16 11:28:25.466  INFO 15 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=065b1ee3-f944-441b-b1fc-730d1d1543d9, content=null, timestamp=1642332505461, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=51754, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=5eea89d14d1a, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=999d21b7-cecf-4b75-ae67-bd5c244cfd50, http-req-server-port=80, http-header-accept=*/*, kc-id=917038d1-218a-4de3-bc21-524ee9b1ec1f, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642332505460, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQCfHNxAH4AEQAAAABh5AFQdAAkOTE3MDM4ZDEtMjE4YS00ZGUzLWJjMjEtNTI0ZWU5YjFlYzFmdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ5OTlkMjFiNy1jZWNmLTRiNzUtYWU2Ny1iZDVjMjQ0Y2ZkNTBwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJKS2NmeHpNR3dHQmVVTmNCczVvZ2tZclhKNlRJX0hyQi04Y3BuakZDa0lZIn0.eyJleHAiOjE2NDIzMzI3OTYsImlhdCI6MTY0MjMzMjQ5NiwianRpIjoiOTE3MDM4ZDEtMjE4YS00ZGUzLWJjMjEtNTI0ZWU5YjFlYzFmIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiI5OTlkMjFiNy1jZWNmLTRiNzUtYWU2Ny1iZDVjMjQ0Y2ZkNTAiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.TNPdGgstBT5KMl1zUUFYUdWBWAX1vTqDRLObIX6Hfm6TD1yNq3YIfGvVs8ew9FkCUjHZv2RxDXwap4ZBgU1XWNfgbY7lRnbcXLwKQVYJ_UngYNYkyfIeNM6f6obFgnYgUZWmuKJPNDWSwOXgaOQYUKn2Kwg84g2RElqDZmS17N-Zrmrpfozma14xSG38xXRYv-xLzM1EYvvOzmGuxWAUpVDlg0H-jAo7M5on-TNuilMfy2lmX-fR8QdyJczEmqrtLszHB-gRh60Vzm3zoDrkhMJEU1EZKqYn9jSEl8QuQahpjS-rHQw5sSk-pQAr0VHiulVAKkKycSls-Wms7_8olg, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre/read, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642332796, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.240.10, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=279C6FB0C016B0739F3B61951F91AAD1, http-session-last-accessed-time=1642332505460, kc-category-name=ACCESS, kc-iat=1642332496, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:51754 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:28:25.467  INFO 15 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:28:25.467  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5931bd64
2022-01-16 11:28:25.468  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5931bd64
2022-01-16 11:28:25.477  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5931bd64
2022-01-16 11:28:25.477  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5931bd64
2022-01-16 11:28:25.533  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5931bd64
2022-01-16 11:28:25.534  WARN 15 --- [https-jsse-nio-7071-exec-3] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:28:25.534  WARN 15 --- [https-jsse-nio-7071-exec-3] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:28:25.534  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: under-emergency, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5931bd64
2022-01-16 11:28:25.546  INFO 15 --- [https-jsse-nio-7071-exec-3] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18910956568094819-852215, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:patient-under-active-emergency:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=patient-under-active-emergency, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 3 - Patient under active emergency, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:28:25.546  INFO 15 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=065b1ee3-f944-441b-b1fc-730d1d1543d9, content=DENY, timestamp=1642332505546, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:patient-under-active-emergency:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=patient-under-active-emergency, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 3 - Patient under active emergency, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:28:25.546  INFO 15 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=79ms, Total=81ms
2022-01-16 11:28:25.563  INFO 15 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=00f311ac-71b0-49b4-849b-2a9a420c2713, content=null, timestamp=1642332505558, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=51756, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=5eea89d14d1a, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=999d21b7-cecf-4b75-ae67-bd5c244cfd50, http-req-server-port=80, http-header-accept=*/*, kc-id=917038d1-218a-4de3-bc21-524ee9b1ec1f, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642332505557, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQCfHNxAH4AEQAAAABh5AFQdAAkOTE3MDM4ZDEtMjE4YS00ZGUzLWJjMjEtNTI0ZWU5YjFlYzFmdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ5OTlkMjFiNy1jZWNmLTRiNzUtYWU2Ny1iZDVjMjQ0Y2ZkNTBwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJKS2NmeHpNR3dHQmVVTmNCczVvZ2tZclhKNlRJX0hyQi04Y3BuakZDa0lZIn0.eyJleHAiOjE2NDIzMzI3OTYsImlhdCI6MTY0MjMzMjQ5NiwianRpIjoiOTE3MDM4ZDEtMjE4YS00ZGUzLWJjMjEtNTI0ZWU5YjFlYzFmIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiI5OTlkMjFiNy1jZWNmLTRiNzUtYWU2Ny1iZDVjMjQ0Y2ZkNTAiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.TNPdGgstBT5KMl1zUUFYUdWBWAX1vTqDRLObIX6Hfm6TD1yNq3YIfGvVs8ew9FkCUjHZv2RxDXwap4ZBgU1XWNfgbY7lRnbcXLwKQVYJ_UngYNYkyfIeNM6f6obFgnYgUZWmuKJPNDWSwOXgaOQYUKn2Kwg84g2RElqDZmS17N-Zrmrpfozma14xSG38xXRYv-xLzM1EYvvOzmGuxWAUpVDlg0H-jAo7M5on-TNuilMfy2lmX-fR8QdyJczEmqrtLszHB-gRh60Vzm3zoDrkhMJEU1EZKqYn9jSEl8QuQahpjS-rHQw5sSk-pQAr0VHiulVAKkKycSls-Wms7_8olg, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre/read, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642332796, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.240.10, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=EBF8B2DB048BCFB7C06C9205147C8F87, http-session-last-accessed-time=1642332505557, kc-category-name=ACCESS, kc-iat=1642332496, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:51756 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:28:25.563  INFO 15 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:28:25.564  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7e9d3903
2022-01-16 11:28:25.565  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7e9d3903
2022-01-16 11:28:25.574  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7e9d3903
2022-01-16 11:28:25.575  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7e9d3903
2022-01-16 11:28:25.625  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7e9d3903
2022-01-16 11:28:25.625  WARN 15 --- [https-jsse-nio-7071-exec-2] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:28:25.626  WARN 15 --- [https-jsse-nio-7071-exec-2] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:28:25.626  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: under-emergency, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7e9d3903
2022-01-16 11:28:25.634  INFO 15 --- [https-jsse-nio-7071-exec-2] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18910956665260150-73148, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:patient-under-active-emergency:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=patient-under-active-emergency, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 3 - Patient under active emergency, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:28:25.634  INFO 15 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=00f311ac-71b0-49b4-849b-2a9a420c2713, content=DENY, timestamp=1642332505634, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:patient-under-active-emergency:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=patient-under-active-emergency, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 3 - Patient under active emergency, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:28:25.635  INFO 15 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=70ms, Total=73ms
2022-01-16 11:28:25.653  INFO 15 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=8562b2dd-ddd2-4650-80cb-a6cd869ae369, content=null, timestamp=1642332505646, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=51758, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=5eea89d14d1a, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=999d21b7-cecf-4b75-ae67-bd5c244cfd50, http-req-server-port=80, http-header-accept=*/*, kc-id=917038d1-218a-4de3-bc21-524ee9b1ec1f, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642332505644, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQCfHNxAH4AEQAAAABh5AFQdAAkOTE3MDM4ZDEtMjE4YS00ZGUzLWJjMjEtNTI0ZWU5YjFlYzFmdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ5OTlkMjFiNy1jZWNmLTRiNzUtYWU2Ny1iZDVjMjQ0Y2ZkNTBwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJKS2NmeHpNR3dHQmVVTmNCczVvZ2tZclhKNlRJX0hyQi04Y3BuakZDa0lZIn0.eyJleHAiOjE2NDIzMzI3OTYsImlhdCI6MTY0MjMzMjQ5NiwianRpIjoiOTE3MDM4ZDEtMjE4YS00ZGUzLWJjMjEtNTI0ZWU5YjFlYzFmIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiI5OTlkMjFiNy1jZWNmLTRiNzUtYWU2Ny1iZDVjMjQ0Y2ZkNTAiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.TNPdGgstBT5KMl1zUUFYUdWBWAX1vTqDRLObIX6Hfm6TD1yNq3YIfGvVs8ew9FkCUjHZv2RxDXwap4ZBgU1XWNfgbY7lRnbcXLwKQVYJ_UngYNYkyfIeNM6f6obFgnYgUZWmuKJPNDWSwOXgaOQYUKn2Kwg84g2RElqDZmS17N-Zrmrpfozma14xSG38xXRYv-xLzM1EYvvOzmGuxWAUpVDlg0H-jAo7M5on-TNuilMfy2lmX-fR8QdyJczEmqrtLszHB-gRh60Vzm3zoDrkhMJEU1EZKqYn9jSEl8QuQahpjS-rHQw5sSk-pQAr0VHiulVAKkKycSls-Wms7_8olg, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre/read, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642332796, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.240.10, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=15C4E9CAA0AFF3777ED9EA3CDA300DC8, http-session-last-accessed-time=1642332505644, kc-category-name=ACCESS, kc-iat=1642332496, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:51758 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:28:25.653  INFO 15 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:28:25.654  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@13f090ff
2022-01-16 11:28:25.655  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@13f090ff
2022-01-16 11:28:25.668  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@13f090ff
2022-01-16 11:28:25.668  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@13f090ff
2022-01-16 11:28:25.721  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@13f090ff
2022-01-16 11:28:25.721  WARN 15 --- [https-jsse-nio-7071-exec-4] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:28:25.721  WARN 15 --- [https-jsse-nio-7071-exec-4] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:28:25.721  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: under-emergency, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@13f090ff
2022-01-16 11:28:25.733  INFO 15 --- [https-jsse-nio-7071-exec-4] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18910956754375626-27154, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:patient-under-active-emergency:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=patient-under-active-emergency, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 3 - Patient under active emergency, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:28:25.733  INFO 15 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=8562b2dd-ddd2-4650-80cb-a6cd869ae369, content=DENY, timestamp=1642332505733, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:patient-under-active-emergency:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=patient-under-active-emergency, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 3 - Patient under active emergency, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:28:25.733  INFO 15 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=80ms, Total=82ms
2022-01-16 11:28:25.757  INFO 15 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=96f3ddfb-6dca-4bea-b3e0-43a1b67266e3, content=null, timestamp=1642332505744, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=51760, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=5eea89d14d1a, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=999d21b7-cecf-4b75-ae67-bd5c244cfd50, http-req-server-port=80, http-header-accept=*/*, kc-id=917038d1-218a-4de3-bc21-524ee9b1ec1f, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642332505742, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQCfHNxAH4AEQAAAABh5AFQdAAkOTE3MDM4ZDEtMjE4YS00ZGUzLWJjMjEtNTI0ZWU5YjFlYzFmdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ5OTlkMjFiNy1jZWNmLTRiNzUtYWU2Ny1iZDVjMjQ0Y2ZkNTBwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJKS2NmeHpNR3dHQmVVTmNCczVvZ2tZclhKNlRJX0hyQi04Y3BuakZDa0lZIn0.eyJleHAiOjE2NDIzMzI3OTYsImlhdCI6MTY0MjMzMjQ5NiwianRpIjoiOTE3MDM4ZDEtMjE4YS00ZGUzLWJjMjEtNTI0ZWU5YjFlYzFmIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiI5OTlkMjFiNy1jZWNmLTRiNzUtYWU2Ny1iZDVjMjQ0Y2ZkNTAiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.TNPdGgstBT5KMl1zUUFYUdWBWAX1vTqDRLObIX6Hfm6TD1yNq3YIfGvVs8ew9FkCUjHZv2RxDXwap4ZBgU1XWNfgbY7lRnbcXLwKQVYJ_UngYNYkyfIeNM6f6obFgnYgUZWmuKJPNDWSwOXgaOQYUKn2Kwg84g2RElqDZmS17N-Zrmrpfozma14xSG38xXRYv-xLzM1EYvvOzmGuxWAUpVDlg0H-jAo7M5on-TNuilMfy2lmX-fR8QdyJczEmqrtLszHB-gRh60Vzm3zoDrkhMJEU1EZKqYn9jSEl8QuQahpjS-rHQw5sSk-pQAr0VHiulVAKkKycSls-Wms7_8olg, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre/read, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642332796, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.240.10, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=B03D322A532E142262667188EA161B30, http-session-last-accessed-time=1642332505742, kc-category-name=ACCESS, kc-iat=1642332496, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:51760 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:28:25.758  INFO 15 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:28:25.759  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@43c0e4df
2022-01-16 11:28:25.759  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@43c0e4df
2022-01-16 11:28:25.777  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@43c0e4df
2022-01-16 11:28:25.778  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@43c0e4df
2022-01-16 11:28:25.830  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@43c0e4df
2022-01-16 11:28:25.830  WARN 15 --- [https-jsse-nio-7071-exec-5] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:28:25.831  WARN 15 --- [https-jsse-nio-7071-exec-5] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:28:25.831  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: under-emergency, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@43c0e4df
2022-01-16 11:28:25.840  INFO 15 --- [https-jsse-nio-7071-exec-5] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18910956859456112-226861, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:patient-under-active-emergency:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=patient-under-active-emergency, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 3 - Patient under active emergency, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:28:25.841  INFO 15 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=96f3ddfb-6dca-4bea-b3e0-43a1b67266e3, content=DENY, timestamp=1642332505841, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:patient-under-active-emergency:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=patient-under-active-emergency, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 3 - Patient under active emergency, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:28:25.842  INFO 15 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=83ms, Total=93ms
2022-01-16 11:28:25.857  INFO 15 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=7dd6d0e1-d7bf-4a6f-8bc2-d10abad71f29, content=null, timestamp=1642332505853, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=51762, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=5eea89d14d1a, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=999d21b7-cecf-4b75-ae67-bd5c244cfd50, http-req-server-port=80, http-header-accept=*/*, kc-id=917038d1-218a-4de3-bc21-524ee9b1ec1f, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642332505852, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQCfHNxAH4AEQAAAABh5AFQdAAkOTE3MDM4ZDEtMjE4YS00ZGUzLWJjMjEtNTI0ZWU5YjFlYzFmdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ5OTlkMjFiNy1jZWNmLTRiNzUtYWU2Ny1iZDVjMjQ0Y2ZkNTBwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJKS2NmeHpNR3dHQmVVTmNCczVvZ2tZclhKNlRJX0hyQi04Y3BuakZDa0lZIn0.eyJleHAiOjE2NDIzMzI3OTYsImlhdCI6MTY0MjMzMjQ5NiwianRpIjoiOTE3MDM4ZDEtMjE4YS00ZGUzLWJjMjEtNTI0ZWU5YjFlYzFmIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiI5OTlkMjFiNy1jZWNmLTRiNzUtYWU2Ny1iZDVjMjQ0Y2ZkNTAiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.TNPdGgstBT5KMl1zUUFYUdWBWAX1vTqDRLObIX6Hfm6TD1yNq3YIfGvVs8ew9FkCUjHZv2RxDXwap4ZBgU1XWNfgbY7lRnbcXLwKQVYJ_UngYNYkyfIeNM6f6obFgnYgUZWmuKJPNDWSwOXgaOQYUKn2Kwg84g2RElqDZmS17N-Zrmrpfozma14xSG38xXRYv-xLzM1EYvvOzmGuxWAUpVDlg0H-jAo7M5on-TNuilMfy2lmX-fR8QdyJczEmqrtLszHB-gRh60Vzm3zoDrkhMJEU1EZKqYn9jSEl8QuQahpjS-rHQw5sSk-pQAr0VHiulVAKkKycSls-Wms7_8olg, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre/read, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642332796, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.240.10, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=8914389B9ABEBF82C2E5C77B5ABCEDA6, http-session-last-accessed-time=1642332505852, kc-category-name=ACCESS, kc-iat=1642332496, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:51762 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:28:25.857  INFO 15 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:28:25.858  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@78a69f59
2022-01-16 11:28:25.858  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@78a69f59
2022-01-16 11:28:25.866  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@78a69f59
2022-01-16 11:28:25.866  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@78a69f59
2022-01-16 11:28:25.914  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@78a69f59
2022-01-16 11:28:25.914  WARN 15 --- [https-jsse-nio-7071-exec-6] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:28:25.914  WARN 15 --- [https-jsse-nio-7071-exec-6] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:28:25.914  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: under-emergency, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@78a69f59
2022-01-16 11:28:25.930  INFO 15 --- [https-jsse-nio-7071-exec-6] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18910956958453732-854125, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:patient-under-active-emergency:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=patient-under-active-emergency, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 3 - Patient under active emergency, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:28:25.930  INFO 15 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=7dd6d0e1-d7bf-4a6f-8bc2-d10abad71f29, content=DENY, timestamp=1642332505930, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:patient-under-active-emergency:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=patient-under-active-emergency, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 3 - Patient under active emergency, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:28:25.931  INFO 15 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=73ms, Total=75ms
2022-01-16 11:28:25.951  INFO 15 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=c0d53f02-ff85-46df-8da0-ee6a8abac36e, content=null, timestamp=1642332505944, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=51764, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=5eea89d14d1a, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=999d21b7-cecf-4b75-ae67-bd5c244cfd50, http-req-server-port=80, http-header-accept=*/*, kc-id=917038d1-218a-4de3-bc21-524ee9b1ec1f, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642332505942, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQCfHNxAH4AEQAAAABh5AFQdAAkOTE3MDM4ZDEtMjE4YS00ZGUzLWJjMjEtNTI0ZWU5YjFlYzFmdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ5OTlkMjFiNy1jZWNmLTRiNzUtYWU2Ny1iZDVjMjQ0Y2ZkNTBwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJKS2NmeHpNR3dHQmVVTmNCczVvZ2tZclhKNlRJX0hyQi04Y3BuakZDa0lZIn0.eyJleHAiOjE2NDIzMzI3OTYsImlhdCI6MTY0MjMzMjQ5NiwianRpIjoiOTE3MDM4ZDEtMjE4YS00ZGUzLWJjMjEtNTI0ZWU5YjFlYzFmIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiI5OTlkMjFiNy1jZWNmLTRiNzUtYWU2Ny1iZDVjMjQ0Y2ZkNTAiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.TNPdGgstBT5KMl1zUUFYUdWBWAX1vTqDRLObIX6Hfm6TD1yNq3YIfGvVs8ew9FkCUjHZv2RxDXwap4ZBgU1XWNfgbY7lRnbcXLwKQVYJ_UngYNYkyfIeNM6f6obFgnYgUZWmuKJPNDWSwOXgaOQYUKn2Kwg84g2RElqDZmS17N-Zrmrpfozma14xSG38xXRYv-xLzM1EYvvOzmGuxWAUpVDlg0H-jAo7M5on-TNuilMfy2lmX-fR8QdyJczEmqrtLszHB-gRh60Vzm3zoDrkhMJEU1EZKqYn9jSEl8QuQahpjS-rHQw5sSk-pQAr0VHiulVAKkKycSls-Wms7_8olg, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre/read, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642332796, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.240.10, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=C126439BB1D9B191515AE4911DC909E7, http-session-last-accessed-time=1642332505942, kc-category-name=ACCESS, kc-iat=1642332496, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:51764 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:28:25.951  INFO 15 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:28:25.952  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@50dd7137
2022-01-16 11:28:25.953  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@50dd7137
2022-01-16 11:28:25.961  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@50dd7137
2022-01-16 11:28:25.962  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@50dd7137
2022-01-16 11:28:26.017  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@50dd7137
2022-01-16 11:28:26.017  WARN 15 --- [https-jsse-nio-7071-exec-7] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:28:26.017  WARN 15 --- [https-jsse-nio-7071-exec-7] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:28:26.018  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: under-emergency, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@50dd7137
2022-01-16 11:28:26.025  INFO 15 --- [https-jsse-nio-7071-exec-7] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18910957052971868-391379, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:patient-under-active-emergency:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=patient-under-active-emergency, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 3 - Patient under active emergency, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:28:26.026  INFO 15 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=c0d53f02-ff85-46df-8da0-ee6a8abac36e, content=DENY, timestamp=1642332506026, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:patient-under-active-emergency:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=patient-under-active-emergency, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 3 - Patient under active emergency, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:28:26.026  INFO 15 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=75ms, Total=77ms
2022-01-16 11:28:26.043  INFO 15 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=7ea5856a-6fae-4028-a5d2-31ee2cede669, content=null, timestamp=1642332506038, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=51766, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=5eea89d14d1a, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=999d21b7-cecf-4b75-ae67-bd5c244cfd50, http-req-server-port=80, http-header-accept=*/*, kc-id=917038d1-218a-4de3-bc21-524ee9b1ec1f, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642332506037, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQCfHNxAH4AEQAAAABh5AFQdAAkOTE3MDM4ZDEtMjE4YS00ZGUzLWJjMjEtNTI0ZWU5YjFlYzFmdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ5OTlkMjFiNy1jZWNmLTRiNzUtYWU2Ny1iZDVjMjQ0Y2ZkNTBwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJKS2NmeHpNR3dHQmVVTmNCczVvZ2tZclhKNlRJX0hyQi04Y3BuakZDa0lZIn0.eyJleHAiOjE2NDIzMzI3OTYsImlhdCI6MTY0MjMzMjQ5NiwianRpIjoiOTE3MDM4ZDEtMjE4YS00ZGUzLWJjMjEtNTI0ZWU5YjFlYzFmIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiI5OTlkMjFiNy1jZWNmLTRiNzUtYWU2Ny1iZDVjMjQ0Y2ZkNTAiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.TNPdGgstBT5KMl1zUUFYUdWBWAX1vTqDRLObIX6Hfm6TD1yNq3YIfGvVs8ew9FkCUjHZv2RxDXwap4ZBgU1XWNfgbY7lRnbcXLwKQVYJ_UngYNYkyfIeNM6f6obFgnYgUZWmuKJPNDWSwOXgaOQYUKn2Kwg84g2RElqDZmS17N-Zrmrpfozma14xSG38xXRYv-xLzM1EYvvOzmGuxWAUpVDlg0H-jAo7M5on-TNuilMfy2lmX-fR8QdyJczEmqrtLszHB-gRh60Vzm3zoDrkhMJEU1EZKqYn9jSEl8QuQahpjS-rHQw5sSk-pQAr0VHiulVAKkKycSls-Wms7_8olg, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre/read, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642332796, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.240.10, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=DB8689E6C347A0E74C85DFC3EDDBBAC6, http-session-last-accessed-time=1642332506037, kc-category-name=ACCESS, kc-iat=1642332496, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:51766 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:28:26.044  INFO 15 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:28:26.045  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7b56c482
2022-01-16 11:28:26.045  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7b56c482
2022-01-16 11:28:26.054  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7b56c482
2022-01-16 11:28:26.054  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7b56c482
2022-01-16 11:28:26.106  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7b56c482
2022-01-16 11:28:26.106  WARN 15 --- [https-jsse-nio-7071-exec-8] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:28:26.107  WARN 15 --- [https-jsse-nio-7071-exec-8] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:28:26.107  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: under-emergency, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7b56c482
2022-01-16 11:28:26.122  INFO 15 --- [https-jsse-nio-7071-exec-8] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18910957145828656-98555, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:patient-under-active-emergency:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=patient-under-active-emergency, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 3 - Patient under active emergency, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:28:26.123  INFO 15 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=7ea5856a-6fae-4028-a5d2-31ee2cede669, content=DENY, timestamp=1642332506123, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:patient-under-active-emergency:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=patient-under-active-emergency, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 3 - Patient under active emergency, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:28:26.123  INFO 15 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=79ms, Total=81ms
2022-01-16 11:28:26.138  INFO 15 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=4364d575-277c-4bfc-87a9-b8133dffb5bc, content=null, timestamp=1642332506134, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=51768, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=5eea89d14d1a, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=999d21b7-cecf-4b75-ae67-bd5c244cfd50, http-req-server-port=80, http-header-accept=*/*, kc-id=917038d1-218a-4de3-bc21-524ee9b1ec1f, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642332506133, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQCfHNxAH4AEQAAAABh5AFQdAAkOTE3MDM4ZDEtMjE4YS00ZGUzLWJjMjEtNTI0ZWU5YjFlYzFmdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ5OTlkMjFiNy1jZWNmLTRiNzUtYWU2Ny1iZDVjMjQ0Y2ZkNTBwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJKS2NmeHpNR3dHQmVVTmNCczVvZ2tZclhKNlRJX0hyQi04Y3BuakZDa0lZIn0.eyJleHAiOjE2NDIzMzI3OTYsImlhdCI6MTY0MjMzMjQ5NiwianRpIjoiOTE3MDM4ZDEtMjE4YS00ZGUzLWJjMjEtNTI0ZWU5YjFlYzFmIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiI5OTlkMjFiNy1jZWNmLTRiNzUtYWU2Ny1iZDVjMjQ0Y2ZkNTAiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.TNPdGgstBT5KMl1zUUFYUdWBWAX1vTqDRLObIX6Hfm6TD1yNq3YIfGvVs8ew9FkCUjHZv2RxDXwap4ZBgU1XWNfgbY7lRnbcXLwKQVYJ_UngYNYkyfIeNM6f6obFgnYgUZWmuKJPNDWSwOXgaOQYUKn2Kwg84g2RElqDZmS17N-Zrmrpfozma14xSG38xXRYv-xLzM1EYvvOzmGuxWAUpVDlg0H-jAo7M5on-TNuilMfy2lmX-fR8QdyJczEmqrtLszHB-gRh60Vzm3zoDrkhMJEU1EZKqYn9jSEl8QuQahpjS-rHQw5sSk-pQAr0VHiulVAKkKycSls-Wms7_8olg, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre/read, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642332796, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.240.10, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=8B94F0B2C204564DB37C46E963C8DFAA, http-session-last-accessed-time=1642332506133, kc-category-name=ACCESS, kc-iat=1642332496, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:51768 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:28:26.139  INFO 15 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:28:26.139  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@65ca31b0
2022-01-16 11:28:26.139  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@65ca31b0
2022-01-16 11:28:26.147  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@65ca31b0
2022-01-16 11:28:26.148  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@65ca31b0
2022-01-16 11:28:26.197  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@65ca31b0
2022-01-16 11:28:26.198  WARN 15 --- [https-jsse-nio-7071-exec-9] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:28:26.198  WARN 15 --- [https-jsse-nio-7071-exec-9] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:28:26.198  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: under-emergency, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@65ca31b0
2022-01-16 11:28:26.206  INFO 15 --- [https-jsse-nio-7071-exec-9] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18910957240111812-79658, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:patient-under-active-emergency:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=patient-under-active-emergency, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 3 - Patient under active emergency, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:28:26.206  INFO 15 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=4364d575-277c-4bfc-87a9-b8133dffb5bc, content=DENY, timestamp=1642332506206, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:patient-under-active-emergency:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=patient-under-active-emergency, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 3 - Patient under active emergency, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:28:26.206  INFO 15 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=67ms, Total=69ms
2022-01-16 11:28:26.222  INFO 15 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=d0c245c0-5586-4325-bf1a-b5d3a64a84ea, content=null, timestamp=1642332506218, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=51770, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=5eea89d14d1a, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=999d21b7-cecf-4b75-ae67-bd5c244cfd50, http-req-server-port=80, http-header-accept=*/*, kc-id=917038d1-218a-4de3-bc21-524ee9b1ec1f, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642332506217, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQCfHNxAH4AEQAAAABh5AFQdAAkOTE3MDM4ZDEtMjE4YS00ZGUzLWJjMjEtNTI0ZWU5YjFlYzFmdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ5OTlkMjFiNy1jZWNmLTRiNzUtYWU2Ny1iZDVjMjQ0Y2ZkNTBwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJKS2NmeHpNR3dHQmVVTmNCczVvZ2tZclhKNlRJX0hyQi04Y3BuakZDa0lZIn0.eyJleHAiOjE2NDIzMzI3OTYsImlhdCI6MTY0MjMzMjQ5NiwianRpIjoiOTE3MDM4ZDEtMjE4YS00ZGUzLWJjMjEtNTI0ZWU5YjFlYzFmIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiI5OTlkMjFiNy1jZWNmLTRiNzUtYWU2Ny1iZDVjMjQ0Y2ZkNTAiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.TNPdGgstBT5KMl1zUUFYUdWBWAX1vTqDRLObIX6Hfm6TD1yNq3YIfGvVs8ew9FkCUjHZv2RxDXwap4ZBgU1XWNfgbY7lRnbcXLwKQVYJ_UngYNYkyfIeNM6f6obFgnYgUZWmuKJPNDWSwOXgaOQYUKn2Kwg84g2RElqDZmS17N-Zrmrpfozma14xSG38xXRYv-xLzM1EYvvOzmGuxWAUpVDlg0H-jAo7M5on-TNuilMfy2lmX-fR8QdyJczEmqrtLszHB-gRh60Vzm3zoDrkhMJEU1EZKqYn9jSEl8QuQahpjS-rHQw5sSk-pQAr0VHiulVAKkKycSls-Wms7_8olg, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre/read, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642332796, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.240.10, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=96EDFEF96B1C898C0B72C80EAC1596E2, http-session-last-accessed-time=1642332506217, kc-category-name=ACCESS, kc-iat=1642332496, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:51770 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:28:26.223  INFO 15 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:28:26.224  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@35f538ec
2022-01-16 11:28:26.224  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@35f538ec
2022-01-16 11:28:26.233  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@35f538ec
2022-01-16 11:28:26.233  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@35f538ec
2022-01-16 11:28:26.282  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@35f538ec
2022-01-16 11:28:26.282  WARN 15 --- [https-jsse-nio-7071-exec-10] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:28:26.283  WARN 15 --- [https-jsse-nio-7071-exec-10] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:28:26.283  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: under-emergency, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@35f538ec
2022-01-16 11:28:26.296  INFO 15 --- [https-jsse-nio-7071-exec-10] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18910957324402529-616865, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:patient-under-active-emergency:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=patient-under-active-emergency, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 3 - Patient under active emergency, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:28:26.296  INFO 15 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=d0c245c0-5586-4325-bf1a-b5d3a64a84ea, content=DENY, timestamp=1642332506296, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:patient-under-active-emergency:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=patient-under-active-emergency, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 3 - Patient under active emergency, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:28:26.297  INFO 15 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=73ms, Total=76ms
2022-01-16 11:28:26.312  INFO 15 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=b29df692-4608-4864-a86b-6444d1a93b9d, content=null, timestamp=1642332506309, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=51772, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=5eea89d14d1a, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=999d21b7-cecf-4b75-ae67-bd5c244cfd50, http-req-server-port=80, http-header-accept=*/*, kc-id=917038d1-218a-4de3-bc21-524ee9b1ec1f, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642332506307, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQCfHNxAH4AEQAAAABh5AFQdAAkOTE3MDM4ZDEtMjE4YS00ZGUzLWJjMjEtNTI0ZWU5YjFlYzFmdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ5OTlkMjFiNy1jZWNmLTRiNzUtYWU2Ny1iZDVjMjQ0Y2ZkNTBwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJKS2NmeHpNR3dHQmVVTmNCczVvZ2tZclhKNlRJX0hyQi04Y3BuakZDa0lZIn0.eyJleHAiOjE2NDIzMzI3OTYsImlhdCI6MTY0MjMzMjQ5NiwianRpIjoiOTE3MDM4ZDEtMjE4YS00ZGUzLWJjMjEtNTI0ZWU5YjFlYzFmIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiI5OTlkMjFiNy1jZWNmLTRiNzUtYWU2Ny1iZDVjMjQ0Y2ZkNTAiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.TNPdGgstBT5KMl1zUUFYUdWBWAX1vTqDRLObIX6Hfm6TD1yNq3YIfGvVs8ew9FkCUjHZv2RxDXwap4ZBgU1XWNfgbY7lRnbcXLwKQVYJ_UngYNYkyfIeNM6f6obFgnYgUZWmuKJPNDWSwOXgaOQYUKn2Kwg84g2RElqDZmS17N-Zrmrpfozma14xSG38xXRYv-xLzM1EYvvOzmGuxWAUpVDlg0H-jAo7M5on-TNuilMfy2lmX-fR8QdyJczEmqrtLszHB-gRh60Vzm3zoDrkhMJEU1EZKqYn9jSEl8QuQahpjS-rHQw5sSk-pQAr0VHiulVAKkKycSls-Wms7_8olg, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre/read, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642332796, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.240.10, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=567F65B87F9A58334F70E0A12988BEF9, http-session-last-accessed-time=1642332506307, kc-category-name=ACCESS, kc-iat=1642332496, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:51772 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:28:26.313  INFO 15 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:28:26.314  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@78f217be
2022-01-16 11:28:26.314  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@78f217be
2022-01-16 11:28:26.324  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@78f217be
2022-01-16 11:28:26.324  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@78f217be
2022-01-16 11:28:26.377  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@78f217be
2022-01-16 11:28:26.377  WARN 15 --- [https-jsse-nio-7071-exec-1] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:28:26.378  WARN 15 --- [https-jsse-nio-7071-exec-1] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:28:26.378  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: under-emergency, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@78f217be
2022-01-16 11:28:26.385  INFO 15 --- [https-jsse-nio-7071-exec-1] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18910957414886449-385087, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:patient-under-active-emergency:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=patient-under-active-emergency, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 3 - Patient under active emergency, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:28:26.385  INFO 15 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=b29df692-4608-4864-a86b-6444d1a93b9d, content=DENY, timestamp=1642332506385, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:patient-under-active-emergency:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=patient-under-active-emergency, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 3 - Patient under active emergency, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:28:26.386  INFO 15 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=72ms, Total=75ms
2022-01-16 11:28:26.403  INFO 15 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=4cc0ced3-1d9f-4656-b42a-6a56c7b87ab1, content=null, timestamp=1642332506397, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=51774, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=5eea89d14d1a, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=999d21b7-cecf-4b75-ae67-bd5c244cfd50, http-req-server-port=80, http-header-accept=*/*, kc-id=917038d1-218a-4de3-bc21-524ee9b1ec1f, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642332506396, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQCfHNxAH4AEQAAAABh5AFQdAAkOTE3MDM4ZDEtMjE4YS00ZGUzLWJjMjEtNTI0ZWU5YjFlYzFmdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ5OTlkMjFiNy1jZWNmLTRiNzUtYWU2Ny1iZDVjMjQ0Y2ZkNTBwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJKS2NmeHpNR3dHQmVVTmNCczVvZ2tZclhKNlRJX0hyQi04Y3BuakZDa0lZIn0.eyJleHAiOjE2NDIzMzI3OTYsImlhdCI6MTY0MjMzMjQ5NiwianRpIjoiOTE3MDM4ZDEtMjE4YS00ZGUzLWJjMjEtNTI0ZWU5YjFlYzFmIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiI5OTlkMjFiNy1jZWNmLTRiNzUtYWU2Ny1iZDVjMjQ0Y2ZkNTAiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.TNPdGgstBT5KMl1zUUFYUdWBWAX1vTqDRLObIX6Hfm6TD1yNq3YIfGvVs8ew9FkCUjHZv2RxDXwap4ZBgU1XWNfgbY7lRnbcXLwKQVYJ_UngYNYkyfIeNM6f6obFgnYgUZWmuKJPNDWSwOXgaOQYUKn2Kwg84g2RElqDZmS17N-Zrmrpfozma14xSG38xXRYv-xLzM1EYvvOzmGuxWAUpVDlg0H-jAo7M5on-TNuilMfy2lmX-fR8QdyJczEmqrtLszHB-gRh60Vzm3zoDrkhMJEU1EZKqYn9jSEl8QuQahpjS-rHQw5sSk-pQAr0VHiulVAKkKycSls-Wms7_8olg, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre/read, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642332796, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.240.10, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=1B701D2229A6CB674A0899E6C527954E, http-session-last-accessed-time=1642332506396, kc-category-name=ACCESS, kc-iat=1642332496, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:51774 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:28:26.403  INFO 15 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:28:26.404  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@51c1e324
2022-01-16 11:28:26.404  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@51c1e324
2022-01-16 11:28:26.413  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@51c1e324
2022-01-16 11:28:26.413  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@51c1e324
2022-01-16 11:28:26.461  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@51c1e324
2022-01-16 11:28:26.461  WARN 15 --- [https-jsse-nio-7071-exec-3] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:28:26.461  WARN 15 --- [https-jsse-nio-7071-exec-3] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:28:26.461  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: under-emergency, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@51c1e324
2022-01-16 11:28:26.473  INFO 15 --- [https-jsse-nio-7071-exec-3] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18910957505218888-130191, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:patient-under-active-emergency:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=patient-under-active-emergency, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 3 - Patient under active emergency, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:28:26.473  INFO 15 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=4cc0ced3-1d9f-4656-b42a-6a56c7b87ab1, content=DENY, timestamp=1642332506473, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:patient-under-active-emergency:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=patient-under-active-emergency, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 3 - Patient under active emergency, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:28:26.473  INFO 15 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=69ms, Total=72ms
2022-01-16 11:28:26.499  INFO 15 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=03cdd2bd-ac9b-40c7-a927-df91ade1a2ce, content=null, timestamp=1642332506493, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=51776, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=5eea89d14d1a, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=999d21b7-cecf-4b75-ae67-bd5c244cfd50, http-req-server-port=80, http-header-accept=*/*, kc-id=917038d1-218a-4de3-bc21-524ee9b1ec1f, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642332506492, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQCfHNxAH4AEQAAAABh5AFQdAAkOTE3MDM4ZDEtMjE4YS00ZGUzLWJjMjEtNTI0ZWU5YjFlYzFmdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ5OTlkMjFiNy1jZWNmLTRiNzUtYWU2Ny1iZDVjMjQ0Y2ZkNTBwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJKS2NmeHpNR3dHQmVVTmNCczVvZ2tZclhKNlRJX0hyQi04Y3BuakZDa0lZIn0.eyJleHAiOjE2NDIzMzI3OTYsImlhdCI6MTY0MjMzMjQ5NiwianRpIjoiOTE3MDM4ZDEtMjE4YS00ZGUzLWJjMjEtNTI0ZWU5YjFlYzFmIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiI5OTlkMjFiNy1jZWNmLTRiNzUtYWU2Ny1iZDVjMjQ0Y2ZkNTAiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.TNPdGgstBT5KMl1zUUFYUdWBWAX1vTqDRLObIX6Hfm6TD1yNq3YIfGvVs8ew9FkCUjHZv2RxDXwap4ZBgU1XWNfgbY7lRnbcXLwKQVYJ_UngYNYkyfIeNM6f6obFgnYgUZWmuKJPNDWSwOXgaOQYUKn2Kwg84g2RElqDZmS17N-Zrmrpfozma14xSG38xXRYv-xLzM1EYvvOzmGuxWAUpVDlg0H-jAo7M5on-TNuilMfy2lmX-fR8QdyJczEmqrtLszHB-gRh60Vzm3zoDrkhMJEU1EZKqYn9jSEl8QuQahpjS-rHQw5sSk-pQAr0VHiulVAKkKycSls-Wms7_8olg, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre/read, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642332796, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.240.10, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=CF296B6B5BDE1B5929469CD2211CFE73, http-session-last-accessed-time=1642332506492, kc-category-name=ACCESS, kc-iat=1642332496, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:51776 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:28:26.499  INFO 15 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:28:26.500  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@311187c4
2022-01-16 11:28:26.501  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@311187c4
2022-01-16 11:28:26.510  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@311187c4
2022-01-16 11:28:26.511  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@311187c4
2022-01-16 11:28:26.561  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@311187c4
2022-01-16 11:28:26.561  WARN 15 --- [https-jsse-nio-7071-exec-2] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:28:26.561  WARN 15 --- [https-jsse-nio-7071-exec-2] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:28:26.561  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: under-emergency, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@311187c4
2022-01-16 11:28:26.581  INFO 15 --- [https-jsse-nio-7071-exec-2] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18910957600994767-84440, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:patient-under-active-emergency:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=patient-under-active-emergency, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 3 - Patient under active emergency, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:28:26.581  INFO 15 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=03cdd2bd-ac9b-40c7-a927-df91ade1a2ce, content=DENY, timestamp=1642332506581, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:patient-under-active-emergency:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=patient-under-active-emergency, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 3 - Patient under active emergency, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:28:26.581  INFO 15 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=81ms, Total=84ms
2022-01-16 11:28:26.598  INFO 15 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=23fff87a-87d5-4499-9045-6d994c72f9c9, content=null, timestamp=1642332506590, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=51778, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=5eea89d14d1a, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=999d21b7-cecf-4b75-ae67-bd5c244cfd50, http-req-server-port=80, http-header-accept=*/*, kc-id=917038d1-218a-4de3-bc21-524ee9b1ec1f, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642332506590, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQCfHNxAH4AEQAAAABh5AFQdAAkOTE3MDM4ZDEtMjE4YS00ZGUzLWJjMjEtNTI0ZWU5YjFlYzFmdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ5OTlkMjFiNy1jZWNmLTRiNzUtYWU2Ny1iZDVjMjQ0Y2ZkNTBwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJKS2NmeHpNR3dHQmVVTmNCczVvZ2tZclhKNlRJX0hyQi04Y3BuakZDa0lZIn0.eyJleHAiOjE2NDIzMzI3OTYsImlhdCI6MTY0MjMzMjQ5NiwianRpIjoiOTE3MDM4ZDEtMjE4YS00ZGUzLWJjMjEtNTI0ZWU5YjFlYzFmIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiI5OTlkMjFiNy1jZWNmLTRiNzUtYWU2Ny1iZDVjMjQ0Y2ZkNTAiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.TNPdGgstBT5KMl1zUUFYUdWBWAX1vTqDRLObIX6Hfm6TD1yNq3YIfGvVs8ew9FkCUjHZv2RxDXwap4ZBgU1XWNfgbY7lRnbcXLwKQVYJ_UngYNYkyfIeNM6f6obFgnYgUZWmuKJPNDWSwOXgaOQYUKn2Kwg84g2RElqDZmS17N-Zrmrpfozma14xSG38xXRYv-xLzM1EYvvOzmGuxWAUpVDlg0H-jAo7M5on-TNuilMfy2lmX-fR8QdyJczEmqrtLszHB-gRh60Vzm3zoDrkhMJEU1EZKqYn9jSEl8QuQahpjS-rHQw5sSk-pQAr0VHiulVAKkKycSls-Wms7_8olg, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre/read, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642332796, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.240.10, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=9F623ADA42FE3EFE345F50195D5CF7E9, http-session-last-accessed-time=1642332506590, kc-category-name=ACCESS, kc-iat=1642332496, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:51778 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:28:26.601  INFO 15 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:28:26.602  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2f1190f7
2022-01-16 11:28:26.605  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2f1190f7
2022-01-16 11:28:26.612  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2f1190f7
2022-01-16 11:28:26.612  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2f1190f7
2022-01-16 11:28:26.661  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2f1190f7
2022-01-16 11:28:26.662  WARN 15 --- [https-jsse-nio-7071-exec-4] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:28:26.662  WARN 15 --- [https-jsse-nio-7071-exec-4] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:28:26.662  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: under-emergency, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2f1190f7
2022-01-16 11:28:26.669  INFO 15 --- [https-jsse-nio-7071-exec-4] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18910957702521292-693754, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:patient-under-active-emergency:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=patient-under-active-emergency, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 3 - Patient under active emergency, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:28:26.670  INFO 15 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=23fff87a-87d5-4499-9045-6d994c72f9c9, content=DENY, timestamp=1642332506670, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:patient-under-active-emergency:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=patient-under-active-emergency, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 3 - Patient under active emergency, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:28:26.671  INFO 15 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=69ms, Total=74ms
2022-01-16 11:28:26.689  INFO 15 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=efbc58a1-2fe4-4121-a151-f21adc63a315, content=null, timestamp=1642332506684, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=51780, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=5eea89d14d1a, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=999d21b7-cecf-4b75-ae67-bd5c244cfd50, http-req-server-port=80, http-header-accept=*/*, kc-id=917038d1-218a-4de3-bc21-524ee9b1ec1f, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642332506682, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQCfHNxAH4AEQAAAABh5AFQdAAkOTE3MDM4ZDEtMjE4YS00ZGUzLWJjMjEtNTI0ZWU5YjFlYzFmdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ5OTlkMjFiNy1jZWNmLTRiNzUtYWU2Ny1iZDVjMjQ0Y2ZkNTBwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJKS2NmeHpNR3dHQmVVTmNCczVvZ2tZclhKNlRJX0hyQi04Y3BuakZDa0lZIn0.eyJleHAiOjE2NDIzMzI3OTYsImlhdCI6MTY0MjMzMjQ5NiwianRpIjoiOTE3MDM4ZDEtMjE4YS00ZGUzLWJjMjEtNTI0ZWU5YjFlYzFmIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiI5OTlkMjFiNy1jZWNmLTRiNzUtYWU2Ny1iZDVjMjQ0Y2ZkNTAiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.TNPdGgstBT5KMl1zUUFYUdWBWAX1vTqDRLObIX6Hfm6TD1yNq3YIfGvVs8ew9FkCUjHZv2RxDXwap4ZBgU1XWNfgbY7lRnbcXLwKQVYJ_UngYNYkyfIeNM6f6obFgnYgUZWmuKJPNDWSwOXgaOQYUKn2Kwg84g2RElqDZmS17N-Zrmrpfozma14xSG38xXRYv-xLzM1EYvvOzmGuxWAUpVDlg0H-jAo7M5on-TNuilMfy2lmX-fR8QdyJczEmqrtLszHB-gRh60Vzm3zoDrkhMJEU1EZKqYn9jSEl8QuQahpjS-rHQw5sSk-pQAr0VHiulVAKkKycSls-Wms7_8olg, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre/read, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642332796, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.240.10, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=AAD871B889877352CD9B0197D46BE9EE, http-session-last-accessed-time=1642332506682, kc-category-name=ACCESS, kc-iat=1642332496, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:51780 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:28:26.690  INFO 15 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:28:26.691  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@197ac1e2
2022-01-16 11:28:26.691  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@197ac1e2
2022-01-16 11:28:26.698  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@197ac1e2
2022-01-16 11:28:26.698  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@197ac1e2
2022-01-16 11:28:26.750  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@197ac1e2
2022-01-16 11:28:26.750  WARN 15 --- [https-jsse-nio-7071-exec-5] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:28:26.751  WARN 15 --- [https-jsse-nio-7071-exec-5] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:28:26.751  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: under-emergency, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@197ac1e2
2022-01-16 11:28:26.760  INFO 15 --- [https-jsse-nio-7071-exec-5] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18910957791357674-946074, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:patient-under-active-emergency:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=patient-under-active-emergency, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 3 - Patient under active emergency, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:28:26.760  INFO 15 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=efbc58a1-2fe4-4121-a151-f21adc63a315, content=DENY, timestamp=1642332506760, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:patient-under-active-emergency:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=patient-under-active-emergency, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 3 - Patient under active emergency, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:28:26.761  INFO 15 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=70ms, Total=73ms
2022-01-16 11:28:26.776  INFO 15 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=81af35f1-4f3c-4483-816d-6b8725ebbb4b, content=null, timestamp=1642332506771, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=51782, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=5eea89d14d1a, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=999d21b7-cecf-4b75-ae67-bd5c244cfd50, http-req-server-port=80, http-header-accept=*/*, kc-id=917038d1-218a-4de3-bc21-524ee9b1ec1f, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642332506769, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQCfHNxAH4AEQAAAABh5AFQdAAkOTE3MDM4ZDEtMjE4YS00ZGUzLWJjMjEtNTI0ZWU5YjFlYzFmdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ5OTlkMjFiNy1jZWNmLTRiNzUtYWU2Ny1iZDVjMjQ0Y2ZkNTBwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJKS2NmeHpNR3dHQmVVTmNCczVvZ2tZclhKNlRJX0hyQi04Y3BuakZDa0lZIn0.eyJleHAiOjE2NDIzMzI3OTYsImlhdCI6MTY0MjMzMjQ5NiwianRpIjoiOTE3MDM4ZDEtMjE4YS00ZGUzLWJjMjEtNTI0ZWU5YjFlYzFmIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiI5OTlkMjFiNy1jZWNmLTRiNzUtYWU2Ny1iZDVjMjQ0Y2ZkNTAiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.TNPdGgstBT5KMl1zUUFYUdWBWAX1vTqDRLObIX6Hfm6TD1yNq3YIfGvVs8ew9FkCUjHZv2RxDXwap4ZBgU1XWNfgbY7lRnbcXLwKQVYJ_UngYNYkyfIeNM6f6obFgnYgUZWmuKJPNDWSwOXgaOQYUKn2Kwg84g2RElqDZmS17N-Zrmrpfozma14xSG38xXRYv-xLzM1EYvvOzmGuxWAUpVDlg0H-jAo7M5on-TNuilMfy2lmX-fR8QdyJczEmqrtLszHB-gRh60Vzm3zoDrkhMJEU1EZKqYn9jSEl8QuQahpjS-rHQw5sSk-pQAr0VHiulVAKkKycSls-Wms7_8olg, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre/read, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642332796, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.240.10, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=1623F465B4DAF2FF048CB198D0342016, http-session-last-accessed-time=1642332506769, kc-category-name=ACCESS, kc-iat=1642332496, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:51782 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:28:26.776  INFO 15 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:28:26.777  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@556a4cb4
2022-01-16 11:28:26.778  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@556a4cb4
2022-01-16 11:28:26.790  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@556a4cb4
2022-01-16 11:28:26.790  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@556a4cb4
2022-01-16 11:28:26.842  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@556a4cb4
2022-01-16 11:28:26.843  WARN 15 --- [https-jsse-nio-7071-exec-6] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:28:26.843  WARN 15 --- [https-jsse-nio-7071-exec-6] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:28:26.844  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: under-emergency, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@556a4cb4
2022-01-16 11:28:26.855  INFO 15 --- [https-jsse-nio-7071-exec-6] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18910957878103140-231625, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:patient-under-active-emergency:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=patient-under-active-emergency, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 3 - Patient under active emergency, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:28:26.856  INFO 15 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=81af35f1-4f3c-4483-816d-6b8725ebbb4b, content=DENY, timestamp=1642332506856, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:patient-under-active-emergency:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=patient-under-active-emergency, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 3 - Patient under active emergency, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:28:26.856  INFO 15 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=79ms, Total=81ms
2022-01-16 11:28:26.876  INFO 15 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=61cdd636-b5a7-4a1a-8cb1-b35ac1262dfc, content=null, timestamp=1642332506872, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=51784, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=5eea89d14d1a, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=999d21b7-cecf-4b75-ae67-bd5c244cfd50, http-req-server-port=80, http-header-accept=*/*, kc-id=917038d1-218a-4de3-bc21-524ee9b1ec1f, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642332506870, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQCfHNxAH4AEQAAAABh5AFQdAAkOTE3MDM4ZDEtMjE4YS00ZGUzLWJjMjEtNTI0ZWU5YjFlYzFmdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ5OTlkMjFiNy1jZWNmLTRiNzUtYWU2Ny1iZDVjMjQ0Y2ZkNTBwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJKS2NmeHpNR3dHQmVVTmNCczVvZ2tZclhKNlRJX0hyQi04Y3BuakZDa0lZIn0.eyJleHAiOjE2NDIzMzI3OTYsImlhdCI6MTY0MjMzMjQ5NiwianRpIjoiOTE3MDM4ZDEtMjE4YS00ZGUzLWJjMjEtNTI0ZWU5YjFlYzFmIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiI5OTlkMjFiNy1jZWNmLTRiNzUtYWU2Ny1iZDVjMjQ0Y2ZkNTAiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.TNPdGgstBT5KMl1zUUFYUdWBWAX1vTqDRLObIX6Hfm6TD1yNq3YIfGvVs8ew9FkCUjHZv2RxDXwap4ZBgU1XWNfgbY7lRnbcXLwKQVYJ_UngYNYkyfIeNM6f6obFgnYgUZWmuKJPNDWSwOXgaOQYUKn2Kwg84g2RElqDZmS17N-Zrmrpfozma14xSG38xXRYv-xLzM1EYvvOzmGuxWAUpVDlg0H-jAo7M5on-TNuilMfy2lmX-fR8QdyJczEmqrtLszHB-gRh60Vzm3zoDrkhMJEU1EZKqYn9jSEl8QuQahpjS-rHQw5sSk-pQAr0VHiulVAKkKycSls-Wms7_8olg, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre/read, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642332796, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.240.10, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=011186D3DD65BBC6470BFF657554BE7F, http-session-last-accessed-time=1642332506870, kc-category-name=ACCESS, kc-iat=1642332496, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:51784 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:28:26.877  INFO 15 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:28:26.877  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4d8646c9
2022-01-16 11:28:26.877  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4d8646c9
2022-01-16 11:28:26.886  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4d8646c9
2022-01-16 11:28:26.886  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4d8646c9
2022-01-16 11:28:26.933  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4d8646c9
2022-01-16 11:28:26.933  WARN 15 --- [https-jsse-nio-7071-exec-7] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:28:26.933  WARN 15 --- [https-jsse-nio-7071-exec-7] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:28:26.934  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: under-emergency, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4d8646c9
2022-01-16 11:28:26.946  INFO 15 --- [https-jsse-nio-7071-exec-7] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18910957978092295-196432, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:patient-under-active-emergency:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=patient-under-active-emergency, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 3 - Patient under active emergency, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:28:26.946  INFO 15 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=61cdd636-b5a7-4a1a-8cb1-b35ac1262dfc, content=DENY, timestamp=1642332506946, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:patient-under-active-emergency:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=patient-under-active-emergency, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 3 - Patient under active emergency, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:28:26.947  INFO 15 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=69ms, Total=72ms
2022-01-16 11:28:26.962  INFO 15 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=392009ec-f52d-42d2-9a60-ef64d8d9aa86, content=null, timestamp=1642332506958, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=51786, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=5eea89d14d1a, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=999d21b7-cecf-4b75-ae67-bd5c244cfd50, http-req-server-port=80, http-header-accept=*/*, kc-id=917038d1-218a-4de3-bc21-524ee9b1ec1f, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642332506957, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQCfHNxAH4AEQAAAABh5AFQdAAkOTE3MDM4ZDEtMjE4YS00ZGUzLWJjMjEtNTI0ZWU5YjFlYzFmdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ5OTlkMjFiNy1jZWNmLTRiNzUtYWU2Ny1iZDVjMjQ0Y2ZkNTBwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJKS2NmeHpNR3dHQmVVTmNCczVvZ2tZclhKNlRJX0hyQi04Y3BuakZDa0lZIn0.eyJleHAiOjE2NDIzMzI3OTYsImlhdCI6MTY0MjMzMjQ5NiwianRpIjoiOTE3MDM4ZDEtMjE4YS00ZGUzLWJjMjEtNTI0ZWU5YjFlYzFmIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiI5OTlkMjFiNy1jZWNmLTRiNzUtYWU2Ny1iZDVjMjQ0Y2ZkNTAiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.TNPdGgstBT5KMl1zUUFYUdWBWAX1vTqDRLObIX6Hfm6TD1yNq3YIfGvVs8ew9FkCUjHZv2RxDXwap4ZBgU1XWNfgbY7lRnbcXLwKQVYJ_UngYNYkyfIeNM6f6obFgnYgUZWmuKJPNDWSwOXgaOQYUKn2Kwg84g2RElqDZmS17N-Zrmrpfozma14xSG38xXRYv-xLzM1EYvvOzmGuxWAUpVDlg0H-jAo7M5on-TNuilMfy2lmX-fR8QdyJczEmqrtLszHB-gRh60Vzm3zoDrkhMJEU1EZKqYn9jSEl8QuQahpjS-rHQw5sSk-pQAr0VHiulVAKkKycSls-Wms7_8olg, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre/read, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642332796, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.240.10, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=54AFB720DBDC630C64C5430AFE6A1A13, http-session-last-accessed-time=1642332506957, kc-category-name=ACCESS, kc-iat=1642332496, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:51786 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:28:26.963  INFO 15 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:28:26.964  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@372002a1
2022-01-16 11:28:26.965  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@372002a1
2022-01-16 11:28:26.979  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@372002a1
2022-01-16 11:28:26.979  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@372002a1
2022-01-16 11:28:27.030  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@372002a1
2022-01-16 11:28:27.030  WARN 15 --- [https-jsse-nio-7071-exec-8] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:28:27.031  WARN 15 --- [https-jsse-nio-7071-exec-8] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:28:27.031  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: under-emergency, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@372002a1
2022-01-16 11:28:27.040  INFO 15 --- [https-jsse-nio-7071-exec-8] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18910958064908194-563173, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:patient-under-active-emergency:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=patient-under-active-emergency, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 3 - Patient under active emergency, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:28:27.041  INFO 15 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=392009ec-f52d-42d2-9a60-ef64d8d9aa86, content=DENY, timestamp=1642332507041, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:patient-under-active-emergency:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=patient-under-active-emergency, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 3 - Patient under active emergency, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:28:27.042  INFO 15 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=78ms, Total=81ms
2022-01-16 11:28:27.058  INFO 15 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=b2562634-882b-4bf5-a240-4ae593cb02c5, content=null, timestamp=1642332507052, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=51788, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=5eea89d14d1a, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=999d21b7-cecf-4b75-ae67-bd5c244cfd50, http-req-server-port=80, http-header-accept=*/*, kc-id=917038d1-218a-4de3-bc21-524ee9b1ec1f, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642332507051, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQCfHNxAH4AEQAAAABh5AFQdAAkOTE3MDM4ZDEtMjE4YS00ZGUzLWJjMjEtNTI0ZWU5YjFlYzFmdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ5OTlkMjFiNy1jZWNmLTRiNzUtYWU2Ny1iZDVjMjQ0Y2ZkNTBwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJKS2NmeHpNR3dHQmVVTmNCczVvZ2tZclhKNlRJX0hyQi04Y3BuakZDa0lZIn0.eyJleHAiOjE2NDIzMzI3OTYsImlhdCI6MTY0MjMzMjQ5NiwianRpIjoiOTE3MDM4ZDEtMjE4YS00ZGUzLWJjMjEtNTI0ZWU5YjFlYzFmIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiI5OTlkMjFiNy1jZWNmLTRiNzUtYWU2Ny1iZDVjMjQ0Y2ZkNTAiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.TNPdGgstBT5KMl1zUUFYUdWBWAX1vTqDRLObIX6Hfm6TD1yNq3YIfGvVs8ew9FkCUjHZv2RxDXwap4ZBgU1XWNfgbY7lRnbcXLwKQVYJ_UngYNYkyfIeNM6f6obFgnYgUZWmuKJPNDWSwOXgaOQYUKn2Kwg84g2RElqDZmS17N-Zrmrpfozma14xSG38xXRYv-xLzM1EYvvOzmGuxWAUpVDlg0H-jAo7M5on-TNuilMfy2lmX-fR8QdyJczEmqrtLszHB-gRh60Vzm3zoDrkhMJEU1EZKqYn9jSEl8QuQahpjS-rHQw5sSk-pQAr0VHiulVAKkKycSls-Wms7_8olg, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre/read, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642332796, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.240.10, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=B955D9E0D914139CEA03E176BE9B28C4, http-session-last-accessed-time=1642332507051, kc-category-name=ACCESS, kc-iat=1642332496, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:51788 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:28:27.059  INFO 15 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:28:27.060  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3867e303
2022-01-16 11:28:27.060  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3867e303
2022-01-16 11:28:27.069  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3867e303
2022-01-16 11:28:27.070  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3867e303
2022-01-16 11:28:27.117  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3867e303
2022-01-16 11:28:27.117  WARN 15 --- [https-jsse-nio-7071-exec-9] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:28:27.117  WARN 15 --- [https-jsse-nio-7071-exec-9] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:28:27.117  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: under-emergency, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3867e303
2022-01-16 11:28:27.130  INFO 15 --- [https-jsse-nio-7071-exec-9] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18910958160427763-648713, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:patient-under-active-emergency:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=patient-under-active-emergency, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 3 - Patient under active emergency, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:28:27.130  INFO 15 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=b2562634-882b-4bf5-a240-4ae593cb02c5, content=DENY, timestamp=1642332507130, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:patient-under-active-emergency:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=patient-under-active-emergency, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 3 - Patient under active emergency, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:28:27.131  INFO 15 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=71ms, Total=75ms
2022-01-16 11:28:27.150  INFO 15 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=df739836-81a6-4704-83de-df114a0faacd, content=null, timestamp=1642332507145, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=51790, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=5eea89d14d1a, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=999d21b7-cecf-4b75-ae67-bd5c244cfd50, http-req-server-port=80, http-header-accept=*/*, kc-id=917038d1-218a-4de3-bc21-524ee9b1ec1f, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642332507140, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQCfHNxAH4AEQAAAABh5AFQdAAkOTE3MDM4ZDEtMjE4YS00ZGUzLWJjMjEtNTI0ZWU5YjFlYzFmdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ5OTlkMjFiNy1jZWNmLTRiNzUtYWU2Ny1iZDVjMjQ0Y2ZkNTBwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJKS2NmeHpNR3dHQmVVTmNCczVvZ2tZclhKNlRJX0hyQi04Y3BuakZDa0lZIn0.eyJleHAiOjE2NDIzMzI3OTYsImlhdCI6MTY0MjMzMjQ5NiwianRpIjoiOTE3MDM4ZDEtMjE4YS00ZGUzLWJjMjEtNTI0ZWU5YjFlYzFmIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiI5OTlkMjFiNy1jZWNmLTRiNzUtYWU2Ny1iZDVjMjQ0Y2ZkNTAiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.TNPdGgstBT5KMl1zUUFYUdWBWAX1vTqDRLObIX6Hfm6TD1yNq3YIfGvVs8ew9FkCUjHZv2RxDXwap4ZBgU1XWNfgbY7lRnbcXLwKQVYJ_UngYNYkyfIeNM6f6obFgnYgUZWmuKJPNDWSwOXgaOQYUKn2Kwg84g2RElqDZmS17N-Zrmrpfozma14xSG38xXRYv-xLzM1EYvvOzmGuxWAUpVDlg0H-jAo7M5on-TNuilMfy2lmX-fR8QdyJczEmqrtLszHB-gRh60Vzm3zoDrkhMJEU1EZKqYn9jSEl8QuQahpjS-rHQw5sSk-pQAr0VHiulVAKkKycSls-Wms7_8olg, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre/read, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642332796, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.240.10, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=CCAA2D9ED6580761E2E09A95068FFA75, http-session-last-accessed-time=1642332507140, kc-category-name=ACCESS, kc-iat=1642332496, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:51790 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:28:27.150  INFO 15 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:28:27.151  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7115732f
2022-01-16 11:28:27.151  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7115732f
2022-01-16 11:28:27.159  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7115732f
2022-01-16 11:28:27.159  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7115732f
2022-01-16 11:28:27.210  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7115732f
2022-01-16 11:28:27.210  WARN 15 --- [https-jsse-nio-7071-exec-10] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:28:27.211  WARN 15 --- [https-jsse-nio-7071-exec-10] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:28:27.212  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: under-emergency, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7115732f
2022-01-16 11:28:27.223  INFO 15 --- [https-jsse-nio-7071-exec-10] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18910958252211100-189658, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:patient-under-active-emergency:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=patient-under-active-emergency, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 3 - Patient under active emergency, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:28:27.223  INFO 15 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=df739836-81a6-4704-83de-df114a0faacd, content=DENY, timestamp=1642332507223, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:patient-under-active-emergency:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=patient-under-active-emergency, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 3 - Patient under active emergency, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:28:27.224  INFO 15 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=72ms, Total=75ms
2022-01-16 11:28:27.240  INFO 15 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=f6d43b5f-4c40-4218-a658-f3c5c85ec94d, content=null, timestamp=1642332507236, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=51792, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=5eea89d14d1a, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=999d21b7-cecf-4b75-ae67-bd5c244cfd50, http-req-server-port=80, http-header-accept=*/*, kc-id=917038d1-218a-4de3-bc21-524ee9b1ec1f, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642332507234, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQCfHNxAH4AEQAAAABh5AFQdAAkOTE3MDM4ZDEtMjE4YS00ZGUzLWJjMjEtNTI0ZWU5YjFlYzFmdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ5OTlkMjFiNy1jZWNmLTRiNzUtYWU2Ny1iZDVjMjQ0Y2ZkNTBwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJKS2NmeHpNR3dHQmVVTmNCczVvZ2tZclhKNlRJX0hyQi04Y3BuakZDa0lZIn0.eyJleHAiOjE2NDIzMzI3OTYsImlhdCI6MTY0MjMzMjQ5NiwianRpIjoiOTE3MDM4ZDEtMjE4YS00ZGUzLWJjMjEtNTI0ZWU5YjFlYzFmIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiI5OTlkMjFiNy1jZWNmLTRiNzUtYWU2Ny1iZDVjMjQ0Y2ZkNTAiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.TNPdGgstBT5KMl1zUUFYUdWBWAX1vTqDRLObIX6Hfm6TD1yNq3YIfGvVs8ew9FkCUjHZv2RxDXwap4ZBgU1XWNfgbY7lRnbcXLwKQVYJ_UngYNYkyfIeNM6f6obFgnYgUZWmuKJPNDWSwOXgaOQYUKn2Kwg84g2RElqDZmS17N-Zrmrpfozma14xSG38xXRYv-xLzM1EYvvOzmGuxWAUpVDlg0H-jAo7M5on-TNuilMfy2lmX-fR8QdyJczEmqrtLszHB-gRh60Vzm3zoDrkhMJEU1EZKqYn9jSEl8QuQahpjS-rHQw5sSk-pQAr0VHiulVAKkKycSls-Wms7_8olg, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre/read, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642332796, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.240.10, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=0D1E5F20E91C7EE42E6EB3999FACAA2B, http-session-last-accessed-time=1642332507234, kc-category-name=ACCESS, kc-iat=1642332496, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:51792 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:28:27.241  INFO 15 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:28:27.242  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2b1bad42
2022-01-16 11:28:27.242  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2b1bad42
2022-01-16 11:28:27.251  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2b1bad42
2022-01-16 11:28:27.252  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2b1bad42
2022-01-16 11:28:27.302  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2b1bad42
2022-01-16 11:28:27.302  WARN 15 --- [https-jsse-nio-7071-exec-1] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:28:27.302  WARN 15 --- [https-jsse-nio-7071-exec-1] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:28:27.302  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: under-emergency, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2b1bad42
2022-01-16 11:28:27.314  INFO 15 --- [https-jsse-nio-7071-exec-1] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18910958342674441-453684, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:patient-under-active-emergency:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=patient-under-active-emergency, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 3 - Patient under active emergency, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:28:27.315  INFO 15 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=f6d43b5f-4c40-4218-a658-f3c5c85ec94d, content=DENY, timestamp=1642332507315, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:patient-under-active-emergency:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=patient-under-active-emergency, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 3 - Patient under active emergency, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:28:27.316  INFO 15 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=74ms, Total=77ms
2022-01-16 11:28:27.334  INFO 15 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=794cac8c-faba-40d4-8662-578329022c1f, content=null, timestamp=1642332507328, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=51794, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=5eea89d14d1a, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=999d21b7-cecf-4b75-ae67-bd5c244cfd50, http-req-server-port=80, http-header-accept=*/*, kc-id=917038d1-218a-4de3-bc21-524ee9b1ec1f, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642332507326, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQCfHNxAH4AEQAAAABh5AFQdAAkOTE3MDM4ZDEtMjE4YS00ZGUzLWJjMjEtNTI0ZWU5YjFlYzFmdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ5OTlkMjFiNy1jZWNmLTRiNzUtYWU2Ny1iZDVjMjQ0Y2ZkNTBwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJKS2NmeHpNR3dHQmVVTmNCczVvZ2tZclhKNlRJX0hyQi04Y3BuakZDa0lZIn0.eyJleHAiOjE2NDIzMzI3OTYsImlhdCI6MTY0MjMzMjQ5NiwianRpIjoiOTE3MDM4ZDEtMjE4YS00ZGUzLWJjMjEtNTI0ZWU5YjFlYzFmIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiI5OTlkMjFiNy1jZWNmLTRiNzUtYWU2Ny1iZDVjMjQ0Y2ZkNTAiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.TNPdGgstBT5KMl1zUUFYUdWBWAX1vTqDRLObIX6Hfm6TD1yNq3YIfGvVs8ew9FkCUjHZv2RxDXwap4ZBgU1XWNfgbY7lRnbcXLwKQVYJ_UngYNYkyfIeNM6f6obFgnYgUZWmuKJPNDWSwOXgaOQYUKn2Kwg84g2RElqDZmS17N-Zrmrpfozma14xSG38xXRYv-xLzM1EYvvOzmGuxWAUpVDlg0H-jAo7M5on-TNuilMfy2lmX-fR8QdyJczEmqrtLszHB-gRh60Vzm3zoDrkhMJEU1EZKqYn9jSEl8QuQahpjS-rHQw5sSk-pQAr0VHiulVAKkKycSls-Wms7_8olg, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre/read, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642332796, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.240.10, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=5C6C79D292242B8978E4263BB68CEBD8, http-session-last-accessed-time=1642332507326, kc-category-name=ACCESS, kc-iat=1642332496, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:51794 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:28:27.335  INFO 15 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:28:27.336  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@448c84ee
2022-01-16 11:28:27.336  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@448c84ee
2022-01-16 11:28:27.344  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@448c84ee
2022-01-16 11:28:27.344  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@448c84ee
2022-01-16 11:28:27.401  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@448c84ee
2022-01-16 11:28:27.401  WARN 15 --- [https-jsse-nio-7071-exec-3] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:28:27.401  WARN 15 --- [https-jsse-nio-7071-exec-3] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:28:27.402  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: under-emergency, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@448c84ee
2022-01-16 11:28:27.416  INFO 15 --- [https-jsse-nio-7071-exec-3] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18910958436167936-667991, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:patient-under-active-emergency:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=patient-under-active-emergency, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 3 - Patient under active emergency, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:28:27.416  INFO 15 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=794cac8c-faba-40d4-8662-578329022c1f, content=DENY, timestamp=1642332507416, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:patient-under-active-emergency:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=patient-under-active-emergency, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 3 - Patient under active emergency, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:28:27.417  INFO 15 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=81ms, Total=84ms
2022-01-16 11:28:27.434  INFO 15 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=df19cab4-798c-449f-abe2-fa5e9e2b13ec, content=null, timestamp=1642332507428, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=51796, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=5eea89d14d1a, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=999d21b7-cecf-4b75-ae67-bd5c244cfd50, http-req-server-port=80, http-header-accept=*/*, kc-id=917038d1-218a-4de3-bc21-524ee9b1ec1f, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642332507427, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQCfHNxAH4AEQAAAABh5AFQdAAkOTE3MDM4ZDEtMjE4YS00ZGUzLWJjMjEtNTI0ZWU5YjFlYzFmdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ5OTlkMjFiNy1jZWNmLTRiNzUtYWU2Ny1iZDVjMjQ0Y2ZkNTBwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJKS2NmeHpNR3dHQmVVTmNCczVvZ2tZclhKNlRJX0hyQi04Y3BuakZDa0lZIn0.eyJleHAiOjE2NDIzMzI3OTYsImlhdCI6MTY0MjMzMjQ5NiwianRpIjoiOTE3MDM4ZDEtMjE4YS00ZGUzLWJjMjEtNTI0ZWU5YjFlYzFmIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiI5OTlkMjFiNy1jZWNmLTRiNzUtYWU2Ny1iZDVjMjQ0Y2ZkNTAiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.TNPdGgstBT5KMl1zUUFYUdWBWAX1vTqDRLObIX6Hfm6TD1yNq3YIfGvVs8ew9FkCUjHZv2RxDXwap4ZBgU1XWNfgbY7lRnbcXLwKQVYJ_UngYNYkyfIeNM6f6obFgnYgUZWmuKJPNDWSwOXgaOQYUKn2Kwg84g2RElqDZmS17N-Zrmrpfozma14xSG38xXRYv-xLzM1EYvvOzmGuxWAUpVDlg0H-jAo7M5on-TNuilMfy2lmX-fR8QdyJczEmqrtLszHB-gRh60Vzm3zoDrkhMJEU1EZKqYn9jSEl8QuQahpjS-rHQw5sSk-pQAr0VHiulVAKkKycSls-Wms7_8olg, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre/read, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642332796, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.240.10, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=6F353965EF1CBBABCBD0464E03E89683, http-session-last-accessed-time=1642332507427, kc-category-name=ACCESS, kc-iat=1642332496, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:51796 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:28:27.435  INFO 15 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:28:27.436  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@15683ef6
2022-01-16 11:28:27.437  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@15683ef6
2022-01-16 11:28:27.444  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@15683ef6
2022-01-16 11:28:27.444  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@15683ef6
2022-01-16 11:28:27.493  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@15683ef6
2022-01-16 11:28:27.494  WARN 15 --- [https-jsse-nio-7071-exec-2] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:28:27.494  WARN 15 --- [https-jsse-nio-7071-exec-2] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:28:27.494  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: under-emergency, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@15683ef6
2022-01-16 11:28:27.502  INFO 15 --- [https-jsse-nio-7071-exec-2] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18910958537233677-13769, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:patient-under-active-emergency:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=patient-under-active-emergency, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 3 - Patient under active emergency, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:28:27.502  INFO 15 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=df19cab4-798c-449f-abe2-fa5e9e2b13ec, content=DENY, timestamp=1642332507502, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:patient-under-active-emergency:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=patient-under-active-emergency, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 3 - Patient under active emergency, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:28:27.502  INFO 15 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=66ms, Total=69ms
2022-01-16 11:28:27.529  INFO 15 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=c32f69fe-32f1-474c-9a8a-caf9e8be6851, content=null, timestamp=1642332507514, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=51798, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=5eea89d14d1a, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=999d21b7-cecf-4b75-ae67-bd5c244cfd50, http-req-server-port=80, http-header-accept=*/*, kc-id=917038d1-218a-4de3-bc21-524ee9b1ec1f, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642332507513, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQCfHNxAH4AEQAAAABh5AFQdAAkOTE3MDM4ZDEtMjE4YS00ZGUzLWJjMjEtNTI0ZWU5YjFlYzFmdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ5OTlkMjFiNy1jZWNmLTRiNzUtYWU2Ny1iZDVjMjQ0Y2ZkNTBwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJKS2NmeHpNR3dHQmVVTmNCczVvZ2tZclhKNlRJX0hyQi04Y3BuakZDa0lZIn0.eyJleHAiOjE2NDIzMzI3OTYsImlhdCI6MTY0MjMzMjQ5NiwianRpIjoiOTE3MDM4ZDEtMjE4YS00ZGUzLWJjMjEtNTI0ZWU5YjFlYzFmIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiI5OTlkMjFiNy1jZWNmLTRiNzUtYWU2Ny1iZDVjMjQ0Y2ZkNTAiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.TNPdGgstBT5KMl1zUUFYUdWBWAX1vTqDRLObIX6Hfm6TD1yNq3YIfGvVs8ew9FkCUjHZv2RxDXwap4ZBgU1XWNfgbY7lRnbcXLwKQVYJ_UngYNYkyfIeNM6f6obFgnYgUZWmuKJPNDWSwOXgaOQYUKn2Kwg84g2RElqDZmS17N-Zrmrpfozma14xSG38xXRYv-xLzM1EYvvOzmGuxWAUpVDlg0H-jAo7M5on-TNuilMfy2lmX-fR8QdyJczEmqrtLszHB-gRh60Vzm3zoDrkhMJEU1EZKqYn9jSEl8QuQahpjS-rHQw5sSk-pQAr0VHiulVAKkKycSls-Wms7_8olg, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre/read, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642332796, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.240.10, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=E867E86EBCEA198C855500F7CC751423, http-session-last-accessed-time=1642332507513, kc-category-name=ACCESS, kc-iat=1642332496, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:51798 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:28:27.530  INFO 15 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:28:27.530  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2f47532e
2022-01-16 11:28:27.530  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2f47532e
2022-01-16 11:28:27.538  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2f47532e
2022-01-16 11:28:27.538  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2f47532e
2022-01-16 11:28:27.585  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2f47532e
2022-01-16 11:28:27.585  WARN 15 --- [https-jsse-nio-7071-exec-7] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:28:27.585  WARN 15 --- [https-jsse-nio-7071-exec-7] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:28:27.585  INFO 15 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: under-emergency, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2f47532e
2022-01-16 11:28:27.599  INFO 15 --- [https-jsse-nio-7071-exec-7] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18910958631034749-244929, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:patient-under-active-emergency:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=patient-under-active-emergency, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 3 - Patient under active emergency, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:28:27.599  INFO 15 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=c32f69fe-32f1-474c-9a8a-caf9e8be6851, content=DENY, timestamp=1642332507599, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:patient-under-active-emergency:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=patient-under-active-emergency, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 3 - Patient under active emergency, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:28:27.599  INFO 15 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=69ms, Total=71ms
2022-01-16 11:28:27.616  INFO 15 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=2f2538a6-b822-44f8-91e3-e53143346757, content=null, timestamp=1642332507608, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=51802, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=5eea89d14d1a, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=999d21b7-cecf-4b75-ae67-bd5c244cfd50, http-req-server-port=80, http-header-accept=*/*, kc-id=917038d1-218a-4de3-bc21-524ee9b1ec1f, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642332507607, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQCfHNxAH4AEQAAAABh5AFQdAAkOTE3MDM4ZDEtMjE4YS00ZGUzLWJjMjEtNTI0ZWU5YjFlYzFmdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ5OTlkMjFiNy1jZWNmLTRiNzUtYWU2Ny1iZDVjMjQ0Y2ZkNTBwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJKS2NmeHpNR3dHQmVVTmNCczVvZ2tZclhKNlRJX0hyQi04Y3BuakZDa0lZIn0.eyJleHAiOjE2NDIzMzI3OTYsImlhdCI6MTY0MjMzMjQ5NiwianRpIjoiOTE3MDM4ZDEtMjE4YS00ZGUzLWJjMjEtNTI0ZWU5YjFlYzFmIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiI5OTlkMjFiNy1jZWNmLTRiNzUtYWU2Ny1iZDVjMjQ0Y2ZkNTAiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.TNPdGgstBT5KMl1zUUFYUdWBWAX1vTqDRLObIX6Hfm6TD1yNq3YIfGvVs8ew9FkCUjHZv2RxDXwap4ZBgU1XWNfgbY7lRnbcXLwKQVYJ_UngYNYkyfIeNM6f6obFgnYgUZWmuKJPNDWSwOXgaOQYUKn2Kwg84g2RElqDZmS17N-Zrmrpfozma14xSG38xXRYv-xLzM1EYvvOzmGuxWAUpVDlg0H-jAo7M5on-TNuilMfy2lmX-fR8QdyJczEmqrtLszHB-gRh60Vzm3zoDrkhMJEU1EZKqYn9jSEl8QuQahpjS-rHQw5sSk-pQAr0VHiulVAKkKycSls-Wms7_8olg, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre/read, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642332796, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.240.10, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=7F4522A54610C262AD24E3A73BD461C0, http-session-last-accessed-time=1642332507607, kc-category-name=ACCESS, kc-iat=1642332496, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:51802 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:28:27.616  INFO 15 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:28:27.617  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4ddfd756
2022-01-16 11:28:27.618  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4ddfd756
2022-01-16 11:28:27.627  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4ddfd756
2022-01-16 11:28:27.627  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4ddfd756
2022-01-16 11:28:27.677  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4ddfd756
2022-01-16 11:28:27.678  WARN 15 --- [https-jsse-nio-7071-exec-8] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:28:27.678  WARN 15 --- [https-jsse-nio-7071-exec-8] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:28:27.679  INFO 15 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: under-emergency, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4ddfd756
2022-01-16 11:28:27.694  INFO 15 --- [https-jsse-nio-7071-exec-8] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18910958718147215-793183, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:patient-under-active-emergency:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=patient-under-active-emergency, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 3 - Patient under active emergency, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:28:27.694  INFO 15 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=2f2538a6-b822-44f8-91e3-e53143346757, content=DENY, timestamp=1642332507694, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:patient-under-active-emergency:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=patient-under-active-emergency, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 3 - Patient under active emergency, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:28:27.695  INFO 15 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=77ms, Total=81ms
2022-01-16 11:28:27.712  INFO 15 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=0631e2a9-9be6-4a48-b076-6b7103419f75, content=null, timestamp=1642332507708, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=51804, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=5eea89d14d1a, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=999d21b7-cecf-4b75-ae67-bd5c244cfd50, http-req-server-port=80, http-header-accept=*/*, kc-id=917038d1-218a-4de3-bc21-524ee9b1ec1f, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642332507707, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQCfHNxAH4AEQAAAABh5AFQdAAkOTE3MDM4ZDEtMjE4YS00ZGUzLWJjMjEtNTI0ZWU5YjFlYzFmdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ5OTlkMjFiNy1jZWNmLTRiNzUtYWU2Ny1iZDVjMjQ0Y2ZkNTBwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJKS2NmeHpNR3dHQmVVTmNCczVvZ2tZclhKNlRJX0hyQi04Y3BuakZDa0lZIn0.eyJleHAiOjE2NDIzMzI3OTYsImlhdCI6MTY0MjMzMjQ5NiwianRpIjoiOTE3MDM4ZDEtMjE4YS00ZGUzLWJjMjEtNTI0ZWU5YjFlYzFmIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiI5OTlkMjFiNy1jZWNmLTRiNzUtYWU2Ny1iZDVjMjQ0Y2ZkNTAiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.TNPdGgstBT5KMl1zUUFYUdWBWAX1vTqDRLObIX6Hfm6TD1yNq3YIfGvVs8ew9FkCUjHZv2RxDXwap4ZBgU1XWNfgbY7lRnbcXLwKQVYJ_UngYNYkyfIeNM6f6obFgnYgUZWmuKJPNDWSwOXgaOQYUKn2Kwg84g2RElqDZmS17N-Zrmrpfozma14xSG38xXRYv-xLzM1EYvvOzmGuxWAUpVDlg0H-jAo7M5on-TNuilMfy2lmX-fR8QdyJczEmqrtLszHB-gRh60Vzm3zoDrkhMJEU1EZKqYn9jSEl8QuQahpjS-rHQw5sSk-pQAr0VHiulVAKkKycSls-Wms7_8olg, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre/read, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642332796, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.240.10, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=87502EF7B88CE85832DAFA28B7DC8BB0, http-session-last-accessed-time=1642332507707, kc-category-name=ACCESS, kc-iat=1642332496, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:51804 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:28:27.713  INFO 15 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:28:27.714  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@516da8db
2022-01-16 11:28:27.715  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@516da8db
2022-01-16 11:28:27.725  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@516da8db
2022-01-16 11:28:27.725  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@516da8db
2022-01-16 11:28:27.777  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@516da8db
2022-01-16 11:28:27.777  WARN 15 --- [https-jsse-nio-7071-exec-9] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:28:27.777  WARN 15 --- [https-jsse-nio-7071-exec-9] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:28:27.778  INFO 15 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: under-emergency, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@516da8db
2022-01-16 11:28:27.787  INFO 15 --- [https-jsse-nio-7071-exec-9] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18910958814064627-20766, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:patient-under-active-emergency:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=patient-under-active-emergency, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 3 - Patient under active emergency, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:28:27.788  INFO 15 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=0631e2a9-9be6-4a48-b076-6b7103419f75, content=DENY, timestamp=1642332507788, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:patient-under-active-emergency:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=patient-under-active-emergency, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 3 - Patient under active emergency, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:28:27.788  INFO 15 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=75ms, Total=77ms
2022-01-16 11:28:27.804  INFO 15 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=b2bfdb56-1484-4185-bb92-9e9d924ca447, content=null, timestamp=1642332507799, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=51806, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=5eea89d14d1a, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=999d21b7-cecf-4b75-ae67-bd5c244cfd50, http-req-server-port=80, http-header-accept=*/*, kc-id=917038d1-218a-4de3-bc21-524ee9b1ec1f, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642332507798, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQCfHNxAH4AEQAAAABh5AFQdAAkOTE3MDM4ZDEtMjE4YS00ZGUzLWJjMjEtNTI0ZWU5YjFlYzFmdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ5OTlkMjFiNy1jZWNmLTRiNzUtYWU2Ny1iZDVjMjQ0Y2ZkNTBwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJKS2NmeHpNR3dHQmVVTmNCczVvZ2tZclhKNlRJX0hyQi04Y3BuakZDa0lZIn0.eyJleHAiOjE2NDIzMzI3OTYsImlhdCI6MTY0MjMzMjQ5NiwianRpIjoiOTE3MDM4ZDEtMjE4YS00ZGUzLWJjMjEtNTI0ZWU5YjFlYzFmIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiI5OTlkMjFiNy1jZWNmLTRiNzUtYWU2Ny1iZDVjMjQ0Y2ZkNTAiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.TNPdGgstBT5KMl1zUUFYUdWBWAX1vTqDRLObIX6Hfm6TD1yNq3YIfGvVs8ew9FkCUjHZv2RxDXwap4ZBgU1XWNfgbY7lRnbcXLwKQVYJ_UngYNYkyfIeNM6f6obFgnYgUZWmuKJPNDWSwOXgaOQYUKn2Kwg84g2RElqDZmS17N-Zrmrpfozma14xSG38xXRYv-xLzM1EYvvOzmGuxWAUpVDlg0H-jAo7M5on-TNuilMfy2lmX-fR8QdyJczEmqrtLszHB-gRh60Vzm3zoDrkhMJEU1EZKqYn9jSEl8QuQahpjS-rHQw5sSk-pQAr0VHiulVAKkKycSls-Wms7_8olg, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre/read, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642332796, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.240.10, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=C7631F985616D4CFCDC33B57E6616CE2, http-session-last-accessed-time=1642332507798, kc-category-name=ACCESS, kc-iat=1642332496, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:51806 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:28:27.804  INFO 15 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:28:27.805  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@f173bd
2022-01-16 11:28:27.805  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@f173bd
2022-01-16 11:28:27.812  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@f173bd
2022-01-16 11:28:27.812  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@f173bd
2022-01-16 11:28:27.861  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@f173bd
2022-01-16 11:28:27.861  WARN 15 --- [https-jsse-nio-7071-exec-10] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:28:27.862  WARN 15 --- [https-jsse-nio-7071-exec-10] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:28:27.862  INFO 15 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: under-emergency, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@f173bd
2022-01-16 11:28:27.876  INFO 15 --- [https-jsse-nio-7071-exec-10] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18910958905583448-559833, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:patient-under-active-emergency:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=patient-under-active-emergency, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 3 - Patient under active emergency, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:28:27.876  INFO 15 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=b2bfdb56-1484-4185-bb92-9e9d924ca447, content=DENY, timestamp=1642332507876, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:patient-under-active-emergency:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=patient-under-active-emergency, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 3 - Patient under active emergency, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:28:27.877  INFO 15 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=72ms, Total=74ms
2022-01-16 11:28:27.895  INFO 15 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=7f5f5220-5421-424f-a63d-a4e9538808e0, content=null, timestamp=1642332507889, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=51808, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=5eea89d14d1a, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=999d21b7-cecf-4b75-ae67-bd5c244cfd50, http-req-server-port=80, http-header-accept=*/*, kc-id=917038d1-218a-4de3-bc21-524ee9b1ec1f, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642332507888, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQCfHNxAH4AEQAAAABh5AFQdAAkOTE3MDM4ZDEtMjE4YS00ZGUzLWJjMjEtNTI0ZWU5YjFlYzFmdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ5OTlkMjFiNy1jZWNmLTRiNzUtYWU2Ny1iZDVjMjQ0Y2ZkNTBwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJKS2NmeHpNR3dHQmVVTmNCczVvZ2tZclhKNlRJX0hyQi04Y3BuakZDa0lZIn0.eyJleHAiOjE2NDIzMzI3OTYsImlhdCI6MTY0MjMzMjQ5NiwianRpIjoiOTE3MDM4ZDEtMjE4YS00ZGUzLWJjMjEtNTI0ZWU5YjFlYzFmIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiI5OTlkMjFiNy1jZWNmLTRiNzUtYWU2Ny1iZDVjMjQ0Y2ZkNTAiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.TNPdGgstBT5KMl1zUUFYUdWBWAX1vTqDRLObIX6Hfm6TD1yNq3YIfGvVs8ew9FkCUjHZv2RxDXwap4ZBgU1XWNfgbY7lRnbcXLwKQVYJ_UngYNYkyfIeNM6f6obFgnYgUZWmuKJPNDWSwOXgaOQYUKn2Kwg84g2RElqDZmS17N-Zrmrpfozma14xSG38xXRYv-xLzM1EYvvOzmGuxWAUpVDlg0H-jAo7M5on-TNuilMfy2lmX-fR8QdyJczEmqrtLszHB-gRh60Vzm3zoDrkhMJEU1EZKqYn9jSEl8QuQahpjS-rHQw5sSk-pQAr0VHiulVAKkKycSls-Wms7_8olg, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre/read, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642332796, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.240.10, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=C4633428760912F83E03B606689B1083, http-session-last-accessed-time=1642332507888, kc-category-name=ACCESS, kc-iat=1642332496, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:51808 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:28:27.896  INFO 15 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:28:27.897  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@19020a6
2022-01-16 11:28:27.898  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@19020a6
2022-01-16 11:28:27.907  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@19020a6
2022-01-16 11:28:27.907  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@19020a6
2022-01-16 11:28:27.957  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@19020a6
2022-01-16 11:28:27.958  WARN 15 --- [https-jsse-nio-7071-exec-1] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:28:27.958  WARN 15 --- [https-jsse-nio-7071-exec-1] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:28:27.959  INFO 15 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: under-emergency, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@19020a6
2022-01-16 11:28:27.967  INFO 15 --- [https-jsse-nio-7071-exec-1] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18910958997692457-859467, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:patient-under-active-emergency:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=patient-under-active-emergency, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 3 - Patient under active emergency, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:28:27.967  INFO 15 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=7f5f5220-5421-424f-a63d-a4e9538808e0, content=DENY, timestamp=1642332507967, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:patient-under-active-emergency:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=patient-under-active-emergency, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 3 - Patient under active emergency, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:28:27.968  INFO 15 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=71ms, Total=74ms
2022-01-16 11:28:27.988  INFO 15 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=837d56a6-e70c-4c8f-baf9-015cfac52736, content=null, timestamp=1642332507984, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=51810, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=5eea89d14d1a, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=999d21b7-cecf-4b75-ae67-bd5c244cfd50, http-req-server-port=80, http-header-accept=*/*, kc-id=917038d1-218a-4de3-bc21-524ee9b1ec1f, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642332507982, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQCfHNxAH4AEQAAAABh5AFQdAAkOTE3MDM4ZDEtMjE4YS00ZGUzLWJjMjEtNTI0ZWU5YjFlYzFmdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ5OTlkMjFiNy1jZWNmLTRiNzUtYWU2Ny1iZDVjMjQ0Y2ZkNTBwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJKS2NmeHpNR3dHQmVVTmNCczVvZ2tZclhKNlRJX0hyQi04Y3BuakZDa0lZIn0.eyJleHAiOjE2NDIzMzI3OTYsImlhdCI6MTY0MjMzMjQ5NiwianRpIjoiOTE3MDM4ZDEtMjE4YS00ZGUzLWJjMjEtNTI0ZWU5YjFlYzFmIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiI5OTlkMjFiNy1jZWNmLTRiNzUtYWU2Ny1iZDVjMjQ0Y2ZkNTAiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.TNPdGgstBT5KMl1zUUFYUdWBWAX1vTqDRLObIX6Hfm6TD1yNq3YIfGvVs8ew9FkCUjHZv2RxDXwap4ZBgU1XWNfgbY7lRnbcXLwKQVYJ_UngYNYkyfIeNM6f6obFgnYgUZWmuKJPNDWSwOXgaOQYUKn2Kwg84g2RElqDZmS17N-Zrmrpfozma14xSG38xXRYv-xLzM1EYvvOzmGuxWAUpVDlg0H-jAo7M5on-TNuilMfy2lmX-fR8QdyJczEmqrtLszHB-gRh60Vzm3zoDrkhMJEU1EZKqYn9jSEl8QuQahpjS-rHQw5sSk-pQAr0VHiulVAKkKycSls-Wms7_8olg, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre/read, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642332796, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.240.10, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=B6D2402031BC58D3D01B8DC3A963187E, http-session-last-accessed-time=1642332507982, kc-category-name=ACCESS, kc-iat=1642332496, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:51810 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:28:27.989  INFO 15 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:28:27.989  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@78e0083f
2022-01-16 11:28:27.990  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@78e0083f
2022-01-16 11:28:28.000  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@78e0083f
2022-01-16 11:28:28.000  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@78e0083f
2022-01-16 11:28:28.049  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@78e0083f
2022-01-16 11:28:28.049  WARN 15 --- [https-jsse-nio-7071-exec-3] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:28:28.050  WARN 15 --- [https-jsse-nio-7071-exec-3] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:28:28.050  INFO 15 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: under-emergency, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@78e0083f
2022-01-16 11:28:28.062  INFO 15 --- [https-jsse-nio-7071-exec-3] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18910959090569756-775675, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:patient-under-active-emergency:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=patient-under-active-emergency, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 3 - Patient under active emergency, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:28:28.062  INFO 15 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=837d56a6-e70c-4c8f-baf9-015cfac52736, content=DENY, timestamp=1642332508062, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:patient-under-active-emergency:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=patient-under-active-emergency, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 3 - Patient under active emergency, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:28:28.063  INFO 15 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=73ms, Total=76ms
2022-01-16 11:28:28.080  INFO 15 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=bdb078a7-0fd9-4c24-a74c-6ca104710155, content=null, timestamp=1642332508075, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=51812, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=5eea89d14d1a, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=999d21b7-cecf-4b75-ae67-bd5c244cfd50, http-req-server-port=80, http-header-accept=*/*, kc-id=917038d1-218a-4de3-bc21-524ee9b1ec1f, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642332508074, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQCfHNxAH4AEQAAAABh5AFQdAAkOTE3MDM4ZDEtMjE4YS00ZGUzLWJjMjEtNTI0ZWU5YjFlYzFmdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ5OTlkMjFiNy1jZWNmLTRiNzUtYWU2Ny1iZDVjMjQ0Y2ZkNTBwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJKS2NmeHpNR3dHQmVVTmNCczVvZ2tZclhKNlRJX0hyQi04Y3BuakZDa0lZIn0.eyJleHAiOjE2NDIzMzI3OTYsImlhdCI6MTY0MjMzMjQ5NiwianRpIjoiOTE3MDM4ZDEtMjE4YS00ZGUzLWJjMjEtNTI0ZWU5YjFlYzFmIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiI5OTlkMjFiNy1jZWNmLTRiNzUtYWU2Ny1iZDVjMjQ0Y2ZkNTAiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.TNPdGgstBT5KMl1zUUFYUdWBWAX1vTqDRLObIX6Hfm6TD1yNq3YIfGvVs8ew9FkCUjHZv2RxDXwap4ZBgU1XWNfgbY7lRnbcXLwKQVYJ_UngYNYkyfIeNM6f6obFgnYgUZWmuKJPNDWSwOXgaOQYUKn2Kwg84g2RElqDZmS17N-Zrmrpfozma14xSG38xXRYv-xLzM1EYvvOzmGuxWAUpVDlg0H-jAo7M5on-TNuilMfy2lmX-fR8QdyJczEmqrtLszHB-gRh60Vzm3zoDrkhMJEU1EZKqYn9jSEl8QuQahpjS-rHQw5sSk-pQAr0VHiulVAKkKycSls-Wms7_8olg, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre/read, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642332796, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.240.10, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=979A0686D94051FFBE1CDE0ED59CA4E5, http-session-last-accessed-time=1642332508074, kc-category-name=ACCESS, kc-iat=1642332496, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:51812 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:28:28.080  INFO 15 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:28:28.082  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@441907ee
2022-01-16 11:28:28.082  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@441907ee
2022-01-16 11:28:28.090  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@441907ee
2022-01-16 11:28:28.091  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@441907ee
2022-01-16 11:28:28.141  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@441907ee
2022-01-16 11:28:28.142  WARN 15 --- [https-jsse-nio-7071-exec-2] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:28:28.142  WARN 15 --- [https-jsse-nio-7071-exec-2] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:28:28.142  INFO 15 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: under-emergency, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@441907ee
2022-01-16 11:28:28.151  INFO 15 --- [https-jsse-nio-7071-exec-2] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18910959181800800-555421, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:patient-under-active-emergency:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=patient-under-active-emergency, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 3 - Patient under active emergency, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:28:28.151  INFO 15 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=bdb078a7-0fd9-4c24-a74c-6ca104710155, content=DENY, timestamp=1642332508151, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:patient-under-active-emergency:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=patient-under-active-emergency, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 3 - Patient under active emergency, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:28:28.152  INFO 15 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=71ms, Total=73ms
2022-01-16 11:28:28.166  INFO 15 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=0207e8b6-d87e-42db-b090-02c39d36d8c4, content=null, timestamp=1642332508162, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=51814, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=5eea89d14d1a, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=999d21b7-cecf-4b75-ae67-bd5c244cfd50, http-req-server-port=80, http-header-accept=*/*, kc-id=917038d1-218a-4de3-bc21-524ee9b1ec1f, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642332508161, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQCfHNxAH4AEQAAAABh5AFQdAAkOTE3MDM4ZDEtMjE4YS00ZGUzLWJjMjEtNTI0ZWU5YjFlYzFmdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ5OTlkMjFiNy1jZWNmLTRiNzUtYWU2Ny1iZDVjMjQ0Y2ZkNTBwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJKS2NmeHpNR3dHQmVVTmNCczVvZ2tZclhKNlRJX0hyQi04Y3BuakZDa0lZIn0.eyJleHAiOjE2NDIzMzI3OTYsImlhdCI6MTY0MjMzMjQ5NiwianRpIjoiOTE3MDM4ZDEtMjE4YS00ZGUzLWJjMjEtNTI0ZWU5YjFlYzFmIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiI5OTlkMjFiNy1jZWNmLTRiNzUtYWU2Ny1iZDVjMjQ0Y2ZkNTAiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.TNPdGgstBT5KMl1zUUFYUdWBWAX1vTqDRLObIX6Hfm6TD1yNq3YIfGvVs8ew9FkCUjHZv2RxDXwap4ZBgU1XWNfgbY7lRnbcXLwKQVYJ_UngYNYkyfIeNM6f6obFgnYgUZWmuKJPNDWSwOXgaOQYUKn2Kwg84g2RElqDZmS17N-Zrmrpfozma14xSG38xXRYv-xLzM1EYvvOzmGuxWAUpVDlg0H-jAo7M5on-TNuilMfy2lmX-fR8QdyJczEmqrtLszHB-gRh60Vzm3zoDrkhMJEU1EZKqYn9jSEl8QuQahpjS-rHQw5sSk-pQAr0VHiulVAKkKycSls-Wms7_8olg, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre/read, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642332796, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.240.10, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=80D106B4C91D27FFB8A7E6F81359A139, http-session-last-accessed-time=1642332508161, kc-category-name=ACCESS, kc-iat=1642332496, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:51814 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:28:28.166  INFO 15 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:28:28.166  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@769f8880
2022-01-16 11:28:28.166  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@769f8880
2022-01-16 11:28:28.172  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@769f8880
2022-01-16 11:28:28.173  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@769f8880
2022-01-16 11:28:28.222  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@769f8880
2022-01-16 11:28:28.222  WARN 15 --- [https-jsse-nio-7071-exec-4] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:28:28.222  WARN 15 --- [https-jsse-nio-7071-exec-4] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:28:28.222  INFO 15 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: under-emergency, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@769f8880
2022-01-16 11:28:28.230  INFO 15 --- [https-jsse-nio-7071-exec-4] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18910959267403291-193438, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:patient-under-active-emergency:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=patient-under-active-emergency, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 3 - Patient under active emergency, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:28:28.230  INFO 15 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=0207e8b6-d87e-42db-b090-02c39d36d8c4, content=DENY, timestamp=1642332508230, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:patient-under-active-emergency:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=patient-under-active-emergency, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 3 - Patient under active emergency, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:28:28.230  INFO 15 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=64ms, Total=66ms
2022-01-16 11:28:28.248  INFO 15 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=ba701303-62b0-4e45-b03f-32877d789c13, content=null, timestamp=1642332508243, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=51816, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=5eea89d14d1a, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=999d21b7-cecf-4b75-ae67-bd5c244cfd50, http-req-server-port=80, http-header-accept=*/*, kc-id=917038d1-218a-4de3-bc21-524ee9b1ec1f, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642332508240, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQCfHNxAH4AEQAAAABh5AFQdAAkOTE3MDM4ZDEtMjE4YS00ZGUzLWJjMjEtNTI0ZWU5YjFlYzFmdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ5OTlkMjFiNy1jZWNmLTRiNzUtYWU2Ny1iZDVjMjQ0Y2ZkNTBwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJKS2NmeHpNR3dHQmVVTmNCczVvZ2tZclhKNlRJX0hyQi04Y3BuakZDa0lZIn0.eyJleHAiOjE2NDIzMzI3OTYsImlhdCI6MTY0MjMzMjQ5NiwianRpIjoiOTE3MDM4ZDEtMjE4YS00ZGUzLWJjMjEtNTI0ZWU5YjFlYzFmIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiI5OTlkMjFiNy1jZWNmLTRiNzUtYWU2Ny1iZDVjMjQ0Y2ZkNTAiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.TNPdGgstBT5KMl1zUUFYUdWBWAX1vTqDRLObIX6Hfm6TD1yNq3YIfGvVs8ew9FkCUjHZv2RxDXwap4ZBgU1XWNfgbY7lRnbcXLwKQVYJ_UngYNYkyfIeNM6f6obFgnYgUZWmuKJPNDWSwOXgaOQYUKn2Kwg84g2RElqDZmS17N-Zrmrpfozma14xSG38xXRYv-xLzM1EYvvOzmGuxWAUpVDlg0H-jAo7M5on-TNuilMfy2lmX-fR8QdyJczEmqrtLszHB-gRh60Vzm3zoDrkhMJEU1EZKqYn9jSEl8QuQahpjS-rHQw5sSk-pQAr0VHiulVAKkKycSls-Wms7_8olg, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre/read, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642332796, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.240.10, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=F4AE83EC75531D93DB7CFA34AC389CA5, http-session-last-accessed-time=1642332508240, kc-category-name=ACCESS, kc-iat=1642332496, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:51816 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:28:28.248  INFO 15 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:28:28.249  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@10026220
2022-01-16 11:28:28.250  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@10026220
2022-01-16 11:28:28.260  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@10026220
2022-01-16 11:28:28.261  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@10026220
2022-01-16 11:28:28.309  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@10026220
2022-01-16 11:28:28.309  WARN 15 --- [https-jsse-nio-7071-exec-5] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:28:28.310  WARN 15 --- [https-jsse-nio-7071-exec-5] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:28:28.310  INFO 15 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: under-emergency, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@10026220
2022-01-16 11:28:28.319  INFO 15 --- [https-jsse-nio-7071-exec-5] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18910959349992517-39204, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:patient-under-active-emergency:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=patient-under-active-emergency, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 3 - Patient under active emergency, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:28:28.322  INFO 15 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=ba701303-62b0-4e45-b03f-32877d789c13, content=DENY, timestamp=1642332508322, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:patient-under-active-emergency:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=patient-under-active-emergency, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 3 - Patient under active emergency, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:28:28.322  INFO 15 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=73ms, Total=76ms
2022-01-16 11:28:28.345  INFO 15 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=b4ed20f9-e880-42f6-bd30-814e7252aaf8, content=null, timestamp=1642332508336, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=51818, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=5eea89d14d1a, kc-issuer=http://10.255.230.159:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=10.255.230.159, kc-session-state=999d21b7-cecf-4b75-ae67-bd5c244cfd50, http-req-server-port=80, http-header-accept=*/*, kc-id=917038d1-218a-4de3-bc21-524ee9b1ec1f, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=10.255.230.159, http-session-creation-time=1642332508334, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYeQCfHNxAH4AEQAAAABh5AFQdAAkOTE3MDM4ZDEtMjE4YS00ZGUzLWJjMjEtNTI0ZWU5YjFlYzFmdAANY2FsbHMtZ2F0ZXdheXQAOGh0dHA6Ly8xMC4yNTUuMjMwLjE1OTo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ5OTlkMjFiNy1jZWNmLTRiNzUtYWU2Ny1iZDVjMjQ0Y2ZkNTBwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAVaHR0cDovLzEwLjI1NS4yMzAuMTU5eHBwc3IAL29yZy5rZXljbG9hay5yZXByZXNlbnRhdGlvbnMuQWNjZXNzVG9rZW4kQWNjZXNzB7BxD+V6RQsCAAJMAAVyb2xlc3EAfgABTAAMdmVyaWZ5Q2FsbGVycQB+AAp4cHNxAH4AK3cMAAAAED9AAAAAAAAEdAAOb2ZmbGluZV9hY2Nlc3N0AAZtZW1iZXJ0AAVhZG1pbnQAEXVtYV9hdXRob3JpemF0aW9ueHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHEAfgAYP0AAAAAAAAx3CAAAABAAAAABdAAHYWNjb3VudHNxAH4ALnNxAH4AK3cMAAAAED9AAAAAAAADdAAObWFuYWdlLWFjY291bnR0ABRtYW5hZ2UtYWNjb3VudC1saW5rc3QADHZpZXctcHJvZmlsZXhweAB0AA1wcm9maWxlIGVtYWlscA==, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJKS2NmeHpNR3dHQmVVTmNCczVvZ2tZclhKNlRJX0hyQi04Y3BuakZDa0lZIn0.eyJleHAiOjE2NDIzMzI3OTYsImlhdCI6MTY0MjMzMjQ5NiwianRpIjoiOTE3MDM4ZDEtMjE4YS00ZGUzLWJjMjEtNTI0ZWU5YjFlYzFmIiwiaXNzIjoiaHR0cDovLzEwLjI1NS4yMzAuMTU5OjgxODEvYXV0aC9yZWFsbXMvYW1idWxhbmNlLWV4YW1wbGUiLCJhdWQiOiJhY2NvdW50Iiwic3ViIjoiM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkIiwidHlwIjoiQmVhcmVyIiwiYXpwIjoiY2FsbHMtZ2F0ZXdheSIsInNlc3Npb25fc3RhdGUiOiI5OTlkMjFiNy1jZWNmLTRiNzUtYWU2Ny1iZDVjMjQ0Y2ZkNTAiLCJhY3IiOiIxIiwiYWxsb3dlZC1vcmlnaW5zIjpbImh0dHA6Ly8xMC4yNTUuMjMwLjE1OSJdLCJyZWFsbV9hY2Nlc3MiOnsicm9sZXMiOlsib2ZmbGluZV9hY2Nlc3MiLCJtZW1iZXIiLCJhZG1pbiIsInVtYV9hdXRob3JpemF0aW9uIl19LCJyZXNvdXJjZV9hY2Nlc3MiOnsiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwibWVkaWNhbC1yb2xlcyI6Inh4eCxhbWJ1bGFuY2UtY3JldyIsImVtYWlsX3ZlcmlmaWVkIjpmYWxzZSwiYW1idWxhbmNlLWNyZXctaWQiOiJhbWJ1bGFuY2UtY3Jldy1pZC0xMjM0IiwiRE9CIjoiMTk4MC0wNC0wNSIsInVzZXItSUQiOiIxMCIsInByZWZlcnJlZF91c2VybmFtZSI6InVzZXIxIiwidGVhbS1JRCI6IjEwIn0.TNPdGgstBT5KMl1zUUFYUdWBWAX1vTqDRLObIX6Hfm6TD1yNq3YIfGvVs8ew9FkCUjHZv2RxDXwap4ZBgU1XWNfgbY7lRnbcXLwKQVYJ_UngYNYkyfIeNM6f6obFgnYgUZWmuKJPNDWSwOXgaOQYUKn2Kwg84g2RElqDZmS17N-Zrmrpfozma14xSG38xXRYv-xLzM1EYvvOzmGuxWAUpVDlg0H-jAo7M5on-TNuilMfy2lmX-fR8QdyJczEmqrtLszHB-gRh60Vzm3zoDrkhMJEU1EZKqYn9jSEl8QuQahpjS-rHQw5sSk-pQAr0VHiulVAKkKycSls-Wms7_8olg, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://10.255.230.159/rest/acute-care-demo/call-centre/read, http-req-server-name=10.255.230.159, kc-cc--user-ID=10, kc-exp=1642332796, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.22.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.240.10, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=10.255.230.159, http-session-id=672213A6F9D5CA5205B13FBB8F6D731A, http-session-last-accessed-time=1642332508334, kc-category-name=ACCESS, kc-iat=1642332496, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=10.255.230.159:51818 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-16 11:28:28.349  INFO 15 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-16 11:28:28.350  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@78d3db00
2022-01-16 11:28:28.350  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@78d3db00
2022-01-16 11:28:28.359  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@78d3db00
2022-01-16 11:28:28.359  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@78d3db00
2022-01-16 11:28:28.409  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@78d3db00
2022-01-16 11:28:28.410  WARN 15 --- [https-jsse-nio-7071-exec-6] e.a.e.c.CustomRestAttrFinder             : --------    getUserteamID: return: 10
2022-01-16 11:28:28.410  WARN 15 --- [https-jsse-nio-7071-exec-6] e.a.e.c.CustomRestAttrFinder             : --------    Found team id: 10
2022-01-16 11:28:28.410  INFO 15 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: under-emergency, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@78d3db00
2022-01-16 11:28:28.422  INFO 15 --- [https-jsse-nio-7071-exec-6] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-18910959450935915-266855, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:patient-under-active-emergency:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=patient-under-active-emergency, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 3 - Patient under active emergency, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-16 11:28:28.422  INFO 15 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=b4ed20f9-e880-42f6-bd30-814e7252aaf8, content=DENY, timestamp=1642332508422, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:patient-under-active-emergency:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=patient-under-active-emergency, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 3 - Patient under active emergency, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-16 11:28:28.422  INFO 15 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=73ms, Total=79ms
