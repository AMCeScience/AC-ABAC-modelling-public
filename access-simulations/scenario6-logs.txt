*** ABAC Authorization Server ***

Config. Dir.: ./config
Policies Dir: ./policies

No configuration file found. Copying default configuration and keystores.
Any existing files will not be altered.
'samples/config/authorization-server.properties' -> './config/authorization-server.properties'
'samples/config/balana.cfg.xml' -> './config/balana.cfg.xml'

External Lib. path: /abac-server/ext/abac-example-context-handlers-1.0.0-SNAPSHOT-jar-with-dependencies.jar
Monitoring: ./policies/*.xml  Polling every 5s...

  .   ____          _            __ _ _
 /\\ / ___'_ __ _ _(_)_ __  __ _ \ \ \ \
( ( )\___ | '_ | '_| | '_ \/ _` | \ \ \ \
 \\/  ___)| |_)| | | | | || (_| |  ) ) ) )
  '  |____| .__|_| |_|_| |_\__, | / / / /
 =========|_|==============|___/=/_/_/_/
 :: Spring Boot ::                (v2.6.2)

2021-12-31 01:43:51.990  INFO 13 --- [           main] .a.a.a.s.AuthorizationServiceApplication : Starting AuthorizationServiceApplication v3.0.4 using Java 1.8.0_212 on e2bfef43cb51 with PID 13 (/abac-server/abac-authorization-server-exec.jar started by root in /abac-server)
2021-12-31 01:43:52.031  INFO 13 --- [           main] .a.a.a.s.AuthorizationServiceApplication : No active profile set, falling back to default profiles: default
2021-12-31 01:44:00.594  INFO 13 --- [           main] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2021-12-31 01:44:01.140  INFO 13 --- [           main] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 431 ms. Found 3 JPA repository interfaces.
2021-12-31 01:44:06.955  INFO 13 --- [           main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port(s): 7071 (https)
2021-12-31 01:44:07.124  INFO 13 --- [           main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2021-12-31 01:44:07.132  INFO 13 --- [           main] org.apache.catalina.core.StandardEngine  : Starting Servlet engine: [Apache Tomcat/9.0.56]
2021-12-31 01:44:08.125  INFO 13 --- [           main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2021-12-31 01:44:08.132  INFO 13 --- [           main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 15406 ms
2021-12-31 01:44:08.484  INFO 13 --- [           main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
2021-12-31 01:44:08.541  WARN 13 --- [           main] com.zaxxer.hikari.util.DriverDataSource  : Registered driver with driverClassName=com.mysql.jdbc.Driver was not found, trying direct instantiation.
2021-12-31 01:44:10.519  INFO 13 --- [           main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
2021-12-31 01:44:10.644  INFO 13 --- [           main] o.s.b.a.h2.H2ConsoleAutoConfiguration    : H2 console available at '/h2-console'. Database available at 'jdbc:mysql://mysql:3306/apam_db?createDatabaseIfNotExist=true'
2021-12-31 01:44:11.908  INFO 13 --- [           main] o.hibernate.jpa.internal.util.LogHelper  : HHH000204: Processing PersistenceUnitInfo [name: default]
2021-12-31 01:44:12.466  INFO 13 --- [           main] org.hibernate.Version                    : HHH000412: Hibernate ORM core version 5.6.3.Final
2021-12-31 01:44:14.300  INFO 13 --- [           main] o.hibernate.annotations.common.Version   : HCANN000001: Hibernate Commons Annotations {5.1.2.Final}
2021-12-31 01:44:15.871  INFO 13 --- [           main] org.hibernate.dialect.Dialect            : HHH000400: Using dialect: org.hibernate.dialect.MySQL5InnoDBDialect
2021-12-31 01:44:20.998  INFO 13 --- [           main] o.h.e.t.j.p.i.JtaPlatformInitiator       : HHH000490: Using JtaPlatform implementation: [org.hibernate.engine.transaction.jta.platform.internal.NoJtaPlatform]
2021-12-31 01:44:21.034  INFO 13 --- [           main] j.LocalContainerEntityManagerFactoryBean : Initialized JPA EntityManagerFactory for persistence unit 'default'
2021-12-31 01:44:22.147  INFO 13 --- [           main] e.a.a.abac.server.pap.PapProperties      : ABAC Policies directory: ./config/../policies
2021-12-31 01:44:22.151  INFO 13 --- [           main] e.a.a.abac.server.pap.PapProperties      : ABE Policies directory: ./config/../policies
2021-12-31 01:44:24.755  INFO 13 --- [           main] e.a.a.abac.server.pdp.DirectoryWatcher   : Policy dir. watcher initialized
2021-12-31 01:44:24.765  INFO 13 --- [           main] e.a.a.a.s.pdp.AuthorizationServicePDP    : Initializing PDP...
2021-12-31 01:44:24.779  INFO 13 --- [           main] e.a.a.a.s.pdp.AuthorizationServicePDP    : Getting policy files from: ./config/../policies
2021-12-31 01:44:24.812  INFO 13 --- [           main] e.a.a.a.s.pdp.AuthorizationServicePDP    : Policy files found: 3
2021-12-31 01:44:26.006  INFO 13 --- [           main] org.wso2.balana.ConfigurationStore       : Loading runtime configuration
2021-12-31 01:44:26.722  INFO 13 --- [           main] e.a.a.a.s.pdp.AuthorizationServicePDP    : Configured attribute finder module classes: [eu.asclepios.authorization.abac.server.pdp.finder.LoggingAttributeFinderModule, eu.asclepios.authorization.abac.server.pdp.finder.WeekdayAttributeFinderModule, eu.asclepios.authorization.abac.server.pdp.finder.IpAddressAttributeFinderModule, eu.asclepios.authorization.abac.server.pdp.finder.DeviceAttributeFinderModule, eu.asclepios.authorization.abac.server.pdp.finder.GeolocationAttributeFinderModule, eu.asclepios.authorization.abac.server.pdp.finder.KeycloackAttributeFinderModule, eu.asclepios.authorization.abac.server.pdp.finder.NoopAttributeFinderModule, eu.asclepios.example.contexthandlers.CustomDbAttributeFinder, eu.asclepios.example.contexthandlers.CustomRestAttributeFinder]
2021-12-31 01:44:26.742  INFO 13 --- [           main] e.a.a.a.s.pdp.AuthorizationServicePDP    :   Instantiating attribute finder module: eu.asclepios.authorization.abac.server.pdp.finder.LoggingAttributeFinderModule@2a7686a7
2021-12-31 01:44:26.762  INFO 13 --- [           main] e.a.a.a.s.pdp.AuthorizationServicePDP    :   Instantiating attribute finder module: eu.asclepios.authorization.abac.server.pdp.finder.WeekdayAttributeFinderModule@758a34ce
2021-12-31 01:44:26.783  INFO 13 --- [           main] e.a.a.a.s.pdp.AuthorizationServicePDP    :   Instantiating attribute finder module: eu.asclepios.authorization.abac.server.pdp.finder.IpAddressAttributeFinderModule@7ec3394b
2021-12-31 01:44:26.790  INFO 13 --- [           main] e.a.a.a.s.pdp.AuthorizationServicePDP    :   Instantiating attribute finder module: eu.asclepios.authorization.abac.server.pdp.finder.DeviceAttributeFinderModule@bff34c6
2021-12-31 01:44:26.857  INFO 13 --- [           main] e.a.a.a.s.pdp.AuthorizationServicePDP    :   Instantiating attribute finder module: eu.asclepios.authorization.abac.server.pdp.finder.GeolocationAttributeFinderModule@1522d8a0
2021-12-31 01:44:26.863  INFO 13 --- [           main] e.a.a.a.s.pdp.AuthorizationServicePDP    :   Instantiating attribute finder module: eu.asclepios.authorization.abac.server.pdp.finder.KeycloackAttributeFinderModule@312ab28e
2021-12-31 01:44:26.866  INFO 13 --- [           main] e.a.a.a.s.pdp.AuthorizationServicePDP    :   Instantiating attribute finder module: eu.asclepios.authorization.abac.server.pdp.finder.NoopAttributeFinderModule@5644dc81
2021-12-31 01:44:26.877  INFO 13 --- [           main] e.a.e.c.CustomDbAttributeFinder          : CustomDbAttributeFinder: DB settings: url=jdbc:mysql://mysql:3306/keycloak, driver=com.mysql.jdbc.Driver, username=keycloak
2021-12-31 01:44:26.914  INFO 13 --- [           main] e.a.e.c.CustomDbAttributeFinder          : CustomDbAttributeFinder: Processing entry: 12345:600000:ambulance-crew-id-1234
2021-12-31 01:44:26.925  INFO 13 --- [           main] e.a.e.c.CustomDbAttributeFinder          : CustomDbAttributeFinder: Processing entry:  23456:600000:ambulance-crew-id-2345
2021-12-31 01:44:26.936  INFO 13 --- [           main] e.a.e.c.CustomDbAttributeFinder          : CustomDbAttributeFinder: Processing entry:  34567:600000:ambulance-crew-id-3456
2021-12-31 01:44:26.946  INFO 13 --- [           main] e.a.e.c.CustomDbAttributeFinder          : CustomDbAttributeFinder: Added 3 entries in DB
2021-12-31 01:44:26.950  INFO 13 --- [           main] e.a.a.a.s.pdp.AuthorizationServicePDP    :   Instantiating attribute finder module: eu.asclepios.example.contexthandlers.CustomDbAttributeFinder@3381b4fc
2021-12-31 01:44:26.975  INFO 13 --- [           main] e.a.e.c.CustomRestAttributeFinder        : CustomRestAttributeFinder: REST URL template: http://django-rest:8000/attribute-provider/getinfov2?ES-ID={{es-id}}&format=json&patient-ID={{patient-id}}&user-ID={{user-id}}
2021-12-31 01:44:27.117  INFO 13 --- [           main] e.a.a.a.s.pdp.AuthorizationServicePDP    :   Instantiating attribute finder module: eu.asclepios.example.contexthandlers.CustomRestAttributeFinder@2e11485
2021-12-31 01:44:27.322  INFO 13 --- [           main] e.a.a.a.s.pdp.AuthorizationServicePDP    : PDP initialized
2021-12-31 01:44:27.327  INFO 13 --- [           main] e.a.a.abac.server.PdpServerController    : Authorization Service configuration: AuthorizationServiceProperties(pdp=AuthorizationServiceProperties.PdpConfig(enable=true, balanaConfigFile=./config/balana.cfg.xml, policiesDir=./config/../policies, policiesExtension=.xml, restartPollingInterval=1000, accessKey=7235687126587231675321756752657236156321765723, attributeFinderClasses=[eu.asclepios.authorization.abac.server.pdp.finder.LoggingAttributeFinderModule, eu.asclepios.authorization.abac.server.pdp.finder.WeekdayAttributeFinderModule, eu.asclepios.authorization.abac.server.pdp.finder.IpAddressAttributeFinderModule, eu.asclepios.authorization.abac.server.pdp.finder.DeviceAttributeFinderModule, eu.asclepios.authorization.abac.server.pdp.finder.GeolocationAttributeFinderModule, eu.asclepios.authorization.abac.server.pdp.finder.KeycloackAttributeFinderModule, eu.asclepios.authorization.abac.server.pdp.finder.NoopAttributeFinderModule, eu.asclepios.example.contexthandlers.CustomDbAttributeFinder, eu.asclepios.example.contexthandlers.CustomRestAttributeFinder]), context=null, pip=[], requestContext=null)
2021-12-31 01:44:27.337  INFO 13 --- [           main] e.a.a.abac.server.PdpServerController    : Server-side request context extraction: false
2021-12-31 01:44:27.586  WARN 13 --- [           main] JpaBaseConfiguration$JpaWebConfiguration : spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2021-12-31 01:44:28.606  INFO 13 --- [           main] e.a.a.abac.server.util.WebMvcConfig      : Using API Key authentication in PDP
2021-12-31 01:44:28.612  INFO 13 --- [           main] e.a.a.abac.server.util.WebMvcConfig      : Using API Key authentication in PAP
2021-12-31 01:44:31.432  INFO 13 --- [           main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port(s): 7071 (https) with context path ''
2021-12-31 01:44:31.480  INFO 13 --- [           main] .a.a.a.s.AuthorizationServiceApplication : Started AuthorizationServiceApplication in 43.551 seconds (JVM running for 49.708)
2021-12-31 01:46:34.964  INFO 13 --- [nio-7071-exec-6] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring DispatcherServlet 'dispatcherServlet'
2021-12-31 01:46:34.972  INFO 13 --- [nio-7071-exec-6] o.s.web.servlet.DispatcherServlet        : Initializing Servlet 'dispatcherServlet'
2021-12-31 01:46:34.980  INFO 13 --- [nio-7071-exec-6] o.s.web.servlet.DispatcherServlet        : Completed initialization in 4 ms
2021-12-31 01:46:35.633  INFO 13 --- [nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=bf5add64-44b6-4ce2-a03c-a0607b524ef7, content=null, timestamp=1640915194115, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=64278, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=ab6fceaaf869, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=192.168.208.1, kc-session-state=ac73253f-28f7-4886-8ef5-3aa90a42f54f, http-req-server-port=80, http-header-accept=*/*, kc-id=e4473c87-b795-4333-8d39-d6ab32d6bf94, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1640915194001, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYc5iJHNxAH4AEQAAAABhzmD4dAAkZTQ0NzNjODctYjc5NS00MzMzLThkMzktZDZhYjMyZDZiZjk0dAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAXh4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRhYzczMjUzZi0yOGY3LTQ4ODYtOGVmNS0zYWE5MGE0MmY1NGZwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAATaHR0cDovLzE5Mi4xNjguMS44M3hwcHNyAC9vcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2VuJEFjY2VzcwewcQ/lekULAgACTAAFcm9sZXNxAH4AAUwADHZlcmlmeUNhbGxlcnEAfgAKeHBzcQB+ACt3DAAAABA/QAAAAAAABHQADm9mZmxpbmVfYWNjZXNzdAAGbWVtYmVydAAFYWRtaW50ABF1bWFfYXV0aG9yaXphdGlvbnhwc3IAF2phdmEudXRpbC5MaW5rZWRIYXNoTWFwNMBOXBBswPsCAAFaAAthY2Nlc3NPcmRlcnhxAH4AGD9AAAAAAAAMdwgAAAAQAAAAAXQAB2FjY291bnRzcQB+AC5zcQB+ACt3DAAAABA/QAAAAAAAA3QADm1hbmFnZS1hY2NvdW50dAAUbWFuYWdlLWFjY291bnQtbGlua3N0AAx2aWV3LXByb2ZpbGV4cHgAdAANcHJvZmlsZSBlbWFpbHA=, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJBcjkxZHNqZjlrTXBrNXU5VWJqclBicjYxSTBQNTlVNXlUeUY3NDRBNENJIn0.eyJleHAiOjE2NDA5MTU0OTIsImlhdCI6MTY0MDkxNTE5MiwianRpIjoiZTQ0NzNjODctYjc5NS00MzMzLThkMzktZDZhYjMyZDZiZjk0IiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiYWM3MzI1M2YtMjhmNy00ODg2LThlZjUtM2FhOTBhNDJmNTRmIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoieCJ9.rDIf9RLBcjr2qP5iz2oDw6OE3elFZfChlZdnKKwyecUS7iNaoa95QqyghoHGzaxjua5HQK04KRZh1VKQ36v1a6exy_Z6RkUOZCHfTdD7NLvUvdKmepPhsYBkBs4E94jPIq5Uxhv0Rx2oxkNCwYlL41_g7qAHlWWoeree0YrTOe9XEaqF-1U_TsY98CSbf4jCb7wANgsbB7Cu-7Z0VbrAdjGpw6yssQBFnquw3myY0XpqV-GlKjekSVNQzukJPVBveXI82CvrpkvIL_ihGiEGcrJI4E4cEDTlZ8_oUAT1Ml9aNuae3aUN0gFuC3e7tWjPId_DTMGWtLb8gcTDiVaEOw, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1640915492, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.208.11, kc-type=Bearer, kc-cc--team-ID=x, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=192.168.208.1, http-session-id=23719C65F0AED10ADBC6A3B49A34114E, http-session-last-accessed-time=1640915194001, kc-category-name=ACCESS, kc-iat=1640915192, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=192.168.208.1:64278 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2021-12-31 01:46:35.640  INFO 13 --- [nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Request context extracted
2021-12-31 01:46:35.663  INFO 13 --- [nio-7071-exec-6] e.a.a.abac.server.util.AttributeUtil     : XACML Attribute Categories:
{urn:oasis:names:tc:xacml:1.0:environment:current-date=urn:oasis:names:tc:xacml:3.0:attribute-category:environment, urn:oasis:names:tc:xacml:1.0:environment:current-dateTime=urn:oasis:names:tc:xacml:3.0:attribute-category:environment, actionId=urn:oasis:names:tc:xacml:3.0:attribute-category:action, user.identifier=urn:oasis:names:tc:xacml:1.0:subject-category:access-subject, urn:oasis:names:tc:xacml:1.0:environment:current-time=urn:oasis:names:tc:xacml:3.0:attribute-category:environment, request-id=urn:oasis:names:tc:xacml:3.0:attribute-category:environment, resource-id=urn:oasis:names:tc:xacml:3.0:attribute-category:resource}
2021-12-31 01:46:35.668  INFO 13 --- [nio-7071-exec-6] e.a.a.abac.server.util.AttributeUtil     : XACML Attribute Data Types:
{urn:oasis:names:tc:xacml:1.0:environment:current-date=http://www.w3.org/2001/XMLSchema#date, urn:oasis:names:tc:xacml:1.0:environment:current-dateTime=http://www.w3.org/2001/XMLSchema#dateTime, actionId=http://www.w3.org/2001/XMLSchema#string, user.identifier=http://www.w3.org/2001/XMLSchema#string, urn:oasis:names:tc:xacml:1.0:environment:current-time=http://www.w3.org/2001/XMLSchema#time, request-id=http://www.w3.org/2001/XMLSchema#string, resource-id=http://www.w3.org/2001/XMLSchema#string}
2021-12-31 01:46:35.716  INFO 13 --- [nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1062a32f
2021-12-31 01:46:35.729  INFO 13 --- [nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1062a32f
2021-12-31 01:46:36.135  INFO 13 --- [nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1062a32f
2021-12-31 01:46:36.140  INFO 13 --- [nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1062a32f
2021-12-31 01:46:36.166  INFO 13 --- [nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1062a32f
2021-12-31 01:46:36.178  WARN 13 --- [nio-7071-exec-6] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: x
2021-12-31 01:46:36.181  WARN 13 --- [nio-7071-exec-6] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: x
2021-12-31 01:46:36.233  INFO 13 --- [nio-7071-exec-6] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-5990166064051-235777, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2021-12-31 01:46:36.243  INFO 13 --- [nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=bf5add64-44b6-4ce2-a03c-a0607b524ef7, content=DENY, timestamp=1640915196243, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2021-12-31 01:46:36.273  INFO 13 --- [nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=595ms, Total=721ms
2021-12-31 01:46:36.931  INFO 13 --- [nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=8badb55e-bf07-4098-8444-4bf22be74807, content=null, timestamp=1640915196839, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=64288, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=ab6fceaaf869, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=192.168.208.1, kc-session-state=ac73253f-28f7-4886-8ef5-3aa90a42f54f, http-req-server-port=80, http-header-accept=*/*, kc-id=e4473c87-b795-4333-8d39-d6ab32d6bf94, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1640915196821, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYc5iJHNxAH4AEQAAAABhzmD4dAAkZTQ0NzNjODctYjc5NS00MzMzLThkMzktZDZhYjMyZDZiZjk0dAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAXh4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRhYzczMjUzZi0yOGY3LTQ4ODYtOGVmNS0zYWE5MGE0MmY1NGZwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAATaHR0cDovLzE5Mi4xNjguMS44M3hwcHNyAC9vcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2VuJEFjY2VzcwewcQ/lekULAgACTAAFcm9sZXNxAH4AAUwADHZlcmlmeUNhbGxlcnEAfgAKeHBzcQB+ACt3DAAAABA/QAAAAAAABHQADm9mZmxpbmVfYWNjZXNzdAAGbWVtYmVydAAFYWRtaW50ABF1bWFfYXV0aG9yaXphdGlvbnhwc3IAF2phdmEudXRpbC5MaW5rZWRIYXNoTWFwNMBOXBBswPsCAAFaAAthY2Nlc3NPcmRlcnhxAH4AGD9AAAAAAAAMdwgAAAAQAAAAAXQAB2FjY291bnRzcQB+AC5zcQB+ACt3DAAAABA/QAAAAAAAA3QADm1hbmFnZS1hY2NvdW50dAAUbWFuYWdlLWFjY291bnQtbGlua3N0AAx2aWV3LXByb2ZpbGV4cHgAdAANcHJvZmlsZSBlbWFpbHA=, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJBcjkxZHNqZjlrTXBrNXU5VWJqclBicjYxSTBQNTlVNXlUeUY3NDRBNENJIn0.eyJleHAiOjE2NDA5MTU0OTIsImlhdCI6MTY0MDkxNTE5MiwianRpIjoiZTQ0NzNjODctYjc5NS00MzMzLThkMzktZDZhYjMyZDZiZjk0IiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiYWM3MzI1M2YtMjhmNy00ODg2LThlZjUtM2FhOTBhNDJmNTRmIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoieCJ9.rDIf9RLBcjr2qP5iz2oDw6OE3elFZfChlZdnKKwyecUS7iNaoa95QqyghoHGzaxjua5HQK04KRZh1VKQ36v1a6exy_Z6RkUOZCHfTdD7NLvUvdKmepPhsYBkBs4E94jPIq5Uxhv0Rx2oxkNCwYlL41_g7qAHlWWoeree0YrTOe9XEaqF-1U_TsY98CSbf4jCb7wANgsbB7Cu-7Z0VbrAdjGpw6yssQBFnquw3myY0XpqV-GlKjekSVNQzukJPVBveXI82CvrpkvIL_ihGiEGcrJI4E4cEDTlZ8_oUAT1Ml9aNuae3aUN0gFuC3e7tWjPId_DTMGWtLb8gcTDiVaEOw, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1640915492, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.208.11, kc-type=Bearer, kc-cc--team-ID=x, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=192.168.208.1, http-session-id=8F6E55955A992AB3CC695DE2139F7CC9, http-session-last-accessed-time=1640915196821, kc-category-name=ACCESS, kc-iat=1640915192, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=192.168.208.1:64288 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2021-12-31 01:46:36.943  INFO 13 --- [nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Request context extracted
2021-12-31 01:46:36.952  INFO 13 --- [nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@58eb2cae
2021-12-31 01:46:36.956  INFO 13 --- [nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@58eb2cae
2021-12-31 01:46:37.004  INFO 13 --- [nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@58eb2cae
2021-12-31 01:46:37.012  INFO 13 --- [nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@58eb2cae
2021-12-31 01:46:37.041  INFO 13 --- [nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@58eb2cae
2021-12-31 01:46:37.048  WARN 13 --- [nio-7071-exec-7] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: x
2021-12-31 01:46:37.052  WARN 13 --- [nio-7071-exec-7] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: x
2021-12-31 01:46:37.055  INFO 13 --- [nio-7071-exec-7] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-5991468714457-933211, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2021-12-31 01:46:37.058  INFO 13 --- [nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=8badb55e-bf07-4098-8444-4bf22be74807, content=DENY, timestamp=1640915197058, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2021-12-31 01:46:37.062  INFO 13 --- [nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=110ms, Total=144ms
2021-12-31 01:46:37.264  INFO 13 --- [nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=eb744419-8649-4295-b464-ca268c06e438, content=null, timestamp=1640915197191, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=64290, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=ab6fceaaf869, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=192.168.208.1, kc-session-state=ac73253f-28f7-4886-8ef5-3aa90a42f54f, http-req-server-port=80, http-header-accept=*/*, kc-id=e4473c87-b795-4333-8d39-d6ab32d6bf94, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1640915197179, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYc5iJHNxAH4AEQAAAABhzmD4dAAkZTQ0NzNjODctYjc5NS00MzMzLThkMzktZDZhYjMyZDZiZjk0dAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAXh4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRhYzczMjUzZi0yOGY3LTQ4ODYtOGVmNS0zYWE5MGE0MmY1NGZwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAATaHR0cDovLzE5Mi4xNjguMS44M3hwcHNyAC9vcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2VuJEFjY2VzcwewcQ/lekULAgACTAAFcm9sZXNxAH4AAUwADHZlcmlmeUNhbGxlcnEAfgAKeHBzcQB+ACt3DAAAABA/QAAAAAAABHQADm9mZmxpbmVfYWNjZXNzdAAGbWVtYmVydAAFYWRtaW50ABF1bWFfYXV0aG9yaXphdGlvbnhwc3IAF2phdmEudXRpbC5MaW5rZWRIYXNoTWFwNMBOXBBswPsCAAFaAAthY2Nlc3NPcmRlcnhxAH4AGD9AAAAAAAAMdwgAAAAQAAAAAXQAB2FjY291bnRzcQB+AC5zcQB+ACt3DAAAABA/QAAAAAAAA3QADm1hbmFnZS1hY2NvdW50dAAUbWFuYWdlLWFjY291bnQtbGlua3N0AAx2aWV3LXByb2ZpbGV4cHgAdAANcHJvZmlsZSBlbWFpbHA=, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJBcjkxZHNqZjlrTXBrNXU5VWJqclBicjYxSTBQNTlVNXlUeUY3NDRBNENJIn0.eyJleHAiOjE2NDA5MTU0OTIsImlhdCI6MTY0MDkxNTE5MiwianRpIjoiZTQ0NzNjODctYjc5NS00MzMzLThkMzktZDZhYjMyZDZiZjk0IiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiYWM3MzI1M2YtMjhmNy00ODg2LThlZjUtM2FhOTBhNDJmNTRmIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoieCJ9.rDIf9RLBcjr2qP5iz2oDw6OE3elFZfChlZdnKKwyecUS7iNaoa95QqyghoHGzaxjua5HQK04KRZh1VKQ36v1a6exy_Z6RkUOZCHfTdD7NLvUvdKmepPhsYBkBs4E94jPIq5Uxhv0Rx2oxkNCwYlL41_g7qAHlWWoeree0YrTOe9XEaqF-1U_TsY98CSbf4jCb7wANgsbB7Cu-7Z0VbrAdjGpw6yssQBFnquw3myY0XpqV-GlKjekSVNQzukJPVBveXI82CvrpkvIL_ihGiEGcrJI4E4cEDTlZ8_oUAT1Ml9aNuae3aUN0gFuC3e7tWjPId_DTMGWtLb8gcTDiVaEOw, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1640915492, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.208.11, kc-type=Bearer, kc-cc--team-ID=x, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=192.168.208.1, http-session-id=4BDC8FE0BEA339A521F53367AA67F03D, http-session-last-accessed-time=1640915197179, kc-category-name=ACCESS, kc-iat=1640915192, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=192.168.208.1:64290 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2021-12-31 01:46:37.277  INFO 13 --- [nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Request context extracted
2021-12-31 01:46:37.288  INFO 13 --- [nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@12fb0c68
2021-12-31 01:46:37.292  INFO 13 --- [nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@12fb0c68
2021-12-31 01:46:37.346  INFO 13 --- [nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@12fb0c68
2021-12-31 01:46:37.352  INFO 13 --- [nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@12fb0c68
2021-12-31 01:46:37.406  INFO 13 --- [nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@12fb0c68
2021-12-31 01:46:37.410  WARN 13 --- [nio-7071-exec-8] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: x
2021-12-31 01:46:37.411  WARN 13 --- [nio-7071-exec-8] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: x
2021-12-31 01:46:37.416  INFO 13 --- [nio-7071-exec-8] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-5991802197162-589301, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2021-12-31 01:46:37.419  INFO 13 --- [nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=eb744419-8649-4295-b464-ca268c06e438, content=DENY, timestamp=1640915197419, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2021-12-31 01:46:37.422  INFO 13 --- [nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=137ms, Total=185ms
2021-12-31 01:46:37.602  INFO 13 --- [nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=158667b9-5d78-4713-958a-ac8d9f4ef222, content=null, timestamp=1640915197563, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=64292, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=ab6fceaaf869, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=192.168.208.1, kc-session-state=ac73253f-28f7-4886-8ef5-3aa90a42f54f, http-req-server-port=80, http-header-accept=*/*, kc-id=e4473c87-b795-4333-8d39-d6ab32d6bf94, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1640915197548, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYc5iJHNxAH4AEQAAAABhzmD4dAAkZTQ0NzNjODctYjc5NS00MzMzLThkMzktZDZhYjMyZDZiZjk0dAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAXh4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRhYzczMjUzZi0yOGY3LTQ4ODYtOGVmNS0zYWE5MGE0MmY1NGZwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAATaHR0cDovLzE5Mi4xNjguMS44M3hwcHNyAC9vcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2VuJEFjY2VzcwewcQ/lekULAgACTAAFcm9sZXNxAH4AAUwADHZlcmlmeUNhbGxlcnEAfgAKeHBzcQB+ACt3DAAAABA/QAAAAAAABHQADm9mZmxpbmVfYWNjZXNzdAAGbWVtYmVydAAFYWRtaW50ABF1bWFfYXV0aG9yaXphdGlvbnhwc3IAF2phdmEudXRpbC5MaW5rZWRIYXNoTWFwNMBOXBBswPsCAAFaAAthY2Nlc3NPcmRlcnhxAH4AGD9AAAAAAAAMdwgAAAAQAAAAAXQAB2FjY291bnRzcQB+AC5zcQB+ACt3DAAAABA/QAAAAAAAA3QADm1hbmFnZS1hY2NvdW50dAAUbWFuYWdlLWFjY291bnQtbGlua3N0AAx2aWV3LXByb2ZpbGV4cHgAdAANcHJvZmlsZSBlbWFpbHA=, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJBcjkxZHNqZjlrTXBrNXU5VWJqclBicjYxSTBQNTlVNXlUeUY3NDRBNENJIn0.eyJleHAiOjE2NDA5MTU0OTIsImlhdCI6MTY0MDkxNTE5MiwianRpIjoiZTQ0NzNjODctYjc5NS00MzMzLThkMzktZDZhYjMyZDZiZjk0IiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiYWM3MzI1M2YtMjhmNy00ODg2LThlZjUtM2FhOTBhNDJmNTRmIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoieCJ9.rDIf9RLBcjr2qP5iz2oDw6OE3elFZfChlZdnKKwyecUS7iNaoa95QqyghoHGzaxjua5HQK04KRZh1VKQ36v1a6exy_Z6RkUOZCHfTdD7NLvUvdKmepPhsYBkBs4E94jPIq5Uxhv0Rx2oxkNCwYlL41_g7qAHlWWoeree0YrTOe9XEaqF-1U_TsY98CSbf4jCb7wANgsbB7Cu-7Z0VbrAdjGpw6yssQBFnquw3myY0XpqV-GlKjekSVNQzukJPVBveXI82CvrpkvIL_ihGiEGcrJI4E4cEDTlZ8_oUAT1Ml9aNuae3aUN0gFuC3e7tWjPId_DTMGWtLb8gcTDiVaEOw, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1640915492, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.208.11, kc-type=Bearer, kc-cc--team-ID=x, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=192.168.208.1, http-session-id=ADCA6A0AA05AFBB1AD94BD89AF990A92, http-session-last-accessed-time=1640915197548, kc-category-name=ACCESS, kc-iat=1640915192, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=192.168.208.1:64292 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2021-12-31 01:46:37.616  INFO 13 --- [nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Request context extracted
2021-12-31 01:46:37.622  INFO 13 --- [nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@e2a5d6d
2021-12-31 01:46:37.627  INFO 13 --- [nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@e2a5d6d
2021-12-31 01:46:37.663  INFO 13 --- [nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@e2a5d6d
2021-12-31 01:46:37.670  INFO 13 --- [nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@e2a5d6d
2021-12-31 01:46:37.746  INFO 13 --- [nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@e2a5d6d
2021-12-31 01:46:37.750  WARN 13 --- [nio-7071-exec-9] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: x
2021-12-31 01:46:37.757  WARN 13 --- [nio-7071-exec-9] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: x
2021-12-31 01:46:37.762  INFO 13 --- [nio-7071-exec-9] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-5992138620586-54052, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2021-12-31 01:46:37.764  INFO 13 --- [nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=158667b9-5d78-4713-958a-ac8d9f4ef222, content=DENY, timestamp=1640915197764, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2021-12-31 01:46:37.769  INFO 13 --- [nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=146ms, Total=170ms
2021-12-31 01:46:37.913  INFO 13 --- [io-7071-exec-10] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=bce0edf9-f1c4-4466-a486-9df0b8960be9, content=null, timestamp=1640915197843, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=64294, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=ab6fceaaf869, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=192.168.208.1, kc-session-state=ac73253f-28f7-4886-8ef5-3aa90a42f54f, http-req-server-port=80, http-header-accept=*/*, kc-id=e4473c87-b795-4333-8d39-d6ab32d6bf94, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1640915197839, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYc5iJHNxAH4AEQAAAABhzmD4dAAkZTQ0NzNjODctYjc5NS00MzMzLThkMzktZDZhYjMyZDZiZjk0dAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAXh4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRhYzczMjUzZi0yOGY3LTQ4ODYtOGVmNS0zYWE5MGE0MmY1NGZwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAATaHR0cDovLzE5Mi4xNjguMS44M3hwcHNyAC9vcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2VuJEFjY2VzcwewcQ/lekULAgACTAAFcm9sZXNxAH4AAUwADHZlcmlmeUNhbGxlcnEAfgAKeHBzcQB+ACt3DAAAABA/QAAAAAAABHQADm9mZmxpbmVfYWNjZXNzdAAGbWVtYmVydAAFYWRtaW50ABF1bWFfYXV0aG9yaXphdGlvbnhwc3IAF2phdmEudXRpbC5MaW5rZWRIYXNoTWFwNMBOXBBswPsCAAFaAAthY2Nlc3NPcmRlcnhxAH4AGD9AAAAAAAAMdwgAAAAQAAAAAXQAB2FjY291bnRzcQB+AC5zcQB+ACt3DAAAABA/QAAAAAAAA3QADm1hbmFnZS1hY2NvdW50dAAUbWFuYWdlLWFjY291bnQtbGlua3N0AAx2aWV3LXByb2ZpbGV4cHgAdAANcHJvZmlsZSBlbWFpbHA=, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJBcjkxZHNqZjlrTXBrNXU5VWJqclBicjYxSTBQNTlVNXlUeUY3NDRBNENJIn0.eyJleHAiOjE2NDA5MTU0OTIsImlhdCI6MTY0MDkxNTE5MiwianRpIjoiZTQ0NzNjODctYjc5NS00MzMzLThkMzktZDZhYjMyZDZiZjk0IiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiYWM3MzI1M2YtMjhmNy00ODg2LThlZjUtM2FhOTBhNDJmNTRmIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoieCJ9.rDIf9RLBcjr2qP5iz2oDw6OE3elFZfChlZdnKKwyecUS7iNaoa95QqyghoHGzaxjua5HQK04KRZh1VKQ36v1a6exy_Z6RkUOZCHfTdD7NLvUvdKmepPhsYBkBs4E94jPIq5Uxhv0Rx2oxkNCwYlL41_g7qAHlWWoeree0YrTOe9XEaqF-1U_TsY98CSbf4jCb7wANgsbB7Cu-7Z0VbrAdjGpw6yssQBFnquw3myY0XpqV-GlKjekSVNQzukJPVBveXI82CvrpkvIL_ihGiEGcrJI4E4cEDTlZ8_oUAT1Ml9aNuae3aUN0gFuC3e7tWjPId_DTMGWtLb8gcTDiVaEOw, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1640915492, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.208.11, kc-type=Bearer, kc-cc--team-ID=x, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=192.168.208.1, http-session-id=4D2FF6B2F39B4E7A98F085DFB356F414, http-session-last-accessed-time=1640915197839, kc-category-name=ACCESS, kc-iat=1640915192, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=192.168.208.1:64294 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2021-12-31 01:46:37.920  INFO 13 --- [io-7071-exec-10] e.a.a.abac.server.PdpServerController    : Request context extracted
2021-12-31 01:46:37.933  INFO 13 --- [io-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@390760eb
2021-12-31 01:46:37.935  INFO 13 --- [io-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@390760eb
2021-12-31 01:46:37.973  INFO 13 --- [io-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@390760eb
2021-12-31 01:46:37.980  INFO 13 --- [io-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@390760eb
2021-12-31 01:46:38.031  INFO 13 --- [io-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@390760eb
2021-12-31 01:46:38.035  WARN 13 --- [io-7071-exec-10] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: x
2021-12-31 01:46:38.038  WARN 13 --- [io-7071-exec-10] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: x
2021-12-31 01:46:38.044  INFO 13 --- [io-7071-exec-10] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-5992442976913-699220, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2021-12-31 01:46:38.046  INFO 13 --- [io-7071-exec-10] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=bce0edf9-f1c4-4466-a486-9df0b8960be9, content=DENY, timestamp=1640915198046, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2021-12-31 01:46:38.052  INFO 13 --- [io-7071-exec-10] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=123ms, Total=143ms
2021-12-31 01:46:38.161  INFO 13 --- [nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=1bac5cd0-e37c-4093-8838-3d4d73b13be5, content=null, timestamp=1640915198142, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=64296, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=ab6fceaaf869, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=192.168.208.1, kc-session-state=ac73253f-28f7-4886-8ef5-3aa90a42f54f, http-req-server-port=80, http-header-accept=*/*, kc-id=e4473c87-b795-4333-8d39-d6ab32d6bf94, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1640915198124, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYc5iJHNxAH4AEQAAAABhzmD4dAAkZTQ0NzNjODctYjc5NS00MzMzLThkMzktZDZhYjMyZDZiZjk0dAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAXh4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRhYzczMjUzZi0yOGY3LTQ4ODYtOGVmNS0zYWE5MGE0MmY1NGZwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAATaHR0cDovLzE5Mi4xNjguMS44M3hwcHNyAC9vcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2VuJEFjY2VzcwewcQ/lekULAgACTAAFcm9sZXNxAH4AAUwADHZlcmlmeUNhbGxlcnEAfgAKeHBzcQB+ACt3DAAAABA/QAAAAAAABHQADm9mZmxpbmVfYWNjZXNzdAAGbWVtYmVydAAFYWRtaW50ABF1bWFfYXV0aG9yaXphdGlvbnhwc3IAF2phdmEudXRpbC5MaW5rZWRIYXNoTWFwNMBOXBBswPsCAAFaAAthY2Nlc3NPcmRlcnhxAH4AGD9AAAAAAAAMdwgAAAAQAAAAAXQAB2FjY291bnRzcQB+AC5zcQB+ACt3DAAAABA/QAAAAAAAA3QADm1hbmFnZS1hY2NvdW50dAAUbWFuYWdlLWFjY291bnQtbGlua3N0AAx2aWV3LXByb2ZpbGV4cHgAdAANcHJvZmlsZSBlbWFpbHA=, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJBcjkxZHNqZjlrTXBrNXU5VWJqclBicjYxSTBQNTlVNXlUeUY3NDRBNENJIn0.eyJleHAiOjE2NDA5MTU0OTIsImlhdCI6MTY0MDkxNTE5MiwianRpIjoiZTQ0NzNjODctYjc5NS00MzMzLThkMzktZDZhYjMyZDZiZjk0IiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiYWM3MzI1M2YtMjhmNy00ODg2LThlZjUtM2FhOTBhNDJmNTRmIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoieCJ9.rDIf9RLBcjr2qP5iz2oDw6OE3elFZfChlZdnKKwyecUS7iNaoa95QqyghoHGzaxjua5HQK04KRZh1VKQ36v1a6exy_Z6RkUOZCHfTdD7NLvUvdKmepPhsYBkBs4E94jPIq5Uxhv0Rx2oxkNCwYlL41_g7qAHlWWoeree0YrTOe9XEaqF-1U_TsY98CSbf4jCb7wANgsbB7Cu-7Z0VbrAdjGpw6yssQBFnquw3myY0XpqV-GlKjekSVNQzukJPVBveXI82CvrpkvIL_ihGiEGcrJI4E4cEDTlZ8_oUAT1Ml9aNuae3aUN0gFuC3e7tWjPId_DTMGWtLb8gcTDiVaEOw, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1640915492, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.208.11, kc-type=Bearer, kc-cc--team-ID=x, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=192.168.208.1, http-session-id=05E4243704FC2D46B383440968838BDF, http-session-last-accessed-time=1640915198124, kc-category-name=ACCESS, kc-iat=1640915192, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=192.168.208.1:64296 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2021-12-31 01:46:38.172  INFO 13 --- [nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Request context extracted
2021-12-31 01:46:38.194  INFO 13 --- [nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@533c1c2d
2021-12-31 01:46:38.199  INFO 13 --- [nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@533c1c2d
2021-12-31 01:46:38.241  INFO 13 --- [nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@533c1c2d
2021-12-31 01:46:38.248  INFO 13 --- [nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@533c1c2d
2021-12-31 01:46:38.277  INFO 13 --- [nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@533c1c2d
2021-12-31 01:46:38.282  WARN 13 --- [nio-7071-exec-1] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: x
2021-12-31 01:46:38.290  WARN 13 --- [nio-7071-exec-1] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: x
2021-12-31 01:46:38.295  INFO 13 --- [nio-7071-exec-1] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-5992709940321-580191, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2021-12-31 01:46:38.298  INFO 13 --- [nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=1bac5cd0-e37c-4093-8838-3d4d73b13be5, content=DENY, timestamp=1640915198298, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2021-12-31 01:46:38.302  INFO 13 --- [nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=108ms, Total=147ms
2021-12-31 01:46:38.435  INFO 13 --- [nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=dd7a19ed-a358-40fa-adfc-370e47a3db45, content=null, timestamp=1640915198408, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=64298, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=ab6fceaaf869, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=192.168.208.1, kc-session-state=ac73253f-28f7-4886-8ef5-3aa90a42f54f, http-req-server-port=80, http-header-accept=*/*, kc-id=e4473c87-b795-4333-8d39-d6ab32d6bf94, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1640915198406, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYc5iJHNxAH4AEQAAAABhzmD4dAAkZTQ0NzNjODctYjc5NS00MzMzLThkMzktZDZhYjMyZDZiZjk0dAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAXh4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRhYzczMjUzZi0yOGY3LTQ4ODYtOGVmNS0zYWE5MGE0MmY1NGZwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAATaHR0cDovLzE5Mi4xNjguMS44M3hwcHNyAC9vcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2VuJEFjY2VzcwewcQ/lekULAgACTAAFcm9sZXNxAH4AAUwADHZlcmlmeUNhbGxlcnEAfgAKeHBzcQB+ACt3DAAAABA/QAAAAAAABHQADm9mZmxpbmVfYWNjZXNzdAAGbWVtYmVydAAFYWRtaW50ABF1bWFfYXV0aG9yaXphdGlvbnhwc3IAF2phdmEudXRpbC5MaW5rZWRIYXNoTWFwNMBOXBBswPsCAAFaAAthY2Nlc3NPcmRlcnhxAH4AGD9AAAAAAAAMdwgAAAAQAAAAAXQAB2FjY291bnRzcQB+AC5zcQB+ACt3DAAAABA/QAAAAAAAA3QADm1hbmFnZS1hY2NvdW50dAAUbWFuYWdlLWFjY291bnQtbGlua3N0AAx2aWV3LXByb2ZpbGV4cHgAdAANcHJvZmlsZSBlbWFpbHA=, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJBcjkxZHNqZjlrTXBrNXU5VWJqclBicjYxSTBQNTlVNXlUeUY3NDRBNENJIn0.eyJleHAiOjE2NDA5MTU0OTIsImlhdCI6MTY0MDkxNTE5MiwianRpIjoiZTQ0NzNjODctYjc5NS00MzMzLThkMzktZDZhYjMyZDZiZjk0IiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiYWM3MzI1M2YtMjhmNy00ODg2LThlZjUtM2FhOTBhNDJmNTRmIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoieCJ9.rDIf9RLBcjr2qP5iz2oDw6OE3elFZfChlZdnKKwyecUS7iNaoa95QqyghoHGzaxjua5HQK04KRZh1VKQ36v1a6exy_Z6RkUOZCHfTdD7NLvUvdKmepPhsYBkBs4E94jPIq5Uxhv0Rx2oxkNCwYlL41_g7qAHlWWoeree0YrTOe9XEaqF-1U_TsY98CSbf4jCb7wANgsbB7Cu-7Z0VbrAdjGpw6yssQBFnquw3myY0XpqV-GlKjekSVNQzukJPVBveXI82CvrpkvIL_ihGiEGcrJI4E4cEDTlZ8_oUAT1Ml9aNuae3aUN0gFuC3e7tWjPId_DTMGWtLb8gcTDiVaEOw, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1640915492, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.208.11, kc-type=Bearer, kc-cc--team-ID=x, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=192.168.208.1, http-session-id=A85904529BDE1B8F11A4AA50F7A0B9D5, http-session-last-accessed-time=1640915198406, kc-category-name=ACCESS, kc-iat=1640915192, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=192.168.208.1:64298 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2021-12-31 01:46:38.455  INFO 13 --- [nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Request context extracted
2021-12-31 01:46:38.466  INFO 13 --- [nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@146faa0c
2021-12-31 01:46:38.470  INFO 13 --- [nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@146faa0c
2021-12-31 01:46:38.508  INFO 13 --- [nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@146faa0c
2021-12-31 01:46:38.516  INFO 13 --- [nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@146faa0c
2021-12-31 01:46:38.586  INFO 13 --- [nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@146faa0c
2021-12-31 01:46:38.591  WARN 13 --- [nio-7071-exec-2] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: x
2021-12-31 01:46:38.596  WARN 13 --- [nio-7071-exec-2] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: x
2021-12-31 01:46:38.610  INFO 13 --- [nio-7071-exec-2] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-5992978286284-411107, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2021-12-31 01:46:38.623  INFO 13 --- [nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=dd7a19ed-a358-40fa-adfc-370e47a3db45, content=DENY, timestamp=1640915198623, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2021-12-31 01:46:38.650  INFO 13 --- [nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=165ms, Total=223ms
2021-12-31 01:46:38.741  INFO 13 --- [nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=39269719-236a-42f5-bc20-b6671f6cb478, content=null, timestamp=1640915198728, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=64300, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=ab6fceaaf869, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=192.168.208.1, kc-session-state=ac73253f-28f7-4886-8ef5-3aa90a42f54f, http-req-server-port=80, http-header-accept=*/*, kc-id=e4473c87-b795-4333-8d39-d6ab32d6bf94, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1640915198724, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYc5iJHNxAH4AEQAAAABhzmD4dAAkZTQ0NzNjODctYjc5NS00MzMzLThkMzktZDZhYjMyZDZiZjk0dAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAXh4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRhYzczMjUzZi0yOGY3LTQ4ODYtOGVmNS0zYWE5MGE0MmY1NGZwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAATaHR0cDovLzE5Mi4xNjguMS44M3hwcHNyAC9vcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2VuJEFjY2VzcwewcQ/lekULAgACTAAFcm9sZXNxAH4AAUwADHZlcmlmeUNhbGxlcnEAfgAKeHBzcQB+ACt3DAAAABA/QAAAAAAABHQADm9mZmxpbmVfYWNjZXNzdAAGbWVtYmVydAAFYWRtaW50ABF1bWFfYXV0aG9yaXphdGlvbnhwc3IAF2phdmEudXRpbC5MaW5rZWRIYXNoTWFwNMBOXBBswPsCAAFaAAthY2Nlc3NPcmRlcnhxAH4AGD9AAAAAAAAMdwgAAAAQAAAAAXQAB2FjY291bnRzcQB+AC5zcQB+ACt3DAAAABA/QAAAAAAAA3QADm1hbmFnZS1hY2NvdW50dAAUbWFuYWdlLWFjY291bnQtbGlua3N0AAx2aWV3LXByb2ZpbGV4cHgAdAANcHJvZmlsZSBlbWFpbHA=, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJBcjkxZHNqZjlrTXBrNXU5VWJqclBicjYxSTBQNTlVNXlUeUY3NDRBNENJIn0.eyJleHAiOjE2NDA5MTU0OTIsImlhdCI6MTY0MDkxNTE5MiwianRpIjoiZTQ0NzNjODctYjc5NS00MzMzLThkMzktZDZhYjMyZDZiZjk0IiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiYWM3MzI1M2YtMjhmNy00ODg2LThlZjUtM2FhOTBhNDJmNTRmIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoieCJ9.rDIf9RLBcjr2qP5iz2oDw6OE3elFZfChlZdnKKwyecUS7iNaoa95QqyghoHGzaxjua5HQK04KRZh1VKQ36v1a6exy_Z6RkUOZCHfTdD7NLvUvdKmepPhsYBkBs4E94jPIq5Uxhv0Rx2oxkNCwYlL41_g7qAHlWWoeree0YrTOe9XEaqF-1U_TsY98CSbf4jCb7wANgsbB7Cu-7Z0VbrAdjGpw6yssQBFnquw3myY0XpqV-GlKjekSVNQzukJPVBveXI82CvrpkvIL_ihGiEGcrJI4E4cEDTlZ8_oUAT1Ml9aNuae3aUN0gFuC3e7tWjPId_DTMGWtLb8gcTDiVaEOw, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1640915492, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.208.11, kc-type=Bearer, kc-cc--team-ID=x, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=192.168.208.1, http-session-id=2CD5A5E13598A6B5E3E88E51FDA915CB, http-session-last-accessed-time=1640915198724, kc-category-name=ACCESS, kc-iat=1640915192, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=192.168.208.1:64300 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2021-12-31 01:46:38.748  INFO 13 --- [nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Request context extracted
2021-12-31 01:46:38.751  INFO 13 --- [nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3d0074ed
2021-12-31 01:46:38.753  INFO 13 --- [nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3d0074ed
2021-12-31 01:46:38.782  INFO 13 --- [nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3d0074ed
2021-12-31 01:46:38.786  INFO 13 --- [nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3d0074ed
2021-12-31 01:46:38.810  INFO 13 --- [nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3d0074ed
2021-12-31 01:46:38.813  WARN 13 --- [nio-7071-exec-3] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: x
2021-12-31 01:46:38.818  WARN 13 --- [nio-7071-exec-3] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: x
2021-12-31 01:46:38.822  INFO 13 --- [nio-7071-exec-3] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-5993270351254-224926, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2021-12-31 01:46:38.826  INFO 13 --- [nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=39269719-236a-42f5-bc20-b6671f6cb478, content=DENY, timestamp=1640915198826, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2021-12-31 01:46:38.832  INFO 13 --- [nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=76ms, Total=93ms
2021-12-31 01:46:38.904  INFO 13 --- [nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=71818cba-62f2-4cec-9fbb-eb364b3dfa12, content=null, timestamp=1640915198887, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=64302, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=ab6fceaaf869, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=192.168.208.1, kc-session-state=ac73253f-28f7-4886-8ef5-3aa90a42f54f, http-req-server-port=80, http-header-accept=*/*, kc-id=e4473c87-b795-4333-8d39-d6ab32d6bf94, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1640915198885, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYc5iJHNxAH4AEQAAAABhzmD4dAAkZTQ0NzNjODctYjc5NS00MzMzLThkMzktZDZhYjMyZDZiZjk0dAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAXh4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRhYzczMjUzZi0yOGY3LTQ4ODYtOGVmNS0zYWE5MGE0MmY1NGZwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAATaHR0cDovLzE5Mi4xNjguMS44M3hwcHNyAC9vcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2VuJEFjY2VzcwewcQ/lekULAgACTAAFcm9sZXNxAH4AAUwADHZlcmlmeUNhbGxlcnEAfgAKeHBzcQB+ACt3DAAAABA/QAAAAAAABHQADm9mZmxpbmVfYWNjZXNzdAAGbWVtYmVydAAFYWRtaW50ABF1bWFfYXV0aG9yaXphdGlvbnhwc3IAF2phdmEudXRpbC5MaW5rZWRIYXNoTWFwNMBOXBBswPsCAAFaAAthY2Nlc3NPcmRlcnhxAH4AGD9AAAAAAAAMdwgAAAAQAAAAAXQAB2FjY291bnRzcQB+AC5zcQB+ACt3DAAAABA/QAAAAAAAA3QADm1hbmFnZS1hY2NvdW50dAAUbWFuYWdlLWFjY291bnQtbGlua3N0AAx2aWV3LXByb2ZpbGV4cHgAdAANcHJvZmlsZSBlbWFpbHA=, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJBcjkxZHNqZjlrTXBrNXU5VWJqclBicjYxSTBQNTlVNXlUeUY3NDRBNENJIn0.eyJleHAiOjE2NDA5MTU0OTIsImlhdCI6MTY0MDkxNTE5MiwianRpIjoiZTQ0NzNjODctYjc5NS00MzMzLThkMzktZDZhYjMyZDZiZjk0IiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiYWM3MzI1M2YtMjhmNy00ODg2LThlZjUtM2FhOTBhNDJmNTRmIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoieCJ9.rDIf9RLBcjr2qP5iz2oDw6OE3elFZfChlZdnKKwyecUS7iNaoa95QqyghoHGzaxjua5HQK04KRZh1VKQ36v1a6exy_Z6RkUOZCHfTdD7NLvUvdKmepPhsYBkBs4E94jPIq5Uxhv0Rx2oxkNCwYlL41_g7qAHlWWoeree0YrTOe9XEaqF-1U_TsY98CSbf4jCb7wANgsbB7Cu-7Z0VbrAdjGpw6yssQBFnquw3myY0XpqV-GlKjekSVNQzukJPVBveXI82CvrpkvIL_ihGiEGcrJI4E4cEDTlZ8_oUAT1Ml9aNuae3aUN0gFuC3e7tWjPId_DTMGWtLb8gcTDiVaEOw, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1640915492, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.208.11, kc-type=Bearer, kc-cc--team-ID=x, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=192.168.208.1, http-session-id=20134CC6EA91466F27355655EE17F45D, http-session-last-accessed-time=1640915198885, kc-category-name=ACCESS, kc-iat=1640915192, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=192.168.208.1:64302 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2021-12-31 01:46:38.921  INFO 13 --- [nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Request context extracted
2021-12-31 01:46:38.926  INFO 13 --- [nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7f833983
2021-12-31 01:46:38.935  INFO 13 --- [nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7f833983
2021-12-31 01:46:38.967  INFO 13 --- [nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7f833983
2021-12-31 01:46:38.982  INFO 13 --- [nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7f833983
2021-12-31 01:46:39.011  INFO 13 --- [nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7f833983
2021-12-31 01:46:39.014  WARN 13 --- [nio-7071-exec-4] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: x
2021-12-31 01:46:39.018  WARN 13 --- [nio-7071-exec-4] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: x
2021-12-31 01:46:39.026  INFO 13 --- [nio-7071-exec-4] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-5993444686763-314383, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2021-12-31 01:46:39.029  INFO 13 --- [nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=71818cba-62f2-4cec-9fbb-eb364b3dfa12, content=DENY, timestamp=1640915199029, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2021-12-31 01:46:39.035  INFO 13 --- [nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=105ms, Total=134ms
2021-12-31 01:46:39.134  INFO 13 --- [nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=64d038f3-8040-4106-a6b8-4043696d8f46, content=null, timestamp=1640915199102, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=64304, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=ab6fceaaf869, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=192.168.208.1, kc-session-state=ac73253f-28f7-4886-8ef5-3aa90a42f54f, http-req-server-port=80, http-header-accept=*/*, kc-id=e4473c87-b795-4333-8d39-d6ab32d6bf94, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1640915199090, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYc5iJHNxAH4AEQAAAABhzmD4dAAkZTQ0NzNjODctYjc5NS00MzMzLThkMzktZDZhYjMyZDZiZjk0dAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAXh4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRhYzczMjUzZi0yOGY3LTQ4ODYtOGVmNS0zYWE5MGE0MmY1NGZwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAATaHR0cDovLzE5Mi4xNjguMS44M3hwcHNyAC9vcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2VuJEFjY2VzcwewcQ/lekULAgACTAAFcm9sZXNxAH4AAUwADHZlcmlmeUNhbGxlcnEAfgAKeHBzcQB+ACt3DAAAABA/QAAAAAAABHQADm9mZmxpbmVfYWNjZXNzdAAGbWVtYmVydAAFYWRtaW50ABF1bWFfYXV0aG9yaXphdGlvbnhwc3IAF2phdmEudXRpbC5MaW5rZWRIYXNoTWFwNMBOXBBswPsCAAFaAAthY2Nlc3NPcmRlcnhxAH4AGD9AAAAAAAAMdwgAAAAQAAAAAXQAB2FjY291bnRzcQB+AC5zcQB+ACt3DAAAABA/QAAAAAAAA3QADm1hbmFnZS1hY2NvdW50dAAUbWFuYWdlLWFjY291bnQtbGlua3N0AAx2aWV3LXByb2ZpbGV4cHgAdAANcHJvZmlsZSBlbWFpbHA=, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJBcjkxZHNqZjlrTXBrNXU5VWJqclBicjYxSTBQNTlVNXlUeUY3NDRBNENJIn0.eyJleHAiOjE2NDA5MTU0OTIsImlhdCI6MTY0MDkxNTE5MiwianRpIjoiZTQ0NzNjODctYjc5NS00MzMzLThkMzktZDZhYjMyZDZiZjk0IiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiYWM3MzI1M2YtMjhmNy00ODg2LThlZjUtM2FhOTBhNDJmNTRmIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoieCJ9.rDIf9RLBcjr2qP5iz2oDw6OE3elFZfChlZdnKKwyecUS7iNaoa95QqyghoHGzaxjua5HQK04KRZh1VKQ36v1a6exy_Z6RkUOZCHfTdD7NLvUvdKmepPhsYBkBs4E94jPIq5Uxhv0Rx2oxkNCwYlL41_g7qAHlWWoeree0YrTOe9XEaqF-1U_TsY98CSbf4jCb7wANgsbB7Cu-7Z0VbrAdjGpw6yssQBFnquw3myY0XpqV-GlKjekSVNQzukJPVBveXI82CvrpkvIL_ihGiEGcrJI4E4cEDTlZ8_oUAT1Ml9aNuae3aUN0gFuC3e7tWjPId_DTMGWtLb8gcTDiVaEOw, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1640915492, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.208.11, kc-type=Bearer, kc-cc--team-ID=x, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=192.168.208.1, http-session-id=173B6757F058076F58B1452EDEC259C8, http-session-last-accessed-time=1640915199090, kc-category-name=ACCESS, kc-iat=1640915192, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=192.168.208.1:64304 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2021-12-31 01:46:39.140  INFO 13 --- [nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Request context extracted
2021-12-31 01:46:39.147  INFO 13 --- [nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@686edfe7
2021-12-31 01:46:39.158  INFO 13 --- [nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@686edfe7
2021-12-31 01:46:39.220  INFO 13 --- [nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@686edfe7
2021-12-31 01:46:39.226  INFO 13 --- [nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@686edfe7
2021-12-31 01:46:39.309  INFO 13 --- [nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@686edfe7
2021-12-31 01:46:39.315  WARN 13 --- [nio-7071-exec-5] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: x
2021-12-31 01:46:39.317  WARN 13 --- [nio-7071-exec-5] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: x
2021-12-31 01:46:39.322  INFO 13 --- [nio-7071-exec-5] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-5993663022869-633860, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2021-12-31 01:46:39.332  INFO 13 --- [nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=64d038f3-8040-4106-a6b8-4043696d8f46, content=DENY, timestamp=1640915199332, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2021-12-31 01:46:39.340  INFO 13 --- [nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=189ms, Total=216ms
2021-12-31 01:46:39.415  INFO 13 --- [nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=b316ef57-97e5-4600-8a70-4d2a1e6aeb9b, content=null, timestamp=1640915199394, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=64306, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=ab6fceaaf869, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=192.168.208.1, kc-session-state=ac73253f-28f7-4886-8ef5-3aa90a42f54f, http-req-server-port=80, http-header-accept=*/*, kc-id=e4473c87-b795-4333-8d39-d6ab32d6bf94, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1640915199390, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYc5iJHNxAH4AEQAAAABhzmD4dAAkZTQ0NzNjODctYjc5NS00MzMzLThkMzktZDZhYjMyZDZiZjk0dAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAXh4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRhYzczMjUzZi0yOGY3LTQ4ODYtOGVmNS0zYWE5MGE0MmY1NGZwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAATaHR0cDovLzE5Mi4xNjguMS44M3hwcHNyAC9vcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2VuJEFjY2VzcwewcQ/lekULAgACTAAFcm9sZXNxAH4AAUwADHZlcmlmeUNhbGxlcnEAfgAKeHBzcQB+ACt3DAAAABA/QAAAAAAABHQADm9mZmxpbmVfYWNjZXNzdAAGbWVtYmVydAAFYWRtaW50ABF1bWFfYXV0aG9yaXphdGlvbnhwc3IAF2phdmEudXRpbC5MaW5rZWRIYXNoTWFwNMBOXBBswPsCAAFaAAthY2Nlc3NPcmRlcnhxAH4AGD9AAAAAAAAMdwgAAAAQAAAAAXQAB2FjY291bnRzcQB+AC5zcQB+ACt3DAAAABA/QAAAAAAAA3QADm1hbmFnZS1hY2NvdW50dAAUbWFuYWdlLWFjY291bnQtbGlua3N0AAx2aWV3LXByb2ZpbGV4cHgAdAANcHJvZmlsZSBlbWFpbHA=, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJBcjkxZHNqZjlrTXBrNXU5VWJqclBicjYxSTBQNTlVNXlUeUY3NDRBNENJIn0.eyJleHAiOjE2NDA5MTU0OTIsImlhdCI6MTY0MDkxNTE5MiwianRpIjoiZTQ0NzNjODctYjc5NS00MzMzLThkMzktZDZhYjMyZDZiZjk0IiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiYWM3MzI1M2YtMjhmNy00ODg2LThlZjUtM2FhOTBhNDJmNTRmIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoieCJ9.rDIf9RLBcjr2qP5iz2oDw6OE3elFZfChlZdnKKwyecUS7iNaoa95QqyghoHGzaxjua5HQK04KRZh1VKQ36v1a6exy_Z6RkUOZCHfTdD7NLvUvdKmepPhsYBkBs4E94jPIq5Uxhv0Rx2oxkNCwYlL41_g7qAHlWWoeree0YrTOe9XEaqF-1U_TsY98CSbf4jCb7wANgsbB7Cu-7Z0VbrAdjGpw6yssQBFnquw3myY0XpqV-GlKjekSVNQzukJPVBveXI82CvrpkvIL_ihGiEGcrJI4E4cEDTlZ8_oUAT1Ml9aNuae3aUN0gFuC3e7tWjPId_DTMGWtLb8gcTDiVaEOw, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1640915492, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.208.11, kc-type=Bearer, kc-cc--team-ID=x, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=192.168.208.1, http-session-id=DF8704B54E76556CED909118963CA7E9, http-session-last-accessed-time=1640915199390, kc-category-name=ACCESS, kc-iat=1640915192, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=192.168.208.1:64306 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2021-12-31 01:46:39.428  INFO 13 --- [nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Request context extracted
2021-12-31 01:46:39.438  INFO 13 --- [nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@77f348e2
2021-12-31 01:46:39.441  INFO 13 --- [nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@77f348e2
2021-12-31 01:46:39.489  INFO 13 --- [nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@77f348e2
2021-12-31 01:46:39.492  INFO 13 --- [nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@77f348e2
2021-12-31 01:46:39.520  INFO 13 --- [nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@77f348e2
2021-12-31 01:46:39.522  WARN 13 --- [nio-7071-exec-6] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: x
2021-12-31 01:46:39.526  WARN 13 --- [nio-7071-exec-6] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: x
2021-12-31 01:46:39.534  INFO 13 --- [nio-7071-exec-6] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-5993951762446-155500, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2021-12-31 01:46:39.538  INFO 13 --- [nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=b316ef57-97e5-4600-8a70-4d2a1e6aeb9b, content=DENY, timestamp=1640915199538, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2021-12-31 01:46:39.543  INFO 13 --- [nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=107ms, Total=129ms
2021-12-31 01:46:39.593  INFO 13 --- [nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=37dbb906-1037-453e-afe4-e6ae7a5c03a7, content=null, timestamp=1640915199581, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=64308, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=ab6fceaaf869, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=192.168.208.1, kc-session-state=ac73253f-28f7-4886-8ef5-3aa90a42f54f, http-req-server-port=80, http-header-accept=*/*, kc-id=e4473c87-b795-4333-8d39-d6ab32d6bf94, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1640915199578, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYc5iJHNxAH4AEQAAAABhzmD4dAAkZTQ0NzNjODctYjc5NS00MzMzLThkMzktZDZhYjMyZDZiZjk0dAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAXh4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRhYzczMjUzZi0yOGY3LTQ4ODYtOGVmNS0zYWE5MGE0MmY1NGZwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAATaHR0cDovLzE5Mi4xNjguMS44M3hwcHNyAC9vcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2VuJEFjY2VzcwewcQ/lekULAgACTAAFcm9sZXNxAH4AAUwADHZlcmlmeUNhbGxlcnEAfgAKeHBzcQB+ACt3DAAAABA/QAAAAAAABHQADm9mZmxpbmVfYWNjZXNzdAAGbWVtYmVydAAFYWRtaW50ABF1bWFfYXV0aG9yaXphdGlvbnhwc3IAF2phdmEudXRpbC5MaW5rZWRIYXNoTWFwNMBOXBBswPsCAAFaAAthY2Nlc3NPcmRlcnhxAH4AGD9AAAAAAAAMdwgAAAAQAAAAAXQAB2FjY291bnRzcQB+AC5zcQB+ACt3DAAAABA/QAAAAAAAA3QADm1hbmFnZS1hY2NvdW50dAAUbWFuYWdlLWFjY291bnQtbGlua3N0AAx2aWV3LXByb2ZpbGV4cHgAdAANcHJvZmlsZSBlbWFpbHA=, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJBcjkxZHNqZjlrTXBrNXU5VWJqclBicjYxSTBQNTlVNXlUeUY3NDRBNENJIn0.eyJleHAiOjE2NDA5MTU0OTIsImlhdCI6MTY0MDkxNTE5MiwianRpIjoiZTQ0NzNjODctYjc5NS00MzMzLThkMzktZDZhYjMyZDZiZjk0IiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiYWM3MzI1M2YtMjhmNy00ODg2LThlZjUtM2FhOTBhNDJmNTRmIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoieCJ9.rDIf9RLBcjr2qP5iz2oDw6OE3elFZfChlZdnKKwyecUS7iNaoa95QqyghoHGzaxjua5HQK04KRZh1VKQ36v1a6exy_Z6RkUOZCHfTdD7NLvUvdKmepPhsYBkBs4E94jPIq5Uxhv0Rx2oxkNCwYlL41_g7qAHlWWoeree0YrTOe9XEaqF-1U_TsY98CSbf4jCb7wANgsbB7Cu-7Z0VbrAdjGpw6yssQBFnquw3myY0XpqV-GlKjekSVNQzukJPVBveXI82CvrpkvIL_ihGiEGcrJI4E4cEDTlZ8_oUAT1Ml9aNuae3aUN0gFuC3e7tWjPId_DTMGWtLb8gcTDiVaEOw, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1640915492, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.208.11, kc-type=Bearer, kc-cc--team-ID=x, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=192.168.208.1, http-session-id=0233A3380174E32F12D46C1A57986E65, http-session-last-accessed-time=1640915199578, kc-category-name=ACCESS, kc-iat=1640915192, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=192.168.208.1:64308 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2021-12-31 01:46:39.597  INFO 13 --- [nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Request context extracted
2021-12-31 01:46:39.609  INFO 13 --- [nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@622b78be
2021-12-31 01:46:39.615  INFO 13 --- [nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@622b78be
2021-12-31 01:46:39.657  INFO 13 --- [nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@622b78be
2021-12-31 01:46:39.661  INFO 13 --- [nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@622b78be
2021-12-31 01:46:39.700  INFO 13 --- [nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@622b78be
2021-12-31 01:46:39.710  WARN 13 --- [nio-7071-exec-7] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: x
2021-12-31 01:46:39.713  WARN 13 --- [nio-7071-exec-7] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: x
2021-12-31 01:46:39.716  INFO 13 --- [nio-7071-exec-7] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-5994121204327-492709, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2021-12-31 01:46:39.718  INFO 13 --- [nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=37dbb906-1037-453e-afe4-e6ae7a5c03a7, content=DENY, timestamp=1640915199718, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2021-12-31 01:46:39.721  INFO 13 --- [nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=117ms, Total=130ms
2021-12-31 01:46:39.788  INFO 13 --- [nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=11e096a4-e52d-4083-8fea-21e8198df8bd, content=null, timestamp=1640915199777, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=64310, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=ab6fceaaf869, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=192.168.208.1, kc-session-state=ac73253f-28f7-4886-8ef5-3aa90a42f54f, http-req-server-port=80, http-header-accept=*/*, kc-id=e4473c87-b795-4333-8d39-d6ab32d6bf94, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1640915199770, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYc5iJHNxAH4AEQAAAABhzmD4dAAkZTQ0NzNjODctYjc5NS00MzMzLThkMzktZDZhYjMyZDZiZjk0dAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAXh4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRhYzczMjUzZi0yOGY3LTQ4ODYtOGVmNS0zYWE5MGE0MmY1NGZwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAATaHR0cDovLzE5Mi4xNjguMS44M3hwcHNyAC9vcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2VuJEFjY2VzcwewcQ/lekULAgACTAAFcm9sZXNxAH4AAUwADHZlcmlmeUNhbGxlcnEAfgAKeHBzcQB+ACt3DAAAABA/QAAAAAAABHQADm9mZmxpbmVfYWNjZXNzdAAGbWVtYmVydAAFYWRtaW50ABF1bWFfYXV0aG9yaXphdGlvbnhwc3IAF2phdmEudXRpbC5MaW5rZWRIYXNoTWFwNMBOXBBswPsCAAFaAAthY2Nlc3NPcmRlcnhxAH4AGD9AAAAAAAAMdwgAAAAQAAAAAXQAB2FjY291bnRzcQB+AC5zcQB+ACt3DAAAABA/QAAAAAAAA3QADm1hbmFnZS1hY2NvdW50dAAUbWFuYWdlLWFjY291bnQtbGlua3N0AAx2aWV3LXByb2ZpbGV4cHgAdAANcHJvZmlsZSBlbWFpbHA=, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJBcjkxZHNqZjlrTXBrNXU5VWJqclBicjYxSTBQNTlVNXlUeUY3NDRBNENJIn0.eyJleHAiOjE2NDA5MTU0OTIsImlhdCI6MTY0MDkxNTE5MiwianRpIjoiZTQ0NzNjODctYjc5NS00MzMzLThkMzktZDZhYjMyZDZiZjk0IiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiYWM3MzI1M2YtMjhmNy00ODg2LThlZjUtM2FhOTBhNDJmNTRmIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoieCJ9.rDIf9RLBcjr2qP5iz2oDw6OE3elFZfChlZdnKKwyecUS7iNaoa95QqyghoHGzaxjua5HQK04KRZh1VKQ36v1a6exy_Z6RkUOZCHfTdD7NLvUvdKmepPhsYBkBs4E94jPIq5Uxhv0Rx2oxkNCwYlL41_g7qAHlWWoeree0YrTOe9XEaqF-1U_TsY98CSbf4jCb7wANgsbB7Cu-7Z0VbrAdjGpw6yssQBFnquw3myY0XpqV-GlKjekSVNQzukJPVBveXI82CvrpkvIL_ihGiEGcrJI4E4cEDTlZ8_oUAT1Ml9aNuae3aUN0gFuC3e7tWjPId_DTMGWtLb8gcTDiVaEOw, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1640915492, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.208.11, kc-type=Bearer, kc-cc--team-ID=x, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=192.168.208.1, http-session-id=6961D3C910B8756B6F3B58C0AEA6E8D7, http-session-last-accessed-time=1640915199770, kc-category-name=ACCESS, kc-iat=1640915192, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=192.168.208.1:64310 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2021-12-31 01:46:39.794  INFO 13 --- [nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Request context extracted
2021-12-31 01:46:39.797  INFO 13 --- [nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3575248d
2021-12-31 01:46:39.799  INFO 13 --- [nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3575248d
2021-12-31 01:46:39.839  INFO 13 --- [nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3575248d
2021-12-31 01:46:39.841  INFO 13 --- [nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3575248d
2021-12-31 01:46:39.935  INFO 13 --- [nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3575248d
2021-12-31 01:46:39.938  WARN 13 --- [nio-7071-exec-8] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: x
2021-12-31 01:46:39.940  WARN 13 --- [nio-7071-exec-8] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: x
2021-12-31 01:46:39.949  INFO 13 --- [nio-7071-exec-8] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-5994316103075-311907, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2021-12-31 01:46:39.958  INFO 13 --- [nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=11e096a4-e52d-4083-8fea-21e8198df8bd, content=DENY, timestamp=1640915199958, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2021-12-31 01:46:39.962  INFO 13 --- [nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=162ms, Total=176ms
2021-12-31 01:46:40.046  INFO 13 --- [nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=4fc004f6-9ce9-4deb-82ea-89a43631c1ae, content=null, timestamp=1640915200037, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=64312, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=ab6fceaaf869, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=192.168.208.1, kc-session-state=ac73253f-28f7-4886-8ef5-3aa90a42f54f, http-req-server-port=80, http-header-accept=*/*, kc-id=e4473c87-b795-4333-8d39-d6ab32d6bf94, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1640915200033, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYc5iJHNxAH4AEQAAAABhzmD4dAAkZTQ0NzNjODctYjc5NS00MzMzLThkMzktZDZhYjMyZDZiZjk0dAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAXh4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRhYzczMjUzZi0yOGY3LTQ4ODYtOGVmNS0zYWE5MGE0MmY1NGZwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAATaHR0cDovLzE5Mi4xNjguMS44M3hwcHNyAC9vcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2VuJEFjY2VzcwewcQ/lekULAgACTAAFcm9sZXNxAH4AAUwADHZlcmlmeUNhbGxlcnEAfgAKeHBzcQB+ACt3DAAAABA/QAAAAAAABHQADm9mZmxpbmVfYWNjZXNzdAAGbWVtYmVydAAFYWRtaW50ABF1bWFfYXV0aG9yaXphdGlvbnhwc3IAF2phdmEudXRpbC5MaW5rZWRIYXNoTWFwNMBOXBBswPsCAAFaAAthY2Nlc3NPcmRlcnhxAH4AGD9AAAAAAAAMdwgAAAAQAAAAAXQAB2FjY291bnRzcQB+AC5zcQB+ACt3DAAAABA/QAAAAAAAA3QADm1hbmFnZS1hY2NvdW50dAAUbWFuYWdlLWFjY291bnQtbGlua3N0AAx2aWV3LXByb2ZpbGV4cHgAdAANcHJvZmlsZSBlbWFpbHA=, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJBcjkxZHNqZjlrTXBrNXU5VWJqclBicjYxSTBQNTlVNXlUeUY3NDRBNENJIn0.eyJleHAiOjE2NDA5MTU0OTIsImlhdCI6MTY0MDkxNTE5MiwianRpIjoiZTQ0NzNjODctYjc5NS00MzMzLThkMzktZDZhYjMyZDZiZjk0IiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiYWM3MzI1M2YtMjhmNy00ODg2LThlZjUtM2FhOTBhNDJmNTRmIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoieCJ9.rDIf9RLBcjr2qP5iz2oDw6OE3elFZfChlZdnKKwyecUS7iNaoa95QqyghoHGzaxjua5HQK04KRZh1VKQ36v1a6exy_Z6RkUOZCHfTdD7NLvUvdKmepPhsYBkBs4E94jPIq5Uxhv0Rx2oxkNCwYlL41_g7qAHlWWoeree0YrTOe9XEaqF-1U_TsY98CSbf4jCb7wANgsbB7Cu-7Z0VbrAdjGpw6yssQBFnquw3myY0XpqV-GlKjekSVNQzukJPVBveXI82CvrpkvIL_ihGiEGcrJI4E4cEDTlZ8_oUAT1Ml9aNuae3aUN0gFuC3e7tWjPId_DTMGWtLb8gcTDiVaEOw, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1640915492, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.208.11, kc-type=Bearer, kc-cc--team-ID=x, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=192.168.208.1, http-session-id=75DF2332E7AE8DF0A6BAB9662AA229D0, http-session-last-accessed-time=1640915200033, kc-category-name=ACCESS, kc-iat=1640915192, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=192.168.208.1:64312 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2021-12-31 01:46:40.050  INFO 13 --- [nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Request context extracted
2021-12-31 01:46:40.060  INFO 13 --- [nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2cf58b7
2021-12-31 01:46:40.063  INFO 13 --- [nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2cf58b7
2021-12-31 01:46:40.099  INFO 13 --- [nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2cf58b7
2021-12-31 01:46:40.106  INFO 13 --- [nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2cf58b7
2021-12-31 01:46:40.131  INFO 13 --- [nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2cf58b7
2021-12-31 01:46:40.134  WARN 13 --- [nio-7071-exec-9] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: x
2021-12-31 01:46:40.135  WARN 13 --- [nio-7071-exec-9] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: x
2021-12-31 01:46:40.139  INFO 13 --- [nio-7071-exec-9] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-5994578760415-859900, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2021-12-31 01:46:40.142  INFO 13 --- [nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=4fc004f6-9ce9-4deb-82ea-89a43631c1ae, content=DENY, timestamp=1640915200142, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2021-12-31 01:46:40.148  INFO 13 --- [nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=84ms, Total=104ms
2021-12-31 01:46:40.210  INFO 13 --- [io-7071-exec-10] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=683f5652-fa81-4320-88bf-18f5e7740fa6, content=null, timestamp=1640915200201, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=64314, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=ab6fceaaf869, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=192.168.208.1, kc-session-state=ac73253f-28f7-4886-8ef5-3aa90a42f54f, http-req-server-port=80, http-header-accept=*/*, kc-id=e4473c87-b795-4333-8d39-d6ab32d6bf94, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1640915200195, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYc5iJHNxAH4AEQAAAABhzmD4dAAkZTQ0NzNjODctYjc5NS00MzMzLThkMzktZDZhYjMyZDZiZjk0dAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAXh4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRhYzczMjUzZi0yOGY3LTQ4ODYtOGVmNS0zYWE5MGE0MmY1NGZwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAATaHR0cDovLzE5Mi4xNjguMS44M3hwcHNyAC9vcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2VuJEFjY2VzcwewcQ/lekULAgACTAAFcm9sZXNxAH4AAUwADHZlcmlmeUNhbGxlcnEAfgAKeHBzcQB+ACt3DAAAABA/QAAAAAAABHQADm9mZmxpbmVfYWNjZXNzdAAGbWVtYmVydAAFYWRtaW50ABF1bWFfYXV0aG9yaXphdGlvbnhwc3IAF2phdmEudXRpbC5MaW5rZWRIYXNoTWFwNMBOXBBswPsCAAFaAAthY2Nlc3NPcmRlcnhxAH4AGD9AAAAAAAAMdwgAAAAQAAAAAXQAB2FjY291bnRzcQB+AC5zcQB+ACt3DAAAABA/QAAAAAAAA3QADm1hbmFnZS1hY2NvdW50dAAUbWFuYWdlLWFjY291bnQtbGlua3N0AAx2aWV3LXByb2ZpbGV4cHgAdAANcHJvZmlsZSBlbWFpbHA=, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJBcjkxZHNqZjlrTXBrNXU5VWJqclBicjYxSTBQNTlVNXlUeUY3NDRBNENJIn0.eyJleHAiOjE2NDA5MTU0OTIsImlhdCI6MTY0MDkxNTE5MiwianRpIjoiZTQ0NzNjODctYjc5NS00MzMzLThkMzktZDZhYjMyZDZiZjk0IiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiYWM3MzI1M2YtMjhmNy00ODg2LThlZjUtM2FhOTBhNDJmNTRmIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoieCJ9.rDIf9RLBcjr2qP5iz2oDw6OE3elFZfChlZdnKKwyecUS7iNaoa95QqyghoHGzaxjua5HQK04KRZh1VKQ36v1a6exy_Z6RkUOZCHfTdD7NLvUvdKmepPhsYBkBs4E94jPIq5Uxhv0Rx2oxkNCwYlL41_g7qAHlWWoeree0YrTOe9XEaqF-1U_TsY98CSbf4jCb7wANgsbB7Cu-7Z0VbrAdjGpw6yssQBFnquw3myY0XpqV-GlKjekSVNQzukJPVBveXI82CvrpkvIL_ihGiEGcrJI4E4cEDTlZ8_oUAT1Ml9aNuae3aUN0gFuC3e7tWjPId_DTMGWtLb8gcTDiVaEOw, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1640915492, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.208.11, kc-type=Bearer, kc-cc--team-ID=x, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=192.168.208.1, http-session-id=46593D03131DA38EEE544B09CFE9C704, http-session-last-accessed-time=1640915200195, kc-category-name=ACCESS, kc-iat=1640915192, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=192.168.208.1:64314 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2021-12-31 01:46:40.217  INFO 13 --- [io-7071-exec-10] e.a.a.abac.server.PdpServerController    : Request context extracted
2021-12-31 01:46:40.222  INFO 13 --- [io-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@705348db
2021-12-31 01:46:40.227  INFO 13 --- [io-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@705348db
2021-12-31 01:46:40.257  INFO 13 --- [io-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@705348db
2021-12-31 01:46:40.260  INFO 13 --- [io-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@705348db
2021-12-31 01:46:40.289  INFO 13 --- [io-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@705348db
2021-12-31 01:46:40.293  WARN 13 --- [io-7071-exec-10] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: x
2021-12-31 01:46:40.297  WARN 13 --- [io-7071-exec-10] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: x
2021-12-31 01:46:40.304  INFO 13 --- [io-7071-exec-10] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-5994739971205-277072, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2021-12-31 01:46:40.306  INFO 13 --- [io-7071-exec-10] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=683f5652-fa81-4320-88bf-18f5e7740fa6, content=DENY, timestamp=1640915200306, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2021-12-31 01:46:40.310  INFO 13 --- [io-7071-exec-10] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=87ms, Total=102ms
2021-12-31 01:46:40.444  INFO 13 --- [nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=e4c389e6-ec28-4e4c-8205-11077a2a307e, content=null, timestamp=1640915200400, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=64316, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=ab6fceaaf869, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=192.168.208.1, kc-session-state=ac73253f-28f7-4886-8ef5-3aa90a42f54f, http-req-server-port=80, http-header-accept=*/*, kc-id=e4473c87-b795-4333-8d39-d6ab32d6bf94, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1640915200395, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYc5iJHNxAH4AEQAAAABhzmD4dAAkZTQ0NzNjODctYjc5NS00MzMzLThkMzktZDZhYjMyZDZiZjk0dAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAXh4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRhYzczMjUzZi0yOGY3LTQ4ODYtOGVmNS0zYWE5MGE0MmY1NGZwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAATaHR0cDovLzE5Mi4xNjguMS44M3hwcHNyAC9vcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2VuJEFjY2VzcwewcQ/lekULAgACTAAFcm9sZXNxAH4AAUwADHZlcmlmeUNhbGxlcnEAfgAKeHBzcQB+ACt3DAAAABA/QAAAAAAABHQADm9mZmxpbmVfYWNjZXNzdAAGbWVtYmVydAAFYWRtaW50ABF1bWFfYXV0aG9yaXphdGlvbnhwc3IAF2phdmEudXRpbC5MaW5rZWRIYXNoTWFwNMBOXBBswPsCAAFaAAthY2Nlc3NPcmRlcnhxAH4AGD9AAAAAAAAMdwgAAAAQAAAAAXQAB2FjY291bnRzcQB+AC5zcQB+ACt3DAAAABA/QAAAAAAAA3QADm1hbmFnZS1hY2NvdW50dAAUbWFuYWdlLWFjY291bnQtbGlua3N0AAx2aWV3LXByb2ZpbGV4cHgAdAANcHJvZmlsZSBlbWFpbHA=, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJBcjkxZHNqZjlrTXBrNXU5VWJqclBicjYxSTBQNTlVNXlUeUY3NDRBNENJIn0.eyJleHAiOjE2NDA5MTU0OTIsImlhdCI6MTY0MDkxNTE5MiwianRpIjoiZTQ0NzNjODctYjc5NS00MzMzLThkMzktZDZhYjMyZDZiZjk0IiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiYWM3MzI1M2YtMjhmNy00ODg2LThlZjUtM2FhOTBhNDJmNTRmIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoieCJ9.rDIf9RLBcjr2qP5iz2oDw6OE3elFZfChlZdnKKwyecUS7iNaoa95QqyghoHGzaxjua5HQK04KRZh1VKQ36v1a6exy_Z6RkUOZCHfTdD7NLvUvdKmepPhsYBkBs4E94jPIq5Uxhv0Rx2oxkNCwYlL41_g7qAHlWWoeree0YrTOe9XEaqF-1U_TsY98CSbf4jCb7wANgsbB7Cu-7Z0VbrAdjGpw6yssQBFnquw3myY0XpqV-GlKjekSVNQzukJPVBveXI82CvrpkvIL_ihGiEGcrJI4E4cEDTlZ8_oUAT1Ml9aNuae3aUN0gFuC3e7tWjPId_DTMGWtLb8gcTDiVaEOw, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1640915492, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.208.11, kc-type=Bearer, kc-cc--team-ID=x, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=192.168.208.1, http-session-id=A6663FCD60E78E05C8959142E21220EC, http-session-last-accessed-time=1640915200395, kc-category-name=ACCESS, kc-iat=1640915192, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=192.168.208.1:64316 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2021-12-31 01:46:40.452  INFO 13 --- [nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Request context extracted
2021-12-31 01:46:40.460  INFO 13 --- [nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@548cba2f
2021-12-31 01:46:40.467  INFO 13 --- [nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@548cba2f
2021-12-31 01:46:40.506  INFO 13 --- [nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@548cba2f
2021-12-31 01:46:40.510  INFO 13 --- [nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@548cba2f
2021-12-31 01:46:40.577  INFO 13 --- [nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@548cba2f
2021-12-31 01:46:40.579  WARN 13 --- [nio-7071-exec-1] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: x
2021-12-31 01:46:40.584  WARN 13 --- [nio-7071-exec-1] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: x
2021-12-31 01:46:40.588  INFO 13 --- [nio-7071-exec-1] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-5994977251671-655202, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2021-12-31 01:46:40.594  INFO 13 --- [nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=e4c389e6-ec28-4e4c-8205-11077a2a307e, content=DENY, timestamp=1640915200594, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2021-12-31 01:46:40.597  INFO 13 --- [nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=137ms, Total=171ms
2021-12-31 01:46:40.711  INFO 13 --- [nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=ce16fb74-03ca-4e9f-bb09-060348047a03, content=null, timestamp=1640915200689, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=64318, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=ab6fceaaf869, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=192.168.208.1, kc-session-state=ac73253f-28f7-4886-8ef5-3aa90a42f54f, http-req-server-port=80, http-header-accept=*/*, kc-id=e4473c87-b795-4333-8d39-d6ab32d6bf94, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1640915200666, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYc5iJHNxAH4AEQAAAABhzmD4dAAkZTQ0NzNjODctYjc5NS00MzMzLThkMzktZDZhYjMyZDZiZjk0dAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAXh4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRhYzczMjUzZi0yOGY3LTQ4ODYtOGVmNS0zYWE5MGE0MmY1NGZwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAATaHR0cDovLzE5Mi4xNjguMS44M3hwcHNyAC9vcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2VuJEFjY2VzcwewcQ/lekULAgACTAAFcm9sZXNxAH4AAUwADHZlcmlmeUNhbGxlcnEAfgAKeHBzcQB+ACt3DAAAABA/QAAAAAAABHQADm9mZmxpbmVfYWNjZXNzdAAGbWVtYmVydAAFYWRtaW50ABF1bWFfYXV0aG9yaXphdGlvbnhwc3IAF2phdmEudXRpbC5MaW5rZWRIYXNoTWFwNMBOXBBswPsCAAFaAAthY2Nlc3NPcmRlcnhxAH4AGD9AAAAAAAAMdwgAAAAQAAAAAXQAB2FjY291bnRzcQB+AC5zcQB+ACt3DAAAABA/QAAAAAAAA3QADm1hbmFnZS1hY2NvdW50dAAUbWFuYWdlLWFjY291bnQtbGlua3N0AAx2aWV3LXByb2ZpbGV4cHgAdAANcHJvZmlsZSBlbWFpbHA=, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJBcjkxZHNqZjlrTXBrNXU5VWJqclBicjYxSTBQNTlVNXlUeUY3NDRBNENJIn0.eyJleHAiOjE2NDA5MTU0OTIsImlhdCI6MTY0MDkxNTE5MiwianRpIjoiZTQ0NzNjODctYjc5NS00MzMzLThkMzktZDZhYjMyZDZiZjk0IiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiYWM3MzI1M2YtMjhmNy00ODg2LThlZjUtM2FhOTBhNDJmNTRmIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoieCJ9.rDIf9RLBcjr2qP5iz2oDw6OE3elFZfChlZdnKKwyecUS7iNaoa95QqyghoHGzaxjua5HQK04KRZh1VKQ36v1a6exy_Z6RkUOZCHfTdD7NLvUvdKmepPhsYBkBs4E94jPIq5Uxhv0Rx2oxkNCwYlL41_g7qAHlWWoeree0YrTOe9XEaqF-1U_TsY98CSbf4jCb7wANgsbB7Cu-7Z0VbrAdjGpw6yssQBFnquw3myY0XpqV-GlKjekSVNQzukJPVBveXI82CvrpkvIL_ihGiEGcrJI4E4cEDTlZ8_oUAT1Ml9aNuae3aUN0gFuC3e7tWjPId_DTMGWtLb8gcTDiVaEOw, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1640915492, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.208.11, kc-type=Bearer, kc-cc--team-ID=x, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=192.168.208.1, http-session-id=BF733A7C6BAAB34F0FAF0B732A2275B8, http-session-last-accessed-time=1640915200666, kc-category-name=ACCESS, kc-iat=1640915192, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=192.168.208.1:64318 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2021-12-31 01:46:40.715  INFO 13 --- [nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Request context extracted
2021-12-31 01:46:40.718  INFO 13 --- [nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7e66a706
2021-12-31 01:46:40.722  INFO 13 --- [nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7e66a706
2021-12-31 01:46:40.745  INFO 13 --- [nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7e66a706
2021-12-31 01:46:40.747  INFO 13 --- [nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7e66a706
2021-12-31 01:46:40.770  INFO 13 --- [nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7e66a706
2021-12-31 01:46:40.774  WARN 13 --- [nio-7071-exec-2] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: x
2021-12-31 01:46:40.777  WARN 13 --- [nio-7071-exec-2] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: x
2021-12-31 01:46:40.782  INFO 13 --- [nio-7071-exec-2] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-5995237526461-465366, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2021-12-31 01:46:40.785  INFO 13 --- [nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=ce16fb74-03ca-4e9f-bb09-060348047a03, content=DENY, timestamp=1640915200785, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2021-12-31 01:46:40.789  INFO 13 --- [nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=68ms, Total=80ms
2021-12-31 01:46:40.851  INFO 13 --- [nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=360a9450-7bf8-4c82-ac45-b3b0538185d4, content=null, timestamp=1640915200833, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=64320, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=ab6fceaaf869, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=192.168.208.1, kc-session-state=ac73253f-28f7-4886-8ef5-3aa90a42f54f, http-req-server-port=80, http-header-accept=*/*, kc-id=e4473c87-b795-4333-8d39-d6ab32d6bf94, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1640915200829, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYc5iJHNxAH4AEQAAAABhzmD4dAAkZTQ0NzNjODctYjc5NS00MzMzLThkMzktZDZhYjMyZDZiZjk0dAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAXh4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRhYzczMjUzZi0yOGY3LTQ4ODYtOGVmNS0zYWE5MGE0MmY1NGZwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAATaHR0cDovLzE5Mi4xNjguMS44M3hwcHNyAC9vcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2VuJEFjY2VzcwewcQ/lekULAgACTAAFcm9sZXNxAH4AAUwADHZlcmlmeUNhbGxlcnEAfgAKeHBzcQB+ACt3DAAAABA/QAAAAAAABHQADm9mZmxpbmVfYWNjZXNzdAAGbWVtYmVydAAFYWRtaW50ABF1bWFfYXV0aG9yaXphdGlvbnhwc3IAF2phdmEudXRpbC5MaW5rZWRIYXNoTWFwNMBOXBBswPsCAAFaAAthY2Nlc3NPcmRlcnhxAH4AGD9AAAAAAAAMdwgAAAAQAAAAAXQAB2FjY291bnRzcQB+AC5zcQB+ACt3DAAAABA/QAAAAAAAA3QADm1hbmFnZS1hY2NvdW50dAAUbWFuYWdlLWFjY291bnQtbGlua3N0AAx2aWV3LXByb2ZpbGV4cHgAdAANcHJvZmlsZSBlbWFpbHA=, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJBcjkxZHNqZjlrTXBrNXU5VWJqclBicjYxSTBQNTlVNXlUeUY3NDRBNENJIn0.eyJleHAiOjE2NDA5MTU0OTIsImlhdCI6MTY0MDkxNTE5MiwianRpIjoiZTQ0NzNjODctYjc5NS00MzMzLThkMzktZDZhYjMyZDZiZjk0IiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiYWM3MzI1M2YtMjhmNy00ODg2LThlZjUtM2FhOTBhNDJmNTRmIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoieCJ9.rDIf9RLBcjr2qP5iz2oDw6OE3elFZfChlZdnKKwyecUS7iNaoa95QqyghoHGzaxjua5HQK04KRZh1VKQ36v1a6exy_Z6RkUOZCHfTdD7NLvUvdKmepPhsYBkBs4E94jPIq5Uxhv0Rx2oxkNCwYlL41_g7qAHlWWoeree0YrTOe9XEaqF-1U_TsY98CSbf4jCb7wANgsbB7Cu-7Z0VbrAdjGpw6yssQBFnquw3myY0XpqV-GlKjekSVNQzukJPVBveXI82CvrpkvIL_ihGiEGcrJI4E4cEDTlZ8_oUAT1Ml9aNuae3aUN0gFuC3e7tWjPId_DTMGWtLb8gcTDiVaEOw, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1640915492, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.208.11, kc-type=Bearer, kc-cc--team-ID=x, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=192.168.208.1, http-session-id=0C073B280645A2862EEF8F423BD7DF46, http-session-last-accessed-time=1640915200829, kc-category-name=ACCESS, kc-iat=1640915192, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=192.168.208.1:64320 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2021-12-31 01:46:40.864  INFO 13 --- [nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Request context extracted
2021-12-31 01:46:40.867  INFO 13 --- [nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@21fdcc44
2021-12-31 01:46:40.870  INFO 13 --- [nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@21fdcc44
2021-12-31 01:46:40.895  INFO 13 --- [nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@21fdcc44
2021-12-31 01:46:40.900  INFO 13 --- [nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@21fdcc44
2021-12-31 01:46:40.925  INFO 13 --- [nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@21fdcc44
2021-12-31 01:46:40.931  WARN 13 --- [nio-7071-exec-3] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: x
2021-12-31 01:46:40.933  WARN 13 --- [nio-7071-exec-3] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: x
2021-12-31 01:46:40.936  INFO 13 --- [nio-7071-exec-3] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-5995386473761-824979, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2021-12-31 01:46:40.940  INFO 13 --- [nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=360a9450-7bf8-4c82-ac45-b3b0538185d4, content=DENY, timestamp=1640915200940, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2021-12-31 01:46:40.942  INFO 13 --- [nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=74ms, Total=94ms
2021-12-31 01:46:41.012  INFO 13 --- [nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=eb84f328-6282-4843-9ff9-56fa82fa8f03, content=null, timestamp=1640915200989, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=64322, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=ab6fceaaf869, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=192.168.208.1, kc-session-state=ac73253f-28f7-4886-8ef5-3aa90a42f54f, http-req-server-port=80, http-header-accept=*/*, kc-id=e4473c87-b795-4333-8d39-d6ab32d6bf94, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1640915200987, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYc5iJHNxAH4AEQAAAABhzmD4dAAkZTQ0NzNjODctYjc5NS00MzMzLThkMzktZDZhYjMyZDZiZjk0dAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAXh4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRhYzczMjUzZi0yOGY3LTQ4ODYtOGVmNS0zYWE5MGE0MmY1NGZwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAATaHR0cDovLzE5Mi4xNjguMS44M3hwcHNyAC9vcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2VuJEFjY2VzcwewcQ/lekULAgACTAAFcm9sZXNxAH4AAUwADHZlcmlmeUNhbGxlcnEAfgAKeHBzcQB+ACt3DAAAABA/QAAAAAAABHQADm9mZmxpbmVfYWNjZXNzdAAGbWVtYmVydAAFYWRtaW50ABF1bWFfYXV0aG9yaXphdGlvbnhwc3IAF2phdmEudXRpbC5MaW5rZWRIYXNoTWFwNMBOXBBswPsCAAFaAAthY2Nlc3NPcmRlcnhxAH4AGD9AAAAAAAAMdwgAAAAQAAAAAXQAB2FjY291bnRzcQB+AC5zcQB+ACt3DAAAABA/QAAAAAAAA3QADm1hbmFnZS1hY2NvdW50dAAUbWFuYWdlLWFjY291bnQtbGlua3N0AAx2aWV3LXByb2ZpbGV4cHgAdAANcHJvZmlsZSBlbWFpbHA=, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJBcjkxZHNqZjlrTXBrNXU5VWJqclBicjYxSTBQNTlVNXlUeUY3NDRBNENJIn0.eyJleHAiOjE2NDA5MTU0OTIsImlhdCI6MTY0MDkxNTE5MiwianRpIjoiZTQ0NzNjODctYjc5NS00MzMzLThkMzktZDZhYjMyZDZiZjk0IiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiYWM3MzI1M2YtMjhmNy00ODg2LThlZjUtM2FhOTBhNDJmNTRmIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoieCJ9.rDIf9RLBcjr2qP5iz2oDw6OE3elFZfChlZdnKKwyecUS7iNaoa95QqyghoHGzaxjua5HQK04KRZh1VKQ36v1a6exy_Z6RkUOZCHfTdD7NLvUvdKmepPhsYBkBs4E94jPIq5Uxhv0Rx2oxkNCwYlL41_g7qAHlWWoeree0YrTOe9XEaqF-1U_TsY98CSbf4jCb7wANgsbB7Cu-7Z0VbrAdjGpw6yssQBFnquw3myY0XpqV-GlKjekSVNQzukJPVBveXI82CvrpkvIL_ihGiEGcrJI4E4cEDTlZ8_oUAT1Ml9aNuae3aUN0gFuC3e7tWjPId_DTMGWtLb8gcTDiVaEOw, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1640915492, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.208.11, kc-type=Bearer, kc-cc--team-ID=x, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=192.168.208.1, http-session-id=8A8254F2E81ABDF115856BE7579C3B7F, http-session-last-accessed-time=1640915200987, kc-category-name=ACCESS, kc-iat=1640915192, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=192.168.208.1:64322 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2021-12-31 01:46:41.021  INFO 13 --- [nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Request context extracted
2021-12-31 01:46:41.029  INFO 13 --- [nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@600f7804
2021-12-31 01:46:41.031  INFO 13 --- [nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@600f7804
2021-12-31 01:46:41.061  INFO 13 --- [nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@600f7804
2021-12-31 01:46:41.073  INFO 13 --- [nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@600f7804
2021-12-31 01:46:41.181  INFO 13 --- [nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@600f7804
2021-12-31 01:46:41.185  WARN 13 --- [nio-7071-exec-4] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: x
2021-12-31 01:46:41.190  WARN 13 --- [nio-7071-exec-4] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: x
2021-12-31 01:46:41.194  INFO 13 --- [nio-7071-exec-4] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-5995543581474-166144, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2021-12-31 01:46:41.201  INFO 13 --- [nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=eb84f328-6282-4843-9ff9-56fa82fa8f03, content=DENY, timestamp=1640915201201, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2021-12-31 01:46:41.214  INFO 13 --- [nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=178ms, Total=208ms
2021-12-31 01:46:41.313  INFO 13 --- [nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=9aba6260-e374-4a4a-a764-36c665c0c0e9, content=null, timestamp=1640915201301, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=64324, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=ab6fceaaf869, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=192.168.208.1, kc-session-state=ac73253f-28f7-4886-8ef5-3aa90a42f54f, http-req-server-port=80, http-header-accept=*/*, kc-id=e4473c87-b795-4333-8d39-d6ab32d6bf94, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1640915201287, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYc5iJHNxAH4AEQAAAABhzmD4dAAkZTQ0NzNjODctYjc5NS00MzMzLThkMzktZDZhYjMyZDZiZjk0dAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAXh4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRhYzczMjUzZi0yOGY3LTQ4ODYtOGVmNS0zYWE5MGE0MmY1NGZwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAATaHR0cDovLzE5Mi4xNjguMS44M3hwcHNyAC9vcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2VuJEFjY2VzcwewcQ/lekULAgACTAAFcm9sZXNxAH4AAUwADHZlcmlmeUNhbGxlcnEAfgAKeHBzcQB+ACt3DAAAABA/QAAAAAAABHQADm9mZmxpbmVfYWNjZXNzdAAGbWVtYmVydAAFYWRtaW50ABF1bWFfYXV0aG9yaXphdGlvbnhwc3IAF2phdmEudXRpbC5MaW5rZWRIYXNoTWFwNMBOXBBswPsCAAFaAAthY2Nlc3NPcmRlcnhxAH4AGD9AAAAAAAAMdwgAAAAQAAAAAXQAB2FjY291bnRzcQB+AC5zcQB+ACt3DAAAABA/QAAAAAAAA3QADm1hbmFnZS1hY2NvdW50dAAUbWFuYWdlLWFjY291bnQtbGlua3N0AAx2aWV3LXByb2ZpbGV4cHgAdAANcHJvZmlsZSBlbWFpbHA=, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJBcjkxZHNqZjlrTXBrNXU5VWJqclBicjYxSTBQNTlVNXlUeUY3NDRBNENJIn0.eyJleHAiOjE2NDA5MTU0OTIsImlhdCI6MTY0MDkxNTE5MiwianRpIjoiZTQ0NzNjODctYjc5NS00MzMzLThkMzktZDZhYjMyZDZiZjk0IiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiYWM3MzI1M2YtMjhmNy00ODg2LThlZjUtM2FhOTBhNDJmNTRmIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoieCJ9.rDIf9RLBcjr2qP5iz2oDw6OE3elFZfChlZdnKKwyecUS7iNaoa95QqyghoHGzaxjua5HQK04KRZh1VKQ36v1a6exy_Z6RkUOZCHfTdD7NLvUvdKmepPhsYBkBs4E94jPIq5Uxhv0Rx2oxkNCwYlL41_g7qAHlWWoeree0YrTOe9XEaqF-1U_TsY98CSbf4jCb7wANgsbB7Cu-7Z0VbrAdjGpw6yssQBFnquw3myY0XpqV-GlKjekSVNQzukJPVBveXI82CvrpkvIL_ihGiEGcrJI4E4cEDTlZ8_oUAT1Ml9aNuae3aUN0gFuC3e7tWjPId_DTMGWtLb8gcTDiVaEOw, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1640915492, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.208.11, kc-type=Bearer, kc-cc--team-ID=x, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=192.168.208.1, http-session-id=5C0475116E7D6BD632B1CE5F54E959BE, http-session-last-accessed-time=1640915201287, kc-category-name=ACCESS, kc-iat=1640915192, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=192.168.208.1:64324 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2021-12-31 01:46:41.317  INFO 13 --- [nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Request context extracted
2021-12-31 01:46:41.322  INFO 13 --- [nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@55c1c292
2021-12-31 01:46:41.331  INFO 13 --- [nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@55c1c292
2021-12-31 01:46:41.400  INFO 13 --- [nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@55c1c292
2021-12-31 01:46:41.410  INFO 13 --- [nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@55c1c292
2021-12-31 01:46:41.441  INFO 13 --- [nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@55c1c292
2021-12-31 01:46:41.443  WARN 13 --- [nio-7071-exec-5] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: x
2021-12-31 01:46:41.445  WARN 13 --- [nio-7071-exec-5] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: x
2021-12-31 01:46:41.448  INFO 13 --- [nio-7071-exec-5] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-5995841067784-827452, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2021-12-31 01:46:41.450  INFO 13 --- [nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=9aba6260-e374-4a4a-a764-36c665c0c0e9, content=DENY, timestamp=1640915201450, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2021-12-31 01:46:41.454  INFO 13 --- [nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=129ms, Total=147ms
2021-12-31 01:46:41.564  INFO 13 --- [nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=056b16eb-00e2-442b-9b7b-eab2c27ae847, content=null, timestamp=1640915201532, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=64326, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=ab6fceaaf869, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=192.168.208.1, kc-session-state=ac73253f-28f7-4886-8ef5-3aa90a42f54f, http-req-server-port=80, http-header-accept=*/*, kc-id=e4473c87-b795-4333-8d39-d6ab32d6bf94, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1640915201514, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYc5iJHNxAH4AEQAAAABhzmD4dAAkZTQ0NzNjODctYjc5NS00MzMzLThkMzktZDZhYjMyZDZiZjk0dAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAXh4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRhYzczMjUzZi0yOGY3LTQ4ODYtOGVmNS0zYWE5MGE0MmY1NGZwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAATaHR0cDovLzE5Mi4xNjguMS44M3hwcHNyAC9vcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2VuJEFjY2VzcwewcQ/lekULAgACTAAFcm9sZXNxAH4AAUwADHZlcmlmeUNhbGxlcnEAfgAKeHBzcQB+ACt3DAAAABA/QAAAAAAABHQADm9mZmxpbmVfYWNjZXNzdAAGbWVtYmVydAAFYWRtaW50ABF1bWFfYXV0aG9yaXphdGlvbnhwc3IAF2phdmEudXRpbC5MaW5rZWRIYXNoTWFwNMBOXBBswPsCAAFaAAthY2Nlc3NPcmRlcnhxAH4AGD9AAAAAAAAMdwgAAAAQAAAAAXQAB2FjY291bnRzcQB+AC5zcQB+ACt3DAAAABA/QAAAAAAAA3QADm1hbmFnZS1hY2NvdW50dAAUbWFuYWdlLWFjY291bnQtbGlua3N0AAx2aWV3LXByb2ZpbGV4cHgAdAANcHJvZmlsZSBlbWFpbHA=, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJBcjkxZHNqZjlrTXBrNXU5VWJqclBicjYxSTBQNTlVNXlUeUY3NDRBNENJIn0.eyJleHAiOjE2NDA5MTU0OTIsImlhdCI6MTY0MDkxNTE5MiwianRpIjoiZTQ0NzNjODctYjc5NS00MzMzLThkMzktZDZhYjMyZDZiZjk0IiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiYWM3MzI1M2YtMjhmNy00ODg2LThlZjUtM2FhOTBhNDJmNTRmIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoieCJ9.rDIf9RLBcjr2qP5iz2oDw6OE3elFZfChlZdnKKwyecUS7iNaoa95QqyghoHGzaxjua5HQK04KRZh1VKQ36v1a6exy_Z6RkUOZCHfTdD7NLvUvdKmepPhsYBkBs4E94jPIq5Uxhv0Rx2oxkNCwYlL41_g7qAHlWWoeree0YrTOe9XEaqF-1U_TsY98CSbf4jCb7wANgsbB7Cu-7Z0VbrAdjGpw6yssQBFnquw3myY0XpqV-GlKjekSVNQzukJPVBveXI82CvrpkvIL_ihGiEGcrJI4E4cEDTlZ8_oUAT1Ml9aNuae3aUN0gFuC3e7tWjPId_DTMGWtLb8gcTDiVaEOw, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1640915492, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.208.11, kc-type=Bearer, kc-cc--team-ID=x, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=192.168.208.1, http-session-id=B683746B9DE71214ECCF45C609DDAC74, http-session-last-accessed-time=1640915201514, kc-category-name=ACCESS, kc-iat=1640915192, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=192.168.208.1:64326 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2021-12-31 01:46:41.571  INFO 13 --- [nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Request context extracted
2021-12-31 01:46:41.574  INFO 13 --- [nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@68d548ea
2021-12-31 01:46:41.576  INFO 13 --- [nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@68d548ea
2021-12-31 01:46:41.610  INFO 13 --- [nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@68d548ea
2021-12-31 01:46:41.614  INFO 13 --- [nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@68d548ea
2021-12-31 01:46:41.648  INFO 13 --- [nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@68d548ea
2021-12-31 01:46:41.651  WARN 13 --- [nio-7071-exec-6] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: x
2021-12-31 01:46:41.662  WARN 13 --- [nio-7071-exec-6] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: x
2021-12-31 01:46:41.665  INFO 13 --- [nio-7071-exec-6] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-5996093613917-796465, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2021-12-31 01:46:41.669  INFO 13 --- [nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=056b16eb-00e2-442b-9b7b-eab2c27ae847, content=DENY, timestamp=1640915201669, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2021-12-31 01:46:41.671  INFO 13 --- [nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=96ms, Total=109ms
2021-12-31 01:46:41.708  INFO 13 --- [nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=1855b5b4-12bc-4a53-b927-85da0165b0d4, content=null, timestamp=1640915201699, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=64328, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=ab6fceaaf869, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=192.168.208.1, kc-session-state=ac73253f-28f7-4886-8ef5-3aa90a42f54f, http-req-server-port=80, http-header-accept=*/*, kc-id=e4473c87-b795-4333-8d39-d6ab32d6bf94, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1640915201696, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYc5iJHNxAH4AEQAAAABhzmD4dAAkZTQ0NzNjODctYjc5NS00MzMzLThkMzktZDZhYjMyZDZiZjk0dAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAXh4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRhYzczMjUzZi0yOGY3LTQ4ODYtOGVmNS0zYWE5MGE0MmY1NGZwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAATaHR0cDovLzE5Mi4xNjguMS44M3hwcHNyAC9vcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2VuJEFjY2VzcwewcQ/lekULAgACTAAFcm9sZXNxAH4AAUwADHZlcmlmeUNhbGxlcnEAfgAKeHBzcQB+ACt3DAAAABA/QAAAAAAABHQADm9mZmxpbmVfYWNjZXNzdAAGbWVtYmVydAAFYWRtaW50ABF1bWFfYXV0aG9yaXphdGlvbnhwc3IAF2phdmEudXRpbC5MaW5rZWRIYXNoTWFwNMBOXBBswPsCAAFaAAthY2Nlc3NPcmRlcnhxAH4AGD9AAAAAAAAMdwgAAAAQAAAAAXQAB2FjY291bnRzcQB+AC5zcQB+ACt3DAAAABA/QAAAAAAAA3QADm1hbmFnZS1hY2NvdW50dAAUbWFuYWdlLWFjY291bnQtbGlua3N0AAx2aWV3LXByb2ZpbGV4cHgAdAANcHJvZmlsZSBlbWFpbHA=, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJBcjkxZHNqZjlrTXBrNXU5VWJqclBicjYxSTBQNTlVNXlUeUY3NDRBNENJIn0.eyJleHAiOjE2NDA5MTU0OTIsImlhdCI6MTY0MDkxNTE5MiwianRpIjoiZTQ0NzNjODctYjc5NS00MzMzLThkMzktZDZhYjMyZDZiZjk0IiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiYWM3MzI1M2YtMjhmNy00ODg2LThlZjUtM2FhOTBhNDJmNTRmIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoieCJ9.rDIf9RLBcjr2qP5iz2oDw6OE3elFZfChlZdnKKwyecUS7iNaoa95QqyghoHGzaxjua5HQK04KRZh1VKQ36v1a6exy_Z6RkUOZCHfTdD7NLvUvdKmepPhsYBkBs4E94jPIq5Uxhv0Rx2oxkNCwYlL41_g7qAHlWWoeree0YrTOe9XEaqF-1U_TsY98CSbf4jCb7wANgsbB7Cu-7Z0VbrAdjGpw6yssQBFnquw3myY0XpqV-GlKjekSVNQzukJPVBveXI82CvrpkvIL_ihGiEGcrJI4E4cEDTlZ8_oUAT1Ml9aNuae3aUN0gFuC3e7tWjPId_DTMGWtLb8gcTDiVaEOw, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1640915492, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.208.11, kc-type=Bearer, kc-cc--team-ID=x, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=192.168.208.1, http-session-id=52EAD4EBD13B415F2D6B2BCB472E020B, http-session-last-accessed-time=1640915201696, kc-category-name=ACCESS, kc-iat=1640915192, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=192.168.208.1:64328 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2021-12-31 01:46:41.712  INFO 13 --- [nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Request context extracted
2021-12-31 01:46:41.716  INFO 13 --- [nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6766e7db
2021-12-31 01:46:41.720  INFO 13 --- [nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6766e7db
2021-12-31 01:46:41.761  INFO 13 --- [nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6766e7db
2021-12-31 01:46:41.763  INFO 13 --- [nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6766e7db
2021-12-31 01:46:41.832  INFO 13 --- [nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6766e7db
2021-12-31 01:46:41.834  WARN 13 --- [nio-7071-exec-7] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: x
2021-12-31 01:46:41.836  WARN 13 --- [nio-7071-exec-7] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: x
2021-12-31 01:46:41.839  INFO 13 --- [nio-7071-exec-7] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-5996234331992-195707, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2021-12-31 01:46:41.841  INFO 13 --- [nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=1855b5b4-12bc-4a53-b927-85da0165b0d4, content=DENY, timestamp=1640915201841, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2021-12-31 01:46:41.846  INFO 13 --- [nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=127ms, Total=140ms
2021-12-31 01:46:41.935  INFO 13 --- [nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=6f950fe0-aee6-48d3-afe6-d052f214bc66, content=null, timestamp=1640915201896, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=64330, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=ab6fceaaf869, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=192.168.208.1, kc-session-state=ac73253f-28f7-4886-8ef5-3aa90a42f54f, http-req-server-port=80, http-header-accept=*/*, kc-id=e4473c87-b795-4333-8d39-d6ab32d6bf94, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1640915201884, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYc5iJHNxAH4AEQAAAABhzmD4dAAkZTQ0NzNjODctYjc5NS00MzMzLThkMzktZDZhYjMyZDZiZjk0dAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAXh4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRhYzczMjUzZi0yOGY3LTQ4ODYtOGVmNS0zYWE5MGE0MmY1NGZwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAATaHR0cDovLzE5Mi4xNjguMS44M3hwcHNyAC9vcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2VuJEFjY2VzcwewcQ/lekULAgACTAAFcm9sZXNxAH4AAUwADHZlcmlmeUNhbGxlcnEAfgAKeHBzcQB+ACt3DAAAABA/QAAAAAAABHQADm9mZmxpbmVfYWNjZXNzdAAGbWVtYmVydAAFYWRtaW50ABF1bWFfYXV0aG9yaXphdGlvbnhwc3IAF2phdmEudXRpbC5MaW5rZWRIYXNoTWFwNMBOXBBswPsCAAFaAAthY2Nlc3NPcmRlcnhxAH4AGD9AAAAAAAAMdwgAAAAQAAAAAXQAB2FjY291bnRzcQB+AC5zcQB+ACt3DAAAABA/QAAAAAAAA3QADm1hbmFnZS1hY2NvdW50dAAUbWFuYWdlLWFjY291bnQtbGlua3N0AAx2aWV3LXByb2ZpbGV4cHgAdAANcHJvZmlsZSBlbWFpbHA=, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJBcjkxZHNqZjlrTXBrNXU5VWJqclBicjYxSTBQNTlVNXlUeUY3NDRBNENJIn0.eyJleHAiOjE2NDA5MTU0OTIsImlhdCI6MTY0MDkxNTE5MiwianRpIjoiZTQ0NzNjODctYjc5NS00MzMzLThkMzktZDZhYjMyZDZiZjk0IiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiYWM3MzI1M2YtMjhmNy00ODg2LThlZjUtM2FhOTBhNDJmNTRmIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoieCJ9.rDIf9RLBcjr2qP5iz2oDw6OE3elFZfChlZdnKKwyecUS7iNaoa95QqyghoHGzaxjua5HQK04KRZh1VKQ36v1a6exy_Z6RkUOZCHfTdD7NLvUvdKmepPhsYBkBs4E94jPIq5Uxhv0Rx2oxkNCwYlL41_g7qAHlWWoeree0YrTOe9XEaqF-1U_TsY98CSbf4jCb7wANgsbB7Cu-7Z0VbrAdjGpw6yssQBFnquw3myY0XpqV-GlKjekSVNQzukJPVBveXI82CvrpkvIL_ihGiEGcrJI4E4cEDTlZ8_oUAT1Ml9aNuae3aUN0gFuC3e7tWjPId_DTMGWtLb8gcTDiVaEOw, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1640915492, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.208.11, kc-type=Bearer, kc-cc--team-ID=x, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=192.168.208.1, http-session-id=CF39AA512DA13FCB277EC04139A55FF5, http-session-last-accessed-time=1640915201884, kc-category-name=ACCESS, kc-iat=1640915192, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=192.168.208.1:64330 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2021-12-31 01:46:41.948  INFO 13 --- [nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Request context extracted
2021-12-31 01:46:41.955  INFO 13 --- [nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5e21ac5
2021-12-31 01:46:41.960  INFO 13 --- [nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5e21ac5
2021-12-31 01:46:42.001  INFO 13 --- [nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5e21ac5
2021-12-31 01:46:42.008  INFO 13 --- [nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5e21ac5
2021-12-31 01:46:42.045  INFO 13 --- [nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5e21ac5
2021-12-31 01:46:42.047  WARN 13 --- [nio-7071-exec-8] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: x
2021-12-31 01:46:42.051  WARN 13 --- [nio-7071-exec-8] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: x
2021-12-31 01:46:42.062  INFO 13 --- [nio-7071-exec-8] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-5996469798164-312437, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2021-12-31 01:46:42.065  INFO 13 --- [nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=6f950fe0-aee6-48d3-afe6-d052f214bc66, content=DENY, timestamp=1640915202065, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2021-12-31 01:46:42.069  INFO 13 --- [nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=116ms, Total=156ms
2021-12-31 01:46:42.207  INFO 13 --- [nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=b39a3432-96e5-4125-980e-5d05d36d7a81, content=null, timestamp=1640915202124, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=64332, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=ab6fceaaf869, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=192.168.208.1, kc-session-state=ac73253f-28f7-4886-8ef5-3aa90a42f54f, http-req-server-port=80, http-header-accept=*/*, kc-id=e4473c87-b795-4333-8d39-d6ab32d6bf94, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1640915202118, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYc5iJHNxAH4AEQAAAABhzmD4dAAkZTQ0NzNjODctYjc5NS00MzMzLThkMzktZDZhYjMyZDZiZjk0dAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAXh4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRhYzczMjUzZi0yOGY3LTQ4ODYtOGVmNS0zYWE5MGE0MmY1NGZwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAATaHR0cDovLzE5Mi4xNjguMS44M3hwcHNyAC9vcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2VuJEFjY2VzcwewcQ/lekULAgACTAAFcm9sZXNxAH4AAUwADHZlcmlmeUNhbGxlcnEAfgAKeHBzcQB+ACt3DAAAABA/QAAAAAAABHQADm9mZmxpbmVfYWNjZXNzdAAGbWVtYmVydAAFYWRtaW50ABF1bWFfYXV0aG9yaXphdGlvbnhwc3IAF2phdmEudXRpbC5MaW5rZWRIYXNoTWFwNMBOXBBswPsCAAFaAAthY2Nlc3NPcmRlcnhxAH4AGD9AAAAAAAAMdwgAAAAQAAAAAXQAB2FjY291bnRzcQB+AC5zcQB+ACt3DAAAABA/QAAAAAAAA3QADm1hbmFnZS1hY2NvdW50dAAUbWFuYWdlLWFjY291bnQtbGlua3N0AAx2aWV3LXByb2ZpbGV4cHgAdAANcHJvZmlsZSBlbWFpbHA=, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJBcjkxZHNqZjlrTXBrNXU5VWJqclBicjYxSTBQNTlVNXlUeUY3NDRBNENJIn0.eyJleHAiOjE2NDA5MTU0OTIsImlhdCI6MTY0MDkxNTE5MiwianRpIjoiZTQ0NzNjODctYjc5NS00MzMzLThkMzktZDZhYjMyZDZiZjk0IiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiYWM3MzI1M2YtMjhmNy00ODg2LThlZjUtM2FhOTBhNDJmNTRmIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoieCJ9.rDIf9RLBcjr2qP5iz2oDw6OE3elFZfChlZdnKKwyecUS7iNaoa95QqyghoHGzaxjua5HQK04KRZh1VKQ36v1a6exy_Z6RkUOZCHfTdD7NLvUvdKmepPhsYBkBs4E94jPIq5Uxhv0Rx2oxkNCwYlL41_g7qAHlWWoeree0YrTOe9XEaqF-1U_TsY98CSbf4jCb7wANgsbB7Cu-7Z0VbrAdjGpw6yssQBFnquw3myY0XpqV-GlKjekSVNQzukJPVBveXI82CvrpkvIL_ihGiEGcrJI4E4cEDTlZ8_oUAT1Ml9aNuae3aUN0gFuC3e7tWjPId_DTMGWtLb8gcTDiVaEOw, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1640915492, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.208.11, kc-type=Bearer, kc-cc--team-ID=x, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=192.168.208.1, http-session-id=732A23C57224F7DD21B3262A438DB7DE, http-session-last-accessed-time=1640915202118, kc-category-name=ACCESS, kc-iat=1640915192, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=192.168.208.1:64332 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2021-12-31 01:46:42.212  INFO 13 --- [nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Request context extracted
2021-12-31 01:46:42.217  INFO 13 --- [nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@b86dad9
2021-12-31 01:46:42.219  INFO 13 --- [nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@b86dad9
2021-12-31 01:46:42.268  INFO 13 --- [nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@b86dad9
2021-12-31 01:46:42.272  INFO 13 --- [nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@b86dad9
2021-12-31 01:46:42.308  INFO 13 --- [nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@b86dad9
2021-12-31 01:46:42.310  WARN 13 --- [nio-7071-exec-9] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: x
2021-12-31 01:46:42.314  WARN 13 --- [nio-7071-exec-9] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: x
2021-12-31 01:46:42.326  INFO 13 --- [nio-7071-exec-9] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-5996735772473-578164, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2021-12-31 01:46:42.329  INFO 13 --- [nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=b39a3432-96e5-4125-980e-5d05d36d7a81, content=DENY, timestamp=1640915202329, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2021-12-31 01:46:42.337  INFO 13 --- [nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=114ms, Total=181ms
2021-12-31 01:46:42.427  INFO 13 --- [io-7071-exec-10] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=de9ec616-b168-46d6-821c-ede06e6e67cf, content=null, timestamp=1640915202395, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=64334, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=ab6fceaaf869, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=192.168.208.1, kc-session-state=ac73253f-28f7-4886-8ef5-3aa90a42f54f, http-req-server-port=80, http-header-accept=*/*, kc-id=e4473c87-b795-4333-8d39-d6ab32d6bf94, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1640915202390, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYc5iJHNxAH4AEQAAAABhzmD4dAAkZTQ0NzNjODctYjc5NS00MzMzLThkMzktZDZhYjMyZDZiZjk0dAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAXh4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRhYzczMjUzZi0yOGY3LTQ4ODYtOGVmNS0zYWE5MGE0MmY1NGZwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAATaHR0cDovLzE5Mi4xNjguMS44M3hwcHNyAC9vcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2VuJEFjY2VzcwewcQ/lekULAgACTAAFcm9sZXNxAH4AAUwADHZlcmlmeUNhbGxlcnEAfgAKeHBzcQB+ACt3DAAAABA/QAAAAAAABHQADm9mZmxpbmVfYWNjZXNzdAAGbWVtYmVydAAFYWRtaW50ABF1bWFfYXV0aG9yaXphdGlvbnhwc3IAF2phdmEudXRpbC5MaW5rZWRIYXNoTWFwNMBOXBBswPsCAAFaAAthY2Nlc3NPcmRlcnhxAH4AGD9AAAAAAAAMdwgAAAAQAAAAAXQAB2FjY291bnRzcQB+AC5zcQB+ACt3DAAAABA/QAAAAAAAA3QADm1hbmFnZS1hY2NvdW50dAAUbWFuYWdlLWFjY291bnQtbGlua3N0AAx2aWV3LXByb2ZpbGV4cHgAdAANcHJvZmlsZSBlbWFpbHA=, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJBcjkxZHNqZjlrTXBrNXU5VWJqclBicjYxSTBQNTlVNXlUeUY3NDRBNENJIn0.eyJleHAiOjE2NDA5MTU0OTIsImlhdCI6MTY0MDkxNTE5MiwianRpIjoiZTQ0NzNjODctYjc5NS00MzMzLThkMzktZDZhYjMyZDZiZjk0IiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiYWM3MzI1M2YtMjhmNy00ODg2LThlZjUtM2FhOTBhNDJmNTRmIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoieCJ9.rDIf9RLBcjr2qP5iz2oDw6OE3elFZfChlZdnKKwyecUS7iNaoa95QqyghoHGzaxjua5HQK04KRZh1VKQ36v1a6exy_Z6RkUOZCHfTdD7NLvUvdKmepPhsYBkBs4E94jPIq5Uxhv0Rx2oxkNCwYlL41_g7qAHlWWoeree0YrTOe9XEaqF-1U_TsY98CSbf4jCb7wANgsbB7Cu-7Z0VbrAdjGpw6yssQBFnquw3myY0XpqV-GlKjekSVNQzukJPVBveXI82CvrpkvIL_ihGiEGcrJI4E4cEDTlZ8_oUAT1Ml9aNuae3aUN0gFuC3e7tWjPId_DTMGWtLb8gcTDiVaEOw, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1640915492, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.208.11, kc-type=Bearer, kc-cc--team-ID=x, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=192.168.208.1, http-session-id=AB1F00C9BEFB466A6E8800FF51FA10FB, http-session-last-accessed-time=1640915202390, kc-category-name=ACCESS, kc-iat=1640915192, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=192.168.208.1:64334 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2021-12-31 01:46:42.430  INFO 13 --- [io-7071-exec-10] e.a.a.abac.server.PdpServerController    : Request context extracted
2021-12-31 01:46:42.435  INFO 13 --- [io-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3889863c
2021-12-31 01:46:42.439  INFO 13 --- [io-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3889863c
2021-12-31 01:46:42.468  INFO 13 --- [io-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3889863c
2021-12-31 01:46:42.474  INFO 13 --- [io-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3889863c
2021-12-31 01:46:42.553  INFO 13 --- [io-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3889863c
2021-12-31 01:46:42.555  WARN 13 --- [io-7071-exec-10] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: x
2021-12-31 01:46:42.557  WARN 13 --- [io-7071-exec-10] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: x
2021-12-31 01:46:42.568  INFO 13 --- [io-7071-exec-10] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-5996952784673-534148, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2021-12-31 01:46:42.572  INFO 13 --- [io-7071-exec-10] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=de9ec616-b168-46d6-821c-ede06e6e67cf, content=DENY, timestamp=1640915202572, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2021-12-31 01:46:42.581  INFO 13 --- [io-7071-exec-10] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=140ms, Total=160ms
2021-12-31 01:46:42.663  INFO 13 --- [nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=f050384a-415c-4c93-a482-a04dfe6902ca, content=null, timestamp=1640915202640, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=64336, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=ab6fceaaf869, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=192.168.208.1, kc-session-state=ac73253f-28f7-4886-8ef5-3aa90a42f54f, http-req-server-port=80, http-header-accept=*/*, kc-id=e4473c87-b795-4333-8d39-d6ab32d6bf94, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1640915202624, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYc5iJHNxAH4AEQAAAABhzmD4dAAkZTQ0NzNjODctYjc5NS00MzMzLThkMzktZDZhYjMyZDZiZjk0dAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAXh4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRhYzczMjUzZi0yOGY3LTQ4ODYtOGVmNS0zYWE5MGE0MmY1NGZwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAATaHR0cDovLzE5Mi4xNjguMS44M3hwcHNyAC9vcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2VuJEFjY2VzcwewcQ/lekULAgACTAAFcm9sZXNxAH4AAUwADHZlcmlmeUNhbGxlcnEAfgAKeHBzcQB+ACt3DAAAABA/QAAAAAAABHQADm9mZmxpbmVfYWNjZXNzdAAGbWVtYmVydAAFYWRtaW50ABF1bWFfYXV0aG9yaXphdGlvbnhwc3IAF2phdmEudXRpbC5MaW5rZWRIYXNoTWFwNMBOXBBswPsCAAFaAAthY2Nlc3NPcmRlcnhxAH4AGD9AAAAAAAAMdwgAAAAQAAAAAXQAB2FjY291bnRzcQB+AC5zcQB+ACt3DAAAABA/QAAAAAAAA3QADm1hbmFnZS1hY2NvdW50dAAUbWFuYWdlLWFjY291bnQtbGlua3N0AAx2aWV3LXByb2ZpbGV4cHgAdAANcHJvZmlsZSBlbWFpbHA=, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJBcjkxZHNqZjlrTXBrNXU5VWJqclBicjYxSTBQNTlVNXlUeUY3NDRBNENJIn0.eyJleHAiOjE2NDA5MTU0OTIsImlhdCI6MTY0MDkxNTE5MiwianRpIjoiZTQ0NzNjODctYjc5NS00MzMzLThkMzktZDZhYjMyZDZiZjk0IiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiYWM3MzI1M2YtMjhmNy00ODg2LThlZjUtM2FhOTBhNDJmNTRmIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoieCJ9.rDIf9RLBcjr2qP5iz2oDw6OE3elFZfChlZdnKKwyecUS7iNaoa95QqyghoHGzaxjua5HQK04KRZh1VKQ36v1a6exy_Z6RkUOZCHfTdD7NLvUvdKmepPhsYBkBs4E94jPIq5Uxhv0Rx2oxkNCwYlL41_g7qAHlWWoeree0YrTOe9XEaqF-1U_TsY98CSbf4jCb7wANgsbB7Cu-7Z0VbrAdjGpw6yssQBFnquw3myY0XpqV-GlKjekSVNQzukJPVBveXI82CvrpkvIL_ihGiEGcrJI4E4cEDTlZ8_oUAT1Ml9aNuae3aUN0gFuC3e7tWjPId_DTMGWtLb8gcTDiVaEOw, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1640915492, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.208.11, kc-type=Bearer, kc-cc--team-ID=x, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=192.168.208.1, http-session-id=093D95B4B26ABC86D2A08335FACC6162, http-session-last-accessed-time=1640915202624, kc-category-name=ACCESS, kc-iat=1640915192, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=192.168.208.1:64336 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2021-12-31 01:46:42.675  INFO 13 --- [nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Request context extracted
2021-12-31 01:46:42.682  INFO 13 --- [nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@a36eb08
2021-12-31 01:46:42.684  INFO 13 --- [nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@a36eb08
2021-12-31 01:46:42.721  INFO 13 --- [nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@a36eb08
2021-12-31 01:46:42.728  INFO 13 --- [nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@a36eb08
2021-12-31 01:46:42.767  INFO 13 --- [nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@a36eb08
2021-12-31 01:46:42.770  WARN 13 --- [nio-7071-exec-1] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: x
2021-12-31 01:46:42.777  WARN 13 --- [nio-7071-exec-1] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: x
2021-12-31 01:46:42.783  INFO 13 --- [nio-7071-exec-1] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-5997198211024-690132, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2021-12-31 01:46:42.785  INFO 13 --- [nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=f050384a-415c-4c93-a482-a04dfe6902ca, content=DENY, timestamp=1640915202785, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2021-12-31 01:46:42.787  INFO 13 --- [nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=107ms, Total=136ms
2021-12-31 01:46:42.848  INFO 13 --- [nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=8c846995-3dc0-4591-811b-a8ba492d1b6b, content=null, timestamp=1640915202828, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=64338, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=ab6fceaaf869, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=192.168.208.1, kc-session-state=ac73253f-28f7-4886-8ef5-3aa90a42f54f, http-req-server-port=80, http-header-accept=*/*, kc-id=e4473c87-b795-4333-8d39-d6ab32d6bf94, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1640915202826, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYc5iJHNxAH4AEQAAAABhzmD4dAAkZTQ0NzNjODctYjc5NS00MzMzLThkMzktZDZhYjMyZDZiZjk0dAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAXh4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRhYzczMjUzZi0yOGY3LTQ4ODYtOGVmNS0zYWE5MGE0MmY1NGZwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAATaHR0cDovLzE5Mi4xNjguMS44M3hwcHNyAC9vcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2VuJEFjY2VzcwewcQ/lekULAgACTAAFcm9sZXNxAH4AAUwADHZlcmlmeUNhbGxlcnEAfgAKeHBzcQB+ACt3DAAAABA/QAAAAAAABHQADm9mZmxpbmVfYWNjZXNzdAAGbWVtYmVydAAFYWRtaW50ABF1bWFfYXV0aG9yaXphdGlvbnhwc3IAF2phdmEudXRpbC5MaW5rZWRIYXNoTWFwNMBOXBBswPsCAAFaAAthY2Nlc3NPcmRlcnhxAH4AGD9AAAAAAAAMdwgAAAAQAAAAAXQAB2FjY291bnRzcQB+AC5zcQB+ACt3DAAAABA/QAAAAAAAA3QADm1hbmFnZS1hY2NvdW50dAAUbWFuYWdlLWFjY291bnQtbGlua3N0AAx2aWV3LXByb2ZpbGV4cHgAdAANcHJvZmlsZSBlbWFpbHA=, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJBcjkxZHNqZjlrTXBrNXU5VWJqclBicjYxSTBQNTlVNXlUeUY3NDRBNENJIn0.eyJleHAiOjE2NDA5MTU0OTIsImlhdCI6MTY0MDkxNTE5MiwianRpIjoiZTQ0NzNjODctYjc5NS00MzMzLThkMzktZDZhYjMyZDZiZjk0IiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiYWM3MzI1M2YtMjhmNy00ODg2LThlZjUtM2FhOTBhNDJmNTRmIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoieCJ9.rDIf9RLBcjr2qP5iz2oDw6OE3elFZfChlZdnKKwyecUS7iNaoa95QqyghoHGzaxjua5HQK04KRZh1VKQ36v1a6exy_Z6RkUOZCHfTdD7NLvUvdKmepPhsYBkBs4E94jPIq5Uxhv0Rx2oxkNCwYlL41_g7qAHlWWoeree0YrTOe9XEaqF-1U_TsY98CSbf4jCb7wANgsbB7Cu-7Z0VbrAdjGpw6yssQBFnquw3myY0XpqV-GlKjekSVNQzukJPVBveXI82CvrpkvIL_ihGiEGcrJI4E4cEDTlZ8_oUAT1Ml9aNuae3aUN0gFuC3e7tWjPId_DTMGWtLb8gcTDiVaEOw, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1640915492, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.208.11, kc-type=Bearer, kc-cc--team-ID=x, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=192.168.208.1, http-session-id=FF32AABBAE24C336A49AC9D908B5D600, http-session-last-accessed-time=1640915202826, kc-category-name=ACCESS, kc-iat=1640915192, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=192.168.208.1:64338 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2021-12-31 01:46:42.855  INFO 13 --- [nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Request context extracted
2021-12-31 01:46:42.860  INFO 13 --- [nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6faa2255
2021-12-31 01:46:42.863  INFO 13 --- [nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6faa2255
2021-12-31 01:46:42.924  INFO 13 --- [nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6faa2255
2021-12-31 01:46:42.926  INFO 13 --- [nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6faa2255
2021-12-31 01:46:42.961  INFO 13 --- [nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6faa2255
2021-12-31 01:46:42.965  WARN 13 --- [nio-7071-exec-2] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: x
2021-12-31 01:46:42.968  WARN 13 --- [nio-7071-exec-2] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: x
2021-12-31 01:46:42.973  INFO 13 --- [nio-7071-exec-2] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-5997378365389-465529, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2021-12-31 01:46:42.977  INFO 13 --- [nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=8c846995-3dc0-4591-811b-a8ba492d1b6b, content=DENY, timestamp=1640915202977, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2021-12-31 01:46:42.980  INFO 13 --- [nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=119ms, Total=138ms
2021-12-31 01:46:43.055  INFO 13 --- [nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=86b7e0cc-822c-433e-b5e8-18e179b9e0a9, content=null, timestamp=1640915203026, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=64340, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=ab6fceaaf869, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=192.168.208.1, kc-session-state=ac73253f-28f7-4886-8ef5-3aa90a42f54f, http-req-server-port=80, http-header-accept=*/*, kc-id=e4473c87-b795-4333-8d39-d6ab32d6bf94, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1640915203018, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYc5iJHNxAH4AEQAAAABhzmD4dAAkZTQ0NzNjODctYjc5NS00MzMzLThkMzktZDZhYjMyZDZiZjk0dAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAXh4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRhYzczMjUzZi0yOGY3LTQ4ODYtOGVmNS0zYWE5MGE0MmY1NGZwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAATaHR0cDovLzE5Mi4xNjguMS44M3hwcHNyAC9vcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2VuJEFjY2VzcwewcQ/lekULAgACTAAFcm9sZXNxAH4AAUwADHZlcmlmeUNhbGxlcnEAfgAKeHBzcQB+ACt3DAAAABA/QAAAAAAABHQADm9mZmxpbmVfYWNjZXNzdAAGbWVtYmVydAAFYWRtaW50ABF1bWFfYXV0aG9yaXphdGlvbnhwc3IAF2phdmEudXRpbC5MaW5rZWRIYXNoTWFwNMBOXBBswPsCAAFaAAthY2Nlc3NPcmRlcnhxAH4AGD9AAAAAAAAMdwgAAAAQAAAAAXQAB2FjY291bnRzcQB+AC5zcQB+ACt3DAAAABA/QAAAAAAAA3QADm1hbmFnZS1hY2NvdW50dAAUbWFuYWdlLWFjY291bnQtbGlua3N0AAx2aWV3LXByb2ZpbGV4cHgAdAANcHJvZmlsZSBlbWFpbHA=, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJBcjkxZHNqZjlrTXBrNXU5VWJqclBicjYxSTBQNTlVNXlUeUY3NDRBNENJIn0.eyJleHAiOjE2NDA5MTU0OTIsImlhdCI6MTY0MDkxNTE5MiwianRpIjoiZTQ0NzNjODctYjc5NS00MzMzLThkMzktZDZhYjMyZDZiZjk0IiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiYWM3MzI1M2YtMjhmNy00ODg2LThlZjUtM2FhOTBhNDJmNTRmIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoieCJ9.rDIf9RLBcjr2qP5iz2oDw6OE3elFZfChlZdnKKwyecUS7iNaoa95QqyghoHGzaxjua5HQK04KRZh1VKQ36v1a6exy_Z6RkUOZCHfTdD7NLvUvdKmepPhsYBkBs4E94jPIq5Uxhv0Rx2oxkNCwYlL41_g7qAHlWWoeree0YrTOe9XEaqF-1U_TsY98CSbf4jCb7wANgsbB7Cu-7Z0VbrAdjGpw6yssQBFnquw3myY0XpqV-GlKjekSVNQzukJPVBveXI82CvrpkvIL_ihGiEGcrJI4E4cEDTlZ8_oUAT1Ml9aNuae3aUN0gFuC3e7tWjPId_DTMGWtLb8gcTDiVaEOw, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1640915492, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.208.11, kc-type=Bearer, kc-cc--team-ID=x, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=192.168.208.1, http-session-id=2F9D8A292A03005D48FC49B551F0C260, http-session-last-accessed-time=1640915203018, kc-category-name=ACCESS, kc-iat=1640915192, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=192.168.208.1:64340 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2021-12-31 01:46:43.071  INFO 13 --- [nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Request context extracted
2021-12-31 01:46:43.075  INFO 13 --- [nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@32ba8b4d
2021-12-31 01:46:43.081  INFO 13 --- [nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@32ba8b4d
2021-12-31 01:46:43.113  INFO 13 --- [nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@32ba8b4d
2021-12-31 01:46:43.120  INFO 13 --- [nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@32ba8b4d
2021-12-31 01:46:43.186  INFO 13 --- [nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@32ba8b4d
2021-12-31 01:46:43.190  WARN 13 --- [nio-7071-exec-3] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: x
2021-12-31 01:46:43.192  WARN 13 --- [nio-7071-exec-3] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: x
2021-12-31 01:46:43.196  INFO 13 --- [nio-7071-exec-3] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-5997593879600-478232, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2021-12-31 01:46:43.198  INFO 13 --- [nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=86b7e0cc-822c-433e-b5e8-18e179b9e0a9, content=DENY, timestamp=1640915203198, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2021-12-31 01:46:43.202  INFO 13 --- [nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=125ms, Total=157ms
2021-12-31 01:46:43.262  INFO 13 --- [nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=f79ebab8-5358-43ec-9ba8-a489c4fa5839, content=null, timestamp=1640915203235, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=64342, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=ab6fceaaf869, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=192.168.208.1, kc-session-state=ac73253f-28f7-4886-8ef5-3aa90a42f54f, http-req-server-port=80, http-header-accept=*/*, kc-id=e4473c87-b795-4333-8d39-d6ab32d6bf94, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1640915203233, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYc5iJHNxAH4AEQAAAABhzmD4dAAkZTQ0NzNjODctYjc5NS00MzMzLThkMzktZDZhYjMyZDZiZjk0dAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAXh4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRhYzczMjUzZi0yOGY3LTQ4ODYtOGVmNS0zYWE5MGE0MmY1NGZwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAATaHR0cDovLzE5Mi4xNjguMS44M3hwcHNyAC9vcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2VuJEFjY2VzcwewcQ/lekULAgACTAAFcm9sZXNxAH4AAUwADHZlcmlmeUNhbGxlcnEAfgAKeHBzcQB+ACt3DAAAABA/QAAAAAAABHQADm9mZmxpbmVfYWNjZXNzdAAGbWVtYmVydAAFYWRtaW50ABF1bWFfYXV0aG9yaXphdGlvbnhwc3IAF2phdmEudXRpbC5MaW5rZWRIYXNoTWFwNMBOXBBswPsCAAFaAAthY2Nlc3NPcmRlcnhxAH4AGD9AAAAAAAAMdwgAAAAQAAAAAXQAB2FjY291bnRzcQB+AC5zcQB+ACt3DAAAABA/QAAAAAAAA3QADm1hbmFnZS1hY2NvdW50dAAUbWFuYWdlLWFjY291bnQtbGlua3N0AAx2aWV3LXByb2ZpbGV4cHgAdAANcHJvZmlsZSBlbWFpbHA=, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJBcjkxZHNqZjlrTXBrNXU5VWJqclBicjYxSTBQNTlVNXlUeUY3NDRBNENJIn0.eyJleHAiOjE2NDA5MTU0OTIsImlhdCI6MTY0MDkxNTE5MiwianRpIjoiZTQ0NzNjODctYjc5NS00MzMzLThkMzktZDZhYjMyZDZiZjk0IiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiYWM3MzI1M2YtMjhmNy00ODg2LThlZjUtM2FhOTBhNDJmNTRmIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoieCJ9.rDIf9RLBcjr2qP5iz2oDw6OE3elFZfChlZdnKKwyecUS7iNaoa95QqyghoHGzaxjua5HQK04KRZh1VKQ36v1a6exy_Z6RkUOZCHfTdD7NLvUvdKmepPhsYBkBs4E94jPIq5Uxhv0Rx2oxkNCwYlL41_g7qAHlWWoeree0YrTOe9XEaqF-1U_TsY98CSbf4jCb7wANgsbB7Cu-7Z0VbrAdjGpw6yssQBFnquw3myY0XpqV-GlKjekSVNQzukJPVBveXI82CvrpkvIL_ihGiEGcrJI4E4cEDTlZ8_oUAT1Ml9aNuae3aUN0gFuC3e7tWjPId_DTMGWtLb8gcTDiVaEOw, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1640915492, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.208.11, kc-type=Bearer, kc-cc--team-ID=x, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=192.168.208.1, http-session-id=212656A70FB2C819548E5638D76B5206, http-session-last-accessed-time=1640915203233, kc-category-name=ACCESS, kc-iat=1640915192, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=192.168.208.1:64342 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2021-12-31 01:46:43.268  INFO 13 --- [nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Request context extracted
2021-12-31 01:46:43.271  INFO 13 --- [nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@54c94f0e
2021-12-31 01:46:43.274  INFO 13 --- [nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@54c94f0e
2021-12-31 01:46:43.303  INFO 13 --- [nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@54c94f0e
2021-12-31 01:46:43.307  INFO 13 --- [nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@54c94f0e
2021-12-31 01:46:43.331  INFO 13 --- [nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@54c94f0e
2021-12-31 01:46:43.333  WARN 13 --- [nio-7071-exec-4] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: x
2021-12-31 01:46:43.334  WARN 13 --- [nio-7071-exec-4] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: x
2021-12-31 01:46:43.342  INFO 13 --- [nio-7071-exec-4] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-5997790427057-398557, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2021-12-31 01:46:43.345  INFO 13 --- [nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=f79ebab8-5358-43ec-9ba8-a489c4fa5839, content=DENY, timestamp=1640915203345, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2021-12-31 01:46:43.348  INFO 13 --- [nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=75ms, Total=98ms
2021-12-31 01:46:43.425  INFO 13 --- [nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=a325bbab-de5e-4849-8fbb-f3392ffd749e, content=null, timestamp=1640915203394, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=64344, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=ab6fceaaf869, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=192.168.208.1, kc-session-state=ac73253f-28f7-4886-8ef5-3aa90a42f54f, http-req-server-port=80, http-header-accept=*/*, kc-id=e4473c87-b795-4333-8d39-d6ab32d6bf94, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1640915203380, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYc5iJHNxAH4AEQAAAABhzmD4dAAkZTQ0NzNjODctYjc5NS00MzMzLThkMzktZDZhYjMyZDZiZjk0dAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAXh4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACRhYzczMjUzZi0yOGY3LTQ4ODYtOGVmNS0zYWE5MGE0MmY1NGZwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAATaHR0cDovLzE5Mi4xNjguMS44M3hwcHNyAC9vcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2VuJEFjY2VzcwewcQ/lekULAgACTAAFcm9sZXNxAH4AAUwADHZlcmlmeUNhbGxlcnEAfgAKeHBzcQB+ACt3DAAAABA/QAAAAAAABHQADm9mZmxpbmVfYWNjZXNzdAAGbWVtYmVydAAFYWRtaW50ABF1bWFfYXV0aG9yaXphdGlvbnhwc3IAF2phdmEudXRpbC5MaW5rZWRIYXNoTWFwNMBOXBBswPsCAAFaAAthY2Nlc3NPcmRlcnhxAH4AGD9AAAAAAAAMdwgAAAAQAAAAAXQAB2FjY291bnRzcQB+AC5zcQB+ACt3DAAAABA/QAAAAAAAA3QADm1hbmFnZS1hY2NvdW50dAAUbWFuYWdlLWFjY291bnQtbGlua3N0AAx2aWV3LXByb2ZpbGV4cHgAdAANcHJvZmlsZSBlbWFpbHA=, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJBcjkxZHNqZjlrTXBrNXU5VWJqclBicjYxSTBQNTlVNXlUeUY3NDRBNENJIn0.eyJleHAiOjE2NDA5MTU0OTIsImlhdCI6MTY0MDkxNTE5MiwianRpIjoiZTQ0NzNjODctYjc5NS00MzMzLThkMzktZDZhYjMyZDZiZjk0IiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiYWM3MzI1M2YtMjhmNy00ODg2LThlZjUtM2FhOTBhNDJmNTRmIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoieCJ9.rDIf9RLBcjr2qP5iz2oDw6OE3elFZfChlZdnKKwyecUS7iNaoa95QqyghoHGzaxjua5HQK04KRZh1VKQ36v1a6exy_Z6RkUOZCHfTdD7NLvUvdKmepPhsYBkBs4E94jPIq5Uxhv0Rx2oxkNCwYlL41_g7qAHlWWoeree0YrTOe9XEaqF-1U_TsY98CSbf4jCb7wANgsbB7Cu-7Z0VbrAdjGpw6yssQBFnquw3myY0XpqV-GlKjekSVNQzukJPVBveXI82CvrpkvIL_ihGiEGcrJI4E4cEDTlZ8_oUAT1Ml9aNuae3aUN0gFuC3e7tWjPId_DTMGWtLb8gcTDiVaEOw, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1640915492, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=192.168.208.11, kc-type=Bearer, kc-cc--team-ID=x, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=192.168.208.1, http-session-id=1CB2A654446CA02113EC2F385FECBED0, http-session-last-accessed-time=1640915203380, kc-category-name=ACCESS, kc-iat=1640915192, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=192.168.208.1:64344 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2021-12-31 01:46:43.434  INFO 13 --- [nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Request context extracted
2021-12-31 01:46:43.437  INFO 13 --- [nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1c5da820
2021-12-31 01:46:43.441  INFO 13 --- [nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1c5da820
2021-12-31 01:46:43.471  INFO 13 --- [nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1c5da820
2021-12-31 01:46:43.478  INFO 13 --- [nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1c5da820
2021-12-31 01:46:43.521  INFO 13 --- [nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1c5da820
2021-12-31 01:46:43.525  WARN 13 --- [nio-7071-exec-5] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: x
2021-12-31 01:46:43.527  WARN 13 --- [nio-7071-exec-5] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: x
2021-12-31 01:46:43.536  INFO 13 --- [nio-7071-exec-5] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-5997956478927-772485, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2021-12-31 01:46:43.542  INFO 13 --- [nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=a325bbab-de5e-4849-8fbb-f3392ffd749e, content=DENY, timestamp=1640915203542, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2021-12-31 01:46:43.549  INFO 13 --- [nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=106ms, Total=150ms
