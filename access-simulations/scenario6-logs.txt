Durations for: Evaluation=190ms, Total=220ms
2022-01-11 13:11:41.284  INFO 17 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=25abb2d1-1f24-4aa9-a52c-bd1eba51dfd4, content=null, timestamp=1641906701243, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=65448, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=9462ddf72b74, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.30.0.1, kc-session-state=115df91e-55fd-4d89-b568-03753c55dee3, http-req-server-port=80, http-header-accept=*/*, kc-id=faa49035-39a2-47eb-9400-cb93a9fe6d10, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641906701236, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd2DNXNxAH4AEQAAAABh3YIJdAAkZmFhNDkwMzUtMzlhMi00N2ViLTk0MDAtY2I5M2E5ZmU2ZDEwdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAXh4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQxMTVkZjkxZS01NWZkLTRkODktYjU2OC0wMzc1M2M1NWRlZTNwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAATaHR0cDovLzE5Mi4xNjguMS44M3hwcHNyAC9vcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2VuJEFjY2VzcwewcQ/lekULAgACTAAFcm9sZXNxAH4AAUwADHZlcmlmeUNhbGxlcnEAfgAKeHBzcQB+ACt3DAAAABA/QAAAAAAABHQADm9mZmxpbmVfYWNjZXNzdAAGbWVtYmVydAAFYWRtaW50ABF1bWFfYXV0aG9yaXphdGlvbnhwc3IAF2phdmEudXRpbC5MaW5rZWRIYXNoTWFwNMBOXBBswPsCAAFaAAthY2Nlc3NPcmRlcnhxAH4AGD9AAAAAAAAMdwgAAAAQAAAAAXQAB2FjY291bnRzcQB+AC5zcQB+ACt3DAAAABA/QAAAAAAAA3QADm1hbmFnZS1hY2NvdW50dAAUbWFuYWdlLWFjY291bnQtbGlua3N0AAx2aWV3LXByb2ZpbGV4cHgAdAANcHJvZmlsZSBlbWFpbHA=, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJFeUZNQnpQUXV6VFFHUzhnWjYwVjJ1LXZxUE4zYm55MFVJSm1HaUpwS2pFIn0.eyJleHAiOjE2NDE5MDY5OTcsImlhdCI6MTY0MTkwNjY5NywianRpIjoiZmFhNDkwMzUtMzlhMi00N2ViLTk0MDAtY2I5M2E5ZmU2ZDEwIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiMTE1ZGY5MWUtNTVmZC00ZDg5LWI1NjgtMDM3NTNjNTVkZWUzIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoieCJ9.RP4jVdLa2GKR1jEUG_Ofs1jSfGSuf9hAaf2-j4R2AHCcLlwOZHQfjtGK56y9rw6Mc7yt4IuTEGT3_0YWpF73nJ5N36X7TcZC0389FvX0FvP5331H4S5EVmOJ7FyGpOHtmkLRXz4dfExVXoNmkyd6BrqB07pTnpObzqEyYxOX88fWlUjDk6RWTDWCykBixaI76kAACr7cHj6JEN_a2AkEpMI4HkZGWG0JnCqZkydE2kfceTUd-pP22WGrHs60GjudxqXJPsI90ESRgnEUGmuXiI5VgPtS_v89gz7KsuRr6RElEpCzvTqNDGXjy8OX7Zi59gzgqCzdmHhL_CD_-QqTiA, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641906997, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=172.30.0.12, kc-type=Bearer, kc-cc--team-ID=x, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.30.0.1, http-session-id=F109AA10A3447AAA4A4A03D85FFBAA73, http-session-last-accessed-time=1641906701236, kc-category-name=ACCESS, kc-iat=1641906697, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.30.0.1:65448 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 13:11:41.308  INFO 17 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 13:11:41.320  INFO 17 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1d113ef3
2022-01-11 13:11:41.331  INFO 17 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1d113ef3
2022-01-11 13:11:41.370  INFO 17 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1d113ef3
2022-01-11 13:11:41.374  INFO 17 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1d113ef3
2022-01-11 13:11:41.457  INFO 17 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1d113ef3
2022-01-11 13:11:41.464  WARN 17 --- [https-jsse-nio-7071-exec-8] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: x
2022-01-11 13:11:41.468  WARN 17 --- [https-jsse-nio-7071-exec-8] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: x
2022-01-11 13:11:41.475  INFO 17 --- [https-jsse-nio-7071-exec-8] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-5882162863475-215418, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-11 13:11:41.477  INFO 17 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=25abb2d1-1f24-4aa9-a52c-bd1eba51dfd4, content=DENY, timestamp=1641906701477, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-11 13:11:41.481  INFO 17 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=164ms, Total=198ms
2022-01-11 13:11:41.564  INFO 17 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=04af10c1-e539-43b7-a8fd-8a4f76cc5018, content=null, timestamp=1641906701550, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=65450, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=9462ddf72b74, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.30.0.1, kc-session-state=115df91e-55fd-4d89-b568-03753c55dee3, http-req-server-port=80, http-header-accept=*/*, kc-id=faa49035-39a2-47eb-9400-cb93a9fe6d10, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641906701534, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd2DNXNxAH4AEQAAAABh3YIJdAAkZmFhNDkwMzUtMzlhMi00N2ViLTk0MDAtY2I5M2E5ZmU2ZDEwdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAXh4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQxMTVkZjkxZS01NWZkLTRkODktYjU2OC0wMzc1M2M1NWRlZTNwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAATaHR0cDovLzE5Mi4xNjguMS44M3hwcHNyAC9vcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2VuJEFjY2VzcwewcQ/lekULAgACTAAFcm9sZXNxAH4AAUwADHZlcmlmeUNhbGxlcnEAfgAKeHBzcQB+ACt3DAAAABA/QAAAAAAABHQADm9mZmxpbmVfYWNjZXNzdAAGbWVtYmVydAAFYWRtaW50ABF1bWFfYXV0aG9yaXphdGlvbnhwc3IAF2phdmEudXRpbC5MaW5rZWRIYXNoTWFwNMBOXBBswPsCAAFaAAthY2Nlc3NPcmRlcnhxAH4AGD9AAAAAAAAMdwgAAAAQAAAAAXQAB2FjY291bnRzcQB+AC5zcQB+ACt3DAAAABA/QAAAAAAAA3QADm1hbmFnZS1hY2NvdW50dAAUbWFuYWdlLWFjY291bnQtbGlua3N0AAx2aWV3LXByb2ZpbGV4cHgAdAANcHJvZmlsZSBlbWFpbHA=, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJFeUZNQnpQUXV6VFFHUzhnWjYwVjJ1LXZxUE4zYm55MFVJSm1HaUpwS2pFIn0.eyJleHAiOjE2NDE5MDY5OTcsImlhdCI6MTY0MTkwNjY5NywianRpIjoiZmFhNDkwMzUtMzlhMi00N2ViLTk0MDAtY2I5M2E5ZmU2ZDEwIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiMTE1ZGY5MWUtNTVmZC00ZDg5LWI1NjgtMDM3NTNjNTVkZWUzIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoieCJ9.RP4jVdLa2GKR1jEUG_Ofs1jSfGSuf9hAaf2-j4R2AHCcLlwOZHQfjtGK56y9rw6Mc7yt4IuTEGT3_0YWpF73nJ5N36X7TcZC0389FvX0FvP5331H4S5EVmOJ7FyGpOHtmkLRXz4dfExVXoNmkyd6BrqB07pTnpObzqEyYxOX88fWlUjDk6RWTDWCykBixaI76kAACr7cHj6JEN_a2AkEpMI4HkZGWG0JnCqZkydE2kfceTUd-pP22WGrHs60GjudxqXJPsI90ESRgnEUGmuXiI5VgPtS_v89gz7KsuRr6RElEpCzvTqNDGXjy8OX7Zi59gzgqCzdmHhL_CD_-QqTiA, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641906997, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=172.30.0.12, kc-type=Bearer, kc-cc--team-ID=x, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.30.0.1, http-session-id=A718AD8CD0C96538EF3792D5C86039A2, http-session-last-accessed-time=1641906701534, kc-category-name=ACCESS, kc-iat=1641906697, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.30.0.1:65450 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 13:11:41.575  INFO 17 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 13:11:41.599  INFO 17 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@295ba4fc
2022-01-11 13:11:41.604  INFO 17 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@295ba4fc
2022-01-11 13:11:41.656  INFO 17 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@295ba4fc
2022-01-11 13:11:41.672  INFO 17 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@295ba4fc
2022-01-11 13:11:41.737  INFO 17 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@295ba4fc
2022-01-11 13:11:41.742  WARN 17 --- [https-jsse-nio-7071-exec-9] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: x
2022-01-11 13:11:41.747  WARN 17 --- [https-jsse-nio-7071-exec-9] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: x
2022-01-11 13:11:41.753  INFO 17 --- [https-jsse-nio-7071-exec-9] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-5882428793075-625633, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-11 13:11:41.766  INFO 17 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=04af10c1-e539-43b7-a8fd-8a4f76cc5018, content=DENY, timestamp=1641906701766, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-11 13:11:41.786  INFO 17 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=187ms, Total=227ms
2022-01-11 13:11:41.921  INFO 17 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=76aa3759-adc8-42e7-bbe3-de465dcc7b20, content=null, timestamp=1641906701891, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=65452, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=9462ddf72b74, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.30.0.1, kc-session-state=115df91e-55fd-4d89-b568-03753c55dee3, http-req-server-port=80, http-header-accept=*/*, kc-id=faa49035-39a2-47eb-9400-cb93a9fe6d10, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641906701887, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd2DNXNxAH4AEQAAAABh3YIJdAAkZmFhNDkwMzUtMzlhMi00N2ViLTk0MDAtY2I5M2E5ZmU2ZDEwdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAXh4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQxMTVkZjkxZS01NWZkLTRkODktYjU2OC0wMzc1M2M1NWRlZTNwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAATaHR0cDovLzE5Mi4xNjguMS44M3hwcHNyAC9vcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2VuJEFjY2VzcwewcQ/lekULAgACTAAFcm9sZXNxAH4AAUwADHZlcmlmeUNhbGxlcnEAfgAKeHBzcQB+ACt3DAAAABA/QAAAAAAABHQADm9mZmxpbmVfYWNjZXNzdAAGbWVtYmVydAAFYWRtaW50ABF1bWFfYXV0aG9yaXphdGlvbnhwc3IAF2phdmEudXRpbC5MaW5rZWRIYXNoTWFwNMBOXBBswPsCAAFaAAthY2Nlc3NPcmRlcnhxAH4AGD9AAAAAAAAMdwgAAAAQAAAAAXQAB2FjY291bnRzcQB+AC5zcQB+ACt3DAAAABA/QAAAAAAAA3QADm1hbmFnZS1hY2NvdW50dAAUbWFuYWdlLWFjY291bnQtbGlua3N0AAx2aWV3LXByb2ZpbGV4cHgAdAANcHJvZmlsZSBlbWFpbHA=, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJFeUZNQnpQUXV6VFFHUzhnWjYwVjJ1LXZxUE4zYm55MFVJSm1HaUpwS2pFIn0.eyJleHAiOjE2NDE5MDY5OTcsImlhdCI6MTY0MTkwNjY5NywianRpIjoiZmFhNDkwMzUtMzlhMi00N2ViLTk0MDAtY2I5M2E5ZmU2ZDEwIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiMTE1ZGY5MWUtNTVmZC00ZDg5LWI1NjgtMDM3NTNjNTVkZWUzIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoieCJ9.RP4jVdLa2GKR1jEUG_Ofs1jSfGSuf9hAaf2-j4R2AHCcLlwOZHQfjtGK56y9rw6Mc7yt4IuTEGT3_0YWpF73nJ5N36X7TcZC0389FvX0FvP5331H4S5EVmOJ7FyGpOHtmkLRXz4dfExVXoNmkyd6BrqB07pTnpObzqEyYxOX88fWlUjDk6RWTDWCykBixaI76kAACr7cHj6JEN_a2AkEpMI4HkZGWG0JnCqZkydE2kfceTUd-pP22WGrHs60GjudxqXJPsI90ESRgnEUGmuXiI5VgPtS_v89gz7KsuRr6RElEpCzvTqNDGXjy8OX7Zi59gzgqCzdmHhL_CD_-QqTiA, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641906997, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=172.30.0.12, kc-type=Bearer, kc-cc--team-ID=x, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.30.0.1, http-session-id=695B689F942F4F282BC9C79833C3805C, http-session-last-accessed-time=1641906701887, kc-category-name=ACCESS, kc-iat=1641906697, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.30.0.1:65452 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 13:11:41.944  INFO 17 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 13:11:41.959  INFO 17 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2606c2e1
2022-01-11 13:11:41.965  INFO 17 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2606c2e1
2022-01-11 13:11:42.026  INFO 17 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2606c2e1
2022-01-11 13:11:42.029  INFO 17 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2606c2e1
2022-01-11 13:11:42.083  INFO 17 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2606c2e1
2022-01-11 13:11:42.086  WARN 17 --- [https-jsse-nio-7071-exec-10] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: x
2022-01-11 13:11:42.089  WARN 17 --- [https-jsse-nio-7071-exec-10] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: x
2022-01-11 13:11:42.100  INFO 17 --- [https-jsse-nio-7071-exec-10] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-5882798903375-883321, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-11 13:11:42.105  INFO 17 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=76aa3759-adc8-42e7-bbe3-de465dcc7b20, content=DENY, timestamp=1641906702105, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-11 13:11:42.108  INFO 17 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=156ms, Total=191ms
2022-01-11 13:11:42.395  INFO 17 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=26e02c6c-6e2c-42e9-a829-369495cf936a, content=null, timestamp=1641906702330, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=65454, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=9462ddf72b74, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.30.0.1, kc-session-state=115df91e-55fd-4d89-b568-03753c55dee3, http-req-server-port=80, http-header-accept=*/*, kc-id=faa49035-39a2-47eb-9400-cb93a9fe6d10, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641906702294, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd2DNXNxAH4AEQAAAABh3YIJdAAkZmFhNDkwMzUtMzlhMi00N2ViLTk0MDAtY2I5M2E5ZmU2ZDEwdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAXh4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQxMTVkZjkxZS01NWZkLTRkODktYjU2OC0wMzc1M2M1NWRlZTNwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAATaHR0cDovLzE5Mi4xNjguMS44M3hwcHNyAC9vcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2VuJEFjY2VzcwewcQ/lekULAgACTAAFcm9sZXNxAH4AAUwADHZlcmlmeUNhbGxlcnEAfgAKeHBzcQB+ACt3DAAAABA/QAAAAAAABHQADm9mZmxpbmVfYWNjZXNzdAAGbWVtYmVydAAFYWRtaW50ABF1bWFfYXV0aG9yaXphdGlvbnhwc3IAF2phdmEudXRpbC5MaW5rZWRIYXNoTWFwNMBOXBBswPsCAAFaAAthY2Nlc3NPcmRlcnhxAH4AGD9AAAAAAAAMdwgAAAAQAAAAAXQAB2FjY291bnRzcQB+AC5zcQB+ACt3DAAAABA/QAAAAAAAA3QADm1hbmFnZS1hY2NvdW50dAAUbWFuYWdlLWFjY291bnQtbGlua3N0AAx2aWV3LXByb2ZpbGV4cHgAdAANcHJvZmlsZSBlbWFpbHA=, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJFeUZNQnpQUXV6VFFHUzhnWjYwVjJ1LXZxUE4zYm55MFVJSm1HaUpwS2pFIn0.eyJleHAiOjE2NDE5MDY5OTcsImlhdCI6MTY0MTkwNjY5NywianRpIjoiZmFhNDkwMzUtMzlhMi00N2ViLTk0MDAtY2I5M2E5ZmU2ZDEwIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiMTE1ZGY5MWUtNTVmZC00ZDg5LWI1NjgtMDM3NTNjNTVkZWUzIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoieCJ9.RP4jVdLa2GKR1jEUG_Ofs1jSfGSuf9hAaf2-j4R2AHCcLlwOZHQfjtGK56y9rw6Mc7yt4IuTEGT3_0YWpF73nJ5N36X7TcZC0389FvX0FvP5331H4S5EVmOJ7FyGpOHtmkLRXz4dfExVXoNmkyd6BrqB07pTnpObzqEyYxOX88fWlUjDk6RWTDWCykBixaI76kAACr7cHj6JEN_a2AkEpMI4HkZGWG0JnCqZkydE2kfceTUd-pP22WGrHs60GjudxqXJPsI90ESRgnEUGmuXiI5VgPtS_v89gz7KsuRr6RElEpCzvTqNDGXjy8OX7Zi59gzgqCzdmHhL_CD_-QqTiA, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641906997, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=172.30.0.12, kc-type=Bearer, kc-cc--team-ID=x, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.30.0.1, http-session-id=7F223595C39AEC9B9FBAB0BB189A5E4F, http-session-last-accessed-time=1641906702294, kc-category-name=ACCESS, kc-iat=1641906697, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.30.0.1:65454 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 13:11:42.413  INFO 17 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 13:11:42.433  INFO 17 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@75bdc27f
2022-01-11 13:11:42.447  INFO 17 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@75bdc27f
2022-01-11 13:11:42.503  INFO 17 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@75bdc27f
2022-01-11 13:11:42.515  INFO 17 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@75bdc27f
2022-01-11 13:11:42.574  INFO 17 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@75bdc27f
2022-01-11 13:11:42.587  WARN 17 --- [https-jsse-nio-7071-exec-1] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: x
2022-01-11 13:11:42.594  WARN 17 --- [https-jsse-nio-7071-exec-1] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: x
2022-01-11 13:11:42.608  INFO 17 --- [https-jsse-nio-7071-exec-1] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-5883273285375-630880, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-11 13:11:42.614  INFO 17 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=26e02c6c-6e2c-42e9-a829-369495cf936a, content=DENY, timestamp=1641906702614, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-11 13:11:42.622  INFO 17 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=191ms, Total=253ms
2022-01-11 13:11:42.732  INFO 17 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=641a4a0a-8367-4a1d-abb5-0edce7120f68, content=null, timestamp=1641906702713, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=65456, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=9462ddf72b74, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.30.0.1, kc-session-state=115df91e-55fd-4d89-b568-03753c55dee3, http-req-server-port=80, http-header-accept=*/*, kc-id=faa49035-39a2-47eb-9400-cb93a9fe6d10, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641906702692, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd2DNXNxAH4AEQAAAABh3YIJdAAkZmFhNDkwMzUtMzlhMi00N2ViLTk0MDAtY2I5M2E5ZmU2ZDEwdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAXh4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQxMTVkZjkxZS01NWZkLTRkODktYjU2OC0wMzc1M2M1NWRlZTNwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAATaHR0cDovLzE5Mi4xNjguMS44M3hwcHNyAC9vcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2VuJEFjY2VzcwewcQ/lekULAgACTAAFcm9sZXNxAH4AAUwADHZlcmlmeUNhbGxlcnEAfgAKeHBzcQB+ACt3DAAAABA/QAAAAAAABHQADm9mZmxpbmVfYWNjZXNzdAAGbWVtYmVydAAFYWRtaW50ABF1bWFfYXV0aG9yaXphdGlvbnhwc3IAF2phdmEudXRpbC5MaW5rZWRIYXNoTWFwNMBOXBBswPsCAAFaAAthY2Nlc3NPcmRlcnhxAH4AGD9AAAAAAAAMdwgAAAAQAAAAAXQAB2FjY291bnRzcQB+AC5zcQB+ACt3DAAAABA/QAAAAAAAA3QADm1hbmFnZS1hY2NvdW50dAAUbWFuYWdlLWFjY291bnQtbGlua3N0AAx2aWV3LXByb2ZpbGV4cHgAdAANcHJvZmlsZSBlbWFpbHA=, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJFeUZNQnpQUXV6VFFHUzhnWjYwVjJ1LXZxUE4zYm55MFVJSm1HaUpwS2pFIn0.eyJleHAiOjE2NDE5MDY5OTcsImlhdCI6MTY0MTkwNjY5NywianRpIjoiZmFhNDkwMzUtMzlhMi00N2ViLTk0MDAtY2I5M2E5ZmU2ZDEwIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiMTE1ZGY5MWUtNTVmZC00ZDg5LWI1NjgtMDM3NTNjNTVkZWUzIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoieCJ9.RP4jVdLa2GKR1jEUG_Ofs1jSfGSuf9hAaf2-j4R2AHCcLlwOZHQfjtGK56y9rw6Mc7yt4IuTEGT3_0YWpF73nJ5N36X7TcZC0389FvX0FvP5331H4S5EVmOJ7FyGpOHtmkLRXz4dfExVXoNmkyd6BrqB07pTnpObzqEyYxOX88fWlUjDk6RWTDWCykBixaI76kAACr7cHj6JEN_a2AkEpMI4HkZGWG0JnCqZkydE2kfceTUd-pP22WGrHs60GjudxqXJPsI90ESRgnEUGmuXiI5VgPtS_v89gz7KsuRr6RElEpCzvTqNDGXjy8OX7Zi59gzgqCzdmHhL_CD_-QqTiA, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641906997, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=172.30.0.12, kc-type=Bearer, kc-cc--team-ID=x, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.30.0.1, http-session-id=7FFB34067967EDC2EC2129B370733631, http-session-last-accessed-time=1641906702692, kc-category-name=ACCESS, kc-iat=1641906697, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.30.0.1:65456 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 13:11:42.749  INFO 17 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 13:11:42.772  INFO 17 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6313b7aa
2022-01-11 13:11:42.783  INFO 17 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6313b7aa
2022-01-11 13:11:42.836  INFO 17 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6313b7aa
2022-01-11 13:11:42.841  INFO 17 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6313b7aa
2022-01-11 13:11:42.990  INFO 17 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6313b7aa
2022-01-11 13:11:42.995  WARN 17 --- [https-jsse-nio-7071-exec-2] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: x
2022-01-11 13:11:42.997  WARN 17 --- [https-jsse-nio-7071-exec-2] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: x
2022-01-11 13:11:43.011  INFO 17 --- [https-jsse-nio-7071-exec-2] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-5883604881575-532394, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-11 13:11:43.017  INFO 17 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=641a4a0a-8367-4a1d-abb5-0edce7120f68, content=DENY, timestamp=1641906703017, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-11 13:11:43.028  INFO 17 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=262ms, Total=303ms
2022-01-11 13:11:43.139  INFO 17 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=c3e6357f-36d4-4954-91c1-1f6ed511df08, content=null, timestamp=1641906703107, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=65458, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=9462ddf72b74, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.30.0.1, kc-session-state=115df91e-55fd-4d89-b568-03753c55dee3, http-req-server-port=80, http-header-accept=*/*, kc-id=faa49035-39a2-47eb-9400-cb93a9fe6d10, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641906703105, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd2DNXNxAH4AEQAAAABh3YIJdAAkZmFhNDkwMzUtMzlhMi00N2ViLTk0MDAtY2I5M2E5ZmU2ZDEwdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAXh4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQxMTVkZjkxZS01NWZkLTRkODktYjU2OC0wMzc1M2M1NWRlZTNwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAATaHR0cDovLzE5Mi4xNjguMS44M3hwcHNyAC9vcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2VuJEFjY2VzcwewcQ/lekULAgACTAAFcm9sZXNxAH4AAUwADHZlcmlmeUNhbGxlcnEAfgAKeHBzcQB+ACt3DAAAABA/QAAAAAAABHQADm9mZmxpbmVfYWNjZXNzdAAGbWVtYmVydAAFYWRtaW50ABF1bWFfYXV0aG9yaXphdGlvbnhwc3IAF2phdmEudXRpbC5MaW5rZWRIYXNoTWFwNMBOXBBswPsCAAFaAAthY2Nlc3NPcmRlcnhxAH4AGD9AAAAAAAAMdwgAAAAQAAAAAXQAB2FjY291bnRzcQB+AC5zcQB+ACt3DAAAABA/QAAAAAAAA3QADm1hbmFnZS1hY2NvdW50dAAUbWFuYWdlLWFjY291bnQtbGlua3N0AAx2aWV3LXByb2ZpbGV4cHgAdAANcHJvZmlsZSBlbWFpbHA=, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJFeUZNQnpQUXV6VFFHUzhnWjYwVjJ1LXZxUE4zYm55MFVJSm1HaUpwS2pFIn0.eyJleHAiOjE2NDE5MDY5OTcsImlhdCI6MTY0MTkwNjY5NywianRpIjoiZmFhNDkwMzUtMzlhMi00N2ViLTk0MDAtY2I5M2E5ZmU2ZDEwIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiMTE1ZGY5MWUtNTVmZC00ZDg5LWI1NjgtMDM3NTNjNTVkZWUzIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoieCJ9.RP4jVdLa2GKR1jEUG_Ofs1jSfGSuf9hAaf2-j4R2AHCcLlwOZHQfjtGK56y9rw6Mc7yt4IuTEGT3_0YWpF73nJ5N36X7TcZC0389FvX0FvP5331H4S5EVmOJ7FyGpOHtmkLRXz4dfExVXoNmkyd6BrqB07pTnpObzqEyYxOX88fWlUjDk6RWTDWCykBixaI76kAACr7cHj6JEN_a2AkEpMI4HkZGWG0JnCqZkydE2kfceTUd-pP22WGrHs60GjudxqXJPsI90ESRgnEUGmuXiI5VgPtS_v89gz7KsuRr6RElEpCzvTqNDGXjy8OX7Zi59gzgqCzdmHhL_CD_-QqTiA, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641906997, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=172.30.0.12, kc-type=Bearer, kc-cc--team-ID=x, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.30.0.1, http-session-id=1A331BA059C850C6020E7E197E322393, http-session-last-accessed-time=1641906703105, kc-category-name=ACCESS, kc-iat=1641906697, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.30.0.1:65458 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 13:11:43.160  INFO 17 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 13:11:43.177  INFO 17 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7adde818
2022-01-11 13:11:43.180  INFO 17 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7adde818
2022-01-11 13:11:43.223  INFO 17 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7adde818
2022-01-11 13:11:43.237  INFO 17 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7adde818
2022-01-11 13:11:43.281  INFO 17 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7adde818
2022-01-11 13:11:43.293  WARN 17 --- [https-jsse-nio-7071-exec-3] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: x
2022-01-11 13:11:43.296  WARN 17 --- [https-jsse-nio-7071-exec-3] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: x
2022-01-11 13:11:43.299  INFO 17 --- [https-jsse-nio-7071-exec-3] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-5884015060075-32639, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-11 13:11:43.304  INFO 17 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=c3e6357f-36d4-4954-91c1-1f6ed511df08, content=DENY, timestamp=1641906703304, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-11 13:11:43.311  INFO 17 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=139ms, Total=173ms
2022-01-11 13:11:43.459  INFO 17 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=dce46d24-7a7e-493c-bc3d-3196dddb8a42, content=null, timestamp=1641906703413, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=65460, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=9462ddf72b74, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.30.0.1, kc-session-state=115df91e-55fd-4d89-b568-03753c55dee3, http-req-server-port=80, http-header-accept=*/*, kc-id=faa49035-39a2-47eb-9400-cb93a9fe6d10, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641906703398, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd2DNXNxAH4AEQAAAABh3YIJdAAkZmFhNDkwMzUtMzlhMi00N2ViLTk0MDAtY2I5M2E5ZmU2ZDEwdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAXh4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQxMTVkZjkxZS01NWZkLTRkODktYjU2OC0wMzc1M2M1NWRlZTNwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAATaHR0cDovLzE5Mi4xNjguMS44M3hwcHNyAC9vcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2VuJEFjY2VzcwewcQ/lekULAgACTAAFcm9sZXNxAH4AAUwADHZlcmlmeUNhbGxlcnEAfgAKeHBzcQB+ACt3DAAAABA/QAAAAAAABHQADm9mZmxpbmVfYWNjZXNzdAAGbWVtYmVydAAFYWRtaW50ABF1bWFfYXV0aG9yaXphdGlvbnhwc3IAF2phdmEudXRpbC5MaW5rZWRIYXNoTWFwNMBOXBBswPsCAAFaAAthY2Nlc3NPcmRlcnhxAH4AGD9AAAAAAAAMdwgAAAAQAAAAAXQAB2FjY291bnRzcQB+AC5zcQB+ACt3DAAAABA/QAAAAAAAA3QADm1hbmFnZS1hY2NvdW50dAAUbWFuYWdlLWFjY291bnQtbGlua3N0AAx2aWV3LXByb2ZpbGV4cHgAdAANcHJvZmlsZSBlbWFpbHA=, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJFeUZNQnpQUXV6VFFHUzhnWjYwVjJ1LXZxUE4zYm55MFVJSm1HaUpwS2pFIn0.eyJleHAiOjE2NDE5MDY5OTcsImlhdCI6MTY0MTkwNjY5NywianRpIjoiZmFhNDkwMzUtMzlhMi00N2ViLTk0MDAtY2I5M2E5ZmU2ZDEwIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiMTE1ZGY5MWUtNTVmZC00ZDg5LWI1NjgtMDM3NTNjNTVkZWUzIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoieCJ9.RP4jVdLa2GKR1jEUG_Ofs1jSfGSuf9hAaf2-j4R2AHCcLlwOZHQfjtGK56y9rw6Mc7yt4IuTEGT3_0YWpF73nJ5N36X7TcZC0389FvX0FvP5331H4S5EVmOJ7FyGpOHtmkLRXz4dfExVXoNmkyd6BrqB07pTnpObzqEyYxOX88fWlUjDk6RWTDWCykBixaI76kAACr7cHj6JEN_a2AkEpMI4HkZGWG0JnCqZkydE2kfceTUd-pP22WGrHs60GjudxqXJPsI90ESRgnEUGmuXiI5VgPtS_v89gz7KsuRr6RElEpCzvTqNDGXjy8OX7Zi59gzgqCzdmHhL_CD_-QqTiA, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641906997, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=172.30.0.12, kc-type=Bearer, kc-cc--team-ID=x, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.30.0.1, http-session-id=DAB2932FDD2F650BA14B1B01803A4332, http-session-last-accessed-time=1641906703398, kc-category-name=ACCESS, kc-iat=1641906697, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.30.0.1:65460 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 13:11:43.468  INFO 17 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 13:11:43.478  INFO 17 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@b111489
2022-01-11 13:11:43.483  INFO 17 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@b111489
2022-01-11 13:11:43.526  INFO 17 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@b111489
2022-01-11 13:11:43.532  INFO 17 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@b111489
2022-01-11 13:11:43.583  INFO 17 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@b111489
2022-01-11 13:11:43.589  WARN 17 --- [https-jsse-nio-7071-exec-4] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: x
2022-01-11 13:11:43.595  WARN 17 --- [https-jsse-nio-7071-exec-4] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: x
2022-01-11 13:11:43.605  INFO 17 --- [https-jsse-nio-7071-exec-4] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-5884321824875-484941, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-11 13:11:43.609  INFO 17 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=dce46d24-7a7e-493c-bc3d-3196dddb8a42, content=DENY, timestamp=1641906703609, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-11 13:11:43.616  INFO 17 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=137ms, Total=170ms
2022-01-11 13:11:43.746  INFO 17 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=9c923c6d-9eb6-4deb-83f5-83f3e012daa4, content=null, timestamp=1641906703707, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=65462, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=9462ddf72b74, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.30.0.1, kc-session-state=115df91e-55fd-4d89-b568-03753c55dee3, http-req-server-port=80, http-header-accept=*/*, kc-id=faa49035-39a2-47eb-9400-cb93a9fe6d10, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641906703698, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd2DNXNxAH4AEQAAAABh3YIJdAAkZmFhNDkwMzUtMzlhMi00N2ViLTk0MDAtY2I5M2E5ZmU2ZDEwdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAXh4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQxMTVkZjkxZS01NWZkLTRkODktYjU2OC0wMzc1M2M1NWRlZTNwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAATaHR0cDovLzE5Mi4xNjguMS44M3hwcHNyAC9vcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2VuJEFjY2VzcwewcQ/lekULAgACTAAFcm9sZXNxAH4AAUwADHZlcmlmeUNhbGxlcnEAfgAKeHBzcQB+ACt3DAAAABA/QAAAAAAABHQADm9mZmxpbmVfYWNjZXNzdAAGbWVtYmVydAAFYWRtaW50ABF1bWFfYXV0aG9yaXphdGlvbnhwc3IAF2phdmEudXRpbC5MaW5rZWRIYXNoTWFwNMBOXBBswPsCAAFaAAthY2Nlc3NPcmRlcnhxAH4AGD9AAAAAAAAMdwgAAAAQAAAAAXQAB2FjY291bnRzcQB+AC5zcQB+ACt3DAAAABA/QAAAAAAAA3QADm1hbmFnZS1hY2NvdW50dAAUbWFuYWdlLWFjY291bnQtbGlua3N0AAx2aWV3LXByb2ZpbGV4cHgAdAANcHJvZmlsZSBlbWFpbHA=, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJFeUZNQnpQUXV6VFFHUzhnWjYwVjJ1LXZxUE4zYm55MFVJSm1HaUpwS2pFIn0.eyJleHAiOjE2NDE5MDY5OTcsImlhdCI6MTY0MTkwNjY5NywianRpIjoiZmFhNDkwMzUtMzlhMi00N2ViLTk0MDAtY2I5M2E5ZmU2ZDEwIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiMTE1ZGY5MWUtNTVmZC00ZDg5LWI1NjgtMDM3NTNjNTVkZWUzIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoieCJ9.RP4jVdLa2GKR1jEUG_Ofs1jSfGSuf9hAaf2-j4R2AHCcLlwOZHQfjtGK56y9rw6Mc7yt4IuTEGT3_0YWpF73nJ5N36X7TcZC0389FvX0FvP5331H4S5EVmOJ7FyGpOHtmkLRXz4dfExVXoNmkyd6BrqB07pTnpObzqEyYxOX88fWlUjDk6RWTDWCykBixaI76kAACr7cHj6JEN_a2AkEpMI4HkZGWG0JnCqZkydE2kfceTUd-pP22WGrHs60GjudxqXJPsI90ESRgnEUGmuXiI5VgPtS_v89gz7KsuRr6RElEpCzvTqNDGXjy8OX7Zi59gzgqCzdmHhL_CD_-QqTiA, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641906997, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=172.30.0.12, kc-type=Bearer, kc-cc--team-ID=x, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.30.0.1, http-session-id=5B5B8E7A8DAD8A5F62AC1BD5919FD799, http-session-last-accessed-time=1641906703698, kc-category-name=ACCESS, kc-iat=1641906697, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.30.0.1:65462 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 13:11:43.754  INFO 17 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 13:11:43.772  INFO 17 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7544eb0f
2022-01-11 13:11:43.775  INFO 17 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7544eb0f
2022-01-11 13:11:43.809  INFO 17 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7544eb0f
2022-01-11 13:11:43.814  INFO 17 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7544eb0f
2022-01-11 13:11:43.882  INFO 17 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7544eb0f
2022-01-11 13:11:43.884  WARN 17 --- [https-jsse-nio-7071-exec-5] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: x
2022-01-11 13:11:43.887  WARN 17 --- [https-jsse-nio-7071-exec-5] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: x
2022-01-11 13:11:43.891  INFO 17 --- [https-jsse-nio-7071-exec-5] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-5884609399975-160317, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-11 13:11:43.896  INFO 17 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=9c923c6d-9eb6-4deb-83f5-83f3e012daa4, content=DENY, timestamp=1641906703896, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-11 13:11:43.900  INFO 17 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=136ms, Total=157ms
2022-01-11 13:11:43.973  INFO 17 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=d2419c07-4a93-4939-b2f3-b9fa24b3b240, content=null, timestamp=1641906703952, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=65464, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=9462ddf72b74, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.30.0.1, kc-session-state=115df91e-55fd-4d89-b568-03753c55dee3, http-req-server-port=80, http-header-accept=*/*, kc-id=faa49035-39a2-47eb-9400-cb93a9fe6d10, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641906703942, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd2DNXNxAH4AEQAAAABh3YIJdAAkZmFhNDkwMzUtMzlhMi00N2ViLTk0MDAtY2I5M2E5ZmU2ZDEwdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAXh4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQxMTVkZjkxZS01NWZkLTRkODktYjU2OC0wMzc1M2M1NWRlZTNwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAATaHR0cDovLzE5Mi4xNjguMS44M3hwcHNyAC9vcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2VuJEFjY2VzcwewcQ/lekULAgACTAAFcm9sZXNxAH4AAUwADHZlcmlmeUNhbGxlcnEAfgAKeHBzcQB+ACt3DAAAABA/QAAAAAAABHQADm9mZmxpbmVfYWNjZXNzdAAGbWVtYmVydAAFYWRtaW50ABF1bWFfYXV0aG9yaXphdGlvbnhwc3IAF2phdmEudXRpbC5MaW5rZWRIYXNoTWFwNMBOXBBswPsCAAFaAAthY2Nlc3NPcmRlcnhxAH4AGD9AAAAAAAAMdwgAAAAQAAAAAXQAB2FjY291bnRzcQB+AC5zcQB+ACt3DAAAABA/QAAAAAAAA3QADm1hbmFnZS1hY2NvdW50dAAUbWFuYWdlLWFjY291bnQtbGlua3N0AAx2aWV3LXByb2ZpbGV4cHgAdAANcHJvZmlsZSBlbWFpbHA=, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJFeUZNQnpQUXV6VFFHUzhnWjYwVjJ1LXZxUE4zYm55MFVJSm1HaUpwS2pFIn0.eyJleHAiOjE2NDE5MDY5OTcsImlhdCI6MTY0MTkwNjY5NywianRpIjoiZmFhNDkwMzUtMzlhMi00N2ViLTk0MDAtY2I5M2E5ZmU2ZDEwIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiMTE1ZGY5MWUtNTVmZC00ZDg5LWI1NjgtMDM3NTNjNTVkZWUzIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoieCJ9.RP4jVdLa2GKR1jEUG_Ofs1jSfGSuf9hAaf2-j4R2AHCcLlwOZHQfjtGK56y9rw6Mc7yt4IuTEGT3_0YWpF73nJ5N36X7TcZC0389FvX0FvP5331H4S5EVmOJ7FyGpOHtmkLRXz4dfExVXoNmkyd6BrqB07pTnpObzqEyYxOX88fWlUjDk6RWTDWCykBixaI76kAACr7cHj6JEN_a2AkEpMI4HkZGWG0JnCqZkydE2kfceTUd-pP22WGrHs60GjudxqXJPsI90ESRgnEUGmuXiI5VgPtS_v89gz7KsuRr6RElEpCzvTqNDGXjy8OX7Zi59gzgqCzdmHhL_CD_-QqTiA, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641906997, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=172.30.0.12, kc-type=Bearer, kc-cc--team-ID=x, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.30.0.1, http-session-id=5D16332FFC8B6181954F229404EDDEC6, http-session-last-accessed-time=1641906703942, kc-category-name=ACCESS, kc-iat=1641906697, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.30.0.1:65464 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 13:11:43.984  INFO 17 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 13:11:43.997  INFO 17 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@662096fd
2022-01-11 13:11:44.002  INFO 17 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@662096fd
2022-01-11 13:11:44.048  INFO 17 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@662096fd
2022-01-11 13:11:44.051  INFO 17 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@662096fd
2022-01-11 13:11:44.083  INFO 17 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@662096fd
2022-01-11 13:11:44.088  WARN 17 --- [https-jsse-nio-7071-exec-6] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: x
2022-01-11 13:11:44.092  WARN 17 --- [https-jsse-nio-7071-exec-6] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: x
2022-01-11 13:11:44.104  INFO 17 --- [https-jsse-nio-7071-exec-6] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-5884837063275-511398, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-11 13:11:44.108  INFO 17 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=d2419c07-4a93-4939-b2f3-b9fa24b3b240, content=DENY, timestamp=1641906704107, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-11 13:11:44.111  INFO 17 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=120ms, Total=140ms
2022-01-11 13:11:44.174  INFO 17 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=96d59f25-c6a1-435e-bc18-28678c34e9b4, content=null, timestamp=1641906704160, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=65466, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=9462ddf72b74, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.30.0.1, kc-session-state=115df91e-55fd-4d89-b568-03753c55dee3, http-req-server-port=80, http-header-accept=*/*, kc-id=faa49035-39a2-47eb-9400-cb93a9fe6d10, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641906704158, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd2DNXNxAH4AEQAAAABh3YIJdAAkZmFhNDkwMzUtMzlhMi00N2ViLTk0MDAtY2I5M2E5ZmU2ZDEwdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAXh4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQxMTVkZjkxZS01NWZkLTRkODktYjU2OC0wMzc1M2M1NWRlZTNwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAATaHR0cDovLzE5Mi4xNjguMS44M3hwcHNyAC9vcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2VuJEFjY2VzcwewcQ/lekULAgACTAAFcm9sZXNxAH4AAUwADHZlcmlmeUNhbGxlcnEAfgAKeHBzcQB+ACt3DAAAABA/QAAAAAAABHQADm9mZmxpbmVfYWNjZXNzdAAGbWVtYmVydAAFYWRtaW50ABF1bWFfYXV0aG9yaXphdGlvbnhwc3IAF2phdmEudXRpbC5MaW5rZWRIYXNoTWFwNMBOXBBswPsCAAFaAAthY2Nlc3NPcmRlcnhxAH4AGD9AAAAAAAAMdwgAAAAQAAAAAXQAB2FjY291bnRzcQB+AC5zcQB+ACt3DAAAABA/QAAAAAAAA3QADm1hbmFnZS1hY2NvdW50dAAUbWFuYWdlLWFjY291bnQtbGlua3N0AAx2aWV3LXByb2ZpbGV4cHgAdAANcHJvZmlsZSBlbWFpbHA=, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJFeUZNQnpQUXV6VFFHUzhnWjYwVjJ1LXZxUE4zYm55MFVJSm1HaUpwS2pFIn0.eyJleHAiOjE2NDE5MDY5OTcsImlhdCI6MTY0MTkwNjY5NywianRpIjoiZmFhNDkwMzUtMzlhMi00N2ViLTk0MDAtY2I5M2E5ZmU2ZDEwIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiMTE1ZGY5MWUtNTVmZC00ZDg5LWI1NjgtMDM3NTNjNTVkZWUzIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoieCJ9.RP4jVdLa2GKR1jEUG_Ofs1jSfGSuf9hAaf2-j4R2AHCcLlwOZHQfjtGK56y9rw6Mc7yt4IuTEGT3_0YWpF73nJ5N36X7TcZC0389FvX0FvP5331H4S5EVmOJ7FyGpOHtmkLRXz4dfExVXoNmkyd6BrqB07pTnpObzqEyYxOX88fWlUjDk6RWTDWCykBixaI76kAACr7cHj6JEN_a2AkEpMI4HkZGWG0JnCqZkydE2kfceTUd-pP22WGrHs60GjudxqXJPsI90ESRgnEUGmuXiI5VgPtS_v89gz7KsuRr6RElEpCzvTqNDGXjy8OX7Zi59gzgqCzdmHhL_CD_-QqTiA, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641906997, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=172.30.0.12, kc-type=Bearer, kc-cc--team-ID=x, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.30.0.1, http-session-id=A1911751A11A64C08EE26DFEBDDDCD40, http-session-last-accessed-time=1641906704158, kc-category-name=ACCESS, kc-iat=1641906697, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.30.0.1:65466 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 13:11:44.178  INFO 17 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 13:11:44.205  INFO 17 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@42c1ccfc
2022-01-11 13:11:44.212  INFO 17 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@42c1ccfc
2022-01-11 13:11:44.246  INFO 17 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@42c1ccfc
2022-01-11 13:11:44.257  INFO 17 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@42c1ccfc
2022-01-11 13:11:44.296  INFO 17 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@42c1ccfc
2022-01-11 13:11:44.306  WARN 17 --- [https-jsse-nio-7071-exec-7] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: x
2022-01-11 13:11:44.309  WARN 17 --- [https-jsse-nio-7071-exec-7] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: x
2022-01-11 13:11:44.327  INFO 17 --- [https-jsse-nio-7071-exec-7] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-5885034671075-748051, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-11 13:11:44.330  INFO 17 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=96d59f25-c6a1-435e-bc18-28678c34e9b4, content=DENY, timestamp=1641906704330, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-11 13:11:44.339  INFO 17 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=145ms, Total=167ms
2022-01-11 13:11:44.423  INFO 17 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=d2e81f34-5c0e-47d8-aba7-d334a20bf2f1, content=null, timestamp=1641906704405, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=65468, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=9462ddf72b74, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.30.0.1, kc-session-state=115df91e-55fd-4d89-b568-03753c55dee3, http-req-server-port=80, http-header-accept=*/*, kc-id=faa49035-39a2-47eb-9400-cb93a9fe6d10, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641906704395, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd2DNXNxAH4AEQAAAABh3YIJdAAkZmFhNDkwMzUtMzlhMi00N2ViLTk0MDAtY2I5M2E5ZmU2ZDEwdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAXh4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQxMTVkZjkxZS01NWZkLTRkODktYjU2OC0wMzc1M2M1NWRlZTNwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAATaHR0cDovLzE5Mi4xNjguMS44M3hwcHNyAC9vcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2VuJEFjY2VzcwewcQ/lekULAgACTAAFcm9sZXNxAH4AAUwADHZlcmlmeUNhbGxlcnEAfgAKeHBzcQB+ACt3DAAAABA/QAAAAAAABHQADm9mZmxpbmVfYWNjZXNzdAAGbWVtYmVydAAFYWRtaW50ABF1bWFfYXV0aG9yaXphdGlvbnhwc3IAF2phdmEudXRpbC5MaW5rZWRIYXNoTWFwNMBOXBBswPsCAAFaAAthY2Nlc3NPcmRlcnhxAH4AGD9AAAAAAAAMdwgAAAAQAAAAAXQAB2FjY291bnRzcQB+AC5zcQB+ACt3DAAAABA/QAAAAAAAA3QADm1hbmFnZS1hY2NvdW50dAAUbWFuYWdlLWFjY291bnQtbGlua3N0AAx2aWV3LXByb2ZpbGV4cHgAdAANcHJvZmlsZSBlbWFpbHA=, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJFeUZNQnpQUXV6VFFHUzhnWjYwVjJ1LXZxUE4zYm55MFVJSm1HaUpwS2pFIn0.eyJleHAiOjE2NDE5MDY5OTcsImlhdCI6MTY0MTkwNjY5NywianRpIjoiZmFhNDkwMzUtMzlhMi00N2ViLTk0MDAtY2I5M2E5ZmU2ZDEwIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiMTE1ZGY5MWUtNTVmZC00ZDg5LWI1NjgtMDM3NTNjNTVkZWUzIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoieCJ9.RP4jVdLa2GKR1jEUG_Ofs1jSfGSuf9hAaf2-j4R2AHCcLlwOZHQfjtGK56y9rw6Mc7yt4IuTEGT3_0YWpF73nJ5N36X7TcZC0389FvX0FvP5331H4S5EVmOJ7FyGpOHtmkLRXz4dfExVXoNmkyd6BrqB07pTnpObzqEyYxOX88fWlUjDk6RWTDWCykBixaI76kAACr7cHj6JEN_a2AkEpMI4HkZGWG0JnCqZkydE2kfceTUd-pP22WGrHs60GjudxqXJPsI90ESRgnEUGmuXiI5VgPtS_v89gz7KsuRr6RElEpCzvTqNDGXjy8OX7Zi59gzgqCzdmHhL_CD_-QqTiA, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641906997, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=172.30.0.12, kc-type=Bearer, kc-cc--team-ID=x, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.30.0.1, http-session-id=96CD23102438C6B1F0225D4CB647A56B, http-session-last-accessed-time=1641906704395, kc-category-name=ACCESS, kc-iat=1641906697, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.30.0.1:65468 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 13:11:44.434  INFO 17 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 13:11:44.441  INFO 17 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7bebaa27
2022-01-11 13:11:44.447  INFO 17 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7bebaa27
2022-01-11 13:11:44.497  INFO 17 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7bebaa27
2022-01-11 13:11:44.501  INFO 17 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7bebaa27
2022-01-11 13:11:44.607  INFO 17 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7bebaa27
2022-01-11 13:11:44.614  WARN 17 --- [https-jsse-nio-7071-exec-8] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: x
2022-01-11 13:11:44.617  WARN 17 --- [https-jsse-nio-7071-exec-8] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: x
2022-01-11 13:11:44.623  INFO 17 --- [https-jsse-nio-7071-exec-8] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-5885288778675-832825, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-11 13:11:44.627  INFO 17 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=d2e81f34-5c0e-47d8-aba7-d334a20bf2f1, content=DENY, timestamp=1641906704627, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-11 13:11:44.635  INFO 17 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=188ms, Total=213ms
2022-01-11 13:11:44.700  INFO 17 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=4559c2bc-bf8a-47bd-86b2-4e5d2f96ac5c, content=null, timestamp=1641906704687, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=65470, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=9462ddf72b74, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.30.0.1, kc-session-state=115df91e-55fd-4d89-b568-03753c55dee3, http-req-server-port=80, http-header-accept=*/*, kc-id=faa49035-39a2-47eb-9400-cb93a9fe6d10, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641906704684, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd2DNXNxAH4AEQAAAABh3YIJdAAkZmFhNDkwMzUtMzlhMi00N2ViLTk0MDAtY2I5M2E5ZmU2ZDEwdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAXh4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQxMTVkZjkxZS01NWZkLTRkODktYjU2OC0wMzc1M2M1NWRlZTNwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAATaHR0cDovLzE5Mi4xNjguMS44M3hwcHNyAC9vcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2VuJEFjY2VzcwewcQ/lekULAgACTAAFcm9sZXNxAH4AAUwADHZlcmlmeUNhbGxlcnEAfgAKeHBzcQB+ACt3DAAAABA/QAAAAAAABHQADm9mZmxpbmVfYWNjZXNzdAAGbWVtYmVydAAFYWRtaW50ABF1bWFfYXV0aG9yaXphdGlvbnhwc3IAF2phdmEudXRpbC5MaW5rZWRIYXNoTWFwNMBOXBBswPsCAAFaAAthY2Nlc3NPcmRlcnhxAH4AGD9AAAAAAAAMdwgAAAAQAAAAAXQAB2FjY291bnRzcQB+AC5zcQB+ACt3DAAAABA/QAAAAAAAA3QADm1hbmFnZS1hY2NvdW50dAAUbWFuYWdlLWFjY291bnQtbGlua3N0AAx2aWV3LXByb2ZpbGV4cHgAdAANcHJvZmlsZSBlbWFpbHA=, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJFeUZNQnpQUXV6VFFHUzhnWjYwVjJ1LXZxUE4zYm55MFVJSm1HaUpwS2pFIn0.eyJleHAiOjE2NDE5MDY5OTcsImlhdCI6MTY0MTkwNjY5NywianRpIjoiZmFhNDkwMzUtMzlhMi00N2ViLTk0MDAtY2I5M2E5ZmU2ZDEwIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiMTE1ZGY5MWUtNTVmZC00ZDg5LWI1NjgtMDM3NTNjNTVkZWUzIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoieCJ9.RP4jVdLa2GKR1jEUG_Ofs1jSfGSuf9hAaf2-j4R2AHCcLlwOZHQfjtGK56y9rw6Mc7yt4IuTEGT3_0YWpF73nJ5N36X7TcZC0389FvX0FvP5331H4S5EVmOJ7FyGpOHtmkLRXz4dfExVXoNmkyd6BrqB07pTnpObzqEyYxOX88fWlUjDk6RWTDWCykBixaI76kAACr7cHj6JEN_a2AkEpMI4HkZGWG0JnCqZkydE2kfceTUd-pP22WGrHs60GjudxqXJPsI90ESRgnEUGmuXiI5VgPtS_v89gz7KsuRr6RElEpCzvTqNDGXjy8OX7Zi59gzgqCzdmHhL_CD_-QqTiA, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641906997, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=172.30.0.12, kc-type=Bearer, kc-cc--team-ID=x, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.30.0.1, http-session-id=6A6726870ED6AC403786968CD19EAF08, http-session-last-accessed-time=1641906704684, kc-category-name=ACCESS, kc-iat=1641906697, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.30.0.1:65470 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 13:11:44.706  INFO 17 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 13:11:44.718  INFO 17 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@18bdb7f7
2022-01-11 13:11:44.737  INFO 17 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@18bdb7f7
2022-01-11 13:11:44.840  INFO 17 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@18bdb7f7
2022-01-11 13:11:44.866  INFO 17 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@18bdb7f7
2022-01-11 13:11:44.948  INFO 17 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@18bdb7f7
2022-01-11 13:11:44.956  WARN 17 --- [https-jsse-nio-7071-exec-9] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: x
2022-01-11 13:11:44.962  WARN 17 --- [https-jsse-nio-7071-exec-9] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: x
2022-01-11 13:11:44.973  INFO 17 --- [https-jsse-nio-7071-exec-9] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-5885560109575-933767, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-11 13:11:44.987  INFO 17 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=4559c2bc-bf8a-47bd-86b2-4e5d2f96ac5c, content=DENY, timestamp=1641906704987, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-11 13:11:44.997  INFO 17 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=277ms, Total=302ms
2022-01-11 13:11:45.152  INFO 17 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=d0236974-0d16-4a35-bc1d-71ddc0639305, content=null, timestamp=1641906705121, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=65472, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=9462ddf72b74, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.30.0.1, kc-session-state=115df91e-55fd-4d89-b568-03753c55dee3, http-req-server-port=80, http-header-accept=*/*, kc-id=faa49035-39a2-47eb-9400-cb93a9fe6d10, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641906705108, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd2DNXNxAH4AEQAAAABh3YIJdAAkZmFhNDkwMzUtMzlhMi00N2ViLTk0MDAtY2I5M2E5ZmU2ZDEwdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAXh4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQxMTVkZjkxZS01NWZkLTRkODktYjU2OC0wMzc1M2M1NWRlZTNwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAATaHR0cDovLzE5Mi4xNjguMS44M3hwcHNyAC9vcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2VuJEFjY2VzcwewcQ/lekULAgACTAAFcm9sZXNxAH4AAUwADHZlcmlmeUNhbGxlcnEAfgAKeHBzcQB+ACt3DAAAABA/QAAAAAAABHQADm9mZmxpbmVfYWNjZXNzdAAGbWVtYmVydAAFYWRtaW50ABF1bWFfYXV0aG9yaXphdGlvbnhwc3IAF2phdmEudXRpbC5MaW5rZWRIYXNoTWFwNMBOXBBswPsCAAFaAAthY2Nlc3NPcmRlcnhxAH4AGD9AAAAAAAAMdwgAAAAQAAAAAXQAB2FjY291bnRzcQB+AC5zcQB+ACt3DAAAABA/QAAAAAAAA3QADm1hbmFnZS1hY2NvdW50dAAUbWFuYWdlLWFjY291bnQtbGlua3N0AAx2aWV3LXByb2ZpbGV4cHgAdAANcHJvZmlsZSBlbWFpbHA=, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJFeUZNQnpQUXV6VFFHUzhnWjYwVjJ1LXZxUE4zYm55MFVJSm1HaUpwS2pFIn0.eyJleHAiOjE2NDE5MDY5OTcsImlhdCI6MTY0MTkwNjY5NywianRpIjoiZmFhNDkwMzUtMzlhMi00N2ViLTk0MDAtY2I5M2E5ZmU2ZDEwIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiMTE1ZGY5MWUtNTVmZC00ZDg5LWI1NjgtMDM3NTNjNTVkZWUzIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoieCJ9.RP4jVdLa2GKR1jEUG_Ofs1jSfGSuf9hAaf2-j4R2AHCcLlwOZHQfjtGK56y9rw6Mc7yt4IuTEGT3_0YWpF73nJ5N36X7TcZC0389FvX0FvP5331H4S5EVmOJ7FyGpOHtmkLRXz4dfExVXoNmkyd6BrqB07pTnpObzqEyYxOX88fWlUjDk6RWTDWCykBixaI76kAACr7cHj6JEN_a2AkEpMI4HkZGWG0JnCqZkydE2kfceTUd-pP22WGrHs60GjudxqXJPsI90ESRgnEUGmuXiI5VgPtS_v89gz7KsuRr6RElEpCzvTqNDGXjy8OX7Zi59gzgqCzdmHhL_CD_-QqTiA, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641906997, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=172.30.0.12, kc-type=Bearer, kc-cc--team-ID=x, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.30.0.1, http-session-id=A585CA6AF71E9215373C8B291784CA90, http-session-last-accessed-time=1641906705108, kc-category-name=ACCESS, kc-iat=1641906697, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.30.0.1:65472 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 13:11:45.162  INFO 17 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 13:11:45.177  INFO 17 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1fd187a7
2022-01-11 13:11:45.181  INFO 17 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1fd187a7
2022-01-11 13:11:45.229  INFO 17 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1fd187a7
2022-01-11 13:11:45.232  INFO 17 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1fd187a7
2022-01-11 13:11:45.269  INFO 17 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1fd187a7
2022-01-11 13:11:45.278  WARN 17 --- [https-jsse-nio-7071-exec-10] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: x
2022-01-11 13:11:45.284  WARN 17 --- [https-jsse-nio-7071-exec-10] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: x
2022-01-11 13:11:45.299  INFO 17 --- [https-jsse-nio-7071-exec-10] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-5886015434475-507147, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-11 13:11:45.301  INFO 17 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=d0236974-0d16-4a35-bc1d-71ddc0639305, content=DENY, timestamp=1641906705301, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-11 13:11:45.304  INFO 17 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=135ms, Total=160ms
2022-01-11 13:11:45.376  INFO 17 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=411d4b9a-5927-4393-bf98-9831a2d343d3, content=null, timestamp=1641906705348, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=65474, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=9462ddf72b74, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.30.0.1, kc-session-state=115df91e-55fd-4d89-b568-03753c55dee3, http-req-server-port=80, http-header-accept=*/*, kc-id=faa49035-39a2-47eb-9400-cb93a9fe6d10, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641906705346, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd2DNXNxAH4AEQAAAABh3YIJdAAkZmFhNDkwMzUtMzlhMi00N2ViLTk0MDAtY2I5M2E5ZmU2ZDEwdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAXh4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQxMTVkZjkxZS01NWZkLTRkODktYjU2OC0wMzc1M2M1NWRlZTNwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAATaHR0cDovLzE5Mi4xNjguMS44M3hwcHNyAC9vcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2VuJEFjY2VzcwewcQ/lekULAgACTAAFcm9sZXNxAH4AAUwADHZlcmlmeUNhbGxlcnEAfgAKeHBzcQB+ACt3DAAAABA/QAAAAAAABHQADm9mZmxpbmVfYWNjZXNzdAAGbWVtYmVydAAFYWRtaW50ABF1bWFfYXV0aG9yaXphdGlvbnhwc3IAF2phdmEudXRpbC5MaW5rZWRIYXNoTWFwNMBOXBBswPsCAAFaAAthY2Nlc3NPcmRlcnhxAH4AGD9AAAAAAAAMdwgAAAAQAAAAAXQAB2FjY291bnRzcQB+AC5zcQB+ACt3DAAAABA/QAAAAAAAA3QADm1hbmFnZS1hY2NvdW50dAAUbWFuYWdlLWFjY291bnQtbGlua3N0AAx2aWV3LXByb2ZpbGV4cHgAdAANcHJvZmlsZSBlbWFpbHA=, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJFeUZNQnpQUXV6VFFHUzhnWjYwVjJ1LXZxUE4zYm55MFVJSm1HaUpwS2pFIn0.eyJleHAiOjE2NDE5MDY5OTcsImlhdCI6MTY0MTkwNjY5NywianRpIjoiZmFhNDkwMzUtMzlhMi00N2ViLTk0MDAtY2I5M2E5ZmU2ZDEwIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiMTE1ZGY5MWUtNTVmZC00ZDg5LWI1NjgtMDM3NTNjNTVkZWUzIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoieCJ9.RP4jVdLa2GKR1jEUG_Ofs1jSfGSuf9hAaf2-j4R2AHCcLlwOZHQfjtGK56y9rw6Mc7yt4IuTEGT3_0YWpF73nJ5N36X7TcZC0389FvX0FvP5331H4S5EVmOJ7FyGpOHtmkLRXz4dfExVXoNmkyd6BrqB07pTnpObzqEyYxOX88fWlUjDk6RWTDWCykBixaI76kAACr7cHj6JEN_a2AkEpMI4HkZGWG0JnCqZkydE2kfceTUd-pP22WGrHs60GjudxqXJPsI90ESRgnEUGmuXiI5VgPtS_v89gz7KsuRr6RElEpCzvTqNDGXjy8OX7Zi59gzgqCzdmHhL_CD_-QqTiA, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641906997, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=172.30.0.12, kc-type=Bearer, kc-cc--team-ID=x, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.30.0.1, http-session-id=460C0AECB5E86C1525D5608C00F40CBB, http-session-last-accessed-time=1641906705346, kc-category-name=ACCESS, kc-iat=1641906697, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.30.0.1:65474 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 13:11:45.386  INFO 17 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 13:11:45.403  INFO 17 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2102f974
2022-01-11 13:11:45.406  INFO 17 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2102f974
2022-01-11 13:11:45.453  INFO 17 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2102f974
2022-01-11 13:11:45.460  INFO 17 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2102f974
2022-01-11 13:11:45.504  INFO 17 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2102f974
2022-01-11 13:11:45.515  WARN 17 --- [https-jsse-nio-7071-exec-1] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: x
2022-01-11 13:11:45.520  WARN 17 --- [https-jsse-nio-7071-exec-1] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: x
2022-01-11 13:11:45.527  INFO 17 --- [https-jsse-nio-7071-exec-1] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-5886238499175-894785, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-11 13:11:45.531  INFO 17 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=411d4b9a-5927-4393-bf98-9831a2d343d3, content=DENY, timestamp=1641906705531, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-11 13:11:45.540  INFO 17 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=142ms, Total=172ms
2022-01-11 13:11:45.609  INFO 17 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=819ffc89-6819-4982-ae5f-102ab0f685e7, content=null, timestamp=1641906705593, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=65476, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=9462ddf72b74, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.30.0.1, kc-session-state=115df91e-55fd-4d89-b568-03753c55dee3, http-req-server-port=80, http-header-accept=*/*, kc-id=faa49035-39a2-47eb-9400-cb93a9fe6d10, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641906705590, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd2DNXNxAH4AEQAAAABh3YIJdAAkZmFhNDkwMzUtMzlhMi00N2ViLTk0MDAtY2I5M2E5ZmU2ZDEwdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAXh4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQxMTVkZjkxZS01NWZkLTRkODktYjU2OC0wMzc1M2M1NWRlZTNwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAATaHR0cDovLzE5Mi4xNjguMS44M3hwcHNyAC9vcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2VuJEFjY2VzcwewcQ/lekULAgACTAAFcm9sZXNxAH4AAUwADHZlcmlmeUNhbGxlcnEAfgAKeHBzcQB+ACt3DAAAABA/QAAAAAAABHQADm9mZmxpbmVfYWNjZXNzdAAGbWVtYmVydAAFYWRtaW50ABF1bWFfYXV0aG9yaXphdGlvbnhwc3IAF2phdmEudXRpbC5MaW5rZWRIYXNoTWFwNMBOXBBswPsCAAFaAAthY2Nlc3NPcmRlcnhxAH4AGD9AAAAAAAAMdwgAAAAQAAAAAXQAB2FjY291bnRzcQB+AC5zcQB+ACt3DAAAABA/QAAAAAAAA3QADm1hbmFnZS1hY2NvdW50dAAUbWFuYWdlLWFjY291bnQtbGlua3N0AAx2aWV3LXByb2ZpbGV4cHgAdAANcHJvZmlsZSBlbWFpbHA=, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJFeUZNQnpQUXV6VFFHUzhnWjYwVjJ1LXZxUE4zYm55MFVJSm1HaUpwS2pFIn0.eyJleHAiOjE2NDE5MDY5OTcsImlhdCI6MTY0MTkwNjY5NywianRpIjoiZmFhNDkwMzUtMzlhMi00N2ViLTk0MDAtY2I5M2E5ZmU2ZDEwIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiMTE1ZGY5MWUtNTVmZC00ZDg5LWI1NjgtMDM3NTNjNTVkZWUzIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoieCJ9.RP4jVdLa2GKR1jEUG_Ofs1jSfGSuf9hAaf2-j4R2AHCcLlwOZHQfjtGK56y9rw6Mc7yt4IuTEGT3_0YWpF73nJ5N36X7TcZC0389FvX0FvP5331H4S5EVmOJ7FyGpOHtmkLRXz4dfExVXoNmkyd6BrqB07pTnpObzqEyYxOX88fWlUjDk6RWTDWCykBixaI76kAACr7cHj6JEN_a2AkEpMI4HkZGWG0JnCqZkydE2kfceTUd-pP22WGrHs60GjudxqXJPsI90ESRgnEUGmuXiI5VgPtS_v89gz7KsuRr6RElEpCzvTqNDGXjy8OX7Zi59gzgqCzdmHhL_CD_-QqTiA, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641906997, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=172.30.0.12, kc-type=Bearer, kc-cc--team-ID=x, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.30.0.1, http-session-id=2679DC5175528566BB52FBB0D4EEEAD0, http-session-last-accessed-time=1641906705590, kc-category-name=ACCESS, kc-iat=1641906697, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.30.0.1:65476 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 13:11:45.616  INFO 17 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 13:11:45.627  INFO 17 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5254fc51
2022-01-11 13:11:45.633  INFO 17 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5254fc51
2022-01-11 13:11:45.669  INFO 17 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5254fc51
2022-01-11 13:11:45.673  INFO 17 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5254fc51
2022-01-11 13:11:45.739  INFO 17 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5254fc51
2022-01-11 13:11:45.742  WARN 17 --- [https-jsse-nio-7071-exec-2] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: x
2022-01-11 13:11:45.745  WARN 17 --- [https-jsse-nio-7071-exec-2] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: x
2022-01-11 13:11:45.757  INFO 17 --- [https-jsse-nio-7071-exec-2] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-5886473071275-929469, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-11 13:11:45.765  INFO 17 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=819ffc89-6819-4982-ae5f-102ab0f685e7, content=DENY, timestamp=1641906705765, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-11 13:11:45.770  INFO 17 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=142ms, Total=163ms
2022-01-11 13:11:45.882  INFO 17 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=292c8d7f-6d1a-4d17-9368-b086c1b1e198, content=null, timestamp=1641906705856, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=65478, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=9462ddf72b74, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.30.0.1, kc-session-state=115df91e-55fd-4d89-b568-03753c55dee3, http-req-server-port=80, http-header-accept=*/*, kc-id=faa49035-39a2-47eb-9400-cb93a9fe6d10, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641906705843, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd2DNXNxAH4AEQAAAABh3YIJdAAkZmFhNDkwMzUtMzlhMi00N2ViLTk0MDAtY2I5M2E5ZmU2ZDEwdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAXh4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQxMTVkZjkxZS01NWZkLTRkODktYjU2OC0wMzc1M2M1NWRlZTNwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAATaHR0cDovLzE5Mi4xNjguMS44M3hwcHNyAC9vcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2VuJEFjY2VzcwewcQ/lekULAgACTAAFcm9sZXNxAH4AAUwADHZlcmlmeUNhbGxlcnEAfgAKeHBzcQB+ACt3DAAAABA/QAAAAAAABHQADm9mZmxpbmVfYWNjZXNzdAAGbWVtYmVydAAFYWRtaW50ABF1bWFfYXV0aG9yaXphdGlvbnhwc3IAF2phdmEudXRpbC5MaW5rZWRIYXNoTWFwNMBOXBBswPsCAAFaAAthY2Nlc3NPcmRlcnhxAH4AGD9AAAAAAAAMdwgAAAAQAAAAAXQAB2FjY291bnRzcQB+AC5zcQB+ACt3DAAAABA/QAAAAAAAA3QADm1hbmFnZS1hY2NvdW50dAAUbWFuYWdlLWFjY291bnQtbGlua3N0AAx2aWV3LXByb2ZpbGV4cHgAdAANcHJvZmlsZSBlbWFpbHA=, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJFeUZNQnpQUXV6VFFHUzhnWjYwVjJ1LXZxUE4zYm55MFVJSm1HaUpwS2pFIn0.eyJleHAiOjE2NDE5MDY5OTcsImlhdCI6MTY0MTkwNjY5NywianRpIjoiZmFhNDkwMzUtMzlhMi00N2ViLTk0MDAtY2I5M2E5ZmU2ZDEwIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiMTE1ZGY5MWUtNTVmZC00ZDg5LWI1NjgtMDM3NTNjNTVkZWUzIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoieCJ9.RP4jVdLa2GKR1jEUG_Ofs1jSfGSuf9hAaf2-j4R2AHCcLlwOZHQfjtGK56y9rw6Mc7yt4IuTEGT3_0YWpF73nJ5N36X7TcZC0389FvX0FvP5331H4S5EVmOJ7FyGpOHtmkLRXz4dfExVXoNmkyd6BrqB07pTnpObzqEyYxOX88fWlUjDk6RWTDWCykBixaI76kAACr7cHj6JEN_a2AkEpMI4HkZGWG0JnCqZkydE2kfceTUd-pP22WGrHs60GjudxqXJPsI90ESRgnEUGmuXiI5VgPtS_v89gz7KsuRr6RElEpCzvTqNDGXjy8OX7Zi59gzgqCzdmHhL_CD_-QqTiA, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641906997, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=172.30.0.12, kc-type=Bearer, kc-cc--team-ID=x, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.30.0.1, http-session-id=2E82164CD9569BFAFFD0E0F3E00F0707, http-session-last-accessed-time=1641906705843, kc-category-name=ACCESS, kc-iat=1641906697, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.30.0.1:65478 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 13:11:45.886  INFO 17 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 13:11:45.893  INFO 17 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@20da59d4
2022-01-11 13:11:45.898  INFO 17 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@20da59d4
2022-01-11 13:11:45.931  INFO 17 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@20da59d4
2022-01-11 13:11:45.937  INFO 17 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@20da59d4
2022-01-11 13:11:45.964  INFO 17 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@20da59d4
2022-01-11 13:11:45.969  WARN 17 --- [https-jsse-nio-7071-exec-3] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: x
2022-01-11 13:11:45.972  WARN 17 --- [https-jsse-nio-7071-exec-3] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: x
2022-01-11 13:11:45.975  INFO 17 --- [https-jsse-nio-7071-exec-3] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-5886738523175-976721, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-11 13:11:45.981  INFO 17 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=292c8d7f-6d1a-4d17-9368-b086c1b1e198, content=DENY, timestamp=1641906705981, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-11 13:11:45.985  INFO 17 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=92ms, Total=106ms
2022-01-11 13:11:46.063  INFO 17 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=b56eee1a-a6a4-4926-bd9b-f48218049606, content=null, timestamp=1641906706041, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=65480, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=9462ddf72b74, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.30.0.1, kc-session-state=115df91e-55fd-4d89-b568-03753c55dee3, http-req-server-port=80, http-header-accept=*/*, kc-id=faa49035-39a2-47eb-9400-cb93a9fe6d10, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641906706038, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd2DNXNxAH4AEQAAAABh3YIJdAAkZmFhNDkwMzUtMzlhMi00N2ViLTk0MDAtY2I5M2E5ZmU2ZDEwdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAXh4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQxMTVkZjkxZS01NWZkLTRkODktYjU2OC0wMzc1M2M1NWRlZTNwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAATaHR0cDovLzE5Mi4xNjguMS44M3hwcHNyAC9vcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2VuJEFjY2VzcwewcQ/lekULAgACTAAFcm9sZXNxAH4AAUwADHZlcmlmeUNhbGxlcnEAfgAKeHBzcQB+ACt3DAAAABA/QAAAAAAABHQADm9mZmxpbmVfYWNjZXNzdAAGbWVtYmVydAAFYWRtaW50ABF1bWFfYXV0aG9yaXphdGlvbnhwc3IAF2phdmEudXRpbC5MaW5rZWRIYXNoTWFwNMBOXBBswPsCAAFaAAthY2Nlc3NPcmRlcnhxAH4AGD9AAAAAAAAMdwgAAAAQAAAAAXQAB2FjY291bnRzcQB+AC5zcQB+ACt3DAAAABA/QAAAAAAAA3QADm1hbmFnZS1hY2NvdW50dAAUbWFuYWdlLWFjY291bnQtbGlua3N0AAx2aWV3LXByb2ZpbGV4cHgAdAANcHJvZmlsZSBlbWFpbHA=, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJFeUZNQnpQUXV6VFFHUzhnWjYwVjJ1LXZxUE4zYm55MFVJSm1HaUpwS2pFIn0.eyJleHAiOjE2NDE5MDY5OTcsImlhdCI6MTY0MTkwNjY5NywianRpIjoiZmFhNDkwMzUtMzlhMi00N2ViLTk0MDAtY2I5M2E5ZmU2ZDEwIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiMTE1ZGY5MWUtNTVmZC00ZDg5LWI1NjgtMDM3NTNjNTVkZWUzIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoieCJ9.RP4jVdLa2GKR1jEUG_Ofs1jSfGSuf9hAaf2-j4R2AHCcLlwOZHQfjtGK56y9rw6Mc7yt4IuTEGT3_0YWpF73nJ5N36X7TcZC0389FvX0FvP5331H4S5EVmOJ7FyGpOHtmkLRXz4dfExVXoNmkyd6BrqB07pTnpObzqEyYxOX88fWlUjDk6RWTDWCykBixaI76kAACr7cHj6JEN_a2AkEpMI4HkZGWG0JnCqZkydE2kfceTUd-pP22WGrHs60GjudxqXJPsI90ESRgnEUGmuXiI5VgPtS_v89gz7KsuRr6RElEpCzvTqNDGXjy8OX7Zi59gzgqCzdmHhL_CD_-QqTiA, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641906997, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=172.30.0.12, kc-type=Bearer, kc-cc--team-ID=x, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.30.0.1, http-session-id=EAE733A63A3F12E6E92445F70F2C9181, http-session-last-accessed-time=1641906706038, kc-category-name=ACCESS, kc-iat=1641906697, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.30.0.1:65480 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 13:11:46.093  INFO 17 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 13:11:46.109  INFO 17 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@55ded2e6
2022-01-11 13:11:46.115  INFO 17 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@55ded2e6
2022-01-11 13:11:46.179  INFO 17 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@55ded2e6
2022-01-11 13:11:46.182  INFO 17 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@55ded2e6
2022-01-11 13:11:46.248  INFO 17 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@55ded2e6
2022-01-11 13:11:46.254  WARN 17 --- [https-jsse-nio-7071-exec-4] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: x
2022-01-11 13:11:46.258  WARN 17 --- [https-jsse-nio-7071-exec-4] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: x
2022-01-11 13:11:46.264  INFO 17 --- [https-jsse-nio-7071-exec-4] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-5886947918375-174461, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-11 13:11:46.266  INFO 17 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=b56eee1a-a6a4-4926-bd9b-f48218049606, content=DENY, timestamp=1641906706266, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-11 13:11:46.273  INFO 17 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=168ms, Total=220ms
2022-01-11 13:11:46.414  INFO 17 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=f71439d6-0cb1-4266-a961-e36bc7c7fc2a, content=null, timestamp=1641906706374, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=65482, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=9462ddf72b74, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.30.0.1, kc-session-state=115df91e-55fd-4d89-b568-03753c55dee3, http-req-server-port=80, http-header-accept=*/*, kc-id=faa49035-39a2-47eb-9400-cb93a9fe6d10, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641906706354, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd2DNXNxAH4AEQAAAABh3YIJdAAkZmFhNDkwMzUtMzlhMi00N2ViLTk0MDAtY2I5M2E5ZmU2ZDEwdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAXh4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQxMTVkZjkxZS01NWZkLTRkODktYjU2OC0wMzc1M2M1NWRlZTNwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAATaHR0cDovLzE5Mi4xNjguMS44M3hwcHNyAC9vcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2VuJEFjY2VzcwewcQ/lekULAgACTAAFcm9sZXNxAH4AAUwADHZlcmlmeUNhbGxlcnEAfgAKeHBzcQB+ACt3DAAAABA/QAAAAAAABHQADm9mZmxpbmVfYWNjZXNzdAAGbWVtYmVydAAFYWRtaW50ABF1bWFfYXV0aG9yaXphdGlvbnhwc3IAF2phdmEudXRpbC5MaW5rZWRIYXNoTWFwNMBOXBBswPsCAAFaAAthY2Nlc3NPcmRlcnhxAH4AGD9AAAAAAAAMdwgAAAAQAAAAAXQAB2FjY291bnRzcQB+AC5zcQB+ACt3DAAAABA/QAAAAAAAA3QADm1hbmFnZS1hY2NvdW50dAAUbWFuYWdlLWFjY291bnQtbGlua3N0AAx2aWV3LXByb2ZpbGV4cHgAdAANcHJvZmlsZSBlbWFpbHA=, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJFeUZNQnpQUXV6VFFHUzhnWjYwVjJ1LXZxUE4zYm55MFVJSm1HaUpwS2pFIn0.eyJleHAiOjE2NDE5MDY5OTcsImlhdCI6MTY0MTkwNjY5NywianRpIjoiZmFhNDkwMzUtMzlhMi00N2ViLTk0MDAtY2I5M2E5ZmU2ZDEwIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiMTE1ZGY5MWUtNTVmZC00ZDg5LWI1NjgtMDM3NTNjNTVkZWUzIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoieCJ9.RP4jVdLa2GKR1jEUG_Ofs1jSfGSuf9hAaf2-j4R2AHCcLlwOZHQfjtGK56y9rw6Mc7yt4IuTEGT3_0YWpF73nJ5N36X7TcZC0389FvX0FvP5331H4S5EVmOJ7FyGpOHtmkLRXz4dfExVXoNmkyd6BrqB07pTnpObzqEyYxOX88fWlUjDk6RWTDWCykBixaI76kAACr7cHj6JEN_a2AkEpMI4HkZGWG0JnCqZkydE2kfceTUd-pP22WGrHs60GjudxqXJPsI90ESRgnEUGmuXiI5VgPtS_v89gz7KsuRr6RElEpCzvTqNDGXjy8OX7Zi59gzgqCzdmHhL_CD_-QqTiA, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641906997, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=172.30.0.12, kc-type=Bearer, kc-cc--team-ID=x, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.30.0.1, http-session-id=B8BF5FC08C80CB12ADE9FFD2FA837830, http-session-last-accessed-time=1641906706354, kc-category-name=ACCESS, kc-iat=1641906697, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.30.0.1:65482 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 13:11:46.423  INFO 17 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 13:11:46.435  INFO 17 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@50e471eb
2022-01-11 13:11:46.437  INFO 17 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@50e471eb
2022-01-11 13:11:46.474  INFO 17 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@50e471eb
2022-01-11 13:11:46.484  INFO 17 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@50e471eb
2022-01-11 13:11:46.545  INFO 17 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@50e471eb
2022-01-11 13:11:46.549  WARN 17 --- [https-jsse-nio-7071-exec-5] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: x
2022-01-11 13:11:46.554  WARN 17 --- [https-jsse-nio-7071-exec-5] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: x
2022-01-11 13:11:46.557  INFO 17 --- [https-jsse-nio-7071-exec-5] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-5887275011375-879567, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-11 13:11:46.560  INFO 17 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=f71439d6-0cb1-4266-a961-e36bc7c7fc2a, content=DENY, timestamp=1641906706560, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-11 13:11:46.569  INFO 17 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=135ms, Total=163ms
2022-01-11 13:11:46.680  INFO 17 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=bb10de56-3a7f-471c-babb-a2910e75d5b0, content=null, timestamp=1641906706647, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=65484, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=9462ddf72b74, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.30.0.1, kc-session-state=115df91e-55fd-4d89-b568-03753c55dee3, http-req-server-port=80, http-header-accept=*/*, kc-id=faa49035-39a2-47eb-9400-cb93a9fe6d10, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641906706645, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd2DNXNxAH4AEQAAAABh3YIJdAAkZmFhNDkwMzUtMzlhMi00N2ViLTk0MDAtY2I5M2E5ZmU2ZDEwdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAXh4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQxMTVkZjkxZS01NWZkLTRkODktYjU2OC0wMzc1M2M1NWRlZTNwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAATaHR0cDovLzE5Mi4xNjguMS44M3hwcHNyAC9vcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2VuJEFjY2VzcwewcQ/lekULAgACTAAFcm9sZXNxAH4AAUwADHZlcmlmeUNhbGxlcnEAfgAKeHBzcQB+ACt3DAAAABA/QAAAAAAABHQADm9mZmxpbmVfYWNjZXNzdAAGbWVtYmVydAAFYWRtaW50ABF1bWFfYXV0aG9yaXphdGlvbnhwc3IAF2phdmEudXRpbC5MaW5rZWRIYXNoTWFwNMBOXBBswPsCAAFaAAthY2Nlc3NPcmRlcnhxAH4AGD9AAAAAAAAMdwgAAAAQAAAAAXQAB2FjY291bnRzcQB+AC5zcQB+ACt3DAAAABA/QAAAAAAAA3QADm1hbmFnZS1hY2NvdW50dAAUbWFuYWdlLWFjY291bnQtbGlua3N0AAx2aWV3LXByb2ZpbGV4cHgAdAANcHJvZmlsZSBlbWFpbHA=, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJFeUZNQnpQUXV6VFFHUzhnWjYwVjJ1LXZxUE4zYm55MFVJSm1HaUpwS2pFIn0.eyJleHAiOjE2NDE5MDY5OTcsImlhdCI6MTY0MTkwNjY5NywianRpIjoiZmFhNDkwMzUtMzlhMi00N2ViLTk0MDAtY2I5M2E5ZmU2ZDEwIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiMTE1ZGY5MWUtNTVmZC00ZDg5LWI1NjgtMDM3NTNjNTVkZWUzIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoieCJ9.RP4jVdLa2GKR1jEUG_Ofs1jSfGSuf9hAaf2-j4R2AHCcLlwOZHQfjtGK56y9rw6Mc7yt4IuTEGT3_0YWpF73nJ5N36X7TcZC0389FvX0FvP5331H4S5EVmOJ7FyGpOHtmkLRXz4dfExVXoNmkyd6BrqB07pTnpObzqEyYxOX88fWlUjDk6RWTDWCykBixaI76kAACr7cHj6JEN_a2AkEpMI4HkZGWG0JnCqZkydE2kfceTUd-pP22WGrHs60GjudxqXJPsI90ESRgnEUGmuXiI5VgPtS_v89gz7KsuRr6RElEpCzvTqNDGXjy8OX7Zi59gzgqCzdmHhL_CD_-QqTiA, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641906997, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=172.30.0.12, kc-type=Bearer, kc-cc--team-ID=x, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.30.0.1, http-session-id=6EABA85DFF44A7F44BA450C43563C656, http-session-last-accessed-time=1641906706645, kc-category-name=ACCESS, kc-iat=1641906697, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.30.0.1:65484 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 13:11:46.692  INFO 17 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 13:11:46.697  INFO 17 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@50e73c72
2022-01-11 13:11:46.704  INFO 17 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@50e73c72
2022-01-11 13:11:46.737  INFO 17 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@50e73c72
2022-01-11 13:11:46.741  INFO 17 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@50e73c72
2022-01-11 13:11:46.818  INFO 17 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@50e73c72
2022-01-11 13:11:46.822  WARN 17 --- [https-jsse-nio-7071-exec-6] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: x
2022-01-11 13:11:46.825  WARN 17 --- [https-jsse-nio-7071-exec-6] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: x
2022-01-11 13:11:46.836  INFO 17 --- [https-jsse-nio-7071-exec-6] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-5887544812775-441868, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-11 13:11:46.841  INFO 17 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=bb10de56-3a7f-471c-babb-a2910e75d5b0, content=DENY, timestamp=1641906706841, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-11 13:11:46.845  INFO 17 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=146ms, Total=171ms
2022-01-11 13:11:46.991  INFO 17 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=d58f3b8b-d6a5-44d8-9e56-2269c8d86b58, content=null, timestamp=1641906706970, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=65486, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=9462ddf72b74, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.30.0.1, kc-session-state=115df91e-55fd-4d89-b568-03753c55dee3, http-req-server-port=80, http-header-accept=*/*, kc-id=faa49035-39a2-47eb-9400-cb93a9fe6d10, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641906706956, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd2DNXNxAH4AEQAAAABh3YIJdAAkZmFhNDkwMzUtMzlhMi00N2ViLTk0MDAtY2I5M2E5ZmU2ZDEwdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAXh4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQxMTVkZjkxZS01NWZkLTRkODktYjU2OC0wMzc1M2M1NWRlZTNwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAATaHR0cDovLzE5Mi4xNjguMS44M3hwcHNyAC9vcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2VuJEFjY2VzcwewcQ/lekULAgACTAAFcm9sZXNxAH4AAUwADHZlcmlmeUNhbGxlcnEAfgAKeHBzcQB+ACt3DAAAABA/QAAAAAAABHQADm9mZmxpbmVfYWNjZXNzdAAGbWVtYmVydAAFYWRtaW50ABF1bWFfYXV0aG9yaXphdGlvbnhwc3IAF2phdmEudXRpbC5MaW5rZWRIYXNoTWFwNMBOXBBswPsCAAFaAAthY2Nlc3NPcmRlcnhxAH4AGD9AAAAAAAAMdwgAAAAQAAAAAXQAB2FjY291bnRzcQB+AC5zcQB+ACt3DAAAABA/QAAAAAAAA3QADm1hbmFnZS1hY2NvdW50dAAUbWFuYWdlLWFjY291bnQtbGlua3N0AAx2aWV3LXByb2ZpbGV4cHgAdAANcHJvZmlsZSBlbWFpbHA=, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJFeUZNQnpQUXV6VFFHUzhnWjYwVjJ1LXZxUE4zYm55MFVJSm1HaUpwS2pFIn0.eyJleHAiOjE2NDE5MDY5OTcsImlhdCI6MTY0MTkwNjY5NywianRpIjoiZmFhNDkwMzUtMzlhMi00N2ViLTk0MDAtY2I5M2E5ZmU2ZDEwIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiMTE1ZGY5MWUtNTVmZC00ZDg5LWI1NjgtMDM3NTNjNTVkZWUzIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoieCJ9.RP4jVdLa2GKR1jEUG_Ofs1jSfGSuf9hAaf2-j4R2AHCcLlwOZHQfjtGK56y9rw6Mc7yt4IuTEGT3_0YWpF73nJ5N36X7TcZC0389FvX0FvP5331H4S5EVmOJ7FyGpOHtmkLRXz4dfExVXoNmkyd6BrqB07pTnpObzqEyYxOX88fWlUjDk6RWTDWCykBixaI76kAACr7cHj6JEN_a2AkEpMI4HkZGWG0JnCqZkydE2kfceTUd-pP22WGrHs60GjudxqXJPsI90ESRgnEUGmuXiI5VgPtS_v89gz7KsuRr6RElEpCzvTqNDGXjy8OX7Zi59gzgqCzdmHhL_CD_-QqTiA, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641906997, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=172.30.0.12, kc-type=Bearer, kc-cc--team-ID=x, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.30.0.1, http-session-id=807A2C25DD4BD997A58D8D8C3CCB8C44, http-session-last-accessed-time=1641906706956, kc-category-name=ACCESS, kc-iat=1641906697, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.30.0.1:65486 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 13:11:47.000  INFO 17 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 13:11:47.005  INFO 17 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2511f141
2022-01-11 13:11:47.010  INFO 17 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2511f141
2022-01-11 13:11:47.038  INFO 17 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2511f141
2022-01-11 13:11:47.048  INFO 17 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2511f141
2022-01-11 13:11:47.096  INFO 17 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2511f141
2022-01-11 13:11:47.099  WARN 17 --- [https-jsse-nio-7071-exec-7] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: x
2022-01-11 13:11:47.102  WARN 17 --- [https-jsse-nio-7071-exec-7] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: x
2022-01-11 13:11:47.108  INFO 17 --- [https-jsse-nio-7071-exec-7] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-5887852729375-176677, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-11 13:11:47.112  INFO 17 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=d58f3b8b-d6a5-44d8-9e56-2269c8d86b58, content=DENY, timestamp=1641906707112, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-11 13:11:47.119  INFO 17 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=109ms, Total=131ms
2022-01-11 13:11:47.183  INFO 17 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=3ebd1143-7e95-4f21-99c3-80b7936f67b0, content=null, timestamp=1641906707175, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=65488, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=9462ddf72b74, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.30.0.1, kc-session-state=115df91e-55fd-4d89-b568-03753c55dee3, http-req-server-port=80, http-header-accept=*/*, kc-id=faa49035-39a2-47eb-9400-cb93a9fe6d10, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641906707171, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd2DNXNxAH4AEQAAAABh3YIJdAAkZmFhNDkwMzUtMzlhMi00N2ViLTk0MDAtY2I5M2E5ZmU2ZDEwdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAXh4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQxMTVkZjkxZS01NWZkLTRkODktYjU2OC0wMzc1M2M1NWRlZTNwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAATaHR0cDovLzE5Mi4xNjguMS44M3hwcHNyAC9vcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2VuJEFjY2VzcwewcQ/lekULAgACTAAFcm9sZXNxAH4AAUwADHZlcmlmeUNhbGxlcnEAfgAKeHBzcQB+ACt3DAAAABA/QAAAAAAABHQADm9mZmxpbmVfYWNjZXNzdAAGbWVtYmVydAAFYWRtaW50ABF1bWFfYXV0aG9yaXphdGlvbnhwc3IAF2phdmEudXRpbC5MaW5rZWRIYXNoTWFwNMBOXBBswPsCAAFaAAthY2Nlc3NPcmRlcnhxAH4AGD9AAAAAAAAMdwgAAAAQAAAAAXQAB2FjY291bnRzcQB+AC5zcQB+ACt3DAAAABA/QAAAAAAAA3QADm1hbmFnZS1hY2NvdW50dAAUbWFuYWdlLWFjY291bnQtbGlua3N0AAx2aWV3LXByb2ZpbGV4cHgAdAANcHJvZmlsZSBlbWFpbHA=, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJFeUZNQnpQUXV6VFFHUzhnWjYwVjJ1LXZxUE4zYm55MFVJSm1HaUpwS2pFIn0.eyJleHAiOjE2NDE5MDY5OTcsImlhdCI6MTY0MTkwNjY5NywianRpIjoiZmFhNDkwMzUtMzlhMi00N2ViLTk0MDAtY2I5M2E5ZmU2ZDEwIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiMTE1ZGY5MWUtNTVmZC00ZDg5LWI1NjgtMDM3NTNjNTVkZWUzIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoieCJ9.RP4jVdLa2GKR1jEUG_Ofs1jSfGSuf9hAaf2-j4R2AHCcLlwOZHQfjtGK56y9rw6Mc7yt4IuTEGT3_0YWpF73nJ5N36X7TcZC0389FvX0FvP5331H4S5EVmOJ7FyGpOHtmkLRXz4dfExVXoNmkyd6BrqB07pTnpObzqEyYxOX88fWlUjDk6RWTDWCykBixaI76kAACr7cHj6JEN_a2AkEpMI4HkZGWG0JnCqZkydE2kfceTUd-pP22WGrHs60GjudxqXJPsI90ESRgnEUGmuXiI5VgPtS_v89gz7KsuRr6RElEpCzvTqNDGXjy8OX7Zi59gzgqCzdmHhL_CD_-QqTiA, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641906997, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=172.30.0.12, kc-type=Bearer, kc-cc--team-ID=x, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.30.0.1, http-session-id=54B7D2C9DB4A67460ECE743C1ACC039C, http-session-last-accessed-time=1641906707171, kc-category-name=ACCESS, kc-iat=1641906697, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.30.0.1:65488 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 13:11:47.196  INFO 17 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 13:11:47.201  INFO 17 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@33ffda8b
2022-01-11 13:11:47.205  INFO 17 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@33ffda8b
2022-01-11 13:11:47.234  INFO 17 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@33ffda8b
2022-01-11 13:11:47.240  INFO 17 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@33ffda8b
2022-01-11 13:11:47.282  INFO 17 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@33ffda8b
2022-01-11 13:11:47.285  WARN 17 --- [https-jsse-nio-7071-exec-8] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: x
2022-01-11 13:11:47.289  WARN 17 --- [https-jsse-nio-7071-exec-8] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: x
2022-01-11 13:11:47.300  INFO 17 --- [https-jsse-nio-7071-exec-8] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-5888049439275-924068, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-11 13:11:47.304  INFO 17 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=3ebd1143-7e95-4f21-99c3-80b7936f67b0, content=DENY, timestamp=1641906707304, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-11 13:11:47.307  INFO 17 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=104ms, Total=127ms
2022-01-11 13:11:47.385  INFO 17 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=3fa68c7d-56dc-4f00-bfc0-d7cbf271a03e, content=null, timestamp=1641906707377, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=65490, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=9462ddf72b74, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.30.0.1, kc-session-state=115df91e-55fd-4d89-b568-03753c55dee3, http-req-server-port=80, http-header-accept=*/*, kc-id=faa49035-39a2-47eb-9400-cb93a9fe6d10, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641906707373, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd2DNXNxAH4AEQAAAABh3YIJdAAkZmFhNDkwMzUtMzlhMi00N2ViLTk0MDAtY2I5M2E5ZmU2ZDEwdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAXh4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQxMTVkZjkxZS01NWZkLTRkODktYjU2OC0wMzc1M2M1NWRlZTNwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAATaHR0cDovLzE5Mi4xNjguMS44M3hwcHNyAC9vcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2VuJEFjY2VzcwewcQ/lekULAgACTAAFcm9sZXNxAH4AAUwADHZlcmlmeUNhbGxlcnEAfgAKeHBzcQB+ACt3DAAAABA/QAAAAAAABHQADm9mZmxpbmVfYWNjZXNzdAAGbWVtYmVydAAFYWRtaW50ABF1bWFfYXV0aG9yaXphdGlvbnhwc3IAF2phdmEudXRpbC5MaW5rZWRIYXNoTWFwNMBOXBBswPsCAAFaAAthY2Nlc3NPcmRlcnhxAH4AGD9AAAAAAAAMdwgAAAAQAAAAAXQAB2FjY291bnRzcQB+AC5zcQB+ACt3DAAAABA/QAAAAAAAA3QADm1hbmFnZS1hY2NvdW50dAAUbWFuYWdlLWFjY291bnQtbGlua3N0AAx2aWV3LXByb2ZpbGV4cHgAdAANcHJvZmlsZSBlbWFpbHA=, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJFeUZNQnpQUXV6VFFHUzhnWjYwVjJ1LXZxUE4zYm55MFVJSm1HaUpwS2pFIn0.eyJleHAiOjE2NDE5MDY5OTcsImlhdCI6MTY0MTkwNjY5NywianRpIjoiZmFhNDkwMzUtMzlhMi00N2ViLTk0MDAtY2I5M2E5ZmU2ZDEwIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiMTE1ZGY5MWUtNTVmZC00ZDg5LWI1NjgtMDM3NTNjNTVkZWUzIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoieCJ9.RP4jVdLa2GKR1jEUG_Ofs1jSfGSuf9hAaf2-j4R2AHCcLlwOZHQfjtGK56y9rw6Mc7yt4IuTEGT3_0YWpF73nJ5N36X7TcZC0389FvX0FvP5331H4S5EVmOJ7FyGpOHtmkLRXz4dfExVXoNmkyd6BrqB07pTnpObzqEyYxOX88fWlUjDk6RWTDWCykBixaI76kAACr7cHj6JEN_a2AkEpMI4HkZGWG0JnCqZkydE2kfceTUd-pP22WGrHs60GjudxqXJPsI90ESRgnEUGmuXiI5VgPtS_v89gz7KsuRr6RElEpCzvTqNDGXjy8OX7Zi59gzgqCzdmHhL_CD_-QqTiA, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641906997, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=172.30.0.12, kc-type=Bearer, kc-cc--team-ID=x, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.30.0.1, http-session-id=5E54D4FD24AB91B58EB63CB48BD0D6BD, http-session-last-accessed-time=1641906707373, kc-category-name=ACCESS, kc-iat=1641906697, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.30.0.1:65490 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 13:11:47.390  INFO 17 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 13:11:47.399  INFO 17 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3b8e9134
2022-01-11 13:11:47.425  INFO 17 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3b8e9134
2022-01-11 13:11:47.455  INFO 17 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3b8e9134
2022-01-11 13:11:47.459  INFO 17 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3b8e9134
2022-01-11 13:11:47.536  INFO 17 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3b8e9134
2022-01-11 13:11:47.548  WARN 17 --- [https-jsse-nio-7071-exec-9] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: x
2022-01-11 13:11:47.552  WARN 17 --- [https-jsse-nio-7071-exec-9] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: x
2022-01-11 13:11:47.556  INFO 17 --- [https-jsse-nio-7071-exec-9] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-5888243742375-531004, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-11 13:11:47.571  INFO 17 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=3fa68c7d-56dc-4f00-bfc0-d7cbf271a03e, content=DENY, timestamp=1641906707571, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-11 13:11:47.577  INFO 17 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=177ms, Total=194ms
2022-01-11 13:11:47.687  INFO 17 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=9822a7d9-c089-4eac-88aa-0c83ca20b6db, content=null, timestamp=1641906707674, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=65492, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=9462ddf72b74, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.30.0.1, kc-session-state=115df91e-55fd-4d89-b568-03753c55dee3, http-req-server-port=80, http-header-accept=*/*, kc-id=faa49035-39a2-47eb-9400-cb93a9fe6d10, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641906707651, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd2DNXNxAH4AEQAAAABh3YIJdAAkZmFhNDkwMzUtMzlhMi00N2ViLTk0MDAtY2I5M2E5ZmU2ZDEwdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAXh4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQxMTVkZjkxZS01NWZkLTRkODktYjU2OC0wMzc1M2M1NWRlZTNwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAATaHR0cDovLzE5Mi4xNjguMS44M3hwcHNyAC9vcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2VuJEFjY2VzcwewcQ/lekULAgACTAAFcm9sZXNxAH4AAUwADHZlcmlmeUNhbGxlcnEAfgAKeHBzcQB+ACt3DAAAABA/QAAAAAAABHQADm9mZmxpbmVfYWNjZXNzdAAGbWVtYmVydAAFYWRtaW50ABF1bWFfYXV0aG9yaXphdGlvbnhwc3IAF2phdmEudXRpbC5MaW5rZWRIYXNoTWFwNMBOXBBswPsCAAFaAAthY2Nlc3NPcmRlcnhxAH4AGD9AAAAAAAAMdwgAAAAQAAAAAXQAB2FjY291bnRzcQB+AC5zcQB+ACt3DAAAABA/QAAAAAAAA3QADm1hbmFnZS1hY2NvdW50dAAUbWFuYWdlLWFjY291bnQtbGlua3N0AAx2aWV3LXByb2ZpbGV4cHgAdAANcHJvZmlsZSBlbWFpbHA=, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJFeUZNQnpQUXV6VFFHUzhnWjYwVjJ1LXZxUE4zYm55MFVJSm1HaUpwS2pFIn0.eyJleHAiOjE2NDE5MDY5OTcsImlhdCI6MTY0MTkwNjY5NywianRpIjoiZmFhNDkwMzUtMzlhMi00N2ViLTk0MDAtY2I5M2E5ZmU2ZDEwIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiMTE1ZGY5MWUtNTVmZC00ZDg5LWI1NjgtMDM3NTNjNTVkZWUzIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoieCJ9.RP4jVdLa2GKR1jEUG_Ofs1jSfGSuf9hAaf2-j4R2AHCcLlwOZHQfjtGK56y9rw6Mc7yt4IuTEGT3_0YWpF73nJ5N36X7TcZC0389FvX0FvP5331H4S5EVmOJ7FyGpOHtmkLRXz4dfExVXoNmkyd6BrqB07pTnpObzqEyYxOX88fWlUjDk6RWTDWCykBixaI76kAACr7cHj6JEN_a2AkEpMI4HkZGWG0JnCqZkydE2kfceTUd-pP22WGrHs60GjudxqXJPsI90ESRgnEUGmuXiI5VgPtS_v89gz7KsuRr6RElEpCzvTqNDGXjy8OX7Zi59gzgqCzdmHhL_CD_-QqTiA, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641906997, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=172.30.0.12, kc-type=Bearer, kc-cc--team-ID=x, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.30.0.1, http-session-id=4E61F812CB6BC6DDE767CF64C968A857, http-session-last-accessed-time=1641906707651, kc-category-name=ACCESS, kc-iat=1641906697, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.30.0.1:65492 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 13:11:47.700  INFO 17 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 13:11:47.705  INFO 17 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4fad5943
2022-01-11 13:11:47.710  INFO 17 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4fad5943
2022-01-11 13:11:47.776  INFO 17 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4fad5943
2022-01-11 13:11:47.780  INFO 17 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4fad5943
2022-01-11 13:11:47.832  INFO 17 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4fad5943
2022-01-11 13:11:47.836  WARN 17 --- [https-jsse-nio-7071-exec-10] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: x
2022-01-11 13:11:47.839  WARN 17 --- [https-jsse-nio-7071-exec-10] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: x
2022-01-11 13:11:47.845  INFO 17 --- [https-jsse-nio-7071-exec-10] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-5888553246875-564480, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-11 13:11:47.849  INFO 17 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=9822a7d9-c089-4eac-88aa-0c83ca20b6db, content=DENY, timestamp=1641906707849, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-11 13:11:47.855  INFO 17 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=146ms, Total=171ms
2022-01-11 13:11:47.941  INFO 17 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=04e44bd3-4d74-479c-8fa7-d955f9c97245, content=null, timestamp=1641906707916, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=65494, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=9462ddf72b74, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.30.0.1, kc-session-state=115df91e-55fd-4d89-b568-03753c55dee3, http-req-server-port=80, http-header-accept=*/*, kc-id=faa49035-39a2-47eb-9400-cb93a9fe6d10, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641906707903, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd2DNXNxAH4AEQAAAABh3YIJdAAkZmFhNDkwMzUtMzlhMi00N2ViLTk0MDAtY2I5M2E5ZmU2ZDEwdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAXh4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQxMTVkZjkxZS01NWZkLTRkODktYjU2OC0wMzc1M2M1NWRlZTNwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAATaHR0cDovLzE5Mi4xNjguMS44M3hwcHNyAC9vcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2VuJEFjY2VzcwewcQ/lekULAgACTAAFcm9sZXNxAH4AAUwADHZlcmlmeUNhbGxlcnEAfgAKeHBzcQB+ACt3DAAAABA/QAAAAAAABHQADm9mZmxpbmVfYWNjZXNzdAAGbWVtYmVydAAFYWRtaW50ABF1bWFfYXV0aG9yaXphdGlvbnhwc3IAF2phdmEudXRpbC5MaW5rZWRIYXNoTWFwNMBOXBBswPsCAAFaAAthY2Nlc3NPcmRlcnhxAH4AGD9AAAAAAAAMdwgAAAAQAAAAAXQAB2FjY291bnRzcQB+AC5zcQB+ACt3DAAAABA/QAAAAAAAA3QADm1hbmFnZS1hY2NvdW50dAAUbWFuYWdlLWFjY291bnQtbGlua3N0AAx2aWV3LXByb2ZpbGV4cHgAdAANcHJvZmlsZSBlbWFpbHA=, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJFeUZNQnpQUXV6VFFHUzhnWjYwVjJ1LXZxUE4zYm55MFVJSm1HaUpwS2pFIn0.eyJleHAiOjE2NDE5MDY5OTcsImlhdCI6MTY0MTkwNjY5NywianRpIjoiZmFhNDkwMzUtMzlhMi00N2ViLTk0MDAtY2I5M2E5ZmU2ZDEwIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiMTE1ZGY5MWUtNTVmZC00ZDg5LWI1NjgtMDM3NTNjNTVkZWUzIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoieCJ9.RP4jVdLa2GKR1jEUG_Ofs1jSfGSuf9hAaf2-j4R2AHCcLlwOZHQfjtGK56y9rw6Mc7yt4IuTEGT3_0YWpF73nJ5N36X7TcZC0389FvX0FvP5331H4S5EVmOJ7FyGpOHtmkLRXz4dfExVXoNmkyd6BrqB07pTnpObzqEyYxOX88fWlUjDk6RWTDWCykBixaI76kAACr7cHj6JEN_a2AkEpMI4HkZGWG0JnCqZkydE2kfceTUd-pP22WGrHs60GjudxqXJPsI90ESRgnEUGmuXiI5VgPtS_v89gz7KsuRr6RElEpCzvTqNDGXjy8OX7Zi59gzgqCzdmHhL_CD_-QqTiA, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641906997, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=172.30.0.12, kc-type=Bearer, kc-cc--team-ID=x, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.30.0.1, http-session-id=8B3B81F1A6A73EFDAFCB4BD0AF323A84, http-session-last-accessed-time=1641906707903, kc-category-name=ACCESS, kc-iat=1641906697, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.30.0.1:65494 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 13:11:47.950  INFO 17 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 13:11:47.956  INFO 17 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1fdb0b36
2022-01-11 13:11:47.960  INFO 17 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1fdb0b36
2022-01-11 13:11:47.993  INFO 17 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1fdb0b36
2022-01-11 13:11:48.000  INFO 17 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1fdb0b36
2022-01-11 13:11:48.040  INFO 17 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1fdb0b36
2022-01-11 13:11:48.046  WARN 17 --- [https-jsse-nio-7071-exec-1] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: x
2022-01-11 13:11:48.049  WARN 17 --- [https-jsse-nio-7071-exec-1] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: x
2022-01-11 13:11:48.052  INFO 17 --- [https-jsse-nio-7071-exec-1] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-5888802869275-513511, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-11 13:11:48.055  INFO 17 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=04e44bd3-4d74-479c-8fa7-d955f9c97245, content=DENY, timestamp=1641906708055, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-11 13:11:48.060  INFO 17 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=102ms, Total=121ms
2022-01-11 13:11:48.161  INFO 17 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=38a44f78-4620-4a49-b0f6-6e92ddac9b8a, content=null, timestamp=1641906708127, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=65496, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=9462ddf72b74, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.30.0.1, kc-session-state=115df91e-55fd-4d89-b568-03753c55dee3, http-req-server-port=80, http-header-accept=*/*, kc-id=faa49035-39a2-47eb-9400-cb93a9fe6d10, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641906708106, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd2DNXNxAH4AEQAAAABh3YIJdAAkZmFhNDkwMzUtMzlhMi00N2ViLTk0MDAtY2I5M2E5ZmU2ZDEwdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAXh4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQxMTVkZjkxZS01NWZkLTRkODktYjU2OC0wMzc1M2M1NWRlZTNwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAATaHR0cDovLzE5Mi4xNjguMS44M3hwcHNyAC9vcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2VuJEFjY2VzcwewcQ/lekULAgACTAAFcm9sZXNxAH4AAUwADHZlcmlmeUNhbGxlcnEAfgAKeHBzcQB+ACt3DAAAABA/QAAAAAAABHQADm9mZmxpbmVfYWNjZXNzdAAGbWVtYmVydAAFYWRtaW50ABF1bWFfYXV0aG9yaXphdGlvbnhwc3IAF2phdmEudXRpbC5MaW5rZWRIYXNoTWFwNMBOXBBswPsCAAFaAAthY2Nlc3NPcmRlcnhxAH4AGD9AAAAAAAAMdwgAAAAQAAAAAXQAB2FjY291bnRzcQB+AC5zcQB+ACt3DAAAABA/QAAAAAAAA3QADm1hbmFnZS1hY2NvdW50dAAUbWFuYWdlLWFjY291bnQtbGlua3N0AAx2aWV3LXByb2ZpbGV4cHgAdAANcHJvZmlsZSBlbWFpbHA=, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJFeUZNQnpQUXV6VFFHUzhnWjYwVjJ1LXZxUE4zYm55MFVJSm1HaUpwS2pFIn0.eyJleHAiOjE2NDE5MDY5OTcsImlhdCI6MTY0MTkwNjY5NywianRpIjoiZmFhNDkwMzUtMzlhMi00N2ViLTk0MDAtY2I5M2E5ZmU2ZDEwIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiMTE1ZGY5MWUtNTVmZC00ZDg5LWI1NjgtMDM3NTNjNTVkZWUzIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoieCJ9.RP4jVdLa2GKR1jEUG_Ofs1jSfGSuf9hAaf2-j4R2AHCcLlwOZHQfjtGK56y9rw6Mc7yt4IuTEGT3_0YWpF73nJ5N36X7TcZC0389FvX0FvP5331H4S5EVmOJ7FyGpOHtmkLRXz4dfExVXoNmkyd6BrqB07pTnpObzqEyYxOX88fWlUjDk6RWTDWCykBixaI76kAACr7cHj6JEN_a2AkEpMI4HkZGWG0JnCqZkydE2kfceTUd-pP22WGrHs60GjudxqXJPsI90ESRgnEUGmuXiI5VgPtS_v89gz7KsuRr6RElEpCzvTqNDGXjy8OX7Zi59gzgqCzdmHhL_CD_-QqTiA, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641906997, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=172.30.0.12, kc-type=Bearer, kc-cc--team-ID=x, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.30.0.1, http-session-id=F341691BF6E246A852D294343651FCD9, http-session-last-accessed-time=1641906708106, kc-category-name=ACCESS, kc-iat=1641906697, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.30.0.1:65496 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 13:11:48.182  INFO 17 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 13:11:48.198  INFO 17 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7e5b89ce
2022-01-11 13:11:48.206  INFO 17 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7e5b89ce
2022-01-11 13:11:48.254  INFO 17 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7e5b89ce
2022-01-11 13:11:48.260  INFO 17 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7e5b89ce
2022-01-11 13:11:48.335  INFO 17 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7e5b89ce
2022-01-11 13:11:48.339  WARN 17 --- [https-jsse-nio-7071-exec-2] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: x
2022-01-11 13:11:48.343  WARN 17 --- [https-jsse-nio-7071-exec-2] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: x
2022-01-11 13:11:48.350  INFO 17 --- [https-jsse-nio-7071-exec-2] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-5889035245675-813185, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-11 13:11:48.353  INFO 17 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=38a44f78-4620-4a49-b0f6-6e92ddac9b8a, content=DENY, timestamp=1641906708353, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-11 13:11:48.360  INFO 17 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=168ms, Total=207ms
2022-01-11 13:11:48.424  INFO 17 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=bf5f95e5-6837-4920-87cf-6ba86109473a, content=null, timestamp=1641906708415, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=65498, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=9462ddf72b74, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.30.0.1, kc-session-state=115df91e-55fd-4d89-b568-03753c55dee3, http-req-server-port=80, http-header-accept=*/*, kc-id=faa49035-39a2-47eb-9400-cb93a9fe6d10, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641906708412, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd2DNXNxAH4AEQAAAABh3YIJdAAkZmFhNDkwMzUtMzlhMi00N2ViLTk0MDAtY2I5M2E5ZmU2ZDEwdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAXh4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQxMTVkZjkxZS01NWZkLTRkODktYjU2OC0wMzc1M2M1NWRlZTNwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAATaHR0cDovLzE5Mi4xNjguMS44M3hwcHNyAC9vcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2VuJEFjY2VzcwewcQ/lekULAgACTAAFcm9sZXNxAH4AAUwADHZlcmlmeUNhbGxlcnEAfgAKeHBzcQB+ACt3DAAAABA/QAAAAAAABHQADm9mZmxpbmVfYWNjZXNzdAAGbWVtYmVydAAFYWRtaW50ABF1bWFfYXV0aG9yaXphdGlvbnhwc3IAF2phdmEudXRpbC5MaW5rZWRIYXNoTWFwNMBOXBBswPsCAAFaAAthY2Nlc3NPcmRlcnhxAH4AGD9AAAAAAAAMdwgAAAAQAAAAAXQAB2FjY291bnRzcQB+AC5zcQB+ACt3DAAAABA/QAAAAAAAA3QADm1hbmFnZS1hY2NvdW50dAAUbWFuYWdlLWFjY291bnQtbGlua3N0AAx2aWV3LXByb2ZpbGV4cHgAdAANcHJvZmlsZSBlbWFpbHA=, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJFeUZNQnpQUXV6VFFHUzhnWjYwVjJ1LXZxUE4zYm55MFVJSm1HaUpwS2pFIn0.eyJleHAiOjE2NDE5MDY5OTcsImlhdCI6MTY0MTkwNjY5NywianRpIjoiZmFhNDkwMzUtMzlhMi00N2ViLTk0MDAtY2I5M2E5ZmU2ZDEwIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiMTE1ZGY5MWUtNTVmZC00ZDg5LWI1NjgtMDM3NTNjNTVkZWUzIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoieCJ9.RP4jVdLa2GKR1jEUG_Ofs1jSfGSuf9hAaf2-j4R2AHCcLlwOZHQfjtGK56y9rw6Mc7yt4IuTEGT3_0YWpF73nJ5N36X7TcZC0389FvX0FvP5331H4S5EVmOJ7FyGpOHtmkLRXz4dfExVXoNmkyd6BrqB07pTnpObzqEyYxOX88fWlUjDk6RWTDWCykBixaI76kAACr7cHj6JEN_a2AkEpMI4HkZGWG0JnCqZkydE2kfceTUd-pP22WGrHs60GjudxqXJPsI90ESRgnEUGmuXiI5VgPtS_v89gz7KsuRr6RElEpCzvTqNDGXjy8OX7Zi59gzgqCzdmHhL_CD_-QqTiA, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641906997, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=172.30.0.12, kc-type=Bearer, kc-cc--team-ID=x, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.30.0.1, http-session-id=B3C6909E9124E2A761171996F6946E81, http-session-last-accessed-time=1641906708412, kc-category-name=ACCESS, kc-iat=1641906697, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.30.0.1:65498 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 13:11:48.439  INFO 17 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 13:11:48.451  INFO 17 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6a9ed458
2022-01-11 13:11:48.456  INFO 17 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6a9ed458
2022-01-11 13:11:48.488  INFO 17 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6a9ed458
2022-01-11 13:11:48.494  INFO 17 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6a9ed458
2022-01-11 13:11:48.524  INFO 17 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6a9ed458
2022-01-11 13:11:48.527  WARN 17 --- [https-jsse-nio-7071-exec-3] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: x
2022-01-11 13:11:48.531  WARN 17 --- [https-jsse-nio-7071-exec-3] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: x
2022-01-11 13:11:48.536  INFO 17 --- [https-jsse-nio-7071-exec-3] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-5889294240275-949526, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-11 13:11:48.541  INFO 17 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=bf5f95e5-6837-4920-87cf-6ba86109473a, content=DENY, timestamp=1641906708541, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-11 13:11:48.544  INFO 17 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=97ms, Total=122ms
2022-01-11 13:11:48.610  INFO 17 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=ca62d25e-ff61-44f2-af76-8b3681718443, content=null, timestamp=1641906708597, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=65500, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=9462ddf72b74, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.30.0.1, kc-session-state=115df91e-55fd-4d89-b568-03753c55dee3, http-req-server-port=80, http-header-accept=*/*, kc-id=faa49035-39a2-47eb-9400-cb93a9fe6d10, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641906708594, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd2DNXNxAH4AEQAAAABh3YIJdAAkZmFhNDkwMzUtMzlhMi00N2ViLTk0MDAtY2I5M2E5ZmU2ZDEwdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAXh4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQxMTVkZjkxZS01NWZkLTRkODktYjU2OC0wMzc1M2M1NWRlZTNwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAATaHR0cDovLzE5Mi4xNjguMS44M3hwcHNyAC9vcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2VuJEFjY2VzcwewcQ/lekULAgACTAAFcm9sZXNxAH4AAUwADHZlcmlmeUNhbGxlcnEAfgAKeHBzcQB+ACt3DAAAABA/QAAAAAAABHQADm9mZmxpbmVfYWNjZXNzdAAGbWVtYmVydAAFYWRtaW50ABF1bWFfYXV0aG9yaXphdGlvbnhwc3IAF2phdmEudXRpbC5MaW5rZWRIYXNoTWFwNMBOXBBswPsCAAFaAAthY2Nlc3NPcmRlcnhxAH4AGD9AAAAAAAAMdwgAAAAQAAAAAXQAB2FjY291bnRzcQB+AC5zcQB+ACt3DAAAABA/QAAAAAAAA3QADm1hbmFnZS1hY2NvdW50dAAUbWFuYWdlLWFjY291bnQtbGlua3N0AAx2aWV3LXByb2ZpbGV4cHgAdAANcHJvZmlsZSBlbWFpbHA=, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJFeUZNQnpQUXV6VFFHUzhnWjYwVjJ1LXZxUE4zYm55MFVJSm1HaUpwS2pFIn0.eyJleHAiOjE2NDE5MDY5OTcsImlhdCI6MTY0MTkwNjY5NywianRpIjoiZmFhNDkwMzUtMzlhMi00N2ViLTk0MDAtY2I5M2E5ZmU2ZDEwIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiMTE1ZGY5MWUtNTVmZC00ZDg5LWI1NjgtMDM3NTNjNTVkZWUzIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoieCJ9.RP4jVdLa2GKR1jEUG_Ofs1jSfGSuf9hAaf2-j4R2AHCcLlwOZHQfjtGK56y9rw6Mc7yt4IuTEGT3_0YWpF73nJ5N36X7TcZC0389FvX0FvP5331H4S5EVmOJ7FyGpOHtmkLRXz4dfExVXoNmkyd6BrqB07pTnpObzqEyYxOX88fWlUjDk6RWTDWCykBixaI76kAACr7cHj6JEN_a2AkEpMI4HkZGWG0JnCqZkydE2kfceTUd-pP22WGrHs60GjudxqXJPsI90ESRgnEUGmuXiI5VgPtS_v89gz7KsuRr6RElEpCzvTqNDGXjy8OX7Zi59gzgqCzdmHhL_CD_-QqTiA, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641906997, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=172.30.0.12, kc-type=Bearer, kc-cc--team-ID=x, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.30.0.1, http-session-id=A775B12C308B313A5823B280AC78AAE9, http-session-last-accessed-time=1641906708594, kc-category-name=ACCESS, kc-iat=1641906697, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.30.0.1:65500 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 13:11:48.618  INFO 17 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 13:11:48.624  INFO 17 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@41f7818
2022-01-11 13:11:48.629  INFO 17 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@41f7818
2022-01-11 13:11:48.661  INFO 17 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@41f7818
2022-01-11 13:11:48.665  INFO 17 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@41f7818
2022-01-11 13:11:48.704  INFO 17 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@41f7818
2022-01-11 13:11:48.710  WARN 17 --- [https-jsse-nio-7071-exec-4] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: x
2022-01-11 13:11:48.712  WARN 17 --- [https-jsse-nio-7071-exec-4] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: x
2022-01-11 13:11:48.717  INFO 17 --- [https-jsse-nio-7071-exec-4] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-5889471617075-84875, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-11 13:11:48.719  INFO 17 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=ca62d25e-ff61-44f2-af76-8b3681718443, content=DENY, timestamp=1641906708719, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-11 13:11:48.723  INFO 17 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=97ms, Total=120ms
2022-01-11 13:11:48.786  INFO 17 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=dfc6adcb-b4bb-43c0-86c2-51099f548588, content=null, timestamp=1641906708772, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=65502, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=9462ddf72b74, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.30.0.1, kc-session-state=115df91e-55fd-4d89-b568-03753c55dee3, http-req-server-port=80, http-header-accept=*/*, kc-id=faa49035-39a2-47eb-9400-cb93a9fe6d10, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641906708768, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd2DNXNxAH4AEQAAAABh3YIJdAAkZmFhNDkwMzUtMzlhMi00N2ViLTk0MDAtY2I5M2E5ZmU2ZDEwdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAXh4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQxMTVkZjkxZS01NWZkLTRkODktYjU2OC0wMzc1M2M1NWRlZTNwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAATaHR0cDovLzE5Mi4xNjguMS44M3hwcHNyAC9vcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2VuJEFjY2VzcwewcQ/lekULAgACTAAFcm9sZXNxAH4AAUwADHZlcmlmeUNhbGxlcnEAfgAKeHBzcQB+ACt3DAAAABA/QAAAAAAABHQADm9mZmxpbmVfYWNjZXNzdAAGbWVtYmVydAAFYWRtaW50ABF1bWFfYXV0aG9yaXphdGlvbnhwc3IAF2phdmEudXRpbC5MaW5rZWRIYXNoTWFwNMBOXBBswPsCAAFaAAthY2Nlc3NPcmRlcnhxAH4AGD9AAAAAAAAMdwgAAAAQAAAAAXQAB2FjY291bnRzcQB+AC5zcQB+ACt3DAAAABA/QAAAAAAAA3QADm1hbmFnZS1hY2NvdW50dAAUbWFuYWdlLWFjY291bnQtbGlua3N0AAx2aWV3LXByb2ZpbGV4cHgAdAANcHJvZmlsZSBlbWFpbHA=, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJFeUZNQnpQUXV6VFFHUzhnWjYwVjJ1LXZxUE4zYm55MFVJSm1HaUpwS2pFIn0.eyJleHAiOjE2NDE5MDY5OTcsImlhdCI6MTY0MTkwNjY5NywianRpIjoiZmFhNDkwMzUtMzlhMi00N2ViLTk0MDAtY2I5M2E5ZmU2ZDEwIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiMTE1ZGY5MWUtNTVmZC00ZDg5LWI1NjgtMDM3NTNjNTVkZWUzIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoieCJ9.RP4jVdLa2GKR1jEUG_Ofs1jSfGSuf9hAaf2-j4R2AHCcLlwOZHQfjtGK56y9rw6Mc7yt4IuTEGT3_0YWpF73nJ5N36X7TcZC0389FvX0FvP5331H4S5EVmOJ7FyGpOHtmkLRXz4dfExVXoNmkyd6BrqB07pTnpObzqEyYxOX88fWlUjDk6RWTDWCykBixaI76kAACr7cHj6JEN_a2AkEpMI4HkZGWG0JnCqZkydE2kfceTUd-pP22WGrHs60GjudxqXJPsI90ESRgnEUGmuXiI5VgPtS_v89gz7KsuRr6RElEpCzvTqNDGXjy8OX7Zi59gzgqCzdmHhL_CD_-QqTiA, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641906997, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=172.30.0.12, kc-type=Bearer, kc-cc--team-ID=x, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.30.0.1, http-session-id=A1D132A4A0219ACFB8BCEE8CD7C5B69B, http-session-last-accessed-time=1641906708768, kc-category-name=ACCESS, kc-iat=1641906697, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.30.0.1:65502 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 13:11:48.938  INFO 17 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 13:11:48.948  INFO 17 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@53f1d4f7
2022-01-11 13:11:48.951  INFO 17 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@53f1d4f7
2022-01-11 13:11:48.994  INFO 17 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@53f1d4f7
2022-01-11 13:11:49.009  INFO 17 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@53f1d4f7
2022-01-11 13:11:49.100  INFO 17 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@53f1d4f7
2022-01-11 13:11:49.105  WARN 17 --- [https-jsse-nio-7071-exec-5] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: x
2022-01-11 13:11:49.107  WARN 17 --- [https-jsse-nio-7071-exec-5] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: x
2022-01-11 13:11:49.110  INFO 17 --- [https-jsse-nio-7071-exec-5] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-5889791443475-451416, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-11 13:11:49.112  INFO 17 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=dfc6adcb-b4bb-43c0-86c2-51099f548588, content=DENY, timestamp=1641906709112, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-11 13:11:49.118  INFO 17 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=171ms, Total=333ms
2022-01-11 13:11:49.179  INFO 17 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=9e1972ce-801c-4704-b86b-42638f0b0a31, content=null, timestamp=1641906709169, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=65504, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=9462ddf72b74, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.30.0.1, kc-session-state=115df91e-55fd-4d89-b568-03753c55dee3, http-req-server-port=80, http-header-accept=*/*, kc-id=faa49035-39a2-47eb-9400-cb93a9fe6d10, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641906709157, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd2DNXNxAH4AEQAAAABh3YIJdAAkZmFhNDkwMzUtMzlhMi00N2ViLTk0MDAtY2I5M2E5ZmU2ZDEwdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAXh4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQxMTVkZjkxZS01NWZkLTRkODktYjU2OC0wMzc1M2M1NWRlZTNwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAATaHR0cDovLzE5Mi4xNjguMS44M3hwcHNyAC9vcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2VuJEFjY2VzcwewcQ/lekULAgACTAAFcm9sZXNxAH4AAUwADHZlcmlmeUNhbGxlcnEAfgAKeHBzcQB+ACt3DAAAABA/QAAAAAAABHQADm9mZmxpbmVfYWNjZXNzdAAGbWVtYmVydAAFYWRtaW50ABF1bWFfYXV0aG9yaXphdGlvbnhwc3IAF2phdmEudXRpbC5MaW5rZWRIYXNoTWFwNMBOXBBswPsCAAFaAAthY2Nlc3NPcmRlcnhxAH4AGD9AAAAAAAAMdwgAAAAQAAAAAXQAB2FjY291bnRzcQB+AC5zcQB+ACt3DAAAABA/QAAAAAAAA3QADm1hbmFnZS1hY2NvdW50dAAUbWFuYWdlLWFjY291bnQtbGlua3N0AAx2aWV3LXByb2ZpbGV4cHgAdAANcHJvZmlsZSBlbWFpbHA=, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJFeUZNQnpQUXV6VFFHUzhnWjYwVjJ1LXZxUE4zYm55MFVJSm1HaUpwS2pFIn0.eyJleHAiOjE2NDE5MDY5OTcsImlhdCI6MTY0MTkwNjY5NywianRpIjoiZmFhNDkwMzUtMzlhMi00N2ViLTk0MDAtY2I5M2E5ZmU2ZDEwIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiMTE1ZGY5MWUtNTVmZC00ZDg5LWI1NjgtMDM3NTNjNTVkZWUzIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoieCJ9.RP4jVdLa2GKR1jEUG_Ofs1jSfGSuf9hAaf2-j4R2AHCcLlwOZHQfjtGK56y9rw6Mc7yt4IuTEGT3_0YWpF73nJ5N36X7TcZC0389FvX0FvP5331H4S5EVmOJ7FyGpOHtmkLRXz4dfExVXoNmkyd6BrqB07pTnpObzqEyYxOX88fWlUjDk6RWTDWCykBixaI76kAACr7cHj6JEN_a2AkEpMI4HkZGWG0JnCqZkydE2kfceTUd-pP22WGrHs60GjudxqXJPsI90ESRgnEUGmuXiI5VgPtS_v89gz7KsuRr6RElEpCzvTqNDGXjy8OX7Zi59gzgqCzdmHhL_CD_-QqTiA, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641906997, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=172.30.0.12, kc-type=Bearer, kc-cc--team-ID=x, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.30.0.1, http-session-id=51E87D825B1A6BC00DA7FFC2CF8516C9, http-session-last-accessed-time=1641906709157, kc-category-name=ACCESS, kc-iat=1641906697, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.30.0.1:65504 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 13:11:49.189  INFO 17 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 13:11:49.196  INFO 17 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@43c5ff0
2022-01-11 13:11:49.207  INFO 17 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@43c5ff0
2022-01-11 13:11:49.252  INFO 17 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@43c5ff0
2022-01-11 13:11:49.257  INFO 17 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@43c5ff0
2022-01-11 13:11:49.293  INFO 17 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@43c5ff0
2022-01-11 13:11:49.301  WARN 17 --- [https-jsse-nio-7071-exec-6] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: x
2022-01-11 13:11:49.303  WARN 17 --- [https-jsse-nio-7071-exec-6] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: x
2022-01-11 13:11:49.311  INFO 17 --- [https-jsse-nio-7071-exec-6] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-5890042876875-986040, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-11 13:11:49.331  INFO 17 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=9e1972ce-801c-4704-b86b-42638f0b0a31, content=DENY, timestamp=1641906709331, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-11 13:11:49.337  INFO 17 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=138ms, Total=159ms
2022-01-11 13:11:49.432  INFO 17 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=9aeb8f94-4ca4-402e-aec9-b4c1303bcb0f, content=null, timestamp=1641906709410, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=65506, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=9462ddf72b74, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.30.0.1, kc-session-state=115df91e-55fd-4d89-b568-03753c55dee3, http-req-server-port=80, http-header-accept=*/*, kc-id=faa49035-39a2-47eb-9400-cb93a9fe6d10, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641906709385, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd2DNXNxAH4AEQAAAABh3YIJdAAkZmFhNDkwMzUtMzlhMi00N2ViLTk0MDAtY2I5M2E5ZmU2ZDEwdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAXh4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQxMTVkZjkxZS01NWZkLTRkODktYjU2OC0wMzc1M2M1NWRlZTNwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAATaHR0cDovLzE5Mi4xNjguMS44M3hwcHNyAC9vcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2VuJEFjY2VzcwewcQ/lekULAgACTAAFcm9sZXNxAH4AAUwADHZlcmlmeUNhbGxlcnEAfgAKeHBzcQB+ACt3DAAAABA/QAAAAAAABHQADm9mZmxpbmVfYWNjZXNzdAAGbWVtYmVydAAFYWRtaW50ABF1bWFfYXV0aG9yaXphdGlvbnhwc3IAF2phdmEudXRpbC5MaW5rZWRIYXNoTWFwNMBOXBBswPsCAAFaAAthY2Nlc3NPcmRlcnhxAH4AGD9AAAAAAAAMdwgAAAAQAAAAAXQAB2FjY291bnRzcQB+AC5zcQB+ACt3DAAAABA/QAAAAAAAA3QADm1hbmFnZS1hY2NvdW50dAAUbWFuYWdlLWFjY291bnQtbGlua3N0AAx2aWV3LXByb2ZpbGV4cHgAdAANcHJvZmlsZSBlbWFpbHA=, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJFeUZNQnpQUXV6VFFHUzhnWjYwVjJ1LXZxUE4zYm55MFVJSm1HaUpwS2pFIn0.eyJleHAiOjE2NDE5MDY5OTcsImlhdCI6MTY0MTkwNjY5NywianRpIjoiZmFhNDkwMzUtMzlhMi00N2ViLTk0MDAtY2I5M2E5ZmU2ZDEwIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiMTE1ZGY5MWUtNTVmZC00ZDg5LWI1NjgtMDM3NTNjNTVkZWUzIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoieCJ9.RP4jVdLa2GKR1jEUG_Ofs1jSfGSuf9hAaf2-j4R2AHCcLlwOZHQfjtGK56y9rw6Mc7yt4IuTEGT3_0YWpF73nJ5N36X7TcZC0389FvX0FvP5331H4S5EVmOJ7FyGpOHtmkLRXz4dfExVXoNmkyd6BrqB07pTnpObzqEyYxOX88fWlUjDk6RWTDWCykBixaI76kAACr7cHj6JEN_a2AkEpMI4HkZGWG0JnCqZkydE2kfceTUd-pP22WGrHs60GjudxqXJPsI90ESRgnEUGmuXiI5VgPtS_v89gz7KsuRr6RElEpCzvTqNDGXjy8OX7Zi59gzgqCzdmHhL_CD_-QqTiA, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641906997, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=172.30.0.12, kc-type=Bearer, kc-cc--team-ID=x, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.30.0.1, http-session-id=324A4D610C8E7EE209FD2D458495CE95, http-session-last-accessed-time=1641906709385, kc-category-name=ACCESS, kc-iat=1641906697, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.30.0.1:65506 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 13:11:49.437  INFO 17 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 13:11:49.452  INFO 17 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3992feb1
2022-01-11 13:11:49.457  INFO 17 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3992feb1
2022-01-11 13:11:49.503  INFO 17 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3992feb1
2022-01-11 13:11:49.506  INFO 17 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3992feb1
2022-01-11 13:11:49.528  INFO 17 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3992feb1
2022-01-11 13:11:49.533  WARN 17 --- [https-jsse-nio-7071-exec-7] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: x
2022-01-11 13:11:49.541  WARN 17 --- [https-jsse-nio-7071-exec-7] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: x
2022-01-11 13:11:49.550  INFO 17 --- [https-jsse-nio-7071-exec-7] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-5890289868275-924865, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-11 13:11:49.552  INFO 17 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=9aeb8f94-4ca4-402e-aec9-b4c1303bcb0f, content=DENY, timestamp=1641906709552, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-11 13:11:49.555  INFO 17 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=112ms, Total=125ms
2022-01-11 13:11:49.644  INFO 17 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=cab1d232-a751-4dbb-8870-8307d040c8d1, content=null, timestamp=1641906709621, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=65508, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=9462ddf72b74, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.30.0.1, kc-session-state=115df91e-55fd-4d89-b568-03753c55dee3, http-req-server-port=80, http-header-accept=*/*, kc-id=faa49035-39a2-47eb-9400-cb93a9fe6d10, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641906709613, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd2DNXNxAH4AEQAAAABh3YIJdAAkZmFhNDkwMzUtMzlhMi00N2ViLTk0MDAtY2I5M2E5ZmU2ZDEwdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAXh4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQxMTVkZjkxZS01NWZkLTRkODktYjU2OC0wMzc1M2M1NWRlZTNwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAATaHR0cDovLzE5Mi4xNjguMS44M3hwcHNyAC9vcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2VuJEFjY2VzcwewcQ/lekULAgACTAAFcm9sZXNxAH4AAUwADHZlcmlmeUNhbGxlcnEAfgAKeHBzcQB+ACt3DAAAABA/QAAAAAAABHQADm9mZmxpbmVfYWNjZXNzdAAGbWVtYmVydAAFYWRtaW50ABF1bWFfYXV0aG9yaXphdGlvbnhwc3IAF2phdmEudXRpbC5MaW5rZWRIYXNoTWFwNMBOXBBswPsCAAFaAAthY2Nlc3NPcmRlcnhxAH4AGD9AAAAAAAAMdwgAAAAQAAAAAXQAB2FjY291bnRzcQB+AC5zcQB+ACt3DAAAABA/QAAAAAAAA3QADm1hbmFnZS1hY2NvdW50dAAUbWFuYWdlLWFjY291bnQtbGlua3N0AAx2aWV3LXByb2ZpbGV4cHgAdAANcHJvZmlsZSBlbWFpbHA=, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJFeUZNQnpQUXV6VFFHUzhnWjYwVjJ1LXZxUE4zYm55MFVJSm1HaUpwS2pFIn0.eyJleHAiOjE2NDE5MDY5OTcsImlhdCI6MTY0MTkwNjY5NywianRpIjoiZmFhNDkwMzUtMzlhMi00N2ViLTk0MDAtY2I5M2E5ZmU2ZDEwIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiMTE1ZGY5MWUtNTVmZC00ZDg5LWI1NjgtMDM3NTNjNTVkZWUzIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoieCJ9.RP4jVdLa2GKR1jEUG_Ofs1jSfGSuf9hAaf2-j4R2AHCcLlwOZHQfjtGK56y9rw6Mc7yt4IuTEGT3_0YWpF73nJ5N36X7TcZC0389FvX0FvP5331H4S5EVmOJ7FyGpOHtmkLRXz4dfExVXoNmkyd6BrqB07pTnpObzqEyYxOX88fWlUjDk6RWTDWCykBixaI76kAACr7cHj6JEN_a2AkEpMI4HkZGWG0JnCqZkydE2kfceTUd-pP22WGrHs60GjudxqXJPsI90ESRgnEUGmuXiI5VgPtS_v89gz7KsuRr6RElEpCzvTqNDGXjy8OX7Zi59gzgqCzdmHhL_CD_-QqTiA, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641906997, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=172.30.0.12, kc-type=Bearer, kc-cc--team-ID=x, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.30.0.1, http-session-id=F7F55DB567CC74FFDDEFD27E8E557814, http-session-last-accessed-time=1641906709613, kc-category-name=ACCESS, kc-iat=1641906697, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.30.0.1:65508 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 13:11:49.658  INFO 17 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 13:11:49.685  INFO 17 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3ac6082e
2022-01-11 13:11:49.691  INFO 17 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3ac6082e
2022-01-11 13:11:49.741  INFO 17 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3ac6082e
2022-01-11 13:11:49.746  INFO 17 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3ac6082e
2022-01-11 13:11:49.812  INFO 17 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3ac6082e
2022-01-11 13:11:49.815  WARN 17 --- [https-jsse-nio-7071-exec-8] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: x
2022-01-11 13:11:49.818  WARN 17 --- [https-jsse-nio-7071-exec-8] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: x
2022-01-11 13:11:49.821  INFO 17 --- [https-jsse-nio-7071-exec-8] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-5890519837475-882937, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-11 13:11:49.829  INFO 17 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=cab1d232-a751-4dbb-8870-8307d040c8d1, content=DENY, timestamp=1641906709829, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-11 13:11:49.839  INFO 17 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=159ms, Total=198ms
2022-01-11 13:11:49.906  INFO 17 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=7eaa2647-5e28-426b-b5f3-5fdc93f2770d, content=null, timestamp=1641906709886, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=65510, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=9462ddf72b74, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.30.0.1, kc-session-state=115df91e-55fd-4d89-b568-03753c55dee3, http-req-server-port=80, http-header-accept=*/*, kc-id=faa49035-39a2-47eb-9400-cb93a9fe6d10, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641906709872, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd2DNXNxAH4AEQAAAABh3YIJdAAkZmFhNDkwMzUtMzlhMi00N2ViLTk0MDAtY2I5M2E5ZmU2ZDEwdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAXh4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQxMTVkZjkxZS01NWZkLTRkODktYjU2OC0wMzc1M2M1NWRlZTNwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAATaHR0cDovLzE5Mi4xNjguMS44M3hwcHNyAC9vcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2VuJEFjY2VzcwewcQ/lekULAgACTAAFcm9sZXNxAH4AAUwADHZlcmlmeUNhbGxlcnEAfgAKeHBzcQB+ACt3DAAAABA/QAAAAAAABHQADm9mZmxpbmVfYWNjZXNzdAAGbWVtYmVydAAFYWRtaW50ABF1bWFfYXV0aG9yaXphdGlvbnhwc3IAF2phdmEudXRpbC5MaW5rZWRIYXNoTWFwNMBOXBBswPsCAAFaAAthY2Nlc3NPcmRlcnhxAH4AGD9AAAAAAAAMdwgAAAAQAAAAAXQAB2FjY291bnRzcQB+AC5zcQB+ACt3DAAAABA/QAAAAAAAA3QADm1hbmFnZS1hY2NvdW50dAAUbWFuYWdlLWFjY291bnQtbGlua3N0AAx2aWV3LXByb2ZpbGV4cHgAdAANcHJvZmlsZSBlbWFpbHA=, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJFeUZNQnpQUXV6VFFHUzhnWjYwVjJ1LXZxUE4zYm55MFVJSm1HaUpwS2pFIn0.eyJleHAiOjE2NDE5MDY5OTcsImlhdCI6MTY0MTkwNjY5NywianRpIjoiZmFhNDkwMzUtMzlhMi00N2ViLTk0MDAtY2I5M2E5ZmU2ZDEwIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiMTE1ZGY5MWUtNTVmZC00ZDg5LWI1NjgtMDM3NTNjNTVkZWUzIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoieCJ9.RP4jVdLa2GKR1jEUG_Ofs1jSfGSuf9hAaf2-j4R2AHCcLlwOZHQfjtGK56y9rw6Mc7yt4IuTEGT3_0YWpF73nJ5N36X7TcZC0389FvX0FvP5331H4S5EVmOJ7FyGpOHtmkLRXz4dfExVXoNmkyd6BrqB07pTnpObzqEyYxOX88fWlUjDk6RWTDWCykBixaI76kAACr7cHj6JEN_a2AkEpMI4HkZGWG0JnCqZkydE2kfceTUd-pP22WGrHs60GjudxqXJPsI90ESRgnEUGmuXiI5VgPtS_v89gz7KsuRr6RElEpCzvTqNDGXjy8OX7Zi59gzgqCzdmHhL_CD_-QqTiA, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641906997, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=172.30.0.12, kc-type=Bearer, kc-cc--team-ID=x, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.30.0.1, http-session-id=EF00DF6D6592FC193EC92CA6DC2A306C, http-session-last-accessed-time=1641906709872, kc-category-name=ACCESS, kc-iat=1641906697, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.30.0.1:65510 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 13:11:49.911  INFO 17 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 13:11:49.938  INFO 17 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@227cb110
2022-01-11 13:11:49.949  INFO 17 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@227cb110
2022-01-11 13:11:50.000  INFO 17 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@227cb110
2022-01-11 13:11:50.012  INFO 17 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@227cb110
2022-01-11 13:11:50.063  INFO 17 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@227cb110
2022-01-11 13:11:50.072  WARN 17 --- [https-jsse-nio-7071-exec-9] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: x
2022-01-11 13:11:50.076  WARN 17 --- [https-jsse-nio-7071-exec-9] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: x
2022-01-11 13:11:50.082  INFO 17 --- [https-jsse-nio-7071-exec-9] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-5890765500675-748890, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-11 13:11:50.088  INFO 17 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=7eaa2647-5e28-426b-b5f3-5fdc93f2770d, content=DENY, timestamp=1641906710088, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-11 13:11:50.095  INFO 17 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=172ms, Total=189ms
2022-01-11 13:11:50.172  INFO 17 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=178e880c-f12a-479f-9696-2f472201d1a2, content=null, timestamp=1641906710157, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=65512, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=9462ddf72b74, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.30.0.1, kc-session-state=115df91e-55fd-4d89-b568-03753c55dee3, http-req-server-port=80, http-header-accept=*/*, kc-id=faa49035-39a2-47eb-9400-cb93a9fe6d10, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641906710147, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd2DNXNxAH4AEQAAAABh3YIJdAAkZmFhNDkwMzUtMzlhMi00N2ViLTk0MDAtY2I5M2E5ZmU2ZDEwdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAXh4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQxMTVkZjkxZS01NWZkLTRkODktYjU2OC0wMzc1M2M1NWRlZTNwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAATaHR0cDovLzE5Mi4xNjguMS44M3hwcHNyAC9vcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2VuJEFjY2VzcwewcQ/lekULAgACTAAFcm9sZXNxAH4AAUwADHZlcmlmeUNhbGxlcnEAfgAKeHBzcQB+ACt3DAAAABA/QAAAAAAABHQADm9mZmxpbmVfYWNjZXNzdAAGbWVtYmVydAAFYWRtaW50ABF1bWFfYXV0aG9yaXphdGlvbnhwc3IAF2phdmEudXRpbC5MaW5rZWRIYXNoTWFwNMBOXBBswPsCAAFaAAthY2Nlc3NPcmRlcnhxAH4AGD9AAAAAAAAMdwgAAAAQAAAAAXQAB2FjY291bnRzcQB+AC5zcQB+ACt3DAAAABA/QAAAAAAAA3QADm1hbmFnZS1hY2NvdW50dAAUbWFuYWdlLWFjY291bnQtbGlua3N0AAx2aWV3LXByb2ZpbGV4cHgAdAANcHJvZmlsZSBlbWFpbHA=, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJFeUZNQnpQUXV6VFFHUzhnWjYwVjJ1LXZxUE4zYm55MFVJSm1HaUpwS2pFIn0.eyJleHAiOjE2NDE5MDY5OTcsImlhdCI6MTY0MTkwNjY5NywianRpIjoiZmFhNDkwMzUtMzlhMi00N2ViLTk0MDAtY2I5M2E5ZmU2ZDEwIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiMTE1ZGY5MWUtNTVmZC00ZDg5LWI1NjgtMDM3NTNjNTVkZWUzIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoieCJ9.RP4jVdLa2GKR1jEUG_Ofs1jSfGSuf9hAaf2-j4R2AHCcLlwOZHQfjtGK56y9rw6Mc7yt4IuTEGT3_0YWpF73nJ5N36X7TcZC0389FvX0FvP5331H4S5EVmOJ7FyGpOHtmkLRXz4dfExVXoNmkyd6BrqB07pTnpObzqEyYxOX88fWlUjDk6RWTDWCykBixaI76kAACr7cHj6JEN_a2AkEpMI4HkZGWG0JnCqZkydE2kfceTUd-pP22WGrHs60GjudxqXJPsI90ESRgnEUGmuXiI5VgPtS_v89gz7KsuRr6RElEpCzvTqNDGXjy8OX7Zi59gzgqCzdmHhL_CD_-QqTiA, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641906997, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=172.30.0.12, kc-type=Bearer, kc-cc--team-ID=x, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.30.0.1, http-session-id=68A24A4080057E5CF3AF92F54023C2AC, http-session-last-accessed-time=1641906710147, kc-category-name=ACCESS, kc-iat=1641906697, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.30.0.1:65512 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 13:11:50.178  INFO 17 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 13:11:50.187  INFO 17 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@602470e0
2022-01-11 13:11:50.207  INFO 17 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@602470e0
2022-01-11 13:11:50.294  INFO 17 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@602470e0
2022-01-11 13:11:50.299  INFO 17 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@602470e0
2022-01-11 13:11:50.364  INFO 17 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@602470e0
2022-01-11 13:11:50.368  WARN 17 --- [https-jsse-nio-7071-exec-10] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: x
2022-01-11 13:11:50.370  WARN 17 --- [https-jsse-nio-7071-exec-10] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: x
2022-01-11 13:11:50.375  INFO 17 --- [https-jsse-nio-7071-exec-10] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-5891032887075-237468, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-11 13:11:50.382  INFO 17 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=178e880c-f12a-479f-9696-2f472201d1a2, content=DENY, timestamp=1641906710382, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-11 13:11:50.385  INFO 17 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=197ms, Total=215ms
2022-01-11 13:11:50.455  INFO 17 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=15123f52-2146-428b-bcf1-d4c38227bbd5, content=null, timestamp=1641906710439, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=65514, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=9462ddf72b74, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.30.0.1, kc-session-state=115df91e-55fd-4d89-b568-03753c55dee3, http-req-server-port=80, http-header-accept=*/*, kc-id=faa49035-39a2-47eb-9400-cb93a9fe6d10, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641906710433, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd2DNXNxAH4AEQAAAABh3YIJdAAkZmFhNDkwMzUtMzlhMi00N2ViLTk0MDAtY2I5M2E5ZmU2ZDEwdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAXh4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQxMTVkZjkxZS01NWZkLTRkODktYjU2OC0wMzc1M2M1NWRlZTNwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAATaHR0cDovLzE5Mi4xNjguMS44M3hwcHNyAC9vcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2VuJEFjY2VzcwewcQ/lekULAgACTAAFcm9sZXNxAH4AAUwADHZlcmlmeUNhbGxlcnEAfgAKeHBzcQB+ACt3DAAAABA/QAAAAAAABHQADm9mZmxpbmVfYWNjZXNzdAAGbWVtYmVydAAFYWRtaW50ABF1bWFfYXV0aG9yaXphdGlvbnhwc3IAF2phdmEudXRpbC5MaW5rZWRIYXNoTWFwNMBOXBBswPsCAAFaAAthY2Nlc3NPcmRlcnhxAH4AGD9AAAAAAAAMdwgAAAAQAAAAAXQAB2FjY291bnRzcQB+AC5zcQB+ACt3DAAAABA/QAAAAAAAA3QADm1hbmFnZS1hY2NvdW50dAAUbWFuYWdlLWFjY291bnQtbGlua3N0AAx2aWV3LXByb2ZpbGV4cHgAdAANcHJvZmlsZSBlbWFpbHA=, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJFeUZNQnpQUXV6VFFHUzhnWjYwVjJ1LXZxUE4zYm55MFVJSm1HaUpwS2pFIn0.eyJleHAiOjE2NDE5MDY5OTcsImlhdCI6MTY0MTkwNjY5NywianRpIjoiZmFhNDkwMzUtMzlhMi00N2ViLTk0MDAtY2I5M2E5ZmU2ZDEwIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiMTE1ZGY5MWUtNTVmZC00ZDg5LWI1NjgtMDM3NTNjNTVkZWUzIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoieCJ9.RP4jVdLa2GKR1jEUG_Ofs1jSfGSuf9hAaf2-j4R2AHCcLlwOZHQfjtGK56y9rw6Mc7yt4IuTEGT3_0YWpF73nJ5N36X7TcZC0389FvX0FvP5331H4S5EVmOJ7FyGpOHtmkLRXz4dfExVXoNmkyd6BrqB07pTnpObzqEyYxOX88fWlUjDk6RWTDWCykBixaI76kAACr7cHj6JEN_a2AkEpMI4HkZGWG0JnCqZkydE2kfceTUd-pP22WGrHs60GjudxqXJPsI90ESRgnEUGmuXiI5VgPtS_v89gz7KsuRr6RElEpCzvTqNDGXjy8OX7Zi59gzgqCzdmHhL_CD_-QqTiA, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641906997, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=172.30.0.12, kc-type=Bearer, kc-cc--team-ID=x, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.30.0.1, http-session-id=4B6D08E8CA9129F6FC77799382085EAB, http-session-last-accessed-time=1641906710433, kc-category-name=ACCESS, kc-iat=1641906697, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.30.0.1:65514 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 13:11:50.468  INFO 17 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 13:11:50.475  INFO 17 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6503aaab
2022-01-11 13:11:50.478  INFO 17 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6503aaab
2022-01-11 13:11:50.533  INFO 17 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6503aaab
2022-01-11 13:11:50.537  INFO 17 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6503aaab
2022-01-11 13:11:50.628  INFO 17 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6503aaab
2022-01-11 13:11:50.634  WARN 17 --- [https-jsse-nio-7071-exec-1] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: x
2022-01-11 13:11:50.639  WARN 17 --- [https-jsse-nio-7071-exec-1] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: x
2022-01-11 13:11:50.642  INFO 17 --- [https-jsse-nio-7071-exec-1] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-5891322396675-367486, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-11 13:11:50.649  INFO 17 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=15123f52-2146-428b-bcf1-d4c38227bbd5, content=DENY, timestamp=1641906710648, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-11 13:11:50.656  INFO 17 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=175ms, Total=209ms
2022-01-11 13:11:50.782  INFO 17 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=7e9d7fd4-68b6-4749-adb7-99fda2ef62d7, content=null, timestamp=1641906710766, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=65516, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=9462ddf72b74, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.30.0.1, kc-session-state=115df91e-55fd-4d89-b568-03753c55dee3, http-req-server-port=80, http-header-accept=*/*, kc-id=faa49035-39a2-47eb-9400-cb93a9fe6d10, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641906710751, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd2DNXNxAH4AEQAAAABh3YIJdAAkZmFhNDkwMzUtMzlhMi00N2ViLTk0MDAtY2I5M2E5ZmU2ZDEwdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAXh4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQxMTVkZjkxZS01NWZkLTRkODktYjU2OC0wMzc1M2M1NWRlZTNwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAATaHR0cDovLzE5Mi4xNjguMS44M3hwcHNyAC9vcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2VuJEFjY2VzcwewcQ/lekULAgACTAAFcm9sZXNxAH4AAUwADHZlcmlmeUNhbGxlcnEAfgAKeHBzcQB+ACt3DAAAABA/QAAAAAAABHQADm9mZmxpbmVfYWNjZXNzdAAGbWVtYmVydAAFYWRtaW50ABF1bWFfYXV0aG9yaXphdGlvbnhwc3IAF2phdmEudXRpbC5MaW5rZWRIYXNoTWFwNMBOXBBswPsCAAFaAAthY2Nlc3NPcmRlcnhxAH4AGD9AAAAAAAAMdwgAAAAQAAAAAXQAB2FjY291bnRzcQB+AC5zcQB+ACt3DAAAABA/QAAAAAAAA3QADm1hbmFnZS1hY2NvdW50dAAUbWFuYWdlLWFjY291bnQtbGlua3N0AAx2aWV3LXByb2ZpbGV4cHgAdAANcHJvZmlsZSBlbWFpbHA=, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJFeUZNQnpQUXV6VFFHUzhnWjYwVjJ1LXZxUE4zYm55MFVJSm1HaUpwS2pFIn0.eyJleHAiOjE2NDE5MDY5OTcsImlhdCI6MTY0MTkwNjY5NywianRpIjoiZmFhNDkwMzUtMzlhMi00N2ViLTk0MDAtY2I5M2E5ZmU2ZDEwIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiMTE1ZGY5MWUtNTVmZC00ZDg5LWI1NjgtMDM3NTNjNTVkZWUzIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoieCJ9.RP4jVdLa2GKR1jEUG_Ofs1jSfGSuf9hAaf2-j4R2AHCcLlwOZHQfjtGK56y9rw6Mc7yt4IuTEGT3_0YWpF73nJ5N36X7TcZC0389FvX0FvP5331H4S5EVmOJ7FyGpOHtmkLRXz4dfExVXoNmkyd6BrqB07pTnpObzqEyYxOX88fWlUjDk6RWTDWCykBixaI76kAACr7cHj6JEN_a2AkEpMI4HkZGWG0JnCqZkydE2kfceTUd-pP22WGrHs60GjudxqXJPsI90ESRgnEUGmuXiI5VgPtS_v89gz7KsuRr6RElEpCzvTqNDGXjy8OX7Zi59gzgqCzdmHhL_CD_-QqTiA, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641906997, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=172.30.0.12, kc-type=Bearer, kc-cc--team-ID=x, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.30.0.1, http-session-id=5971AFDF68FCA3EB985F02A891D32226, http-session-last-accessed-time=1641906710751, kc-category-name=ACCESS, kc-iat=1641906697, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.30.0.1:65516 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 13:11:50.790  INFO 17 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 13:11:50.812  INFO 17 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1554b223
2022-01-11 13:11:50.818  INFO 17 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1554b223
2022-01-11 13:11:50.855  INFO 17 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1554b223
2022-01-11 13:11:50.861  INFO 17 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1554b223
2022-01-11 13:11:50.897  INFO 17 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1554b223
2022-01-11 13:11:50.901  WARN 17 --- [https-jsse-nio-7071-exec-2] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: x
2022-01-11 13:11:50.904  WARN 17 --- [https-jsse-nio-7071-exec-2] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: x
2022-01-11 13:11:50.914  INFO 17 --- [https-jsse-nio-7071-exec-2] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-5891643355175-630615, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-11 13:11:50.920  INFO 17 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=7e9d7fd4-68b6-4749-adb7-99fda2ef62d7, content=DENY, timestamp=1641906710920, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-11 13:11:50.931  INFO 17 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=127ms, Total=151ms
2022-01-11 13:11:51.026  INFO 17 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=e146c65a-f320-493e-8ec9-b66e8c8a8d2a, content=null, timestamp=1641906711014, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=65518, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=9462ddf72b74, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.30.0.1, kc-session-state=115df91e-55fd-4d89-b568-03753c55dee3, http-req-server-port=80, http-header-accept=*/*, kc-id=faa49035-39a2-47eb-9400-cb93a9fe6d10, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641906710991, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd2DNXNxAH4AEQAAAABh3YIJdAAkZmFhNDkwMzUtMzlhMi00N2ViLTk0MDAtY2I5M2E5ZmU2ZDEwdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAXh4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQxMTVkZjkxZS01NWZkLTRkODktYjU2OC0wMzc1M2M1NWRlZTNwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAATaHR0cDovLzE5Mi4xNjguMS44M3hwcHNyAC9vcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2VuJEFjY2VzcwewcQ/lekULAgACTAAFcm9sZXNxAH4AAUwADHZlcmlmeUNhbGxlcnEAfgAKeHBzcQB+ACt3DAAAABA/QAAAAAAABHQADm9mZmxpbmVfYWNjZXNzdAAGbWVtYmVydAAFYWRtaW50ABF1bWFfYXV0aG9yaXphdGlvbnhwc3IAF2phdmEudXRpbC5MaW5rZWRIYXNoTWFwNMBOXBBswPsCAAFaAAthY2Nlc3NPcmRlcnhxAH4AGD9AAAAAAAAMdwgAAAAQAAAAAXQAB2FjY291bnRzcQB+AC5zcQB+ACt3DAAAABA/QAAAAAAAA3QADm1hbmFnZS1hY2NvdW50dAAUbWFuYWdlLWFjY291bnQtbGlua3N0AAx2aWV3LXByb2ZpbGV4cHgAdAANcHJvZmlsZSBlbWFpbHA=, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJFeUZNQnpQUXV6VFFHUzhnWjYwVjJ1LXZxUE4zYm55MFVJSm1HaUpwS2pFIn0.eyJleHAiOjE2NDE5MDY5OTcsImlhdCI6MTY0MTkwNjY5NywianRpIjoiZmFhNDkwMzUtMzlhMi00N2ViLTk0MDAtY2I5M2E5ZmU2ZDEwIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiMTE1ZGY5MWUtNTVmZC00ZDg5LWI1NjgtMDM3NTNjNTVkZWUzIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoieCJ9.RP4jVdLa2GKR1jEUG_Ofs1jSfGSuf9hAaf2-j4R2AHCcLlwOZHQfjtGK56y9rw6Mc7yt4IuTEGT3_0YWpF73nJ5N36X7TcZC0389FvX0FvP5331H4S5EVmOJ7FyGpOHtmkLRXz4dfExVXoNmkyd6BrqB07pTnpObzqEyYxOX88fWlUjDk6RWTDWCykBixaI76kAACr7cHj6JEN_a2AkEpMI4HkZGWG0JnCqZkydE2kfceTUd-pP22WGrHs60GjudxqXJPsI90ESRgnEUGmuXiI5VgPtS_v89gz7KsuRr6RElEpCzvTqNDGXjy8OX7Zi59gzgqCzdmHhL_CD_-QqTiA, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641906997, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=172.30.0.12, kc-type=Bearer, kc-cc--team-ID=x, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.30.0.1, http-session-id=09B7604A236DC6ED724554B608137566, http-session-last-accessed-time=1641906710991, kc-category-name=ACCESS, kc-iat=1641906697, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.30.0.1:65518 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 13:11:51.034  INFO 17 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 13:11:51.041  INFO 17 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@50784c2a
2022-01-11 13:11:51.047  INFO 17 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@50784c2a
2022-01-11 13:11:51.085  INFO 17 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@50784c2a
2022-01-11 13:11:51.092  INFO 17 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@50784c2a
2022-01-11 13:11:51.141  INFO 17 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@50784c2a
2022-01-11 13:11:51.144  WARN 17 --- [https-jsse-nio-7071-exec-3] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: x
2022-01-11 13:11:51.149  WARN 17 --- [https-jsse-nio-7071-exec-3] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: x
2022-01-11 13:11:51.154  INFO 17 --- [https-jsse-nio-7071-exec-3] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-5891887840775-737230, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-11 13:11:51.158  INFO 17 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=e146c65a-f320-493e-8ec9-b66e8c8a8d2a, content=DENY, timestamp=1641906711158, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-11 13:11:51.161  INFO 17 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=120ms, Total=136ms
2022-01-11 13:11:51.248  INFO 17 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=e6ea6b4d-df7c-4ab4-98c0-ba7d2d7473d3, content=null, timestamp=1641906711230, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=65520, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=9462ddf72b74, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.30.0.1, kc-session-state=115df91e-55fd-4d89-b568-03753c55dee3, http-req-server-port=80, http-header-accept=*/*, kc-id=faa49035-39a2-47eb-9400-cb93a9fe6d10, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641906711222, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd2DNXNxAH4AEQAAAABh3YIJdAAkZmFhNDkwMzUtMzlhMi00N2ViLTk0MDAtY2I5M2E5ZmU2ZDEwdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAXh4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQxMTVkZjkxZS01NWZkLTRkODktYjU2OC0wMzc1M2M1NWRlZTNwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAATaHR0cDovLzE5Mi4xNjguMS44M3hwcHNyAC9vcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2VuJEFjY2VzcwewcQ/lekULAgACTAAFcm9sZXNxAH4AAUwADHZlcmlmeUNhbGxlcnEAfgAKeHBzcQB+ACt3DAAAABA/QAAAAAAABHQADm9mZmxpbmVfYWNjZXNzdAAGbWVtYmVydAAFYWRtaW50ABF1bWFfYXV0aG9yaXphdGlvbnhwc3IAF2phdmEudXRpbC5MaW5rZWRIYXNoTWFwNMBOXBBswPsCAAFaAAthY2Nlc3NPcmRlcnhxAH4AGD9AAAAAAAAMdwgAAAAQAAAAAXQAB2FjY291bnRzcQB+AC5zcQB+ACt3DAAAABA/QAAAAAAAA3QADm1hbmFnZS1hY2NvdW50dAAUbWFuYWdlLWFjY291bnQtbGlua3N0AAx2aWV3LXByb2ZpbGV4cHgAdAANcHJvZmlsZSBlbWFpbHA=, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJFeUZNQnpQUXV6VFFHUzhnWjYwVjJ1LXZxUE4zYm55MFVJSm1HaUpwS2pFIn0.eyJleHAiOjE2NDE5MDY5OTcsImlhdCI6MTY0MTkwNjY5NywianRpIjoiZmFhNDkwMzUtMzlhMi00N2ViLTk0MDAtY2I5M2E5ZmU2ZDEwIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiMTE1ZGY5MWUtNTVmZC00ZDg5LWI1NjgtMDM3NTNjNTVkZWUzIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoieCJ9.RP4jVdLa2GKR1jEUG_Ofs1jSfGSuf9hAaf2-j4R2AHCcLlwOZHQfjtGK56y9rw6Mc7yt4IuTEGT3_0YWpF73nJ5N36X7TcZC0389FvX0FvP5331H4S5EVmOJ7FyGpOHtmkLRXz4dfExVXoNmkyd6BrqB07pTnpObzqEyYxOX88fWlUjDk6RWTDWCykBixaI76kAACr7cHj6JEN_a2AkEpMI4HkZGWG0JnCqZkydE2kfceTUd-pP22WGrHs60GjudxqXJPsI90ESRgnEUGmuXiI5VgPtS_v89gz7KsuRr6RElEpCzvTqNDGXjy8OX7Zi59gzgqCzdmHhL_CD_-QqTiA, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641906997, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=172.30.0.12, kc-type=Bearer, kc-cc--team-ID=x, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.30.0.1, http-session-id=BF29D7B7C0D43D8E86962AE8080C856A, http-session-last-accessed-time=1641906711222, kc-category-name=ACCESS, kc-iat=1641906697, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.30.0.1:65520 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 13:11:51.257  INFO 17 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 13:11:51.274  INFO 17 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@28a03e8a
2022-01-11 13:11:51.280  INFO 17 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@28a03e8a
2022-01-11 13:11:51.310  INFO 17 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@28a03e8a
2022-01-11 13:11:51.315  INFO 17 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@28a03e8a
2022-01-11 13:11:51.409  INFO 17 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@28a03e8a
2022-01-11 13:11:51.413  WARN 17 --- [https-jsse-nio-7071-exec-4] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: x
2022-01-11 13:11:51.416  WARN 17 --- [https-jsse-nio-7071-exec-4] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: x
2022-01-11 13:11:51.423  INFO 17 --- [https-jsse-nio-7071-exec-4] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-5892115639375-137004, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-11 13:11:51.426  INFO 17 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=e6ea6b4d-df7c-4ab4-98c0-ba7d2d7473d3, content=DENY, timestamp=1641906711426, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-11 13:11:51.435  INFO 17 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=161ms, Total=191ms
2022-01-11 13:11:51.517  INFO 17 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=953cd3d3-04fa-4899-b2cf-db84cff23d70, content=null, timestamp=1641906711499, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=65522, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=9462ddf72b74, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.30.0.1, kc-session-state=115df91e-55fd-4d89-b568-03753c55dee3, http-req-server-port=80, http-header-accept=*/*, kc-id=faa49035-39a2-47eb-9400-cb93a9fe6d10, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641906711492, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd2DNXNxAH4AEQAAAABh3YIJdAAkZmFhNDkwMzUtMzlhMi00N2ViLTk0MDAtY2I5M2E5ZmU2ZDEwdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAXh4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQxMTVkZjkxZS01NWZkLTRkODktYjU2OC0wMzc1M2M1NWRlZTNwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAATaHR0cDovLzE5Mi4xNjguMS44M3hwcHNyAC9vcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2VuJEFjY2VzcwewcQ/lekULAgACTAAFcm9sZXNxAH4AAUwADHZlcmlmeUNhbGxlcnEAfgAKeHBzcQB+ACt3DAAAABA/QAAAAAAABHQADm9mZmxpbmVfYWNjZXNzdAAGbWVtYmVydAAFYWRtaW50ABF1bWFfYXV0aG9yaXphdGlvbnhwc3IAF2phdmEudXRpbC5MaW5rZWRIYXNoTWFwNMBOXBBswPsCAAFaAAthY2Nlc3NPcmRlcnhxAH4AGD9AAAAAAAAMdwgAAAAQAAAAAXQAB2FjY291bnRzcQB+AC5zcQB+ACt3DAAAABA/QAAAAAAAA3QADm1hbmFnZS1hY2NvdW50dAAUbWFuYWdlLWFjY291bnQtbGlua3N0AAx2aWV3LXByb2ZpbGV4cHgAdAANcHJvZmlsZSBlbWFpbHA=, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJFeUZNQnpQUXV6VFFHUzhnWjYwVjJ1LXZxUE4zYm55MFVJSm1HaUpwS2pFIn0.eyJleHAiOjE2NDE5MDY5OTcsImlhdCI6MTY0MTkwNjY5NywianRpIjoiZmFhNDkwMzUtMzlhMi00N2ViLTk0MDAtY2I5M2E5ZmU2ZDEwIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiMTE1ZGY5MWUtNTVmZC00ZDg5LWI1NjgtMDM3NTNjNTVkZWUzIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoieCJ9.RP4jVdLa2GKR1jEUG_Ofs1jSfGSuf9hAaf2-j4R2AHCcLlwOZHQfjtGK56y9rw6Mc7yt4IuTEGT3_0YWpF73nJ5N36X7TcZC0389FvX0FvP5331H4S5EVmOJ7FyGpOHtmkLRXz4dfExVXoNmkyd6BrqB07pTnpObzqEyYxOX88fWlUjDk6RWTDWCykBixaI76kAACr7cHj6JEN_a2AkEpMI4HkZGWG0JnCqZkydE2kfceTUd-pP22WGrHs60GjudxqXJPsI90ESRgnEUGmuXiI5VgPtS_v89gz7KsuRr6RElEpCzvTqNDGXjy8OX7Zi59gzgqCzdmHhL_CD_-QqTiA, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641906997, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=172.30.0.12, kc-type=Bearer, kc-cc--team-ID=x, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.30.0.1, http-session-id=B57D5F2F9C393750204D1CE05A6EA526, http-session-last-accessed-time=1641906711492, kc-category-name=ACCESS, kc-iat=1641906697, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.30.0.1:65522 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 13:11:51.522  INFO 17 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 13:11:51.528  INFO 17 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@fb42766
2022-01-11 13:11:51.547  INFO 17 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@fb42766
2022-01-11 13:11:51.586  INFO 17 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@fb42766
2022-01-11 13:11:51.599  INFO 17 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@fb42766
2022-01-11 13:11:51.648  INFO 17 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@fb42766
2022-01-11 13:11:51.651  WARN 17 --- [https-jsse-nio-7071-exec-5] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: x
2022-01-11 13:11:51.655  WARN 17 --- [https-jsse-nio-7071-exec-5] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: x
2022-01-11 13:11:51.667  INFO 17 --- [https-jsse-nio-7071-exec-5] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-5892375351575-447483, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-11 13:11:51.669  INFO 17 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=953cd3d3-04fa-4899-b2cf-db84cff23d70, content=DENY, timestamp=1641906711669, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-11 13:11:51.673  INFO 17 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=144ms, Total=158ms
2022-01-11 13:11:51.803  INFO 17 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=e892e852-a9cb-4c6d-910d-ea750bef6242, content=null, timestamp=1641906711784, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=65524, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=9462ddf72b74, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.30.0.1, kc-session-state=115df91e-55fd-4d89-b568-03753c55dee3, http-req-server-port=80, http-header-accept=*/*, kc-id=faa49035-39a2-47eb-9400-cb93a9fe6d10, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641906711766, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd2DNXNxAH4AEQAAAABh3YIJdAAkZmFhNDkwMzUtMzlhMi00N2ViLTk0MDAtY2I5M2E5ZmU2ZDEwdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAXh4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQxMTVkZjkxZS01NWZkLTRkODktYjU2OC0wMzc1M2M1NWRlZTNwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAATaHR0cDovLzE5Mi4xNjguMS44M3hwcHNyAC9vcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2VuJEFjY2VzcwewcQ/lekULAgACTAAFcm9sZXNxAH4AAUwADHZlcmlmeUNhbGxlcnEAfgAKeHBzcQB+ACt3DAAAABA/QAAAAAAABHQADm9mZmxpbmVfYWNjZXNzdAAGbWVtYmVydAAFYWRtaW50ABF1bWFfYXV0aG9yaXphdGlvbnhwc3IAF2phdmEudXRpbC5MaW5rZWRIYXNoTWFwNMBOXBBswPsCAAFaAAthY2Nlc3NPcmRlcnhxAH4AGD9AAAAAAAAMdwgAAAAQAAAAAXQAB2FjY291bnRzcQB+AC5zcQB+ACt3DAAAABA/QAAAAAAAA3QADm1hbmFnZS1hY2NvdW50dAAUbWFuYWdlLWFjY291bnQtbGlua3N0AAx2aWV3LXByb2ZpbGV4cHgAdAANcHJvZmlsZSBlbWFpbHA=, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJFeUZNQnpQUXV6VFFHUzhnWjYwVjJ1LXZxUE4zYm55MFVJSm1HaUpwS2pFIn0.eyJleHAiOjE2NDE5MDY5OTcsImlhdCI6MTY0MTkwNjY5NywianRpIjoiZmFhNDkwMzUtMzlhMi00N2ViLTk0MDAtY2I5M2E5ZmU2ZDEwIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiMTE1ZGY5MWUtNTVmZC00ZDg5LWI1NjgtMDM3NTNjNTVkZWUzIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoieCJ9.RP4jVdLa2GKR1jEUG_Ofs1jSfGSuf9hAaf2-j4R2AHCcLlwOZHQfjtGK56y9rw6Mc7yt4IuTEGT3_0YWpF73nJ5N36X7TcZC0389FvX0FvP5331H4S5EVmOJ7FyGpOHtmkLRXz4dfExVXoNmkyd6BrqB07pTnpObzqEyYxOX88fWlUjDk6RWTDWCykBixaI76kAACr7cHj6JEN_a2AkEpMI4HkZGWG0JnCqZkydE2kfceTUd-pP22WGrHs60GjudxqXJPsI90ESRgnEUGmuXiI5VgPtS_v89gz7KsuRr6RElEpCzvTqNDGXjy8OX7Zi59gzgqCzdmHhL_CD_-QqTiA, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641906997, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=172.30.0.12, kc-type=Bearer, kc-cc--team-ID=x, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.30.0.1, http-session-id=62CB9C34B0E486D99994265491EFA42D, http-session-last-accessed-time=1641906711766, kc-category-name=ACCESS, kc-iat=1641906697, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.30.0.1:65524 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 13:11:51.834  INFO 17 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 13:11:51.860  INFO 17 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1991dc3
2022-01-11 13:11:51.870  INFO 17 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1991dc3
2022-01-11 13:11:51.976  INFO 17 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1991dc3
2022-01-11 13:11:51.982  INFO 17 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1991dc3
2022-01-11 13:11:52.061  INFO 17 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1991dc3
2022-01-11 13:11:52.064  WARN 17 --- [https-jsse-nio-7071-exec-6] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: x
2022-01-11 13:11:52.067  WARN 17 --- [https-jsse-nio-7071-exec-6] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: x
2022-01-11 13:11:52.074  INFO 17 --- [https-jsse-nio-7071-exec-6] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-5892690633875-901609, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-11 13:11:52.081  INFO 17 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=e892e852-a9cb-4c6d-910d-ea750bef6242, content=DENY, timestamp=1641906712081, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-11 13:11:52.095  INFO 17 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=240ms, Total=299ms
2022-01-11 13:11:52.183  INFO 17 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=ed61cc93-3b42-47c4-93e0-5c11e730cb4e, content=null, timestamp=1641906712164, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=65526, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=9462ddf72b74, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.30.0.1, kc-session-state=115df91e-55fd-4d89-b568-03753c55dee3, http-req-server-port=80, http-header-accept=*/*, kc-id=faa49035-39a2-47eb-9400-cb93a9fe6d10, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641906712156, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd2DNXNxAH4AEQAAAABh3YIJdAAkZmFhNDkwMzUtMzlhMi00N2ViLTk0MDAtY2I5M2E5ZmU2ZDEwdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAXh4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQxMTVkZjkxZS01NWZkLTRkODktYjU2OC0wMzc1M2M1NWRlZTNwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAATaHR0cDovLzE5Mi4xNjguMS44M3hwcHNyAC9vcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2VuJEFjY2VzcwewcQ/lekULAgACTAAFcm9sZXNxAH4AAUwADHZlcmlmeUNhbGxlcnEAfgAKeHBzcQB+ACt3DAAAABA/QAAAAAAABHQADm9mZmxpbmVfYWNjZXNzdAAGbWVtYmVydAAFYWRtaW50ABF1bWFfYXV0aG9yaXphdGlvbnhwc3IAF2phdmEudXRpbC5MaW5rZWRIYXNoTWFwNMBOXBBswPsCAAFaAAthY2Nlc3NPcmRlcnhxAH4AGD9AAAAAAAAMdwgAAAAQAAAAAXQAB2FjY291bnRzcQB+AC5zcQB+ACt3DAAAABA/QAAAAAAAA3QADm1hbmFnZS1hY2NvdW50dAAUbWFuYWdlLWFjY291bnQtbGlua3N0AAx2aWV3LXByb2ZpbGV4cHgAdAANcHJvZmlsZSBlbWFpbHA=, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJFeUZNQnpQUXV6VFFHUzhnWjYwVjJ1LXZxUE4zYm55MFVJSm1HaUpwS2pFIn0.eyJleHAiOjE2NDE5MDY5OTcsImlhdCI6MTY0MTkwNjY5NywianRpIjoiZmFhNDkwMzUtMzlhMi00N2ViLTk0MDAtY2I5M2E5ZmU2ZDEwIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiMTE1ZGY5MWUtNTVmZC00ZDg5LWI1NjgtMDM3NTNjNTVkZWUzIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoieCJ9.RP4jVdLa2GKR1jEUG_Ofs1jSfGSuf9hAaf2-j4R2AHCcLlwOZHQfjtGK56y9rw6Mc7yt4IuTEGT3_0YWpF73nJ5N36X7TcZC0389FvX0FvP5331H4S5EVmOJ7FyGpOHtmkLRXz4dfExVXoNmkyd6BrqB07pTnpObzqEyYxOX88fWlUjDk6RWTDWCykBixaI76kAACr7cHj6JEN_a2AkEpMI4HkZGWG0JnCqZkydE2kfceTUd-pP22WGrHs60GjudxqXJPsI90ESRgnEUGmuXiI5VgPtS_v89gz7KsuRr6RElEpCzvTqNDGXjy8OX7Zi59gzgqCzdmHhL_CD_-QqTiA, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641906997, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=172.30.0.12, kc-type=Bearer, kc-cc--team-ID=x, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.30.0.1, http-session-id=EDBFE45422AE22C6BC8DA7059178FF30, http-session-last-accessed-time=1641906712156, kc-category-name=ACCESS, kc-iat=1641906697, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.30.0.1:65526 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 13:11:52.196  INFO 17 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 13:11:52.216  INFO 17 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5b44432c
2022-01-11 13:11:52.228  INFO 17 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5b44432c
2022-01-11 13:11:52.273  INFO 17 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5b44432c
2022-01-11 13:11:52.280  INFO 17 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5b44432c
2022-01-11 13:11:52.360  INFO 17 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5b44432c
2022-01-11 13:11:52.362  WARN 17 --- [https-jsse-nio-7071-exec-7] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: x
2022-01-11 13:11:52.366  WARN 17 --- [https-jsse-nio-7071-exec-7] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: x
2022-01-11 13:11:52.371  INFO 17 --- [https-jsse-nio-7071-exec-7] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-5893049473875-68171, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-11 13:11:52.374  INFO 17 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=ed61cc93-3b42-47c4-93e0-5c11e730cb4e, content=DENY, timestamp=1641906712374, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-11 13:11:52.379  INFO 17 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=174ms, Total=199ms
2022-01-11 13:11:52.461  INFO 17 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=6f2bc84b-009d-4d36-b7ed-a74a22ca4f23, content=null, timestamp=1641906712444, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=65528, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=9462ddf72b74, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.30.0.1, kc-session-state=115df91e-55fd-4d89-b568-03753c55dee3, http-req-server-port=80, http-header-accept=*/*, kc-id=faa49035-39a2-47eb-9400-cb93a9fe6d10, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641906712442, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd2DNXNxAH4AEQAAAABh3YIJdAAkZmFhNDkwMzUtMzlhMi00N2ViLTk0MDAtY2I5M2E5ZmU2ZDEwdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAXh4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQxMTVkZjkxZS01NWZkLTRkODktYjU2OC0wMzc1M2M1NWRlZTNwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAATaHR0cDovLzE5Mi4xNjguMS44M3hwcHNyAC9vcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2VuJEFjY2VzcwewcQ/lekULAgACTAAFcm9sZXNxAH4AAUwADHZlcmlmeUNhbGxlcnEAfgAKeHBzcQB+ACt3DAAAABA/QAAAAAAABHQADm9mZmxpbmVfYWNjZXNzdAAGbWVtYmVydAAFYWRtaW50ABF1bWFfYXV0aG9yaXphdGlvbnhwc3IAF2phdmEudXRpbC5MaW5rZWRIYXNoTWFwNMBOXBBswPsCAAFaAAthY2Nlc3NPcmRlcnhxAH4AGD9AAAAAAAAMdwgAAAAQAAAAAXQAB2FjY291bnRzcQB+AC5zcQB+ACt3DAAAABA/QAAAAAAAA3QADm1hbmFnZS1hY2NvdW50dAAUbWFuYWdlLWFjY291bnQtbGlua3N0AAx2aWV3LXByb2ZpbGV4cHgAdAANcHJvZmlsZSBlbWFpbHA=, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJFeUZNQnpQUXV6VFFHUzhnWjYwVjJ1LXZxUE4zYm55MFVJSm1HaUpwS2pFIn0.eyJleHAiOjE2NDE5MDY5OTcsImlhdCI6MTY0MTkwNjY5NywianRpIjoiZmFhNDkwMzUtMzlhMi00N2ViLTk0MDAtY2I5M2E5ZmU2ZDEwIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiMTE1ZGY5MWUtNTVmZC00ZDg5LWI1NjgtMDM3NTNjNTVkZWUzIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoieCJ9.RP4jVdLa2GKR1jEUG_Ofs1jSfGSuf9hAaf2-j4R2AHCcLlwOZHQfjtGK56y9rw6Mc7yt4IuTEGT3_0YWpF73nJ5N36X7TcZC0389FvX0FvP5331H4S5EVmOJ7FyGpOHtmkLRXz4dfExVXoNmkyd6BrqB07pTnpObzqEyYxOX88fWlUjDk6RWTDWCykBixaI76kAACr7cHj6JEN_a2AkEpMI4HkZGWG0JnCqZkydE2kfceTUd-pP22WGrHs60GjudxqXJPsI90ESRgnEUGmuXiI5VgPtS_v89gz7KsuRr6RElEpCzvTqNDGXjy8OX7Zi59gzgqCzdmHhL_CD_-QqTiA, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641906997, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=172.30.0.12, kc-type=Bearer, kc-cc--team-ID=x, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.30.0.1, http-session-id=362B1DB32ADD1B139F7C1A4AA9416FCE, http-session-last-accessed-time=1641906712442, kc-category-name=ACCESS, kc-iat=1641906697, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.30.0.1:65528 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 13:11:52.470  INFO 17 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 13:11:52.489  INFO 17 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@35961d3a
2022-01-11 13:11:52.493  INFO 17 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@35961d3a
2022-01-11 13:11:52.528  INFO 17 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@35961d3a
2022-01-11 13:11:52.532  INFO 17 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@35961d3a
2022-01-11 13:11:52.567  INFO 17 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@35961d3a
2022-01-11 13:11:52.577  WARN 17 --- [https-jsse-nio-7071-exec-8] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: x
2022-01-11 13:11:52.580  WARN 17 --- [https-jsse-nio-7071-exec-8] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: x
2022-01-11 13:11:52.593  INFO 17 --- [https-jsse-nio-7071-exec-8] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-5893328054175-421380, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-11 13:11:52.596  INFO 17 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=6f2bc84b-009d-4d36-b7ed-a74a22ca4f23, content=DENY, timestamp=1641906712596, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-11 13:11:52.605  INFO 17 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=118ms, Total=152ms
2022-01-11 13:11:52.696  INFO 17 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=e8992909-e266-41b6-b21f-d842260db225, content=null, timestamp=1641906712680, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=65530, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=9462ddf72b74, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.30.0.1, kc-session-state=115df91e-55fd-4d89-b568-03753c55dee3, http-req-server-port=80, http-header-accept=*/*, kc-id=faa49035-39a2-47eb-9400-cb93a9fe6d10, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641906712667, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd2DNXNxAH4AEQAAAABh3YIJdAAkZmFhNDkwMzUtMzlhMi00N2ViLTk0MDAtY2I5M2E5ZmU2ZDEwdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAXh4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQxMTVkZjkxZS01NWZkLTRkODktYjU2OC0wMzc1M2M1NWRlZTNwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAATaHR0cDovLzE5Mi4xNjguMS44M3hwcHNyAC9vcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2VuJEFjY2VzcwewcQ/lekULAgACTAAFcm9sZXNxAH4AAUwADHZlcmlmeUNhbGxlcnEAfgAKeHBzcQB+ACt3DAAAABA/QAAAAAAABHQADm9mZmxpbmVfYWNjZXNzdAAGbWVtYmVydAAFYWRtaW50ABF1bWFfYXV0aG9yaXphdGlvbnhwc3IAF2phdmEudXRpbC5MaW5rZWRIYXNoTWFwNMBOXBBswPsCAAFaAAthY2Nlc3NPcmRlcnhxAH4AGD9AAAAAAAAMdwgAAAAQAAAAAXQAB2FjY291bnRzcQB+AC5zcQB+ACt3DAAAABA/QAAAAAAAA3QADm1hbmFnZS1hY2NvdW50dAAUbWFuYWdlLWFjY291bnQtbGlua3N0AAx2aWV3LXByb2ZpbGV4cHgAdAANcHJvZmlsZSBlbWFpbHA=, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJFeUZNQnpQUXV6VFFHUzhnWjYwVjJ1LXZxUE4zYm55MFVJSm1HaUpwS2pFIn0.eyJleHAiOjE2NDE5MDY5OTcsImlhdCI6MTY0MTkwNjY5NywianRpIjoiZmFhNDkwMzUtMzlhMi00N2ViLTk0MDAtY2I5M2E5ZmU2ZDEwIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiMTE1ZGY5MWUtNTVmZC00ZDg5LWI1NjgtMDM3NTNjNTVkZWUzIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoieCJ9.RP4jVdLa2GKR1jEUG_Ofs1jSfGSuf9hAaf2-j4R2AHCcLlwOZHQfjtGK56y9rw6Mc7yt4IuTEGT3_0YWpF73nJ5N36X7TcZC0389FvX0FvP5331H4S5EVmOJ7FyGpOHtmkLRXz4dfExVXoNmkyd6BrqB07pTnpObzqEyYxOX88fWlUjDk6RWTDWCykBixaI76kAACr7cHj6JEN_a2AkEpMI4HkZGWG0JnCqZkydE2kfceTUd-pP22WGrHs60GjudxqXJPsI90ESRgnEUGmuXiI5VgPtS_v89gz7KsuRr6RElEpCzvTqNDGXjy8OX7Zi59gzgqCzdmHhL_CD_-QqTiA, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641906997, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=172.30.0.12, kc-type=Bearer, kc-cc--team-ID=x, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.30.0.1, http-session-id=04471116BB8B1A986AD5C5F414BFF621, http-session-last-accessed-time=1641906712667, kc-category-name=ACCESS, kc-iat=1641906697, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.30.0.1:65530 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 13:11:52.706  INFO 17 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 13:11:52.721  INFO 17 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@17c1e542
2022-01-11 13:11:52.729  INFO 17 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@17c1e542
2022-01-11 13:11:52.776  INFO 17 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@17c1e542
2022-01-11 13:11:52.780  INFO 17 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@17c1e542
2022-01-11 13:11:52.808  INFO 17 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@17c1e542
2022-01-11 13:11:52.812  WARN 17 --- [https-jsse-nio-7071-exec-9] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: x
2022-01-11 13:11:52.819  WARN 17 --- [https-jsse-nio-7071-exec-9] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: x
2022-01-11 13:11:52.825  INFO 17 --- [https-jsse-nio-7071-exec-9] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-5893558918175-37788, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-11 13:11:52.829  INFO 17 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=e8992909-e266-41b6-b21f-d842260db225, content=DENY, timestamp=1641906712829, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-11 13:11:52.834  INFO 17 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=120ms, Total=140ms
2022-01-11 13:11:52.931  INFO 17 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=9c35dae9-4210-4b5e-a4d4-513e5bc3ac6c, content=null, timestamp=1641906712910, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=65532, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=9462ddf72b74, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.30.0.1, kc-session-state=115df91e-55fd-4d89-b568-03753c55dee3, http-req-server-port=80, http-header-accept=*/*, kc-id=faa49035-39a2-47eb-9400-cb93a9fe6d10, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641906712900, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd2DNXNxAH4AEQAAAABh3YIJdAAkZmFhNDkwMzUtMzlhMi00N2ViLTk0MDAtY2I5M2E5ZmU2ZDEwdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAXh4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQxMTVkZjkxZS01NWZkLTRkODktYjU2OC0wMzc1M2M1NWRlZTNwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAATaHR0cDovLzE5Mi4xNjguMS44M3hwcHNyAC9vcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2VuJEFjY2VzcwewcQ/lekULAgACTAAFcm9sZXNxAH4AAUwADHZlcmlmeUNhbGxlcnEAfgAKeHBzcQB+ACt3DAAAABA/QAAAAAAABHQADm9mZmxpbmVfYWNjZXNzdAAGbWVtYmVydAAFYWRtaW50ABF1bWFfYXV0aG9yaXphdGlvbnhwc3IAF2phdmEudXRpbC5MaW5rZWRIYXNoTWFwNMBOXBBswPsCAAFaAAthY2Nlc3NPcmRlcnhxAH4AGD9AAAAAAAAMdwgAAAAQAAAAAXQAB2FjY291bnRzcQB+AC5zcQB+ACt3DAAAABA/QAAAAAAAA3QADm1hbmFnZS1hY2NvdW50dAAUbWFuYWdlLWFjY291bnQtbGlua3N0AAx2aWV3LXByb2ZpbGV4cHgAdAANcHJvZmlsZSBlbWFpbHA=, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJFeUZNQnpQUXV6VFFHUzhnWjYwVjJ1LXZxUE4zYm55MFVJSm1HaUpwS2pFIn0.eyJleHAiOjE2NDE5MDY5OTcsImlhdCI6MTY0MTkwNjY5NywianRpIjoiZmFhNDkwMzUtMzlhMi00N2ViLTk0MDAtY2I5M2E5ZmU2ZDEwIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiMTE1ZGY5MWUtNTVmZC00ZDg5LWI1NjgtMDM3NTNjNTVkZWUzIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoieCJ9.RP4jVdLa2GKR1jEUG_Ofs1jSfGSuf9hAaf2-j4R2AHCcLlwOZHQfjtGK56y9rw6Mc7yt4IuTEGT3_0YWpF73nJ5N36X7TcZC0389FvX0FvP5331H4S5EVmOJ7FyGpOHtmkLRXz4dfExVXoNmkyd6BrqB07pTnpObzqEyYxOX88fWlUjDk6RWTDWCykBixaI76kAACr7cHj6JEN_a2AkEpMI4HkZGWG0JnCqZkydE2kfceTUd-pP22WGrHs60GjudxqXJPsI90ESRgnEUGmuXiI5VgPtS_v89gz7KsuRr6RElEpCzvTqNDGXjy8OX7Zi59gzgqCzdmHhL_CD_-QqTiA, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641906997, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=172.30.0.12, kc-type=Bearer, kc-cc--team-ID=x, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.30.0.1, http-session-id=124B1B6190E2FCD9D424071243D9D553, http-session-last-accessed-time=1641906712900, kc-category-name=ACCESS, kc-iat=1641906697, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.30.0.1:65532 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 13:11:52.943  INFO 17 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 13:11:52.968  INFO 17 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@15b8db47
2022-01-11 13:11:52.978  INFO 17 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@15b8db47
2022-01-11 13:11:53.013  INFO 17 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@15b8db47
2022-01-11 13:11:53.016  INFO 17 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@15b8db47
2022-01-11 13:11:53.084  INFO 17 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@15b8db47
2022-01-11 13:11:53.088  WARN 17 --- [https-jsse-nio-7071-exec-10] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: x
2022-01-11 13:11:53.091  WARN 17 --- [https-jsse-nio-7071-exec-10] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: x
2022-01-11 13:11:53.095  INFO 17 --- [https-jsse-nio-7071-exec-10] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-5893798358075-249001, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-11 13:11:53.097  INFO 17 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=9c35dae9-4210-4b5e-a4d4-513e5bc3ac6c, content=DENY, timestamp=1641906713097, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-11 13:11:53.100  INFO 17 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=149ms, Total=171ms
2022-01-11 13:11:53.248  INFO 17 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=890eb676-3af2-4305-866d-afc66ee00beb, content=null, timestamp=1641906713199, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=65534, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=9462ddf72b74, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.30.0.1, kc-session-state=115df91e-55fd-4d89-b568-03753c55dee3, http-req-server-port=80, http-header-accept=*/*, kc-id=faa49035-39a2-47eb-9400-cb93a9fe6d10, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641906713187, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd2DNXNxAH4AEQAAAABh3YIJdAAkZmFhNDkwMzUtMzlhMi00N2ViLTk0MDAtY2I5M2E5ZmU2ZDEwdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAXh4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQxMTVkZjkxZS01NWZkLTRkODktYjU2OC0wMzc1M2M1NWRlZTNwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAATaHR0cDovLzE5Mi4xNjguMS44M3hwcHNyAC9vcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2VuJEFjY2VzcwewcQ/lekULAgACTAAFcm9sZXNxAH4AAUwADHZlcmlmeUNhbGxlcnEAfgAKeHBzcQB+ACt3DAAAABA/QAAAAAAABHQADm9mZmxpbmVfYWNjZXNzdAAGbWVtYmVydAAFYWRtaW50ABF1bWFfYXV0aG9yaXphdGlvbnhwc3IAF2phdmEudXRpbC5MaW5rZWRIYXNoTWFwNMBOXBBswPsCAAFaAAthY2Nlc3NPcmRlcnhxAH4AGD9AAAAAAAAMdwgAAAAQAAAAAXQAB2FjY291bnRzcQB+AC5zcQB+ACt3DAAAABA/QAAAAAAAA3QADm1hbmFnZS1hY2NvdW50dAAUbWFuYWdlLWFjY291bnQtbGlua3N0AAx2aWV3LXByb2ZpbGV4cHgAdAANcHJvZmlsZSBlbWFpbHA=, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJFeUZNQnpQUXV6VFFHUzhnWjYwVjJ1LXZxUE4zYm55MFVJSm1HaUpwS2pFIn0.eyJleHAiOjE2NDE5MDY5OTcsImlhdCI6MTY0MTkwNjY5NywianRpIjoiZmFhNDkwMzUtMzlhMi00N2ViLTk0MDAtY2I5M2E5ZmU2ZDEwIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiMTE1ZGY5MWUtNTVmZC00ZDg5LWI1NjgtMDM3NTNjNTVkZWUzIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoieCJ9.RP4jVdLa2GKR1jEUG_Ofs1jSfGSuf9hAaf2-j4R2AHCcLlwOZHQfjtGK56y9rw6Mc7yt4IuTEGT3_0YWpF73nJ5N36X7TcZC0389FvX0FvP5331H4S5EVmOJ7FyGpOHtmkLRXz4dfExVXoNmkyd6BrqB07pTnpObzqEyYxOX88fWlUjDk6RWTDWCykBixaI76kAACr7cHj6JEN_a2AkEpMI4HkZGWG0JnCqZkydE2kfceTUd-pP22WGrHs60GjudxqXJPsI90ESRgnEUGmuXiI5VgPtS_v89gz7KsuRr6RElEpCzvTqNDGXjy8OX7Zi59gzgqCzdmHhL_CD_-QqTiA, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641906997, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=172.30.0.12, kc-type=Bearer, kc-cc--team-ID=x, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.30.0.1, http-session-id=F305971BAAF79897A2BFDB8BF13ACE9F, http-session-last-accessed-time=1641906713187, kc-category-name=ACCESS, kc-iat=1641906697, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.30.0.1:65534 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 13:11:53.260  INFO 17 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 13:11:53.292  INFO 17 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@78b5d3a7
2022-01-11 13:11:53.305  INFO 17 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@78b5d3a7
2022-01-11 13:11:53.356  INFO 17 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@78b5d3a7
2022-01-11 13:11:53.368  INFO 17 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@78b5d3a7
2022-01-11 13:11:53.420  INFO 17 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@78b5d3a7
2022-01-11 13:11:53.423  WARN 17 --- [https-jsse-nio-7071-exec-1] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: x
2022-01-11 13:11:53.426  WARN 17 --- [https-jsse-nio-7071-exec-1] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: x
2022-01-11 13:11:53.431  INFO 17 --- [https-jsse-nio-7071-exec-1] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-5894120037275-37753, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-11 13:11:53.435  INFO 17 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=890eb676-3af2-4305-866d-afc66ee00beb, content=DENY, timestamp=1641906713435, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-11 13:11:53.439  INFO 17 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=165ms, Total=200ms
2022-01-11 13:11:53.572  INFO 17 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=d241c969-a0ff-4412-bd27-f128d6e6df7b, content=null, timestamp=1641906713523, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=55000, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=9462ddf72b74, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.30.0.1, kc-session-state=115df91e-55fd-4d89-b568-03753c55dee3, http-req-server-port=80, http-header-accept=*/*, kc-id=faa49035-39a2-47eb-9400-cb93a9fe6d10, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641906713509, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd2DNXNxAH4AEQAAAABh3YIJdAAkZmFhNDkwMzUtMzlhMi00N2ViLTk0MDAtY2I5M2E5ZmU2ZDEwdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAXh4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQxMTVkZjkxZS01NWZkLTRkODktYjU2OC0wMzc1M2M1NWRlZTNwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAATaHR0cDovLzE5Mi4xNjguMS44M3hwcHNyAC9vcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2VuJEFjY2VzcwewcQ/lekULAgACTAAFcm9sZXNxAH4AAUwADHZlcmlmeUNhbGxlcnEAfgAKeHBzcQB+ACt3DAAAABA/QAAAAAAABHQADm9mZmxpbmVfYWNjZXNzdAAGbWVtYmVydAAFYWRtaW50ABF1bWFfYXV0aG9yaXphdGlvbnhwc3IAF2phdmEudXRpbC5MaW5rZWRIYXNoTWFwNMBOXBBswPsCAAFaAAthY2Nlc3NPcmRlcnhxAH4AGD9AAAAAAAAMdwgAAAAQAAAAAXQAB2FjY291bnRzcQB+AC5zcQB+ACt3DAAAABA/QAAAAAAAA3QADm1hbmFnZS1hY2NvdW50dAAUbWFuYWdlLWFjY291bnQtbGlua3N0AAx2aWV3LXByb2ZpbGV4cHgAdAANcHJvZmlsZSBlbWFpbHA=, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJFeUZNQnpQUXV6VFFHUzhnWjYwVjJ1LXZxUE4zYm55MFVJSm1HaUpwS2pFIn0.eyJleHAiOjE2NDE5MDY5OTcsImlhdCI6MTY0MTkwNjY5NywianRpIjoiZmFhNDkwMzUtMzlhMi00N2ViLTk0MDAtY2I5M2E5ZmU2ZDEwIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiMTE1ZGY5MWUtNTVmZC00ZDg5LWI1NjgtMDM3NTNjNTVkZWUzIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoieCJ9.RP4jVdLa2GKR1jEUG_Ofs1jSfGSuf9hAaf2-j4R2AHCcLlwOZHQfjtGK56y9rw6Mc7yt4IuTEGT3_0YWpF73nJ5N36X7TcZC0389FvX0FvP5331H4S5EVmOJ7FyGpOHtmkLRXz4dfExVXoNmkyd6BrqB07pTnpObzqEyYxOX88fWlUjDk6RWTDWCykBixaI76kAACr7cHj6JEN_a2AkEpMI4HkZGWG0JnCqZkydE2kfceTUd-pP22WGrHs60GjudxqXJPsI90ESRgnEUGmuXiI5VgPtS_v89gz7KsuRr6RElEpCzvTqNDGXjy8OX7Zi59gzgqCzdmHhL_CD_-QqTiA, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641906997, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=172.30.0.12, kc-type=Bearer, kc-cc--team-ID=x, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.30.0.1, http-session-id=AF473003D3B6D8C09DE0062C9A62867C, http-session-last-accessed-time=1641906713509, kc-category-name=ACCESS, kc-iat=1641906697, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.30.0.1:55000 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 13:11:53.576  INFO 17 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 13:11:53.581  INFO 17 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@a492050
2022-01-11 13:11:53.583  INFO 17 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@a492050
2022-01-11 13:11:53.649  INFO 17 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@a492050
2022-01-11 13:11:53.652  INFO 17 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@a492050
2022-01-11 13:11:53.700  INFO 17 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@a492050
2022-01-11 13:11:53.703  WARN 17 --- [https-jsse-nio-7071-exec-2] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: x
2022-01-11 13:11:53.705  WARN 17 --- [https-jsse-nio-7071-exec-2] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: x
2022-01-11 13:11:53.720  INFO 17 --- [https-jsse-nio-7071-exec-2] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-5894427948775-40105, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-11 13:11:53.722  INFO 17 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=d241c969-a0ff-4412-bd27-f128d6e6df7b, content=DENY, timestamp=1641906713722, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-11 13:11:53.726  INFO 17 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=144ms, Total=174ms
2022-01-11 13:11:53.796  INFO 17 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=1a6428da-a647-484d-835e-201d5f92a35c, content=null, timestamp=1641906713783, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=55002, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=9462ddf72b74, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.30.0.1, kc-session-state=115df91e-55fd-4d89-b568-03753c55dee3, http-req-server-port=80, http-header-accept=*/*, kc-id=faa49035-39a2-47eb-9400-cb93a9fe6d10, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641906713781, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd2DNXNxAH4AEQAAAABh3YIJdAAkZmFhNDkwMzUtMzlhMi00N2ViLTk0MDAtY2I5M2E5ZmU2ZDEwdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAXh4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQxMTVkZjkxZS01NWZkLTRkODktYjU2OC0wMzc1M2M1NWRlZTNwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAATaHR0cDovLzE5Mi4xNjguMS44M3hwcHNyAC9vcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2VuJEFjY2VzcwewcQ/lekULAgACTAAFcm9sZXNxAH4AAUwADHZlcmlmeUNhbGxlcnEAfgAKeHBzcQB+ACt3DAAAABA/QAAAAAAABHQADm9mZmxpbmVfYWNjZXNzdAAGbWVtYmVydAAFYWRtaW50ABF1bWFfYXV0aG9yaXphdGlvbnhwc3IAF2phdmEudXRpbC5MaW5rZWRIYXNoTWFwNMBOXBBswPsCAAFaAAthY2Nlc3NPcmRlcnhxAH4AGD9AAAAAAAAMdwgAAAAQAAAAAXQAB2FjY291bnRzcQB+AC5zcQB+ACt3DAAAABA/QAAAAAAAA3QADm1hbmFnZS1hY2NvdW50dAAUbWFuYWdlLWFjY291bnQtbGlua3N0AAx2aWV3LXByb2ZpbGV4cHgAdAANcHJvZmlsZSBlbWFpbHA=, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJFeUZNQnpQUXV6VFFHUzhnWjYwVjJ1LXZxUE4zYm55MFVJSm1HaUpwS2pFIn0.eyJleHAiOjE2NDE5MDY5OTcsImlhdCI6MTY0MTkwNjY5NywianRpIjoiZmFhNDkwMzUtMzlhMi00N2ViLTk0MDAtY2I5M2E5ZmU2ZDEwIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiMTE1ZGY5MWUtNTVmZC00ZDg5LWI1NjgtMDM3NTNjNTVkZWUzIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoieCJ9.RP4jVdLa2GKR1jEUG_Ofs1jSfGSuf9hAaf2-j4R2AHCcLlwOZHQfjtGK56y9rw6Mc7yt4IuTEGT3_0YWpF73nJ5N36X7TcZC0389FvX0FvP5331H4S5EVmOJ7FyGpOHtmkLRXz4dfExVXoNmkyd6BrqB07pTnpObzqEyYxOX88fWlUjDk6RWTDWCykBixaI76kAACr7cHj6JEN_a2AkEpMI4HkZGWG0JnCqZkydE2kfceTUd-pP22WGrHs60GjudxqXJPsI90ESRgnEUGmuXiI5VgPtS_v89gz7KsuRr6RElEpCzvTqNDGXjy8OX7Zi59gzgqCzdmHhL_CD_-QqTiA, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641906997, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=172.30.0.12, kc-type=Bearer, kc-cc--team-ID=x, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.30.0.1, http-session-id=CA3DBC9C2A05CE7B5C74746CEB889E4E, http-session-last-accessed-time=1641906713781, kc-category-name=ACCESS, kc-iat=1641906697, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.30.0.1:55002 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 13:11:53.801  INFO 17 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 13:11:53.807  INFO 17 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@374a4837
2022-01-11 13:11:53.809  INFO 17 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@374a4837
2022-01-11 13:11:53.833  INFO 17 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@374a4837
2022-01-11 13:11:53.839  INFO 17 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@374a4837
2022-01-11 13:11:53.923  INFO 17 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@374a4837
2022-01-11 13:11:53.929  WARN 17 --- [https-jsse-nio-7071-exec-3] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: x
2022-01-11 13:11:53.932  WARN 17 --- [https-jsse-nio-7071-exec-3] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: x
2022-01-11 13:11:53.936  INFO 17 --- [https-jsse-nio-7071-exec-3] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-5894654735275-618078, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-11 13:11:53.943  INFO 17 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=1a6428da-a647-484d-835e-201d5f92a35c, content=DENY, timestamp=1641906713943, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-11 13:11:53.946  INFO 17 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=138ms, Total=152ms
2022-01-11 13:11:54.014  INFO 17 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=24e6bf6e-c938-470c-9011-6e530bf12059, content=null, timestamp=1641906714003, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=55004, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=9462ddf72b74, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.30.0.1, kc-session-state=115df91e-55fd-4d89-b568-03753c55dee3, http-req-server-port=80, http-header-accept=*/*, kc-id=faa49035-39a2-47eb-9400-cb93a9fe6d10, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641906713992, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd2DNXNxAH4AEQAAAABh3YIJdAAkZmFhNDkwMzUtMzlhMi00N2ViLTk0MDAtY2I5M2E5ZmU2ZDEwdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAXh4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQxMTVkZjkxZS01NWZkLTRkODktYjU2OC0wMzc1M2M1NWRlZTNwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAATaHR0cDovLzE5Mi4xNjguMS44M3hwcHNyAC9vcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2VuJEFjY2VzcwewcQ/lekULAgACTAAFcm9sZXNxAH4AAUwADHZlcmlmeUNhbGxlcnEAfgAKeHBzcQB+ACt3DAAAABA/QAAAAAAABHQADm9mZmxpbmVfYWNjZXNzdAAGbWVtYmVydAAFYWRtaW50ABF1bWFfYXV0aG9yaXphdGlvbnhwc3IAF2phdmEudXRpbC5MaW5rZWRIYXNoTWFwNMBOXBBswPsCAAFaAAthY2Nlc3NPcmRlcnhxAH4AGD9AAAAAAAAMdwgAAAAQAAAAAXQAB2FjY291bnRzcQB+AC5zcQB+ACt3DAAAABA/QAAAAAAAA3QADm1hbmFnZS1hY2NvdW50dAAUbWFuYWdlLWFjY291bnQtbGlua3N0AAx2aWV3LXByb2ZpbGV4cHgAdAANcHJvZmlsZSBlbWFpbHA=, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJFeUZNQnpQUXV6VFFHUzhnWjYwVjJ1LXZxUE4zYm55MFVJSm1HaUpwS2pFIn0.eyJleHAiOjE2NDE5MDY5OTcsImlhdCI6MTY0MTkwNjY5NywianRpIjoiZmFhNDkwMzUtMzlhMi00N2ViLTk0MDAtY2I5M2E5ZmU2ZDEwIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiMTE1ZGY5MWUtNTVmZC00ZDg5LWI1NjgtMDM3NTNjNTVkZWUzIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoieCJ9.RP4jVdLa2GKR1jEUG_Ofs1jSfGSuf9hAaf2-j4R2AHCcLlwOZHQfjtGK56y9rw6Mc7yt4IuTEGT3_0YWpF73nJ5N36X7TcZC0389FvX0FvP5331H4S5EVmOJ7FyGpOHtmkLRXz4dfExVXoNmkyd6BrqB07pTnpObzqEyYxOX88fWlUjDk6RWTDWCykBixaI76kAACr7cHj6JEN_a2AkEpMI4HkZGWG0JnCqZkydE2kfceTUd-pP22WGrHs60GjudxqXJPsI90ESRgnEUGmuXiI5VgPtS_v89gz7KsuRr6RElEpCzvTqNDGXjy8OX7Zi59gzgqCzdmHhL_CD_-QqTiA, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641906997, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=172.30.0.12, kc-type=Bearer, kc-cc--team-ID=x, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.30.0.1, http-session-id=2D23634037CC88433B0AA282E46AA869, http-session-last-accessed-time=1641906713992, kc-category-name=ACCESS, kc-iat=1641906697, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.30.0.1:55004 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 13:11:54.020  INFO 17 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 13:11:54.024  INFO 17 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@f8b8c69
2022-01-11 13:11:54.026  INFO 17 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@f8b8c69
2022-01-11 13:11:54.081  INFO 17 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@f8b8c69
2022-01-11 13:11:54.085  INFO 17 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@f8b8c69
2022-01-11 13:11:54.129  INFO 17 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@f8b8c69
2022-01-11 13:11:54.132  WARN 17 --- [https-jsse-nio-7071-exec-4] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: x
2022-01-11 13:11:54.134  WARN 17 --- [https-jsse-nio-7071-exec-4] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: x
2022-01-11 13:11:54.138  INFO 17 --- [https-jsse-nio-7071-exec-4] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-5894871665775-63729, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-11 13:11:54.144  INFO 17 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=24e6bf6e-c938-470c-9011-6e530bf12059, content=DENY, timestamp=1641906714144, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-11 13:11:54.148  INFO 17 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=122ms, Total=136ms
2022-01-11 13:11:54.231  INFO 17 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=d3e43938-c2b8-4c65-b05a-e39cceb60aea, content=null, timestamp=1641906714196, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=55006, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=9462ddf72b74, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.30.0.1, kc-session-state=115df91e-55fd-4d89-b568-03753c55dee3, http-req-server-port=80, http-header-accept=*/*, kc-id=faa49035-39a2-47eb-9400-cb93a9fe6d10, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641906714193, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd2DNXNxAH4AEQAAAABh3YIJdAAkZmFhNDkwMzUtMzlhMi00N2ViLTk0MDAtY2I5M2E5ZmU2ZDEwdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAXh4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQxMTVkZjkxZS01NWZkLTRkODktYjU2OC0wMzc1M2M1NWRlZTNwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAATaHR0cDovLzE5Mi4xNjguMS44M3hwcHNyAC9vcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2VuJEFjY2VzcwewcQ/lekULAgACTAAFcm9sZXNxAH4AAUwADHZlcmlmeUNhbGxlcnEAfgAKeHBzcQB+ACt3DAAAABA/QAAAAAAABHQADm9mZmxpbmVfYWNjZXNzdAAGbWVtYmVydAAFYWRtaW50ABF1bWFfYXV0aG9yaXphdGlvbnhwc3IAF2phdmEudXRpbC5MaW5rZWRIYXNoTWFwNMBOXBBswPsCAAFaAAthY2Nlc3NPcmRlcnhxAH4AGD9AAAAAAAAMdwgAAAAQAAAAAXQAB2FjY291bnRzcQB+AC5zcQB+ACt3DAAAABA/QAAAAAAAA3QADm1hbmFnZS1hY2NvdW50dAAUbWFuYWdlLWFjY291bnQtbGlua3N0AAx2aWV3LXByb2ZpbGV4cHgAdAANcHJvZmlsZSBlbWFpbHA=, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJFeUZNQnpQUXV6VFFHUzhnWjYwVjJ1LXZxUE4zYm55MFVJSm1HaUpwS2pFIn0.eyJleHAiOjE2NDE5MDY5OTcsImlhdCI6MTY0MTkwNjY5NywianRpIjoiZmFhNDkwMzUtMzlhMi00N2ViLTk0MDAtY2I5M2E5ZmU2ZDEwIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiMTE1ZGY5MWUtNTVmZC00ZDg5LWI1NjgtMDM3NTNjNTVkZWUzIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoieCJ9.RP4jVdLa2GKR1jEUG_Ofs1jSfGSuf9hAaf2-j4R2AHCcLlwOZHQfjtGK56y9rw6Mc7yt4IuTEGT3_0YWpF73nJ5N36X7TcZC0389FvX0FvP5331H4S5EVmOJ7FyGpOHtmkLRXz4dfExVXoNmkyd6BrqB07pTnpObzqEyYxOX88fWlUjDk6RWTDWCykBixaI76kAACr7cHj6JEN_a2AkEpMI4HkZGWG0JnCqZkydE2kfceTUd-pP22WGrHs60GjudxqXJPsI90ESRgnEUGmuXiI5VgPtS_v89gz7KsuRr6RElEpCzvTqNDGXjy8OX7Zi59gzgqCzdmHhL_CD_-QqTiA, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641906997, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=172.30.0.12, kc-type=Bearer, kc-cc--team-ID=x, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.30.0.1, http-session-id=2B01D202B17B78E39B74D7FC06F0AF65, http-session-last-accessed-time=1641906714193, kc-category-name=ACCESS, kc-iat=1641906697, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.30.0.1:55006 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 13:11:54.235  INFO 17 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 13:11:54.252  INFO 17 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@73165da5
2022-01-11 13:11:54.266  INFO 17 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@73165da5
2022-01-11 13:11:54.330  INFO 17 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@73165da5
2022-01-11 13:11:54.337  INFO 17 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@73165da5
2022-01-11 13:11:54.397  INFO 17 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@73165da5
2022-01-11 13:11:54.401  WARN 17 --- [https-jsse-nio-7071-exec-5] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: x
2022-01-11 13:11:54.406  WARN 17 --- [https-jsse-nio-7071-exec-5] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: x
2022-01-11 13:11:54.414  INFO 17 --- [https-jsse-nio-7071-exec-5] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-5895090922675-856201, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-11 13:11:54.419  INFO 17 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=d3e43938-c2b8-4c65-b05a-e39cceb60aea, content=DENY, timestamp=1641906714419, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-11 13:11:54.427  INFO 17 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=178ms, Total=208ms
2022-01-11 13:11:54.520  INFO 17 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=a2548554-c543-4ac7-95fc-5ff32adc7e49, content=null, timestamp=1641906714496, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=55008, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=9462ddf72b74, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.30.0.1, kc-session-state=115df91e-55fd-4d89-b568-03753c55dee3, http-req-server-port=80, http-header-accept=*/*, kc-id=faa49035-39a2-47eb-9400-cb93a9fe6d10, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641906714482, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd2DNXNxAH4AEQAAAABh3YIJdAAkZmFhNDkwMzUtMzlhMi00N2ViLTk0MDAtY2I5M2E5ZmU2ZDEwdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAXh4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQxMTVkZjkxZS01NWZkLTRkODktYjU2OC0wMzc1M2M1NWRlZTNwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAATaHR0cDovLzE5Mi4xNjguMS44M3hwcHNyAC9vcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2VuJEFjY2VzcwewcQ/lekULAgACTAAFcm9sZXNxAH4AAUwADHZlcmlmeUNhbGxlcnEAfgAKeHBzcQB+ACt3DAAAABA/QAAAAAAABHQADm9mZmxpbmVfYWNjZXNzdAAGbWVtYmVydAAFYWRtaW50ABF1bWFfYXV0aG9yaXphdGlvbnhwc3IAF2phdmEudXRpbC5MaW5rZWRIYXNoTWFwNMBOXBBswPsCAAFaAAthY2Nlc3NPcmRlcnhxAH4AGD9AAAAAAAAMdwgAAAAQAAAAAXQAB2FjY291bnRzcQB+AC5zcQB+ACt3DAAAABA/QAAAAAAAA3QADm1hbmFnZS1hY2NvdW50dAAUbWFuYWdlLWFjY291bnQtbGlua3N0AAx2aWV3LXByb2ZpbGV4cHgAdAANcHJvZmlsZSBlbWFpbHA=, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJFeUZNQnpQUXV6VFFHUzhnWjYwVjJ1LXZxUE4zYm55MFVJSm1HaUpwS2pFIn0.eyJleHAiOjE2NDE5MDY5OTcsImlhdCI6MTY0MTkwNjY5NywianRpIjoiZmFhNDkwMzUtMzlhMi00N2ViLTk0MDAtY2I5M2E5ZmU2ZDEwIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiMTE1ZGY5MWUtNTVmZC00ZDg5LWI1NjgtMDM3NTNjNTVkZWUzIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoieCJ9.RP4jVdLa2GKR1jEUG_Ofs1jSfGSuf9hAaf2-j4R2AHCcLlwOZHQfjtGK56y9rw6Mc7yt4IuTEGT3_0YWpF73nJ5N36X7TcZC0389FvX0FvP5331H4S5EVmOJ7FyGpOHtmkLRXz4dfExVXoNmkyd6BrqB07pTnpObzqEyYxOX88fWlUjDk6RWTDWCykBixaI76kAACr7cHj6JEN_a2AkEpMI4HkZGWG0JnCqZkydE2kfceTUd-pP22WGrHs60GjudxqXJPsI90ESRgnEUGmuXiI5VgPtS_v89gz7KsuRr6RElEpCzvTqNDGXjy8OX7Zi59gzgqCzdmHhL_CD_-QqTiA, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641906997, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=172.30.0.12, kc-type=Bearer, kc-cc--team-ID=x, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.30.0.1, http-session-id=2CEF1DD6C1B374146BDD55B14F785406, http-session-last-accessed-time=1641906714482, kc-category-name=ACCESS, kc-iat=1641906697, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.30.0.1:55008 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 13:11:54.534  INFO 17 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 13:11:54.546  INFO 17 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4cc66035
2022-01-11 13:11:54.550  INFO 17 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4cc66035
2022-01-11 13:11:54.629  INFO 17 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4cc66035
2022-01-11 13:11:54.635  INFO 17 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4cc66035
2022-01-11 13:11:54.726  INFO 17 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4cc66035
2022-01-11 13:11:54.731  WARN 17 --- [https-jsse-nio-7071-exec-6] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: x
2022-01-11 13:11:54.734  WARN 17 --- [https-jsse-nio-7071-exec-6] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: x
2022-01-11 13:11:54.741  INFO 17 --- [https-jsse-nio-7071-exec-6] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-5895391915075-321801, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-11 13:11:54.745  INFO 17 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=a2548554-c543-4ac7-95fc-5ff32adc7e49, content=DENY, timestamp=1641906714745, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-11 13:11:54.748  INFO 17 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=203ms, Total=229ms
2022-01-11 13:11:54.813  INFO 17 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=fea0d079-7054-4eac-ad3e-1f02d7de41b5, content=null, timestamp=1641906714800, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=55010, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=9462ddf72b74, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.30.0.1, kc-session-state=115df91e-55fd-4d89-b568-03753c55dee3, http-req-server-port=80, http-header-accept=*/*, kc-id=faa49035-39a2-47eb-9400-cb93a9fe6d10, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641906714794, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd2DNXNxAH4AEQAAAABh3YIJdAAkZmFhNDkwMzUtMzlhMi00N2ViLTk0MDAtY2I5M2E5ZmU2ZDEwdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAXh4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQxMTVkZjkxZS01NWZkLTRkODktYjU2OC0wMzc1M2M1NWRlZTNwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAATaHR0cDovLzE5Mi4xNjguMS44M3hwcHNyAC9vcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2VuJEFjY2VzcwewcQ/lekULAgACTAAFcm9sZXNxAH4AAUwADHZlcmlmeUNhbGxlcnEAfgAKeHBzcQB+ACt3DAAAABA/QAAAAAAABHQADm9mZmxpbmVfYWNjZXNzdAAGbWVtYmVydAAFYWRtaW50ABF1bWFfYXV0aG9yaXphdGlvbnhwc3IAF2phdmEudXRpbC5MaW5rZWRIYXNoTWFwNMBOXBBswPsCAAFaAAthY2Nlc3NPcmRlcnhxAH4AGD9AAAAAAAAMdwgAAAAQAAAAAXQAB2FjY291bnRzcQB+AC5zcQB+ACt3DAAAABA/QAAAAAAAA3QADm1hbmFnZS1hY2NvdW50dAAUbWFuYWdlLWFjY291bnQtbGlua3N0AAx2aWV3LXByb2ZpbGV4cHgAdAANcHJvZmlsZSBlbWFpbHA=, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJFeUZNQnpQUXV6VFFHUzhnWjYwVjJ1LXZxUE4zYm55MFVJSm1HaUpwS2pFIn0.eyJleHAiOjE2NDE5MDY5OTcsImlhdCI6MTY0MTkwNjY5NywianRpIjoiZmFhNDkwMzUtMzlhMi00N2ViLTk0MDAtY2I5M2E5ZmU2ZDEwIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiMTE1ZGY5MWUtNTVmZC00ZDg5LWI1NjgtMDM3NTNjNTVkZWUzIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoieCJ9.RP4jVdLa2GKR1jEUG_Ofs1jSfGSuf9hAaf2-j4R2AHCcLlwOZHQfjtGK56y9rw6Mc7yt4IuTEGT3_0YWpF73nJ5N36X7TcZC0389FvX0FvP5331H4S5EVmOJ7FyGpOHtmkLRXz4dfExVXoNmkyd6BrqB07pTnpObzqEyYxOX88fWlUjDk6RWTDWCykBixaI76kAACr7cHj6JEN_a2AkEpMI4HkZGWG0JnCqZkydE2kfceTUd-pP22WGrHs60GjudxqXJPsI90ESRgnEUGmuXiI5VgPtS_v89gz7KsuRr6RElEpCzvTqNDGXjy8OX7Zi59gzgqCzdmHhL_CD_-QqTiA, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641906997, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=172.30.0.12, kc-type=Bearer, kc-cc--team-ID=x, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.30.0.1, http-session-id=678045F550828C130F190E8F1F750303, http-session-last-accessed-time=1641906714794, kc-category-name=ACCESS, kc-iat=1641906697, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.30.0.1:55010 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 13:11:54.818  INFO 17 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 13:11:54.822  INFO 17 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@57edacad
2022-01-11 13:11:54.825  INFO 17 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@57edacad
2022-01-11 13:11:54.889  INFO 17 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@57edacad
2022-01-11 13:11:54.892  INFO 17 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@57edacad
2022-01-11 13:11:54.927  INFO 17 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@57edacad
2022-01-11 13:11:54.932  WARN 17 --- [https-jsse-nio-7071-exec-7] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: x
2022-01-11 13:11:54.938  WARN 17 --- [https-jsse-nio-7071-exec-7] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: x
2022-01-11 13:11:54.945  INFO 17 --- [https-jsse-nio-7071-exec-7] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-5895670434075-11619, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-11 13:11:54.960  INFO 17 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=fea0d079-7054-4eac-ad3e-1f02d7de41b5, content=DENY, timestamp=1641906714960, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-11 13:11:54.965  INFO 17 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=139ms, Total=154ms
2022-01-11 13:11:55.021  INFO 17 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=33703e43-668d-41b3-b8b1-12c72b47e22e, content=null, timestamp=1641906715012, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=55012, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=9462ddf72b74, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.30.0.1, kc-session-state=115df91e-55fd-4d89-b568-03753c55dee3, http-req-server-port=80, http-header-accept=*/*, kc-id=faa49035-39a2-47eb-9400-cb93a9fe6d10, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641906715005, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd2DNXNxAH4AEQAAAABh3YIJdAAkZmFhNDkwMzUtMzlhMi00N2ViLTk0MDAtY2I5M2E5ZmU2ZDEwdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAXh4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQxMTVkZjkxZS01NWZkLTRkODktYjU2OC0wMzc1M2M1NWRlZTNwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAATaHR0cDovLzE5Mi4xNjguMS44M3hwcHNyAC9vcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2VuJEFjY2VzcwewcQ/lekULAgACTAAFcm9sZXNxAH4AAUwADHZlcmlmeUNhbGxlcnEAfgAKeHBzcQB+ACt3DAAAABA/QAAAAAAABHQADm9mZmxpbmVfYWNjZXNzdAAGbWVtYmVydAAFYWRtaW50ABF1bWFfYXV0aG9yaXphdGlvbnhwc3IAF2phdmEudXRpbC5MaW5rZWRIYXNoTWFwNMBOXBBswPsCAAFaAAthY2Nlc3NPcmRlcnhxAH4AGD9AAAAAAAAMdwgAAAAQAAAAAXQAB2FjY291bnRzcQB+AC5zcQB+ACt3DAAAABA/QAAAAAAAA3QADm1hbmFnZS1hY2NvdW50dAAUbWFuYWdlLWFjY291bnQtbGlua3N0AAx2aWV3LXByb2ZpbGV4cHgAdAANcHJvZmlsZSBlbWFpbHA=, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJFeUZNQnpQUXV6VFFHUzhnWjYwVjJ1LXZxUE4zYm55MFVJSm1HaUpwS2pFIn0.eyJleHAiOjE2NDE5MDY5OTcsImlhdCI6MTY0MTkwNjY5NywianRpIjoiZmFhNDkwMzUtMzlhMi00N2ViLTk0MDAtY2I5M2E5ZmU2ZDEwIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiMTE1ZGY5MWUtNTVmZC00ZDg5LWI1NjgtMDM3NTNjNTVkZWUzIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoieCJ9.RP4jVdLa2GKR1jEUG_Ofs1jSfGSuf9hAaf2-j4R2AHCcLlwOZHQfjtGK56y9rw6Mc7yt4IuTEGT3_0YWpF73nJ5N36X7TcZC0389FvX0FvP5331H4S5EVmOJ7FyGpOHtmkLRXz4dfExVXoNmkyd6BrqB07pTnpObzqEyYxOX88fWlUjDk6RWTDWCykBixaI76kAACr7cHj6JEN_a2AkEpMI4HkZGWG0JnCqZkydE2kfceTUd-pP22WGrHs60GjudxqXJPsI90ESRgnEUGmuXiI5VgPtS_v89gz7KsuRr6RElEpCzvTqNDGXjy8OX7Zi59gzgqCzdmHhL_CD_-QqTiA, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641906997, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=172.30.0.12, kc-type=Bearer, kc-cc--team-ID=x, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.30.0.1, http-session-id=9553EFCEC5D29CDEB075188B68953936, http-session-last-accessed-time=1641906715005, kc-category-name=ACCESS, kc-iat=1641906697, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.30.0.1:55012 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 13:11:55.038  INFO 17 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 13:11:55.064  INFO 17 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3590974d
2022-01-11 13:11:55.075  INFO 17 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3590974d
2022-01-11 13:11:55.108  INFO 17 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3590974d
2022-01-11 13:11:55.113  INFO 17 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3590974d
2022-01-11 13:11:55.166  INFO 17 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3590974d
2022-01-11 13:11:55.169  WARN 17 --- [https-jsse-nio-7071-exec-8] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: x
2022-01-11 13:11:55.173  WARN 17 --- [https-jsse-nio-7071-exec-8] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: x
2022-01-11 13:11:55.181  INFO 17 --- [https-jsse-nio-7071-exec-8] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-5895898830575-187932, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-11 13:11:55.186  INFO 17 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=33703e43-668d-41b3-b8b1-12c72b47e22e, content=DENY, timestamp=1641906715186, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-11 13:11:55.197  INFO 17 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=137ms, Total=178ms
2022-01-11 13:11:55.281  INFO 17 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=23bc0e07-72a4-4ca1-ad0a-8aae1d774090, content=null, timestamp=1641906715268, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=55014, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=9462ddf72b74, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.30.0.1, kc-session-state=115df91e-55fd-4d89-b568-03753c55dee3, http-req-server-port=80, http-header-accept=*/*, kc-id=faa49035-39a2-47eb-9400-cb93a9fe6d10, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641906715250, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd2DNXNxAH4AEQAAAABh3YIJdAAkZmFhNDkwMzUtMzlhMi00N2ViLTk0MDAtY2I5M2E5ZmU2ZDEwdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAXh4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQxMTVkZjkxZS01NWZkLTRkODktYjU2OC0wMzc1M2M1NWRlZTNwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAATaHR0cDovLzE5Mi4xNjguMS44M3hwcHNyAC9vcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2VuJEFjY2VzcwewcQ/lekULAgACTAAFcm9sZXNxAH4AAUwADHZlcmlmeUNhbGxlcnEAfgAKeHBzcQB+ACt3DAAAABA/QAAAAAAABHQADm9mZmxpbmVfYWNjZXNzdAAGbWVtYmVydAAFYWRtaW50ABF1bWFfYXV0aG9yaXphdGlvbnhwc3IAF2phdmEudXRpbC5MaW5rZWRIYXNoTWFwNMBOXBBswPsCAAFaAAthY2Nlc3NPcmRlcnhxAH4AGD9AAAAAAAAMdwgAAAAQAAAAAXQAB2FjY291bnRzcQB+AC5zcQB+ACt3DAAAABA/QAAAAAAAA3QADm1hbmFnZS1hY2NvdW50dAAUbWFuYWdlLWFjY291bnQtbGlua3N0AAx2aWV3LXByb2ZpbGV4cHgAdAANcHJvZmlsZSBlbWFpbHA=, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJFeUZNQnpQUXV6VFFHUzhnWjYwVjJ1LXZxUE4zYm55MFVJSm1HaUpwS2pFIn0.eyJleHAiOjE2NDE5MDY5OTcsImlhdCI6MTY0MTkwNjY5NywianRpIjoiZmFhNDkwMzUtMzlhMi00N2ViLTk0MDAtY2I5M2E5ZmU2ZDEwIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiMTE1ZGY5MWUtNTVmZC00ZDg5LWI1NjgtMDM3NTNjNTVkZWUzIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoieCJ9.RP4jVdLa2GKR1jEUG_Ofs1jSfGSuf9hAaf2-j4R2AHCcLlwOZHQfjtGK56y9rw6Mc7yt4IuTEGT3_0YWpF73nJ5N36X7TcZC0389FvX0FvP5331H4S5EVmOJ7FyGpOHtmkLRXz4dfExVXoNmkyd6BrqB07pTnpObzqEyYxOX88fWlUjDk6RWTDWCykBixaI76kAACr7cHj6JEN_a2AkEpMI4HkZGWG0JnCqZkydE2kfceTUd-pP22WGrHs60GjudxqXJPsI90ESRgnEUGmuXiI5VgPtS_v89gz7KsuRr6RElEpCzvTqNDGXjy8OX7Zi59gzgqCzdmHhL_CD_-QqTiA, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641906997, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=172.30.0.12, kc-type=Bearer, kc-cc--team-ID=x, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.30.0.1, http-session-id=390BB5668F6696A565FFA8ABDF5C4CEB, http-session-last-accessed-time=1641906715250, kc-category-name=ACCESS, kc-iat=1641906697, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.30.0.1:55014 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 13:11:55.286  INFO 17 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 13:11:55.300  INFO 17 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5d907341
2022-01-11 13:11:55.307  INFO 17 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5d907341
2022-01-11 13:11:55.358  INFO 17 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5d907341
2022-01-11 13:11:55.366  INFO 17 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5d907341
2022-01-11 13:11:55.437  INFO 17 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5d907341
2022-01-11 13:11:55.440  WARN 17 --- [https-jsse-nio-7071-exec-9] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: x
2022-01-11 13:11:55.443  WARN 17 --- [https-jsse-nio-7071-exec-9] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: x
2022-01-11 13:11:55.452  INFO 17 --- [https-jsse-nio-7071-exec-9] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-5896139119175-652545, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-11 13:11:55.458  INFO 17 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=23bc0e07-72a4-4ca1-ad0a-8aae1d774090, content=DENY, timestamp=1641906715458, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-11 13:11:55.466  INFO 17 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=169ms, Total=187ms
2022-01-11 13:11:55.542  INFO 17 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=365cbb06-b0cd-43fd-ad71-3cd2514d7738, content=null, timestamp=1641906715535, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=55016, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=9462ddf72b74, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.30.0.1, kc-session-state=115df91e-55fd-4d89-b568-03753c55dee3, http-req-server-port=80, http-header-accept=*/*, kc-id=faa49035-39a2-47eb-9400-cb93a9fe6d10, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641906715515, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd2DNXNxAH4AEQAAAABh3YIJdAAkZmFhNDkwMzUtMzlhMi00N2ViLTk0MDAtY2I5M2E5ZmU2ZDEwdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAXh4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQxMTVkZjkxZS01NWZkLTRkODktYjU2OC0wMzc1M2M1NWRlZTNwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAATaHR0cDovLzE5Mi4xNjguMS44M3hwcHNyAC9vcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2VuJEFjY2VzcwewcQ/lekULAgACTAAFcm9sZXNxAH4AAUwADHZlcmlmeUNhbGxlcnEAfgAKeHBzcQB+ACt3DAAAABA/QAAAAAAABHQADm9mZmxpbmVfYWNjZXNzdAAGbWVtYmVydAAFYWRtaW50ABF1bWFfYXV0aG9yaXphdGlvbnhwc3IAF2phdmEudXRpbC5MaW5rZWRIYXNoTWFwNMBOXBBswPsCAAFaAAthY2Nlc3NPcmRlcnhxAH4AGD9AAAAAAAAMdwgAAAAQAAAAAXQAB2FjY291bnRzcQB+AC5zcQB+ACt3DAAAABA/QAAAAAAAA3QADm1hbmFnZS1hY2NvdW50dAAUbWFuYWdlLWFjY291bnQtbGlua3N0AAx2aWV3LXByb2ZpbGV4cHgAdAANcHJvZmlsZSBlbWFpbHA=, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJFeUZNQnpQUXV6VFFHUzhnWjYwVjJ1LXZxUE4zYm55MFVJSm1HaUpwS2pFIn0.eyJleHAiOjE2NDE5MDY5OTcsImlhdCI6MTY0MTkwNjY5NywianRpIjoiZmFhNDkwMzUtMzlhMi00N2ViLTk0MDAtY2I5M2E5ZmU2ZDEwIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiMTE1ZGY5MWUtNTVmZC00ZDg5LWI1NjgtMDM3NTNjNTVkZWUzIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoieCJ9.RP4jVdLa2GKR1jEUG_Ofs1jSfGSuf9hAaf2-j4R2AHCcLlwOZHQfjtGK56y9rw6Mc7yt4IuTEGT3_0YWpF73nJ5N36X7TcZC0389FvX0FvP5331H4S5EVmOJ7FyGpOHtmkLRXz4dfExVXoNmkyd6BrqB07pTnpObzqEyYxOX88fWlUjDk6RWTDWCykBixaI76kAACr7cHj6JEN_a2AkEpMI4HkZGWG0JnCqZkydE2kfceTUd-pP22WGrHs60GjudxqXJPsI90ESRgnEUGmuXiI5VgPtS_v89gz7KsuRr6RElEpCzvTqNDGXjy8OX7Zi59gzgqCzdmHhL_CD_-QqTiA, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641906997, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=172.30.0.12, kc-type=Bearer, kc-cc--team-ID=x, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.30.0.1, http-session-id=413731ADEFA7875BE592418E813E1CA0, http-session-last-accessed-time=1641906715515, kc-category-name=ACCESS, kc-iat=1641906697, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.30.0.1:55016 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 13:11:55.547  INFO 17 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 13:11:55.552  INFO 17 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@14450897
2022-01-11 13:11:55.559  INFO 17 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@14450897
2022-01-11 13:11:55.589  INFO 17 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@14450897
2022-01-11 13:11:55.596  INFO 17 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@14450897
2022-01-11 13:11:55.636  INFO 17 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@14450897
2022-01-11 13:11:55.639  WARN 17 --- [https-jsse-nio-7071-exec-10] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: x
2022-01-11 13:11:55.650  WARN 17 --- [https-jsse-nio-7071-exec-10] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: x
2022-01-11 13:11:55.655  INFO 17 --- [https-jsse-nio-7071-exec-10] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-5896400417475-218252, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-11 13:11:55.666  INFO 17 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=365cbb06-b0cd-43fd-ad71-3cd2514d7738, content=DENY, timestamp=1641906715666, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-11 13:11:55.671  INFO 17 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=116ms, Total=130ms
2022-01-11 13:11:55.748  INFO 17 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=7060578f-c010-4b34-999e-a17365a03b85, content=null, timestamp=1641906715737, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=55018, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=9462ddf72b74, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.30.0.1, kc-session-state=115df91e-55fd-4d89-b568-03753c55dee3, http-req-server-port=80, http-header-accept=*/*, kc-id=faa49035-39a2-47eb-9400-cb93a9fe6d10, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641906715730, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd2DNXNxAH4AEQAAAABh3YIJdAAkZmFhNDkwMzUtMzlhMi00N2ViLTk0MDAtY2I5M2E5ZmU2ZDEwdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAXh4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQxMTVkZjkxZS01NWZkLTRkODktYjU2OC0wMzc1M2M1NWRlZTNwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAATaHR0cDovLzE5Mi4xNjguMS44M3hwcHNyAC9vcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2VuJEFjY2VzcwewcQ/lekULAgACTAAFcm9sZXNxAH4AAUwADHZlcmlmeUNhbGxlcnEAfgAKeHBzcQB+ACt3DAAAABA/QAAAAAAABHQADm9mZmxpbmVfYWNjZXNzdAAGbWVtYmVydAAFYWRtaW50ABF1bWFfYXV0aG9yaXphdGlvbnhwc3IAF2phdmEudXRpbC5MaW5rZWRIYXNoTWFwNMBOXBBswPsCAAFaAAthY2Nlc3NPcmRlcnhxAH4AGD9AAAAAAAAMdwgAAAAQAAAAAXQAB2FjY291bnRzcQB+AC5zcQB+ACt3DAAAABA/QAAAAAAAA3QADm1hbmFnZS1hY2NvdW50dAAUbWFuYWdlLWFjY291bnQtbGlua3N0AAx2aWV3LXByb2ZpbGV4cHgAdAANcHJvZmlsZSBlbWFpbHA=, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJFeUZNQnpQUXV6VFFHUzhnWjYwVjJ1LXZxUE4zYm55MFVJSm1HaUpwS2pFIn0.eyJleHAiOjE2NDE5MDY5OTcsImlhdCI6MTY0MTkwNjY5NywianRpIjoiZmFhNDkwMzUtMzlhMi00N2ViLTk0MDAtY2I5M2E5ZmU2ZDEwIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiMTE1ZGY5MWUtNTVmZC00ZDg5LWI1NjgtMDM3NTNjNTVkZWUzIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoieCJ9.RP4jVdLa2GKR1jEUG_Ofs1jSfGSuf9hAaf2-j4R2AHCcLlwOZHQfjtGK56y9rw6Mc7yt4IuTEGT3_0YWpF73nJ5N36X7TcZC0389FvX0FvP5331H4S5EVmOJ7FyGpOHtmkLRXz4dfExVXoNmkyd6BrqB07pTnpObzqEyYxOX88fWlUjDk6RWTDWCykBixaI76kAACr7cHj6JEN_a2AkEpMI4HkZGWG0JnCqZkydE2kfceTUd-pP22WGrHs60GjudxqXJPsI90ESRgnEUGmuXiI5VgPtS_v89gz7KsuRr6RElEpCzvTqNDGXjy8OX7Zi59gzgqCzdmHhL_CD_-QqTiA, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641906997, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=172.30.0.12, kc-type=Bearer, kc-cc--team-ID=x, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.30.0.1, http-session-id=FBBE5E8B9F4B515179269D5A79CCE9F5, http-session-last-accessed-time=1641906715730, kc-category-name=ACCESS, kc-iat=1641906697, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.30.0.1:55018 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 13:11:55.753  INFO 17 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 13:11:55.765  INFO 17 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@327f64cd
2022-01-11 13:11:55.776  INFO 17 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@327f64cd
2022-01-11 13:11:55.828  INFO 17 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@327f64cd
2022-01-11 13:11:55.833  INFO 17 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@327f64cd
2022-01-11 13:11:55.912  INFO 17 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@327f64cd
2022-01-11 13:11:55.920  WARN 17 --- [https-jsse-nio-7071-exec-1] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: x
2022-01-11 13:11:55.922  WARN 17 --- [https-jsse-nio-7071-exec-1] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: x
2022-01-11 13:11:55.925  INFO 17 --- [https-jsse-nio-7071-exec-1] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-5896605321675-199322, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-11 13:11:55.928  INFO 17 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=7060578f-c010-4b34-999e-a17365a03b85, content=DENY, timestamp=1641906715928, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-11 13:11:55.932  INFO 17 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=173ms, Total=186ms
2022-01-11 13:11:56.000  INFO 17 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=27e8e9bc-e5ae-4141-adbc-75b495575d7b, content=null, timestamp=1641906715981, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=55020, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=9462ddf72b74, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.30.0.1, kc-session-state=115df91e-55fd-4d89-b568-03753c55dee3, http-req-server-port=80, http-header-accept=*/*, kc-id=faa49035-39a2-47eb-9400-cb93a9fe6d10, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641906715979, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd2DNXNxAH4AEQAAAABh3YIJdAAkZmFhNDkwMzUtMzlhMi00N2ViLTk0MDAtY2I5M2E5ZmU2ZDEwdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAXh4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQxMTVkZjkxZS01NWZkLTRkODktYjU2OC0wMzc1M2M1NWRlZTNwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAATaHR0cDovLzE5Mi4xNjguMS44M3hwcHNyAC9vcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2VuJEFjY2VzcwewcQ/lekULAgACTAAFcm9sZXNxAH4AAUwADHZlcmlmeUNhbGxlcnEAfgAKeHBzcQB+ACt3DAAAABA/QAAAAAAABHQADm9mZmxpbmVfYWNjZXNzdAAGbWVtYmVydAAFYWRtaW50ABF1bWFfYXV0aG9yaXphdGlvbnhwc3IAF2phdmEudXRpbC5MaW5rZWRIYXNoTWFwNMBOXBBswPsCAAFaAAthY2Nlc3NPcmRlcnhxAH4AGD9AAAAAAAAMdwgAAAAQAAAAAXQAB2FjY291bnRzcQB+AC5zcQB+ACt3DAAAABA/QAAAAAAAA3QADm1hbmFnZS1hY2NvdW50dAAUbWFuYWdlLWFjY291bnQtbGlua3N0AAx2aWV3LXByb2ZpbGV4cHgAdAANcHJvZmlsZSBlbWFpbHA=, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJFeUZNQnpQUXV6VFFHUzhnWjYwVjJ1LXZxUE4zYm55MFVJSm1HaUpwS2pFIn0.eyJleHAiOjE2NDE5MDY5OTcsImlhdCI6MTY0MTkwNjY5NywianRpIjoiZmFhNDkwMzUtMzlhMi00N2ViLTk0MDAtY2I5M2E5ZmU2ZDEwIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiMTE1ZGY5MWUtNTVmZC00ZDg5LWI1NjgtMDM3NTNjNTVkZWUzIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoieCJ9.RP4jVdLa2GKR1jEUG_Ofs1jSfGSuf9hAaf2-j4R2AHCcLlwOZHQfjtGK56y9rw6Mc7yt4IuTEGT3_0YWpF73nJ5N36X7TcZC0389FvX0FvP5331H4S5EVmOJ7FyGpOHtmkLRXz4dfExVXoNmkyd6BrqB07pTnpObzqEyYxOX88fWlUjDk6RWTDWCykBixaI76kAACr7cHj6JEN_a2AkEpMI4HkZGWG0JnCqZkydE2kfceTUd-pP22WGrHs60GjudxqXJPsI90ESRgnEUGmuXiI5VgPtS_v89gz7KsuRr6RElEpCzvTqNDGXjy8OX7Zi59gzgqCzdmHhL_CD_-QqTiA, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641906997, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=172.30.0.12, kc-type=Bearer, kc-cc--team-ID=x, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.30.0.1, http-session-id=3E43E5EEBA113BD54D9D0C3249E9E124, http-session-last-accessed-time=1641906715979, kc-category-name=ACCESS, kc-iat=1641906697, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.30.0.1:55020 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 13:11:56.008  INFO 17 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 13:11:56.026  INFO 17 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@35d869bc
2022-01-11 13:11:56.031  INFO 17 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@35d869bc
2022-01-11 13:11:56.121  INFO 17 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@35d869bc
2022-01-11 13:11:56.124  INFO 17 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@35d869bc
2022-01-11 13:11:56.236  INFO 17 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@35d869bc
2022-01-11 13:11:56.241  WARN 17 --- [https-jsse-nio-7071-exec-2] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: x
2022-01-11 13:11:56.245  WARN 17 --- [https-jsse-nio-7071-exec-2] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: x
2022-01-11 13:11:56.249  INFO 17 --- [https-jsse-nio-7071-exec-2] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-5896861424075-324580, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-11 13:11:56.252  INFO 17 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=27e8e9bc-e5ae-4141-adbc-75b495575d7b, content=DENY, timestamp=1641906716252, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-11 13:11:56.258  INFO 17 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=241ms, Total=260ms
2022-01-11 13:11:56.322  INFO 17 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=c83f3244-20a9-4e7f-80aa-bd998d11054b, content=null, timestamp=1641906716302, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=55022, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=9462ddf72b74, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.30.0.1, kc-session-state=115df91e-55fd-4d89-b568-03753c55dee3, http-req-server-port=80, http-header-accept=*/*, kc-id=faa49035-39a2-47eb-9400-cb93a9fe6d10, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641906716300, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd2DNXNxAH4AEQAAAABh3YIJdAAkZmFhNDkwMzUtMzlhMi00N2ViLTk0MDAtY2I5M2E5ZmU2ZDEwdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAXh4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQxMTVkZjkxZS01NWZkLTRkODktYjU2OC0wMzc1M2M1NWRlZTNwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAATaHR0cDovLzE5Mi4xNjguMS44M3hwcHNyAC9vcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2VuJEFjY2VzcwewcQ/lekULAgACTAAFcm9sZXNxAH4AAUwADHZlcmlmeUNhbGxlcnEAfgAKeHBzcQB+ACt3DAAAABA/QAAAAAAABHQADm9mZmxpbmVfYWNjZXNzdAAGbWVtYmVydAAFYWRtaW50ABF1bWFfYXV0aG9yaXphdGlvbnhwc3IAF2phdmEudXRpbC5MaW5rZWRIYXNoTWFwNMBOXBBswPsCAAFaAAthY2Nlc3NPcmRlcnhxAH4AGD9AAAAAAAAMdwgAAAAQAAAAAXQAB2FjY291bnRzcQB+AC5zcQB+ACt3DAAAABA/QAAAAAAAA3QADm1hbmFnZS1hY2NvdW50dAAUbWFuYWdlLWFjY291bnQtbGlua3N0AAx2aWV3LXByb2ZpbGV4cHgAdAANcHJvZmlsZSBlbWFpbHA=, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJFeUZNQnpQUXV6VFFHUzhnWjYwVjJ1LXZxUE4zYm55MFVJSm1HaUpwS2pFIn0.eyJleHAiOjE2NDE5MDY5OTcsImlhdCI6MTY0MTkwNjY5NywianRpIjoiZmFhNDkwMzUtMzlhMi00N2ViLTk0MDAtY2I5M2E5ZmU2ZDEwIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiMTE1ZGY5MWUtNTVmZC00ZDg5LWI1NjgtMDM3NTNjNTVkZWUzIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoieCJ9.RP4jVdLa2GKR1jEUG_Ofs1jSfGSuf9hAaf2-j4R2AHCcLlwOZHQfjtGK56y9rw6Mc7yt4IuTEGT3_0YWpF73nJ5N36X7TcZC0389FvX0FvP5331H4S5EVmOJ7FyGpOHtmkLRXz4dfExVXoNmkyd6BrqB07pTnpObzqEyYxOX88fWlUjDk6RWTDWCykBixaI76kAACr7cHj6JEN_a2AkEpMI4HkZGWG0JnCqZkydE2kfceTUd-pP22WGrHs60GjudxqXJPsI90ESRgnEUGmuXiI5VgPtS_v89gz7KsuRr6RElEpCzvTqNDGXjy8OX7Zi59gzgqCzdmHhL_CD_-QqTiA, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641906997, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=172.30.0.12, kc-type=Bearer, kc-cc--team-ID=x, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.30.0.1, http-session-id=F796EB3481AB7A9BAB2A3FC132ED4A1A, http-session-last-accessed-time=1641906716300, kc-category-name=ACCESS, kc-iat=1641906697, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.30.0.1:55022 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 13:11:56.339  INFO 17 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 13:11:56.360  INFO 17 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@690aadcc
2022-01-11 13:11:56.368  INFO 17 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@690aadcc
2022-01-11 13:11:56.409  INFO 17 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@690aadcc
2022-01-11 13:11:56.419  INFO 17 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@690aadcc
2022-01-11 13:11:56.467  INFO 17 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@690aadcc
2022-01-11 13:11:56.470  WARN 17 --- [https-jsse-nio-7071-exec-3] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: x
2022-01-11 13:11:56.476  WARN 17 --- [https-jsse-nio-7071-exec-3] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: x
2022-01-11 13:11:56.483  INFO 17 --- [https-jsse-nio-7071-exec-3] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-5897193763075-577892, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-11 13:11:56.489  INFO 17 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=c83f3244-20a9-4e7f-80aa-bd998d11054b, content=DENY, timestamp=1641906716489, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-11 13:11:56.500  INFO 17 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=145ms, Total=186ms
2022-01-11 13:11:56.605  INFO 17 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=806ce085-2cfa-4f8c-8f03-3476926234a4, content=null, timestamp=1641906716573, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=55024, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=9462ddf72b74, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.30.0.1, kc-session-state=115df91e-55fd-4d89-b568-03753c55dee3, http-req-server-port=80, http-header-accept=*/*, kc-id=faa49035-39a2-47eb-9400-cb93a9fe6d10, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641906716571, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd2DNXNxAH4AEQAAAABh3YIJdAAkZmFhNDkwMzUtMzlhMi00N2ViLTk0MDAtY2I5M2E5ZmU2ZDEwdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAXh4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQxMTVkZjkxZS01NWZkLTRkODktYjU2OC0wMzc1M2M1NWRlZTNwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAATaHR0cDovLzE5Mi4xNjguMS44M3hwcHNyAC9vcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2VuJEFjY2VzcwewcQ/lekULAgACTAAFcm9sZXNxAH4AAUwADHZlcmlmeUNhbGxlcnEAfgAKeHBzcQB+ACt3DAAAABA/QAAAAAAABHQADm9mZmxpbmVfYWNjZXNzdAAGbWVtYmVydAAFYWRtaW50ABF1bWFfYXV0aG9yaXphdGlvbnhwc3IAF2phdmEudXRpbC5MaW5rZWRIYXNoTWFwNMBOXBBswPsCAAFaAAthY2Nlc3NPcmRlcnhxAH4AGD9AAAAAAAAMdwgAAAAQAAAAAXQAB2FjY291bnRzcQB+AC5zcQB+ACt3DAAAABA/QAAAAAAAA3QADm1hbmFnZS1hY2NvdW50dAAUbWFuYWdlLWFjY291bnQtbGlua3N0AAx2aWV3LXByb2ZpbGV4cHgAdAANcHJvZmlsZSBlbWFpbHA=, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJFeUZNQnpQUXV6VFFHUzhnWjYwVjJ1LXZxUE4zYm55MFVJSm1HaUpwS2pFIn0.eyJleHAiOjE2NDE5MDY5OTcsImlhdCI6MTY0MTkwNjY5NywianRpIjoiZmFhNDkwMzUtMzlhMi00N2ViLTk0MDAtY2I5M2E5ZmU2ZDEwIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiMTE1ZGY5MWUtNTVmZC00ZDg5LWI1NjgtMDM3NTNjNTVkZWUzIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoieCJ9.RP4jVdLa2GKR1jEUG_Ofs1jSfGSuf9hAaf2-j4R2AHCcLlwOZHQfjtGK56y9rw6Mc7yt4IuTEGT3_0YWpF73nJ5N36X7TcZC0389FvX0FvP5331H4S5EVmOJ7FyGpOHtmkLRXz4dfExVXoNmkyd6BrqB07pTnpObzqEyYxOX88fWlUjDk6RWTDWCykBixaI76kAACr7cHj6JEN_a2AkEpMI4HkZGWG0JnCqZkydE2kfceTUd-pP22WGrHs60GjudxqXJPsI90ESRgnEUGmuXiI5VgPtS_v89gz7KsuRr6RElEpCzvTqNDGXjy8OX7Zi59gzgqCzdmHhL_CD_-QqTiA, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641906997, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=172.30.0.12, kc-type=Bearer, kc-cc--team-ID=x, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.30.0.1, http-session-id=A79D630A6B8DAEB8F761247E51893AC4, http-session-last-accessed-time=1641906716571, kc-category-name=ACCESS, kc-iat=1641906697, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.30.0.1:55024 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 13:11:56.612  INFO 17 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 13:11:56.619  INFO 17 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4992f33b
2022-01-11 13:11:56.623  INFO 17 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4992f33b
2022-01-11 13:11:56.654  INFO 17 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4992f33b
2022-01-11 13:11:56.662  INFO 17 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4992f33b
2022-01-11 13:11:56.691  INFO 17 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4992f33b
2022-01-11 13:11:56.694  WARN 17 --- [https-jsse-nio-7071-exec-4] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: x
2022-01-11 13:11:56.698  WARN 17 --- [https-jsse-nio-7071-exec-4] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: x
2022-01-11 13:11:56.703  INFO 17 --- [https-jsse-nio-7071-exec-4] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-5897465658175-478598, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-11 13:11:56.705  INFO 17 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=806ce085-2cfa-4f8c-8f03-3476926234a4, content=DENY, timestamp=1641906716705, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-11 13:11:56.711  INFO 17 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=89ms, Total=117ms
2022-01-11 13:11:56.772  INFO 17 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=52b8ab25-d38d-44de-b281-8472b95e74df, content=null, timestamp=1641906716755, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=55026, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=9462ddf72b74, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.30.0.1, kc-session-state=115df91e-55fd-4d89-b568-03753c55dee3, http-req-server-port=80, http-header-accept=*/*, kc-id=faa49035-39a2-47eb-9400-cb93a9fe6d10, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641906716753, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd2DNXNxAH4AEQAAAABh3YIJdAAkZmFhNDkwMzUtMzlhMi00N2ViLTk0MDAtY2I5M2E5ZmU2ZDEwdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAXh4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQxMTVkZjkxZS01NWZkLTRkODktYjU2OC0wMzc1M2M1NWRlZTNwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAATaHR0cDovLzE5Mi4xNjguMS44M3hwcHNyAC9vcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2VuJEFjY2VzcwewcQ/lekULAgACTAAFcm9sZXNxAH4AAUwADHZlcmlmeUNhbGxlcnEAfgAKeHBzcQB+ACt3DAAAABA/QAAAAAAABHQADm9mZmxpbmVfYWNjZXNzdAAGbWVtYmVydAAFYWRtaW50ABF1bWFfYXV0aG9yaXphdGlvbnhwc3IAF2phdmEudXRpbC5MaW5rZWRIYXNoTWFwNMBOXBBswPsCAAFaAAthY2Nlc3NPcmRlcnhxAH4AGD9AAAAAAAAMdwgAAAAQAAAAAXQAB2FjY291bnRzcQB+AC5zcQB+ACt3DAAAABA/QAAAAAAAA3QADm1hbmFnZS1hY2NvdW50dAAUbWFuYWdlLWFjY291bnQtbGlua3N0AAx2aWV3LXByb2ZpbGV4cHgAdAANcHJvZmlsZSBlbWFpbHA=, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJFeUZNQnpQUXV6VFFHUzhnWjYwVjJ1LXZxUE4zYm55MFVJSm1HaUpwS2pFIn0.eyJleHAiOjE2NDE5MDY5OTcsImlhdCI6MTY0MTkwNjY5NywianRpIjoiZmFhNDkwMzUtMzlhMi00N2ViLTk0MDAtY2I5M2E5ZmU2ZDEwIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiMTE1ZGY5MWUtNTVmZC00ZDg5LWI1NjgtMDM3NTNjNTVkZWUzIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoieCJ9.RP4jVdLa2GKR1jEUG_Ofs1jSfGSuf9hAaf2-j4R2AHCcLlwOZHQfjtGK56y9rw6Mc7yt4IuTEGT3_0YWpF73nJ5N36X7TcZC0389FvX0FvP5331H4S5EVmOJ7FyGpOHtmkLRXz4dfExVXoNmkyd6BrqB07pTnpObzqEyYxOX88fWlUjDk6RWTDWCykBixaI76kAACr7cHj6JEN_a2AkEpMI4HkZGWG0JnCqZkydE2kfceTUd-pP22WGrHs60GjudxqXJPsI90ESRgnEUGmuXiI5VgPtS_v89gz7KsuRr6RElEpCzvTqNDGXjy8OX7Zi59gzgqCzdmHhL_CD_-QqTiA, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641906997, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=172.30.0.12, kc-type=Bearer, kc-cc--team-ID=x, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.30.0.1, http-session-id=07530C77263FF49CEF5A5EC166011417, http-session-last-accessed-time=1641906716753, kc-category-name=ACCESS, kc-iat=1641906697, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.30.0.1:55026 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 13:11:56.786  INFO 17 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 13:11:56.792  INFO 17 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1af97624
2022-01-11 13:11:56.795  INFO 17 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1af97624
2022-01-11 13:11:56.820  INFO 17 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1af97624
2022-01-11 13:11:56.824  INFO 17 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1af97624
2022-01-11 13:11:56.938  INFO 17 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1af97624
2022-01-11 13:11:56.943  WARN 17 --- [https-jsse-nio-7071-exec-5] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: x
2022-01-11 13:11:56.946  WARN 17 --- [https-jsse-nio-7071-exec-5] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: x
2022-01-11 13:11:56.949  INFO 17 --- [https-jsse-nio-7071-exec-5] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-5897639512975-983639, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-11 13:11:56.951  INFO 17 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=52b8ab25-d38d-44de-b281-8472b95e74df, content=DENY, timestamp=1641906716951, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-11 13:11:56.954  INFO 17 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=161ms, Total=186ms
2022-01-11 13:11:57.041  INFO 17 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=fa952beb-bee5-4216-8dc4-bd8fb9ebbad3, content=null, timestamp=1641906717022, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=55028, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=9462ddf72b74, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.30.0.1, kc-session-state=115df91e-55fd-4d89-b568-03753c55dee3, http-req-server-port=80, http-header-accept=*/*, kc-id=faa49035-39a2-47eb-9400-cb93a9fe6d10, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641906717020, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd2DNXNxAH4AEQAAAABh3YIJdAAkZmFhNDkwMzUtMzlhMi00N2ViLTk0MDAtY2I5M2E5ZmU2ZDEwdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAXh4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQxMTVkZjkxZS01NWZkLTRkODktYjU2OC0wMzc1M2M1NWRlZTNwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAATaHR0cDovLzE5Mi4xNjguMS44M3hwcHNyAC9vcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2VuJEFjY2VzcwewcQ/lekULAgACTAAFcm9sZXNxAH4AAUwADHZlcmlmeUNhbGxlcnEAfgAKeHBzcQB+ACt3DAAAABA/QAAAAAAABHQADm9mZmxpbmVfYWNjZXNzdAAGbWVtYmVydAAFYWRtaW50ABF1bWFfYXV0aG9yaXphdGlvbnhwc3IAF2phdmEudXRpbC5MaW5rZWRIYXNoTWFwNMBOXBBswPsCAAFaAAthY2Nlc3NPcmRlcnhxAH4AGD9AAAAAAAAMdwgAAAAQAAAAAXQAB2FjY291bnRzcQB+AC5zcQB+ACt3DAAAABA/QAAAAAAAA3QADm1hbmFnZS1hY2NvdW50dAAUbWFuYWdlLWFjY291bnQtbGlua3N0AAx2aWV3LXByb2ZpbGV4cHgAdAANcHJvZmlsZSBlbWFpbHA=, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJFeUZNQnpQUXV6VFFHUzhnWjYwVjJ1LXZxUE4zYm55MFVJSm1HaUpwS2pFIn0.eyJleHAiOjE2NDE5MDY5OTcsImlhdCI6MTY0MTkwNjY5NywianRpIjoiZmFhNDkwMzUtMzlhMi00N2ViLTk0MDAtY2I5M2E5ZmU2ZDEwIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiMTE1ZGY5MWUtNTVmZC00ZDg5LWI1NjgtMDM3NTNjNTVkZWUzIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoieCJ9.RP4jVdLa2GKR1jEUG_Ofs1jSfGSuf9hAaf2-j4R2AHCcLlwOZHQfjtGK56y9rw6Mc7yt4IuTEGT3_0YWpF73nJ5N36X7TcZC0389FvX0FvP5331H4S5EVmOJ7FyGpOHtmkLRXz4dfExVXoNmkyd6BrqB07pTnpObzqEyYxOX88fWlUjDk6RWTDWCykBixaI76kAACr7cHj6JEN_a2AkEpMI4HkZGWG0JnCqZkydE2kfceTUd-pP22WGrHs60GjudxqXJPsI90ESRgnEUGmuXiI5VgPtS_v89gz7KsuRr6RElEpCzvTqNDGXjy8OX7Zi59gzgqCzdmHhL_CD_-QqTiA, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641906997, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=172.30.0.12, kc-type=Bearer, kc-cc--team-ID=x, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.30.0.1, http-session-id=4172403C2BB0D65A6D9E6005E4CBBDDA, http-session-last-accessed-time=1641906717020, kc-category-name=ACCESS, kc-iat=1641906697, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.30.0.1:55028 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 13:11:57.047  INFO 17 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 13:11:57.051  INFO 17 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6544ab40
2022-01-11 13:11:57.053  INFO 17 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6544ab40
2022-01-11 13:11:57.096  INFO 17 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6544ab40
2022-01-11 13:11:57.101  INFO 17 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6544ab40
2022-01-11 13:11:57.141  INFO 17 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6544ab40
2022-01-11 13:11:57.144  WARN 17 --- [https-jsse-nio-7071-exec-6] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: x
2022-01-11 13:11:57.146  WARN 17 --- [https-jsse-nio-7071-exec-6] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: x
2022-01-11 13:11:57.150  INFO 17 --- [https-jsse-nio-7071-exec-6] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-5897898790975-258438, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-11 13:11:57.152  INFO 17 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=fa952beb-bee5-4216-8dc4-bd8fb9ebbad3, content=DENY, timestamp=1641906717152, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-11 13:11:57.160  INFO 17 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=103ms, Total=123ms
2022-01-11 13:11:57.240  INFO 17 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=d19ba899-fb4c-4676-8d64-f0fceb22de91, content=null, timestamp=1641906717221, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=55030, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=9462ddf72b74, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.30.0.1, kc-session-state=115df91e-55fd-4d89-b568-03753c55dee3, http-req-server-port=80, http-header-accept=*/*, kc-id=faa49035-39a2-47eb-9400-cb93a9fe6d10, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641906717207, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd2DNXNxAH4AEQAAAABh3YIJdAAkZmFhNDkwMzUtMzlhMi00N2ViLTk0MDAtY2I5M2E5ZmU2ZDEwdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAXh4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQxMTVkZjkxZS01NWZkLTRkODktYjU2OC0wMzc1M2M1NWRlZTNwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAATaHR0cDovLzE5Mi4xNjguMS44M3hwcHNyAC9vcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2VuJEFjY2VzcwewcQ/lekULAgACTAAFcm9sZXNxAH4AAUwADHZlcmlmeUNhbGxlcnEAfgAKeHBzcQB+ACt3DAAAABA/QAAAAAAABHQADm9mZmxpbmVfYWNjZXNzdAAGbWVtYmVydAAFYWRtaW50ABF1bWFfYXV0aG9yaXphdGlvbnhwc3IAF2phdmEudXRpbC5MaW5rZWRIYXNoTWFwNMBOXBBswPsCAAFaAAthY2Nlc3NPcmRlcnhxAH4AGD9AAAAAAAAMdwgAAAAQAAAAAXQAB2FjY291bnRzcQB+AC5zcQB+ACt3DAAAABA/QAAAAAAAA3QADm1hbmFnZS1hY2NvdW50dAAUbWFuYWdlLWFjY291bnQtbGlua3N0AAx2aWV3LXByb2ZpbGV4cHgAdAANcHJvZmlsZSBlbWFpbHA=, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJFeUZNQnpQUXV6VFFHUzhnWjYwVjJ1LXZxUE4zYm55MFVJSm1HaUpwS2pFIn0.eyJleHAiOjE2NDE5MDY5OTcsImlhdCI6MTY0MTkwNjY5NywianRpIjoiZmFhNDkwMzUtMzlhMi00N2ViLTk0MDAtY2I5M2E5ZmU2ZDEwIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiMTE1ZGY5MWUtNTVmZC00ZDg5LWI1NjgtMDM3NTNjNTVkZWUzIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoieCJ9.RP4jVdLa2GKR1jEUG_Ofs1jSfGSuf9hAaf2-j4R2AHCcLlwOZHQfjtGK56y9rw6Mc7yt4IuTEGT3_0YWpF73nJ5N36X7TcZC0389FvX0FvP5331H4S5EVmOJ7FyGpOHtmkLRXz4dfExVXoNmkyd6BrqB07pTnpObzqEyYxOX88fWlUjDk6RWTDWCykBixaI76kAACr7cHj6JEN_a2AkEpMI4HkZGWG0JnCqZkydE2kfceTUd-pP22WGrHs60GjudxqXJPsI90ESRgnEUGmuXiI5VgPtS_v89gz7KsuRr6RElEpCzvTqNDGXjy8OX7Zi59gzgqCzdmHhL_CD_-QqTiA, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641906997, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=172.30.0.12, kc-type=Bearer, kc-cc--team-ID=x, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.30.0.1, http-session-id=E56644B0F3F605CC2A86F1E67C6FE169, http-session-last-accessed-time=1641906717207, kc-category-name=ACCESS, kc-iat=1641906697, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.30.0.1:55030 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 13:11:57.256  INFO 17 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 13:11:57.261  INFO 17 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@219a119
2022-01-11 13:11:57.264  INFO 17 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@219a119
2022-01-11 13:11:57.368  INFO 17 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@219a119
2022-01-11 13:11:57.374  INFO 17 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@219a119
2022-01-11 13:11:57.449  INFO 17 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@219a119
2022-01-11 13:11:57.452  WARN 17 --- [https-jsse-nio-7071-exec-7] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: x
2022-01-11 13:11:57.456  WARN 17 --- [https-jsse-nio-7071-exec-7] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: x
2022-01-11 13:11:57.460  INFO 17 --- [https-jsse-nio-7071-exec-7] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-5898107737575-102741, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-11 13:11:57.462  INFO 17 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=d19ba899-fb4c-4676-8d64-f0fceb22de91, content=DENY, timestamp=1641906717462, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-11 13:11:57.466  INFO 17 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=204ms, Total=228ms
2022-01-11 13:11:57.539  INFO 17 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=22d03b7e-30ec-4179-93ce-318d69435fa4, content=null, timestamp=1641906717529, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=55032, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=9462ddf72b74, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.30.0.1, kc-session-state=115df91e-55fd-4d89-b568-03753c55dee3, http-req-server-port=80, http-header-accept=*/*, kc-id=faa49035-39a2-47eb-9400-cb93a9fe6d10, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641906717525, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd2DNXNxAH4AEQAAAABh3YIJdAAkZmFhNDkwMzUtMzlhMi00N2ViLTk0MDAtY2I5M2E5ZmU2ZDEwdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAXh4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQxMTVkZjkxZS01NWZkLTRkODktYjU2OC0wMzc1M2M1NWRlZTNwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAATaHR0cDovLzE5Mi4xNjguMS44M3hwcHNyAC9vcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2VuJEFjY2VzcwewcQ/lekULAgACTAAFcm9sZXNxAH4AAUwADHZlcmlmeUNhbGxlcnEAfgAKeHBzcQB+ACt3DAAAABA/QAAAAAAABHQADm9mZmxpbmVfYWNjZXNzdAAGbWVtYmVydAAFYWRtaW50ABF1bWFfYXV0aG9yaXphdGlvbnhwc3IAF2phdmEudXRpbC5MaW5rZWRIYXNoTWFwNMBOXBBswPsCAAFaAAthY2Nlc3NPcmRlcnhxAH4AGD9AAAAAAAAMdwgAAAAQAAAAAXQAB2FjY291bnRzcQB+AC5zcQB+ACt3DAAAABA/QAAAAAAAA3QADm1hbmFnZS1hY2NvdW50dAAUbWFuYWdlLWFjY291bnQtbGlua3N0AAx2aWV3LXByb2ZpbGV4cHgAdAANcHJvZmlsZSBlbWFpbHA=, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJFeUZNQnpQUXV6VFFHUzhnWjYwVjJ1LXZxUE4zYm55MFVJSm1HaUpwS2pFIn0.eyJleHAiOjE2NDE5MDY5OTcsImlhdCI6MTY0MTkwNjY5NywianRpIjoiZmFhNDkwMzUtMzlhMi00N2ViLTk0MDAtY2I5M2E5ZmU2ZDEwIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiMTE1ZGY5MWUtNTVmZC00ZDg5LWI1NjgtMDM3NTNjNTVkZWUzIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoieCJ9.RP4jVdLa2GKR1jEUG_Ofs1jSfGSuf9hAaf2-j4R2AHCcLlwOZHQfjtGK56y9rw6Mc7yt4IuTEGT3_0YWpF73nJ5N36X7TcZC0389FvX0FvP5331H4S5EVmOJ7FyGpOHtmkLRXz4dfExVXoNmkyd6BrqB07pTnpObzqEyYxOX88fWlUjDk6RWTDWCykBixaI76kAACr7cHj6JEN_a2AkEpMI4HkZGWG0JnCqZkydE2kfceTUd-pP22WGrHs60GjudxqXJPsI90ESRgnEUGmuXiI5VgPtS_v89gz7KsuRr6RElEpCzvTqNDGXjy8OX7Zi59gzgqCzdmHhL_CD_-QqTiA, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641906997, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=172.30.0.12, kc-type=Bearer, kc-cc--team-ID=x, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.30.0.1, http-session-id=E4AAF3DF778FF1ED9A2CC78D68351146, http-session-last-accessed-time=1641906717525, kc-category-name=ACCESS, kc-iat=1641906697, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.30.0.1:55032 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 13:11:57.548  INFO 17 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 13:11:57.575  INFO 17 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@13ae697c
2022-01-11 13:11:57.587  INFO 17 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@13ae697c
2022-01-11 13:11:57.676  INFO 17 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@13ae697c
2022-01-11 13:11:57.679  INFO 17 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@13ae697c
2022-01-11 13:11:57.773  INFO 17 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@13ae697c
2022-01-11 13:11:57.777  WARN 17 --- [https-jsse-nio-7071-exec-8] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: x
2022-01-11 13:11:57.783  WARN 17 --- [https-jsse-nio-7071-exec-8] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: x
2022-01-11 13:11:57.793  INFO 17 --- [https-jsse-nio-7071-exec-8] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-5898404206575-907880, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-11 13:11:57.797  INFO 17 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=22d03b7e-30ec-4179-93ce-318d69435fa4, content=DENY, timestamp=1641906717797, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-11 13:11:57.804  INFO 17 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=243ms, Total=266ms
2022-01-11 13:11:57.863  INFO 17 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=79f09a15-2887-4828-96d5-e6c67edd623e, content=null, timestamp=1641906717856, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=55034, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=9462ddf72b74, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.30.0.1, kc-session-state=115df91e-55fd-4d89-b568-03753c55dee3, http-req-server-port=80, http-header-accept=*/*, kc-id=faa49035-39a2-47eb-9400-cb93a9fe6d10, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641906717855, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd2DNXNxAH4AEQAAAABh3YIJdAAkZmFhNDkwMzUtMzlhMi00N2ViLTk0MDAtY2I5M2E5ZmU2ZDEwdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAXh4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQxMTVkZjkxZS01NWZkLTRkODktYjU2OC0wMzc1M2M1NWRlZTNwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAATaHR0cDovLzE5Mi4xNjguMS44M3hwcHNyAC9vcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2VuJEFjY2VzcwewcQ/lekULAgACTAAFcm9sZXNxAH4AAUwADHZlcmlmeUNhbGxlcnEAfgAKeHBzcQB+ACt3DAAAABA/QAAAAAAABHQADm9mZmxpbmVfYWNjZXNzdAAGbWVtYmVydAAFYWRtaW50ABF1bWFfYXV0aG9yaXphdGlvbnhwc3IAF2phdmEudXRpbC5MaW5rZWRIYXNoTWFwNMBOXBBswPsCAAFaAAthY2Nlc3NPcmRlcnhxAH4AGD9AAAAAAAAMdwgAAAAQAAAAAXQAB2FjY291bnRzcQB+AC5zcQB+ACt3DAAAABA/QAAAAAAAA3QADm1hbmFnZS1hY2NvdW50dAAUbWFuYWdlLWFjY291bnQtbGlua3N0AAx2aWV3LXByb2ZpbGV4cHgAdAANcHJvZmlsZSBlbWFpbHA=, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJFeUZNQnpQUXV6VFFHUzhnWjYwVjJ1LXZxUE4zYm55MFVJSm1HaUpwS2pFIn0.eyJleHAiOjE2NDE5MDY5OTcsImlhdCI6MTY0MTkwNjY5NywianRpIjoiZmFhNDkwMzUtMzlhMi00N2ViLTk0MDAtY2I5M2E5ZmU2ZDEwIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiMTE1ZGY5MWUtNTVmZC00ZDg5LWI1NjgtMDM3NTNjNTVkZWUzIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoieCJ9.RP4jVdLa2GKR1jEUG_Ofs1jSfGSuf9hAaf2-j4R2AHCcLlwOZHQfjtGK56y9rw6Mc7yt4IuTEGT3_0YWpF73nJ5N36X7TcZC0389FvX0FvP5331H4S5EVmOJ7FyGpOHtmkLRXz4dfExVXoNmkyd6BrqB07pTnpObzqEyYxOX88fWlUjDk6RWTDWCykBixaI76kAACr7cHj6JEN_a2AkEpMI4HkZGWG0JnCqZkydE2kfceTUd-pP22WGrHs60GjudxqXJPsI90ESRgnEUGmuXiI5VgPtS_v89gz7KsuRr6RElEpCzvTqNDGXjy8OX7Zi59gzgqCzdmHhL_CD_-QqTiA, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641906997, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=172.30.0.12, kc-type=Bearer, kc-cc--team-ID=x, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.30.0.1, http-session-id=597B17CA8F98204904B49C06ED85A530, http-session-last-accessed-time=1641906717855, kc-category-name=ACCESS, kc-iat=1641906697, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.30.0.1:55034 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 13:11:57.870  INFO 17 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 13:11:57.887  INFO 17 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6da92164
2022-01-11 13:11:57.891  INFO 17 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6da92164
2022-01-11 13:11:57.935  INFO 17 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6da92164
2022-01-11 13:11:57.940  INFO 17 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6da92164
2022-01-11 13:11:57.981  INFO 17 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6da92164
2022-01-11 13:11:57.984  WARN 17 --- [https-jsse-nio-7071-exec-9] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: x
2022-01-11 13:11:57.988  WARN 17 --- [https-jsse-nio-7071-exec-9] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: x
2022-01-11 13:11:57.995  INFO 17 --- [https-jsse-nio-7071-exec-9] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-5898723423975-459485, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-11 13:11:58.003  INFO 17 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=79f09a15-2887-4828-96d5-e6c67edd623e, content=DENY, timestamp=1641906718003, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-11 13:11:58.013  INFO 17 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=130ms, Total=152ms
2022-01-11 13:11:58.098  INFO 17 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=34d5324b-12ab-4ecb-879b-ac2dea3f4362, content=null, timestamp=1641906718068, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=55036, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=9462ddf72b74, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.30.0.1, kc-session-state=115df91e-55fd-4d89-b568-03753c55dee3, http-req-server-port=80, http-header-accept=*/*, kc-id=faa49035-39a2-47eb-9400-cb93a9fe6d10, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641906718053, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd2DNXNxAH4AEQAAAABh3YIJdAAkZmFhNDkwMzUtMzlhMi00N2ViLTk0MDAtY2I5M2E5ZmU2ZDEwdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAXh4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQxMTVkZjkxZS01NWZkLTRkODktYjU2OC0wMzc1M2M1NWRlZTNwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAATaHR0cDovLzE5Mi4xNjguMS44M3hwcHNyAC9vcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2VuJEFjY2VzcwewcQ/lekULAgACTAAFcm9sZXNxAH4AAUwADHZlcmlmeUNhbGxlcnEAfgAKeHBzcQB+ACt3DAAAABA/QAAAAAAABHQADm9mZmxpbmVfYWNjZXNzdAAGbWVtYmVydAAFYWRtaW50ABF1bWFfYXV0aG9yaXphdGlvbnhwc3IAF2phdmEudXRpbC5MaW5rZWRIYXNoTWFwNMBOXBBswPsCAAFaAAthY2Nlc3NPcmRlcnhxAH4AGD9AAAAAAAAMdwgAAAAQAAAAAXQAB2FjY291bnRzcQB+AC5zcQB+ACt3DAAAABA/QAAAAAAAA3QADm1hbmFnZS1hY2NvdW50dAAUbWFuYWdlLWFjY291bnQtbGlua3N0AAx2aWV3LXByb2ZpbGV4cHgAdAANcHJvZmlsZSBlbWFpbHA=, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJFeUZNQnpQUXV6VFFHUzhnWjYwVjJ1LXZxUE4zYm55MFVJSm1HaUpwS2pFIn0.eyJleHAiOjE2NDE5MDY5OTcsImlhdCI6MTY0MTkwNjY5NywianRpIjoiZmFhNDkwMzUtMzlhMi00N2ViLTk0MDAtY2I5M2E5ZmU2ZDEwIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiMTE1ZGY5MWUtNTVmZC00ZDg5LWI1NjgtMDM3NTNjNTVkZWUzIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoieCJ9.RP4jVdLa2GKR1jEUG_Ofs1jSfGSuf9hAaf2-j4R2AHCcLlwOZHQfjtGK56y9rw6Mc7yt4IuTEGT3_0YWpF73nJ5N36X7TcZC0389FvX0FvP5331H4S5EVmOJ7FyGpOHtmkLRXz4dfExVXoNmkyd6BrqB07pTnpObzqEyYxOX88fWlUjDk6RWTDWCykBixaI76kAACr7cHj6JEN_a2AkEpMI4HkZGWG0JnCqZkydE2kfceTUd-pP22WGrHs60GjudxqXJPsI90ESRgnEUGmuXiI5VgPtS_v89gz7KsuRr6RElEpCzvTqNDGXjy8OX7Zi59gzgqCzdmHhL_CD_-QqTiA, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641906997, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=172.30.0.12, kc-type=Bearer, kc-cc--team-ID=x, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.30.0.1, http-session-id=5BF4F4A2B4321CC56EFE67C343EF9C93, http-session-last-accessed-time=1641906718053, kc-category-name=ACCESS, kc-iat=1641906697, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.30.0.1:55036 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 13:11:58.110  INFO 17 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 13:11:58.131  INFO 17 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5cb6a3bb
2022-01-11 13:11:58.145  INFO 17 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5cb6a3bb
2022-01-11 13:11:58.192  INFO 17 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5cb6a3bb
2022-01-11 13:11:58.199  INFO 17 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5cb6a3bb
2022-01-11 13:11:58.243  INFO 17 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5cb6a3bb
2022-01-11 13:11:58.253  WARN 17 --- [https-jsse-nio-7071-exec-10] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: x
2022-01-11 13:11:58.258  WARN 17 --- [https-jsse-nio-7071-exec-10] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: x
2022-01-11 13:11:58.273  INFO 17 --- [https-jsse-nio-7071-exec-10] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-5898969315575-783281, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-11 13:11:58.279  INFO 17 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=34d5324b-12ab-4ecb-879b-ac2dea3f4362, content=DENY, timestamp=1641906718279, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-11 13:11:58.282  INFO 17 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=160ms, Total=195ms
2022-01-11 13:11:58.347  INFO 17 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=d8b5d4fe-8e5a-46e4-930a-d7794635f53f, content=null, timestamp=1641906718332, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=55038, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=9462ddf72b74, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.30.0.1, kc-session-state=115df91e-55fd-4d89-b568-03753c55dee3, http-req-server-port=80, http-header-accept=*/*, kc-id=faa49035-39a2-47eb-9400-cb93a9fe6d10, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641906718322, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd2DNXNxAH4AEQAAAABh3YIJdAAkZmFhNDkwMzUtMzlhMi00N2ViLTk0MDAtY2I5M2E5ZmU2ZDEwdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAXh4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQxMTVkZjkxZS01NWZkLTRkODktYjU2OC0wMzc1M2M1NWRlZTNwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAATaHR0cDovLzE5Mi4xNjguMS44M3hwcHNyAC9vcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2VuJEFjY2VzcwewcQ/lekULAgACTAAFcm9sZXNxAH4AAUwADHZlcmlmeUNhbGxlcnEAfgAKeHBzcQB+ACt3DAAAABA/QAAAAAAABHQADm9mZmxpbmVfYWNjZXNzdAAGbWVtYmVydAAFYWRtaW50ABF1bWFfYXV0aG9yaXphdGlvbnhwc3IAF2phdmEudXRpbC5MaW5rZWRIYXNoTWFwNMBOXBBswPsCAAFaAAthY2Nlc3NPcmRlcnhxAH4AGD9AAAAAAAAMdwgAAAAQAAAAAXQAB2FjY291bnRzcQB+AC5zcQB+ACt3DAAAABA/QAAAAAAAA3QADm1hbmFnZS1hY2NvdW50dAAUbWFuYWdlLWFjY291bnQtbGlua3N0AAx2aWV3LXByb2ZpbGV4cHgAdAANcHJvZmlsZSBlbWFpbHA=, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJFeUZNQnpQUXV6VFFHUzhnWjYwVjJ1LXZxUE4zYm55MFVJSm1HaUpwS2pFIn0.eyJleHAiOjE2NDE5MDY5OTcsImlhdCI6MTY0MTkwNjY5NywianRpIjoiZmFhNDkwMzUtMzlhMi00N2ViLTk0MDAtY2I5M2E5ZmU2ZDEwIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiMTE1ZGY5MWUtNTVmZC00ZDg5LWI1NjgtMDM3NTNjNTVkZWUzIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoieCJ9.RP4jVdLa2GKR1jEUG_Ofs1jSfGSuf9hAaf2-j4R2AHCcLlwOZHQfjtGK56y9rw6Mc7yt4IuTEGT3_0YWpF73nJ5N36X7TcZC0389FvX0FvP5331H4S5EVmOJ7FyGpOHtmkLRXz4dfExVXoNmkyd6BrqB07pTnpObzqEyYxOX88fWlUjDk6RWTDWCykBixaI76kAACr7cHj6JEN_a2AkEpMI4HkZGWG0JnCqZkydE2kfceTUd-pP22WGrHs60GjudxqXJPsI90ESRgnEUGmuXiI5VgPtS_v89gz7KsuRr6RElEpCzvTqNDGXjy8OX7Zi59gzgqCzdmHhL_CD_-QqTiA, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641906997, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=172.30.0.12, kc-type=Bearer, kc-cc--team-ID=x, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.30.0.1, http-session-id=938E3EC8447F79D5319F2F51966C5224, http-session-last-accessed-time=1641906718322, kc-category-name=ACCESS, kc-iat=1641906697, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.30.0.1:55038 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 13:11:58.359  INFO 17 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 13:11:58.381  INFO 17 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5080d37
2022-01-11 13:11:58.386  INFO 17 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5080d37
2022-01-11 13:11:58.423  INFO 17 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5080d37
2022-01-11 13:11:58.428  INFO 17 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5080d37
2022-01-11 13:11:58.513  INFO 17 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5080d37
2022-01-11 13:11:58.516  WARN 17 --- [https-jsse-nio-7071-exec-1] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: x
2022-01-11 13:11:58.518  WARN 17 --- [https-jsse-nio-7071-exec-1] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: x
2022-01-11 13:11:58.521  INFO 17 --- [https-jsse-nio-7071-exec-1] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-5899214807275-491370, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-11 13:11:58.530  INFO 17 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=d8b5d4fe-8e5a-46e4-930a-d7794635f53f, content=DENY, timestamp=1641906718530, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-11 13:11:58.535  INFO 17 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=165ms, Total=191ms
2022-01-11 13:11:58.607  INFO 17 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=59266842-e6f1-4818-903e-c9a8cc876e16, content=null, timestamp=1641906718597, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=55040, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=9462ddf72b74, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.30.0.1, kc-session-state=115df91e-55fd-4d89-b568-03753c55dee3, http-req-server-port=80, http-header-accept=*/*, kc-id=faa49035-39a2-47eb-9400-cb93a9fe6d10, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641906718578, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd2DNXNxAH4AEQAAAABh3YIJdAAkZmFhNDkwMzUtMzlhMi00N2ViLTk0MDAtY2I5M2E5ZmU2ZDEwdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAXh4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQxMTVkZjkxZS01NWZkLTRkODktYjU2OC0wMzc1M2M1NWRlZTNwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAATaHR0cDovLzE5Mi4xNjguMS44M3hwcHNyAC9vcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2VuJEFjY2VzcwewcQ/lekULAgACTAAFcm9sZXNxAH4AAUwADHZlcmlmeUNhbGxlcnEAfgAKeHBzcQB+ACt3DAAAABA/QAAAAAAABHQADm9mZmxpbmVfYWNjZXNzdAAGbWVtYmVydAAFYWRtaW50ABF1bWFfYXV0aG9yaXphdGlvbnhwc3IAF2phdmEudXRpbC5MaW5rZWRIYXNoTWFwNMBOXBBswPsCAAFaAAthY2Nlc3NPcmRlcnhxAH4AGD9AAAAAAAAMdwgAAAAQAAAAAXQAB2FjY291bnRzcQB+AC5zcQB+ACt3DAAAABA/QAAAAAAAA3QADm1hbmFnZS1hY2NvdW50dAAUbWFuYWdlLWFjY291bnQtbGlua3N0AAx2aWV3LXByb2ZpbGV4cHgAdAANcHJvZmlsZSBlbWFpbHA=, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJFeUZNQnpQUXV6VFFHUzhnWjYwVjJ1LXZxUE4zYm55MFVJSm1HaUpwS2pFIn0.eyJleHAiOjE2NDE5MDY5OTcsImlhdCI6MTY0MTkwNjY5NywianRpIjoiZmFhNDkwMzUtMzlhMi00N2ViLTk0MDAtY2I5M2E5ZmU2ZDEwIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiMTE1ZGY5MWUtNTVmZC00ZDg5LWI1NjgtMDM3NTNjNTVkZWUzIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoieCJ9.RP4jVdLa2GKR1jEUG_Ofs1jSfGSuf9hAaf2-j4R2AHCcLlwOZHQfjtGK56y9rw6Mc7yt4IuTEGT3_0YWpF73nJ5N36X7TcZC0389FvX0FvP5331H4S5EVmOJ7FyGpOHtmkLRXz4dfExVXoNmkyd6BrqB07pTnpObzqEyYxOX88fWlUjDk6RWTDWCykBixaI76kAACr7cHj6JEN_a2AkEpMI4HkZGWG0JnCqZkydE2kfceTUd-pP22WGrHs60GjudxqXJPsI90ESRgnEUGmuXiI5VgPtS_v89gz7KsuRr6RElEpCzvTqNDGXjy8OX7Zi59gzgqCzdmHhL_CD_-QqTiA, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641906997, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=172.30.0.12, kc-type=Bearer, kc-cc--team-ID=x, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.30.0.1, http-session-id=9157FB14C1789C246F42033A9CFCBC77, http-session-last-accessed-time=1641906718578, kc-category-name=ACCESS, kc-iat=1641906697, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.30.0.1:55040 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 13:11:58.612  INFO 17 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 13:11:58.627  INFO 17 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@45dd2f60
2022-01-11 13:11:58.631  INFO 17 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@45dd2f60
2022-01-11 13:11:58.678  INFO 17 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@45dd2f60
2022-01-11 13:11:58.681  INFO 17 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@45dd2f60
2022-01-11 13:11:58.718  INFO 17 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@45dd2f60
2022-01-11 13:11:58.732  WARN 17 --- [https-jsse-nio-7071-exec-2] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: x
2022-01-11 13:11:58.741  WARN 17 --- [https-jsse-nio-7071-exec-2] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: x
2022-01-11 13:11:58.749  INFO 17 --- [https-jsse-nio-7071-exec-2] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-5899471354375-572159, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-11 13:11:58.755  INFO 17 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=59266842-e6f1-4818-903e-c9a8cc876e16, content=DENY, timestamp=1641906718755, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-11 13:11:58.765  INFO 17 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=133ms, Total=160ms
2022-01-11 13:11:58.852  INFO 17 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=e7ec09d7-391d-4f6f-8106-f3b0ec167e10, content=null, timestamp=1641906718833, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=55042, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=9462ddf72b74, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.30.0.1, kc-session-state=115df91e-55fd-4d89-b568-03753c55dee3, http-req-server-port=80, http-header-accept=*/*, kc-id=faa49035-39a2-47eb-9400-cb93a9fe6d10, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641906718824, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd2DNXNxAH4AEQAAAABh3YIJdAAkZmFhNDkwMzUtMzlhMi00N2ViLTk0MDAtY2I5M2E5ZmU2ZDEwdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAXh4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQxMTVkZjkxZS01NWZkLTRkODktYjU2OC0wMzc1M2M1NWRlZTNwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAATaHR0cDovLzE5Mi4xNjguMS44M3hwcHNyAC9vcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2VuJEFjY2VzcwewcQ/lekULAgACTAAFcm9sZXNxAH4AAUwADHZlcmlmeUNhbGxlcnEAfgAKeHBzcQB+ACt3DAAAABA/QAAAAAAABHQADm9mZmxpbmVfYWNjZXNzdAAGbWVtYmVydAAFYWRtaW50ABF1bWFfYXV0aG9yaXphdGlvbnhwc3IAF2phdmEudXRpbC5MaW5rZWRIYXNoTWFwNMBOXBBswPsCAAFaAAthY2Nlc3NPcmRlcnhxAH4AGD9AAAAAAAAMdwgAAAAQAAAAAXQAB2FjY291bnRzcQB+AC5zcQB+ACt3DAAAABA/QAAAAAAAA3QADm1hbmFnZS1hY2NvdW50dAAUbWFuYWdlLWFjY291bnQtbGlua3N0AAx2aWV3LXByb2ZpbGV4cHgAdAANcHJvZmlsZSBlbWFpbHA=, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJFeUZNQnpQUXV6VFFHUzhnWjYwVjJ1LXZxUE4zYm55MFVJSm1HaUpwS2pFIn0.eyJleHAiOjE2NDE5MDY5OTcsImlhdCI6MTY0MTkwNjY5NywianRpIjoiZmFhNDkwMzUtMzlhMi00N2ViLTk0MDAtY2I5M2E5ZmU2ZDEwIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiMTE1ZGY5MWUtNTVmZC00ZDg5LWI1NjgtMDM3NTNjNTVkZWUzIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoieCJ9.RP4jVdLa2GKR1jEUG_Ofs1jSfGSuf9hAaf2-j4R2AHCcLlwOZHQfjtGK56y9rw6Mc7yt4IuTEGT3_0YWpF73nJ5N36X7TcZC0389FvX0FvP5331H4S5EVmOJ7FyGpOHtmkLRXz4dfExVXoNmkyd6BrqB07pTnpObzqEyYxOX88fWlUjDk6RWTDWCykBixaI76kAACr7cHj6JEN_a2AkEpMI4HkZGWG0JnCqZkydE2kfceTUd-pP22WGrHs60GjudxqXJPsI90ESRgnEUGmuXiI5VgPtS_v89gz7KsuRr6RElEpCzvTqNDGXjy8OX7Zi59gzgqCzdmHhL_CD_-QqTiA, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641906997, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=172.30.0.12, kc-type=Bearer, kc-cc--team-ID=x, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.30.0.1, http-session-id=F371B03E4B17D3F7F3C6C65BB0ABC0AE, http-session-last-accessed-time=1641906718824, kc-category-name=ACCESS, kc-iat=1641906697, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.30.0.1:55042 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 13:11:58.862  INFO 17 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 13:11:58.884  INFO 17 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@48f9a5aa
2022-01-11 13:11:58.887  INFO 17 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@48f9a5aa
2022-01-11 13:11:58.939  INFO 17 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@48f9a5aa
2022-01-11 13:11:58.945  INFO 17 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@48f9a5aa
2022-01-11 13:11:59.012  INFO 17 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@48f9a5aa
2022-01-11 13:11:59.016  WARN 17 --- [https-jsse-nio-7071-exec-3] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: x
2022-01-11 13:11:59.019  WARN 17 --- [https-jsse-nio-7071-exec-3] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: x
2022-01-11 13:11:59.027  INFO 17 --- [https-jsse-nio-7071-exec-3] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-5899715830775-90168, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-11 13:11:59.031  INFO 17 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=e7ec09d7-391d-4f6f-8106-f3b0ec167e10, content=DENY, timestamp=1641906719031, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-11 13:11:59.038  INFO 17 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=165ms, Total=193ms
2022-01-11 13:11:59.087  INFO 17 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=e2d4c159-864b-4c13-b2f3-1b481af962a6, content=null, timestamp=1641906719075, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=55044, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=9462ddf72b74, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.30.0.1, kc-session-state=115df91e-55fd-4d89-b568-03753c55dee3, http-req-server-port=80, http-header-accept=*/*, kc-id=faa49035-39a2-47eb-9400-cb93a9fe6d10, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641906719073, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd2DNXNxAH4AEQAAAABh3YIJdAAkZmFhNDkwMzUtMzlhMi00N2ViLTk0MDAtY2I5M2E5ZmU2ZDEwdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAXh4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQxMTVkZjkxZS01NWZkLTRkODktYjU2OC0wMzc1M2M1NWRlZTNwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAATaHR0cDovLzE5Mi4xNjguMS44M3hwcHNyAC9vcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2VuJEFjY2VzcwewcQ/lekULAgACTAAFcm9sZXNxAH4AAUwADHZlcmlmeUNhbGxlcnEAfgAKeHBzcQB+ACt3DAAAABA/QAAAAAAABHQADm9mZmxpbmVfYWNjZXNzdAAGbWVtYmVydAAFYWRtaW50ABF1bWFfYXV0aG9yaXphdGlvbnhwc3IAF2phdmEudXRpbC5MaW5rZWRIYXNoTWFwNMBOXBBswPsCAAFaAAthY2Nlc3NPcmRlcnhxAH4AGD9AAAAAAAAMdwgAAAAQAAAAAXQAB2FjY291bnRzcQB+AC5zcQB+ACt3DAAAABA/QAAAAAAAA3QADm1hbmFnZS1hY2NvdW50dAAUbWFuYWdlLWFjY291bnQtbGlua3N0AAx2aWV3LXByb2ZpbGV4cHgAdAANcHJvZmlsZSBlbWFpbHA=, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJFeUZNQnpQUXV6VFFHUzhnWjYwVjJ1LXZxUE4zYm55MFVJSm1HaUpwS2pFIn0.eyJleHAiOjE2NDE5MDY5OTcsImlhdCI6MTY0MTkwNjY5NywianRpIjoiZmFhNDkwMzUtMzlhMi00N2ViLTk0MDAtY2I5M2E5ZmU2ZDEwIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiMTE1ZGY5MWUtNTVmZC00ZDg5LWI1NjgtMDM3NTNjNTVkZWUzIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoieCJ9.RP4jVdLa2GKR1jEUG_Ofs1jSfGSuf9hAaf2-j4R2AHCcLlwOZHQfjtGK56y9rw6Mc7yt4IuTEGT3_0YWpF73nJ5N36X7TcZC0389FvX0FvP5331H4S5EVmOJ7FyGpOHtmkLRXz4dfExVXoNmkyd6BrqB07pTnpObzqEyYxOX88fWlUjDk6RWTDWCykBixaI76kAACr7cHj6JEN_a2AkEpMI4HkZGWG0JnCqZkydE2kfceTUd-pP22WGrHs60GjudxqXJPsI90ESRgnEUGmuXiI5VgPtS_v89gz7KsuRr6RElEpCzvTqNDGXjy8OX7Zi59gzgqCzdmHhL_CD_-QqTiA, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641906997, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=172.30.0.12, kc-type=Bearer, kc-cc--team-ID=x, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.30.0.1, http-session-id=2AC2DEBC8273D4D3E863B2A8BDCF08DE, http-session-last-accessed-time=1641906719073, kc-category-name=ACCESS, kc-iat=1641906697, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.30.0.1:55044 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 13:11:59.107  INFO 17 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 13:11:59.119  INFO 17 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@599501c7
2022-01-11 13:11:59.123  INFO 17 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@599501c7
2022-01-11 13:11:59.154  INFO 17 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@599501c7
2022-01-11 13:11:59.158  INFO 17 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@599501c7
2022-01-11 13:11:59.226  INFO 17 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@599501c7
2022-01-11 13:11:59.231  WARN 17 --- [https-jsse-nio-7071-exec-4] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: x
2022-01-11 13:11:59.235  WARN 17 --- [https-jsse-nio-7071-exec-4] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: x
2022-01-11 13:11:59.241  INFO 17 --- [https-jsse-nio-7071-exec-4] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-5899960300675-16431, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-11 13:11:59.246  INFO 17 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=e2d4c159-864b-4c13-b2f3-1b481af962a6, content=DENY, timestamp=1641906719246, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-11 13:11:59.251  INFO 17 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=136ms, Total=166ms
2022-01-11 13:11:59.318  INFO 17 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=5bdb64d7-b34f-44a2-96e4-c3520f3888fa, content=null, timestamp=1641906719303, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=55046, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=9462ddf72b74, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.30.0.1, kc-session-state=115df91e-55fd-4d89-b568-03753c55dee3, http-req-server-port=80, http-header-accept=*/*, kc-id=faa49035-39a2-47eb-9400-cb93a9fe6d10, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641906719300, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd2DNXNxAH4AEQAAAABh3YIJdAAkZmFhNDkwMzUtMzlhMi00N2ViLTk0MDAtY2I5M2E5ZmU2ZDEwdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAXh4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQxMTVkZjkxZS01NWZkLTRkODktYjU2OC0wMzc1M2M1NWRlZTNwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAATaHR0cDovLzE5Mi4xNjguMS44M3hwcHNyAC9vcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2VuJEFjY2VzcwewcQ/lekULAgACTAAFcm9sZXNxAH4AAUwADHZlcmlmeUNhbGxlcnEAfgAKeHBzcQB+ACt3DAAAABA/QAAAAAAABHQADm9mZmxpbmVfYWNjZXNzdAAGbWVtYmVydAAFYWRtaW50ABF1bWFfYXV0aG9yaXphdGlvbnhwc3IAF2phdmEudXRpbC5MaW5rZWRIYXNoTWFwNMBOXBBswPsCAAFaAAthY2Nlc3NPcmRlcnhxAH4AGD9AAAAAAAAMdwgAAAAQAAAAAXQAB2FjY291bnRzcQB+AC5zcQB+ACt3DAAAABA/QAAAAAAAA3QADm1hbmFnZS1hY2NvdW50dAAUbWFuYWdlLWFjY291bnQtbGlua3N0AAx2aWV3LXByb2ZpbGV4cHgAdAANcHJvZmlsZSBlbWFpbHA=, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJFeUZNQnpQUXV6VFFHUzhnWjYwVjJ1LXZxUE4zYm55MFVJSm1HaUpwS2pFIn0.eyJleHAiOjE2NDE5MDY5OTcsImlhdCI6MTY0MTkwNjY5NywianRpIjoiZmFhNDkwMzUtMzlhMi00N2ViLTk0MDAtY2I5M2E5ZmU2ZDEwIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiMTE1ZGY5MWUtNTVmZC00ZDg5LWI1NjgtMDM3NTNjNTVkZWUzIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoieCJ9.RP4jVdLa2GKR1jEUG_Ofs1jSfGSuf9hAaf2-j4R2AHCcLlwOZHQfjtGK56y9rw6Mc7yt4IuTEGT3_0YWpF73nJ5N36X7TcZC0389FvX0FvP5331H4S5EVmOJ7FyGpOHtmkLRXz4dfExVXoNmkyd6BrqB07pTnpObzqEyYxOX88fWlUjDk6RWTDWCykBixaI76kAACr7cHj6JEN_a2AkEpMI4HkZGWG0JnCqZkydE2kfceTUd-pP22WGrHs60GjudxqXJPsI90ESRgnEUGmuXiI5VgPtS_v89gz7KsuRr6RElEpCzvTqNDGXjy8OX7Zi59gzgqCzdmHhL_CD_-QqTiA, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641906997, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=172.30.0.12, kc-type=Bearer, kc-cc--team-ID=x, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.30.0.1, http-session-id=B1832AA61BADCEB55D8A9845E5553A98, http-session-last-accessed-time=1641906719300, kc-category-name=ACCESS, kc-iat=1641906697, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.30.0.1:55046 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 13:11:59.332  INFO 17 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 13:11:59.338  INFO 17 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@10725d14
2022-01-11 13:11:59.342  INFO 17 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@10725d14
2022-01-11 13:11:59.395  INFO 17 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@10725d14
2022-01-11 13:11:59.404  INFO 17 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@10725d14
2022-01-11 13:11:59.438  INFO 17 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@10725d14
2022-01-11 13:11:59.441  WARN 17 --- [https-jsse-nio-7071-exec-5] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: x
2022-01-11 13:11:59.444  WARN 17 --- [https-jsse-nio-7071-exec-5] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: x
2022-01-11 13:11:59.448  INFO 17 --- [https-jsse-nio-7071-exec-5] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-5900185410575-480342, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-11 13:11:59.453  INFO 17 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=5bdb64d7-b34f-44a2-96e4-c3520f3888fa, content=DENY, timestamp=1641906719453, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-11 13:11:59.458  INFO 17 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=117ms, Total=146ms
2022-01-11 13:11:59.564  INFO 17 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=adbe8d1d-a3c8-43e7-8ad6-d6aacc9d5abb, content=null, timestamp=1641906719540, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=55048, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=9462ddf72b74, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.30.0.1, kc-session-state=115df91e-55fd-4d89-b568-03753c55dee3, http-req-server-port=80, http-header-accept=*/*, kc-id=faa49035-39a2-47eb-9400-cb93a9fe6d10, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641906719528, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd2DNXNxAH4AEQAAAABh3YIJdAAkZmFhNDkwMzUtMzlhMi00N2ViLTk0MDAtY2I5M2E5ZmU2ZDEwdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAXh4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQxMTVkZjkxZS01NWZkLTRkODktYjU2OC0wMzc1M2M1NWRlZTNwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAATaHR0cDovLzE5Mi4xNjguMS44M3hwcHNyAC9vcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2VuJEFjY2VzcwewcQ/lekULAgACTAAFcm9sZXNxAH4AAUwADHZlcmlmeUNhbGxlcnEAfgAKeHBzcQB+ACt3DAAAABA/QAAAAAAABHQADm9mZmxpbmVfYWNjZXNzdAAGbWVtYmVydAAFYWRtaW50ABF1bWFfYXV0aG9yaXphdGlvbnhwc3IAF2phdmEudXRpbC5MaW5rZWRIYXNoTWFwNMBOXBBswPsCAAFaAAthY2Nlc3NPcmRlcnhxAH4AGD9AAAAAAAAMdwgAAAAQAAAAAXQAB2FjY291bnRzcQB+AC5zcQB+ACt3DAAAABA/QAAAAAAAA3QADm1hbmFnZS1hY2NvdW50dAAUbWFuYWdlLWFjY291bnQtbGlua3N0AAx2aWV3LXByb2ZpbGV4cHgAdAANcHJvZmlsZSBlbWFpbHA=, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJFeUZNQnpQUXV6VFFHUzhnWjYwVjJ1LXZxUE4zYm55MFVJSm1HaUpwS2pFIn0.eyJleHAiOjE2NDE5MDY5OTcsImlhdCI6MTY0MTkwNjY5NywianRpIjoiZmFhNDkwMzUtMzlhMi00N2ViLTk0MDAtY2I5M2E5ZmU2ZDEwIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiMTE1ZGY5MWUtNTVmZC00ZDg5LWI1NjgtMDM3NTNjNTVkZWUzIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoieCJ9.RP4jVdLa2GKR1jEUG_Ofs1jSfGSuf9hAaf2-j4R2AHCcLlwOZHQfjtGK56y9rw6Mc7yt4IuTEGT3_0YWpF73nJ5N36X7TcZC0389FvX0FvP5331H4S5EVmOJ7FyGpOHtmkLRXz4dfExVXoNmkyd6BrqB07pTnpObzqEyYxOX88fWlUjDk6RWTDWCykBixaI76kAACr7cHj6JEN_a2AkEpMI4HkZGWG0JnCqZkydE2kfceTUd-pP22WGrHs60GjudxqXJPsI90ESRgnEUGmuXiI5VgPtS_v89gz7KsuRr6RElEpCzvTqNDGXjy8OX7Zi59gzgqCzdmHhL_CD_-QqTiA, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641906997, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=172.30.0.12, kc-type=Bearer, kc-cc--team-ID=x, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.30.0.1, http-session-id=708D9821B9F6AAD827B3FB04292EB115, http-session-last-accessed-time=1641906719528, kc-category-name=ACCESS, kc-iat=1641906697, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.30.0.1:55048 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 13:11:59.570  INFO 17 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 13:11:59.575  INFO 17 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@353f7a3
2022-01-11 13:11:59.578  INFO 17 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@353f7a3
2022-01-11 13:11:59.620  INFO 17 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@353f7a3
2022-01-11 13:11:59.624  INFO 17 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@353f7a3
2022-01-11 13:11:59.681  INFO 17 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@353f7a3
2022-01-11 13:11:59.691  WARN 17 --- [https-jsse-nio-7071-exec-6] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: x
2022-01-11 13:11:59.697  WARN 17 --- [https-jsse-nio-7071-exec-6] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: x
2022-01-11 13:11:59.708  INFO 17 --- [https-jsse-nio-7071-exec-6] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-5900422961175-926676, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-11 13:11:59.712  INFO 17 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=adbe8d1d-a3c8-43e7-8ad6-d6aacc9d5abb, content=DENY, timestamp=1641906719712, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-11 13:11:59.718  INFO 17 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=139ms, Total=157ms
2022-01-11 13:11:59.782  INFO 17 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=8a66b322-3786-477a-9025-e89840dce7b0, content=null, timestamp=1641906719761, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=55050, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=9462ddf72b74, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.30.0.1, kc-session-state=115df91e-55fd-4d89-b568-03753c55dee3, http-req-server-port=80, http-header-accept=*/*, kc-id=faa49035-39a2-47eb-9400-cb93a9fe6d10, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641906719756, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd2DNXNxAH4AEQAAAABh3YIJdAAkZmFhNDkwMzUtMzlhMi00N2ViLTk0MDAtY2I5M2E5ZmU2ZDEwdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAXh4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQxMTVkZjkxZS01NWZkLTRkODktYjU2OC0wMzc1M2M1NWRlZTNwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAATaHR0cDovLzE5Mi4xNjguMS44M3hwcHNyAC9vcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2VuJEFjY2VzcwewcQ/lekULAgACTAAFcm9sZXNxAH4AAUwADHZlcmlmeUNhbGxlcnEAfgAKeHBzcQB+ACt3DAAAABA/QAAAAAAABHQADm9mZmxpbmVfYWNjZXNzdAAGbWVtYmVydAAFYWRtaW50ABF1bWFfYXV0aG9yaXphdGlvbnhwc3IAF2phdmEudXRpbC5MaW5rZWRIYXNoTWFwNMBOXBBswPsCAAFaAAthY2Nlc3NPcmRlcnhxAH4AGD9AAAAAAAAMdwgAAAAQAAAAAXQAB2FjY291bnRzcQB+AC5zcQB+ACt3DAAAABA/QAAAAAAAA3QADm1hbmFnZS1hY2NvdW50dAAUbWFuYWdlLWFjY291bnQtbGlua3N0AAx2aWV3LXByb2ZpbGV4cHgAdAANcHJvZmlsZSBlbWFpbHA=, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJFeUZNQnpQUXV6VFFHUzhnWjYwVjJ1LXZxUE4zYm55MFVJSm1HaUpwS2pFIn0.eyJleHAiOjE2NDE5MDY5OTcsImlhdCI6MTY0MTkwNjY5NywianRpIjoiZmFhNDkwMzUtMzlhMi00N2ViLTk0MDAtY2I5M2E5ZmU2ZDEwIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiMTE1ZGY5MWUtNTVmZC00ZDg5LWI1NjgtMDM3NTNjNTVkZWUzIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoieCJ9.RP4jVdLa2GKR1jEUG_Ofs1jSfGSuf9hAaf2-j4R2AHCcLlwOZHQfjtGK56y9rw6Mc7yt4IuTEGT3_0YWpF73nJ5N36X7TcZC0389FvX0FvP5331H4S5EVmOJ7FyGpOHtmkLRXz4dfExVXoNmkyd6BrqB07pTnpObzqEyYxOX88fWlUjDk6RWTDWCykBixaI76kAACr7cHj6JEN_a2AkEpMI4HkZGWG0JnCqZkydE2kfceTUd-pP22WGrHs60GjudxqXJPsI90ESRgnEUGmuXiI5VgPtS_v89gz7KsuRr6RElEpCzvTqNDGXjy8OX7Zi59gzgqCzdmHhL_CD_-QqTiA, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641906997, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=172.30.0.12, kc-type=Bearer, kc-cc--team-ID=x, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.30.0.1, http-session-id=28F1DC6D281ED1377A4AAE9EB7DB34B7, http-session-last-accessed-time=1641906719756, kc-category-name=ACCESS, kc-iat=1641906697, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.30.0.1:55050 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 13:11:59.792  INFO 17 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 13:11:59.800  INFO 17 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5a99cd0b
2022-01-11 13:11:59.803  INFO 17 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5a99cd0b
2022-01-11 13:11:59.826  INFO 17 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5a99cd0b
2022-01-11 13:11:59.830  INFO 17 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5a99cd0b
2022-01-11 13:11:59.900  INFO 17 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5a99cd0b
2022-01-11 13:11:59.903  WARN 17 --- [https-jsse-nio-7071-exec-7] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: x
2022-01-11 13:11:59.906  WARN 17 --- [https-jsse-nio-7071-exec-7] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: x
2022-01-11 13:11:59.909  INFO 17 --- [https-jsse-nio-7071-exec-7] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-5900645153875-683431, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-11 13:11:59.913  INFO 17 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=8a66b322-3786-477a-9025-e89840dce7b0, content=DENY, timestamp=1641906719913, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-11 13:11:59.916  INFO 17 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=118ms, Total=143ms
2022-01-11 13:11:59.975  INFO 17 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=44c7e9ee-e4e0-4b4c-a305-e5373c7f933a, content=null, timestamp=1641906719957, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=55052, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=9462ddf72b74, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.30.0.1, kc-session-state=115df91e-55fd-4d89-b568-03753c55dee3, http-req-server-port=80, http-header-accept=*/*, kc-id=faa49035-39a2-47eb-9400-cb93a9fe6d10, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641906719954, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd2DNXNxAH4AEQAAAABh3YIJdAAkZmFhNDkwMzUtMzlhMi00N2ViLTk0MDAtY2I5M2E5ZmU2ZDEwdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAXh4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQxMTVkZjkxZS01NWZkLTRkODktYjU2OC0wMzc1M2M1NWRlZTNwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAATaHR0cDovLzE5Mi4xNjguMS44M3hwcHNyAC9vcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2VuJEFjY2VzcwewcQ/lekULAgACTAAFcm9sZXNxAH4AAUwADHZlcmlmeUNhbGxlcnEAfgAKeHBzcQB+ACt3DAAAABA/QAAAAAAABHQADm9mZmxpbmVfYWNjZXNzdAAGbWVtYmVydAAFYWRtaW50ABF1bWFfYXV0aG9yaXphdGlvbnhwc3IAF2phdmEudXRpbC5MaW5rZWRIYXNoTWFwNMBOXBBswPsCAAFaAAthY2Nlc3NPcmRlcnhxAH4AGD9AAAAAAAAMdwgAAAAQAAAAAXQAB2FjY291bnRzcQB+AC5zcQB+ACt3DAAAABA/QAAAAAAAA3QADm1hbmFnZS1hY2NvdW50dAAUbWFuYWdlLWFjY291bnQtbGlua3N0AAx2aWV3LXByb2ZpbGV4cHgAdAANcHJvZmlsZSBlbWFpbHA=, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJFeUZNQnpQUXV6VFFHUzhnWjYwVjJ1LXZxUE4zYm55MFVJSm1HaUpwS2pFIn0.eyJleHAiOjE2NDE5MDY5OTcsImlhdCI6MTY0MTkwNjY5NywianRpIjoiZmFhNDkwMzUtMzlhMi00N2ViLTk0MDAtY2I5M2E5ZmU2ZDEwIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiMTE1ZGY5MWUtNTVmZC00ZDg5LWI1NjgtMDM3NTNjNTVkZWUzIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoieCJ9.RP4jVdLa2GKR1jEUG_Ofs1jSfGSuf9hAaf2-j4R2AHCcLlwOZHQfjtGK56y9rw6Mc7yt4IuTEGT3_0YWpF73nJ5N36X7TcZC0389FvX0FvP5331H4S5EVmOJ7FyGpOHtmkLRXz4dfExVXoNmkyd6BrqB07pTnpObzqEyYxOX88fWlUjDk6RWTDWCykBixaI76kAACr7cHj6JEN_a2AkEpMI4HkZGWG0JnCqZkydE2kfceTUd-pP22WGrHs60GjudxqXJPsI90ESRgnEUGmuXiI5VgPtS_v89gz7KsuRr6RElEpCzvTqNDGXjy8OX7Zi59gzgqCzdmHhL_CD_-QqTiA, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641906997, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=172.30.0.12, kc-type=Bearer, kc-cc--team-ID=x, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.30.0.1, http-session-id=6B4D296B28984DADB68B427938C2C864, http-session-last-accessed-time=1641906719954, kc-category-name=ACCESS, kc-iat=1641906697, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.30.0.1:55052 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 13:11:59.981  INFO 17 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 13:11:59.998  INFO 17 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3419e62a
2022-01-11 13:12:00.004  INFO 17 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3419e62a
2022-01-11 13:12:00.035  INFO 17 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3419e62a
2022-01-11 13:12:00.051  INFO 17 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3419e62a
2022-01-11 13:12:00.097  INFO 17 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3419e62a
2022-01-11 13:12:00.107  WARN 17 --- [https-jsse-nio-7071-exec-8] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: x
2022-01-11 13:12:00.111  WARN 17 --- [https-jsse-nio-7071-exec-8] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: x
2022-01-11 13:12:00.118  INFO 17 --- [https-jsse-nio-7071-exec-8] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-5900835675675-474060, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-11 13:12:00.124  INFO 17 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=44c7e9ee-e4e0-4b4c-a305-e5373c7f933a, content=DENY, timestamp=1641906720123, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-11 13:12:00.131  INFO 17 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=137ms, Total=160ms
2022-01-11 13:12:00.239  INFO 17 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=5df5db7d-9b38-426c-96c7-1bed6d72128f, content=null, timestamp=1641906720221, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=55054, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=9462ddf72b74, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.30.0.1, kc-session-state=115df91e-55fd-4d89-b568-03753c55dee3, http-req-server-port=80, http-header-accept=*/*, kc-id=faa49035-39a2-47eb-9400-cb93a9fe6d10, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641906720210, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd2DNXNxAH4AEQAAAABh3YIJdAAkZmFhNDkwMzUtMzlhMi00N2ViLTk0MDAtY2I5M2E5ZmU2ZDEwdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAXh4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQxMTVkZjkxZS01NWZkLTRkODktYjU2OC0wMzc1M2M1NWRlZTNwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAATaHR0cDovLzE5Mi4xNjguMS44M3hwcHNyAC9vcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2VuJEFjY2VzcwewcQ/lekULAgACTAAFcm9sZXNxAH4AAUwADHZlcmlmeUNhbGxlcnEAfgAKeHBzcQB+ACt3DAAAABA/QAAAAAAABHQADm9mZmxpbmVfYWNjZXNzdAAGbWVtYmVydAAFYWRtaW50ABF1bWFfYXV0aG9yaXphdGlvbnhwc3IAF2phdmEudXRpbC5MaW5rZWRIYXNoTWFwNMBOXBBswPsCAAFaAAthY2Nlc3NPcmRlcnhxAH4AGD9AAAAAAAAMdwgAAAAQAAAAAXQAB2FjY291bnRzcQB+AC5zcQB+ACt3DAAAABA/QAAAAAAAA3QADm1hbmFnZS1hY2NvdW50dAAUbWFuYWdlLWFjY291bnQtbGlua3N0AAx2aWV3LXByb2ZpbGV4cHgAdAANcHJvZmlsZSBlbWFpbHA=, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJFeUZNQnpQUXV6VFFHUzhnWjYwVjJ1LXZxUE4zYm55MFVJSm1HaUpwS2pFIn0.eyJleHAiOjE2NDE5MDY5OTcsImlhdCI6MTY0MTkwNjY5NywianRpIjoiZmFhNDkwMzUtMzlhMi00N2ViLTk0MDAtY2I5M2E5ZmU2ZDEwIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiMTE1ZGY5MWUtNTVmZC00ZDg5LWI1NjgtMDM3NTNjNTVkZWUzIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoieCJ9.RP4jVdLa2GKR1jEUG_Ofs1jSfGSuf9hAaf2-j4R2AHCcLlwOZHQfjtGK56y9rw6Mc7yt4IuTEGT3_0YWpF73nJ5N36X7TcZC0389FvX0FvP5331H4S5EVmOJ7FyGpOHtmkLRXz4dfExVXoNmkyd6BrqB07pTnpObzqEyYxOX88fWlUjDk6RWTDWCykBixaI76kAACr7cHj6JEN_a2AkEpMI4HkZGWG0JnCqZkydE2kfceTUd-pP22WGrHs60GjudxqXJPsI90ESRgnEUGmuXiI5VgPtS_v89gz7KsuRr6RElEpCzvTqNDGXjy8OX7Zi59gzgqCzdmHhL_CD_-QqTiA, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641906997, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=172.30.0.12, kc-type=Bearer, kc-cc--team-ID=x, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.30.0.1, http-session-id=90904D04D65145BE2BBA7940784300DB, http-session-last-accessed-time=1641906720210, kc-category-name=ACCESS, kc-iat=1641906697, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.30.0.1:55054 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 13:12:00.248  INFO 17 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 13:12:00.257  INFO 17 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@49c400b0
2022-01-11 13:12:00.269  INFO 17 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@49c400b0
2022-01-11 13:12:00.360  INFO 17 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@49c400b0
2022-01-11 13:12:00.371  INFO 17 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@49c400b0
2022-01-11 13:12:00.443  INFO 17 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@49c400b0
2022-01-11 13:12:00.447  WARN 17 --- [https-jsse-nio-7071-exec-9] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: x
2022-01-11 13:12:00.450  WARN 17 --- [https-jsse-nio-7071-exec-9] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: x
2022-01-11 13:12:00.457  INFO 17 --- [https-jsse-nio-7071-exec-9] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-5901102294975-388294, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-11 13:12:00.461  INFO 17 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=5df5db7d-9b38-426c-96c7-1bed6d72128f, content=DENY, timestamp=1641906720461, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-11 13:12:00.468  INFO 17 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=208ms, Total=241ms
2022-01-11 13:12:00.610  INFO 17 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=133a5566-2e59-4774-9efa-b08ba12a0a31, content=null, timestamp=1641906720576, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=55056, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=9462ddf72b74, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.30.0.1, kc-session-state=115df91e-55fd-4d89-b568-03753c55dee3, http-req-server-port=80, http-header-accept=*/*, kc-id=faa49035-39a2-47eb-9400-cb93a9fe6d10, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641906720553, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd2DNXNxAH4AEQAAAABh3YIJdAAkZmFhNDkwMzUtMzlhMi00N2ViLTk0MDAtY2I5M2E5ZmU2ZDEwdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAXh4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQxMTVkZjkxZS01NWZkLTRkODktYjU2OC0wMzc1M2M1NWRlZTNwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAATaHR0cDovLzE5Mi4xNjguMS44M3hwcHNyAC9vcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2VuJEFjY2VzcwewcQ/lekULAgACTAAFcm9sZXNxAH4AAUwADHZlcmlmeUNhbGxlcnEAfgAKeHBzcQB+ACt3DAAAABA/QAAAAAAABHQADm9mZmxpbmVfYWNjZXNzdAAGbWVtYmVydAAFYWRtaW50ABF1bWFfYXV0aG9yaXphdGlvbnhwc3IAF2phdmEudXRpbC5MaW5rZWRIYXNoTWFwNMBOXBBswPsCAAFaAAthY2Nlc3NPcmRlcnhxAH4AGD9AAAAAAAAMdwgAAAAQAAAAAXQAB2FjY291bnRzcQB+AC5zcQB+ACt3DAAAABA/QAAAAAAAA3QADm1hbmFnZS1hY2NvdW50dAAUbWFuYWdlLWFjY291bnQtbGlua3N0AAx2aWV3LXByb2ZpbGV4cHgAdAANcHJvZmlsZSBlbWFpbHA=, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJFeUZNQnpQUXV6VFFHUzhnWjYwVjJ1LXZxUE4zYm55MFVJSm1HaUpwS2pFIn0.eyJleHAiOjE2NDE5MDY5OTcsImlhdCI6MTY0MTkwNjY5NywianRpIjoiZmFhNDkwMzUtMzlhMi00N2ViLTk0MDAtY2I5M2E5ZmU2ZDEwIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiMTE1ZGY5MWUtNTVmZC00ZDg5LWI1NjgtMDM3NTNjNTVkZWUzIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoieCJ9.RP4jVdLa2GKR1jEUG_Ofs1jSfGSuf9hAaf2-j4R2AHCcLlwOZHQfjtGK56y9rw6Mc7yt4IuTEGT3_0YWpF73nJ5N36X7TcZC0389FvX0FvP5331H4S5EVmOJ7FyGpOHtmkLRXz4dfExVXoNmkyd6BrqB07pTnpObzqEyYxOX88fWlUjDk6RWTDWCykBixaI76kAACr7cHj6JEN_a2AkEpMI4HkZGWG0JnCqZkydE2kfceTUd-pP22WGrHs60GjudxqXJPsI90ESRgnEUGmuXiI5VgPtS_v89gz7KsuRr6RElEpCzvTqNDGXjy8OX7Zi59gzgqCzdmHhL_CD_-QqTiA, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641906997, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=172.30.0.12, kc-type=Bearer, kc-cc--team-ID=x, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.30.0.1, http-session-id=5A3CA3D3697F0AA6DF645123DD66A6DC, http-session-last-accessed-time=1641906720553, kc-category-name=ACCESS, kc-iat=1641906697, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.30.0.1:55056 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 13:12:00.619  INFO 17 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 13:12:00.626  INFO 17 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@63726162
2022-01-11 13:12:00.629  INFO 17 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@63726162
2022-01-11 13:12:00.664  INFO 17 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@63726162
2022-01-11 13:12:00.667  INFO 17 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@63726162
2022-01-11 13:12:00.744  INFO 17 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@63726162
2022-01-11 13:12:00.748  WARN 17 --- [https-jsse-nio-7071-exec-10] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: x
2022-01-11 13:12:00.750  WARN 17 --- [https-jsse-nio-7071-exec-10] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: x
2022-01-11 13:12:00.766  INFO 17 --- [https-jsse-nio-7071-exec-10] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-5901472447975-364024, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-11 13:12:00.770  INFO 17 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=133a5566-2e59-4774-9efa-b08ba12a0a31, content=DENY, timestamp=1641906720770, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-11 13:12:00.776  INFO 17 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=148ms, Total=167ms
2022-01-11 13:12:00.833  INFO 17 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=02d42fb5-7231-4aa9-9016-db0e79ee6928, content=null, timestamp=1641906720817, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=55058, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=9462ddf72b74, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.30.0.1, kc-session-state=115df91e-55fd-4d89-b568-03753c55dee3, http-req-server-port=80, http-header-accept=*/*, kc-id=faa49035-39a2-47eb-9400-cb93a9fe6d10, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641906720815, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd2DNXNxAH4AEQAAAABh3YIJdAAkZmFhNDkwMzUtMzlhMi00N2ViLTk0MDAtY2I5M2E5ZmU2ZDEwdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAXh4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQxMTVkZjkxZS01NWZkLTRkODktYjU2OC0wMzc1M2M1NWRlZTNwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAATaHR0cDovLzE5Mi4xNjguMS44M3hwcHNyAC9vcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2VuJEFjY2VzcwewcQ/lekULAgACTAAFcm9sZXNxAH4AAUwADHZlcmlmeUNhbGxlcnEAfgAKeHBzcQB+ACt3DAAAABA/QAAAAAAABHQADm9mZmxpbmVfYWNjZXNzdAAGbWVtYmVydAAFYWRtaW50ABF1bWFfYXV0aG9yaXphdGlvbnhwc3IAF2phdmEudXRpbC5MaW5rZWRIYXNoTWFwNMBOXBBswPsCAAFaAAthY2Nlc3NPcmRlcnhxAH4AGD9AAAAAAAAMdwgAAAAQAAAAAXQAB2FjY291bnRzcQB+AC5zcQB+ACt3DAAAABA/QAAAAAAAA3QADm1hbmFnZS1hY2NvdW50dAAUbWFuYWdlLWFjY291bnQtbGlua3N0AAx2aWV3LXByb2ZpbGV4cHgAdAANcHJvZmlsZSBlbWFpbHA=, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJFeUZNQnpQUXV6VFFHUzhnWjYwVjJ1LXZxUE4zYm55MFVJSm1HaUpwS2pFIn0.eyJleHAiOjE2NDE5MDY5OTcsImlhdCI6MTY0MTkwNjY5NywianRpIjoiZmFhNDkwMzUtMzlhMi00N2ViLTk0MDAtY2I5M2E5ZmU2ZDEwIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiMTE1ZGY5MWUtNTVmZC00ZDg5LWI1NjgtMDM3NTNjNTVkZWUzIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoieCJ9.RP4jVdLa2GKR1jEUG_Ofs1jSfGSuf9hAaf2-j4R2AHCcLlwOZHQfjtGK56y9rw6Mc7yt4IuTEGT3_0YWpF73nJ5N36X7TcZC0389FvX0FvP5331H4S5EVmOJ7FyGpOHtmkLRXz4dfExVXoNmkyd6BrqB07pTnpObzqEyYxOX88fWlUjDk6RWTDWCykBixaI76kAACr7cHj6JEN_a2AkEpMI4HkZGWG0JnCqZkydE2kfceTUd-pP22WGrHs60GjudxqXJPsI90ESRgnEUGmuXiI5VgPtS_v89gz7KsuRr6RElEpCzvTqNDGXjy8OX7Zi59gzgqCzdmHhL_CD_-QqTiA, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641906997, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=172.30.0.12, kc-type=Bearer, kc-cc--team-ID=x, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.30.0.1, http-session-id=31A87A23BCB33D3851C58DC649D7DEEF, http-session-last-accessed-time=1641906720815, kc-category-name=ACCESS, kc-iat=1641906697, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.30.0.1:55058 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 13:12:00.840  INFO 17 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 13:12:00.851  INFO 17 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@38d5d1d8
2022-01-11 13:12:00.870  INFO 17 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@38d5d1d8
2022-01-11 13:12:00.922  INFO 17 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@38d5d1d8
2022-01-11 13:12:00.936  INFO 17 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@38d5d1d8
2022-01-11 13:12:00.973  INFO 17 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@38d5d1d8
2022-01-11 13:12:00.976  WARN 17 --- [https-jsse-nio-7071-exec-1] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: x
2022-01-11 13:12:00.982  WARN 17 --- [https-jsse-nio-7071-exec-1] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: x
2022-01-11 13:12:00.993  INFO 17 --- [https-jsse-nio-7071-exec-1] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-5901692824275-715982, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-11 13:12:00.996  INFO 17 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=02d42fb5-7231-4aa9-9016-db0e79ee6928, content=DENY, timestamp=1641906720996, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-11 13:12:01.000  INFO 17 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=153ms, Total=169ms
2022-01-11 13:12:01.074  INFO 17 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=9980e9c6-ccb9-4e4f-8233-e10d4a649536, content=null, timestamp=1641906721053, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=55060, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=9462ddf72b74, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.30.0.1, kc-session-state=115df91e-55fd-4d89-b568-03753c55dee3, http-req-server-port=80, http-header-accept=*/*, kc-id=faa49035-39a2-47eb-9400-cb93a9fe6d10, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641906721049, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd2DNXNxAH4AEQAAAABh3YIJdAAkZmFhNDkwMzUtMzlhMi00N2ViLTk0MDAtY2I5M2E5ZmU2ZDEwdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAXh4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQxMTVkZjkxZS01NWZkLTRkODktYjU2OC0wMzc1M2M1NWRlZTNwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAATaHR0cDovLzE5Mi4xNjguMS44M3hwcHNyAC9vcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2VuJEFjY2VzcwewcQ/lekULAgACTAAFcm9sZXNxAH4AAUwADHZlcmlmeUNhbGxlcnEAfgAKeHBzcQB+ACt3DAAAABA/QAAAAAAABHQADm9mZmxpbmVfYWNjZXNzdAAGbWVtYmVydAAFYWRtaW50ABF1bWFfYXV0aG9yaXphdGlvbnhwc3IAF2phdmEudXRpbC5MaW5rZWRIYXNoTWFwNMBOXBBswPsCAAFaAAthY2Nlc3NPcmRlcnhxAH4AGD9AAAAAAAAMdwgAAAAQAAAAAXQAB2FjY291bnRzcQB+AC5zcQB+ACt3DAAAABA/QAAAAAAAA3QADm1hbmFnZS1hY2NvdW50dAAUbWFuYWdlLWFjY291bnQtbGlua3N0AAx2aWV3LXByb2ZpbGV4cHgAdAANcHJvZmlsZSBlbWFpbHA=, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJFeUZNQnpQUXV6VFFHUzhnWjYwVjJ1LXZxUE4zYm55MFVJSm1HaUpwS2pFIn0.eyJleHAiOjE2NDE5MDY5OTcsImlhdCI6MTY0MTkwNjY5NywianRpIjoiZmFhNDkwMzUtMzlhMi00N2ViLTk0MDAtY2I5M2E5ZmU2ZDEwIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiMTE1ZGY5MWUtNTVmZC00ZDg5LWI1NjgtMDM3NTNjNTVkZWUzIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoieCJ9.RP4jVdLa2GKR1jEUG_Ofs1jSfGSuf9hAaf2-j4R2AHCcLlwOZHQfjtGK56y9rw6Mc7yt4IuTEGT3_0YWpF73nJ5N36X7TcZC0389FvX0FvP5331H4S5EVmOJ7FyGpOHtmkLRXz4dfExVXoNmkyd6BrqB07pTnpObzqEyYxOX88fWlUjDk6RWTDWCykBixaI76kAACr7cHj6JEN_a2AkEpMI4HkZGWG0JnCqZkydE2kfceTUd-pP22WGrHs60GjudxqXJPsI90ESRgnEUGmuXiI5VgPtS_v89gz7KsuRr6RElEpCzvTqNDGXjy8OX7Zi59gzgqCzdmHhL_CD_-QqTiA, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641906997, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=172.30.0.12, kc-type=Bearer, kc-cc--team-ID=x, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.30.0.1, http-session-id=8F425A28D7E06497FBA48CAAB28A720E, http-session-last-accessed-time=1641906721049, kc-category-name=ACCESS, kc-iat=1641906697, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.30.0.1:55060 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 13:12:01.090  INFO 17 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 13:12:01.108  INFO 17 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2dabbaa7
2022-01-11 13:12:01.110  INFO 17 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2dabbaa7
2022-01-11 13:12:01.146  INFO 17 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2dabbaa7
2022-01-11 13:12:01.150  INFO 17 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2dabbaa7
2022-01-11 13:12:01.199  INFO 17 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2dabbaa7
2022-01-11 13:12:01.203  WARN 17 --- [https-jsse-nio-7071-exec-2] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: x
2022-01-11 13:12:01.208  WARN 17 --- [https-jsse-nio-7071-exec-2] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: x
2022-01-11 13:12:01.213  INFO 17 --- [https-jsse-nio-7071-exec-2] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-5901942613375-879321, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-11 13:12:01.217  INFO 17 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=9980e9c6-ccb9-4e4f-8233-e10d4a649536, content=DENY, timestamp=1641906721217, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-11 13:12:01.225  INFO 17 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=124ms, Total=153ms
2022-01-11 13:12:01.302  INFO 17 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=99ce426d-2ffd-4287-b8b8-25e697da2792, content=null, timestamp=1641906721283, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=55062, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=9462ddf72b74, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.30.0.1, kc-session-state=115df91e-55fd-4d89-b568-03753c55dee3, http-req-server-port=80, http-header-accept=*/*, kc-id=faa49035-39a2-47eb-9400-cb93a9fe6d10, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641906721281, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd2DNXNxAH4AEQAAAABh3YIJdAAkZmFhNDkwMzUtMzlhMi00N2ViLTk0MDAtY2I5M2E5ZmU2ZDEwdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAXh4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQxMTVkZjkxZS01NWZkLTRkODktYjU2OC0wMzc1M2M1NWRlZTNwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAATaHR0cDovLzE5Mi4xNjguMS44M3hwcHNyAC9vcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2VuJEFjY2VzcwewcQ/lekULAgACTAAFcm9sZXNxAH4AAUwADHZlcmlmeUNhbGxlcnEAfgAKeHBzcQB+ACt3DAAAABA/QAAAAAAABHQADm9mZmxpbmVfYWNjZXNzdAAGbWVtYmVydAAFYWRtaW50ABF1bWFfYXV0aG9yaXphdGlvbnhwc3IAF2phdmEudXRpbC5MaW5rZWRIYXNoTWFwNMBOXBBswPsCAAFaAAthY2Nlc3NPcmRlcnhxAH4AGD9AAAAAAAAMdwgAAAAQAAAAAXQAB2FjY291bnRzcQB+AC5zcQB+ACt3DAAAABA/QAAAAAAAA3QADm1hbmFnZS1hY2NvdW50dAAUbWFuYWdlLWFjY291bnQtbGlua3N0AAx2aWV3LXByb2ZpbGV4cHgAdAANcHJvZmlsZSBlbWFpbHA=, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJFeUZNQnpQUXV6VFFHUzhnWjYwVjJ1LXZxUE4zYm55MFVJSm1HaUpwS2pFIn0.eyJleHAiOjE2NDE5MDY5OTcsImlhdCI6MTY0MTkwNjY5NywianRpIjoiZmFhNDkwMzUtMzlhMi00N2ViLTk0MDAtY2I5M2E5ZmU2ZDEwIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiMTE1ZGY5MWUtNTVmZC00ZDg5LWI1NjgtMDM3NTNjNTVkZWUzIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoieCJ9.RP4jVdLa2GKR1jEUG_Ofs1jSfGSuf9hAaf2-j4R2AHCcLlwOZHQfjtGK56y9rw6Mc7yt4IuTEGT3_0YWpF73nJ5N36X7TcZC0389FvX0FvP5331H4S5EVmOJ7FyGpOHtmkLRXz4dfExVXoNmkyd6BrqB07pTnpObzqEyYxOX88fWlUjDk6RWTDWCykBixaI76kAACr7cHj6JEN_a2AkEpMI4HkZGWG0JnCqZkydE2kfceTUd-pP22WGrHs60GjudxqXJPsI90ESRgnEUGmuXiI5VgPtS_v89gz7KsuRr6RElEpCzvTqNDGXjy8OX7Zi59gzgqCzdmHhL_CD_-QqTiA, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641906997, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=172.30.0.12, kc-type=Bearer, kc-cc--team-ID=x, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.30.0.1, http-session-id=B8C7CAEA138EB38FD4A7EB52B7855BD6, http-session-last-accessed-time=1641906721281, kc-category-name=ACCESS, kc-iat=1641906697, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.30.0.1:55062 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 13:12:01.310  INFO 17 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 13:12:01.325  INFO 17 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5091a3ea
2022-01-11 13:12:01.334  INFO 17 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5091a3ea
2022-01-11 13:12:01.385  INFO 17 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5091a3ea
2022-01-11 13:12:01.391  INFO 17 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5091a3ea
2022-01-11 13:12:01.473  INFO 17 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5091a3ea
2022-01-11 13:12:01.479  WARN 17 --- [https-jsse-nio-7071-exec-3] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: x
2022-01-11 13:12:01.482  WARN 17 --- [https-jsse-nio-7071-exec-3] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: x
2022-01-11 13:12:01.495  INFO 17 --- [https-jsse-nio-7071-exec-3] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-5902164881275-240689, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-11 13:12:01.503  INFO 17 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=99ce426d-2ffd-4287-b8b8-25e697da2792, content=DENY, timestamp=1641906721503, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-11 13:12:01.512  INFO 17 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=188ms, Total=211ms
2022-01-11 13:12:01.576  INFO 17 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=61dc18e0-a2d9-4386-b912-260b36e29be2, content=null, timestamp=1641906721562, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=55064, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=9462ddf72b74, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.30.0.1, kc-session-state=115df91e-55fd-4d89-b568-03753c55dee3, http-req-server-port=80, http-header-accept=*/*, kc-id=faa49035-39a2-47eb-9400-cb93a9fe6d10, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641906721557, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd2DNXNxAH4AEQAAAABh3YIJdAAkZmFhNDkwMzUtMzlhMi00N2ViLTk0MDAtY2I5M2E5ZmU2ZDEwdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAXh4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQxMTVkZjkxZS01NWZkLTRkODktYjU2OC0wMzc1M2M1NWRlZTNwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAATaHR0cDovLzE5Mi4xNjguMS44M3hwcHNyAC9vcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2VuJEFjY2VzcwewcQ/lekULAgACTAAFcm9sZXNxAH4AAUwADHZlcmlmeUNhbGxlcnEAfgAKeHBzcQB+ACt3DAAAABA/QAAAAAAABHQADm9mZmxpbmVfYWNjZXNzdAAGbWVtYmVydAAFYWRtaW50ABF1bWFfYXV0aG9yaXphdGlvbnhwc3IAF2phdmEudXRpbC5MaW5rZWRIYXNoTWFwNMBOXBBswPsCAAFaAAthY2Nlc3NPcmRlcnhxAH4AGD9AAAAAAAAMdwgAAAAQAAAAAXQAB2FjY291bnRzcQB+AC5zcQB+ACt3DAAAABA/QAAAAAAAA3QADm1hbmFnZS1hY2NvdW50dAAUbWFuYWdlLWFjY291bnQtbGlua3N0AAx2aWV3LXByb2ZpbGV4cHgAdAANcHJvZmlsZSBlbWFpbHA=, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJFeUZNQnpQUXV6VFFHUzhnWjYwVjJ1LXZxUE4zYm55MFVJSm1HaUpwS2pFIn0.eyJleHAiOjE2NDE5MDY5OTcsImlhdCI6MTY0MTkwNjY5NywianRpIjoiZmFhNDkwMzUtMzlhMi00N2ViLTk0MDAtY2I5M2E5ZmU2ZDEwIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiMTE1ZGY5MWUtNTVmZC00ZDg5LWI1NjgtMDM3NTNjNTVkZWUzIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoieCJ9.RP4jVdLa2GKR1jEUG_Ofs1jSfGSuf9hAaf2-j4R2AHCcLlwOZHQfjtGK56y9rw6Mc7yt4IuTEGT3_0YWpF73nJ5N36X7TcZC0389FvX0FvP5331H4S5EVmOJ7FyGpOHtmkLRXz4dfExVXoNmkyd6BrqB07pTnpObzqEyYxOX88fWlUjDk6RWTDWCykBixaI76kAACr7cHj6JEN_a2AkEpMI4HkZGWG0JnCqZkydE2kfceTUd-pP22WGrHs60GjudxqXJPsI90ESRgnEUGmuXiI5VgPtS_v89gz7KsuRr6RElEpCzvTqNDGXjy8OX7Zi59gzgqCzdmHhL_CD_-QqTiA, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641906997, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=172.30.0.12, kc-type=Bearer, kc-cc--team-ID=x, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.30.0.1, http-session-id=F7EC329D7C31F34CC6CAF901AB333517, http-session-last-accessed-time=1641906721557, kc-category-name=ACCESS, kc-iat=1641906697, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.30.0.1:55064 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 13:12:01.587  INFO 17 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 13:12:01.607  INFO 17 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7ed9404d
2022-01-11 13:12:01.611  INFO 17 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7ed9404d
2022-01-11 13:12:01.674  INFO 17 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7ed9404d
2022-01-11 13:12:01.678  INFO 17 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7ed9404d
2022-01-11 13:12:01.748  INFO 17 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7ed9404d
2022-01-11 13:12:01.751  WARN 17 --- [https-jsse-nio-7071-exec-4] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: x
2022-01-11 13:12:01.756  WARN 17 --- [https-jsse-nio-7071-exec-4] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: x
2022-01-11 13:12:01.780  INFO 17 --- [https-jsse-nio-7071-exec-4] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-5902441035875-606078, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-11 13:12:01.798  INFO 17 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=61dc18e0-a2d9-4386-b912-260b36e29be2, content=DENY, timestamp=1641906721798, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-11 13:12:01.815  INFO 17 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=208ms, Total=241ms
2022-01-11 13:12:01.909  INFO 17 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=cd426281-98bd-4e6a-b300-9c4ffa06f421, content=null, timestamp=1641906721874, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=55066, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=9462ddf72b74, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.30.0.1, kc-session-state=115df91e-55fd-4d89-b568-03753c55dee3, http-req-server-port=80, http-header-accept=*/*, kc-id=faa49035-39a2-47eb-9400-cb93a9fe6d10, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641906721873, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd2DNXNxAH4AEQAAAABh3YIJdAAkZmFhNDkwMzUtMzlhMi00N2ViLTk0MDAtY2I5M2E5ZmU2ZDEwdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAXh4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQxMTVkZjkxZS01NWZkLTRkODktYjU2OC0wMzc1M2M1NWRlZTNwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAATaHR0cDovLzE5Mi4xNjguMS44M3hwcHNyAC9vcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2VuJEFjY2VzcwewcQ/lekULAgACTAAFcm9sZXNxAH4AAUwADHZlcmlmeUNhbGxlcnEAfgAKeHBzcQB+ACt3DAAAABA/QAAAAAAABHQADm9mZmxpbmVfYWNjZXNzdAAGbWVtYmVydAAFYWRtaW50ABF1bWFfYXV0aG9yaXphdGlvbnhwc3IAF2phdmEudXRpbC5MaW5rZWRIYXNoTWFwNMBOXBBswPsCAAFaAAthY2Nlc3NPcmRlcnhxAH4AGD9AAAAAAAAMdwgAAAAQAAAAAXQAB2FjY291bnRzcQB+AC5zcQB+ACt3DAAAABA/QAAAAAAAA3QADm1hbmFnZS1hY2NvdW50dAAUbWFuYWdlLWFjY291bnQtbGlua3N0AAx2aWV3LXByb2ZpbGV4cHgAdAANcHJvZmlsZSBlbWFpbHA=, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJFeUZNQnpQUXV6VFFHUzhnWjYwVjJ1LXZxUE4zYm55MFVJSm1HaUpwS2pFIn0.eyJleHAiOjE2NDE5MDY5OTcsImlhdCI6MTY0MTkwNjY5NywianRpIjoiZmFhNDkwMzUtMzlhMi00N2ViLTk0MDAtY2I5M2E5ZmU2ZDEwIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiMTE1ZGY5MWUtNTVmZC00ZDg5LWI1NjgtMDM3NTNjNTVkZWUzIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoieCJ9.RP4jVdLa2GKR1jEUG_Ofs1jSfGSuf9hAaf2-j4R2AHCcLlwOZHQfjtGK56y9rw6Mc7yt4IuTEGT3_0YWpF73nJ5N36X7TcZC0389FvX0FvP5331H4S5EVmOJ7FyGpOHtmkLRXz4dfExVXoNmkyd6BrqB07pTnpObzqEyYxOX88fWlUjDk6RWTDWCykBixaI76kAACr7cHj6JEN_a2AkEpMI4HkZGWG0JnCqZkydE2kfceTUd-pP22WGrHs60GjudxqXJPsI90ESRgnEUGmuXiI5VgPtS_v89gz7KsuRr6RElEpCzvTqNDGXjy8OX7Zi59gzgqCzdmHhL_CD_-QqTiA, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641906997, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=172.30.0.12, kc-type=Bearer, kc-cc--team-ID=x, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.30.0.1, http-session-id=1D0E6E5F821185924DF427D5AEBBC1AA, http-session-last-accessed-time=1641906721873, kc-category-name=ACCESS, kc-iat=1641906697, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.30.0.1:55066 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 13:12:01.916  INFO 17 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 13:12:01.935  INFO 17 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@17462a8b
2022-01-11 13:12:01.946  INFO 17 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@17462a8b
2022-01-11 13:12:01.994  INFO 17 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@17462a8b
2022-01-11 13:12:01.997  INFO 17 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@17462a8b
2022-01-11 13:12:02.058  INFO 17 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@17462a8b
2022-01-11 13:12:02.061  WARN 17 --- [https-jsse-nio-7071-exec-5] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: x
2022-01-11 13:12:02.064  WARN 17 --- [https-jsse-nio-7071-exec-5] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: x
2022-01-11 13:12:02.073  INFO 17 --- [https-jsse-nio-7071-exec-5] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-5902770829075-264477, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-11 13:12:02.085  INFO 17 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=cd426281-98bd-4e6a-b300-9c4ffa06f421, content=DENY, timestamp=1641906722085, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-11 13:12:02.089  INFO 17 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=164ms, Total=191ms
2022-01-11 13:12:02.161  INFO 17 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=870d9b35-bd79-425a-ab6b-94b152c2287d, content=null, timestamp=1641906722138, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=55068, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=9462ddf72b74, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.30.0.1, kc-session-state=115df91e-55fd-4d89-b568-03753c55dee3, http-req-server-port=80, http-header-accept=*/*, kc-id=faa49035-39a2-47eb-9400-cb93a9fe6d10, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641906722137, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd2DNXNxAH4AEQAAAABh3YIJdAAkZmFhNDkwMzUtMzlhMi00N2ViLTk0MDAtY2I5M2E5ZmU2ZDEwdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAXh4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQxMTVkZjkxZS01NWZkLTRkODktYjU2OC0wMzc1M2M1NWRlZTNwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAATaHR0cDovLzE5Mi4xNjguMS44M3hwcHNyAC9vcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2VuJEFjY2VzcwewcQ/lekULAgACTAAFcm9sZXNxAH4AAUwADHZlcmlmeUNhbGxlcnEAfgAKeHBzcQB+ACt3DAAAABA/QAAAAAAABHQADm9mZmxpbmVfYWNjZXNzdAAGbWVtYmVydAAFYWRtaW50ABF1bWFfYXV0aG9yaXphdGlvbnhwc3IAF2phdmEudXRpbC5MaW5rZWRIYXNoTWFwNMBOXBBswPsCAAFaAAthY2Nlc3NPcmRlcnhxAH4AGD9AAAAAAAAMdwgAAAAQAAAAAXQAB2FjY291bnRzcQB+AC5zcQB+ACt3DAAAABA/QAAAAAAAA3QADm1hbmFnZS1hY2NvdW50dAAUbWFuYWdlLWFjY291bnQtbGlua3N0AAx2aWV3LXByb2ZpbGV4cHgAdAANcHJvZmlsZSBlbWFpbHA=, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJFeUZNQnpQUXV6VFFHUzhnWjYwVjJ1LXZxUE4zYm55MFVJSm1HaUpwS2pFIn0.eyJleHAiOjE2NDE5MDY5OTcsImlhdCI6MTY0MTkwNjY5NywianRpIjoiZmFhNDkwMzUtMzlhMi00N2ViLTk0MDAtY2I5M2E5ZmU2ZDEwIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiMTE1ZGY5MWUtNTVmZC00ZDg5LWI1NjgtMDM3NTNjNTVkZWUzIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoieCJ9.RP4jVdLa2GKR1jEUG_Ofs1jSfGSuf9hAaf2-j4R2AHCcLlwOZHQfjtGK56y9rw6Mc7yt4IuTEGT3_0YWpF73nJ5N36X7TcZC0389FvX0FvP5331H4S5EVmOJ7FyGpOHtmkLRXz4dfExVXoNmkyd6BrqB07pTnpObzqEyYxOX88fWlUjDk6RWTDWCykBixaI76kAACr7cHj6JEN_a2AkEpMI4HkZGWG0JnCqZkydE2kfceTUd-pP22WGrHs60GjudxqXJPsI90ESRgnEUGmuXiI5VgPtS_v89gz7KsuRr6RElEpCzvTqNDGXjy8OX7Zi59gzgqCzdmHhL_CD_-QqTiA, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641906997, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=172.30.0.12, kc-type=Bearer, kc-cc--team-ID=x, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.30.0.1, http-session-id=2DEB52E8003B38E3774F2C8E77008FBA, http-session-last-accessed-time=1641906722137, kc-category-name=ACCESS, kc-iat=1641906697, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.30.0.1:55068 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 13:12:02.176  INFO 17 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 13:12:02.187  INFO 17 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4b1cdf68
2022-01-11 13:12:02.198  INFO 17 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4b1cdf68
2022-01-11 13:12:02.237  INFO 17 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4b1cdf68
2022-01-11 13:12:02.240  INFO 17 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4b1cdf68
2022-01-11 13:12:02.319  INFO 17 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4b1cdf68
2022-01-11 13:12:02.321  WARN 17 --- [https-jsse-nio-7071-exec-6] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: x
2022-01-11 13:12:02.325  WARN 17 --- [https-jsse-nio-7071-exec-6] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: x
2022-01-11 13:12:02.330  INFO 17 --- [https-jsse-nio-7071-exec-6] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-5903034699775-180292, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-11 13:12:02.334  INFO 17 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=870d9b35-bd79-425a-ab6b-94b152c2287d, content=DENY, timestamp=1641906722334, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-11 13:12:02.341  INFO 17 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=149ms, Total=182ms
2022-01-11 13:12:02.387  INFO 17 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=7f979b4a-08b9-4275-ae02-9e9150b06654, content=null, timestamp=1641906722380, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=55070, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=9462ddf72b74, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.30.0.1, kc-session-state=115df91e-55fd-4d89-b568-03753c55dee3, http-req-server-port=80, http-header-accept=*/*, kc-id=faa49035-39a2-47eb-9400-cb93a9fe6d10, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641906722377, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd2DNXNxAH4AEQAAAABh3YIJdAAkZmFhNDkwMzUtMzlhMi00N2ViLTk0MDAtY2I5M2E5ZmU2ZDEwdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAXh4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQxMTVkZjkxZS01NWZkLTRkODktYjU2OC0wMzc1M2M1NWRlZTNwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAATaHR0cDovLzE5Mi4xNjguMS44M3hwcHNyAC9vcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2VuJEFjY2VzcwewcQ/lekULAgACTAAFcm9sZXNxAH4AAUwADHZlcmlmeUNhbGxlcnEAfgAKeHBzcQB+ACt3DAAAABA/QAAAAAAABHQADm9mZmxpbmVfYWNjZXNzdAAGbWVtYmVydAAFYWRtaW50ABF1bWFfYXV0aG9yaXphdGlvbnhwc3IAF2phdmEudXRpbC5MaW5rZWRIYXNoTWFwNMBOXBBswPsCAAFaAAthY2Nlc3NPcmRlcnhxAH4AGD9AAAAAAAAMdwgAAAAQAAAAAXQAB2FjY291bnRzcQB+AC5zcQB+ACt3DAAAABA/QAAAAAAAA3QADm1hbmFnZS1hY2NvdW50dAAUbWFuYWdlLWFjY291bnQtbGlua3N0AAx2aWV3LXByb2ZpbGV4cHgAdAANcHJvZmlsZSBlbWFpbHA=, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJFeUZNQnpQUXV6VFFHUzhnWjYwVjJ1LXZxUE4zYm55MFVJSm1HaUpwS2pFIn0.eyJleHAiOjE2NDE5MDY5OTcsImlhdCI6MTY0MTkwNjY5NywianRpIjoiZmFhNDkwMzUtMzlhMi00N2ViLTk0MDAtY2I5M2E5ZmU2ZDEwIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiMTE1ZGY5MWUtNTVmZC00ZDg5LWI1NjgtMDM3NTNjNTVkZWUzIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoieCJ9.RP4jVdLa2GKR1jEUG_Ofs1jSfGSuf9hAaf2-j4R2AHCcLlwOZHQfjtGK56y9rw6Mc7yt4IuTEGT3_0YWpF73nJ5N36X7TcZC0389FvX0FvP5331H4S5EVmOJ7FyGpOHtmkLRXz4dfExVXoNmkyd6BrqB07pTnpObzqEyYxOX88fWlUjDk6RWTDWCykBixaI76kAACr7cHj6JEN_a2AkEpMI4HkZGWG0JnCqZkydE2kfceTUd-pP22WGrHs60GjudxqXJPsI90ESRgnEUGmuXiI5VgPtS_v89gz7KsuRr6RElEpCzvTqNDGXjy8OX7Zi59gzgqCzdmHhL_CD_-QqTiA, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641906997, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=172.30.0.12, kc-type=Bearer, kc-cc--team-ID=x, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.30.0.1, http-session-id=FD49C06060A41280402E0B6AB91149BC, http-session-last-accessed-time=1641906722377, kc-category-name=ACCESS, kc-iat=1641906697, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.30.0.1:55070 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 13:12:02.395  INFO 17 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 13:12:02.403  INFO 17 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@66a6e4b7
2022-01-11 13:12:02.407  INFO 17 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@66a6e4b7
2022-01-11 13:12:02.443  INFO 17 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@66a6e4b7
2022-01-11 13:12:02.454  INFO 17 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@66a6e4b7
2022-01-11 13:12:02.497  INFO 17 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@66a6e4b7
2022-01-11 13:12:02.502  WARN 17 --- [https-jsse-nio-7071-exec-7] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: x
2022-01-11 13:12:02.505  WARN 17 --- [https-jsse-nio-7071-exec-7] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: x
2022-01-11 13:12:02.508  INFO 17 --- [https-jsse-nio-7071-exec-7] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-5903249346375-5860, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-11 13:12:02.511  INFO 17 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=7f979b4a-08b9-4275-ae02-9e9150b06654, content=DENY, timestamp=1641906722511, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-11 13:12:02.514  INFO 17 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=112ms, Total=129ms
2022-01-11 13:12:02.566  INFO 17 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=3111992b-e6df-408b-b186-65d070139ba1, content=null, timestamp=1641906722551, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=55072, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=9462ddf72b74, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.30.0.1, kc-session-state=115df91e-55fd-4d89-b568-03753c55dee3, http-req-server-port=80, http-header-accept=*/*, kc-id=faa49035-39a2-47eb-9400-cb93a9fe6d10, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641906722550, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd2DNXNxAH4AEQAAAABh3YIJdAAkZmFhNDkwMzUtMzlhMi00N2ViLTk0MDAtY2I5M2E5ZmU2ZDEwdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAXh4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQxMTVkZjkxZS01NWZkLTRkODktYjU2OC0wMzc1M2M1NWRlZTNwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAATaHR0cDovLzE5Mi4xNjguMS44M3hwcHNyAC9vcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2VuJEFjY2VzcwewcQ/lekULAgACTAAFcm9sZXNxAH4AAUwADHZlcmlmeUNhbGxlcnEAfgAKeHBzcQB+ACt3DAAAABA/QAAAAAAABHQADm9mZmxpbmVfYWNjZXNzdAAGbWVtYmVydAAFYWRtaW50ABF1bWFfYXV0aG9yaXphdGlvbnhwc3IAF2phdmEudXRpbC5MaW5rZWRIYXNoTWFwNMBOXBBswPsCAAFaAAthY2Nlc3NPcmRlcnhxAH4AGD9AAAAAAAAMdwgAAAAQAAAAAXQAB2FjY291bnRzcQB+AC5zcQB+ACt3DAAAABA/QAAAAAAAA3QADm1hbmFnZS1hY2NvdW50dAAUbWFuYWdlLWFjY291bnQtbGlua3N0AAx2aWV3LXByb2ZpbGV4cHgAdAANcHJvZmlsZSBlbWFpbHA=, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJFeUZNQnpQUXV6VFFHUzhnWjYwVjJ1LXZxUE4zYm55MFVJSm1HaUpwS2pFIn0.eyJleHAiOjE2NDE5MDY5OTcsImlhdCI6MTY0MTkwNjY5NywianRpIjoiZmFhNDkwMzUtMzlhMi00N2ViLTk0MDAtY2I5M2E5ZmU2ZDEwIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiMTE1ZGY5MWUtNTVmZC00ZDg5LWI1NjgtMDM3NTNjNTVkZWUzIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoieCJ9.RP4jVdLa2GKR1jEUG_Ofs1jSfGSuf9hAaf2-j4R2AHCcLlwOZHQfjtGK56y9rw6Mc7yt4IuTEGT3_0YWpF73nJ5N36X7TcZC0389FvX0FvP5331H4S5EVmOJ7FyGpOHtmkLRXz4dfExVXoNmkyd6BrqB07pTnpObzqEyYxOX88fWlUjDk6RWTDWCykBixaI76kAACr7cHj6JEN_a2AkEpMI4HkZGWG0JnCqZkydE2kfceTUd-pP22WGrHs60GjudxqXJPsI90ESRgnEUGmuXiI5VgPtS_v89gz7KsuRr6RElEpCzvTqNDGXjy8OX7Zi59gzgqCzdmHhL_CD_-QqTiA, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641906997, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=172.30.0.12, kc-type=Bearer, kc-cc--team-ID=x, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.30.0.1, http-session-id=BEA36B1B705455F47883F52DB4DC14E4, http-session-last-accessed-time=1641906722550, kc-category-name=ACCESS, kc-iat=1641906697, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.30.0.1:55072 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 13:12:02.574  INFO 17 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 13:12:02.593  INFO 17 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5316d854
2022-01-11 13:12:02.597  INFO 17 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5316d854
2022-01-11 13:12:02.627  INFO 17 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5316d854
2022-01-11 13:12:02.631  INFO 17 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5316d854
2022-01-11 13:12:02.661  INFO 17 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5316d854
2022-01-11 13:12:02.664  WARN 17 --- [https-jsse-nio-7071-exec-8] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: x
2022-01-11 13:12:02.668  WARN 17 --- [https-jsse-nio-7071-exec-8] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: x
2022-01-11 13:12:02.675  INFO 17 --- [https-jsse-nio-7071-exec-8] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-5903429352575-696428, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-11 13:12:02.684  INFO 17 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=3111992b-e6df-408b-b186-65d070139ba1, content=DENY, timestamp=1641906722684, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-11 13:12:02.689  INFO 17 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=106ms, Total=126ms
2022-01-11 13:12:02.764  INFO 17 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=66e0cf8f-a708-4984-908d-8664de985377, content=null, timestamp=1641906722742, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=55074, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=9462ddf72b74, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.30.0.1, kc-session-state=115df91e-55fd-4d89-b568-03753c55dee3, http-req-server-port=80, http-header-accept=*/*, kc-id=faa49035-39a2-47eb-9400-cb93a9fe6d10, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641906722736, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd2DNXNxAH4AEQAAAABh3YIJdAAkZmFhNDkwMzUtMzlhMi00N2ViLTk0MDAtY2I5M2E5ZmU2ZDEwdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAXh4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQxMTVkZjkxZS01NWZkLTRkODktYjU2OC0wMzc1M2M1NWRlZTNwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAATaHR0cDovLzE5Mi4xNjguMS44M3hwcHNyAC9vcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2VuJEFjY2VzcwewcQ/lekULAgACTAAFcm9sZXNxAH4AAUwADHZlcmlmeUNhbGxlcnEAfgAKeHBzcQB+ACt3DAAAABA/QAAAAAAABHQADm9mZmxpbmVfYWNjZXNzdAAGbWVtYmVydAAFYWRtaW50ABF1bWFfYXV0aG9yaXphdGlvbnhwc3IAF2phdmEudXRpbC5MaW5rZWRIYXNoTWFwNMBOXBBswPsCAAFaAAthY2Nlc3NPcmRlcnhxAH4AGD9AAAAAAAAMdwgAAAAQAAAAAXQAB2FjY291bnRzcQB+AC5zcQB+ACt3DAAAABA/QAAAAAAAA3QADm1hbmFnZS1hY2NvdW50dAAUbWFuYWdlLWFjY291bnQtbGlua3N0AAx2aWV3LXByb2ZpbGV4cHgAdAANcHJvZmlsZSBlbWFpbHA=, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJFeUZNQnpQUXV6VFFHUzhnWjYwVjJ1LXZxUE4zYm55MFVJSm1HaUpwS2pFIn0.eyJleHAiOjE2NDE5MDY5OTcsImlhdCI6MTY0MTkwNjY5NywianRpIjoiZmFhNDkwMzUtMzlhMi00N2ViLTk0MDAtY2I5M2E5ZmU2ZDEwIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiMTE1ZGY5MWUtNTVmZC00ZDg5LWI1NjgtMDM3NTNjNTVkZWUzIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoieCJ9.RP4jVdLa2GKR1jEUG_Ofs1jSfGSuf9hAaf2-j4R2AHCcLlwOZHQfjtGK56y9rw6Mc7yt4IuTEGT3_0YWpF73nJ5N36X7TcZC0389FvX0FvP5331H4S5EVmOJ7FyGpOHtmkLRXz4dfExVXoNmkyd6BrqB07pTnpObzqEyYxOX88fWlUjDk6RWTDWCykBixaI76kAACr7cHj6JEN_a2AkEpMI4HkZGWG0JnCqZkydE2kfceTUd-pP22WGrHs60GjudxqXJPsI90ESRgnEUGmuXiI5VgPtS_v89gz7KsuRr6RElEpCzvTqNDGXjy8OX7Zi59gzgqCzdmHhL_CD_-QqTiA, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641906997, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=172.30.0.12, kc-type=Bearer, kc-cc--team-ID=x, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.30.0.1, http-session-id=1C6A95A443DDCBFDB655451D2B0E1579, http-session-last-accessed-time=1641906722736, kc-category-name=ACCESS, kc-iat=1641906697, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.30.0.1:55074 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 13:12:02.768  INFO 17 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 13:12:02.776  INFO 17 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7e63ec79
2022-01-11 13:12:02.785  INFO 17 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7e63ec79
2022-01-11 13:12:02.846  INFO 17 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7e63ec79
2022-01-11 13:12:02.852  INFO 17 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7e63ec79
2022-01-11 13:12:02.941  INFO 17 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7e63ec79
2022-01-11 13:12:02.946  WARN 17 --- [https-jsse-nio-7071-exec-9] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: x
2022-01-11 13:12:02.951  WARN 17 --- [https-jsse-nio-7071-exec-9] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: x
2022-01-11 13:12:02.955  INFO 17 --- [https-jsse-nio-7071-exec-9] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-5903619952675-266754, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-11 13:12:02.963  INFO 17 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=66e0cf8f-a708-4984-908d-8664de985377, content=DENY, timestamp=1641906722963, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-11 13:12:02.969  INFO 17 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=193ms, Total=206ms
2022-01-11 13:12:03.048  INFO 17 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=3931eace-0933-4064-b59c-f4e9d1ca2402, content=null, timestamp=1641906723007, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=55076, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=9462ddf72b74, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.30.0.1, kc-session-state=115df91e-55fd-4d89-b568-03753c55dee3, http-req-server-port=80, http-header-accept=*/*, kc-id=faa49035-39a2-47eb-9400-cb93a9fe6d10, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641906723006, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd2DNXNxAH4AEQAAAABh3YIJdAAkZmFhNDkwMzUtMzlhMi00N2ViLTk0MDAtY2I5M2E5ZmU2ZDEwdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAXh4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQxMTVkZjkxZS01NWZkLTRkODktYjU2OC0wMzc1M2M1NWRlZTNwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAATaHR0cDovLzE5Mi4xNjguMS44M3hwcHNyAC9vcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2VuJEFjY2VzcwewcQ/lekULAgACTAAFcm9sZXNxAH4AAUwADHZlcmlmeUNhbGxlcnEAfgAKeHBzcQB+ACt3DAAAABA/QAAAAAAABHQADm9mZmxpbmVfYWNjZXNzdAAGbWVtYmVydAAFYWRtaW50ABF1bWFfYXV0aG9yaXphdGlvbnhwc3IAF2phdmEudXRpbC5MaW5rZWRIYXNoTWFwNMBOXBBswPsCAAFaAAthY2Nlc3NPcmRlcnhxAH4AGD9AAAAAAAAMdwgAAAAQAAAAAXQAB2FjY291bnRzcQB+AC5zcQB+ACt3DAAAABA/QAAAAAAAA3QADm1hbmFnZS1hY2NvdW50dAAUbWFuYWdlLWFjY291bnQtbGlua3N0AAx2aWV3LXByb2ZpbGV4cHgAdAANcHJvZmlsZSBlbWFpbHA=, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJFeUZNQnpQUXV6VFFHUzhnWjYwVjJ1LXZxUE4zYm55MFVJSm1HaUpwS2pFIn0.eyJleHAiOjE2NDE5MDY5OTcsImlhdCI6MTY0MTkwNjY5NywianRpIjoiZmFhNDkwMzUtMzlhMi00N2ViLTk0MDAtY2I5M2E5ZmU2ZDEwIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiMTE1ZGY5MWUtNTVmZC00ZDg5LWI1NjgtMDM3NTNjNTVkZWUzIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoieCJ9.RP4jVdLa2GKR1jEUG_Ofs1jSfGSuf9hAaf2-j4R2AHCcLlwOZHQfjtGK56y9rw6Mc7yt4IuTEGT3_0YWpF73nJ5N36X7TcZC0389FvX0FvP5331H4S5EVmOJ7FyGpOHtmkLRXz4dfExVXoNmkyd6BrqB07pTnpObzqEyYxOX88fWlUjDk6RWTDWCykBixaI76kAACr7cHj6JEN_a2AkEpMI4HkZGWG0JnCqZkydE2kfceTUd-pP22WGrHs60GjudxqXJPsI90ESRgnEUGmuXiI5VgPtS_v89gz7KsuRr6RElEpCzvTqNDGXjy8OX7Zi59gzgqCzdmHhL_CD_-QqTiA, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641906997, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=172.30.0.12, kc-type=Bearer, kc-cc--team-ID=x, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.30.0.1, http-session-id=09008C9966EF58921865CEF3F8FA7E93, http-session-last-accessed-time=1641906723006, kc-category-name=ACCESS, kc-iat=1641906697, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.30.0.1:55076 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 13:12:03.054  INFO 17 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 13:12:03.071  INFO 17 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5088cd52
2022-01-11 13:12:03.075  INFO 17 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5088cd52
2022-01-11 13:12:03.135  INFO 17 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5088cd52
2022-01-11 13:12:03.138  INFO 17 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5088cd52
2022-01-11 13:12:03.201  INFO 17 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5088cd52
2022-01-11 13:12:03.206  WARN 17 --- [https-jsse-nio-7071-exec-10] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: x
2022-01-11 13:12:03.210  WARN 17 --- [https-jsse-nio-7071-exec-10] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: x
2022-01-11 13:12:03.214  INFO 17 --- [https-jsse-nio-7071-exec-10] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-5903907310875-665794, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-11 13:12:03.217  INFO 17 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=3931eace-0933-4064-b59c-f4e9d1ca2402, content=DENY, timestamp=1641906723217, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-11 13:12:03.222  INFO 17 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=160ms, Total=185ms
2022-01-11 13:12:03.301  INFO 17 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=ab67f327-199a-4f51-8f13-eb838bea9e7c, content=null, timestamp=1641906723274, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=55078, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=9462ddf72b74, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.30.0.1, kc-session-state=115df91e-55fd-4d89-b568-03753c55dee3, http-req-server-port=80, http-header-accept=*/*, kc-id=faa49035-39a2-47eb-9400-cb93a9fe6d10, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641906723266, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd2DNXNxAH4AEQAAAABh3YIJdAAkZmFhNDkwMzUtMzlhMi00N2ViLTk0MDAtY2I5M2E5ZmU2ZDEwdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAXh4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQxMTVkZjkxZS01NWZkLTRkODktYjU2OC0wMzc1M2M1NWRlZTNwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAATaHR0cDovLzE5Mi4xNjguMS44M3hwcHNyAC9vcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2VuJEFjY2VzcwewcQ/lekULAgACTAAFcm9sZXNxAH4AAUwADHZlcmlmeUNhbGxlcnEAfgAKeHBzcQB+ACt3DAAAABA/QAAAAAAABHQADm9mZmxpbmVfYWNjZXNzdAAGbWVtYmVydAAFYWRtaW50ABF1bWFfYXV0aG9yaXphdGlvbnhwc3IAF2phdmEudXRpbC5MaW5rZWRIYXNoTWFwNMBOXBBswPsCAAFaAAthY2Nlc3NPcmRlcnhxAH4AGD9AAAAAAAAMdwgAAAAQAAAAAXQAB2FjY291bnRzcQB+AC5zcQB+ACt3DAAAABA/QAAAAAAAA3QADm1hbmFnZS1hY2NvdW50dAAUbWFuYWdlLWFjY291bnQtbGlua3N0AAx2aWV3LXByb2ZpbGV4cHgAdAANcHJvZmlsZSBlbWFpbHA=, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJFeUZNQnpQUXV6VFFHUzhnWjYwVjJ1LXZxUE4zYm55MFVJSm1HaUpwS2pFIn0.eyJleHAiOjE2NDE5MDY5OTcsImlhdCI6MTY0MTkwNjY5NywianRpIjoiZmFhNDkwMzUtMzlhMi00N2ViLTk0MDAtY2I5M2E5ZmU2ZDEwIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiMTE1ZGY5MWUtNTVmZC00ZDg5LWI1NjgtMDM3NTNjNTVkZWUzIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoieCJ9.RP4jVdLa2GKR1jEUG_Ofs1jSfGSuf9hAaf2-j4R2AHCcLlwOZHQfjtGK56y9rw6Mc7yt4IuTEGT3_0YWpF73nJ5N36X7TcZC0389FvX0FvP5331H4S5EVmOJ7FyGpOHtmkLRXz4dfExVXoNmkyd6BrqB07pTnpObzqEyYxOX88fWlUjDk6RWTDWCykBixaI76kAACr7cHj6JEN_a2AkEpMI4HkZGWG0JnCqZkydE2kfceTUd-pP22WGrHs60GjudxqXJPsI90ESRgnEUGmuXiI5VgPtS_v89gz7KsuRr6RElEpCzvTqNDGXjy8OX7Zi59gzgqCzdmHhL_CD_-QqTiA, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641906997, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=172.30.0.12, kc-type=Bearer, kc-cc--team-ID=x, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.30.0.1, http-session-id=CA79A6D6B95B7DE13D030087A5184074, http-session-last-accessed-time=1641906723266, kc-category-name=ACCESS, kc-iat=1641906697, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.30.0.1:55078 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 13:12:03.306  INFO 17 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 13:12:03.327  INFO 17 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@d37f15c
2022-01-11 13:12:03.331  INFO 17 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@d37f15c
2022-01-11 13:12:03.403  INFO 17 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@d37f15c
2022-01-11 13:12:03.408  INFO 17 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@d37f15c
2022-01-11 13:12:03.436  INFO 17 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@d37f15c
2022-01-11 13:12:03.443  WARN 17 --- [https-jsse-nio-7071-exec-1] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: x
2022-01-11 13:12:03.445  WARN 17 --- [https-jsse-nio-7071-exec-1] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: x
2022-01-11 13:12:03.448  INFO 17 --- [https-jsse-nio-7071-exec-1] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-5904158217375-707636, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-11 13:12:03.452  INFO 17 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=ab67f327-199a-4f51-8f13-eb838bea9e7c, content=DENY, timestamp=1641906723452, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-11 13:12:03.456  INFO 17 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=144ms, Total=167ms
2022-01-11 13:12:03.547  INFO 17 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=2cc2a1f1-c3f5-4238-8f2f-fb4fa561ecfc, content=null, timestamp=1641906723528, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=55080, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=9462ddf72b74, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.30.0.1, kc-session-state=115df91e-55fd-4d89-b568-03753c55dee3, http-req-server-port=80, http-header-accept=*/*, kc-id=faa49035-39a2-47eb-9400-cb93a9fe6d10, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641906723515, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd2DNXNxAH4AEQAAAABh3YIJdAAkZmFhNDkwMzUtMzlhMi00N2ViLTk0MDAtY2I5M2E5ZmU2ZDEwdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAXh4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQxMTVkZjkxZS01NWZkLTRkODktYjU2OC0wMzc1M2M1NWRlZTNwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAATaHR0cDovLzE5Mi4xNjguMS44M3hwcHNyAC9vcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2VuJEFjY2VzcwewcQ/lekULAgACTAAFcm9sZXNxAH4AAUwADHZlcmlmeUNhbGxlcnEAfgAKeHBzcQB+ACt3DAAAABA/QAAAAAAABHQADm9mZmxpbmVfYWNjZXNzdAAGbWVtYmVydAAFYWRtaW50ABF1bWFfYXV0aG9yaXphdGlvbnhwc3IAF2phdmEudXRpbC5MaW5rZWRIYXNoTWFwNMBOXBBswPsCAAFaAAthY2Nlc3NPcmRlcnhxAH4AGD9AAAAAAAAMdwgAAAAQAAAAAXQAB2FjY291bnRzcQB+AC5zcQB+ACt3DAAAABA/QAAAAAAAA3QADm1hbmFnZS1hY2NvdW50dAAUbWFuYWdlLWFjY291bnQtbGlua3N0AAx2aWV3LXByb2ZpbGV4cHgAdAANcHJvZmlsZSBlbWFpbHA=, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJFeUZNQnpQUXV6VFFHUzhnWjYwVjJ1LXZxUE4zYm55MFVJSm1HaUpwS2pFIn0.eyJleHAiOjE2NDE5MDY5OTcsImlhdCI6MTY0MTkwNjY5NywianRpIjoiZmFhNDkwMzUtMzlhMi00N2ViLTk0MDAtY2I5M2E5ZmU2ZDEwIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiMTE1ZGY5MWUtNTVmZC00ZDg5LWI1NjgtMDM3NTNjNTVkZWUzIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoieCJ9.RP4jVdLa2GKR1jEUG_Ofs1jSfGSuf9hAaf2-j4R2AHCcLlwOZHQfjtGK56y9rw6Mc7yt4IuTEGT3_0YWpF73nJ5N36X7TcZC0389FvX0FvP5331H4S5EVmOJ7FyGpOHtmkLRXz4dfExVXoNmkyd6BrqB07pTnpObzqEyYxOX88fWlUjDk6RWTDWCykBixaI76kAACr7cHj6JEN_a2AkEpMI4HkZGWG0JnCqZkydE2kfceTUd-pP22WGrHs60GjudxqXJPsI90ESRgnEUGmuXiI5VgPtS_v89gz7KsuRr6RElEpCzvTqNDGXjy8OX7Zi59gzgqCzdmHhL_CD_-QqTiA, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641906997, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=172.30.0.12, kc-type=Bearer, kc-cc--team-ID=x, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.30.0.1, http-session-id=B1FD49E4925BED5FB50E31DC4CBFC4CA, http-session-last-accessed-time=1641906723515, kc-category-name=ACCESS, kc-iat=1641906697, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.30.0.1:55080 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 13:12:03.556  INFO 17 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 13:12:03.565  INFO 17 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5fb2c445
2022-01-11 13:12:03.575  INFO 17 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5fb2c445
2022-01-11 13:12:03.618  INFO 17 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5fb2c445
2022-01-11 13:12:03.621  INFO 17 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5fb2c445
2022-01-11 13:12:03.696  INFO 17 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5fb2c445
2022-01-11 13:12:03.699  WARN 17 --- [https-jsse-nio-7071-exec-2] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: x
2022-01-11 13:12:03.702  WARN 17 --- [https-jsse-nio-7071-exec-2] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: x
2022-01-11 13:12:03.713  INFO 17 --- [https-jsse-nio-7071-exec-2] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-5904412063675-89304, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-11 13:12:03.721  INFO 17 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=2cc2a1f1-c3f5-4238-8f2f-fb4fa561ecfc, content=DENY, timestamp=1641906723720, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-11 13:12:03.726  INFO 17 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=158ms, Total=181ms
2022-01-11 13:12:03.766  INFO 17 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=7107ad71-d383-4af6-bc58-5d8ab098ee55, content=null, timestamp=1641906723756, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=55082, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=9462ddf72b74, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.30.0.1, kc-session-state=115df91e-55fd-4d89-b568-03753c55dee3, http-req-server-port=80, http-header-accept=*/*, kc-id=faa49035-39a2-47eb-9400-cb93a9fe6d10, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641906723754, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd2DNXNxAH4AEQAAAABh3YIJdAAkZmFhNDkwMzUtMzlhMi00N2ViLTk0MDAtY2I5M2E5ZmU2ZDEwdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAXh4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQxMTVkZjkxZS01NWZkLTRkODktYjU2OC0wMzc1M2M1NWRlZTNwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAATaHR0cDovLzE5Mi4xNjguMS44M3hwcHNyAC9vcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2VuJEFjY2VzcwewcQ/lekULAgACTAAFcm9sZXNxAH4AAUwADHZlcmlmeUNhbGxlcnEAfgAKeHBzcQB+ACt3DAAAABA/QAAAAAAABHQADm9mZmxpbmVfYWNjZXNzdAAGbWVtYmVydAAFYWRtaW50ABF1bWFfYXV0aG9yaXphdGlvbnhwc3IAF2phdmEudXRpbC5MaW5rZWRIYXNoTWFwNMBOXBBswPsCAAFaAAthY2Nlc3NPcmRlcnhxAH4AGD9AAAAAAAAMdwgAAAAQAAAAAXQAB2FjY291bnRzcQB+AC5zcQB+ACt3DAAAABA/QAAAAAAAA3QADm1hbmFnZS1hY2NvdW50dAAUbWFuYWdlLWFjY291bnQtbGlua3N0AAx2aWV3LXByb2ZpbGV4cHgAdAANcHJvZmlsZSBlbWFpbHA=, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJFeUZNQnpQUXV6VFFHUzhnWjYwVjJ1LXZxUE4zYm55MFVJSm1HaUpwS2pFIn0.eyJleHAiOjE2NDE5MDY5OTcsImlhdCI6MTY0MTkwNjY5NywianRpIjoiZmFhNDkwMzUtMzlhMi00N2ViLTk0MDAtY2I5M2E5ZmU2ZDEwIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiMTE1ZGY5MWUtNTVmZC00ZDg5LWI1NjgtMDM3NTNjNTVkZWUzIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoieCJ9.RP4jVdLa2GKR1jEUG_Ofs1jSfGSuf9hAaf2-j4R2AHCcLlwOZHQfjtGK56y9rw6Mc7yt4IuTEGT3_0YWpF73nJ5N36X7TcZC0389FvX0FvP5331H4S5EVmOJ7FyGpOHtmkLRXz4dfExVXoNmkyd6BrqB07pTnpObzqEyYxOX88fWlUjDk6RWTDWCykBixaI76kAACr7cHj6JEN_a2AkEpMI4HkZGWG0JnCqZkydE2kfceTUd-pP22WGrHs60GjudxqXJPsI90ESRgnEUGmuXiI5VgPtS_v89gz7KsuRr6RElEpCzvTqNDGXjy8OX7Zi59gzgqCzdmHhL_CD_-QqTiA, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641906997, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=172.30.0.12, kc-type=Bearer, kc-cc--team-ID=x, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.30.0.1, http-session-id=5BB7D6876E711E814C54923283710158, http-session-last-accessed-time=1641906723754, kc-category-name=ACCESS, kc-iat=1641906697, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.30.0.1:55082 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 13:12:03.773  INFO 17 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 13:12:03.785  INFO 17 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5e7fda08
2022-01-11 13:12:03.791  INFO 17 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5e7fda08
2022-01-11 13:12:03.829  INFO 17 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5e7fda08
2022-01-11 13:12:03.833  INFO 17 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5e7fda08
2022-01-11 13:12:03.879  INFO 17 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5e7fda08
2022-01-11 13:12:03.882  WARN 17 --- [https-jsse-nio-7071-exec-3] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: x
2022-01-11 13:12:03.892  WARN 17 --- [https-jsse-nio-7071-exec-3] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: x
2022-01-11 13:12:03.907  INFO 17 --- [https-jsse-nio-7071-exec-3] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-5904625362975-959159, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-11 13:12:03.916  INFO 17 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=7107ad71-d383-4af6-bc58-5d8ab098ee55, content=DENY, timestamp=1641906723915, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-11 13:12:03.932  INFO 17 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=139ms, Total=168ms
2022-01-11 13:12:03.998  INFO 17 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=e2beee07-1fc4-426a-b1dd-ee856f7e7607, content=null, timestamp=1641906723985, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=55084, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=9462ddf72b74, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.30.0.1, kc-session-state=115df91e-55fd-4d89-b568-03753c55dee3, http-req-server-port=80, http-header-accept=*/*, kc-id=faa49035-39a2-47eb-9400-cb93a9fe6d10, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641906723983, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd2DNXNxAH4AEQAAAABh3YIJdAAkZmFhNDkwMzUtMzlhMi00N2ViLTk0MDAtY2I5M2E5ZmU2ZDEwdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAXh4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQxMTVkZjkxZS01NWZkLTRkODktYjU2OC0wMzc1M2M1NWRlZTNwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAATaHR0cDovLzE5Mi4xNjguMS44M3hwcHNyAC9vcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2VuJEFjY2VzcwewcQ/lekULAgACTAAFcm9sZXNxAH4AAUwADHZlcmlmeUNhbGxlcnEAfgAKeHBzcQB+ACt3DAAAABA/QAAAAAAABHQADm9mZmxpbmVfYWNjZXNzdAAGbWVtYmVydAAFYWRtaW50ABF1bWFfYXV0aG9yaXphdGlvbnhwc3IAF2phdmEudXRpbC5MaW5rZWRIYXNoTWFwNMBOXBBswPsCAAFaAAthY2Nlc3NPcmRlcnhxAH4AGD9AAAAAAAAMdwgAAAAQAAAAAXQAB2FjY291bnRzcQB+AC5zcQB+ACt3DAAAABA/QAAAAAAAA3QADm1hbmFnZS1hY2NvdW50dAAUbWFuYWdlLWFjY291bnQtbGlua3N0AAx2aWV3LXByb2ZpbGV4cHgAdAANcHJvZmlsZSBlbWFpbHA=, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJFeUZNQnpQUXV6VFFHUzhnWjYwVjJ1LXZxUE4zYm55MFVJSm1HaUpwS2pFIn0.eyJleHAiOjE2NDE5MDY5OTcsImlhdCI6MTY0MTkwNjY5NywianRpIjoiZmFhNDkwMzUtMzlhMi00N2ViLTk0MDAtY2I5M2E5ZmU2ZDEwIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiMTE1ZGY5MWUtNTVmZC00ZDg5LWI1NjgtMDM3NTNjNTVkZWUzIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoieCJ9.RP4jVdLa2GKR1jEUG_Ofs1jSfGSuf9hAaf2-j4R2AHCcLlwOZHQfjtGK56y9rw6Mc7yt4IuTEGT3_0YWpF73nJ5N36X7TcZC0389FvX0FvP5331H4S5EVmOJ7FyGpOHtmkLRXz4dfExVXoNmkyd6BrqB07pTnpObzqEyYxOX88fWlUjDk6RWTDWCykBixaI76kAACr7cHj6JEN_a2AkEpMI4HkZGWG0JnCqZkydE2kfceTUd-pP22WGrHs60GjudxqXJPsI90ESRgnEUGmuXiI5VgPtS_v89gz7KsuRr6RElEpCzvTqNDGXjy8OX7Zi59gzgqCzdmHhL_CD_-QqTiA, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641906997, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=172.30.0.12, kc-type=Bearer, kc-cc--team-ID=x, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.30.0.1, http-session-id=CB03DD211AC3527D3F0C7656AAE5C9BB, http-session-last-accessed-time=1641906723983, kc-category-name=ACCESS, kc-iat=1641906697, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.30.0.1:55084 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 13:12:04.003  INFO 17 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 13:12:04.007  INFO 17 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@568cb8c2
2022-01-11 13:12:04.009  INFO 17 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@568cb8c2
2022-01-11 13:12:04.048  INFO 17 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@568cb8c2
2022-01-11 13:12:04.051  INFO 17 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@568cb8c2
2022-01-11 13:12:04.093  INFO 17 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@568cb8c2
2022-01-11 13:12:04.110  WARN 17 --- [https-jsse-nio-7071-exec-4] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: x
2022-01-11 13:12:04.133  WARN 17 --- [https-jsse-nio-7071-exec-4] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: x
2022-01-11 13:12:04.140  INFO 17 --- [https-jsse-nio-7071-exec-4] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-5904855100675-384586, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-11 13:12:04.148  INFO 17 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=e2beee07-1fc4-426a-b1dd-ee856f7e7607, content=DENY, timestamp=1641906724148, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-11 13:12:04.162  INFO 17 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=143ms, Total=171ms
2022-01-11 13:12:04.266  INFO 17 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=cfb879be-9bf6-40fd-acd3-1ec11e988430, content=null, timestamp=1641906724246, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=55086, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=9462ddf72b74, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.30.0.1, kc-session-state=115df91e-55fd-4d89-b568-03753c55dee3, http-req-server-port=80, http-header-accept=*/*, kc-id=faa49035-39a2-47eb-9400-cb93a9fe6d10, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641906724242, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd2DNXNxAH4AEQAAAABh3YIJdAAkZmFhNDkwMzUtMzlhMi00N2ViLTk0MDAtY2I5M2E5ZmU2ZDEwdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAXh4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQxMTVkZjkxZS01NWZkLTRkODktYjU2OC0wMzc1M2M1NWRlZTNwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAATaHR0cDovLzE5Mi4xNjguMS44M3hwcHNyAC9vcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2VuJEFjY2VzcwewcQ/lekULAgACTAAFcm9sZXNxAH4AAUwADHZlcmlmeUNhbGxlcnEAfgAKeHBzcQB+ACt3DAAAABA/QAAAAAAABHQADm9mZmxpbmVfYWNjZXNzdAAGbWVtYmVydAAFYWRtaW50ABF1bWFfYXV0aG9yaXphdGlvbnhwc3IAF2phdmEudXRpbC5MaW5rZWRIYXNoTWFwNMBOXBBswPsCAAFaAAthY2Nlc3NPcmRlcnhxAH4AGD9AAAAAAAAMdwgAAAAQAAAAAXQAB2FjY291bnRzcQB+AC5zcQB+ACt3DAAAABA/QAAAAAAAA3QADm1hbmFnZS1hY2NvdW50dAAUbWFuYWdlLWFjY291bnQtbGlua3N0AAx2aWV3LXByb2ZpbGV4cHgAdAANcHJvZmlsZSBlbWFpbHA=, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJFeUZNQnpQUXV6VFFHUzhnWjYwVjJ1LXZxUE4zYm55MFVJSm1HaUpwS2pFIn0.eyJleHAiOjE2NDE5MDY5OTcsImlhdCI6MTY0MTkwNjY5NywianRpIjoiZmFhNDkwMzUtMzlhMi00N2ViLTk0MDAtY2I5M2E5ZmU2ZDEwIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiMTE1ZGY5MWUtNTVmZC00ZDg5LWI1NjgtMDM3NTNjNTVkZWUzIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoieCJ9.RP4jVdLa2GKR1jEUG_Ofs1jSfGSuf9hAaf2-j4R2AHCcLlwOZHQfjtGK56y9rw6Mc7yt4IuTEGT3_0YWpF73nJ5N36X7TcZC0389FvX0FvP5331H4S5EVmOJ7FyGpOHtmkLRXz4dfExVXoNmkyd6BrqB07pTnpObzqEyYxOX88fWlUjDk6RWTDWCykBixaI76kAACr7cHj6JEN_a2AkEpMI4HkZGWG0JnCqZkydE2kfceTUd-pP22WGrHs60GjudxqXJPsI90ESRgnEUGmuXiI5VgPtS_v89gz7KsuRr6RElEpCzvTqNDGXjy8OX7Zi59gzgqCzdmHhL_CD_-QqTiA, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641906997, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=172.30.0.12, kc-type=Bearer, kc-cc--team-ID=x, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.30.0.1, http-session-id=D9284DB88919860B94571F61723B34A8, http-session-last-accessed-time=1641906724242, kc-category-name=ACCESS, kc-iat=1641906697, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.30.0.1:55086 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 13:12:04.279  INFO 17 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 13:12:04.302  INFO 17 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@73d67500
2022-01-11 13:12:04.307  INFO 17 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@73d67500
2022-01-11 13:12:04.365  INFO 17 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@73d67500
2022-01-11 13:12:04.371  INFO 17 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@73d67500
2022-01-11 13:12:04.508  INFO 17 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@73d67500
2022-01-11 13:12:04.538  WARN 17 --- [https-jsse-nio-7071-exec-5] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: x
2022-01-11 13:12:04.545  WARN 17 --- [https-jsse-nio-7071-exec-5] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: x
2022-01-11 13:12:04.553  INFO 17 --- [https-jsse-nio-7071-exec-5] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-5905133633475-5037, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-11 13:12:04.565  INFO 17 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=cfb879be-9bf6-40fd-acd3-1ec11e988430, content=DENY, timestamp=1641906724565, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-11 13:12:04.574  INFO 17 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=279ms, Total=309ms
2022-01-11 13:12:04.691  INFO 17 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=e705a204-9769-4bce-9865-a67dc91562cc, content=null, timestamp=1641906724621, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=55088, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=9462ddf72b74, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.30.0.1, kc-session-state=115df91e-55fd-4d89-b568-03753c55dee3, http-req-server-port=80, http-header-accept=*/*, kc-id=faa49035-39a2-47eb-9400-cb93a9fe6d10, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641906724620, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd2DNXNxAH4AEQAAAABh3YIJdAAkZmFhNDkwMzUtMzlhMi00N2ViLTk0MDAtY2I5M2E5ZmU2ZDEwdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAXh4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQxMTVkZjkxZS01NWZkLTRkODktYjU2OC0wMzc1M2M1NWRlZTNwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAATaHR0cDovLzE5Mi4xNjguMS44M3hwcHNyAC9vcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2VuJEFjY2VzcwewcQ/lekULAgACTAAFcm9sZXNxAH4AAUwADHZlcmlmeUNhbGxlcnEAfgAKeHBzcQB+ACt3DAAAABA/QAAAAAAABHQADm9mZmxpbmVfYWNjZXNzdAAGbWVtYmVydAAFYWRtaW50ABF1bWFfYXV0aG9yaXphdGlvbnhwc3IAF2phdmEudXRpbC5MaW5rZWRIYXNoTWFwNMBOXBBswPsCAAFaAAthY2Nlc3NPcmRlcnhxAH4AGD9AAAAAAAAMdwgAAAAQAAAAAXQAB2FjY291bnRzcQB+AC5zcQB+ACt3DAAAABA/QAAAAAAAA3QADm1hbmFnZS1hY2NvdW50dAAUbWFuYWdlLWFjY291bnQtbGlua3N0AAx2aWV3LXByb2ZpbGV4cHgAdAANcHJvZmlsZSBlbWFpbHA=, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJFeUZNQnpQUXV6VFFHUzhnWjYwVjJ1LXZxUE4zYm55MFVJSm1HaUpwS2pFIn0.eyJleHAiOjE2NDE5MDY5OTcsImlhdCI6MTY0MTkwNjY5NywianRpIjoiZmFhNDkwMzUtMzlhMi00N2ViLTk0MDAtY2I5M2E5ZmU2ZDEwIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiMTE1ZGY5MWUtNTVmZC00ZDg5LWI1NjgtMDM3NTNjNTVkZWUzIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoieCJ9.RP4jVdLa2GKR1jEUG_Ofs1jSfGSuf9hAaf2-j4R2AHCcLlwOZHQfjtGK56y9rw6Mc7yt4IuTEGT3_0YWpF73nJ5N36X7TcZC0389FvX0FvP5331H4S5EVmOJ7FyGpOHtmkLRXz4dfExVXoNmkyd6BrqB07pTnpObzqEyYxOX88fWlUjDk6RWTDWCykBixaI76kAACr7cHj6JEN_a2AkEpMI4HkZGWG0JnCqZkydE2kfceTUd-pP22WGrHs60GjudxqXJPsI90ESRgnEUGmuXiI5VgPtS_v89gz7KsuRr6RElEpCzvTqNDGXjy8OX7Zi59gzgqCzdmHhL_CD_-QqTiA, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641906997, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=172.30.0.12, kc-type=Bearer, kc-cc--team-ID=x, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.30.0.1, http-session-id=05F2E7BD562B29A2F61C7F26C268EF98, http-session-last-accessed-time=1641906724620, kc-category-name=ACCESS, kc-iat=1641906697, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.30.0.1:55088 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 13:12:04.700  INFO 17 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 13:12:04.714  INFO 17 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@22708039
2022-01-11 13:12:04.719  INFO 17 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@22708039
2022-01-11 13:12:04.730  INFO 17 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@22708039
2022-01-11 13:12:04.735  INFO 17 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@22708039
2022-01-11 13:12:04.798  INFO 17 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@22708039
2022-01-11 13:12:04.804  WARN 17 --- [https-jsse-nio-7071-exec-7] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: x
2022-01-11 13:12:04.808  WARN 17 --- [https-jsse-nio-7071-exec-7] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: x
2022-01-11 13:12:04.816  INFO 17 --- [https-jsse-nio-7071-exec-7] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-5905553420275-476523, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-11 13:12:04.820  INFO 17 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=e705a204-9769-4bce-9865-a67dc91562cc, content=DENY, timestamp=1641906724820, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-11 13:12:04.826  INFO 17 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=117ms, Total=137ms
2022-01-11 13:12:04.906  INFO 17 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=d7dd8539-94dc-43be-80dc-3bc63ebbd79f, content=null, timestamp=1641906724882, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=55092, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=9462ddf72b74, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.30.0.1, kc-session-state=115df91e-55fd-4d89-b568-03753c55dee3, http-req-server-port=80, http-header-accept=*/*, kc-id=faa49035-39a2-47eb-9400-cb93a9fe6d10, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641906724879, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd2DNXNxAH4AEQAAAABh3YIJdAAkZmFhNDkwMzUtMzlhMi00N2ViLTk0MDAtY2I5M2E5ZmU2ZDEwdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAXh4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQxMTVkZjkxZS01NWZkLTRkODktYjU2OC0wMzc1M2M1NWRlZTNwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAATaHR0cDovLzE5Mi4xNjguMS44M3hwcHNyAC9vcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2VuJEFjY2VzcwewcQ/lekULAgACTAAFcm9sZXNxAH4AAUwADHZlcmlmeUNhbGxlcnEAfgAKeHBzcQB+ACt3DAAAABA/QAAAAAAABHQADm9mZmxpbmVfYWNjZXNzdAAGbWVtYmVydAAFYWRtaW50ABF1bWFfYXV0aG9yaXphdGlvbnhwc3IAF2phdmEudXRpbC5MaW5rZWRIYXNoTWFwNMBOXBBswPsCAAFaAAthY2Nlc3NPcmRlcnhxAH4AGD9AAAAAAAAMdwgAAAAQAAAAAXQAB2FjY291bnRzcQB+AC5zcQB+ACt3DAAAABA/QAAAAAAAA3QADm1hbmFnZS1hY2NvdW50dAAUbWFuYWdlLWFjY291bnQtbGlua3N0AAx2aWV3LXByb2ZpbGV4cHgAdAANcHJvZmlsZSBlbWFpbHA=, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJFeUZNQnpQUXV6VFFHUzhnWjYwVjJ1LXZxUE4zYm55MFVJSm1HaUpwS2pFIn0.eyJleHAiOjE2NDE5MDY5OTcsImlhdCI6MTY0MTkwNjY5NywianRpIjoiZmFhNDkwMzUtMzlhMi00N2ViLTk0MDAtY2I5M2E5ZmU2ZDEwIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiMTE1ZGY5MWUtNTVmZC00ZDg5LWI1NjgtMDM3NTNjNTVkZWUzIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoieCJ9.RP4jVdLa2GKR1jEUG_Ofs1jSfGSuf9hAaf2-j4R2AHCcLlwOZHQfjtGK56y9rw6Mc7yt4IuTEGT3_0YWpF73nJ5N36X7TcZC0389FvX0FvP5331H4S5EVmOJ7FyGpOHtmkLRXz4dfExVXoNmkyd6BrqB07pTnpObzqEyYxOX88fWlUjDk6RWTDWCykBixaI76kAACr7cHj6JEN_a2AkEpMI4HkZGWG0JnCqZkydE2kfceTUd-pP22WGrHs60GjudxqXJPsI90ESRgnEUGmuXiI5VgPtS_v89gz7KsuRr6RElEpCzvTqNDGXjy8OX7Zi59gzgqCzdmHhL_CD_-QqTiA, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641906997, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=172.30.0.12, kc-type=Bearer, kc-cc--team-ID=x, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.30.0.1, http-session-id=E7356195DED2B58F4C89535B58E64B74, http-session-last-accessed-time=1641906724879, kc-category-name=ACCESS, kc-iat=1641906697, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.30.0.1:55092 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 13:12:04.910  INFO 17 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 13:12:04.915  INFO 17 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@622e0f30
2022-01-11 13:12:04.917  INFO 17 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@622e0f30
2022-01-11 13:12:04.948  INFO 17 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@622e0f30
2022-01-11 13:12:04.953  INFO 17 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@622e0f30
2022-01-11 13:12:04.981  INFO 17 --- [https-jsse-nio-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@622e0f30
2022-01-11 13:12:04.984  WARN 17 --- [https-jsse-nio-7071-exec-10] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: x
2022-01-11 13:12:04.987  WARN 17 --- [https-jsse-nio-7071-exec-10] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: x
2022-01-11 13:12:04.989  INFO 17 --- [https-jsse-nio-7071-exec-10] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-5905796858975-114154, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-11 13:12:04.991  INFO 17 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=d7dd8539-94dc-43be-80dc-3bc63ebbd79f, content=DENY, timestamp=1641906724991, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-11 13:12:04.995  INFO 17 --- [https-jsse-nio-7071-exec-10] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=78ms, Total=91ms
2022-01-11 13:12:05.059  INFO 17 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=48306f59-13e0-4806-b8c1-17af533b87bf, content=null, timestamp=1641906725046, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=55094, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=9462ddf72b74, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.30.0.1, kc-session-state=115df91e-55fd-4d89-b568-03753c55dee3, http-req-server-port=80, http-header-accept=*/*, kc-id=faa49035-39a2-47eb-9400-cb93a9fe6d10, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641906725037, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd2DNXNxAH4AEQAAAABh3YIJdAAkZmFhNDkwMzUtMzlhMi00N2ViLTk0MDAtY2I5M2E5ZmU2ZDEwdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAXh4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQxMTVkZjkxZS01NWZkLTRkODktYjU2OC0wMzc1M2M1NWRlZTNwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAATaHR0cDovLzE5Mi4xNjguMS44M3hwcHNyAC9vcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2VuJEFjY2VzcwewcQ/lekULAgACTAAFcm9sZXNxAH4AAUwADHZlcmlmeUNhbGxlcnEAfgAKeHBzcQB+ACt3DAAAABA/QAAAAAAABHQADm9mZmxpbmVfYWNjZXNzdAAGbWVtYmVydAAFYWRtaW50ABF1bWFfYXV0aG9yaXphdGlvbnhwc3IAF2phdmEudXRpbC5MaW5rZWRIYXNoTWFwNMBOXBBswPsCAAFaAAthY2Nlc3NPcmRlcnhxAH4AGD9AAAAAAAAMdwgAAAAQAAAAAXQAB2FjY291bnRzcQB+AC5zcQB+ACt3DAAAABA/QAAAAAAAA3QADm1hbmFnZS1hY2NvdW50dAAUbWFuYWdlLWFjY291bnQtbGlua3N0AAx2aWV3LXByb2ZpbGV4cHgAdAANcHJvZmlsZSBlbWFpbHA=, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJFeUZNQnpQUXV6VFFHUzhnWjYwVjJ1LXZxUE4zYm55MFVJSm1HaUpwS2pFIn0.eyJleHAiOjE2NDE5MDY5OTcsImlhdCI6MTY0MTkwNjY5NywianRpIjoiZmFhNDkwMzUtMzlhMi00N2ViLTk0MDAtY2I5M2E5ZmU2ZDEwIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiMTE1ZGY5MWUtNTVmZC00ZDg5LWI1NjgtMDM3NTNjNTVkZWUzIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoieCJ9.RP4jVdLa2GKR1jEUG_Ofs1jSfGSuf9hAaf2-j4R2AHCcLlwOZHQfjtGK56y9rw6Mc7yt4IuTEGT3_0YWpF73nJ5N36X7TcZC0389FvX0FvP5331H4S5EVmOJ7FyGpOHtmkLRXz4dfExVXoNmkyd6BrqB07pTnpObzqEyYxOX88fWlUjDk6RWTDWCykBixaI76kAACr7cHj6JEN_a2AkEpMI4HkZGWG0JnCqZkydE2kfceTUd-pP22WGrHs60GjudxqXJPsI90ESRgnEUGmuXiI5VgPtS_v89gz7KsuRr6RElEpCzvTqNDGXjy8OX7Zi59gzgqCzdmHhL_CD_-QqTiA, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641906997, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=172.30.0.12, kc-type=Bearer, kc-cc--team-ID=x, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.30.0.1, http-session-id=0F633B1408513F77789685AB7ACE749B, http-session-last-accessed-time=1641906725037, kc-category-name=ACCESS, kc-iat=1641906697, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.30.0.1:55094 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 13:12:05.072  INFO 17 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 13:12:05.086  INFO 17 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@11bbfe45
2022-01-11 13:12:05.090  INFO 17 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@11bbfe45
2022-01-11 13:12:05.125  INFO 17 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@11bbfe45
2022-01-11 13:12:05.130  INFO 17 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@11bbfe45
2022-01-11 13:12:05.164  INFO 17 --- [https-jsse-nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@11bbfe45
2022-01-11 13:12:05.170  WARN 17 --- [https-jsse-nio-7071-exec-1] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: x
2022-01-11 13:12:05.173  WARN 17 --- [https-jsse-nio-7071-exec-1] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: x
2022-01-11 13:12:05.176  INFO 17 --- [https-jsse-nio-7071-exec-1] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-5905963422275-297025, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-11 13:12:05.179  INFO 17 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=48306f59-13e0-4806-b8c1-17af533b87bf, content=DENY, timestamp=1641906725179, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-11 13:12:05.185  INFO 17 --- [https-jsse-nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=100ms, Total=129ms
2022-01-11 13:12:05.230  INFO 17 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=56f50934-0109-43a0-bf67-afcbd8b66d62, content=null, timestamp=1641906725221, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=55096, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=9462ddf72b74, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.30.0.1, kc-session-state=115df91e-55fd-4d89-b568-03753c55dee3, http-req-server-port=80, http-header-accept=*/*, kc-id=faa49035-39a2-47eb-9400-cb93a9fe6d10, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641906725218, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd2DNXNxAH4AEQAAAABh3YIJdAAkZmFhNDkwMzUtMzlhMi00N2ViLTk0MDAtY2I5M2E5ZmU2ZDEwdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAXh4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQxMTVkZjkxZS01NWZkLTRkODktYjU2OC0wMzc1M2M1NWRlZTNwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAATaHR0cDovLzE5Mi4xNjguMS44M3hwcHNyAC9vcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2VuJEFjY2VzcwewcQ/lekULAgACTAAFcm9sZXNxAH4AAUwADHZlcmlmeUNhbGxlcnEAfgAKeHBzcQB+ACt3DAAAABA/QAAAAAAABHQADm9mZmxpbmVfYWNjZXNzdAAGbWVtYmVydAAFYWRtaW50ABF1bWFfYXV0aG9yaXphdGlvbnhwc3IAF2phdmEudXRpbC5MaW5rZWRIYXNoTWFwNMBOXBBswPsCAAFaAAthY2Nlc3NPcmRlcnhxAH4AGD9AAAAAAAAMdwgAAAAQAAAAAXQAB2FjY291bnRzcQB+AC5zcQB+ACt3DAAAABA/QAAAAAAAA3QADm1hbmFnZS1hY2NvdW50dAAUbWFuYWdlLWFjY291bnQtbGlua3N0AAx2aWV3LXByb2ZpbGV4cHgAdAANcHJvZmlsZSBlbWFpbHA=, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJFeUZNQnpQUXV6VFFHUzhnWjYwVjJ1LXZxUE4zYm55MFVJSm1HaUpwS2pFIn0.eyJleHAiOjE2NDE5MDY5OTcsImlhdCI6MTY0MTkwNjY5NywianRpIjoiZmFhNDkwMzUtMzlhMi00N2ViLTk0MDAtY2I5M2E5ZmU2ZDEwIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiMTE1ZGY5MWUtNTVmZC00ZDg5LWI1NjgtMDM3NTNjNTVkZWUzIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoieCJ9.RP4jVdLa2GKR1jEUG_Ofs1jSfGSuf9hAaf2-j4R2AHCcLlwOZHQfjtGK56y9rw6Mc7yt4IuTEGT3_0YWpF73nJ5N36X7TcZC0389FvX0FvP5331H4S5EVmOJ7FyGpOHtmkLRXz4dfExVXoNmkyd6BrqB07pTnpObzqEyYxOX88fWlUjDk6RWTDWCykBixaI76kAACr7cHj6JEN_a2AkEpMI4HkZGWG0JnCqZkydE2kfceTUd-pP22WGrHs60GjudxqXJPsI90ESRgnEUGmuXiI5VgPtS_v89gz7KsuRr6RElEpCzvTqNDGXjy8OX7Zi59gzgqCzdmHhL_CD_-QqTiA, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641906997, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=172.30.0.12, kc-type=Bearer, kc-cc--team-ID=x, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.30.0.1, http-session-id=5EC89559AF0B77E04959ED9B7A7504DA, http-session-last-accessed-time=1641906725218, kc-category-name=ACCESS, kc-iat=1641906697, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.30.0.1:55096 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 13:12:05.235  INFO 17 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 13:12:05.249  INFO 17 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5c9f2e0d
2022-01-11 13:12:05.254  INFO 17 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5c9f2e0d
2022-01-11 13:12:05.297  INFO 17 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5c9f2e0d
2022-01-11 13:12:05.302  INFO 17 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5c9f2e0d
2022-01-11 13:12:05.374  INFO 17 --- [https-jsse-nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5c9f2e0d
2022-01-11 13:12:05.378  WARN 17 --- [https-jsse-nio-7071-exec-2] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: x
2022-01-11 13:12:05.380  WARN 17 --- [https-jsse-nio-7071-exec-2] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: x
2022-01-11 13:12:05.388  INFO 17 --- [https-jsse-nio-7071-exec-2] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-5906123270475-810970, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-11 13:12:05.398  INFO 17 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=56f50934-0109-43a0-bf67-afcbd8b66d62, content=DENY, timestamp=1641906725398, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-11 13:12:05.403  INFO 17 --- [https-jsse-nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=159ms, Total=175ms
2022-01-11 13:12:05.468  INFO 17 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=f5a23426-4ed7-41b5-aa39-3f60164a9378, content=null, timestamp=1641906725455, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=55098, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=9462ddf72b74, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.30.0.1, kc-session-state=115df91e-55fd-4d89-b568-03753c55dee3, http-req-server-port=80, http-header-accept=*/*, kc-id=faa49035-39a2-47eb-9400-cb93a9fe6d10, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641906725451, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd2DNXNxAH4AEQAAAABh3YIJdAAkZmFhNDkwMzUtMzlhMi00N2ViLTk0MDAtY2I5M2E5ZmU2ZDEwdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAXh4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQxMTVkZjkxZS01NWZkLTRkODktYjU2OC0wMzc1M2M1NWRlZTNwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAATaHR0cDovLzE5Mi4xNjguMS44M3hwcHNyAC9vcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2VuJEFjY2VzcwewcQ/lekULAgACTAAFcm9sZXNxAH4AAUwADHZlcmlmeUNhbGxlcnEAfgAKeHBzcQB+ACt3DAAAABA/QAAAAAAABHQADm9mZmxpbmVfYWNjZXNzdAAGbWVtYmVydAAFYWRtaW50ABF1bWFfYXV0aG9yaXphdGlvbnhwc3IAF2phdmEudXRpbC5MaW5rZWRIYXNoTWFwNMBOXBBswPsCAAFaAAthY2Nlc3NPcmRlcnhxAH4AGD9AAAAAAAAMdwgAAAAQAAAAAXQAB2FjY291bnRzcQB+AC5zcQB+ACt3DAAAABA/QAAAAAAAA3QADm1hbmFnZS1hY2NvdW50dAAUbWFuYWdlLWFjY291bnQtbGlua3N0AAx2aWV3LXByb2ZpbGV4cHgAdAANcHJvZmlsZSBlbWFpbHA=, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJFeUZNQnpQUXV6VFFHUzhnWjYwVjJ1LXZxUE4zYm55MFVJSm1HaUpwS2pFIn0.eyJleHAiOjE2NDE5MDY5OTcsImlhdCI6MTY0MTkwNjY5NywianRpIjoiZmFhNDkwMzUtMzlhMi00N2ViLTk0MDAtY2I5M2E5ZmU2ZDEwIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiMTE1ZGY5MWUtNTVmZC00ZDg5LWI1NjgtMDM3NTNjNTVkZWUzIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoieCJ9.RP4jVdLa2GKR1jEUG_Ofs1jSfGSuf9hAaf2-j4R2AHCcLlwOZHQfjtGK56y9rw6Mc7yt4IuTEGT3_0YWpF73nJ5N36X7TcZC0389FvX0FvP5331H4S5EVmOJ7FyGpOHtmkLRXz4dfExVXoNmkyd6BrqB07pTnpObzqEyYxOX88fWlUjDk6RWTDWCykBixaI76kAACr7cHj6JEN_a2AkEpMI4HkZGWG0JnCqZkydE2kfceTUd-pP22WGrHs60GjudxqXJPsI90ESRgnEUGmuXiI5VgPtS_v89gz7KsuRr6RElEpCzvTqNDGXjy8OX7Zi59gzgqCzdmHhL_CD_-QqTiA, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641906997, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=172.30.0.12, kc-type=Bearer, kc-cc--team-ID=x, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.30.0.1, http-session-id=06D8C81518A4342792EA5A73302B3EFD, http-session-last-accessed-time=1641906725451, kc-category-name=ACCESS, kc-iat=1641906697, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.30.0.1:55098 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 13:12:05.485  INFO 17 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 13:12:05.497  INFO 17 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7aea470
2022-01-11 13:12:05.500  INFO 17 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7aea470
2022-01-11 13:12:05.550  INFO 17 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7aea470
2022-01-11 13:12:05.554  INFO 17 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7aea470
2022-01-11 13:12:05.597  INFO 17 --- [https-jsse-nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7aea470
2022-01-11 13:12:05.604  WARN 17 --- [https-jsse-nio-7071-exec-3] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: x
2022-01-11 13:12:05.607  WARN 17 --- [https-jsse-nio-7071-exec-3] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: x
2022-01-11 13:12:05.613  INFO 17 --- [https-jsse-nio-7071-exec-3] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-5906375335475-545704, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-11 13:12:05.616  INFO 17 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=f5a23426-4ed7-41b5-aa39-3f60164a9378, content=DENY, timestamp=1641906725616, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-11 13:12:05.620  INFO 17 --- [https-jsse-nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=125ms, Total=154ms
2022-01-11 13:12:05.687  INFO 17 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=372a3dc5-caa9-4290-9a4b-bc6f224e684d, content=null, timestamp=1641906725671, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=55100, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=9462ddf72b74, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.30.0.1, kc-session-state=115df91e-55fd-4d89-b568-03753c55dee3, http-req-server-port=80, http-header-accept=*/*, kc-id=faa49035-39a2-47eb-9400-cb93a9fe6d10, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641906725664, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd2DNXNxAH4AEQAAAABh3YIJdAAkZmFhNDkwMzUtMzlhMi00N2ViLTk0MDAtY2I5M2E5ZmU2ZDEwdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAXh4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQxMTVkZjkxZS01NWZkLTRkODktYjU2OC0wMzc1M2M1NWRlZTNwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAATaHR0cDovLzE5Mi4xNjguMS44M3hwcHNyAC9vcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2VuJEFjY2VzcwewcQ/lekULAgACTAAFcm9sZXNxAH4AAUwADHZlcmlmeUNhbGxlcnEAfgAKeHBzcQB+ACt3DAAAABA/QAAAAAAABHQADm9mZmxpbmVfYWNjZXNzdAAGbWVtYmVydAAFYWRtaW50ABF1bWFfYXV0aG9yaXphdGlvbnhwc3IAF2phdmEudXRpbC5MaW5rZWRIYXNoTWFwNMBOXBBswPsCAAFaAAthY2Nlc3NPcmRlcnhxAH4AGD9AAAAAAAAMdwgAAAAQAAAAAXQAB2FjY291bnRzcQB+AC5zcQB+ACt3DAAAABA/QAAAAAAAA3QADm1hbmFnZS1hY2NvdW50dAAUbWFuYWdlLWFjY291bnQtbGlua3N0AAx2aWV3LXByb2ZpbGV4cHgAdAANcHJvZmlsZSBlbWFpbHA=, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJFeUZNQnpQUXV6VFFHUzhnWjYwVjJ1LXZxUE4zYm55MFVJSm1HaUpwS2pFIn0.eyJleHAiOjE2NDE5MDY5OTcsImlhdCI6MTY0MTkwNjY5NywianRpIjoiZmFhNDkwMzUtMzlhMi00N2ViLTk0MDAtY2I5M2E5ZmU2ZDEwIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiMTE1ZGY5MWUtNTVmZC00ZDg5LWI1NjgtMDM3NTNjNTVkZWUzIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoieCJ9.RP4jVdLa2GKR1jEUG_Ofs1jSfGSuf9hAaf2-j4R2AHCcLlwOZHQfjtGK56y9rw6Mc7yt4IuTEGT3_0YWpF73nJ5N36X7TcZC0389FvX0FvP5331H4S5EVmOJ7FyGpOHtmkLRXz4dfExVXoNmkyd6BrqB07pTnpObzqEyYxOX88fWlUjDk6RWTDWCykBixaI76kAACr7cHj6JEN_a2AkEpMI4HkZGWG0JnCqZkydE2kfceTUd-pP22WGrHs60GjudxqXJPsI90ESRgnEUGmuXiI5VgPtS_v89gz7KsuRr6RElEpCzvTqNDGXjy8OX7Zi59gzgqCzdmHhL_CD_-QqTiA, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641906997, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=172.30.0.12, kc-type=Bearer, kc-cc--team-ID=x, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.30.0.1, http-session-id=5FB0BB2F7F5958592CD955177C35B755, http-session-last-accessed-time=1641906725664, kc-category-name=ACCESS, kc-iat=1641906697, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.30.0.1:55100 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 13:12:05.703  INFO 17 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 13:12:05.708  INFO 17 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@72cc464c
2022-01-11 13:12:05.719  INFO 17 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@72cc464c
2022-01-11 13:12:05.801  INFO 17 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@72cc464c
2022-01-11 13:12:05.805  INFO 17 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@72cc464c
2022-01-11 13:12:05.854  INFO 17 --- [https-jsse-nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@72cc464c
2022-01-11 13:12:05.859  WARN 17 --- [https-jsse-nio-7071-exec-4] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: x
2022-01-11 13:12:05.861  WARN 17 --- [https-jsse-nio-7071-exec-4] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: x
2022-01-11 13:12:05.869  INFO 17 --- [https-jsse-nio-7071-exec-4] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-5906589340475-136935, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-11 13:12:05.873  INFO 17 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=372a3dc5-caa9-4290-9a4b-bc6f224e684d, content=DENY, timestamp=1641906725873, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-11 13:12:05.880  INFO 17 --- [https-jsse-nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=168ms, Total=195ms
2022-01-11 13:12:05.950  INFO 17 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=c4d1c29b-a592-43e8-8577-cfdd7e167e78, content=null, timestamp=1641906725935, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=55102, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=9462ddf72b74, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.30.0.1, kc-session-state=115df91e-55fd-4d89-b568-03753c55dee3, http-req-server-port=80, http-header-accept=*/*, kc-id=faa49035-39a2-47eb-9400-cb93a9fe6d10, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641906725933, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd2DNXNxAH4AEQAAAABh3YIJdAAkZmFhNDkwMzUtMzlhMi00N2ViLTk0MDAtY2I5M2E5ZmU2ZDEwdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAXh4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQxMTVkZjkxZS01NWZkLTRkODktYjU2OC0wMzc1M2M1NWRlZTNwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAATaHR0cDovLzE5Mi4xNjguMS44M3hwcHNyAC9vcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2VuJEFjY2VzcwewcQ/lekULAgACTAAFcm9sZXNxAH4AAUwADHZlcmlmeUNhbGxlcnEAfgAKeHBzcQB+ACt3DAAAABA/QAAAAAAABHQADm9mZmxpbmVfYWNjZXNzdAAGbWVtYmVydAAFYWRtaW50ABF1bWFfYXV0aG9yaXphdGlvbnhwc3IAF2phdmEudXRpbC5MaW5rZWRIYXNoTWFwNMBOXBBswPsCAAFaAAthY2Nlc3NPcmRlcnhxAH4AGD9AAAAAAAAMdwgAAAAQAAAAAXQAB2FjY291bnRzcQB+AC5zcQB+ACt3DAAAABA/QAAAAAAAA3QADm1hbmFnZS1hY2NvdW50dAAUbWFuYWdlLWFjY291bnQtbGlua3N0AAx2aWV3LXByb2ZpbGV4cHgAdAANcHJvZmlsZSBlbWFpbHA=, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJFeUZNQnpQUXV6VFFHUzhnWjYwVjJ1LXZxUE4zYm55MFVJSm1HaUpwS2pFIn0.eyJleHAiOjE2NDE5MDY5OTcsImlhdCI6MTY0MTkwNjY5NywianRpIjoiZmFhNDkwMzUtMzlhMi00N2ViLTk0MDAtY2I5M2E5ZmU2ZDEwIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiMTE1ZGY5MWUtNTVmZC00ZDg5LWI1NjgtMDM3NTNjNTVkZWUzIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoieCJ9.RP4jVdLa2GKR1jEUG_Ofs1jSfGSuf9hAaf2-j4R2AHCcLlwOZHQfjtGK56y9rw6Mc7yt4IuTEGT3_0YWpF73nJ5N36X7TcZC0389FvX0FvP5331H4S5EVmOJ7FyGpOHtmkLRXz4dfExVXoNmkyd6BrqB07pTnpObzqEyYxOX88fWlUjDk6RWTDWCykBixaI76kAACr7cHj6JEN_a2AkEpMI4HkZGWG0JnCqZkydE2kfceTUd-pP22WGrHs60GjudxqXJPsI90ESRgnEUGmuXiI5VgPtS_v89gz7KsuRr6RElEpCzvTqNDGXjy8OX7Zi59gzgqCzdmHhL_CD_-QqTiA, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641906997, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=172.30.0.12, kc-type=Bearer, kc-cc--team-ID=x, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.30.0.1, http-session-id=34C5A83F6982E71A9A4C5E53B988C9E3, http-session-last-accessed-time=1641906725933, kc-category-name=ACCESS, kc-iat=1641906697, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.30.0.1:55102 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 13:12:05.958  INFO 17 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 13:12:05.969  INFO 17 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@65dff6ee
2022-01-11 13:12:05.974  INFO 17 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@65dff6ee
2022-01-11 13:12:06.022  INFO 17 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@65dff6ee
2022-01-11 13:12:06.026  INFO 17 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@65dff6ee
2022-01-11 13:12:06.108  INFO 17 --- [https-jsse-nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@65dff6ee
2022-01-11 13:12:06.113  WARN 17 --- [https-jsse-nio-7071-exec-5] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: x
2022-01-11 13:12:06.117  WARN 17 --- [https-jsse-nio-7071-exec-5] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: x
2022-01-11 13:12:06.121  INFO 17 --- [https-jsse-nio-7071-exec-5] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-5906849719075-718195, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-11 13:12:06.126  INFO 17 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=c4d1c29b-a592-43e8-8577-cfdd7e167e78, content=DENY, timestamp=1641906726126, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-11 13:12:06.129  INFO 17 --- [https-jsse-nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=160ms, Total=183ms
2022-01-11 13:12:06.203  INFO 17 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=508140c7-65e3-4441-b30a-3cbcc79b55c2, content=null, timestamp=1641906726161, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=55104, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=9462ddf72b74, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.30.0.1, kc-session-state=115df91e-55fd-4d89-b568-03753c55dee3, http-req-server-port=80, http-header-accept=*/*, kc-id=faa49035-39a2-47eb-9400-cb93a9fe6d10, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641906726154, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd2DNXNxAH4AEQAAAABh3YIJdAAkZmFhNDkwMzUtMzlhMi00N2ViLTk0MDAtY2I5M2E5ZmU2ZDEwdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAXh4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQxMTVkZjkxZS01NWZkLTRkODktYjU2OC0wMzc1M2M1NWRlZTNwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAATaHR0cDovLzE5Mi4xNjguMS44M3hwcHNyAC9vcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2VuJEFjY2VzcwewcQ/lekULAgACTAAFcm9sZXNxAH4AAUwADHZlcmlmeUNhbGxlcnEAfgAKeHBzcQB+ACt3DAAAABA/QAAAAAAABHQADm9mZmxpbmVfYWNjZXNzdAAGbWVtYmVydAAFYWRtaW50ABF1bWFfYXV0aG9yaXphdGlvbnhwc3IAF2phdmEudXRpbC5MaW5rZWRIYXNoTWFwNMBOXBBswPsCAAFaAAthY2Nlc3NPcmRlcnhxAH4AGD9AAAAAAAAMdwgAAAAQAAAAAXQAB2FjY291bnRzcQB+AC5zcQB+ACt3DAAAABA/QAAAAAAAA3QADm1hbmFnZS1hY2NvdW50dAAUbWFuYWdlLWFjY291bnQtbGlua3N0AAx2aWV3LXByb2ZpbGV4cHgAdAANcHJvZmlsZSBlbWFpbHA=, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJFeUZNQnpQUXV6VFFHUzhnWjYwVjJ1LXZxUE4zYm55MFVJSm1HaUpwS2pFIn0.eyJleHAiOjE2NDE5MDY5OTcsImlhdCI6MTY0MTkwNjY5NywianRpIjoiZmFhNDkwMzUtMzlhMi00N2ViLTk0MDAtY2I5M2E5ZmU2ZDEwIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiMTE1ZGY5MWUtNTVmZC00ZDg5LWI1NjgtMDM3NTNjNTVkZWUzIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoieCJ9.RP4jVdLa2GKR1jEUG_Ofs1jSfGSuf9hAaf2-j4R2AHCcLlwOZHQfjtGK56y9rw6Mc7yt4IuTEGT3_0YWpF73nJ5N36X7TcZC0389FvX0FvP5331H4S5EVmOJ7FyGpOHtmkLRXz4dfExVXoNmkyd6BrqB07pTnpObzqEyYxOX88fWlUjDk6RWTDWCykBixaI76kAACr7cHj6JEN_a2AkEpMI4HkZGWG0JnCqZkydE2kfceTUd-pP22WGrHs60GjudxqXJPsI90ESRgnEUGmuXiI5VgPtS_v89gz7KsuRr6RElEpCzvTqNDGXjy8OX7Zi59gzgqCzdmHhL_CD_-QqTiA, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641906997, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=172.30.0.12, kc-type=Bearer, kc-cc--team-ID=x, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.30.0.1, http-session-id=E94C22B06EA18FA4F03B8477ED970F07, http-session-last-accessed-time=1641906726154, kc-category-name=ACCESS, kc-iat=1641906697, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.30.0.1:55104 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 13:12:06.213  INFO 17 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 13:12:06.220  INFO 17 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1c652494
2022-01-11 13:12:06.224  INFO 17 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1c652494
2022-01-11 13:12:06.255  INFO 17 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1c652494
2022-01-11 13:12:06.262  INFO 17 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1c652494
2022-01-11 13:12:06.282  INFO 17 --- [https-jsse-nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1c652494
2022-01-11 13:12:06.286  WARN 17 --- [https-jsse-nio-7071-exec-6] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: x
2022-01-11 13:12:06.288  WARN 17 --- [https-jsse-nio-7071-exec-6] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: x
2022-01-11 13:12:06.291  INFO 17 --- [https-jsse-nio-7071-exec-6] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-5907099867575-659546, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-11 13:12:06.294  INFO 17 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=508140c7-65e3-4441-b30a-3cbcc79b55c2, content=DENY, timestamp=1641906726294, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-11 13:12:06.301  INFO 17 --- [https-jsse-nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=78ms, Total=127ms
2022-01-11 13:12:06.355  INFO 17 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=5249498c-6e87-4d72-9bac-e089f27b8a87, content=null, timestamp=1641906726347, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=55106, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=9462ddf72b74, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.30.0.1, kc-session-state=115df91e-55fd-4d89-b568-03753c55dee3, http-req-server-port=80, http-header-accept=*/*, kc-id=faa49035-39a2-47eb-9400-cb93a9fe6d10, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641906726344, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd2DNXNxAH4AEQAAAABh3YIJdAAkZmFhNDkwMzUtMzlhMi00N2ViLTk0MDAtY2I5M2E5ZmU2ZDEwdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAXh4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQxMTVkZjkxZS01NWZkLTRkODktYjU2OC0wMzc1M2M1NWRlZTNwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAATaHR0cDovLzE5Mi4xNjguMS44M3hwcHNyAC9vcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2VuJEFjY2VzcwewcQ/lekULAgACTAAFcm9sZXNxAH4AAUwADHZlcmlmeUNhbGxlcnEAfgAKeHBzcQB+ACt3DAAAABA/QAAAAAAABHQADm9mZmxpbmVfYWNjZXNzdAAGbWVtYmVydAAFYWRtaW50ABF1bWFfYXV0aG9yaXphdGlvbnhwc3IAF2phdmEudXRpbC5MaW5rZWRIYXNoTWFwNMBOXBBswPsCAAFaAAthY2Nlc3NPcmRlcnhxAH4AGD9AAAAAAAAMdwgAAAAQAAAAAXQAB2FjY291bnRzcQB+AC5zcQB+ACt3DAAAABA/QAAAAAAAA3QADm1hbmFnZS1hY2NvdW50dAAUbWFuYWdlLWFjY291bnQtbGlua3N0AAx2aWV3LXByb2ZpbGV4cHgAdAANcHJvZmlsZSBlbWFpbHA=, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJFeUZNQnpQUXV6VFFHUzhnWjYwVjJ1LXZxUE4zYm55MFVJSm1HaUpwS2pFIn0.eyJleHAiOjE2NDE5MDY5OTcsImlhdCI6MTY0MTkwNjY5NywianRpIjoiZmFhNDkwMzUtMzlhMi00N2ViLTk0MDAtY2I5M2E5ZmU2ZDEwIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiMTE1ZGY5MWUtNTVmZC00ZDg5LWI1NjgtMDM3NTNjNTVkZWUzIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoieCJ9.RP4jVdLa2GKR1jEUG_Ofs1jSfGSuf9hAaf2-j4R2AHCcLlwOZHQfjtGK56y9rw6Mc7yt4IuTEGT3_0YWpF73nJ5N36X7TcZC0389FvX0FvP5331H4S5EVmOJ7FyGpOHtmkLRXz4dfExVXoNmkyd6BrqB07pTnpObzqEyYxOX88fWlUjDk6RWTDWCykBixaI76kAACr7cHj6JEN_a2AkEpMI4HkZGWG0JnCqZkydE2kfceTUd-pP22WGrHs60GjudxqXJPsI90ESRgnEUGmuXiI5VgPtS_v89gz7KsuRr6RElEpCzvTqNDGXjy8OX7Zi59gzgqCzdmHhL_CD_-QqTiA, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641906997, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=172.30.0.12, kc-type=Bearer, kc-cc--team-ID=x, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.30.0.1, http-session-id=FB6B90CC40FE7BF570BA421B557EAFEB, http-session-last-accessed-time=1641906726344, kc-category-name=ACCESS, kc-iat=1641906697, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.30.0.1:55106 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 13:12:06.360  INFO 17 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 13:12:06.372  INFO 17 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@17d88aa9
2022-01-11 13:12:06.375  INFO 17 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@17d88aa9
2022-01-11 13:12:06.424  INFO 17 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@17d88aa9
2022-01-11 13:12:06.431  INFO 17 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@17d88aa9
2022-01-11 13:12:06.474  INFO 17 --- [https-jsse-nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@17d88aa9
2022-01-11 13:12:06.477  WARN 17 --- [https-jsse-nio-7071-exec-8] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: x
2022-01-11 13:12:06.480  WARN 17 --- [https-jsse-nio-7071-exec-8] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: x
2022-01-11 13:12:06.488  INFO 17 --- [https-jsse-nio-7071-exec-8] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-5907251133475-821053, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-11 13:12:06.492  INFO 17 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=5249498c-6e87-4d72-9bac-e089f27b8a87, content=DENY, timestamp=1641906726492, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-11 13:12:06.496  INFO 17 --- [https-jsse-nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=125ms, Total=141ms
2022-01-11 13:12:06.545  INFO 17 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=e2c43dd1-d6f7-484a-84ba-bb98ae2f6e6a, content=null, timestamp=1641906726533, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=55108, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=9462ddf72b74, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.30.0.1, kc-session-state=115df91e-55fd-4d89-b568-03753c55dee3, http-req-server-port=80, http-header-accept=*/*, kc-id=faa49035-39a2-47eb-9400-cb93a9fe6d10, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641906726527, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd2DNXNxAH4AEQAAAABh3YIJdAAkZmFhNDkwMzUtMzlhMi00N2ViLTk0MDAtY2I5M2E5ZmU2ZDEwdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAXh4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQxMTVkZjkxZS01NWZkLTRkODktYjU2OC0wMzc1M2M1NWRlZTNwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAATaHR0cDovLzE5Mi4xNjguMS44M3hwcHNyAC9vcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2VuJEFjY2VzcwewcQ/lekULAgACTAAFcm9sZXNxAH4AAUwADHZlcmlmeUNhbGxlcnEAfgAKeHBzcQB+ACt3DAAAABA/QAAAAAAABHQADm9mZmxpbmVfYWNjZXNzdAAGbWVtYmVydAAFYWRtaW50ABF1bWFfYXV0aG9yaXphdGlvbnhwc3IAF2phdmEudXRpbC5MaW5rZWRIYXNoTWFwNMBOXBBswPsCAAFaAAthY2Nlc3NPcmRlcnhxAH4AGD9AAAAAAAAMdwgAAAAQAAAAAXQAB2FjY291bnRzcQB+AC5zcQB+ACt3DAAAABA/QAAAAAAAA3QADm1hbmFnZS1hY2NvdW50dAAUbWFuYWdlLWFjY291bnQtbGlua3N0AAx2aWV3LXByb2ZpbGV4cHgAdAANcHJvZmlsZSBlbWFpbHA=, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJFeUZNQnpQUXV6VFFHUzhnWjYwVjJ1LXZxUE4zYm55MFVJSm1HaUpwS2pFIn0.eyJleHAiOjE2NDE5MDY5OTcsImlhdCI6MTY0MTkwNjY5NywianRpIjoiZmFhNDkwMzUtMzlhMi00N2ViLTk0MDAtY2I5M2E5ZmU2ZDEwIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiMTE1ZGY5MWUtNTVmZC00ZDg5LWI1NjgtMDM3NTNjNTVkZWUzIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoieCJ9.RP4jVdLa2GKR1jEUG_Ofs1jSfGSuf9hAaf2-j4R2AHCcLlwOZHQfjtGK56y9rw6Mc7yt4IuTEGT3_0YWpF73nJ5N36X7TcZC0389FvX0FvP5331H4S5EVmOJ7FyGpOHtmkLRXz4dfExVXoNmkyd6BrqB07pTnpObzqEyYxOX88fWlUjDk6RWTDWCykBixaI76kAACr7cHj6JEN_a2AkEpMI4HkZGWG0JnCqZkydE2kfceTUd-pP22WGrHs60GjudxqXJPsI90ESRgnEUGmuXiI5VgPtS_v89gz7KsuRr6RElEpCzvTqNDGXjy8OX7Zi59gzgqCzdmHhL_CD_-QqTiA, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641906997, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=172.30.0.12, kc-type=Bearer, kc-cc--team-ID=x, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.30.0.1, http-session-id=B7CB71D094F27CB354AB4E7543E12DD9, http-session-last-accessed-time=1641906726527, kc-category-name=ACCESS, kc-iat=1641906697, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.30.0.1:55108 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 13:12:06.550  INFO 17 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 13:12:06.563  INFO 17 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@746c6134
2022-01-11 13:12:06.568  INFO 17 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@746c6134
2022-01-11 13:12:06.614  INFO 17 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@746c6134
2022-01-11 13:12:06.618  INFO 17 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@746c6134
2022-01-11 13:12:06.684  INFO 17 --- [https-jsse-nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@746c6134
2022-01-11 13:12:06.687  WARN 17 --- [https-jsse-nio-7071-exec-9] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: x
2022-01-11 13:12:06.691  WARN 17 --- [https-jsse-nio-7071-exec-9] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: x
2022-01-11 13:12:06.696  INFO 17 --- [https-jsse-nio-7071-exec-9] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-5907436691075-170652, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-11 13:12:06.701  INFO 17 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=e2c43dd1-d6f7-484a-84ba-bb98ae2f6e6a, content=DENY, timestamp=1641906726701, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-11 13:12:06.706  INFO 17 --- [https-jsse-nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=149ms, Total=162ms
2022-01-11 13:12:06.771  INFO 17 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=480f4051-3ca7-475b-a596-9865df061994, content=null, timestamp=1641906726746, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=55110, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=9462ddf72b74, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-session-valid=false, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.30.0.1, kc-session-state=115df91e-55fd-4d89-b568-03753c55dee3, http-req-server-port=80, http-header-accept=*/*, kc-id=faa49035-39a2-47eb-9400-cb93a9fe6d10, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1641906726745, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYd2DNXNxAH4AEQAAAABh3YIJdAAkZmFhNDkwMzUtMzlhMi00N2ViLTk0MDAtY2I5M2E5ZmU2ZDEwdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAXh4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAAGQmVhcmVycHQAATFwcHBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQxMTVkZjkxZS01NWZkLTRkODktYjU2OC0wMzc1M2M1NWRlZTNwcHBwc3IAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAATaHR0cDovLzE5Mi4xNjguMS44M3hwcHNyAC9vcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2VuJEFjY2VzcwewcQ/lekULAgACTAAFcm9sZXNxAH4AAUwADHZlcmlmeUNhbGxlcnEAfgAKeHBzcQB+ACt3DAAAABA/QAAAAAAABHQADm9mZmxpbmVfYWNjZXNzdAAGbWVtYmVydAAFYWRtaW50ABF1bWFfYXV0aG9yaXphdGlvbnhwc3IAF2phdmEudXRpbC5MaW5rZWRIYXNoTWFwNMBOXBBswPsCAAFaAAthY2Nlc3NPcmRlcnhxAH4AGD9AAAAAAAAMdwgAAAAQAAAAAXQAB2FjY291bnRzcQB+AC5zcQB+ACt3DAAAABA/QAAAAAAAA3QADm1hbmFnZS1hY2NvdW50dAAUbWFuYWdlLWFjY291bnQtbGlua3N0AAx2aWV3LXByb2ZpbGV4cHgAdAANcHJvZmlsZSBlbWFpbHA=, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJFeUZNQnpQUXV6VFFHUzhnWjYwVjJ1LXZxUE4zYm55MFVJSm1HaUpwS2pFIn0.eyJleHAiOjE2NDE5MDY5OTcsImlhdCI6MTY0MTkwNjY5NywianRpIjoiZmFhNDkwMzUtMzlhMi00N2ViLTk0MDAtY2I5M2E5ZmU2ZDEwIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiMTE1ZGY5MWUtNTVmZC00ZDg5LWI1NjgtMDM3NTNjNTVkZWUzIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoieCJ9.RP4jVdLa2GKR1jEUG_Ofs1jSfGSuf9hAaf2-j4R2AHCcLlwOZHQfjtGK56y9rw6Mc7yt4IuTEGT3_0YWpF73nJ5N36X7TcZC0389FvX0FvP5331H4S5EVmOJ7FyGpOHtmkLRXz4dfExVXoNmkyd6BrqB07pTnpObzqEyYxOX88fWlUjDk6RWTDWCykBixaI76kAACr7cHj6JEN_a2AkEpMI4HkZGWG0JnCqZkydE2kfceTUd-pP22WGrHs60GjudxqXJPsI90ESRgnEUGmuXiI5VgPtS_v89gz7KsuRr6RElEpCzvTqNDGXjy8OX7Zi59gzgqCzdmHhL_CD_-QqTiA, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1641906997, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-req-local-address=172.30.0.12, kc-type=Bearer, kc-cc--team-ID=x, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.30.0.1, http-session-id=52FF9866F8D05CF6822E97C8C7DAF00B, http-session-last-accessed-time=1641906726745, kc-category-name=ACCESS, kc-iat=1641906697, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.30.0.1:55110 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2022-01-11 13:12:06.781  INFO 17 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Request context extracted
2022-01-11 13:12:06.797  INFO 17 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@11918830
2022-01-11 13:12:06.810  INFO 17 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@11918830
2022-01-11 13:12:06.854  INFO 17 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@11918830
2022-01-11 13:12:06.861  INFO 17 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@11918830
2022-01-11 13:12:06.900  INFO 17 --- [https-jsse-nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@11918830
2022-01-11 13:12:06.910  WARN 17 --- [https-jsse-nio-7071-exec-7] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: x
2022-01-11 13:12:06.913  WARN 17 --- [https-jsse-nio-7071-exec-7] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: x
2022-01-11 13:12:06.917  INFO 17 --- [https-jsse-nio-7071-exec-7] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-5907678731175-647615, decision=DENY, pdp-result=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}})
2022-01-11 13:12:06.922  INFO 17 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=480f4051-3ca7-475b-a596-9865df061994, content=DENY, timestamp=1641906726922, pdpResult=PdpResult(decision=DENY, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:user-belongs-to-team:deny={asclepios:obligation:type=Rule, asclepios:obligation:id=user-belongs-to-team, asclepios:obligation:parent=Read-AC-ABAC-policy, asclepios:obligation:name=Rule 2 - User belongs to a Team, asclepios:obligation:decision=DENY}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:deny={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=DENY}}))
2022-01-11 13:12:06.926  INFO 17 --- [https-jsse-nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=128ms, Total=157ms
