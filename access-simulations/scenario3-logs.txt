*** ABAC Authorization Server ***

Config. Dir.: ./config
Policies Dir: ./policies

No configuration file found. Copying default configuration and keystores.
Any existing files will not be altered.
'samples/config/authorization-server.properties' -> './config/authorization-server.properties'
'samples/config/balana.cfg.xml' -> './config/balana.cfg.xml'

External Lib. path: /abac-server/ext/abac-example-context-handlers-1.0.0-SNAPSHOT-jar-with-dependencies.jar
Monitoring: ./policies/*.xml  Polling every 5s...

  .   ____          _            __ _ _
 /\\ / ___'_ __ _ _(_)_ __  __ _ \ \ \ \
( ( )\___ | '_ | '_| | '_ \/ _` | \ \ \ \
 \\/  ___)| |_)| | | | | || (_| |  ) ) ) )
  '  |____| .__|_| |_|_| |_\__, | / / / /
 =========|_|==============|___/=/_/_/_/
 :: Spring Boot ::        (v2.3.7.RELEASE)

2021-12-29 21:11:37.052  INFO 14 --- [           main] .a.a.a.s.AuthorizationServiceApplication : Starting AuthorizationServiceApplication v2.0.0-SNAPSHOT on 7282badde740 with PID 14 (/abac-server/abac-authorization-server-exec.jar started by root in /abac-server)
2021-12-29 21:11:37.121  INFO 14 --- [           main] .a.a.a.s.AuthorizationServiceApplication : No active profile set, falling back to default profiles: default
2021-12-29 21:11:59.559  INFO 14 --- [           main] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2021-12-29 21:12:02.426  INFO 14 --- [           main] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 2442ms. Found 3 JPA repository interfaces.
2021-12-29 21:12:25.377  INFO 14 --- [           main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port(s): 7071 (https)
2021-12-29 21:12:25.523  INFO 14 --- [           main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2021-12-29 21:12:25.531  INFO 14 --- [           main] org.apache.catalina.core.StandardEngine  : Starting Servlet engine: [Apache Tomcat/9.0.41]
2021-12-29 21:12:26.967  INFO 14 --- [           main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2021-12-29 21:12:26.989  INFO 14 --- [           main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 48261 ms
2021-12-29 21:12:28.296  INFO 14 --- [           main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
2021-12-29 21:12:28.368  WARN 14 --- [           main] com.zaxxer.hikari.util.DriverDataSource  : Registered driver with driverClassName=com.mysql.jdbc.Driver was not found, trying direct instantiation.
2021-12-29 21:12:33.212  INFO 14 --- [           main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
2021-12-29 21:12:33.380  INFO 14 --- [           main] o.s.b.a.h2.H2ConsoleAutoConfiguration    : H2 console available at '/h2-console'. Database available at 'jdbc:mysql://mysql:3306/apam_db?createDatabaseIfNotExist=true'
2021-12-29 21:12:37.080  INFO 14 --- [           main] o.hibernate.jpa.internal.util.LogHelper  : HHH000204: Processing PersistenceUnitInfo [name: default]
2021-12-29 21:12:38.640  INFO 14 --- [           main] org.hibernate.Version                    : HHH000412: Hibernate ORM core version 5.4.25.Final
2021-12-29 21:12:41.022  INFO 14 --- [           main] o.hibernate.annotations.common.Version   : HCANN000001: Hibernate Commons Annotations {5.1.2.Final}
2021-12-29 21:12:42.574  INFO 14 --- [           main] org.hibernate.dialect.Dialect            : HHH000400: Using dialect: org.hibernate.dialect.MySQL5InnoDBDialect
2021-12-29 21:12:51.359  INFO 14 --- [           main] o.h.e.t.j.p.i.JtaPlatformInitiator       : HHH000490: Using JtaPlatform implementation: [org.hibernate.engine.transaction.jta.platform.internal.NoJtaPlatform]
2021-12-29 21:12:51.509  INFO 14 --- [           main] j.LocalContainerEntityManagerFactoryBean : Initialized JPA EntityManagerFactory for persistence unit 'default'
2021-12-29 21:13:02.534  INFO 14 --- [           main] e.a.a.abac.server.pap.PapProperties      : ABAC Policies directory: ./config/../policies
2021-12-29 21:13:02.547  INFO 14 --- [           main] e.a.a.abac.server.pap.PapProperties      : ABE Policies directory: ./config/../policies
2021-12-29 21:13:03.639  INFO 14 --- [           main] e.a.a.abac.server.pdp.DirectoryWatcher   : Policy dir. watcher initialized
2021-12-29 21:13:03.644  INFO 14 --- [           main] e.a.a.a.s.pdp.AuthorizationServicePDP    : Initializing PDP...
2021-12-29 21:13:03.657  INFO 14 --- [           main] e.a.a.a.s.pdp.AuthorizationServicePDP    : Getting policy files from: ./config/../policies
2021-12-29 21:13:03.719  INFO 14 --- [           main] e.a.a.a.s.pdp.AuthorizationServicePDP    : Policy files found: 2
2021-12-29 21:13:05.851  INFO 14 --- [           main] org.wso2.balana.ConfigurationStore       : Loading runtime configuration
2021-12-29 21:13:07.540  INFO 14 --- [           main] e.a.a.a.s.pdp.AuthorizationServicePDP    : Configured attribute finder module classes: [eu.asclepios.authorization.abac.server.pdp.finder.LoggingAttributeFinderModule, eu.asclepios.authorization.abac.server.pdp.finder.WeekdayAttributeFinderModule, eu.asclepios.authorization.abac.server.pdp.finder.IpAddressAttributeFinderModule, eu.asclepios.authorization.abac.server.pdp.finder.DeviceAttributeFinderModule, eu.asclepios.authorization.abac.server.pdp.finder.GeolocationAttributeFinderModule, eu.asclepios.authorization.abac.server.pdp.finder.KeycloackAttributeFinderModule, eu.asclepios.authorization.abac.server.pdp.finder.NoopAttributeFinderModule, eu.asclepios.example.contexthandlers.CustomDbAttributeFinder, eu.asclepios.example.contexthandlers.CustomRestAttributeFinder]
2021-12-29 21:13:07.560  INFO 14 --- [           main] e.a.a.a.s.pdp.AuthorizationServicePDP    :   Instantiating attribute finder module: eu.asclepios.authorization.abac.server.pdp.finder.LoggingAttributeFinderModule@1080b026
2021-12-29 21:13:07.572  INFO 14 --- [           main] e.a.a.a.s.pdp.AuthorizationServicePDP    :   Instantiating attribute finder module: eu.asclepios.authorization.abac.server.pdp.finder.WeekdayAttributeFinderModule@58ebfd03
2021-12-29 21:13:07.581  INFO 14 --- [           main] e.a.a.a.s.pdp.AuthorizationServicePDP    :   Instantiating attribute finder module: eu.asclepios.authorization.abac.server.pdp.finder.IpAddressAttributeFinderModule@5b07730f
2021-12-29 21:13:07.587  INFO 14 --- [           main] e.a.a.a.s.pdp.AuthorizationServicePDP    :   Instantiating attribute finder module: eu.asclepios.authorization.abac.server.pdp.finder.DeviceAttributeFinderModule@1fdfafd2
2021-12-29 21:13:08.001  INFO 14 --- [           main] e.a.a.a.s.pdp.AuthorizationServicePDP    :   Instantiating attribute finder module: eu.asclepios.authorization.abac.server.pdp.finder.GeolocationAttributeFinderModule@a4b2d8f
2021-12-29 21:13:08.010  INFO 14 --- [           main] e.a.a.a.s.pdp.AuthorizationServicePDP    :   Instantiating attribute finder module: eu.asclepios.authorization.abac.server.pdp.finder.KeycloackAttributeFinderModule@dcfda20
2021-12-29 21:13:08.025  INFO 14 --- [           main] e.a.a.a.s.pdp.AuthorizationServicePDP    :   Instantiating attribute finder module: eu.asclepios.authorization.abac.server.pdp.finder.NoopAttributeFinderModule@6d304f9d
2021-12-29 21:13:08.060  INFO 14 --- [           main] e.a.e.c.CustomDbAttributeFinder          : CustomDbAttributeFinder: DB settings: url=jdbc:mysql://mysql:3306/keycloak, driver=com.mysql.jdbc.Driver, username=keycloak
2021-12-29 21:13:08.222  INFO 14 --- [           main] e.a.e.c.CustomDbAttributeFinder          : CustomDbAttributeFinder: Processing entry: 12345:600000:ambulance-crew-id-1234
2021-12-29 21:13:08.241  INFO 14 --- [           main] e.a.e.c.CustomDbAttributeFinder          : CustomDbAttributeFinder: Processing entry:  23456:600000:ambulance-crew-id-2345
2021-12-29 21:13:08.253  INFO 14 --- [           main] e.a.e.c.CustomDbAttributeFinder          : CustomDbAttributeFinder: Processing entry:  34567:600000:ambulance-crew-id-3456
2021-12-29 21:13:08.301  INFO 14 --- [           main] e.a.e.c.CustomDbAttributeFinder          : CustomDbAttributeFinder: Added 3 entries in DB
2021-12-29 21:13:08.301  INFO 14 --- [           main] e.a.a.a.s.pdp.AuthorizationServicePDP    :   Instantiating attribute finder module: eu.asclepios.example.contexthandlers.CustomDbAttributeFinder@40499e4f
2021-12-29 21:13:08.546  INFO 14 --- [           main] e.a.e.c.CustomRestAttributeFinder        : CustomRestAttributeFinder: REST URL template: http://django-rest:8000/attribute-provider/getinfov2?ES-ID={{es-id}}&format=json&patient-ID={{patient-id}}&user-ID={{user-id}}
2021-12-29 21:13:09.269  INFO 14 --- [           main] e.a.a.a.s.pdp.AuthorizationServicePDP    :   Instantiating attribute finder module: eu.asclepios.example.contexthandlers.CustomRestAttributeFinder@42a9e5d1
2021-12-29 21:13:09.615  INFO 14 --- [           main] e.a.a.a.s.pdp.AuthorizationServicePDP    : PDP initialized
2021-12-29 21:13:09.781  INFO 14 --- [           main] e.a.a.abac.server.PdpServerController    : Authorization Service configuration: AuthorizationServiceProperties(pdp=AuthorizationServiceProperties.PdpConfig(enable=true, balanaConfigFile=./config/balana.cfg.xml, policiesDir=./config/../policies, policiesExtension=.xml, restartPollingInterval=1000, accessKey=7235687126587231675321756752657236156321765723, attributeFinderClasses=[eu.asclepios.authorization.abac.server.pdp.finder.LoggingAttributeFinderModule, eu.asclepios.authorization.abac.server.pdp.finder.WeekdayAttributeFinderModule, eu.asclepios.authorization.abac.server.pdp.finder.IpAddressAttributeFinderModule, eu.asclepios.authorization.abac.server.pdp.finder.DeviceAttributeFinderModule, eu.asclepios.authorization.abac.server.pdp.finder.GeolocationAttributeFinderModule, eu.asclepios.authorization.abac.server.pdp.finder.KeycloackAttributeFinderModule, eu.asclepios.authorization.abac.server.pdp.finder.NoopAttributeFinderModule, eu.asclepios.example.contexthandlers.CustomDbAttributeFinder, eu.asclepios.example.contexthandlers.CustomRestAttributeFinder]), context=null, pip=[], requestContext=null)
2021-12-29 21:13:09.807  INFO 14 --- [           main] e.a.a.abac.server.PdpServerController    : Server-side request context extraction: false
2021-12-29 21:13:10.659  WARN 14 --- [           main] JpaBaseConfiguration$JpaWebConfiguration : spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2021-12-29 21:13:15.916  INFO 14 --- [           main] e.a.a.abac.server.util.WebMvcConfig      : Using API Key authentication in PDP
2021-12-29 21:13:16.105  INFO 14 --- [           main] e.a.a.abac.server.util.WebMvcConfig      : Using API Key authentication in PAP
2021-12-29 21:13:22.409  INFO 14 --- [           main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port(s): 7071 (https) with context path ''
2021-12-29 21:13:22.557  INFO 14 --- [           main] .a.a.a.s.AuthorizationServiceApplication : Started AuthorizationServiceApplication in 116.654 seconds (JVM running for 126.923)
2021-12-29 21:16:05.022  INFO 14 --- [nio-7071-exec-6] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring DispatcherServlet 'dispatcherServlet'
2021-12-29 21:16:05.027  INFO 14 --- [nio-7071-exec-6] o.s.web.servlet.DispatcherServlet        : Initializing Servlet 'dispatcherServlet'
2021-12-29 21:16:05.125  INFO 14 --- [nio-7071-exec-6] o.s.web.servlet.DispatcherServlet        : Completed initialization in 97 ms
2021-12-29 21:16:05.924  INFO 14 --- [nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=2c059ebe-7760-4aad-aafd-3942f6153291, content=null, timestamp=1640812563640, xacmlRequest={http-header-referer=http://192.168.1.83/rest/acute-care-demo/call-centre/read?ES-ID=10&format=json&patient-ID=100&user-ID=10, http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=9E8C08A9DA29EA6811766C53F823DF88, http-req-remote-port=62582, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-param-upload=upload, http-req-local-name=b9c70ccf9dc9, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-cookie-jsessionid=47B79C3808BFF3C91AF876643E6CA177, http-session-valid=true, http-req-content-length=98, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.31.0.1, kc-session-state=5aaaaf61-c3a3-48a9-b85b-5a471e16272a, http-req-server-port=80, http-header-accept=text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8, kc-id=88112c40-dd74-4bd8-a7e2-26292baa101f, http-cookie-oauth_token_request_state=f45a9fa7-0c21-445a-a76e-e82fb345f839, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=application/x-www-form-urlencoded;charset=UTF-8, http-header-host=192.168.1.83, http-session-creation-time=1640812488526, kc-id-token=rO0ABXNyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAA2FjcnEAfgABTAAHYWRkcmVzc3QALkxvcmcva2V5Y2xvYWsvcmVwcmVzZW50YXRpb25zL0FkZHJlc3NDbGFpbVNldDtMAAlhdXRoX3RpbWV0ABBMamF2YS9sYW5nL0xvbmc7TAAJYmlydGhkYXRlcQB+AAFMAA1jbGFpbXNMb2NhbGVzcQB+AAFMAAhjb2RlSGFzaHEAfgABTAAFZW1haWxxAH4AAUwADWVtYWlsVmVyaWZpZWR0ABNMamF2YS9sYW5nL0Jvb2xlYW47TAAKZmFtaWx5TmFtZXEAfgABTAAGZ2VuZGVycQB+AAFMAAlnaXZlbk5hbWVxAH4AAUwABmxvY2FsZXEAfgABTAAKbWlkZGxlTmFtZXEAfgABTAAEbmFtZXEAfgABTAAIbmlja05hbWVxAH4AAUwABW5vbmNlcQB+AAFMAAtwaG9uZU51bWJlcnEAfgABTAATcGhvbmVOdW1iZXJWZXJpZmllZHEAfgAETAAHcGljdHVyZXEAfgABTAARcHJlZmVycmVkVXNlcm5hbWVxAH4AAUwAB3Byb2ZpbGVxAH4AAUwADHNlc3Npb25TdGF0ZXEAfgABTAAJc3RhdGVIYXNocQB+AAFMAAl1cGRhdGVkQXRxAH4AA0wAB3dlYnNpdGVxAH4AAUwACHpvbmVpbmZvcQB+AAF4cgApb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5Kc29uV2ViVG9rZW6Cc0CQZNbg6gIAClsACGF1ZGllbmNldAATW0xqYXZhL2xhbmcvU3RyaW5nO0wAA2V4cHEAfgADTAADaWF0cQB+AANMAAJpZHEAfgABTAAJaXNzdWVkRm9ycQB+AAFMAAZpc3N1ZXJxAH4AAUwAA25iZnEAfgADTAALb3RoZXJDbGFpbXN0AA9MamF2YS91dGlsL01hcDtMAAdzdWJqZWN0cQB+AAFMAAR0eXBlcQB+AAF4cHVyABNbTGphdmEubGFuZy5TdHJpbmc7rdJW5+kde0cCAAB4cAAAAAF0AA1jYWxscy1nYXRld2F5c3IADmphdmEubGFuZy5Mb25nO4vkkMyPI98CAAFKAAV2YWx1ZXhyABBqYXZhLmxhbmcuTnVtYmVyhqyVHQuU4IsCAAB4cAAAAABhzNE9c3EAfgAMAAAAAGHM0BF0ACQ4ODExMmM0MC1kZDc0LTRiZDgtYTdlMi0yNjI5MmJhYTEwMWZ0AA1jYWxscy1nYXRld2F5dAA2aHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAACSURwdAABMXBzcQB+AAwAAAAAYczQEXBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ1YWFhYWY2MS1jM2EzLTQ4YTktYjg1Yi01YTQ3MWUxNjI3MmFwcHBw, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1640812861, http-header-upgrade-insecure-requests=1, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-param-csrfmiddlewaretoken=jloAPGwpIO5vXBQphCWdBQiGY9unEsYrFJff7KlQNSaLMJfDHBV2wzC2uBuvgmbp, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/14.1.1 Safari/605.1.15, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, http-header-accept-language=pt-br, http-cookie-csrftoken=5yQ1zZRimgYY62m2wQtsjEi7XLpVcEAdrWHGR3GJrk3eVaLgWPshenCttdp3OyNb, kc-preferred-username=user1, http-header-content-length=98, http-req-local-address=172.31.0.11, kc-type=ID, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-header-content-type=application/x-www-form-urlencoded, http-param-es-id=10, http-header-cookie=csrftoken=5yQ1zZRimgYY62m2wQtsjEi7XLpVcEAdrWHGR3GJrk3eVaLgWPshenCttdp3OyNb; JSESSIONID=47B79C3808BFF3C91AF876643E6CA177; OAuth_Token_Request_State=f45a9fa7-0c21-445a-a76e-e82fb345f839, kc-email-verified=false, http-req-remote-host=172.31.0.1, http-session-id=9E8C08A9DA29EA6811766C53F823DF88, http-session-last-accessed-time=1640812562896, kc-auth-time=1640812561, kc-category-name=ID, kc-iat=1640812561, http-header-origin=http://192.168.1.83, kc-category-ordinal=2, http-param-patient-id=100, user.identifier=172.31.0.1:62582 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2021-12-29 21:16:05.931  INFO 14 --- [nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Request context extracted
2021-12-29 21:16:05.966  INFO 14 --- [nio-7071-exec-6] e.a.a.abac.server.util.AttributeUtil     : XACML Attribute Categories:
{urn:oasis:names:tc:xacml:1.0:environment:current-date=urn:oasis:names:tc:xacml:3.0:attribute-category:environment, urn:oasis:names:tc:xacml:1.0:environment:current-dateTime=urn:oasis:names:tc:xacml:3.0:attribute-category:environment, actionId=urn:oasis:names:tc:xacml:3.0:attribute-category:action, user.identifier=urn:oasis:names:tc:xacml:1.0:subject-category:access-subject, urn:oasis:names:tc:xacml:1.0:environment:current-time=urn:oasis:names:tc:xacml:3.0:attribute-category:environment, request-id=urn:oasis:names:tc:xacml:3.0:attribute-category:environment, resource-id=urn:oasis:names:tc:xacml:3.0:attribute-category:resource}
2021-12-29 21:16:05.971  INFO 14 --- [nio-7071-exec-6] e.a.a.abac.server.util.AttributeUtil     : XACML Attribute Data Types:
{urn:oasis:names:tc:xacml:1.0:environment:current-date=http://www.w3.org/2001/XMLSchema#date, urn:oasis:names:tc:xacml:1.0:environment:current-dateTime=http://www.w3.org/2001/XMLSchema#dateTime, actionId=http://www.w3.org/2001/XMLSchema#string, user.identifier=http://www.w3.org/2001/XMLSchema#string, urn:oasis:names:tc:xacml:1.0:environment:current-time=http://www.w3.org/2001/XMLSchema#time, request-id=http://www.w3.org/2001/XMLSchema#string, resource-id=http://www.w3.org/2001/XMLSchema#string}
2021-12-29 21:16:06.178  INFO 14 --- [nio-7071-exec-6] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-7393987432740-224960, decision=NOT_APPLICABLE, pdp-result=PdpResult(decision=NOT_APPLICABLE, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={})
2021-12-29 21:16:06.191  INFO 14 --- [nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=2c059ebe-7760-4aad-aafd-3942f6153291, content=NOT_APPLICABLE, timestamp=1640812566191, pdpResult=PdpResult(decision=NOT_APPLICABLE, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={}))
2021-12-29 21:16:16.157  INFO 14 --- [nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=c3286be6-6cf8-4404-a805-ed119be9af3d, content=null, timestamp=1640812575484, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-session-max-inactive-interval=1800, http-req-requested-session-id=9E8C08A9DA29EA6811766C53F823DF88, http-req-remote-port=62590, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=b9c70ccf9dc9, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-cookie-jsessionid=9E8C08A9DA29EA6811766C53F823DF88, http-session-valid=true, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.31.0.1, kc-session-state=5aaaaf61-c3a3-48a9-b85b-5a471e16272a, http-req-server-port=80, http-header-accept=text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8, kc-id=88112c40-dd74-4bd8-a7e2-26292baa101f, http-cookie-oauth_token_request_state=cf9b39b5-9935-4c48-a8bd-f77f2ce607cd, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1640812488526, kc-id-token=rO0ABXNyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAA2FjcnEAfgABTAAHYWRkcmVzc3QALkxvcmcva2V5Y2xvYWsvcmVwcmVzZW50YXRpb25zL0FkZHJlc3NDbGFpbVNldDtMAAlhdXRoX3RpbWV0ABBMamF2YS9sYW5nL0xvbmc7TAAJYmlydGhkYXRlcQB+AAFMAA1jbGFpbXNMb2NhbGVzcQB+AAFMAAhjb2RlSGFzaHEAfgABTAAFZW1haWxxAH4AAUwADWVtYWlsVmVyaWZpZWR0ABNMamF2YS9sYW5nL0Jvb2xlYW47TAAKZmFtaWx5TmFtZXEAfgABTAAGZ2VuZGVycQB+AAFMAAlnaXZlbk5hbWVxAH4AAUwABmxvY2FsZXEAfgABTAAKbWlkZGxlTmFtZXEAfgABTAAEbmFtZXEAfgABTAAIbmlja05hbWVxAH4AAUwABW5vbmNlcQB+AAFMAAtwaG9uZU51bWJlcnEAfgABTAATcGhvbmVOdW1iZXJWZXJpZmllZHEAfgAETAAHcGljdHVyZXEAfgABTAARcHJlZmVycmVkVXNlcm5hbWVxAH4AAUwAB3Byb2ZpbGVxAH4AAUwADHNlc3Npb25TdGF0ZXEAfgABTAAJc3RhdGVIYXNocQB+AAFMAAl1cGRhdGVkQXRxAH4AA0wAB3dlYnNpdGVxAH4AAUwACHpvbmVpbmZvcQB+AAF4cgApb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5Kc29uV2ViVG9rZW6Cc0CQZNbg6gIAClsACGF1ZGllbmNldAATW0xqYXZhL2xhbmcvU3RyaW5nO0wAA2V4cHEAfgADTAADaWF0cQB+AANMAAJpZHEAfgABTAAJaXNzdWVkRm9ycQB+AAFMAAZpc3N1ZXJxAH4AAUwAA25iZnEAfgADTAALb3RoZXJDbGFpbXN0AA9MamF2YS91dGlsL01hcDtMAAdzdWJqZWN0cQB+AAFMAAR0eXBlcQB+AAF4cHVyABNbTGphdmEubGFuZy5TdHJpbmc7rdJW5+kde0cCAAB4cAAAAAF0AA1jYWxscy1nYXRld2F5c3IADmphdmEubGFuZy5Mb25nO4vkkMyPI98CAAFKAAV2YWx1ZXhyABBqYXZhLmxhbmcuTnVtYmVyhqyVHQuU4IsCAAB4cAAAAABhzNE9c3EAfgAMAAAAAGHM0BF0ACQ4ODExMmM0MC1kZDc0LTRiZDgtYTdlMi0yNjI5MmJhYTEwMWZ0AA1jYWxscy1nYXRld2F5dAA2aHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAACSURwdAABMXBzcQB+AAwAAAAAYczQEXBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ1YWFhYWY2MS1jM2EzLTQ4YTktYjg1Yi01YTQ3MWUxNjI3MmFwcHBw, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1640812861, http-header-upgrade-insecure-requests=1, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/14.1.1 Safari/605.1.15, http-req-query-string=null, http-req-scheme=http, http-header-accept-language=pt-br, http-cookie-csrftoken=5yQ1zZRimgYY62m2wQtsjEi7XLpVcEAdrWHGR3GJrk3eVaLgWPshenCttdp3OyNb, kc-preferred-username=user1, http-req-local-address=172.31.0.11, kc-type=ID, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-header-cookie=JSESSIONID=9E8C08A9DA29EA6811766C53F823DF88; OAuth_Token_Request_State=cf9b39b5-9935-4c48-a8bd-f77f2ce607cd; csrftoken=5yQ1zZRimgYY62m2wQtsjEi7XLpVcEAdrWHGR3GJrk3eVaLgWPshenCttdp3OyNb, kc-email-verified=false, http-req-remote-host=172.31.0.1, http-session-id=9E8C08A9DA29EA6811766C53F823DF88, http-session-last-accessed-time=1640812567057, kc-auth-time=1640812561, kc-category-name=ID, kc-iat=1640812561, kc-category-ordinal=2, user.identifier=172.31.0.1:62590 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2021-12-29 21:16:16.160  INFO 14 --- [nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Request context extracted
2021-12-29 21:16:16.180  INFO 14 --- [nio-7071-exec-7] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-7404212164340-25844, decision=PERMIT, pdp-result=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={})
2021-12-29 21:16:16.182  INFO 14 --- [nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=c3286be6-6cf8-4404-a805-ed119be9af3d, content=PERMIT, timestamp=1640812576182, pdpResult=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={}))
2021-12-29 21:16:20.102  INFO 14 --- [nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=5f0a64fc-881f-49db-9720-88d6d1f3ac65, content=null, timestamp=1640812580057, xacmlRequest={http-header-accept-encoding=gzip, deflate, http-header-referer=http://192.168.1.83/rest/acute-care-demo/call-centre, kc-acr=1, kc-is-expired=false, http-session-max-inactive-interval=1800, http-req-requested-session-id=9E8C08A9DA29EA6811766C53F823DF88, http-req-remote-port=62582, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-param-upload=upload, http-req-local-name=b9c70ccf9dc9, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-cookie-jsessionid=9E8C08A9DA29EA6811766C53F823DF88, http-session-valid=true, http-req-content-length=98, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.31.0.1, kc-session-state=5aaaaf61-c3a3-48a9-b85b-5a471e16272a, http-req-server-port=80, http-header-accept=text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8, kc-id=88112c40-dd74-4bd8-a7e2-26292baa101f, http-cookie-oauth_token_request_state=cf9b39b5-9935-4c48-a8bd-f77f2ce607cd, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=application/x-www-form-urlencoded;charset=UTF-8, http-header-host=192.168.1.83, http-session-creation-time=1640812488526, kc-id-token=rO0ABXNyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAA2FjcnEAfgABTAAHYWRkcmVzc3QALkxvcmcva2V5Y2xvYWsvcmVwcmVzZW50YXRpb25zL0FkZHJlc3NDbGFpbVNldDtMAAlhdXRoX3RpbWV0ABBMamF2YS9sYW5nL0xvbmc7TAAJYmlydGhkYXRlcQB+AAFMAA1jbGFpbXNMb2NhbGVzcQB+AAFMAAhjb2RlSGFzaHEAfgABTAAFZW1haWxxAH4AAUwADWVtYWlsVmVyaWZpZWR0ABNMamF2YS9sYW5nL0Jvb2xlYW47TAAKZmFtaWx5TmFtZXEAfgABTAAGZ2VuZGVycQB+AAFMAAlnaXZlbk5hbWVxAH4AAUwABmxvY2FsZXEAfgABTAAKbWlkZGxlTmFtZXEAfgABTAAEbmFtZXEAfgABTAAIbmlja05hbWVxAH4AAUwABW5vbmNlcQB+AAFMAAtwaG9uZU51bWJlcnEAfgABTAATcGhvbmVOdW1iZXJWZXJpZmllZHEAfgAETAAHcGljdHVyZXEAfgABTAARcHJlZmVycmVkVXNlcm5hbWVxAH4AAUwAB3Byb2ZpbGVxAH4AAUwADHNlc3Npb25TdGF0ZXEAfgABTAAJc3RhdGVIYXNocQB+AAFMAAl1cGRhdGVkQXRxAH4AA0wAB3dlYnNpdGVxAH4AAUwACHpvbmVpbmZvcQB+AAF4cgApb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5Kc29uV2ViVG9rZW6Cc0CQZNbg6gIAClsACGF1ZGllbmNldAATW0xqYXZhL2xhbmcvU3RyaW5nO0wAA2V4cHEAfgADTAADaWF0cQB+AANMAAJpZHEAfgABTAAJaXNzdWVkRm9ycQB+AAFMAAZpc3N1ZXJxAH4AAUwAA25iZnEAfgADTAALb3RoZXJDbGFpbXN0AA9MamF2YS91dGlsL01hcDtMAAdzdWJqZWN0cQB+AAFMAAR0eXBlcQB+AAF4cHVyABNbTGphdmEubGFuZy5TdHJpbmc7rdJW5+kde0cCAAB4cAAAAAF0AA1jYWxscy1nYXRld2F5c3IADmphdmEubGFuZy5Mb25nO4vkkMyPI98CAAFKAAV2YWx1ZXhyABBqYXZhLmxhbmcuTnVtYmVyhqyVHQuU4IsCAAB4cAAAAABhzNE9c3EAfgAMAAAAAGHM0BF0ACQ4ODExMmM0MC1kZDc0LTRiZDgtYTdlMi0yNjI5MmJhYTEwMWZ0AA1jYWxscy1nYXRld2F5dAA2aHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAACSURwdAABMXBzcQB+AAwAAAAAYczQEXBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ1YWFhYWY2MS1jM2EzLTQ4YTktYjg1Yi01YTQ3MWUxNjI3MmFwcHBw, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1640812861, http-header-upgrade-insecure-requests=1, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-param-csrfmiddlewaretoken=ViMf1wm8ojvhsd35SzE7ao4UZqXQREOEhGDUjAbztnAxhlsjiyDW57ogvSXYty1C, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/14.1.1 Safari/605.1.15, http-req-query-string=null, http-req-scheme=http, http-header-accept-language=pt-br, http-cookie-csrftoken=5yQ1zZRimgYY62m2wQtsjEi7XLpVcEAdrWHGR3GJrk3eVaLgWPshenCttdp3OyNb, kc-preferred-username=user1, http-header-content-length=98, http-req-local-address=172.31.0.11, kc-type=ID, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-header-content-type=application/x-www-form-urlencoded, http-header-cookie=csrftoken=5yQ1zZRimgYY62m2wQtsjEi7XLpVcEAdrWHGR3GJrk3eVaLgWPshenCttdp3OyNb; JSESSIONID=9E8C08A9DA29EA6811766C53F823DF88; OAuth_Token_Request_State=cf9b39b5-9935-4c48-a8bd-f77f2ce607cd, kc-email-verified=false, http-req-remote-host=172.31.0.1, http-session-id=9E8C08A9DA29EA6811766C53F823DF88, http-session-last-accessed-time=1640812578017, kc-auth-time=1640812561, kc-category-name=ID, kc-iat=1640812561, http-header-origin=http://192.168.1.83, kc-category-ordinal=2, user.identifier=172.31.0.1:62582 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2021-12-29 21:16:20.102  INFO 14 --- [nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Request context extracted
2021-12-29 21:16:20.109  INFO 14 --- [nio-7071-exec-8] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-7408153724340-619561, decision=NOT_APPLICABLE, pdp-result=PdpResult(decision=NOT_APPLICABLE, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={})
2021-12-29 21:16:20.110  INFO 14 --- [nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=5f0a64fc-881f-49db-9720-88d6d1f3ac65, content=NOT_APPLICABLE, timestamp=1640812580110, pdpResult=PdpResult(decision=NOT_APPLICABLE, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={}))
2021-12-29 21:16:50.253  INFO 14 --- [cTaskExecutor-2] e.a.a.abac.server.pdp.DirectoryWatcher   :   Policy dir. watcher: ENTRY_CREATE: Update-AC-ABAC-policy.xml
2021-12-29 21:16:50.255  INFO 14 --- [cTaskExecutor-2] e.a.a.abac.server.pdp.DirectoryWatcher   :   Policy dir. watcher: ENTRY_MODIFY: Update-AC-ABAC-policy.xml
2021-12-29 21:16:50.312  INFO 14 --- [cTaskExecutor-1] e.a.a.a.s.pdp.AuthorizationServicePDP    : Getting policy files from: ./config/../policies
2021-12-29 21:16:50.352  INFO 14 --- [cTaskExecutor-1] e.a.a.a.s.pdp.AuthorizationServicePDP    : Policy files found: 3
2021-12-29 21:16:50.359  INFO 14 --- [cTaskExecutor-1] e.a.a.a.s.pdp.AuthorizationServicePDP    : Reloading policies...
2021-12-29 21:16:50.580  INFO 14 --- [cTaskExecutor-1] e.a.a.a.s.pdp.AuthorizationServicePDP    : Reloading policies... done
Policies changed...
2021-12-29 21:16:53.975  WARN 14 --- [ SIGHUP handler] e.a.a.a.s.pdp.AuthorizationServicePDP    : RECEIVED SIGNAL: SIGHUP
2021-12-29 21:16:53.979  INFO 14 --- [ SIGHUP handler] e.a.a.a.s.pdp.AuthorizationServicePDP    : Getting policy files from: ./config/../policies
2021-12-29 21:16:53.980  INFO 14 --- [ SIGHUP handler] e.a.a.a.s.pdp.AuthorizationServicePDP    : Policy files found: 3
2021-12-29 21:16:53.981  INFO 14 --- [ SIGHUP handler] e.a.a.a.s.pdp.AuthorizationServicePDP    : Reloading policies...
2021-12-29 21:16:54.544  INFO 14 --- [ SIGHUP handler] e.a.a.a.s.pdp.AuthorizationServicePDP    : Reloading policies... done
2021-12-29 21:16:58.473  INFO 14 --- [nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=9cd5bafc-731f-43e3-8222-1df1d913d6fb, content=null, timestamp=1640812618423, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-session-max-inactive-interval=1800, http-req-requested-session-id=9E8C08A9DA29EA6811766C53F823DF88, http-req-remote-port=62582, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=b9c70ccf9dc9, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-cookie-jsessionid=9E8C08A9DA29EA6811766C53F823DF88, http-session-valid=true, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.31.0.1, kc-session-state=5aaaaf61-c3a3-48a9-b85b-5a471e16272a, http-req-server-port=80, http-header-accept=text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8, kc-id=88112c40-dd74-4bd8-a7e2-26292baa101f, http-cookie-oauth_token_request_state=cf9b39b5-9935-4c48-a8bd-f77f2ce607cd, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1640812488526, kc-id-token=rO0ABXNyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAA2FjcnEAfgABTAAHYWRkcmVzc3QALkxvcmcva2V5Y2xvYWsvcmVwcmVzZW50YXRpb25zL0FkZHJlc3NDbGFpbVNldDtMAAlhdXRoX3RpbWV0ABBMamF2YS9sYW5nL0xvbmc7TAAJYmlydGhkYXRlcQB+AAFMAA1jbGFpbXNMb2NhbGVzcQB+AAFMAAhjb2RlSGFzaHEAfgABTAAFZW1haWxxAH4AAUwADWVtYWlsVmVyaWZpZWR0ABNMamF2YS9sYW5nL0Jvb2xlYW47TAAKZmFtaWx5TmFtZXEAfgABTAAGZ2VuZGVycQB+AAFMAAlnaXZlbk5hbWVxAH4AAUwABmxvY2FsZXEAfgABTAAKbWlkZGxlTmFtZXEAfgABTAAEbmFtZXEAfgABTAAIbmlja05hbWVxAH4AAUwABW5vbmNlcQB+AAFMAAtwaG9uZU51bWJlcnEAfgABTAATcGhvbmVOdW1iZXJWZXJpZmllZHEAfgAETAAHcGljdHVyZXEAfgABTAARcHJlZmVycmVkVXNlcm5hbWVxAH4AAUwAB3Byb2ZpbGVxAH4AAUwADHNlc3Npb25TdGF0ZXEAfgABTAAJc3RhdGVIYXNocQB+AAFMAAl1cGRhdGVkQXRxAH4AA0wAB3dlYnNpdGVxAH4AAUwACHpvbmVpbmZvcQB+AAF4cgApb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5Kc29uV2ViVG9rZW6Cc0CQZNbg6gIAClsACGF1ZGllbmNldAATW0xqYXZhL2xhbmcvU3RyaW5nO0wAA2V4cHEAfgADTAADaWF0cQB+AANMAAJpZHEAfgABTAAJaXNzdWVkRm9ycQB+AAFMAAZpc3N1ZXJxAH4AAUwAA25iZnEAfgADTAALb3RoZXJDbGFpbXN0AA9MamF2YS91dGlsL01hcDtMAAdzdWJqZWN0cQB+AAFMAAR0eXBlcQB+AAF4cHVyABNbTGphdmEubGFuZy5TdHJpbmc7rdJW5+kde0cCAAB4cAAAAAF0AA1jYWxscy1nYXRld2F5c3IADmphdmEubGFuZy5Mb25nO4vkkMyPI98CAAFKAAV2YWx1ZXhyABBqYXZhLmxhbmcuTnVtYmVyhqyVHQuU4IsCAAB4cAAAAABhzNE9c3EAfgAMAAAAAGHM0BF0ACQ4ODExMmM0MC1kZDc0LTRiZDgtYTdlMi0yNjI5MmJhYTEwMWZ0AA1jYWxscy1nYXRld2F5dAA2aHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAACSURwdAABMXBzcQB+AAwAAAAAYczQEXBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ1YWFhYWY2MS1jM2EzLTQ4YTktYjg1Yi01YTQ3MWUxNjI3MmFwcHBw, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1640812861, http-header-upgrade-insecure-requests=1, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/14.1.1 Safari/605.1.15, http-req-query-string=null, http-req-scheme=http, http-header-accept-language=pt-br, http-cookie-csrftoken=5yQ1zZRimgYY62m2wQtsjEi7XLpVcEAdrWHGR3GJrk3eVaLgWPshenCttdp3OyNb, kc-preferred-username=user1, http-req-local-address=172.31.0.11, kc-type=ID, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-header-cookie=csrftoken=5yQ1zZRimgYY62m2wQtsjEi7XLpVcEAdrWHGR3GJrk3eVaLgWPshenCttdp3OyNb; JSESSIONID=9E8C08A9DA29EA6811766C53F823DF88; OAuth_Token_Request_State=cf9b39b5-9935-4c48-a8bd-f77f2ce607cd, kc-email-verified=false, http-req-remote-host=172.31.0.1, http-session-id=9E8C08A9DA29EA6811766C53F823DF88, http-session-last-accessed-time=1640812580142, kc-auth-time=1640812561, kc-category-name=ID, kc-iat=1640812561, kc-category-ordinal=2, user.identifier=172.31.0.1:62582 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2021-12-29 21:16:58.475  INFO 14 --- [nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Request context extracted
2021-12-29 21:16:58.481  INFO 14 --- [nio-7071-exec-9] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-7446560867940-111909, decision=PERMIT, pdp-result=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={})
2021-12-29 21:16:58.491  INFO 14 --- [nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=9cd5bafc-731f-43e3-8222-1df1d913d6fb, content=PERMIT, timestamp=1640812618491, pdpResult=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={}))
2021-12-29 21:17:00.945  INFO 14 --- [io-7071-exec-10] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=dee3cf88-9833-44bb-a9bc-6b3cff36e9f9, content=null, timestamp=1640812620896, xacmlRequest={http-header-accept-encoding=gzip, deflate, http-header-referer=http://192.168.1.83/rest/acute-care-demo/call-centre, kc-acr=1, kc-is-expired=false, http-session-max-inactive-interval=1800, http-req-requested-session-id=9E8C08A9DA29EA6811766C53F823DF88, http-req-remote-port=62582, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-param-upload=upload, http-req-local-name=b9c70ccf9dc9, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-cookie-jsessionid=9E8C08A9DA29EA6811766C53F823DF88, http-session-valid=true, http-req-content-length=98, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.31.0.1, kc-session-state=5aaaaf61-c3a3-48a9-b85b-5a471e16272a, http-req-server-port=80, http-header-accept=text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8, kc-id=88112c40-dd74-4bd8-a7e2-26292baa101f, http-cookie-oauth_token_request_state=cf9b39b5-9935-4c48-a8bd-f77f2ce607cd, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=application/x-www-form-urlencoded;charset=UTF-8, http-header-host=192.168.1.83, http-session-creation-time=1640812488526, kc-id-token=rO0ABXNyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAA2FjcnEAfgABTAAHYWRkcmVzc3QALkxvcmcva2V5Y2xvYWsvcmVwcmVzZW50YXRpb25zL0FkZHJlc3NDbGFpbVNldDtMAAlhdXRoX3RpbWV0ABBMamF2YS9sYW5nL0xvbmc7TAAJYmlydGhkYXRlcQB+AAFMAA1jbGFpbXNMb2NhbGVzcQB+AAFMAAhjb2RlSGFzaHEAfgABTAAFZW1haWxxAH4AAUwADWVtYWlsVmVyaWZpZWR0ABNMamF2YS9sYW5nL0Jvb2xlYW47TAAKZmFtaWx5TmFtZXEAfgABTAAGZ2VuZGVycQB+AAFMAAlnaXZlbk5hbWVxAH4AAUwABmxvY2FsZXEAfgABTAAKbWlkZGxlTmFtZXEAfgABTAAEbmFtZXEAfgABTAAIbmlja05hbWVxAH4AAUwABW5vbmNlcQB+AAFMAAtwaG9uZU51bWJlcnEAfgABTAATcGhvbmVOdW1iZXJWZXJpZmllZHEAfgAETAAHcGljdHVyZXEAfgABTAARcHJlZmVycmVkVXNlcm5hbWVxAH4AAUwAB3Byb2ZpbGVxAH4AAUwADHNlc3Npb25TdGF0ZXEAfgABTAAJc3RhdGVIYXNocQB+AAFMAAl1cGRhdGVkQXRxAH4AA0wAB3dlYnNpdGVxAH4AAUwACHpvbmVpbmZvcQB+AAF4cgApb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5Kc29uV2ViVG9rZW6Cc0CQZNbg6gIAClsACGF1ZGllbmNldAATW0xqYXZhL2xhbmcvU3RyaW5nO0wAA2V4cHEAfgADTAADaWF0cQB+AANMAAJpZHEAfgABTAAJaXNzdWVkRm9ycQB+AAFMAAZpc3N1ZXJxAH4AAUwAA25iZnEAfgADTAALb3RoZXJDbGFpbXN0AA9MamF2YS91dGlsL01hcDtMAAdzdWJqZWN0cQB+AAFMAAR0eXBlcQB+AAF4cHVyABNbTGphdmEubGFuZy5TdHJpbmc7rdJW5+kde0cCAAB4cAAAAAF0AA1jYWxscy1nYXRld2F5c3IADmphdmEubGFuZy5Mb25nO4vkkMyPI98CAAFKAAV2YWx1ZXhyABBqYXZhLmxhbmcuTnVtYmVyhqyVHQuU4IsCAAB4cAAAAABhzNE9c3EAfgAMAAAAAGHM0BF0ACQ4ODExMmM0MC1kZDc0LTRiZDgtYTdlMi0yNjI5MmJhYTEwMWZ0AA1jYWxscy1nYXRld2F5dAA2aHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAACSURwdAABMXBzcQB+AAwAAAAAYczQEXBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ1YWFhYWY2MS1jM2EzLTQ4YTktYjg1Yi01YTQ3MWUxNjI3MmFwcHBw, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1640812861, http-header-upgrade-insecure-requests=1, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-param-csrfmiddlewaretoken=dcPX8l6F6vEkW2kYOiYqMBVGMarEfnq9zAGCqpV6bzJALaJcehXfHkf2iCrMRhD7, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/14.1.1 Safari/605.1.15, http-req-query-string=null, http-req-scheme=http, http-header-accept-language=pt-br, http-cookie-csrftoken=5yQ1zZRimgYY62m2wQtsjEi7XLpVcEAdrWHGR3GJrk3eVaLgWPshenCttdp3OyNb, kc-preferred-username=user1, http-header-content-length=98, http-req-local-address=172.31.0.11, kc-type=ID, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-header-content-type=application/x-www-form-urlencoded, http-header-cookie=csrftoken=5yQ1zZRimgYY62m2wQtsjEi7XLpVcEAdrWHGR3GJrk3eVaLgWPshenCttdp3OyNb; JSESSIONID=9E8C08A9DA29EA6811766C53F823DF88; OAuth_Token_Request_State=cf9b39b5-9935-4c48-a8bd-f77f2ce607cd, kc-email-verified=false, http-req-remote-host=172.31.0.1, http-session-id=9E8C08A9DA29EA6811766C53F823DF88, http-session-last-accessed-time=1640812618539, kc-auth-time=1640812561, kc-category-name=ID, kc-iat=1640812561, http-header-origin=http://192.168.1.83, kc-category-ordinal=2, user.identifier=172.31.0.1:62582 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2021-12-29 21:17:00.950  INFO 14 --- [io-7071-exec-10] e.a.a.abac.server.PdpServerController    : Request context extracted
2021-12-29 21:17:00.971  INFO 14 --- [io-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@31bd74d8
2021-12-29 21:17:00.974  INFO 14 --- [io-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@31bd74d8
2021-12-29 21:17:00.975  INFO 14 --- [io-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: http-param-patient-id, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@31bd74d8
2021-12-29 21:17:00.979  INFO 14 --- [io-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: http-param-es-id, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@31bd74d8
2021-12-29 21:17:01.021 ERROR 14 --- [io-7071-exec-10] e.a.a.a.s.pdp.AuthorizationServicePDP    : EXCEPTION while evaluating access request: 

java.lang.NullPointerException: null
	at java.lang.String.replace(String.java:2240) ~[na:1.8.0_212]
	at eu.asclepios.example.contexthandlers.CustomRestAttributeFinder.callRestProvider(CustomRestAttributeFinder.java:299) ~[abac-example-context-handlers-1.0.0-SNAPSHOT-jar-with-dependencies.jar:na]
	at eu.asclepios.example.contexthandlers.CustomRestAttributeFinder.findAttribute(CustomRestAttributeFinder.java:90) ~[abac-example-context-handlers-1.0.0-SNAPSHOT-jar-with-dependencies.jar:na]
	at org.wso2.balana.finder.AttributeFinder.findAttribute(AttributeFinder.java:163) ~[org.wso2.balana-1.1.12.jar!/:na]
	at org.wso2.balana.ctx.BasicEvaluationCtx.callHelper(BasicEvaluationCtx.java:227) ~[org.wso2.balana-1.1.12.jar!/:na]
	at org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx.getAttribute(XACML3EvaluationCtx.java:143) ~[org.wso2.balana-1.1.12.jar!/:na]
	at org.wso2.balana.attr.xacml3.AttributeDesignator.evaluate(AttributeDesignator.java:246) ~[org.wso2.balana-1.1.12.jar!/:na]
	at org.wso2.balana.cond.FunctionBase.evalArgs(FunctionBase.java:322) ~[org.wso2.balana-1.1.12.jar!/:na]
	at org.wso2.balana.cond.GeneralBagFunction.evaluate(GeneralBagFunction.java:237) ~[org.wso2.balana-1.1.12.jar!/:na]
	at org.wso2.balana.cond.Apply.evaluate(Apply.java:277) ~[org.wso2.balana-1.1.12.jar!/:na]
	at org.wso2.balana.cond.FunctionBase.evalArgs(FunctionBase.java:322) ~[org.wso2.balana-1.1.12.jar!/:na]
	at org.wso2.balana.cond.ComparisonFunction.evaluate(ComparisonFunction.java:344) ~[org.wso2.balana-1.1.12.jar!/:na]
	at org.wso2.balana.cond.Apply.evaluate(Apply.java:277) ~[org.wso2.balana-1.1.12.jar!/:na]
	at org.wso2.balana.cond.FunctionBase.evalArgs(FunctionBase.java:322) ~[org.wso2.balana-1.1.12.jar!/:na]
	at org.wso2.balana.cond.NotFunction.evaluate(NotFunction.java:105) ~[org.wso2.balana-1.1.12.jar!/:na]
	at org.wso2.balana.cond.Apply.evaluate(Apply.java:277) ~[org.wso2.balana-1.1.12.jar!/:na]
	at org.wso2.balana.cond.LogicalFunction.evaluate(LogicalFunction.java:133) ~[org.wso2.balana-1.1.12.jar!/:na]
	at org.wso2.balana.cond.Apply.evaluate(Apply.java:277) ~[org.wso2.balana-1.1.12.jar!/:na]
	at org.wso2.balana.cond.Condition.evaluate(Condition.java:253) ~[org.wso2.balana-1.1.12.jar!/:na]
	at org.wso2.balana.Rule.evaluate(Rule.java:397) ~[org.wso2.balana-1.1.12.jar!/:na]
	at org.wso2.balana.combine.xacml3.PermitUnlessDenyRuleAlg.combine(PermitUnlessDenyRuleAlg.java:94) ~[org.wso2.balana-1.1.12.jar!/:na]
	at org.wso2.balana.AbstractPolicy.evaluate(AbstractPolicy.java:570) ~[org.wso2.balana-1.1.12.jar!/:na]
	at org.wso2.balana.PDP.evaluateContext(PDP.java:262) ~[org.wso2.balana-1.1.12.jar!/:na]
	at org.wso2.balana.PDP.evaluate(PDP.java:195) ~[org.wso2.balana-1.1.12.jar!/:na]
	at org.wso2.balana.PDP.evaluate(PDP.java:154) ~[org.wso2.balana-1.1.12.jar!/:na]
	at eu.asclepios.authorization.abac.server.pdp.AuthorizationServicePDP.__evaluateRequest(AuthorizationServicePDP.java:247) ~[classes!/:2.0.0-SNAPSHOT]
	at eu.asclepios.authorization.abac.server.pdp.AuthorizationServicePDP.evaluateRequest(AuthorizationServicePDP.java:231) ~[classes!/:2.0.0-SNAPSHOT]
	at eu.asclepios.authorization.abac.server.PdpServerController.checkJsonAccessRequest(PdpServerController.java:96) [classes!/:2.0.0-SNAPSHOT]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[na:1.8.0_212]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[na:1.8.0_212]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:1.8.0_212]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[na:1.8.0_212]
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:190) [spring-web-5.2.12.RELEASE.jar!/:5.2.12.RELEASE]
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:138) [spring-web-5.2.12.RELEASE.jar!/:5.2.12.RELEASE]
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:105) [spring-webmvc-5.2.12.RELEASE.jar!/:5.2.12.RELEASE]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:878) [spring-webmvc-5.2.12.RELEASE.jar!/:5.2.12.RELEASE]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:792) [spring-webmvc-5.2.12.RELEASE.jar!/:5.2.12.RELEASE]
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) [spring-webmvc-5.2.12.RELEASE.jar!/:5.2.12.RELEASE]
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1040) [spring-webmvc-5.2.12.RELEASE.jar!/:5.2.12.RELEASE]
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:943) [spring-webmvc-5.2.12.RELEASE.jar!/:5.2.12.RELEASE]
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006) [spring-webmvc-5.2.12.RELEASE.jar!/:5.2.12.RELEASE]
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909) [spring-webmvc-5.2.12.RELEASE.jar!/:5.2.12.RELEASE]
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:652) [tomcat-embed-core-9.0.41.jar!/:4.0.FR]
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883) [spring-webmvc-5.2.12.RELEASE.jar!/:5.2.12.RELEASE]
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:733) [tomcat-embed-core-9.0.41.jar!/:4.0.FR]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:231) [tomcat-embed-core-9.0.41.jar!/:9.0.41]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166) [tomcat-embed-core-9.0.41.jar!/:9.0.41]
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:53) [tomcat-embed-websocket-9.0.41.jar!/:9.0.41]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193) [tomcat-embed-core-9.0.41.jar!/:9.0.41]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166) [tomcat-embed-core-9.0.41.jar!/:9.0.41]
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) [spring-web-5.2.12.RELEASE.jar!/:5.2.12.RELEASE]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119) [spring-web-5.2.12.RELEASE.jar!/:5.2.12.RELEASE]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193) [tomcat-embed-core-9.0.41.jar!/:9.0.41]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166) [tomcat-embed-core-9.0.41.jar!/:9.0.41]
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) [spring-web-5.2.12.RELEASE.jar!/:5.2.12.RELEASE]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119) [spring-web-5.2.12.RELEASE.jar!/:5.2.12.RELEASE]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193) [tomcat-embed-core-9.0.41.jar!/:9.0.41]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166) [tomcat-embed-core-9.0.41.jar!/:9.0.41]
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) [spring-web-5.2.12.RELEASE.jar!/:5.2.12.RELEASE]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119) [spring-web-5.2.12.RELEASE.jar!/:5.2.12.RELEASE]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193) [tomcat-embed-core-9.0.41.jar!/:9.0.41]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166) [tomcat-embed-core-9.0.41.jar!/:9.0.41]
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:202) [tomcat-embed-core-9.0.41.jar!/:9.0.41]
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:97) [tomcat-embed-core-9.0.41.jar!/:9.0.41]
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:542) [tomcat-embed-core-9.0.41.jar!/:9.0.41]
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:143) [tomcat-embed-core-9.0.41.jar!/:9.0.41]
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:92) [tomcat-embed-core-9.0.41.jar!/:9.0.41]
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:78) [tomcat-embed-core-9.0.41.jar!/:9.0.41]
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343) [tomcat-embed-core-9.0.41.jar!/:9.0.41]
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:374) [tomcat-embed-core-9.0.41.jar!/:9.0.41]
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:65) [tomcat-embed-core-9.0.41.jar!/:9.0.41]
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:888) [tomcat-embed-core-9.0.41.jar!/:9.0.41]
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1597) [tomcat-embed-core-9.0.41.jar!/:9.0.41]
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:49) [tomcat-embed-core-9.0.41.jar!/:9.0.41]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [na:1.8.0_212]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [na:1.8.0_212]
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61) [tomcat-embed-core-9.0.41.jar!/:9.0.41]
	at java.lang.Thread.run(Thread.java:748) [na:1.8.0_212]

2021-12-29 21:17:01.024  INFO 14 --- [io-7071-exec-10] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=dee3cf88-9833-44bb-a9bc-6b3cff36e9f9, content=ERROR, timestamp=1640812621024, pdpResult=PdpResult(decision=ERROR, statusCodes=null, statusDetails=null, statusMessage=null, obligations=null))
2021-12-29 21:18:14.973  INFO 14 --- [nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=4093d42e-f4c4-4eaf-af4d-8949a5aec5d8, content=null, timestamp=1640812694893, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-session-max-inactive-interval=1800, http-req-requested-session-id=9E8C08A9DA29EA6811766C53F823DF88, http-req-remote-port=62594, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=b9c70ccf9dc9, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-cookie-jsessionid=9E8C08A9DA29EA6811766C53F823DF88, http-session-valid=true, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.31.0.1, kc-session-state=5aaaaf61-c3a3-48a9-b85b-5a471e16272a, http-req-server-port=80, http-header-accept=text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8, kc-id=88112c40-dd74-4bd8-a7e2-26292baa101f, http-cookie-oauth_token_request_state=cf9b39b5-9935-4c48-a8bd-f77f2ce607cd, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1640812488526, kc-id-token=rO0ABXNyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAA2FjcnEAfgABTAAHYWRkcmVzc3QALkxvcmcva2V5Y2xvYWsvcmVwcmVzZW50YXRpb25zL0FkZHJlc3NDbGFpbVNldDtMAAlhdXRoX3RpbWV0ABBMamF2YS9sYW5nL0xvbmc7TAAJYmlydGhkYXRlcQB+AAFMAA1jbGFpbXNMb2NhbGVzcQB+AAFMAAhjb2RlSGFzaHEAfgABTAAFZW1haWxxAH4AAUwADWVtYWlsVmVyaWZpZWR0ABNMamF2YS9sYW5nL0Jvb2xlYW47TAAKZmFtaWx5TmFtZXEAfgABTAAGZ2VuZGVycQB+AAFMAAlnaXZlbk5hbWVxAH4AAUwABmxvY2FsZXEAfgABTAAKbWlkZGxlTmFtZXEAfgABTAAEbmFtZXEAfgABTAAIbmlja05hbWVxAH4AAUwABW5vbmNlcQB+AAFMAAtwaG9uZU51bWJlcnEAfgABTAATcGhvbmVOdW1iZXJWZXJpZmllZHEAfgAETAAHcGljdHVyZXEAfgABTAARcHJlZmVycmVkVXNlcm5hbWVxAH4AAUwAB3Byb2ZpbGVxAH4AAUwADHNlc3Npb25TdGF0ZXEAfgABTAAJc3RhdGVIYXNocQB+AAFMAAl1cGRhdGVkQXRxAH4AA0wAB3dlYnNpdGVxAH4AAUwACHpvbmVpbmZvcQB+AAF4cgApb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5Kc29uV2ViVG9rZW6Cc0CQZNbg6gIAClsACGF1ZGllbmNldAATW0xqYXZhL2xhbmcvU3RyaW5nO0wAA2V4cHEAfgADTAADaWF0cQB+AANMAAJpZHEAfgABTAAJaXNzdWVkRm9ycQB+AAFMAAZpc3N1ZXJxAH4AAUwAA25iZnEAfgADTAALb3RoZXJDbGFpbXN0AA9MamF2YS91dGlsL01hcDtMAAdzdWJqZWN0cQB+AAFMAAR0eXBlcQB+AAF4cHVyABNbTGphdmEubGFuZy5TdHJpbmc7rdJW5+kde0cCAAB4cAAAAAF0AA1jYWxscy1nYXRld2F5c3IADmphdmEubGFuZy5Mb25nO4vkkMyPI98CAAFKAAV2YWx1ZXhyABBqYXZhLmxhbmcuTnVtYmVyhqyVHQuU4IsCAAB4cAAAAABhzNE9c3EAfgAMAAAAAGHM0BF0ACQ4ODExMmM0MC1kZDc0LTRiZDgtYTdlMi0yNjI5MmJhYTEwMWZ0AA1jYWxscy1nYXRld2F5dAA2aHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAACSURwdAABMXBzcQB+AAwAAAAAYczQEXBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ1YWFhYWY2MS1jM2EzLTQ4YTktYjg1Yi01YTQ3MWUxNjI3MmFwcHBw, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1640812861, http-header-upgrade-insecure-requests=1, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/14.1.1 Safari/605.1.15, http-req-query-string=null, http-req-scheme=http, http-header-accept-language=pt-br, http-cookie-csrftoken=5yQ1zZRimgYY62m2wQtsjEi7XLpVcEAdrWHGR3GJrk3eVaLgWPshenCttdp3OyNb, kc-preferred-username=user1, http-req-local-address=172.31.0.11, kc-type=ID, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-header-cookie=csrftoken=5yQ1zZRimgYY62m2wQtsjEi7XLpVcEAdrWHGR3GJrk3eVaLgWPshenCttdp3OyNb; JSESSIONID=9E8C08A9DA29EA6811766C53F823DF88; OAuth_Token_Request_State=cf9b39b5-9935-4c48-a8bd-f77f2ce607cd, kc-email-verified=false, http-req-remote-host=172.31.0.1, http-session-id=9E8C08A9DA29EA6811766C53F823DF88, http-session-last-accessed-time=1640812621056, kc-auth-time=1640812561, kc-category-name=ID, kc-iat=1640812561, kc-category-ordinal=2, user.identifier=172.31.0.1:62594 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2021-12-29 21:18:14.983  INFO 14 --- [nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Request context extracted
2021-12-29 21:18:14.989  INFO 14 --- [nio-7071-exec-6] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-7523171905840-663475, decision=PERMIT, pdp-result=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={})
2021-12-29 21:18:14.999  INFO 14 --- [nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=4093d42e-f4c4-4eaf-af4d-8949a5aec5d8, content=PERMIT, timestamp=1640812694999, pdpResult=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={}))
2021-12-29 21:18:16.549  INFO 14 --- [nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=5453d92b-c2a9-40ce-9959-5c49260fb60a, content=null, timestamp=1640812696524, xacmlRequest={http-header-accept-encoding=gzip, deflate, http-header-referer=http://192.168.1.83/rest/acute-care-demo/call-centre, kc-acr=1, kc-is-expired=false, http-session-max-inactive-interval=1800, http-req-requested-session-id=9E8C08A9DA29EA6811766C53F823DF88, http-req-remote-port=62594, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-param-upload=upload, http-req-local-name=b9c70ccf9dc9, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-cookie-jsessionid=9E8C08A9DA29EA6811766C53F823DF88, http-session-valid=true, http-req-content-length=98, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.31.0.1, kc-session-state=5aaaaf61-c3a3-48a9-b85b-5a471e16272a, http-req-server-port=80, http-header-accept=text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8, kc-id=88112c40-dd74-4bd8-a7e2-26292baa101f, http-cookie-oauth_token_request_state=cf9b39b5-9935-4c48-a8bd-f77f2ce607cd, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=application/x-www-form-urlencoded;charset=UTF-8, http-header-host=192.168.1.83, http-session-creation-time=1640812488526, kc-id-token=rO0ABXNyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAA2FjcnEAfgABTAAHYWRkcmVzc3QALkxvcmcva2V5Y2xvYWsvcmVwcmVzZW50YXRpb25zL0FkZHJlc3NDbGFpbVNldDtMAAlhdXRoX3RpbWV0ABBMamF2YS9sYW5nL0xvbmc7TAAJYmlydGhkYXRlcQB+AAFMAA1jbGFpbXNMb2NhbGVzcQB+AAFMAAhjb2RlSGFzaHEAfgABTAAFZW1haWxxAH4AAUwADWVtYWlsVmVyaWZpZWR0ABNMamF2YS9sYW5nL0Jvb2xlYW47TAAKZmFtaWx5TmFtZXEAfgABTAAGZ2VuZGVycQB+AAFMAAlnaXZlbk5hbWVxAH4AAUwABmxvY2FsZXEAfgABTAAKbWlkZGxlTmFtZXEAfgABTAAEbmFtZXEAfgABTAAIbmlja05hbWVxAH4AAUwABW5vbmNlcQB+AAFMAAtwaG9uZU51bWJlcnEAfgABTAATcGhvbmVOdW1iZXJWZXJpZmllZHEAfgAETAAHcGljdHVyZXEAfgABTAARcHJlZmVycmVkVXNlcm5hbWVxAH4AAUwAB3Byb2ZpbGVxAH4AAUwADHNlc3Npb25TdGF0ZXEAfgABTAAJc3RhdGVIYXNocQB+AAFMAAl1cGRhdGVkQXRxAH4AA0wAB3dlYnNpdGVxAH4AAUwACHpvbmVpbmZvcQB+AAF4cgApb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5Kc29uV2ViVG9rZW6Cc0CQZNbg6gIAClsACGF1ZGllbmNldAATW0xqYXZhL2xhbmcvU3RyaW5nO0wAA2V4cHEAfgADTAADaWF0cQB+AANMAAJpZHEAfgABTAAJaXNzdWVkRm9ycQB+AAFMAAZpc3N1ZXJxAH4AAUwAA25iZnEAfgADTAALb3RoZXJDbGFpbXN0AA9MamF2YS91dGlsL01hcDtMAAdzdWJqZWN0cQB+AAFMAAR0eXBlcQB+AAF4cHVyABNbTGphdmEubGFuZy5TdHJpbmc7rdJW5+kde0cCAAB4cAAAAAF0AA1jYWxscy1nYXRld2F5c3IADmphdmEubGFuZy5Mb25nO4vkkMyPI98CAAFKAAV2YWx1ZXhyABBqYXZhLmxhbmcuTnVtYmVyhqyVHQuU4IsCAAB4cAAAAABhzNE9c3EAfgAMAAAAAGHM0BF0ACQ4ODExMmM0MC1kZDc0LTRiZDgtYTdlMi0yNjI5MmJhYTEwMWZ0AA1jYWxscy1nYXRld2F5dAA2aHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAACSURwdAABMXBzcQB+AAwAAAAAYczQEXBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ1YWFhYWY2MS1jM2EzLTQ4YTktYjg1Yi01YTQ3MWUxNjI3MmFwcHBw, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1640812861, http-header-upgrade-insecure-requests=1, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-param-csrfmiddlewaretoken=iwILQWzUiTHpuaykrShoaMP1NzyFfxWBEUzq80olnXMFjiXyRRgd5v9nj1yNRr9z, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/14.1.1 Safari/605.1.15, http-req-query-string=null, http-req-scheme=http, http-header-accept-language=pt-br, http-cookie-csrftoken=5yQ1zZRimgYY62m2wQtsjEi7XLpVcEAdrWHGR3GJrk3eVaLgWPshenCttdp3OyNb, kc-preferred-username=user1, http-header-content-length=98, http-req-local-address=172.31.0.11, kc-type=ID, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-header-content-type=application/x-www-form-urlencoded, http-header-cookie=csrftoken=5yQ1zZRimgYY62m2wQtsjEi7XLpVcEAdrWHGR3GJrk3eVaLgWPshenCttdp3OyNb; JSESSIONID=9E8C08A9DA29EA6811766C53F823DF88; OAuth_Token_Request_State=cf9b39b5-9935-4c48-a8bd-f77f2ce607cd, kc-email-verified=false, http-req-remote-host=172.31.0.1, http-session-id=9E8C08A9DA29EA6811766C53F823DF88, http-session-last-accessed-time=1640812695085, kc-auth-time=1640812561, kc-category-name=ID, kc-iat=1640812561, http-header-origin=http://192.168.1.83, kc-category-ordinal=2, user.identifier=172.31.0.1:62594 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2021-12-29 21:18:16.551  INFO 14 --- [nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Request context extracted
2021-12-29 21:18:16.557  INFO 14 --- [nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3e62d4b0
2021-12-29 21:18:16.558  INFO 14 --- [nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3e62d4b0
2021-12-29 21:18:16.560  INFO 14 --- [nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: http-param-patient-id, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3e62d4b0
2021-12-29 21:18:16.561  INFO 14 --- [nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: http-param-es-id, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3e62d4b0
2021-12-29 21:18:16.570 ERROR 14 --- [nio-7071-exec-7] e.a.a.a.s.pdp.AuthorizationServicePDP    : EXCEPTION while evaluating access request: 

java.lang.NullPointerException: null
	at java.lang.String.replace(String.java:2240) ~[na:1.8.0_212]
	at eu.asclepios.example.contexthandlers.CustomRestAttributeFinder.callRestProvider(CustomRestAttributeFinder.java:299) ~[abac-example-context-handlers-1.0.0-SNAPSHOT-jar-with-dependencies.jar:na]
	at eu.asclepios.example.contexthandlers.CustomRestAttributeFinder.findAttribute(CustomRestAttributeFinder.java:90) ~[abac-example-context-handlers-1.0.0-SNAPSHOT-jar-with-dependencies.jar:na]
	at org.wso2.balana.finder.AttributeFinder.findAttribute(AttributeFinder.java:163) ~[org.wso2.balana-1.1.12.jar!/:na]
	at org.wso2.balana.ctx.BasicEvaluationCtx.callHelper(BasicEvaluationCtx.java:227) ~[org.wso2.balana-1.1.12.jar!/:na]
	at org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx.getAttribute(XACML3EvaluationCtx.java:143) ~[org.wso2.balana-1.1.12.jar!/:na]
	at org.wso2.balana.attr.xacml3.AttributeDesignator.evaluate(AttributeDesignator.java:246) ~[org.wso2.balana-1.1.12.jar!/:na]
	at org.wso2.balana.cond.FunctionBase.evalArgs(FunctionBase.java:322) ~[org.wso2.balana-1.1.12.jar!/:na]
	at org.wso2.balana.cond.GeneralBagFunction.evaluate(GeneralBagFunction.java:237) ~[org.wso2.balana-1.1.12.jar!/:na]
	at org.wso2.balana.cond.Apply.evaluate(Apply.java:277) ~[org.wso2.balana-1.1.12.jar!/:na]
	at org.wso2.balana.cond.FunctionBase.evalArgs(FunctionBase.java:322) ~[org.wso2.balana-1.1.12.jar!/:na]
	at org.wso2.balana.cond.ComparisonFunction.evaluate(ComparisonFunction.java:344) ~[org.wso2.balana-1.1.12.jar!/:na]
	at org.wso2.balana.cond.Apply.evaluate(Apply.java:277) ~[org.wso2.balana-1.1.12.jar!/:na]
	at org.wso2.balana.cond.FunctionBase.evalArgs(FunctionBase.java:322) ~[org.wso2.balana-1.1.12.jar!/:na]
	at org.wso2.balana.cond.NotFunction.evaluate(NotFunction.java:105) ~[org.wso2.balana-1.1.12.jar!/:na]
	at org.wso2.balana.cond.Apply.evaluate(Apply.java:277) ~[org.wso2.balana-1.1.12.jar!/:na]
	at org.wso2.balana.cond.LogicalFunction.evaluate(LogicalFunction.java:133) ~[org.wso2.balana-1.1.12.jar!/:na]
	at org.wso2.balana.cond.Apply.evaluate(Apply.java:277) ~[org.wso2.balana-1.1.12.jar!/:na]
	at org.wso2.balana.cond.Condition.evaluate(Condition.java:253) ~[org.wso2.balana-1.1.12.jar!/:na]
	at org.wso2.balana.Rule.evaluate(Rule.java:397) ~[org.wso2.balana-1.1.12.jar!/:na]
	at org.wso2.balana.combine.xacml3.PermitUnlessDenyRuleAlg.combine(PermitUnlessDenyRuleAlg.java:94) ~[org.wso2.balana-1.1.12.jar!/:na]
	at org.wso2.balana.AbstractPolicy.evaluate(AbstractPolicy.java:570) ~[org.wso2.balana-1.1.12.jar!/:na]
	at org.wso2.balana.PDP.evaluateContext(PDP.java:262) ~[org.wso2.balana-1.1.12.jar!/:na]
	at org.wso2.balana.PDP.evaluate(PDP.java:195) ~[org.wso2.balana-1.1.12.jar!/:na]
	at org.wso2.balana.PDP.evaluate(PDP.java:154) ~[org.wso2.balana-1.1.12.jar!/:na]
	at eu.asclepios.authorization.abac.server.pdp.AuthorizationServicePDP.__evaluateRequest(AuthorizationServicePDP.java:247) ~[classes!/:2.0.0-SNAPSHOT]
	at eu.asclepios.authorization.abac.server.pdp.AuthorizationServicePDP.evaluateRequest(AuthorizationServicePDP.java:231) ~[classes!/:2.0.0-SNAPSHOT]
	at eu.asclepios.authorization.abac.server.PdpServerController.checkJsonAccessRequest(PdpServerController.java:96) [classes!/:2.0.0-SNAPSHOT]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[na:1.8.0_212]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[na:1.8.0_212]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:1.8.0_212]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[na:1.8.0_212]
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:190) [spring-web-5.2.12.RELEASE.jar!/:5.2.12.RELEASE]
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:138) [spring-web-5.2.12.RELEASE.jar!/:5.2.12.RELEASE]
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:105) [spring-webmvc-5.2.12.RELEASE.jar!/:5.2.12.RELEASE]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:878) [spring-webmvc-5.2.12.RELEASE.jar!/:5.2.12.RELEASE]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:792) [spring-webmvc-5.2.12.RELEASE.jar!/:5.2.12.RELEASE]
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) [spring-webmvc-5.2.12.RELEASE.jar!/:5.2.12.RELEASE]
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1040) [spring-webmvc-5.2.12.RELEASE.jar!/:5.2.12.RELEASE]
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:943) [spring-webmvc-5.2.12.RELEASE.jar!/:5.2.12.RELEASE]
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006) [spring-webmvc-5.2.12.RELEASE.jar!/:5.2.12.RELEASE]
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909) [spring-webmvc-5.2.12.RELEASE.jar!/:5.2.12.RELEASE]
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:652) [tomcat-embed-core-9.0.41.jar!/:4.0.FR]
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883) [spring-webmvc-5.2.12.RELEASE.jar!/:5.2.12.RELEASE]
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:733) [tomcat-embed-core-9.0.41.jar!/:4.0.FR]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:231) [tomcat-embed-core-9.0.41.jar!/:9.0.41]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166) [tomcat-embed-core-9.0.41.jar!/:9.0.41]
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:53) [tomcat-embed-websocket-9.0.41.jar!/:9.0.41]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193) [tomcat-embed-core-9.0.41.jar!/:9.0.41]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166) [tomcat-embed-core-9.0.41.jar!/:9.0.41]
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) [spring-web-5.2.12.RELEASE.jar!/:5.2.12.RELEASE]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119) [spring-web-5.2.12.RELEASE.jar!/:5.2.12.RELEASE]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193) [tomcat-embed-core-9.0.41.jar!/:9.0.41]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166) [tomcat-embed-core-9.0.41.jar!/:9.0.41]
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) [spring-web-5.2.12.RELEASE.jar!/:5.2.12.RELEASE]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119) [spring-web-5.2.12.RELEASE.jar!/:5.2.12.RELEASE]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193) [tomcat-embed-core-9.0.41.jar!/:9.0.41]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166) [tomcat-embed-core-9.0.41.jar!/:9.0.41]
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) [spring-web-5.2.12.RELEASE.jar!/:5.2.12.RELEASE]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119) [spring-web-5.2.12.RELEASE.jar!/:5.2.12.RELEASE]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193) [tomcat-embed-core-9.0.41.jar!/:9.0.41]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166) [tomcat-embed-core-9.0.41.jar!/:9.0.41]
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:202) [tomcat-embed-core-9.0.41.jar!/:9.0.41]
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:97) [tomcat-embed-core-9.0.41.jar!/:9.0.41]
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:542) [tomcat-embed-core-9.0.41.jar!/:9.0.41]
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:143) [tomcat-embed-core-9.0.41.jar!/:9.0.41]
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:92) [tomcat-embed-core-9.0.41.jar!/:9.0.41]
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:78) [tomcat-embed-core-9.0.41.jar!/:9.0.41]
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343) [tomcat-embed-core-9.0.41.jar!/:9.0.41]
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:374) [tomcat-embed-core-9.0.41.jar!/:9.0.41]
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:65) [tomcat-embed-core-9.0.41.jar!/:9.0.41]
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:888) [tomcat-embed-core-9.0.41.jar!/:9.0.41]
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1597) [tomcat-embed-core-9.0.41.jar!/:9.0.41]
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:49) [tomcat-embed-core-9.0.41.jar!/:9.0.41]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [na:1.8.0_212]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [na:1.8.0_212]
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61) [tomcat-embed-core-9.0.41.jar!/:9.0.41]
	at java.lang.Thread.run(Thread.java:748) [na:1.8.0_212]

2021-12-29 21:18:16.572  INFO 14 --- [nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=5453d92b-c2a9-40ce-9959-5c49260fb60a, content=ERROR, timestamp=1640812696572, pdpResult=PdpResult(decision=ERROR, statusCodes=null, statusDetails=null, statusMessage=null, obligations=null))
2021-12-29 21:18:53.457  INFO 14 --- [nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=6db7371f-de73-4762-973e-e6cb4808d1b5, content=null, timestamp=1640812733421, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-session-max-inactive-interval=1800, http-req-requested-session-id=9E8C08A9DA29EA6811766C53F823DF88, http-req-remote-port=62594, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=b9c70ccf9dc9, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-cookie-jsessionid=9E8C08A9DA29EA6811766C53F823DF88, http-session-valid=true, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.31.0.1, kc-session-state=5aaaaf61-c3a3-48a9-b85b-5a471e16272a, http-req-server-port=80, http-header-accept=text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8, kc-id=88112c40-dd74-4bd8-a7e2-26292baa101f, http-cookie-oauth_token_request_state=cf9b39b5-9935-4c48-a8bd-f77f2ce607cd, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1640812488526, kc-id-token=rO0ABXNyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAA2FjcnEAfgABTAAHYWRkcmVzc3QALkxvcmcva2V5Y2xvYWsvcmVwcmVzZW50YXRpb25zL0FkZHJlc3NDbGFpbVNldDtMAAlhdXRoX3RpbWV0ABBMamF2YS9sYW5nL0xvbmc7TAAJYmlydGhkYXRlcQB+AAFMAA1jbGFpbXNMb2NhbGVzcQB+AAFMAAhjb2RlSGFzaHEAfgABTAAFZW1haWxxAH4AAUwADWVtYWlsVmVyaWZpZWR0ABNMamF2YS9sYW5nL0Jvb2xlYW47TAAKZmFtaWx5TmFtZXEAfgABTAAGZ2VuZGVycQB+AAFMAAlnaXZlbk5hbWVxAH4AAUwABmxvY2FsZXEAfgABTAAKbWlkZGxlTmFtZXEAfgABTAAEbmFtZXEAfgABTAAIbmlja05hbWVxAH4AAUwABW5vbmNlcQB+AAFMAAtwaG9uZU51bWJlcnEAfgABTAATcGhvbmVOdW1iZXJWZXJpZmllZHEAfgAETAAHcGljdHVyZXEAfgABTAARcHJlZmVycmVkVXNlcm5hbWVxAH4AAUwAB3Byb2ZpbGVxAH4AAUwADHNlc3Npb25TdGF0ZXEAfgABTAAJc3RhdGVIYXNocQB+AAFMAAl1cGRhdGVkQXRxAH4AA0wAB3dlYnNpdGVxAH4AAUwACHpvbmVpbmZvcQB+AAF4cgApb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5Kc29uV2ViVG9rZW6Cc0CQZNbg6gIAClsACGF1ZGllbmNldAATW0xqYXZhL2xhbmcvU3RyaW5nO0wAA2V4cHEAfgADTAADaWF0cQB+AANMAAJpZHEAfgABTAAJaXNzdWVkRm9ycQB+AAFMAAZpc3N1ZXJxAH4AAUwAA25iZnEAfgADTAALb3RoZXJDbGFpbXN0AA9MamF2YS91dGlsL01hcDtMAAdzdWJqZWN0cQB+AAFMAAR0eXBlcQB+AAF4cHVyABNbTGphdmEubGFuZy5TdHJpbmc7rdJW5+kde0cCAAB4cAAAAAF0AA1jYWxscy1nYXRld2F5c3IADmphdmEubGFuZy5Mb25nO4vkkMyPI98CAAFKAAV2YWx1ZXhyABBqYXZhLmxhbmcuTnVtYmVyhqyVHQuU4IsCAAB4cAAAAABhzNE9c3EAfgAMAAAAAGHM0BF0ACQ4ODExMmM0MC1kZDc0LTRiZDgtYTdlMi0yNjI5MmJhYTEwMWZ0AA1jYWxscy1nYXRld2F5dAA2aHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAACSURwdAABMXBzcQB+AAwAAAAAYczQEXBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ1YWFhYWY2MS1jM2EzLTQ4YTktYjg1Yi01YTQ3MWUxNjI3MmFwcHBw, http-req-servlet-path=/rest/acute-care-demo/call-centre/upload, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/upload, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1640812861, http-header-upgrade-insecure-requests=1, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/upload, http-req-uri=/rest/acute-care-demo/call-centre/upload, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/14.1.1 Safari/605.1.15, http-req-query-string=null, http-req-scheme=http, http-header-accept-language=pt-br, http-cookie-csrftoken=5yQ1zZRimgYY62m2wQtsjEi7XLpVcEAdrWHGR3GJrk3eVaLgWPshenCttdp3OyNb, kc-preferred-username=user1, http-req-local-address=172.31.0.11, kc-type=ID, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-header-cookie=csrftoken=5yQ1zZRimgYY62m2wQtsjEi7XLpVcEAdrWHGR3GJrk3eVaLgWPshenCttdp3OyNb; JSESSIONID=9E8C08A9DA29EA6811766C53F823DF88; OAuth_Token_Request_State=cf9b39b5-9935-4c48-a8bd-f77f2ce607cd, kc-email-verified=false, http-req-remote-host=172.31.0.1, http-session-id=9E8C08A9DA29EA6811766C53F823DF88, http-session-last-accessed-time=1640812696619, kc-auth-time=1640812561, kc-category-name=ID, kc-iat=1640812561, kc-category-ordinal=2, user.identifier=172.31.0.1:62594 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2021-12-29 21:18:53.462  INFO 14 --- [nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Request context extracted
2021-12-29 21:18:53.471  INFO 14 --- [nio-7071-exec-8] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-7561686214140-151249, decision=NOT_APPLICABLE, pdp-result=PdpResult(decision=NOT_APPLICABLE, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={})
2021-12-29 21:18:53.472  INFO 14 --- [nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=6db7371f-de73-4762-973e-e6cb4808d1b5, content=NOT_APPLICABLE, timestamp=1640812733472, pdpResult=PdpResult(decision=NOT_APPLICABLE, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={}))
2021-12-29 21:18:57.096  INFO 14 --- [nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=3bd26c91-37e8-4890-9ea9-ec38e9091e7c, content=null, timestamp=1640812737068, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-session-max-inactive-interval=1800, http-req-requested-session-id=9E8C08A9DA29EA6811766C53F823DF88, http-req-remote-port=62594, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=b9c70ccf9dc9, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-cookie-jsessionid=9E8C08A9DA29EA6811766C53F823DF88, http-session-valid=true, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.31.0.1, kc-session-state=5aaaaf61-c3a3-48a9-b85b-5a471e16272a, http-req-server-port=80, http-header-accept=text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8, kc-id=88112c40-dd74-4bd8-a7e2-26292baa101f, http-cookie-oauth_token_request_state=cf9b39b5-9935-4c48-a8bd-f77f2ce607cd, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1640812488526, kc-id-token=rO0ABXNyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAA2FjcnEAfgABTAAHYWRkcmVzc3QALkxvcmcva2V5Y2xvYWsvcmVwcmVzZW50YXRpb25zL0FkZHJlc3NDbGFpbVNldDtMAAlhdXRoX3RpbWV0ABBMamF2YS9sYW5nL0xvbmc7TAAJYmlydGhkYXRlcQB+AAFMAA1jbGFpbXNMb2NhbGVzcQB+AAFMAAhjb2RlSGFzaHEAfgABTAAFZW1haWxxAH4AAUwADWVtYWlsVmVyaWZpZWR0ABNMamF2YS9sYW5nL0Jvb2xlYW47TAAKZmFtaWx5TmFtZXEAfgABTAAGZ2VuZGVycQB+AAFMAAlnaXZlbk5hbWVxAH4AAUwABmxvY2FsZXEAfgABTAAKbWlkZGxlTmFtZXEAfgABTAAEbmFtZXEAfgABTAAIbmlja05hbWVxAH4AAUwABW5vbmNlcQB+AAFMAAtwaG9uZU51bWJlcnEAfgABTAATcGhvbmVOdW1iZXJWZXJpZmllZHEAfgAETAAHcGljdHVyZXEAfgABTAARcHJlZmVycmVkVXNlcm5hbWVxAH4AAUwAB3Byb2ZpbGVxAH4AAUwADHNlc3Npb25TdGF0ZXEAfgABTAAJc3RhdGVIYXNocQB+AAFMAAl1cGRhdGVkQXRxAH4AA0wAB3dlYnNpdGVxAH4AAUwACHpvbmVpbmZvcQB+AAF4cgApb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5Kc29uV2ViVG9rZW6Cc0CQZNbg6gIAClsACGF1ZGllbmNldAATW0xqYXZhL2xhbmcvU3RyaW5nO0wAA2V4cHEAfgADTAADaWF0cQB+AANMAAJpZHEAfgABTAAJaXNzdWVkRm9ycQB+AAFMAAZpc3N1ZXJxAH4AAUwAA25iZnEAfgADTAALb3RoZXJDbGFpbXN0AA9MamF2YS91dGlsL01hcDtMAAdzdWJqZWN0cQB+AAFMAAR0eXBlcQB+AAF4cHVyABNbTGphdmEubGFuZy5TdHJpbmc7rdJW5+kde0cCAAB4cAAAAAF0AA1jYWxscy1nYXRld2F5c3IADmphdmEubGFuZy5Mb25nO4vkkMyPI98CAAFKAAV2YWx1ZXhyABBqYXZhLmxhbmcuTnVtYmVyhqyVHQuU4IsCAAB4cAAAAABhzNE9c3EAfgAMAAAAAGHM0BF0ACQ4ODExMmM0MC1kZDc0LTRiZDgtYTdlMi0yNjI5MmJhYTEwMWZ0AA1jYWxscy1nYXRld2F5dAA2aHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAACSURwdAABMXBzcQB+AAwAAAAAYczQEXBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ1YWFhYWY2MS1jM2EzLTQ4YTktYjg1Yi01YTQ3MWUxNjI3MmFwcHBw, http-req-servlet-path=/rest/acute-care-demo/call-centre/upload, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/upload, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1640812861, http-header-upgrade-insecure-requests=1, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/upload, http-req-uri=/rest/acute-care-demo/call-centre/upload, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/14.1.1 Safari/605.1.15, http-req-query-string=null, http-req-scheme=http, http-header-accept-language=pt-br, http-cookie-csrftoken=5yQ1zZRimgYY62m2wQtsjEi7XLpVcEAdrWHGR3GJrk3eVaLgWPshenCttdp3OyNb, kc-preferred-username=user1, http-req-local-address=172.31.0.11, kc-type=ID, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-header-cookie=csrftoken=5yQ1zZRimgYY62m2wQtsjEi7XLpVcEAdrWHGR3GJrk3eVaLgWPshenCttdp3OyNb; JSESSIONID=9E8C08A9DA29EA6811766C53F823DF88; OAuth_Token_Request_State=cf9b39b5-9935-4c48-a8bd-f77f2ce607cd, kc-email-verified=false, http-req-remote-host=172.31.0.1, http-session-id=9E8C08A9DA29EA6811766C53F823DF88, http-session-last-accessed-time=1640812733521, kc-auth-time=1640812561, kc-category-name=ID, kc-iat=1640812561, kc-category-ordinal=2, user.identifier=172.31.0.1:62594 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2021-12-29 21:18:57.108  INFO 14 --- [nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Request context extracted
2021-12-29 21:18:57.124  INFO 14 --- [nio-7071-exec-9] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-7565335444540-784448, decision=NOT_APPLICABLE, pdp-result=PdpResult(decision=NOT_APPLICABLE, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={})
2021-12-29 21:18:57.125  INFO 14 --- [nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=3bd26c91-37e8-4890-9ea9-ec38e9091e7c, content=NOT_APPLICABLE, timestamp=1640812737125, pdpResult=PdpResult(decision=NOT_APPLICABLE, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={}))
2021-12-29 21:20:13.305  INFO 14 --- [nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=81e59141-48eb-4946-85b3-3b1c5b119b88, content=null, timestamp=1640812813228, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-session-max-inactive-interval=1800, http-req-requested-session-id=9E8C08A9DA29EA6811766C53F823DF88, http-req-remote-port=62598, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=b9c70ccf9dc9, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-cookie-jsessionid=9E8C08A9DA29EA6811766C53F823DF88, http-session-valid=true, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.31.0.1, kc-session-state=5aaaaf61-c3a3-48a9-b85b-5a471e16272a, http-req-server-port=80, http-header-accept=text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8, kc-id=88112c40-dd74-4bd8-a7e2-26292baa101f, http-cookie-oauth_token_request_state=cf9b39b5-9935-4c48-a8bd-f77f2ce607cd, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1640812488526, kc-id-token=rO0ABXNyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAA2FjcnEAfgABTAAHYWRkcmVzc3QALkxvcmcva2V5Y2xvYWsvcmVwcmVzZW50YXRpb25zL0FkZHJlc3NDbGFpbVNldDtMAAlhdXRoX3RpbWV0ABBMamF2YS9sYW5nL0xvbmc7TAAJYmlydGhkYXRlcQB+AAFMAA1jbGFpbXNMb2NhbGVzcQB+AAFMAAhjb2RlSGFzaHEAfgABTAAFZW1haWxxAH4AAUwADWVtYWlsVmVyaWZpZWR0ABNMamF2YS9sYW5nL0Jvb2xlYW47TAAKZmFtaWx5TmFtZXEAfgABTAAGZ2VuZGVycQB+AAFMAAlnaXZlbk5hbWVxAH4AAUwABmxvY2FsZXEAfgABTAAKbWlkZGxlTmFtZXEAfgABTAAEbmFtZXEAfgABTAAIbmlja05hbWVxAH4AAUwABW5vbmNlcQB+AAFMAAtwaG9uZU51bWJlcnEAfgABTAATcGhvbmVOdW1iZXJWZXJpZmllZHEAfgAETAAHcGljdHVyZXEAfgABTAARcHJlZmVycmVkVXNlcm5hbWVxAH4AAUwAB3Byb2ZpbGVxAH4AAUwADHNlc3Npb25TdGF0ZXEAfgABTAAJc3RhdGVIYXNocQB+AAFMAAl1cGRhdGVkQXRxAH4AA0wAB3dlYnNpdGVxAH4AAUwACHpvbmVpbmZvcQB+AAF4cgApb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5Kc29uV2ViVG9rZW6Cc0CQZNbg6gIAClsACGF1ZGllbmNldAATW0xqYXZhL2xhbmcvU3RyaW5nO0wAA2V4cHEAfgADTAADaWF0cQB+AANMAAJpZHEAfgABTAAJaXNzdWVkRm9ycQB+AAFMAAZpc3N1ZXJxAH4AAUwAA25iZnEAfgADTAALb3RoZXJDbGFpbXN0AA9MamF2YS91dGlsL01hcDtMAAdzdWJqZWN0cQB+AAFMAAR0eXBlcQB+AAF4cHVyABNbTGphdmEubGFuZy5TdHJpbmc7rdJW5+kde0cCAAB4cAAAAAF0AA1jYWxscy1nYXRld2F5c3IADmphdmEubGFuZy5Mb25nO4vkkMyPI98CAAFKAAV2YWx1ZXhyABBqYXZhLmxhbmcuTnVtYmVyhqyVHQuU4IsCAAB4cAAAAABhzNE9c3EAfgAMAAAAAGHM0BF0ACQ4ODExMmM0MC1kZDc0LTRiZDgtYTdlMi0yNjI5MmJhYTEwMWZ0AA1jYWxscy1nYXRld2F5dAA2aHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAACSURwdAABMXBzcQB+AAwAAAAAYczQEXBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ1YWFhYWY2MS1jM2EzLTQ4YTktYjg1Yi01YTQ3MWUxNjI3MmFwcHBw, http-req-servlet-path=/rest/acute-care-demo/ambulance, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/ambulance, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1640812861, http-header-upgrade-insecure-requests=1, actionId=GET, http-req-url=/rest/acute-care-demo/ambulance, http-req-uri=/rest/acute-care-demo/ambulance, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/14.1.1 Safari/605.1.15, http-req-query-string=null, http-req-scheme=http, http-header-accept-language=pt-br, http-cookie-csrftoken=5yQ1zZRimgYY62m2wQtsjEi7XLpVcEAdrWHGR3GJrk3eVaLgWPshenCttdp3OyNb, kc-preferred-username=user1, http-req-local-address=172.31.0.11, kc-type=ID, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-header-cookie=csrftoken=5yQ1zZRimgYY62m2wQtsjEi7XLpVcEAdrWHGR3GJrk3eVaLgWPshenCttdp3OyNb; JSESSIONID=9E8C08A9DA29EA6811766C53F823DF88; OAuth_Token_Request_State=cf9b39b5-9935-4c48-a8bd-f77f2ce607cd, kc-email-verified=false, http-req-remote-host=172.31.0.1, http-session-id=9E8C08A9DA29EA6811766C53F823DF88, http-session-last-accessed-time=1640812737148, kc-auth-time=1640812561, kc-category-name=ID, kc-iat=1640812561, kc-category-ordinal=2, user.identifier=172.31.0.1:62598 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2021-12-29 21:20:13.308  INFO 14 --- [nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Request context extracted
2021-12-29 21:20:13.322  INFO 14 --- [nio-7071-exec-5] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-7641634442340-897946, decision=PERMIT, pdp-result=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={})
2021-12-29 21:20:13.323  INFO 14 --- [nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=81e59141-48eb-4946-85b3-3b1c5b119b88, content=PERMIT, timestamp=1640812813323, pdpResult=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={}))
2021-12-29 21:20:48.663  INFO 14 --- [nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=f36bb90d-be63-48d5-a767-ebf3be8f371e, content=null, timestamp=1640812848630, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-session-max-inactive-interval=1800, http-req-requested-session-id=9E8C08A9DA29EA6811766C53F823DF88, http-req-remote-port=62598, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=b9c70ccf9dc9, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-cookie-jsessionid=9E8C08A9DA29EA6811766C53F823DF88, http-session-valid=true, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.31.0.1, kc-session-state=5aaaaf61-c3a3-48a9-b85b-5a471e16272a, http-req-server-port=80, http-header-accept=text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8, kc-id=88112c40-dd74-4bd8-a7e2-26292baa101f, http-cookie-oauth_token_request_state=cf9b39b5-9935-4c48-a8bd-f77f2ce607cd, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1640812488526, kc-id-token=rO0ABXNyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAA2FjcnEAfgABTAAHYWRkcmVzc3QALkxvcmcva2V5Y2xvYWsvcmVwcmVzZW50YXRpb25zL0FkZHJlc3NDbGFpbVNldDtMAAlhdXRoX3RpbWV0ABBMamF2YS9sYW5nL0xvbmc7TAAJYmlydGhkYXRlcQB+AAFMAA1jbGFpbXNMb2NhbGVzcQB+AAFMAAhjb2RlSGFzaHEAfgABTAAFZW1haWxxAH4AAUwADWVtYWlsVmVyaWZpZWR0ABNMamF2YS9sYW5nL0Jvb2xlYW47TAAKZmFtaWx5TmFtZXEAfgABTAAGZ2VuZGVycQB+AAFMAAlnaXZlbk5hbWVxAH4AAUwABmxvY2FsZXEAfgABTAAKbWlkZGxlTmFtZXEAfgABTAAEbmFtZXEAfgABTAAIbmlja05hbWVxAH4AAUwABW5vbmNlcQB+AAFMAAtwaG9uZU51bWJlcnEAfgABTAATcGhvbmVOdW1iZXJWZXJpZmllZHEAfgAETAAHcGljdHVyZXEAfgABTAARcHJlZmVycmVkVXNlcm5hbWVxAH4AAUwAB3Byb2ZpbGVxAH4AAUwADHNlc3Npb25TdGF0ZXEAfgABTAAJc3RhdGVIYXNocQB+AAFMAAl1cGRhdGVkQXRxAH4AA0wAB3dlYnNpdGVxAH4AAUwACHpvbmVpbmZvcQB+AAF4cgApb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5Kc29uV2ViVG9rZW6Cc0CQZNbg6gIAClsACGF1ZGllbmNldAATW0xqYXZhL2xhbmcvU3RyaW5nO0wAA2V4cHEAfgADTAADaWF0cQB+AANMAAJpZHEAfgABTAAJaXNzdWVkRm9ycQB+AAFMAAZpc3N1ZXJxAH4AAUwAA25iZnEAfgADTAALb3RoZXJDbGFpbXN0AA9MamF2YS91dGlsL01hcDtMAAdzdWJqZWN0cQB+AAFMAAR0eXBlcQB+AAF4cHVyABNbTGphdmEubGFuZy5TdHJpbmc7rdJW5+kde0cCAAB4cAAAAAF0AA1jYWxscy1nYXRld2F5c3IADmphdmEubGFuZy5Mb25nO4vkkMyPI98CAAFKAAV2YWx1ZXhyABBqYXZhLmxhbmcuTnVtYmVyhqyVHQuU4IsCAAB4cAAAAABhzNE9c3EAfgAMAAAAAGHM0BF0ACQ4ODExMmM0MC1kZDc0LTRiZDgtYTdlMi0yNjI5MmJhYTEwMWZ0AA1jYWxscy1nYXRld2F5dAA2aHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAACSURwdAABMXBzcQB+AAwAAAAAYczQEXBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ1YWFhYWY2MS1jM2EzLTQ4YTktYjg1Yi01YTQ3MWUxNjI3MmFwcHBw, http-req-servlet-path=/rest/acute-care-demo/hospital, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/hospital, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1640812861, http-header-upgrade-insecure-requests=1, actionId=GET, http-req-url=/rest/acute-care-demo/hospital, http-req-uri=/rest/acute-care-demo/hospital, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/14.1.1 Safari/605.1.15, http-req-query-string=null, http-req-scheme=http, http-header-accept-language=pt-br, http-cookie-csrftoken=5yQ1zZRimgYY62m2wQtsjEi7XLpVcEAdrWHGR3GJrk3eVaLgWPshenCttdp3OyNb, kc-preferred-username=user1, http-req-local-address=172.31.0.11, kc-type=ID, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-header-cookie=csrftoken=5yQ1zZRimgYY62m2wQtsjEi7XLpVcEAdrWHGR3GJrk3eVaLgWPshenCttdp3OyNb; JSESSIONID=9E8C08A9DA29EA6811766C53F823DF88; OAuth_Token_Request_State=cf9b39b5-9935-4c48-a8bd-f77f2ce607cd, kc-email-verified=false, http-req-remote-host=172.31.0.1, http-session-id=9E8C08A9DA29EA6811766C53F823DF88, http-session-last-accessed-time=1640812813354, kc-auth-time=1640812561, kc-category-name=ID, kc-iat=1640812561, kc-category-ordinal=2, user.identifier=172.31.0.1:62598 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2021-12-29 21:20:48.665  INFO 14 --- [nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Request context extracted
2021-12-29 21:20:48.683  INFO 14 --- [nio-7071-exec-6] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-7677028367140-304962, decision=PERMIT, pdp-result=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={})
2021-12-29 21:20:48.684  INFO 14 --- [nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=f36bb90d-be63-48d5-a767-ebf3be8f371e, content=PERMIT, timestamp=1640812848684, pdpResult=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={}))
2021-12-29 21:21:07.431  INFO 14 --- [nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=4fb34aa1-3d6e-4f32-933f-ea537b661122, content=null, timestamp=1640812867402, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=true, http-session-max-inactive-interval=1800, http-req-requested-session-id=9E8C08A9DA29EA6811766C53F823DF88, http-req-remote-port=62598, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=b9c70ccf9dc9, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-cookie-jsessionid=9E8C08A9DA29EA6811766C53F823DF88, http-session-valid=true, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.31.0.1, kc-session-state=5aaaaf61-c3a3-48a9-b85b-5a471e16272a, http-req-server-port=80, http-header-accept=text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8, kc-id=88112c40-dd74-4bd8-a7e2-26292baa101f, http-cookie-oauth_token_request_state=cf9b39b5-9935-4c48-a8bd-f77f2ce607cd, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1640812488526, kc-id-token=rO0ABXNyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAA2FjcnEAfgABTAAHYWRkcmVzc3QALkxvcmcva2V5Y2xvYWsvcmVwcmVzZW50YXRpb25zL0FkZHJlc3NDbGFpbVNldDtMAAlhdXRoX3RpbWV0ABBMamF2YS9sYW5nL0xvbmc7TAAJYmlydGhkYXRlcQB+AAFMAA1jbGFpbXNMb2NhbGVzcQB+AAFMAAhjb2RlSGFzaHEAfgABTAAFZW1haWxxAH4AAUwADWVtYWlsVmVyaWZpZWR0ABNMamF2YS9sYW5nL0Jvb2xlYW47TAAKZmFtaWx5TmFtZXEAfgABTAAGZ2VuZGVycQB+AAFMAAlnaXZlbk5hbWVxAH4AAUwABmxvY2FsZXEAfgABTAAKbWlkZGxlTmFtZXEAfgABTAAEbmFtZXEAfgABTAAIbmlja05hbWVxAH4AAUwABW5vbmNlcQB+AAFMAAtwaG9uZU51bWJlcnEAfgABTAATcGhvbmVOdW1iZXJWZXJpZmllZHEAfgAETAAHcGljdHVyZXEAfgABTAARcHJlZmVycmVkVXNlcm5hbWVxAH4AAUwAB3Byb2ZpbGVxAH4AAUwADHNlc3Npb25TdGF0ZXEAfgABTAAJc3RhdGVIYXNocQB+AAFMAAl1cGRhdGVkQXRxAH4AA0wAB3dlYnNpdGVxAH4AAUwACHpvbmVpbmZvcQB+AAF4cgApb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5Kc29uV2ViVG9rZW6Cc0CQZNbg6gIAClsACGF1ZGllbmNldAATW0xqYXZhL2xhbmcvU3RyaW5nO0wAA2V4cHEAfgADTAADaWF0cQB+AANMAAJpZHEAfgABTAAJaXNzdWVkRm9ycQB+AAFMAAZpc3N1ZXJxAH4AAUwAA25iZnEAfgADTAALb3RoZXJDbGFpbXN0AA9MamF2YS91dGlsL01hcDtMAAdzdWJqZWN0cQB+AAFMAAR0eXBlcQB+AAF4cHVyABNbTGphdmEubGFuZy5TdHJpbmc7rdJW5+kde0cCAAB4cAAAAAF0AA1jYWxscy1nYXRld2F5c3IADmphdmEubGFuZy5Mb25nO4vkkMyPI98CAAFKAAV2YWx1ZXhyABBqYXZhLmxhbmcuTnVtYmVyhqyVHQuU4IsCAAB4cAAAAABhzNE9c3EAfgAMAAAAAGHM0BF0ACQ4ODExMmM0MC1kZDc0LTRiZDgtYTdlMi0yNjI5MmJhYTEwMWZ0AA1jYWxscy1nYXRld2F5dAA2aHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAACSURwdAABMXBzcQB+AAwAAAAAYczQEXBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ1YWFhYWY2MS1jM2EzLTQ4YTktYjg1Yi01YTQ3MWUxNjI3MmFwcHBw, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=false, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1640812861, http-header-upgrade-insecure-requests=1, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/14.1.1 Safari/605.1.15, http-req-query-string=null, http-req-scheme=http, http-header-accept-language=pt-br, http-cookie-csrftoken=5yQ1zZRimgYY62m2wQtsjEi7XLpVcEAdrWHGR3GJrk3eVaLgWPshenCttdp3OyNb, kc-preferred-username=user1, http-req-local-address=172.31.0.11, kc-type=ID, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-header-cookie=csrftoken=5yQ1zZRimgYY62m2wQtsjEi7XLpVcEAdrWHGR3GJrk3eVaLgWPshenCttdp3OyNb; JSESSIONID=9E8C08A9DA29EA6811766C53F823DF88; OAuth_Token_Request_State=cf9b39b5-9935-4c48-a8bd-f77f2ce607cd, kc-email-verified=false, http-req-remote-host=172.31.0.1, http-session-id=9E8C08A9DA29EA6811766C53F823DF88, http-session-last-accessed-time=1640812848728, kc-auth-time=1640812561, kc-category-name=ID, kc-iat=1640812561, kc-category-ordinal=2, user.identifier=172.31.0.1:62598 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2021-12-29 21:21:07.434  INFO 14 --- [nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Request context extracted
2021-12-29 21:21:07.453  INFO 14 --- [nio-7071-exec-7] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-7695830434940-401182, decision=PERMIT, pdp-result=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={})
2021-12-29 21:21:07.454  INFO 14 --- [nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=4fb34aa1-3d6e-4f32-933f-ea537b661122, content=PERMIT, timestamp=1640812867454, pdpResult=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={}))
2021-12-29 21:21:09.135  INFO 14 --- [nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=d9cb4a90-06a4-4105-bd6b-f36307f5502f, content=null, timestamp=1640812869099, xacmlRequest={http-header-accept-encoding=gzip, deflate, http-header-referer=http://192.168.1.83/rest/acute-care-demo/call-centre, kc-acr=1, kc-is-expired=true, http-session-max-inactive-interval=1800, http-req-requested-session-id=9E8C08A9DA29EA6811766C53F823DF88, http-req-remote-port=62598, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-param-upload=upload, http-req-local-name=b9c70ccf9dc9, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-cookie-jsessionid=9E8C08A9DA29EA6811766C53F823DF88, http-session-valid=true, http-req-content-length=98, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.31.0.1, kc-session-state=5aaaaf61-c3a3-48a9-b85b-5a471e16272a, http-req-server-port=80, http-header-accept=text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8, kc-id=88112c40-dd74-4bd8-a7e2-26292baa101f, http-cookie-oauth_token_request_state=cf9b39b5-9935-4c48-a8bd-f77f2ce607cd, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=application/x-www-form-urlencoded;charset=UTF-8, http-header-host=192.168.1.83, http-session-creation-time=1640812488526, kc-id-token=rO0ABXNyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAA2FjcnEAfgABTAAHYWRkcmVzc3QALkxvcmcva2V5Y2xvYWsvcmVwcmVzZW50YXRpb25zL0FkZHJlc3NDbGFpbVNldDtMAAlhdXRoX3RpbWV0ABBMamF2YS9sYW5nL0xvbmc7TAAJYmlydGhkYXRlcQB+AAFMAA1jbGFpbXNMb2NhbGVzcQB+AAFMAAhjb2RlSGFzaHEAfgABTAAFZW1haWxxAH4AAUwADWVtYWlsVmVyaWZpZWR0ABNMamF2YS9sYW5nL0Jvb2xlYW47TAAKZmFtaWx5TmFtZXEAfgABTAAGZ2VuZGVycQB+AAFMAAlnaXZlbk5hbWVxAH4AAUwABmxvY2FsZXEAfgABTAAKbWlkZGxlTmFtZXEAfgABTAAEbmFtZXEAfgABTAAIbmlja05hbWVxAH4AAUwABW5vbmNlcQB+AAFMAAtwaG9uZU51bWJlcnEAfgABTAATcGhvbmVOdW1iZXJWZXJpZmllZHEAfgAETAAHcGljdHVyZXEAfgABTAARcHJlZmVycmVkVXNlcm5hbWVxAH4AAUwAB3Byb2ZpbGVxAH4AAUwADHNlc3Npb25TdGF0ZXEAfgABTAAJc3RhdGVIYXNocQB+AAFMAAl1cGRhdGVkQXRxAH4AA0wAB3dlYnNpdGVxAH4AAUwACHpvbmVpbmZvcQB+AAF4cgApb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5Kc29uV2ViVG9rZW6Cc0CQZNbg6gIAClsACGF1ZGllbmNldAATW0xqYXZhL2xhbmcvU3RyaW5nO0wAA2V4cHEAfgADTAADaWF0cQB+AANMAAJpZHEAfgABTAAJaXNzdWVkRm9ycQB+AAFMAAZpc3N1ZXJxAH4AAUwAA25iZnEAfgADTAALb3RoZXJDbGFpbXN0AA9MamF2YS91dGlsL01hcDtMAAdzdWJqZWN0cQB+AAFMAAR0eXBlcQB+AAF4cHVyABNbTGphdmEubGFuZy5TdHJpbmc7rdJW5+kde0cCAAB4cAAAAAF0AA1jYWxscy1nYXRld2F5c3IADmphdmEubGFuZy5Mb25nO4vkkMyPI98CAAFKAAV2YWx1ZXhyABBqYXZhLmxhbmcuTnVtYmVyhqyVHQuU4IsCAAB4cAAAAABhzNE9c3EAfgAMAAAAAGHM0BF0ACQ4ODExMmM0MC1kZDc0LTRiZDgtYTdlMi0yNjI5MmJhYTEwMWZ0AA1jYWxscy1nYXRld2F5dAA2aHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAACSURwdAABMXBzcQB+AAwAAAAAYczQEXBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ1YWFhYWY2MS1jM2EzLTQ4YTktYjg1Yi01YTQ3MWUxNjI3MmFwcHBw, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=false, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1640812861, http-header-upgrade-insecure-requests=1, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-param-csrfmiddlewaretoken=EnqEyO7mwM3v3NrmEWpnudvba3zCFlD20LhjQSWNBQ8LSVQA4VocpWPxGvzKhfQ0, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/14.1.1 Safari/605.1.15, http-req-query-string=null, http-req-scheme=http, http-header-accept-language=pt-br, http-cookie-csrftoken=5yQ1zZRimgYY62m2wQtsjEi7XLpVcEAdrWHGR3GJrk3eVaLgWPshenCttdp3OyNb, kc-preferred-username=user1, http-header-content-length=98, http-req-local-address=172.31.0.11, kc-type=ID, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-header-content-type=application/x-www-form-urlencoded, http-header-cookie=csrftoken=5yQ1zZRimgYY62m2wQtsjEi7XLpVcEAdrWHGR3GJrk3eVaLgWPshenCttdp3OyNb; JSESSIONID=9E8C08A9DA29EA6811766C53F823DF88; OAuth_Token_Request_State=cf9b39b5-9935-4c48-a8bd-f77f2ce607cd, kc-email-verified=false, http-req-remote-host=172.31.0.1, http-session-id=9E8C08A9DA29EA6811766C53F823DF88, http-session-last-accessed-time=1640812867554, kc-auth-time=1640812561, kc-category-name=ID, kc-iat=1640812561, http-header-origin=http://192.168.1.83, kc-category-ordinal=2, user.identifier=172.31.0.1:62598 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2021-12-29 21:21:09.147  INFO 14 --- [nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Request context extracted
2021-12-29 21:21:09.154  INFO 14 --- [nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7f5c611a
2021-12-29 21:21:09.156  INFO 14 --- [nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7f5c611a
2021-12-29 21:21:09.158  INFO 14 --- [nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: http-param-patient-id, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7f5c611a
2021-12-29 21:21:09.160  INFO 14 --- [nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: http-param-es-id, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7f5c611a
2021-12-29 21:21:09.174 ERROR 14 --- [nio-7071-exec-8] e.a.a.a.s.pdp.AuthorizationServicePDP    : EXCEPTION while evaluating access request: 

java.lang.NullPointerException: null
	at java.lang.String.replace(String.java:2240) ~[na:1.8.0_212]
	at eu.asclepios.example.contexthandlers.CustomRestAttributeFinder.callRestProvider(CustomRestAttributeFinder.java:299) ~[abac-example-context-handlers-1.0.0-SNAPSHOT-jar-with-dependencies.jar:na]
	at eu.asclepios.example.contexthandlers.CustomRestAttributeFinder.findAttribute(CustomRestAttributeFinder.java:90) ~[abac-example-context-handlers-1.0.0-SNAPSHOT-jar-with-dependencies.jar:na]
	at org.wso2.balana.finder.AttributeFinder.findAttribute(AttributeFinder.java:163) ~[org.wso2.balana-1.1.12.jar!/:na]
	at org.wso2.balana.ctx.BasicEvaluationCtx.callHelper(BasicEvaluationCtx.java:227) ~[org.wso2.balana-1.1.12.jar!/:na]
	at org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx.getAttribute(XACML3EvaluationCtx.java:143) ~[org.wso2.balana-1.1.12.jar!/:na]
	at org.wso2.balana.attr.xacml3.AttributeDesignator.evaluate(AttributeDesignator.java:246) ~[org.wso2.balana-1.1.12.jar!/:na]
	at org.wso2.balana.cond.FunctionBase.evalArgs(FunctionBase.java:322) ~[org.wso2.balana-1.1.12.jar!/:na]
	at org.wso2.balana.cond.GeneralBagFunction.evaluate(GeneralBagFunction.java:237) ~[org.wso2.balana-1.1.12.jar!/:na]
	at org.wso2.balana.cond.Apply.evaluate(Apply.java:277) ~[org.wso2.balana-1.1.12.jar!/:na]
	at org.wso2.balana.cond.FunctionBase.evalArgs(FunctionBase.java:322) ~[org.wso2.balana-1.1.12.jar!/:na]
	at org.wso2.balana.cond.ComparisonFunction.evaluate(ComparisonFunction.java:344) ~[org.wso2.balana-1.1.12.jar!/:na]
	at org.wso2.balana.cond.Apply.evaluate(Apply.java:277) ~[org.wso2.balana-1.1.12.jar!/:na]
	at org.wso2.balana.cond.FunctionBase.evalArgs(FunctionBase.java:322) ~[org.wso2.balana-1.1.12.jar!/:na]
	at org.wso2.balana.cond.NotFunction.evaluate(NotFunction.java:105) ~[org.wso2.balana-1.1.12.jar!/:na]
	at org.wso2.balana.cond.Apply.evaluate(Apply.java:277) ~[org.wso2.balana-1.1.12.jar!/:na]
	at org.wso2.balana.cond.LogicalFunction.evaluate(LogicalFunction.java:133) ~[org.wso2.balana-1.1.12.jar!/:na]
	at org.wso2.balana.cond.Apply.evaluate(Apply.java:277) ~[org.wso2.balana-1.1.12.jar!/:na]
	at org.wso2.balana.cond.Condition.evaluate(Condition.java:253) ~[org.wso2.balana-1.1.12.jar!/:na]
	at org.wso2.balana.Rule.evaluate(Rule.java:397) ~[org.wso2.balana-1.1.12.jar!/:na]
	at org.wso2.balana.combine.xacml3.PermitUnlessDenyRuleAlg.combine(PermitUnlessDenyRuleAlg.java:94) ~[org.wso2.balana-1.1.12.jar!/:na]
	at org.wso2.balana.AbstractPolicy.evaluate(AbstractPolicy.java:570) ~[org.wso2.balana-1.1.12.jar!/:na]
	at org.wso2.balana.PDP.evaluateContext(PDP.java:262) ~[org.wso2.balana-1.1.12.jar!/:na]
	at org.wso2.balana.PDP.evaluate(PDP.java:195) ~[org.wso2.balana-1.1.12.jar!/:na]
	at org.wso2.balana.PDP.evaluate(PDP.java:154) ~[org.wso2.balana-1.1.12.jar!/:na]
	at eu.asclepios.authorization.abac.server.pdp.AuthorizationServicePDP.__evaluateRequest(AuthorizationServicePDP.java:247) ~[classes!/:2.0.0-SNAPSHOT]
	at eu.asclepios.authorization.abac.server.pdp.AuthorizationServicePDP.evaluateRequest(AuthorizationServicePDP.java:231) ~[classes!/:2.0.0-SNAPSHOT]
	at eu.asclepios.authorization.abac.server.PdpServerController.checkJsonAccessRequest(PdpServerController.java:96) [classes!/:2.0.0-SNAPSHOT]
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[na:1.8.0_212]
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[na:1.8.0_212]
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[na:1.8.0_212]
	at java.lang.reflect.Method.invoke(Method.java:498) ~[na:1.8.0_212]
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:190) [spring-web-5.2.12.RELEASE.jar!/:5.2.12.RELEASE]
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:138) [spring-web-5.2.12.RELEASE.jar!/:5.2.12.RELEASE]
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:105) [spring-webmvc-5.2.12.RELEASE.jar!/:5.2.12.RELEASE]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:878) [spring-webmvc-5.2.12.RELEASE.jar!/:5.2.12.RELEASE]
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:792) [spring-webmvc-5.2.12.RELEASE.jar!/:5.2.12.RELEASE]
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87) [spring-webmvc-5.2.12.RELEASE.jar!/:5.2.12.RELEASE]
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1040) [spring-webmvc-5.2.12.RELEASE.jar!/:5.2.12.RELEASE]
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:943) [spring-webmvc-5.2.12.RELEASE.jar!/:5.2.12.RELEASE]
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1006) [spring-webmvc-5.2.12.RELEASE.jar!/:5.2.12.RELEASE]
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:909) [spring-webmvc-5.2.12.RELEASE.jar!/:5.2.12.RELEASE]
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:652) [tomcat-embed-core-9.0.41.jar!/:4.0.FR]
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:883) [spring-webmvc-5.2.12.RELEASE.jar!/:5.2.12.RELEASE]
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:733) [tomcat-embed-core-9.0.41.jar!/:4.0.FR]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:231) [tomcat-embed-core-9.0.41.jar!/:9.0.41]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166) [tomcat-embed-core-9.0.41.jar!/:9.0.41]
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:53) [tomcat-embed-websocket-9.0.41.jar!/:9.0.41]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193) [tomcat-embed-core-9.0.41.jar!/:9.0.41]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166) [tomcat-embed-core-9.0.41.jar!/:9.0.41]
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100) [spring-web-5.2.12.RELEASE.jar!/:5.2.12.RELEASE]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119) [spring-web-5.2.12.RELEASE.jar!/:5.2.12.RELEASE]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193) [tomcat-embed-core-9.0.41.jar!/:9.0.41]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166) [tomcat-embed-core-9.0.41.jar!/:9.0.41]
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93) [spring-web-5.2.12.RELEASE.jar!/:5.2.12.RELEASE]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119) [spring-web-5.2.12.RELEASE.jar!/:5.2.12.RELEASE]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193) [tomcat-embed-core-9.0.41.jar!/:9.0.41]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166) [tomcat-embed-core-9.0.41.jar!/:9.0.41]
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201) [spring-web-5.2.12.RELEASE.jar!/:5.2.12.RELEASE]
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:119) [spring-web-5.2.12.RELEASE.jar!/:5.2.12.RELEASE]
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193) [tomcat-embed-core-9.0.41.jar!/:9.0.41]
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166) [tomcat-embed-core-9.0.41.jar!/:9.0.41]
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:202) [tomcat-embed-core-9.0.41.jar!/:9.0.41]
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:97) [tomcat-embed-core-9.0.41.jar!/:9.0.41]
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:542) [tomcat-embed-core-9.0.41.jar!/:9.0.41]
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:143) [tomcat-embed-core-9.0.41.jar!/:9.0.41]
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:92) [tomcat-embed-core-9.0.41.jar!/:9.0.41]
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:78) [tomcat-embed-core-9.0.41.jar!/:9.0.41]
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343) [tomcat-embed-core-9.0.41.jar!/:9.0.41]
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:374) [tomcat-embed-core-9.0.41.jar!/:9.0.41]
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:65) [tomcat-embed-core-9.0.41.jar!/:9.0.41]
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:888) [tomcat-embed-core-9.0.41.jar!/:9.0.41]
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1597) [tomcat-embed-core-9.0.41.jar!/:9.0.41]
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:49) [tomcat-embed-core-9.0.41.jar!/:9.0.41]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149) [na:1.8.0_212]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624) [na:1.8.0_212]
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61) [tomcat-embed-core-9.0.41.jar!/:9.0.41]
	at java.lang.Thread.run(Thread.java:748) [na:1.8.0_212]

2021-12-29 21:21:09.183  INFO 14 --- [nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=d9cb4a90-06a4-4105-bd6b-f36307f5502f, content=ERROR, timestamp=1640812869183, pdpResult=PdpResult(decision=ERROR, statusCodes=null, statusDetails=null, statusMessage=null, obligations=null))
2021-12-29 21:22:46.024  INFO 14 --- [nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=84528984-b509-41a5-964d-58c45ca5a6c2, content=null, timestamp=1640812965954, xacmlRequest={http-header-referer=http://192.168.1.83/rest/acute-care-demo/call-centre, http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=true, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=9E8C08A9DA29EA6811766C53F823DF88, http-req-remote-port=62606, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=b9c70ccf9dc9, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-cookie-jsessionid=9E8C08A9DA29EA6811766C53F823DF88, http-session-valid=true, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.31.0.1, kc-session-state=5aaaaf61-c3a3-48a9-b85b-5a471e16272a, http-req-server-port=80, http-header-accept=text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8, kc-id=88112c40-dd74-4bd8-a7e2-26292baa101f, http-cookie-oauth_token_request_state=cf9b39b5-9935-4c48-a8bd-f77f2ce607cd, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1640812488526, kc-id-token=rO0ABXNyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAA2FjcnEAfgABTAAHYWRkcmVzc3QALkxvcmcva2V5Y2xvYWsvcmVwcmVzZW50YXRpb25zL0FkZHJlc3NDbGFpbVNldDtMAAlhdXRoX3RpbWV0ABBMamF2YS9sYW5nL0xvbmc7TAAJYmlydGhkYXRlcQB+AAFMAA1jbGFpbXNMb2NhbGVzcQB+AAFMAAhjb2RlSGFzaHEAfgABTAAFZW1haWxxAH4AAUwADWVtYWlsVmVyaWZpZWR0ABNMamF2YS9sYW5nL0Jvb2xlYW47TAAKZmFtaWx5TmFtZXEAfgABTAAGZ2VuZGVycQB+AAFMAAlnaXZlbk5hbWVxAH4AAUwABmxvY2FsZXEAfgABTAAKbWlkZGxlTmFtZXEAfgABTAAEbmFtZXEAfgABTAAIbmlja05hbWVxAH4AAUwABW5vbmNlcQB+AAFMAAtwaG9uZU51bWJlcnEAfgABTAATcGhvbmVOdW1iZXJWZXJpZmllZHEAfgAETAAHcGljdHVyZXEAfgABTAARcHJlZmVycmVkVXNlcm5hbWVxAH4AAUwAB3Byb2ZpbGVxAH4AAUwADHNlc3Npb25TdGF0ZXEAfgABTAAJc3RhdGVIYXNocQB+AAFMAAl1cGRhdGVkQXRxAH4AA0wAB3dlYnNpdGVxAH4AAUwACHpvbmVpbmZvcQB+AAF4cgApb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5Kc29uV2ViVG9rZW6Cc0CQZNbg6gIAClsACGF1ZGllbmNldAATW0xqYXZhL2xhbmcvU3RyaW5nO0wAA2V4cHEAfgADTAADaWF0cQB+AANMAAJpZHEAfgABTAAJaXNzdWVkRm9ycQB+AAFMAAZpc3N1ZXJxAH4AAUwAA25iZnEAfgADTAALb3RoZXJDbGFpbXN0AA9MamF2YS91dGlsL01hcDtMAAdzdWJqZWN0cQB+AAFMAAR0eXBlcQB+AAF4cHVyABNbTGphdmEubGFuZy5TdHJpbmc7rdJW5+kde0cCAAB4cAAAAAF0AA1jYWxscy1nYXRld2F5c3IADmphdmEubGFuZy5Mb25nO4vkkMyPI98CAAFKAAV2YWx1ZXhyABBqYXZhLmxhbmcuTnVtYmVyhqyVHQuU4IsCAAB4cAAAAABhzNE9c3EAfgAMAAAAAGHM0BF0ACQ4ODExMmM0MC1kZDc0LTRiZDgtYTdlMi0yNjI5MmJhYTEwMWZ0AA1jYWxscy1nYXRld2F5dAA2aHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAACSURwdAABMXBzcQB+AAwAAAAAYczQEXBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ1YWFhYWY2MS1jM2EzLTQ4YTktYjg1Yi01YTQ3MWUxNjI3MmFwcHBw, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=false, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1640812861, http-header-upgrade-insecure-requests=1, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/14.1.1 Safari/605.1.15, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, http-header-accept-language=pt-br, http-cookie-csrftoken=5yQ1zZRimgYY62m2wQtsjEi7XLpVcEAdrWHGR3GJrk3eVaLgWPshenCttdp3OyNb, kc-preferred-username=user1, http-req-local-address=172.31.0.11, kc-type=ID, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, http-header-cookie=csrftoken=5yQ1zZRimgYY62m2wQtsjEi7XLpVcEAdrWHGR3GJrk3eVaLgWPshenCttdp3OyNb; JSESSIONID=9E8C08A9DA29EA6811766C53F823DF88; OAuth_Token_Request_State=cf9b39b5-9935-4c48-a8bd-f77f2ce607cd, kc-email-verified=false, http-req-remote-host=172.31.0.1, http-session-id=9E8C08A9DA29EA6811766C53F823DF88, http-session-last-accessed-time=1640812869216, kc-auth-time=1640812561, kc-category-name=ID, kc-iat=1640812561, kc-category-ordinal=2, http-param-patient-id=100, user.identifier=172.31.0.1:62606 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2021-12-29 21:22:46.032  INFO 14 --- [nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Request context extracted
2021-12-29 21:22:46.037  INFO 14 --- [nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@641c02d0
2021-12-29 21:22:46.039  INFO 14 --- [nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@641c02d0
2021-12-29 21:22:46.880  INFO 14 --- [nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@641c02d0
2021-12-29 21:22:46.881  INFO 14 --- [nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@641c02d0
2021-12-29 21:22:46.920  INFO 14 --- [nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@641c02d0
2021-12-29 21:22:46.921  WARN 14 --- [nio-7071-exec-3] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2021-12-29 21:22:46.924  WARN 14 --- [nio-7071-exec-3] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2021-12-29 21:22:46.926  INFO 14 --- [nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: under-emergency, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@641c02d0
2021-12-29 21:22:46.979  INFO 14 --- [nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@641c02d0
2021-12-29 21:22:46.982  WARN 14 --- [nio-7071-exec-3] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2021-12-29 21:22:46.984  WARN 14 --- [nio-7071-exec-3] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2021-12-29 21:22:46.986  INFO 14 --- [nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@641c02d0
2021-12-29 21:22:47.049  INFO 14 --- [nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@641c02d0
2021-12-29 21:22:47.051  INFO 14 --- [nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-invite, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@641c02d0
2021-12-29 21:22:47.144  INFO 14 --- [nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@641c02d0
2021-12-29 21:22:47.145  INFO 14 --- [nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-revoke, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@641c02d0
2021-12-29 21:22:47.197  INFO 14 --- [nio-7071-exec-3] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-7794531187740-756412, decision=PERMIT, pdp-result=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}})
2021-12-29 21:22:47.199  INFO 14 --- [nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=84528984-b509-41a5-964d-58c45ca5a6c2, content=PERMIT, timestamp=1640812967199, pdpResult=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d, asclepios:obligation:name=Read-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}}))
2021-12-29 21:22:55.238  INFO 14 --- [nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=67cee536-a9d9-4e49-8d26-d6a28b9d4cd2, content=null, timestamp=1640812975216, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=true, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=9E8C08A9DA29EA6811766C53F823DF88, http-req-remote-port=62606, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=b9c70ccf9dc9, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=GET, http-cookie-jsessionid=9E8C08A9DA29EA6811766C53F823DF88, http-session-valid=true, http-req-content-length=-1, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.31.0.1, kc-session-state=5aaaaf61-c3a3-48a9-b85b-5a471e16272a, http-req-server-port=80, http-header-accept=text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8, kc-id=88112c40-dd74-4bd8-a7e2-26292baa101f, http-cookie-oauth_token_request_state=cf9b39b5-9935-4c48-a8bd-f77f2ce607cd, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1640812488526, kc-id-token=rO0ABXNyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAA2FjcnEAfgABTAAHYWRkcmVzc3QALkxvcmcva2V5Y2xvYWsvcmVwcmVzZW50YXRpb25zL0FkZHJlc3NDbGFpbVNldDtMAAlhdXRoX3RpbWV0ABBMamF2YS9sYW5nL0xvbmc7TAAJYmlydGhkYXRlcQB+AAFMAA1jbGFpbXNMb2NhbGVzcQB+AAFMAAhjb2RlSGFzaHEAfgABTAAFZW1haWxxAH4AAUwADWVtYWlsVmVyaWZpZWR0ABNMamF2YS9sYW5nL0Jvb2xlYW47TAAKZmFtaWx5TmFtZXEAfgABTAAGZ2VuZGVycQB+AAFMAAlnaXZlbk5hbWVxAH4AAUwABmxvY2FsZXEAfgABTAAKbWlkZGxlTmFtZXEAfgABTAAEbmFtZXEAfgABTAAIbmlja05hbWVxAH4AAUwABW5vbmNlcQB+AAFMAAtwaG9uZU51bWJlcnEAfgABTAATcGhvbmVOdW1iZXJWZXJpZmllZHEAfgAETAAHcGljdHVyZXEAfgABTAARcHJlZmVycmVkVXNlcm5hbWVxAH4AAUwAB3Byb2ZpbGVxAH4AAUwADHNlc3Npb25TdGF0ZXEAfgABTAAJc3RhdGVIYXNocQB+AAFMAAl1cGRhdGVkQXRxAH4AA0wAB3dlYnNpdGVxAH4AAUwACHpvbmVpbmZvcQB+AAF4cgApb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5Kc29uV2ViVG9rZW6Cc0CQZNbg6gIAClsACGF1ZGllbmNldAATW0xqYXZhL2xhbmcvU3RyaW5nO0wAA2V4cHEAfgADTAADaWF0cQB+AANMAAJpZHEAfgABTAAJaXNzdWVkRm9ycQB+AAFMAAZpc3N1ZXJxAH4AAUwAA25iZnEAfgADTAALb3RoZXJDbGFpbXN0AA9MamF2YS91dGlsL01hcDtMAAdzdWJqZWN0cQB+AAFMAAR0eXBlcQB+AAF4cHVyABNbTGphdmEubGFuZy5TdHJpbmc7rdJW5+kde0cCAAB4cAAAAAF0AA1jYWxscy1nYXRld2F5c3IADmphdmEubGFuZy5Mb25nO4vkkMyPI98CAAFKAAV2YWx1ZXhyABBqYXZhLmxhbmcuTnVtYmVyhqyVHQuU4IsCAAB4cAAAAABhzNE9c3EAfgAMAAAAAGHM0BF0ACQ4ODExMmM0MC1kZDc0LTRiZDgtYTdlMi0yNjI5MmJhYTEwMWZ0AA1jYWxscy1nYXRld2F5dAA2aHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlcHNyABFqYXZhLnV0aWwuSGFzaE1hcAUH2sHDFmDRAwACRgAKbG9hZEZhY3RvckkACXRocmVzaG9sZHhwP0AAAAAAAAx3CAAAABAAAAAFdAANbWVkaWNhbC1yb2xlc3QAEnh4eCxhbWJ1bGFuY2UtY3Jld3QAEWFtYnVsYW5jZS1jcmV3LWlkdAAWYW1idWxhbmNlLWNyZXctaWQtMTIzNHQAA0RPQnQACjE5ODAtMDQtMDV0AAd1c2VyLUlEdAACMTB0AAd0ZWFtLUlEdAACMTB4dAAkM2YwYjM5Y2ItMGExYi00NDI4LWIzNmYtYjhjMDk4MTI2ZGJkdAACSURwdAABMXBzcQB+AAwAAAAAYczQEXBwcHBzcgARamF2YS5sYW5nLkJvb2xlYW7NIHKA1Zz67gIAAVoABXZhbHVleHAAcHBwcHBwcHBwcHB0AAV1c2VyMXB0ACQ1YWFhYWY2MS1jM2EzLTQ4YTktYjg1Yi01YTQ3MWUxNjI3MmFwcHBw, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=false, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1640812861, http-header-upgrade-insecure-requests=1, actionId=GET, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/14.1.1 Safari/605.1.15, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, http-header-accept-language=pt-br, http-cookie-csrftoken=5yQ1zZRimgYY62m2wQtsjEi7XLpVcEAdrWHGR3GJrk3eVaLgWPshenCttdp3OyNb, kc-preferred-username=user1, http-req-local-address=172.31.0.11, kc-type=ID, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, http-header-cookie=csrftoken=5yQ1zZRimgYY62m2wQtsjEi7XLpVcEAdrWHGR3GJrk3eVaLgWPshenCttdp3OyNb; JSESSIONID=9E8C08A9DA29EA6811766C53F823DF88; OAuth_Token_Request_State=cf9b39b5-9935-4c48-a8bd-f77f2ce607cd, kc-email-verified=false, http-req-remote-host=172.31.0.1, http-session-id=9E8C08A9DA29EA6811766C53F823DF88, http-session-last-accessed-time=1640812967322, kc-auth-time=1640812561, kc-category-name=ID, kc-iat=1640812561, kc-category-ordinal=2, http-param-patient-id=100, user.identifier=172.31.0.1:62606 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2021-12-29 21:22:55.242  INFO 14 --- [nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Request context extracted
2021-12-29 21:22:55.251  INFO 14 --- [nio-7071-exec-4] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-7803741694840-32204, decision=PERMIT, pdp-result=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={})
2021-12-29 21:22:55.252  INFO 14 --- [nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=67cee536-a9d9-4e49-8d26-d6a28b9d4cd2, content=PERMIT, timestamp=1640812975252, pdpResult=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={}))
2021-12-29 21:23:17.808  INFO 14 --- [nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=29f5e4be-76b0-4e3f-a879-71fbda57bf46, content=null, timestamp=1640812997774, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=62614, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=b9c70ccf9dc9, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.31.0.1, kc-session-state=aaad9daf-6c00-4e38-aada-3833271cc0e4, http-req-server-port=80, http-header-accept=*/*, kc-id=2bd1af23-103c-4c2e-b974-30b0147db875, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1640812997760, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYczS8XNxAH4AEQAAAABhzNHFdAAkMmJkMWFmMjMtMTAzYy00YzJlLWI5NzQtMzBiMDE0N2RiODc1dAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkYWFhZDlkYWYtNmMwMC00ZTM4LWFhZGEtMzgzMzI3MWNjMGU0cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJESFp6RXFmTnRfR3I5TEo1RnRqR3YyUTYwTlNKRnRYell0eVZMQTNjOHZVIn0.eyJleHAiOjE2NDA4MTMyOTcsImlhdCI6MTY0MDgxMjk5NywianRpIjoiMmJkMWFmMjMtMTAzYy00YzJlLWI5NzQtMzBiMDE0N2RiODc1IiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiYWFhZDlkYWYtNmMwMC00ZTM4LWFhZGEtMzgzMzI3MWNjMGU0IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.s-Eqltlwkcmzu06TzXjVEBjBnMPefmD5UChyHi9XLjVjCCtzwjME3CvRhCRNXDwIzzDxv-aMaiQn0SQo0KbxCma1x-VejC17Kdm5Yx5qDgqYFXOUghTdsHwzKxOJO3jHiQnXJ7FmCc18c81lk2_LJusRkIPDb7W6YyhTQbTsPvY3ZfapxEDcnzW_Kna0_hxSkZfvzVoBBK9jWf_BhfEeja3Gya2Rpm6Vhfa2cgQqXydc_AxlwcRy3Y9nxB_vtgaKpFDRjacpJDwRnvHyxZRC6TOsNJeGQz_5C5DP6oB7DkGud_qMayA5_1G5Ht3SQBIwWL-rR9vt82vmkUq-164Rtg, http-req-servlet-path=/rest/acute-care-demo/call-centre/read, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre/read, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1640813297, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre/read, http-req-uri=/rest/acute-care-demo/call-centre/read, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.31.0.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.31.0.1, http-session-id=707DE01DC247F15F95CFB9142A520C3C, http-session-last-accessed-time=1640812997760, kc-category-name=ACCESS, kc-iat=1640812997, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.31.0.1:62614 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2021-12-29 21:23:17.812  INFO 14 --- [nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Request context extracted
2021-12-29 21:23:17.816  INFO 14 --- [nio-7071-exec-5] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-7826345916140-769977, decision=NOT_APPLICABLE, pdp-result=PdpResult(decision=NOT_APPLICABLE, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={})
2021-12-29 21:23:17.817  INFO 14 --- [nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=29f5e4be-76b0-4e3f-a879-71fbda57bf46, content=NOT_APPLICABLE, timestamp=1640812997817, pdpResult=PdpResult(decision=NOT_APPLICABLE, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={}))
2021-12-29 21:24:42.859  INFO 14 --- [io-7071-exec-10] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=1875315a-929d-474d-b539-14d92a00c0ae, content=null, timestamp=1640813082791, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=62618, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=b9c70ccf9dc9, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.31.0.1, kc-session-state=e2776bce-4c50-4768-8908-231cce03db69, http-req-server-port=80, http-header-accept=*/*, kc-id=448d65c9-b0aa-4c94-86ba-9812c34e530b, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1640813082789, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYczTRnNxAH4AEQAAAABhzNIadAAkNDQ4ZDY1YzktYjBhYS00Yzk0LTg2YmEtOTgxMmMzNGU1MzBidAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkZTI3NzZiY2UtNGM1MC00NzY4LTg5MDgtMjMxY2NlMDNkYjY5cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJESFp6RXFmTnRfR3I5TEo1RnRqR3YyUTYwTlNKRnRYell0eVZMQTNjOHZVIn0.eyJleHAiOjE2NDA4MTMzODIsImlhdCI6MTY0MDgxMzA4MiwianRpIjoiNDQ4ZDY1YzktYjBhYS00Yzk0LTg2YmEtOTgxMmMzNGU1MzBiIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiZTI3NzZiY2UtNGM1MC00NzY4LTg5MDgtMjMxY2NlMDNkYjY5IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.AblxQU0BibXD5M_MGwUspXIaD_P-tHICwPhzanD98WGWpR4YVoeoo9BP95eaDenGUYPvPTjw8S21mf9-nm5ukOMGzrusYEjJO4l9gM9Z5d9HCSF-_ZZ94MQRL45JFAr9m_YOHJto3aLAVSM6obGRUvpCiz6QchT5YdMWj8hocUSTVnBLVRKERZBzZFxcCnKY_b_PlZPLSRs8oJ7_sIa7-xTvNHmA85YWDfdl1J2MgegrIl4aiXY1G9gvSVSjnIRKIIsA4sul79f31z_J6htvRhPm94Bv3MhoWAu5ji5rEgtFsbmInpqQXjAsj2xPO9onq3Ow9Fan24bWpM4f3IU18w, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1640813382, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.31.0.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.31.0.1, http-session-id=3A448F17979DD983C0CDCBA17D7E7B48, http-session-last-accessed-time=1640813082789, kc-category-name=ACCESS, kc-iat=1640813082, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.31.0.1:62618 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2021-12-29 21:24:42.860  INFO 14 --- [io-7071-exec-10] e.a.a.abac.server.PdpServerController    : Request context extracted
2021-12-29 21:24:42.867  INFO 14 --- [io-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@198014b0
2021-12-29 21:24:42.867  INFO 14 --- [io-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@198014b0
2021-12-29 21:24:42.920  INFO 14 --- [io-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@198014b0
2021-12-29 21:24:42.921  INFO 14 --- [io-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@198014b0
2021-12-29 21:24:42.967  INFO 14 --- [io-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@198014b0
2021-12-29 21:24:42.968  WARN 14 --- [io-7071-exec-10] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2021-12-29 21:24:42.968  WARN 14 --- [io-7071-exec-10] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2021-12-29 21:24:42.968  INFO 14 --- [io-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@198014b0
2021-12-29 21:24:42.990  INFO 14 --- [io-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@198014b0
2021-12-29 21:24:42.992  WARN 14 --- [io-7071-exec-10] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2021-12-29 21:24:42.994  WARN 14 --- [io-7071-exec-10] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2021-12-29 21:24:42.997  INFO 14 --- [io-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@198014b0
2021-12-29 21:24:43.040  INFO 14 --- [io-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@198014b0
2021-12-29 21:24:43.043  INFO 14 --- [io-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@198014b0
2021-12-29 21:24:43.122  INFO 14 --- [io-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@198014b0
2021-12-29 21:24:43.122  INFO 14 --- [io-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@198014b0
2021-12-29 21:24:43.157  INFO 14 --- [io-7071-exec-10] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-7911481837140-356616, decision=PERMIT, pdp-result=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=PERMIT}})
2021-12-29 21:24:43.159  INFO 14 --- [io-7071-exec-10] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=1875315a-929d-474d-b539-14d92a00c0ae, content=PERMIT, timestamp=1640813083159, pdpResult=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=PERMIT}}))
2021-12-29 21:25:22.081  INFO 14 --- [nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=2649f1e1-25d2-4b4d-949f-28edb1defb66, content=null, timestamp=1640813122052, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=62626, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=b9c70ccf9dc9, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.31.0.1, kc-session-state=42e84600-4ff9-42d0-a5b1-0e4cd9272614, http-req-server-port=80, http-header-accept=*/*, kc-id=bab1a0fa-4144-4f54-9f8a-85d5c44be1bf, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1640813122050, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYczTbnNxAH4AEQAAAABhzNJCdAAkYmFiMWEwZmEtNDE0NC00ZjU0LTlmOGEtODVkNWM0NGJlMWJmdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkNDJlODQ2MDAtNGZmOS00MmQwLWE1YjEtMGU0Y2Q5MjcyNjE0cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJESFp6RXFmTnRfR3I5TEo1RnRqR3YyUTYwTlNKRnRYell0eVZMQTNjOHZVIn0.eyJleHAiOjE2NDA4MTM0MjIsImlhdCI6MTY0MDgxMzEyMiwianRpIjoiYmFiMWEwZmEtNDE0NC00ZjU0LTlmOGEtODVkNWM0NGJlMWJmIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiNDJlODQ2MDAtNGZmOS00MmQwLWE1YjEtMGU0Y2Q5MjcyNjE0IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Z7_e9m-UxUO3zV3LAQQ7NcaHgBb7ryCqYHgZlKD3WgTdxU5BRE82s3QfcW8YvCiqqFhYgLdg1Qxu-V6yq9NtTFxkrgWMV2TwCxVWgFnfaL6WKNGOvGpokV2IyOM_Ho-gVqPQgsSpS_Ikd1895B-zQUZ7oRe-JEL9o6Lv9Ons8UfrGBRNztTS5bylHynaKHCzp8PltDQrIEHzqLKJVSMlLYzPqoHVHtHj34_Qh3PYIl66Z7WovgI_MYCW_MbDMF5KdWOHZYZEH8qsWeLJRxkKYcYYhv_a76OhKBXDESLkJiqPEt_F1iBh7Um0pQes0R1OlmP4lhfO4rvsrXQzhZcEdw, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1640813422, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.31.0.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.31.0.1, http-session-id=6B6574DCDA14E6153480B436D82CC5FC, http-session-last-accessed-time=1640813122050, kc-category-name=ACCESS, kc-iat=1640813122, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.31.0.1:62626 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2021-12-29 21:25:22.089  INFO 14 --- [nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Request context extracted
2021-12-29 21:25:22.096  INFO 14 --- [nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@45a6f131
2021-12-29 21:25:22.097  INFO 14 --- [nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@45a6f131
2021-12-29 21:25:22.139  INFO 14 --- [nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@45a6f131
2021-12-29 21:25:22.140  INFO 14 --- [nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@45a6f131
2021-12-29 21:25:22.173  INFO 14 --- [nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@45a6f131
2021-12-29 21:25:22.174  WARN 14 --- [nio-7071-exec-1] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2021-12-29 21:25:22.174  WARN 14 --- [nio-7071-exec-1] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2021-12-29 21:25:22.176  INFO 14 --- [nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@45a6f131
2021-12-29 21:25:22.178  INFO 14 --- [nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@45a6f131
2021-12-29 21:25:22.180  WARN 14 --- [nio-7071-exec-1] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2021-12-29 21:25:22.180  WARN 14 --- [nio-7071-exec-1] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2021-12-29 21:25:22.182  INFO 14 --- [nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@45a6f131
2021-12-29 21:25:22.240  INFO 14 --- [nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@45a6f131
2021-12-29 21:25:22.245  INFO 14 --- [nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@45a6f131
2021-12-29 21:25:22.365  INFO 14 --- [nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@45a6f131
2021-12-29 21:25:22.368  INFO 14 --- [nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@45a6f131
2021-12-29 21:25:22.427  INFO 14 --- [nio-7071-exec-1] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-7950742779540-506796, decision=PERMIT, pdp-result=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=PERMIT}})
2021-12-29 21:25:22.431  INFO 14 --- [nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=2649f1e1-25d2-4b4d-949f-28edb1defb66, content=PERMIT, timestamp=1640813122431, pdpResult=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=PERMIT}}))
2021-12-29 21:25:22.648  INFO 14 --- [nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=ced04e42-5319-459e-94f4-5cb339857a78, content=null, timestamp=1640813122602, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=62630, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=b9c70ccf9dc9, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.31.0.1, kc-session-state=42e84600-4ff9-42d0-a5b1-0e4cd9272614, http-req-server-port=80, http-header-accept=*/*, kc-id=bab1a0fa-4144-4f54-9f8a-85d5c44be1bf, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1640813122594, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYczTbnNxAH4AEQAAAABhzNJCdAAkYmFiMWEwZmEtNDE0NC00ZjU0LTlmOGEtODVkNWM0NGJlMWJmdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkNDJlODQ2MDAtNGZmOS00MmQwLWE1YjEtMGU0Y2Q5MjcyNjE0cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJESFp6RXFmTnRfR3I5TEo1RnRqR3YyUTYwTlNKRnRYell0eVZMQTNjOHZVIn0.eyJleHAiOjE2NDA4MTM0MjIsImlhdCI6MTY0MDgxMzEyMiwianRpIjoiYmFiMWEwZmEtNDE0NC00ZjU0LTlmOGEtODVkNWM0NGJlMWJmIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiNDJlODQ2MDAtNGZmOS00MmQwLWE1YjEtMGU0Y2Q5MjcyNjE0IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Z7_e9m-UxUO3zV3LAQQ7NcaHgBb7ryCqYHgZlKD3WgTdxU5BRE82s3QfcW8YvCiqqFhYgLdg1Qxu-V6yq9NtTFxkrgWMV2TwCxVWgFnfaL6WKNGOvGpokV2IyOM_Ho-gVqPQgsSpS_Ikd1895B-zQUZ7oRe-JEL9o6Lv9Ons8UfrGBRNztTS5bylHynaKHCzp8PltDQrIEHzqLKJVSMlLYzPqoHVHtHj34_Qh3PYIl66Z7WovgI_MYCW_MbDMF5KdWOHZYZEH8qsWeLJRxkKYcYYhv_a76OhKBXDESLkJiqPEt_F1iBh7Um0pQes0R1OlmP4lhfO4rvsrXQzhZcEdw, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1640813422, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.31.0.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.31.0.1, http-session-id=0397920E1DC8E5509BF787CDAFFF610E, http-session-last-accessed-time=1640813122594, kc-category-name=ACCESS, kc-iat=1640813122, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.31.0.1:62630 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2021-12-29 21:25:22.657  INFO 14 --- [nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Request context extracted
2021-12-29 21:25:22.662  INFO 14 --- [nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1169df3e
2021-12-29 21:25:22.665  INFO 14 --- [nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1169df3e
2021-12-29 21:25:22.749  INFO 14 --- [nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1169df3e
2021-12-29 21:25:22.755  INFO 14 --- [nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1169df3e
2021-12-29 21:25:22.885  INFO 14 --- [nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1169df3e
2021-12-29 21:25:22.887  WARN 14 --- [nio-7071-exec-2] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2021-12-29 21:25:22.888  WARN 14 --- [nio-7071-exec-2] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2021-12-29 21:25:22.897  INFO 14 --- [nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1169df3e
2021-12-29 21:25:22.899  INFO 14 --- [nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1169df3e
2021-12-29 21:25:22.900  WARN 14 --- [nio-7071-exec-2] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2021-12-29 21:25:22.909  WARN 14 --- [nio-7071-exec-2] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2021-12-29 21:25:22.915  INFO 14 --- [nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1169df3e
2021-12-29 21:25:22.985  INFO 14 --- [nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1169df3e
2021-12-29 21:25:22.989  INFO 14 --- [nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1169df3e
2021-12-29 21:25:23.090  INFO 14 --- [nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1169df3e
2021-12-29 21:25:23.093  INFO 14 --- [nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1169df3e
2021-12-29 21:25:23.157  INFO 14 --- [nio-7071-exec-2] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-7951310368940-167213, decision=PERMIT, pdp-result=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=PERMIT}})
2021-12-29 21:25:23.161  INFO 14 --- [nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=ced04e42-5319-459e-94f4-5cb339857a78, content=PERMIT, timestamp=1640813123161, pdpResult=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=PERMIT}}))
2021-12-29 21:25:23.423  INFO 14 --- [nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=dff4cd7e-c9ba-4d52-bc52-c1ee17f30762, content=null, timestamp=1640813123341, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=62632, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=b9c70ccf9dc9, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.31.0.1, kc-session-state=42e84600-4ff9-42d0-a5b1-0e4cd9272614, http-req-server-port=80, http-header-accept=*/*, kc-id=bab1a0fa-4144-4f54-9f8a-85d5c44be1bf, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1640813123316, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYczTbnNxAH4AEQAAAABhzNJCdAAkYmFiMWEwZmEtNDE0NC00ZjU0LTlmOGEtODVkNWM0NGJlMWJmdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkNDJlODQ2MDAtNGZmOS00MmQwLWE1YjEtMGU0Y2Q5MjcyNjE0cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJESFp6RXFmTnRfR3I5TEo1RnRqR3YyUTYwTlNKRnRYell0eVZMQTNjOHZVIn0.eyJleHAiOjE2NDA4MTM0MjIsImlhdCI6MTY0MDgxMzEyMiwianRpIjoiYmFiMWEwZmEtNDE0NC00ZjU0LTlmOGEtODVkNWM0NGJlMWJmIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiNDJlODQ2MDAtNGZmOS00MmQwLWE1YjEtMGU0Y2Q5MjcyNjE0IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Z7_e9m-UxUO3zV3LAQQ7NcaHgBb7ryCqYHgZlKD3WgTdxU5BRE82s3QfcW8YvCiqqFhYgLdg1Qxu-V6yq9NtTFxkrgWMV2TwCxVWgFnfaL6WKNGOvGpokV2IyOM_Ho-gVqPQgsSpS_Ikd1895B-zQUZ7oRe-JEL9o6Lv9Ons8UfrGBRNztTS5bylHynaKHCzp8PltDQrIEHzqLKJVSMlLYzPqoHVHtHj34_Qh3PYIl66Z7WovgI_MYCW_MbDMF5KdWOHZYZEH8qsWeLJRxkKYcYYhv_a76OhKBXDESLkJiqPEt_F1iBh7Um0pQes0R1OlmP4lhfO4rvsrXQzhZcEdw, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1640813422, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.31.0.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.31.0.1, http-session-id=2182559A0F40A7DA7694EE21D493B6C8, http-session-last-accessed-time=1640813123316, kc-category-name=ACCESS, kc-iat=1640813122, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.31.0.1:62632 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2021-12-29 21:25:23.430  INFO 14 --- [nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Request context extracted
2021-12-29 21:25:23.437  INFO 14 --- [nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6b100183
2021-12-29 21:25:23.439  INFO 14 --- [nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6b100183
2021-12-29 21:25:23.484  INFO 14 --- [nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6b100183
2021-12-29 21:25:23.485  INFO 14 --- [nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6b100183
2021-12-29 21:25:23.522  INFO 14 --- [nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6b100183
2021-12-29 21:25:23.525  WARN 14 --- [nio-7071-exec-3] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2021-12-29 21:25:23.527  WARN 14 --- [nio-7071-exec-3] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2021-12-29 21:25:23.528  INFO 14 --- [nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6b100183
2021-12-29 21:25:23.530  INFO 14 --- [nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6b100183
2021-12-29 21:25:23.531  WARN 14 --- [nio-7071-exec-3] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2021-12-29 21:25:23.534  WARN 14 --- [nio-7071-exec-3] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2021-12-29 21:25:23.535  INFO 14 --- [nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6b100183
2021-12-29 21:25:23.606  INFO 14 --- [nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6b100183
2021-12-29 21:25:23.611  INFO 14 --- [nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6b100183
2021-12-29 21:25:23.644  INFO 14 --- [nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6b100183
2021-12-29 21:25:23.645  INFO 14 --- [nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6b100183
2021-12-29 21:25:23.675  INFO 14 --- [nio-7071-exec-3] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-7952085123140-946644, decision=PERMIT, pdp-result=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=PERMIT}})
2021-12-29 21:25:23.676  INFO 14 --- [nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=dff4cd7e-c9ba-4d52-bc52-c1ee17f30762, content=PERMIT, timestamp=1640813123676, pdpResult=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=PERMIT}}))
2021-12-29 21:25:23.815  INFO 14 --- [nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=ca3816de-f83a-40d3-ba9b-0bec1ccb4222, content=null, timestamp=1640813123803, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=62634, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=b9c70ccf9dc9, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.31.0.1, kc-session-state=42e84600-4ff9-42d0-a5b1-0e4cd9272614, http-req-server-port=80, http-header-accept=*/*, kc-id=bab1a0fa-4144-4f54-9f8a-85d5c44be1bf, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1640813123795, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYczTbnNxAH4AEQAAAABhzNJCdAAkYmFiMWEwZmEtNDE0NC00ZjU0LTlmOGEtODVkNWM0NGJlMWJmdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkNDJlODQ2MDAtNGZmOS00MmQwLWE1YjEtMGU0Y2Q5MjcyNjE0cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJESFp6RXFmTnRfR3I5TEo1RnRqR3YyUTYwTlNKRnRYell0eVZMQTNjOHZVIn0.eyJleHAiOjE2NDA4MTM0MjIsImlhdCI6MTY0MDgxMzEyMiwianRpIjoiYmFiMWEwZmEtNDE0NC00ZjU0LTlmOGEtODVkNWM0NGJlMWJmIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiNDJlODQ2MDAtNGZmOS00MmQwLWE1YjEtMGU0Y2Q5MjcyNjE0IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Z7_e9m-UxUO3zV3LAQQ7NcaHgBb7ryCqYHgZlKD3WgTdxU5BRE82s3QfcW8YvCiqqFhYgLdg1Qxu-V6yq9NtTFxkrgWMV2TwCxVWgFnfaL6WKNGOvGpokV2IyOM_Ho-gVqPQgsSpS_Ikd1895B-zQUZ7oRe-JEL9o6Lv9Ons8UfrGBRNztTS5bylHynaKHCzp8PltDQrIEHzqLKJVSMlLYzPqoHVHtHj34_Qh3PYIl66Z7WovgI_MYCW_MbDMF5KdWOHZYZEH8qsWeLJRxkKYcYYhv_a76OhKBXDESLkJiqPEt_F1iBh7Um0pQes0R1OlmP4lhfO4rvsrXQzhZcEdw, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1640813422, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.31.0.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.31.0.1, http-session-id=B953995C32BF2A92BBC15B4EA513142B, http-session-last-accessed-time=1640813123795, kc-category-name=ACCESS, kc-iat=1640813122, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.31.0.1:62634 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2021-12-29 21:25:23.821  INFO 14 --- [nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Request context extracted
2021-12-29 21:25:23.832  INFO 14 --- [nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@260a8931
2021-12-29 21:25:23.838  INFO 14 --- [nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@260a8931
2021-12-29 21:25:23.905  INFO 14 --- [nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@260a8931
2021-12-29 21:25:23.906  INFO 14 --- [nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@260a8931
2021-12-29 21:25:23.997  INFO 14 --- [nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@260a8931
2021-12-29 21:25:23.997  WARN 14 --- [nio-7071-exec-4] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2021-12-29 21:25:24.000  WARN 14 --- [nio-7071-exec-4] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2021-12-29 21:25:24.004  INFO 14 --- [nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@260a8931
2021-12-29 21:25:24.010  INFO 14 --- [nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@260a8931
2021-12-29 21:25:24.010  WARN 14 --- [nio-7071-exec-4] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2021-12-29 21:25:24.011  WARN 14 --- [nio-7071-exec-4] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2021-12-29 21:25:24.014  INFO 14 --- [nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@260a8931
2021-12-29 21:25:24.121  INFO 14 --- [nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@260a8931
2021-12-29 21:25:24.125  INFO 14 --- [nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@260a8931
2021-12-29 21:25:24.238  INFO 14 --- [nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@260a8931
2021-12-29 21:25:24.240  INFO 14 --- [nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@260a8931
2021-12-29 21:25:24.383  INFO 14 --- [nio-7071-exec-4] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-7952475741740-958343, decision=PERMIT, pdp-result=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=PERMIT}})
2021-12-29 21:25:24.384  INFO 14 --- [nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=ca3816de-f83a-40d3-ba9b-0bec1ccb4222, content=PERMIT, timestamp=1640813124384, pdpResult=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=PERMIT}}))
2021-12-29 21:25:24.642  INFO 14 --- [nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=d623de13-df5e-4a1b-a124-7a1242d558fb, content=null, timestamp=1640813124593, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=62636, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=b9c70ccf9dc9, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.31.0.1, kc-session-state=42e84600-4ff9-42d0-a5b1-0e4cd9272614, http-req-server-port=80, http-header-accept=*/*, kc-id=bab1a0fa-4144-4f54-9f8a-85d5c44be1bf, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1640813124571, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYczTbnNxAH4AEQAAAABhzNJCdAAkYmFiMWEwZmEtNDE0NC00ZjU0LTlmOGEtODVkNWM0NGJlMWJmdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkNDJlODQ2MDAtNGZmOS00MmQwLWE1YjEtMGU0Y2Q5MjcyNjE0cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJESFp6RXFmTnRfR3I5TEo1RnRqR3YyUTYwTlNKRnRYell0eVZMQTNjOHZVIn0.eyJleHAiOjE2NDA4MTM0MjIsImlhdCI6MTY0MDgxMzEyMiwianRpIjoiYmFiMWEwZmEtNDE0NC00ZjU0LTlmOGEtODVkNWM0NGJlMWJmIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiNDJlODQ2MDAtNGZmOS00MmQwLWE1YjEtMGU0Y2Q5MjcyNjE0IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Z7_e9m-UxUO3zV3LAQQ7NcaHgBb7ryCqYHgZlKD3WgTdxU5BRE82s3QfcW8YvCiqqFhYgLdg1Qxu-V6yq9NtTFxkrgWMV2TwCxVWgFnfaL6WKNGOvGpokV2IyOM_Ho-gVqPQgsSpS_Ikd1895B-zQUZ7oRe-JEL9o6Lv9Ons8UfrGBRNztTS5bylHynaKHCzp8PltDQrIEHzqLKJVSMlLYzPqoHVHtHj34_Qh3PYIl66Z7WovgI_MYCW_MbDMF5KdWOHZYZEH8qsWeLJRxkKYcYYhv_a76OhKBXDESLkJiqPEt_F1iBh7Um0pQes0R1OlmP4lhfO4rvsrXQzhZcEdw, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1640813422, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.31.0.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.31.0.1, http-session-id=0E4ABEDF529EFF0B8751F14FB3A76A3D, http-session-last-accessed-time=1640813124571, kc-category-name=ACCESS, kc-iat=1640813122, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.31.0.1:62636 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2021-12-29 21:25:24.652  INFO 14 --- [nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Request context extracted
2021-12-29 21:25:24.671  INFO 14 --- [nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@61e9d93
2021-12-29 21:25:24.673  INFO 14 --- [nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@61e9d93
2021-12-29 21:25:24.721  INFO 14 --- [nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@61e9d93
2021-12-29 21:25:24.722  INFO 14 --- [nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@61e9d93
2021-12-29 21:25:24.797  INFO 14 --- [nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@61e9d93
2021-12-29 21:25:24.798  WARN 14 --- [nio-7071-exec-5] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2021-12-29 21:25:24.799  WARN 14 --- [nio-7071-exec-5] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2021-12-29 21:25:24.802  INFO 14 --- [nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@61e9d93
2021-12-29 21:25:24.803  INFO 14 --- [nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@61e9d93
2021-12-29 21:25:24.804  WARN 14 --- [nio-7071-exec-5] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2021-12-29 21:25:24.804  WARN 14 --- [nio-7071-exec-5] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2021-12-29 21:25:24.805  INFO 14 --- [nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@61e9d93
2021-12-29 21:25:24.859  INFO 14 --- [nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@61e9d93
2021-12-29 21:25:24.860  INFO 14 --- [nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@61e9d93
2021-12-29 21:25:24.908  INFO 14 --- [nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@61e9d93
2021-12-29 21:25:24.910  INFO 14 --- [nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@61e9d93
2021-12-29 21:25:24.998  INFO 14 --- [nio-7071-exec-5] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-7953310519040-636112, decision=PERMIT, pdp-result=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=PERMIT}})
2021-12-29 21:25:24.999  INFO 14 --- [nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=d623de13-df5e-4a1b-a124-7a1242d558fb, content=PERMIT, timestamp=1640813124999, pdpResult=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=PERMIT}}))
2021-12-29 21:25:25.153  INFO 14 --- [nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=11216dd7-b421-4e64-8c30-8c48b4406b17, content=null, timestamp=1640813125116, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=62638, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=b9c70ccf9dc9, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.31.0.1, kc-session-state=42e84600-4ff9-42d0-a5b1-0e4cd9272614, http-req-server-port=80, http-header-accept=*/*, kc-id=bab1a0fa-4144-4f54-9f8a-85d5c44be1bf, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1640813125109, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYczTbnNxAH4AEQAAAABhzNJCdAAkYmFiMWEwZmEtNDE0NC00ZjU0LTlmOGEtODVkNWM0NGJlMWJmdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkNDJlODQ2MDAtNGZmOS00MmQwLWE1YjEtMGU0Y2Q5MjcyNjE0cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJESFp6RXFmTnRfR3I5TEo1RnRqR3YyUTYwTlNKRnRYell0eVZMQTNjOHZVIn0.eyJleHAiOjE2NDA4MTM0MjIsImlhdCI6MTY0MDgxMzEyMiwianRpIjoiYmFiMWEwZmEtNDE0NC00ZjU0LTlmOGEtODVkNWM0NGJlMWJmIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiNDJlODQ2MDAtNGZmOS00MmQwLWE1YjEtMGU0Y2Q5MjcyNjE0IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Z7_e9m-UxUO3zV3LAQQ7NcaHgBb7ryCqYHgZlKD3WgTdxU5BRE82s3QfcW8YvCiqqFhYgLdg1Qxu-V6yq9NtTFxkrgWMV2TwCxVWgFnfaL6WKNGOvGpokV2IyOM_Ho-gVqPQgsSpS_Ikd1895B-zQUZ7oRe-JEL9o6Lv9Ons8UfrGBRNztTS5bylHynaKHCzp8PltDQrIEHzqLKJVSMlLYzPqoHVHtHj34_Qh3PYIl66Z7WovgI_MYCW_MbDMF5KdWOHZYZEH8qsWeLJRxkKYcYYhv_a76OhKBXDESLkJiqPEt_F1iBh7Um0pQes0R1OlmP4lhfO4rvsrXQzhZcEdw, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1640813422, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.31.0.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.31.0.1, http-session-id=D454C53BDDEEB560D5D0136C3CA1BF24, http-session-last-accessed-time=1640813125109, kc-category-name=ACCESS, kc-iat=1640813122, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.31.0.1:62638 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2021-12-29 21:25:25.158  INFO 14 --- [nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Request context extracted
2021-12-29 21:25:25.164  INFO 14 --- [nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2ed94387
2021-12-29 21:25:25.165  INFO 14 --- [nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2ed94387
2021-12-29 21:25:25.216  INFO 14 --- [nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2ed94387
2021-12-29 21:25:25.218  INFO 14 --- [nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2ed94387
2021-12-29 21:25:25.286  INFO 14 --- [nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2ed94387
2021-12-29 21:25:25.288  WARN 14 --- [nio-7071-exec-6] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2021-12-29 21:25:25.290  WARN 14 --- [nio-7071-exec-6] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2021-12-29 21:25:25.292  INFO 14 --- [nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2ed94387
2021-12-29 21:25:25.297  INFO 14 --- [nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2ed94387
2021-12-29 21:25:25.298  WARN 14 --- [nio-7071-exec-6] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2021-12-29 21:25:25.301  WARN 14 --- [nio-7071-exec-6] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2021-12-29 21:25:25.305  INFO 14 --- [nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2ed94387
2021-12-29 21:25:25.369  INFO 14 --- [nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2ed94387
2021-12-29 21:25:25.370  INFO 14 --- [nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2ed94387
2021-12-29 21:25:25.458  INFO 14 --- [nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2ed94387
2021-12-29 21:25:25.460  INFO 14 --- [nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2ed94387
2021-12-29 21:25:25.524  INFO 14 --- [nio-7071-exec-6] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-7953813625340-386937, decision=PERMIT, pdp-result=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=PERMIT}})
2021-12-29 21:25:25.526  INFO 14 --- [nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=11216dd7-b421-4e64-8c30-8c48b4406b17, content=PERMIT, timestamp=1640813125526, pdpResult=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=PERMIT}}))
2021-12-29 21:25:25.736  INFO 14 --- [nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=603dc2c2-9651-4344-9345-4f7788285bef, content=null, timestamp=1640813125677, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=62640, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=b9c70ccf9dc9, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.31.0.1, kc-session-state=42e84600-4ff9-42d0-a5b1-0e4cd9272614, http-req-server-port=80, http-header-accept=*/*, kc-id=bab1a0fa-4144-4f54-9f8a-85d5c44be1bf, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1640813125666, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYczTbnNxAH4AEQAAAABhzNJCdAAkYmFiMWEwZmEtNDE0NC00ZjU0LTlmOGEtODVkNWM0NGJlMWJmdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkNDJlODQ2MDAtNGZmOS00MmQwLWE1YjEtMGU0Y2Q5MjcyNjE0cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJESFp6RXFmTnRfR3I5TEo1RnRqR3YyUTYwTlNKRnRYell0eVZMQTNjOHZVIn0.eyJleHAiOjE2NDA4MTM0MjIsImlhdCI6MTY0MDgxMzEyMiwianRpIjoiYmFiMWEwZmEtNDE0NC00ZjU0LTlmOGEtODVkNWM0NGJlMWJmIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiNDJlODQ2MDAtNGZmOS00MmQwLWE1YjEtMGU0Y2Q5MjcyNjE0IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Z7_e9m-UxUO3zV3LAQQ7NcaHgBb7ryCqYHgZlKD3WgTdxU5BRE82s3QfcW8YvCiqqFhYgLdg1Qxu-V6yq9NtTFxkrgWMV2TwCxVWgFnfaL6WKNGOvGpokV2IyOM_Ho-gVqPQgsSpS_Ikd1895B-zQUZ7oRe-JEL9o6Lv9Ons8UfrGBRNztTS5bylHynaKHCzp8PltDQrIEHzqLKJVSMlLYzPqoHVHtHj34_Qh3PYIl66Z7WovgI_MYCW_MbDMF5KdWOHZYZEH8qsWeLJRxkKYcYYhv_a76OhKBXDESLkJiqPEt_F1iBh7Um0pQes0R1OlmP4lhfO4rvsrXQzhZcEdw, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1640813422, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.31.0.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.31.0.1, http-session-id=A2CC3383DFB8344269E0A584613C9787, http-session-last-accessed-time=1640813125666, kc-category-name=ACCESS, kc-iat=1640813122, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.31.0.1:62640 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2021-12-29 21:25:25.743  INFO 14 --- [nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Request context extracted
2021-12-29 21:25:25.751  INFO 14 --- [nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@11ab44d6
2021-12-29 21:25:25.754  INFO 14 --- [nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@11ab44d6
2021-12-29 21:25:25.822  INFO 14 --- [nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@11ab44d6
2021-12-29 21:25:25.823  INFO 14 --- [nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@11ab44d6
2021-12-29 21:25:25.876  INFO 14 --- [nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@11ab44d6
2021-12-29 21:25:25.876  WARN 14 --- [nio-7071-exec-7] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2021-12-29 21:25:25.880  WARN 14 --- [nio-7071-exec-7] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2021-12-29 21:25:25.885  INFO 14 --- [nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@11ab44d6
2021-12-29 21:25:25.889  INFO 14 --- [nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@11ab44d6
2021-12-29 21:25:25.889  WARN 14 --- [nio-7071-exec-7] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2021-12-29 21:25:25.891  WARN 14 --- [nio-7071-exec-7] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2021-12-29 21:25:25.895  INFO 14 --- [nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@11ab44d6
2021-12-29 21:25:26.064  INFO 14 --- [nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@11ab44d6
2021-12-29 21:25:26.064  INFO 14 --- [nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@11ab44d6
2021-12-29 21:25:26.170  INFO 14 --- [nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@11ab44d6
2021-12-29 21:25:26.177  INFO 14 --- [nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@11ab44d6
2021-12-29 21:25:26.228  INFO 14 --- [nio-7071-exec-7] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-7954397827040-119711, decision=PERMIT, pdp-result=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=PERMIT}})
2021-12-29 21:25:26.229  INFO 14 --- [nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=603dc2c2-9651-4344-9345-4f7788285bef, content=PERMIT, timestamp=1640813126229, pdpResult=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=PERMIT}}))
2021-12-29 21:25:26.479  INFO 14 --- [nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=ae5590a0-5f23-40f3-9eb1-6fa7b2a968b5, content=null, timestamp=1640813126376, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=62642, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=b9c70ccf9dc9, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.31.0.1, kc-session-state=42e84600-4ff9-42d0-a5b1-0e4cd9272614, http-req-server-port=80, http-header-accept=*/*, kc-id=bab1a0fa-4144-4f54-9f8a-85d5c44be1bf, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1640813126356, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYczTbnNxAH4AEQAAAABhzNJCdAAkYmFiMWEwZmEtNDE0NC00ZjU0LTlmOGEtODVkNWM0NGJlMWJmdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkNDJlODQ2MDAtNGZmOS00MmQwLWE1YjEtMGU0Y2Q5MjcyNjE0cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJESFp6RXFmTnRfR3I5TEo1RnRqR3YyUTYwTlNKRnRYell0eVZMQTNjOHZVIn0.eyJleHAiOjE2NDA4MTM0MjIsImlhdCI6MTY0MDgxMzEyMiwianRpIjoiYmFiMWEwZmEtNDE0NC00ZjU0LTlmOGEtODVkNWM0NGJlMWJmIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiNDJlODQ2MDAtNGZmOS00MmQwLWE1YjEtMGU0Y2Q5MjcyNjE0IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Z7_e9m-UxUO3zV3LAQQ7NcaHgBb7ryCqYHgZlKD3WgTdxU5BRE82s3QfcW8YvCiqqFhYgLdg1Qxu-V6yq9NtTFxkrgWMV2TwCxVWgFnfaL6WKNGOvGpokV2IyOM_Ho-gVqPQgsSpS_Ikd1895B-zQUZ7oRe-JEL9o6Lv9Ons8UfrGBRNztTS5bylHynaKHCzp8PltDQrIEHzqLKJVSMlLYzPqoHVHtHj34_Qh3PYIl66Z7WovgI_MYCW_MbDMF5KdWOHZYZEH8qsWeLJRxkKYcYYhv_a76OhKBXDESLkJiqPEt_F1iBh7Um0pQes0R1OlmP4lhfO4rvsrXQzhZcEdw, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1640813422, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.31.0.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.31.0.1, http-session-id=3389AF6EBF5ADAEA37C265BA79341D0D, http-session-last-accessed-time=1640813126356, kc-category-name=ACCESS, kc-iat=1640813122, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.31.0.1:62642 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2021-12-29 21:25:26.485  INFO 14 --- [nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Request context extracted
2021-12-29 21:25:26.495  INFO 14 --- [nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6aa4e01
2021-12-29 21:25:26.501  INFO 14 --- [nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6aa4e01
2021-12-29 21:25:26.560  INFO 14 --- [nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6aa4e01
2021-12-29 21:25:26.562  INFO 14 --- [nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6aa4e01
2021-12-29 21:25:26.602  INFO 14 --- [nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6aa4e01
2021-12-29 21:25:26.604  WARN 14 --- [nio-7071-exec-8] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2021-12-29 21:25:26.606  WARN 14 --- [nio-7071-exec-8] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2021-12-29 21:25:26.609  INFO 14 --- [nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6aa4e01
2021-12-29 21:25:26.616  INFO 14 --- [nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6aa4e01
2021-12-29 21:25:26.618  WARN 14 --- [nio-7071-exec-8] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2021-12-29 21:25:26.619  WARN 14 --- [nio-7071-exec-8] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2021-12-29 21:25:26.620  INFO 14 --- [nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6aa4e01
2021-12-29 21:25:26.722  INFO 14 --- [nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6aa4e01
2021-12-29 21:25:26.723  INFO 14 --- [nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6aa4e01
2021-12-29 21:25:26.771  INFO 14 --- [nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6aa4e01
2021-12-29 21:25:26.776  INFO 14 --- [nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6aa4e01
2021-12-29 21:25:26.828  INFO 14 --- [nio-7071-exec-8] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-7955139716540-805427, decision=PERMIT, pdp-result=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=PERMIT}})
2021-12-29 21:25:26.831  INFO 14 --- [nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=ae5590a0-5f23-40f3-9eb1-6fa7b2a968b5, content=PERMIT, timestamp=1640813126831, pdpResult=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=PERMIT}}))
2021-12-29 21:25:27.159  INFO 14 --- [nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=d6a2e992-77f8-41d3-833c-b1460d08b635, content=null, timestamp=1640813127083, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=62644, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=b9c70ccf9dc9, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.31.0.1, kc-session-state=42e84600-4ff9-42d0-a5b1-0e4cd9272614, http-req-server-port=80, http-header-accept=*/*, kc-id=bab1a0fa-4144-4f54-9f8a-85d5c44be1bf, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1640813127078, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYczTbnNxAH4AEQAAAABhzNJCdAAkYmFiMWEwZmEtNDE0NC00ZjU0LTlmOGEtODVkNWM0NGJlMWJmdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkNDJlODQ2MDAtNGZmOS00MmQwLWE1YjEtMGU0Y2Q5MjcyNjE0cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJESFp6RXFmTnRfR3I5TEo1RnRqR3YyUTYwTlNKRnRYell0eVZMQTNjOHZVIn0.eyJleHAiOjE2NDA4MTM0MjIsImlhdCI6MTY0MDgxMzEyMiwianRpIjoiYmFiMWEwZmEtNDE0NC00ZjU0LTlmOGEtODVkNWM0NGJlMWJmIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiNDJlODQ2MDAtNGZmOS00MmQwLWE1YjEtMGU0Y2Q5MjcyNjE0IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Z7_e9m-UxUO3zV3LAQQ7NcaHgBb7ryCqYHgZlKD3WgTdxU5BRE82s3QfcW8YvCiqqFhYgLdg1Qxu-V6yq9NtTFxkrgWMV2TwCxVWgFnfaL6WKNGOvGpokV2IyOM_Ho-gVqPQgsSpS_Ikd1895B-zQUZ7oRe-JEL9o6Lv9Ons8UfrGBRNztTS5bylHynaKHCzp8PltDQrIEHzqLKJVSMlLYzPqoHVHtHj34_Qh3PYIl66Z7WovgI_MYCW_MbDMF5KdWOHZYZEH8qsWeLJRxkKYcYYhv_a76OhKBXDESLkJiqPEt_F1iBh7Um0pQes0R1OlmP4lhfO4rvsrXQzhZcEdw, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1640813422, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.31.0.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.31.0.1, http-session-id=E1E29EEDE080C89E7F663211E99BDBA1, http-session-last-accessed-time=1640813127078, kc-category-name=ACCESS, kc-iat=1640813122, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.31.0.1:62644 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2021-12-29 21:25:27.164  INFO 14 --- [nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Request context extracted
2021-12-29 21:25:27.185  INFO 14 --- [nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@537d6bfa
2021-12-29 21:25:27.185  INFO 14 --- [nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@537d6bfa
2021-12-29 21:25:27.240  INFO 14 --- [nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@537d6bfa
2021-12-29 21:25:27.246  INFO 14 --- [nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@537d6bfa
2021-12-29 21:25:27.341  INFO 14 --- [nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@537d6bfa
2021-12-29 21:25:27.342  WARN 14 --- [nio-7071-exec-9] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2021-12-29 21:25:27.345  WARN 14 --- [nio-7071-exec-9] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2021-12-29 21:25:27.348  INFO 14 --- [nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@537d6bfa
2021-12-29 21:25:27.351  INFO 14 --- [nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@537d6bfa
2021-12-29 21:25:27.352  WARN 14 --- [nio-7071-exec-9] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2021-12-29 21:25:27.357  WARN 14 --- [nio-7071-exec-9] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2021-12-29 21:25:27.358  INFO 14 --- [nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@537d6bfa
2021-12-29 21:25:27.421  INFO 14 --- [nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@537d6bfa
2021-12-29 21:25:27.422  INFO 14 --- [nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@537d6bfa
2021-12-29 21:25:27.478  INFO 14 --- [nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@537d6bfa
2021-12-29 21:25:27.480  INFO 14 --- [nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@537d6bfa
2021-12-29 21:25:27.605  INFO 14 --- [nio-7071-exec-9] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-7955817727940-53097, decision=PERMIT, pdp-result=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=PERMIT}})
2021-12-29 21:25:27.617  INFO 14 --- [nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=d6a2e992-77f8-41d3-833c-b1460d08b635, content=PERMIT, timestamp=1640813127617, pdpResult=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=PERMIT}}))
2021-12-29 21:25:27.847  INFO 14 --- [io-7071-exec-10] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=af6728a3-a10e-4ae6-82f7-16cfb0fdd613, content=null, timestamp=1640813127793, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=62646, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=b9c70ccf9dc9, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.31.0.1, kc-session-state=42e84600-4ff9-42d0-a5b1-0e4cd9272614, http-req-server-port=80, http-header-accept=*/*, kc-id=bab1a0fa-4144-4f54-9f8a-85d5c44be1bf, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1640813127780, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYczTbnNxAH4AEQAAAABhzNJCdAAkYmFiMWEwZmEtNDE0NC00ZjU0LTlmOGEtODVkNWM0NGJlMWJmdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkNDJlODQ2MDAtNGZmOS00MmQwLWE1YjEtMGU0Y2Q5MjcyNjE0cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJESFp6RXFmTnRfR3I5TEo1RnRqR3YyUTYwTlNKRnRYell0eVZMQTNjOHZVIn0.eyJleHAiOjE2NDA4MTM0MjIsImlhdCI6MTY0MDgxMzEyMiwianRpIjoiYmFiMWEwZmEtNDE0NC00ZjU0LTlmOGEtODVkNWM0NGJlMWJmIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiNDJlODQ2MDAtNGZmOS00MmQwLWE1YjEtMGU0Y2Q5MjcyNjE0IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Z7_e9m-UxUO3zV3LAQQ7NcaHgBb7ryCqYHgZlKD3WgTdxU5BRE82s3QfcW8YvCiqqFhYgLdg1Qxu-V6yq9NtTFxkrgWMV2TwCxVWgFnfaL6WKNGOvGpokV2IyOM_Ho-gVqPQgsSpS_Ikd1895B-zQUZ7oRe-JEL9o6Lv9Ons8UfrGBRNztTS5bylHynaKHCzp8PltDQrIEHzqLKJVSMlLYzPqoHVHtHj34_Qh3PYIl66Z7WovgI_MYCW_MbDMF5KdWOHZYZEH8qsWeLJRxkKYcYYhv_a76OhKBXDESLkJiqPEt_F1iBh7Um0pQes0R1OlmP4lhfO4rvsrXQzhZcEdw, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1640813422, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.31.0.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.31.0.1, http-session-id=E3A609D7E22C320F85E176D4396B5444, http-session-last-accessed-time=1640813127780, kc-category-name=ACCESS, kc-iat=1640813122, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.31.0.1:62646 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2021-12-29 21:25:27.853  INFO 14 --- [io-7071-exec-10] e.a.a.abac.server.PdpServerController    : Request context extracted
2021-12-29 21:25:27.863  INFO 14 --- [io-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@327907ff
2021-12-29 21:25:27.863  INFO 14 --- [io-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@327907ff
2021-12-29 21:25:27.915  INFO 14 --- [io-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@327907ff
2021-12-29 21:25:27.915  INFO 14 --- [io-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@327907ff
2021-12-29 21:25:27.959  INFO 14 --- [io-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@327907ff
2021-12-29 21:25:27.959  WARN 14 --- [io-7071-exec-10] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2021-12-29 21:25:27.960  WARN 14 --- [io-7071-exec-10] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2021-12-29 21:25:27.964  INFO 14 --- [io-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@327907ff
2021-12-29 21:25:27.966  INFO 14 --- [io-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@327907ff
2021-12-29 21:25:27.966  WARN 14 --- [io-7071-exec-10] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2021-12-29 21:25:27.967  WARN 14 --- [io-7071-exec-10] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2021-12-29 21:25:27.969  INFO 14 --- [io-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@327907ff
2021-12-29 21:25:28.019  INFO 14 --- [io-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@327907ff
2021-12-29 21:25:28.019  INFO 14 --- [io-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@327907ff
2021-12-29 21:25:28.102  INFO 14 --- [io-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@327907ff
2021-12-29 21:25:28.104  INFO 14 --- [io-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@327907ff
2021-12-29 21:25:28.172  INFO 14 --- [io-7071-exec-10] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-7956508856440-498332, decision=PERMIT, pdp-result=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=PERMIT}})
2021-12-29 21:25:28.173  INFO 14 --- [io-7071-exec-10] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=af6728a3-a10e-4ae6-82f7-16cfb0fdd613, content=PERMIT, timestamp=1640813128173, pdpResult=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=PERMIT}}))
2021-12-29 21:25:28.289  INFO 14 --- [nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=141775eb-d7f7-47f0-b0cf-ad05e4760e33, content=null, timestamp=1640813128252, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=62648, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=b9c70ccf9dc9, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.31.0.1, kc-session-state=42e84600-4ff9-42d0-a5b1-0e4cd9272614, http-req-server-port=80, http-header-accept=*/*, kc-id=bab1a0fa-4144-4f54-9f8a-85d5c44be1bf, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1640813128244, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYczTbnNxAH4AEQAAAABhzNJCdAAkYmFiMWEwZmEtNDE0NC00ZjU0LTlmOGEtODVkNWM0NGJlMWJmdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkNDJlODQ2MDAtNGZmOS00MmQwLWE1YjEtMGU0Y2Q5MjcyNjE0cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJESFp6RXFmTnRfR3I5TEo1RnRqR3YyUTYwTlNKRnRYell0eVZMQTNjOHZVIn0.eyJleHAiOjE2NDA4MTM0MjIsImlhdCI6MTY0MDgxMzEyMiwianRpIjoiYmFiMWEwZmEtNDE0NC00ZjU0LTlmOGEtODVkNWM0NGJlMWJmIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiNDJlODQ2MDAtNGZmOS00MmQwLWE1YjEtMGU0Y2Q5MjcyNjE0IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Z7_e9m-UxUO3zV3LAQQ7NcaHgBb7ryCqYHgZlKD3WgTdxU5BRE82s3QfcW8YvCiqqFhYgLdg1Qxu-V6yq9NtTFxkrgWMV2TwCxVWgFnfaL6WKNGOvGpokV2IyOM_Ho-gVqPQgsSpS_Ikd1895B-zQUZ7oRe-JEL9o6Lv9Ons8UfrGBRNztTS5bylHynaKHCzp8PltDQrIEHzqLKJVSMlLYzPqoHVHtHj34_Qh3PYIl66Z7WovgI_MYCW_MbDMF5KdWOHZYZEH8qsWeLJRxkKYcYYhv_a76OhKBXDESLkJiqPEt_F1iBh7Um0pQes0R1OlmP4lhfO4rvsrXQzhZcEdw, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1640813422, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.31.0.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.31.0.1, http-session-id=834651652628C2966C01CC3289D5B5E8, http-session-last-accessed-time=1640813128244, kc-category-name=ACCESS, kc-iat=1640813122, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.31.0.1:62648 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2021-12-29 21:25:28.291  INFO 14 --- [nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Request context extracted
2021-12-29 21:25:28.298  INFO 14 --- [nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6a8691f6
2021-12-29 21:25:28.300  INFO 14 --- [nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6a8691f6
2021-12-29 21:25:28.370  INFO 14 --- [nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6a8691f6
2021-12-29 21:25:28.372  INFO 14 --- [nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6a8691f6
2021-12-29 21:25:28.448  INFO 14 --- [nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6a8691f6
2021-12-29 21:25:28.449  WARN 14 --- [nio-7071-exec-1] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2021-12-29 21:25:28.450  WARN 14 --- [nio-7071-exec-1] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2021-12-29 21:25:28.453  INFO 14 --- [nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6a8691f6
2021-12-29 21:25:28.455  INFO 14 --- [nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6a8691f6
2021-12-29 21:25:28.455  WARN 14 --- [nio-7071-exec-1] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2021-12-29 21:25:28.456  WARN 14 --- [nio-7071-exec-1] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2021-12-29 21:25:28.462  INFO 14 --- [nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6a8691f6
2021-12-29 21:25:28.556  INFO 14 --- [nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6a8691f6
2021-12-29 21:25:28.557  INFO 14 --- [nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6a8691f6
2021-12-29 21:25:28.629  INFO 14 --- [nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6a8691f6
2021-12-29 21:25:28.632  INFO 14 --- [nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6a8691f6
2021-12-29 21:25:28.692  INFO 14 --- [nio-7071-exec-1] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-7956946130940-174819, decision=PERMIT, pdp-result=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=PERMIT}})
2021-12-29 21:25:28.693  INFO 14 --- [nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=141775eb-d7f7-47f0-b0cf-ad05e4760e33, content=PERMIT, timestamp=1640813128693, pdpResult=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=PERMIT}}))
2021-12-29 21:25:28.819  INFO 14 --- [nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=cfe118a8-6562-49cc-89d6-611b91359948, content=null, timestamp=1640813128778, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=62650, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=b9c70ccf9dc9, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.31.0.1, kc-session-state=42e84600-4ff9-42d0-a5b1-0e4cd9272614, http-req-server-port=80, http-header-accept=*/*, kc-id=bab1a0fa-4144-4f54-9f8a-85d5c44be1bf, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1640813128774, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYczTbnNxAH4AEQAAAABhzNJCdAAkYmFiMWEwZmEtNDE0NC00ZjU0LTlmOGEtODVkNWM0NGJlMWJmdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkNDJlODQ2MDAtNGZmOS00MmQwLWE1YjEtMGU0Y2Q5MjcyNjE0cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJESFp6RXFmTnRfR3I5TEo1RnRqR3YyUTYwTlNKRnRYell0eVZMQTNjOHZVIn0.eyJleHAiOjE2NDA4MTM0MjIsImlhdCI6MTY0MDgxMzEyMiwianRpIjoiYmFiMWEwZmEtNDE0NC00ZjU0LTlmOGEtODVkNWM0NGJlMWJmIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiNDJlODQ2MDAtNGZmOS00MmQwLWE1YjEtMGU0Y2Q5MjcyNjE0IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Z7_e9m-UxUO3zV3LAQQ7NcaHgBb7ryCqYHgZlKD3WgTdxU5BRE82s3QfcW8YvCiqqFhYgLdg1Qxu-V6yq9NtTFxkrgWMV2TwCxVWgFnfaL6WKNGOvGpokV2IyOM_Ho-gVqPQgsSpS_Ikd1895B-zQUZ7oRe-JEL9o6Lv9Ons8UfrGBRNztTS5bylHynaKHCzp8PltDQrIEHzqLKJVSMlLYzPqoHVHtHj34_Qh3PYIl66Z7WovgI_MYCW_MbDMF5KdWOHZYZEH8qsWeLJRxkKYcYYhv_a76OhKBXDESLkJiqPEt_F1iBh7Um0pQes0R1OlmP4lhfO4rvsrXQzhZcEdw, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1640813422, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.31.0.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.31.0.1, http-session-id=69BF2C356B24EB89D0210F972A7E7854, http-session-last-accessed-time=1640813128774, kc-category-name=ACCESS, kc-iat=1640813122, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.31.0.1:62650 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2021-12-29 21:25:28.821  INFO 14 --- [nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Request context extracted
2021-12-29 21:25:28.828  INFO 14 --- [nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@515becf4
2021-12-29 21:25:28.830  INFO 14 --- [nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@515becf4
2021-12-29 21:25:28.876  INFO 14 --- [nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@515becf4
2021-12-29 21:25:28.880  INFO 14 --- [nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@515becf4
2021-12-29 21:25:28.980  INFO 14 --- [nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@515becf4
2021-12-29 21:25:28.980  WARN 14 --- [nio-7071-exec-2] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2021-12-29 21:25:28.981  WARN 14 --- [nio-7071-exec-2] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2021-12-29 21:25:28.984  INFO 14 --- [nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@515becf4
2021-12-29 21:25:28.986  INFO 14 --- [nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@515becf4
2021-12-29 21:25:28.987  WARN 14 --- [nio-7071-exec-2] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2021-12-29 21:25:28.989  WARN 14 --- [nio-7071-exec-2] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2021-12-29 21:25:28.989  INFO 14 --- [nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@515becf4
2021-12-29 21:25:29.035  INFO 14 --- [nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@515becf4
2021-12-29 21:25:29.036  INFO 14 --- [nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@515becf4
2021-12-29 21:25:29.068  INFO 14 --- [nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@515becf4
2021-12-29 21:25:29.071  INFO 14 --- [nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@515becf4
2021-12-29 21:25:29.164  INFO 14 --- [nio-7071-exec-2] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-7957473948540-222009, decision=PERMIT, pdp-result=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=PERMIT}})
2021-12-29 21:25:29.165  INFO 14 --- [nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=cfe118a8-6562-49cc-89d6-611b91359948, content=PERMIT, timestamp=1640813129165, pdpResult=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=PERMIT}}))
2021-12-29 21:25:29.295  INFO 14 --- [nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=47ca403a-1a56-434b-a4a7-038df1f0e543, content=null, timestamp=1640813129277, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=62652, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=b9c70ccf9dc9, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.31.0.1, kc-session-state=42e84600-4ff9-42d0-a5b1-0e4cd9272614, http-req-server-port=80, http-header-accept=*/*, kc-id=bab1a0fa-4144-4f54-9f8a-85d5c44be1bf, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1640813129265, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYczTbnNxAH4AEQAAAABhzNJCdAAkYmFiMWEwZmEtNDE0NC00ZjU0LTlmOGEtODVkNWM0NGJlMWJmdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkNDJlODQ2MDAtNGZmOS00MmQwLWE1YjEtMGU0Y2Q5MjcyNjE0cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJESFp6RXFmTnRfR3I5TEo1RnRqR3YyUTYwTlNKRnRYell0eVZMQTNjOHZVIn0.eyJleHAiOjE2NDA4MTM0MjIsImlhdCI6MTY0MDgxMzEyMiwianRpIjoiYmFiMWEwZmEtNDE0NC00ZjU0LTlmOGEtODVkNWM0NGJlMWJmIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiNDJlODQ2MDAtNGZmOS00MmQwLWE1YjEtMGU0Y2Q5MjcyNjE0IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Z7_e9m-UxUO3zV3LAQQ7NcaHgBb7ryCqYHgZlKD3WgTdxU5BRE82s3QfcW8YvCiqqFhYgLdg1Qxu-V6yq9NtTFxkrgWMV2TwCxVWgFnfaL6WKNGOvGpokV2IyOM_Ho-gVqPQgsSpS_Ikd1895B-zQUZ7oRe-JEL9o6Lv9Ons8UfrGBRNztTS5bylHynaKHCzp8PltDQrIEHzqLKJVSMlLYzPqoHVHtHj34_Qh3PYIl66Z7WovgI_MYCW_MbDMF5KdWOHZYZEH8qsWeLJRxkKYcYYhv_a76OhKBXDESLkJiqPEt_F1iBh7Um0pQes0R1OlmP4lhfO4rvsrXQzhZcEdw, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1640813422, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.31.0.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.31.0.1, http-session-id=C60A7E3CC0114F5DC485C24BA68B5C2E, http-session-last-accessed-time=1640813129265, kc-category-name=ACCESS, kc-iat=1640813122, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.31.0.1:62652 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2021-12-29 21:25:29.298  INFO 14 --- [nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Request context extracted
2021-12-29 21:25:29.303  INFO 14 --- [nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@333fd205
2021-12-29 21:25:29.306  INFO 14 --- [nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@333fd205
2021-12-29 21:25:29.354  INFO 14 --- [nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@333fd205
2021-12-29 21:25:29.356  INFO 14 --- [nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@333fd205
2021-12-29 21:25:29.401  INFO 14 --- [nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@333fd205
2021-12-29 21:25:29.402  WARN 14 --- [nio-7071-exec-3] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2021-12-29 21:25:29.403  WARN 14 --- [nio-7071-exec-3] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2021-12-29 21:25:29.406  INFO 14 --- [nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@333fd205
2021-12-29 21:25:29.407  INFO 14 --- [nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@333fd205
2021-12-29 21:25:29.410  WARN 14 --- [nio-7071-exec-3] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2021-12-29 21:25:29.411  WARN 14 --- [nio-7071-exec-3] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2021-12-29 21:25:29.412  INFO 14 --- [nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@333fd205
2021-12-29 21:25:29.455  INFO 14 --- [nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@333fd205
2021-12-29 21:25:29.458  INFO 14 --- [nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@333fd205
2021-12-29 21:25:29.547  INFO 14 --- [nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@333fd205
2021-12-29 21:25:29.551  INFO 14 --- [nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@333fd205
2021-12-29 21:25:29.594  INFO 14 --- [nio-7071-exec-3] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-7957950993140-311553, decision=PERMIT, pdp-result=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=PERMIT}})
2021-12-29 21:25:29.595  INFO 14 --- [nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=47ca403a-1a56-434b-a4a7-038df1f0e543, content=PERMIT, timestamp=1640813129595, pdpResult=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=PERMIT}}))
2021-12-29 21:25:29.678  INFO 14 --- [nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=4d351c0d-1838-428d-b160-80eddaaf0020, content=null, timestamp=1640813129654, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=62654, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=b9c70ccf9dc9, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.31.0.1, kc-session-state=42e84600-4ff9-42d0-a5b1-0e4cd9272614, http-req-server-port=80, http-header-accept=*/*, kc-id=bab1a0fa-4144-4f54-9f8a-85d5c44be1bf, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1640813129650, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYczTbnNxAH4AEQAAAABhzNJCdAAkYmFiMWEwZmEtNDE0NC00ZjU0LTlmOGEtODVkNWM0NGJlMWJmdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkNDJlODQ2MDAtNGZmOS00MmQwLWE1YjEtMGU0Y2Q5MjcyNjE0cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJESFp6RXFmTnRfR3I5TEo1RnRqR3YyUTYwTlNKRnRYell0eVZMQTNjOHZVIn0.eyJleHAiOjE2NDA4MTM0MjIsImlhdCI6MTY0MDgxMzEyMiwianRpIjoiYmFiMWEwZmEtNDE0NC00ZjU0LTlmOGEtODVkNWM0NGJlMWJmIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiNDJlODQ2MDAtNGZmOS00MmQwLWE1YjEtMGU0Y2Q5MjcyNjE0IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Z7_e9m-UxUO3zV3LAQQ7NcaHgBb7ryCqYHgZlKD3WgTdxU5BRE82s3QfcW8YvCiqqFhYgLdg1Qxu-V6yq9NtTFxkrgWMV2TwCxVWgFnfaL6WKNGOvGpokV2IyOM_Ho-gVqPQgsSpS_Ikd1895B-zQUZ7oRe-JEL9o6Lv9Ons8UfrGBRNztTS5bylHynaKHCzp8PltDQrIEHzqLKJVSMlLYzPqoHVHtHj34_Qh3PYIl66Z7WovgI_MYCW_MbDMF5KdWOHZYZEH8qsWeLJRxkKYcYYhv_a76OhKBXDESLkJiqPEt_F1iBh7Um0pQes0R1OlmP4lhfO4rvsrXQzhZcEdw, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1640813422, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.31.0.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.31.0.1, http-session-id=4266081B863FD1E141FEF61FAF3CECBD, http-session-last-accessed-time=1640813129650, kc-category-name=ACCESS, kc-iat=1640813122, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.31.0.1:62654 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2021-12-29 21:25:29.679  INFO 14 --- [nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Request context extracted
2021-12-29 21:25:29.685  INFO 14 --- [nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@67e0812d
2021-12-29 21:25:29.687  INFO 14 --- [nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@67e0812d
2021-12-29 21:25:29.802  INFO 14 --- [nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@67e0812d
2021-12-29 21:25:29.804  INFO 14 --- [nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@67e0812d
2021-12-29 21:25:29.859  INFO 14 --- [nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@67e0812d
2021-12-29 21:25:29.868  WARN 14 --- [nio-7071-exec-4] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2021-12-29 21:25:29.869  WARN 14 --- [nio-7071-exec-4] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2021-12-29 21:25:29.870  INFO 14 --- [nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@67e0812d
2021-12-29 21:25:29.873  INFO 14 --- [nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@67e0812d
2021-12-29 21:25:29.874  WARN 14 --- [nio-7071-exec-4] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2021-12-29 21:25:29.875  WARN 14 --- [nio-7071-exec-4] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2021-12-29 21:25:29.877  INFO 14 --- [nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@67e0812d
2021-12-29 21:25:29.995  INFO 14 --- [nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@67e0812d
2021-12-29 21:25:29.995  INFO 14 --- [nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@67e0812d
2021-12-29 21:25:30.077  INFO 14 --- [nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@67e0812d
2021-12-29 21:25:30.078  INFO 14 --- [nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@67e0812d
2021-12-29 21:25:30.172  INFO 14 --- [nio-7071-exec-4] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-7958332760640-834760, decision=PERMIT, pdp-result=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=PERMIT}})
2021-12-29 21:25:30.174  INFO 14 --- [nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=4d351c0d-1838-428d-b160-80eddaaf0020, content=PERMIT, timestamp=1640813130174, pdpResult=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=PERMIT}}))
2021-12-29 21:25:30.278  INFO 14 --- [nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=8dda18aa-609c-44b0-9a02-3b37b97f055d, content=null, timestamp=1640813130261, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=62656, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=b9c70ccf9dc9, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.31.0.1, kc-session-state=42e84600-4ff9-42d0-a5b1-0e4cd9272614, http-req-server-port=80, http-header-accept=*/*, kc-id=bab1a0fa-4144-4f54-9f8a-85d5c44be1bf, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1640813130249, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYczTbnNxAH4AEQAAAABhzNJCdAAkYmFiMWEwZmEtNDE0NC00ZjU0LTlmOGEtODVkNWM0NGJlMWJmdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkNDJlODQ2MDAtNGZmOS00MmQwLWE1YjEtMGU0Y2Q5MjcyNjE0cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJESFp6RXFmTnRfR3I5TEo1RnRqR3YyUTYwTlNKRnRYell0eVZMQTNjOHZVIn0.eyJleHAiOjE2NDA4MTM0MjIsImlhdCI6MTY0MDgxMzEyMiwianRpIjoiYmFiMWEwZmEtNDE0NC00ZjU0LTlmOGEtODVkNWM0NGJlMWJmIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiNDJlODQ2MDAtNGZmOS00MmQwLWE1YjEtMGU0Y2Q5MjcyNjE0IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Z7_e9m-UxUO3zV3LAQQ7NcaHgBb7ryCqYHgZlKD3WgTdxU5BRE82s3QfcW8YvCiqqFhYgLdg1Qxu-V6yq9NtTFxkrgWMV2TwCxVWgFnfaL6WKNGOvGpokV2IyOM_Ho-gVqPQgsSpS_Ikd1895B-zQUZ7oRe-JEL9o6Lv9Ons8UfrGBRNztTS5bylHynaKHCzp8PltDQrIEHzqLKJVSMlLYzPqoHVHtHj34_Qh3PYIl66Z7WovgI_MYCW_MbDMF5KdWOHZYZEH8qsWeLJRxkKYcYYhv_a76OhKBXDESLkJiqPEt_F1iBh7Um0pQes0R1OlmP4lhfO4rvsrXQzhZcEdw, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1640813422, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.31.0.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.31.0.1, http-session-id=F268B561087BAC9436A579C10A1E07C6, http-session-last-accessed-time=1640813130249, kc-category-name=ACCESS, kc-iat=1640813122, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.31.0.1:62656 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2021-12-29 21:25:30.279  INFO 14 --- [nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Request context extracted
2021-12-29 21:25:30.284  INFO 14 --- [nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1c9713c9
2021-12-29 21:25:30.284  INFO 14 --- [nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1c9713c9
2021-12-29 21:25:30.327  INFO 14 --- [nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1c9713c9
2021-12-29 21:25:30.328  INFO 14 --- [nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1c9713c9
2021-12-29 21:25:30.418  INFO 14 --- [nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1c9713c9
2021-12-29 21:25:30.418  WARN 14 --- [nio-7071-exec-5] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2021-12-29 21:25:30.419  WARN 14 --- [nio-7071-exec-5] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2021-12-29 21:25:30.422  INFO 14 --- [nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1c9713c9
2021-12-29 21:25:30.423  INFO 14 --- [nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1c9713c9
2021-12-29 21:25:30.424  WARN 14 --- [nio-7071-exec-5] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2021-12-29 21:25:30.425  WARN 14 --- [nio-7071-exec-5] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2021-12-29 21:25:30.425  INFO 14 --- [nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1c9713c9
2021-12-29 21:25:30.459  INFO 14 --- [nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1c9713c9
2021-12-29 21:25:30.460  INFO 14 --- [nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1c9713c9
2021-12-29 21:25:30.506  INFO 14 --- [nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1c9713c9
2021-12-29 21:25:30.508  INFO 14 --- [nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1c9713c9
2021-12-29 21:25:30.594  INFO 14 --- [nio-7071-exec-5] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-7958932722140-777437, decision=PERMIT, pdp-result=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=PERMIT}})
2021-12-29 21:25:30.595  INFO 14 --- [nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=8dda18aa-609c-44b0-9a02-3b37b97f055d, content=PERMIT, timestamp=1640813130595, pdpResult=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=PERMIT}}))
2021-12-29 21:25:30.692  INFO 14 --- [nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=2d53e9a1-ce5b-41f7-8034-902e0efbe99c, content=null, timestamp=1640813130663, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=62658, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=b9c70ccf9dc9, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.31.0.1, kc-session-state=42e84600-4ff9-42d0-a5b1-0e4cd9272614, http-req-server-port=80, http-header-accept=*/*, kc-id=bab1a0fa-4144-4f54-9f8a-85d5c44be1bf, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1640813130658, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYczTbnNxAH4AEQAAAABhzNJCdAAkYmFiMWEwZmEtNDE0NC00ZjU0LTlmOGEtODVkNWM0NGJlMWJmdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkNDJlODQ2MDAtNGZmOS00MmQwLWE1YjEtMGU0Y2Q5MjcyNjE0cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJESFp6RXFmTnRfR3I5TEo1RnRqR3YyUTYwTlNKRnRYell0eVZMQTNjOHZVIn0.eyJleHAiOjE2NDA4MTM0MjIsImlhdCI6MTY0MDgxMzEyMiwianRpIjoiYmFiMWEwZmEtNDE0NC00ZjU0LTlmOGEtODVkNWM0NGJlMWJmIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiNDJlODQ2MDAtNGZmOS00MmQwLWE1YjEtMGU0Y2Q5MjcyNjE0IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Z7_e9m-UxUO3zV3LAQQ7NcaHgBb7ryCqYHgZlKD3WgTdxU5BRE82s3QfcW8YvCiqqFhYgLdg1Qxu-V6yq9NtTFxkrgWMV2TwCxVWgFnfaL6WKNGOvGpokV2IyOM_Ho-gVqPQgsSpS_Ikd1895B-zQUZ7oRe-JEL9o6Lv9Ons8UfrGBRNztTS5bylHynaKHCzp8PltDQrIEHzqLKJVSMlLYzPqoHVHtHj34_Qh3PYIl66Z7WovgI_MYCW_MbDMF5KdWOHZYZEH8qsWeLJRxkKYcYYhv_a76OhKBXDESLkJiqPEt_F1iBh7Um0pQes0R1OlmP4lhfO4rvsrXQzhZcEdw, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1640813422, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.31.0.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.31.0.1, http-session-id=9BE4EA060460A49D95EA9FD2243F9E50, http-session-last-accessed-time=1640813130658, kc-category-name=ACCESS, kc-iat=1640813122, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.31.0.1:62658 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2021-12-29 21:25:30.696  INFO 14 --- [nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Request context extracted
2021-12-29 21:25:30.700  INFO 14 --- [nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6356c065
2021-12-29 21:25:30.702  INFO 14 --- [nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6356c065
2021-12-29 21:25:30.744  INFO 14 --- [nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6356c065
2021-12-29 21:25:30.752  INFO 14 --- [nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6356c065
2021-12-29 21:25:30.794  INFO 14 --- [nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6356c065
2021-12-29 21:25:30.795  WARN 14 --- [nio-7071-exec-6] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2021-12-29 21:25:30.797  WARN 14 --- [nio-7071-exec-6] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2021-12-29 21:25:30.800  INFO 14 --- [nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6356c065
2021-12-29 21:25:30.800  INFO 14 --- [nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6356c065
2021-12-29 21:25:30.801  WARN 14 --- [nio-7071-exec-6] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2021-12-29 21:25:30.801  WARN 14 --- [nio-7071-exec-6] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2021-12-29 21:25:30.803  INFO 14 --- [nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6356c065
2021-12-29 21:25:30.840  INFO 14 --- [nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6356c065
2021-12-29 21:25:30.841  INFO 14 --- [nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6356c065
2021-12-29 21:25:30.917  INFO 14 --- [nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6356c065
2021-12-29 21:25:30.918  INFO 14 --- [nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6356c065
2021-12-29 21:25:30.965  INFO 14 --- [nio-7071-exec-6] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-7959349793440-541062, decision=PERMIT, pdp-result=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=PERMIT}})
2021-12-29 21:25:30.966  INFO 14 --- [nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=2d53e9a1-ce5b-41f7-8034-902e0efbe99c, content=PERMIT, timestamp=1640813130966, pdpResult=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=PERMIT}}))
2021-12-29 21:25:31.073  INFO 14 --- [nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=03cb6560-5c81-46f7-a4a9-7baa31d958be, content=null, timestamp=1640813131045, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=62660, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=b9c70ccf9dc9, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.31.0.1, kc-session-state=42e84600-4ff9-42d0-a5b1-0e4cd9272614, http-req-server-port=80, http-header-accept=*/*, kc-id=bab1a0fa-4144-4f54-9f8a-85d5c44be1bf, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1640813131037, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYczTbnNxAH4AEQAAAABhzNJCdAAkYmFiMWEwZmEtNDE0NC00ZjU0LTlmOGEtODVkNWM0NGJlMWJmdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkNDJlODQ2MDAtNGZmOS00MmQwLWE1YjEtMGU0Y2Q5MjcyNjE0cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJESFp6RXFmTnRfR3I5TEo1RnRqR3YyUTYwTlNKRnRYell0eVZMQTNjOHZVIn0.eyJleHAiOjE2NDA4MTM0MjIsImlhdCI6MTY0MDgxMzEyMiwianRpIjoiYmFiMWEwZmEtNDE0NC00ZjU0LTlmOGEtODVkNWM0NGJlMWJmIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiNDJlODQ2MDAtNGZmOS00MmQwLWE1YjEtMGU0Y2Q5MjcyNjE0IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Z7_e9m-UxUO3zV3LAQQ7NcaHgBb7ryCqYHgZlKD3WgTdxU5BRE82s3QfcW8YvCiqqFhYgLdg1Qxu-V6yq9NtTFxkrgWMV2TwCxVWgFnfaL6WKNGOvGpokV2IyOM_Ho-gVqPQgsSpS_Ikd1895B-zQUZ7oRe-JEL9o6Lv9Ons8UfrGBRNztTS5bylHynaKHCzp8PltDQrIEHzqLKJVSMlLYzPqoHVHtHj34_Qh3PYIl66Z7WovgI_MYCW_MbDMF5KdWOHZYZEH8qsWeLJRxkKYcYYhv_a76OhKBXDESLkJiqPEt_F1iBh7Um0pQes0R1OlmP4lhfO4rvsrXQzhZcEdw, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1640813422, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.31.0.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.31.0.1, http-session-id=883259AE80C1014B2DAF59109E63D0D8, http-session-last-accessed-time=1640813131037, kc-category-name=ACCESS, kc-iat=1640813122, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.31.0.1:62660 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2021-12-29 21:25:31.084  INFO 14 --- [nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Request context extracted
2021-12-29 21:25:31.088  INFO 14 --- [nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@75161457
2021-12-29 21:25:31.090  INFO 14 --- [nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@75161457
2021-12-29 21:25:31.149  INFO 14 --- [nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@75161457
2021-12-29 21:25:31.149  INFO 14 --- [nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@75161457
2021-12-29 21:25:31.233  INFO 14 --- [nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@75161457
2021-12-29 21:25:31.233  WARN 14 --- [nio-7071-exec-7] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2021-12-29 21:25:31.234  WARN 14 --- [nio-7071-exec-7] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2021-12-29 21:25:31.234  INFO 14 --- [nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@75161457
2021-12-29 21:25:31.235  INFO 14 --- [nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@75161457
2021-12-29 21:25:31.235  WARN 14 --- [nio-7071-exec-7] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2021-12-29 21:25:31.237  WARN 14 --- [nio-7071-exec-7] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2021-12-29 21:25:31.238  INFO 14 --- [nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@75161457
2021-12-29 21:25:31.369  INFO 14 --- [nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@75161457
2021-12-29 21:25:31.369  INFO 14 --- [nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@75161457
2021-12-29 21:25:31.445  INFO 14 --- [nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@75161457
2021-12-29 21:25:31.445  INFO 14 --- [nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@75161457
2021-12-29 21:25:31.562  INFO 14 --- [nio-7071-exec-7] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-7959738020940-503362, decision=PERMIT, pdp-result=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=PERMIT}})
2021-12-29 21:25:31.562  INFO 14 --- [nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=03cb6560-5c81-46f7-a4a9-7baa31d958be, content=PERMIT, timestamp=1640813131562, pdpResult=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=PERMIT}}))
2021-12-29 21:25:31.699  INFO 14 --- [nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=91764e05-47fd-47c7-9b6b-04cb6c013ebd, content=null, timestamp=1640813131680, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=62662, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=b9c70ccf9dc9, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.31.0.1, kc-session-state=42e84600-4ff9-42d0-a5b1-0e4cd9272614, http-req-server-port=80, http-header-accept=*/*, kc-id=bab1a0fa-4144-4f54-9f8a-85d5c44be1bf, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1640813131672, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYczTbnNxAH4AEQAAAABhzNJCdAAkYmFiMWEwZmEtNDE0NC00ZjU0LTlmOGEtODVkNWM0NGJlMWJmdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkNDJlODQ2MDAtNGZmOS00MmQwLWE1YjEtMGU0Y2Q5MjcyNjE0cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJESFp6RXFmTnRfR3I5TEo1RnRqR3YyUTYwTlNKRnRYell0eVZMQTNjOHZVIn0.eyJleHAiOjE2NDA4MTM0MjIsImlhdCI6MTY0MDgxMzEyMiwianRpIjoiYmFiMWEwZmEtNDE0NC00ZjU0LTlmOGEtODVkNWM0NGJlMWJmIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiNDJlODQ2MDAtNGZmOS00MmQwLWE1YjEtMGU0Y2Q5MjcyNjE0IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Z7_e9m-UxUO3zV3LAQQ7NcaHgBb7ryCqYHgZlKD3WgTdxU5BRE82s3QfcW8YvCiqqFhYgLdg1Qxu-V6yq9NtTFxkrgWMV2TwCxVWgFnfaL6WKNGOvGpokV2IyOM_Ho-gVqPQgsSpS_Ikd1895B-zQUZ7oRe-JEL9o6Lv9Ons8UfrGBRNztTS5bylHynaKHCzp8PltDQrIEHzqLKJVSMlLYzPqoHVHtHj34_Qh3PYIl66Z7WovgI_MYCW_MbDMF5KdWOHZYZEH8qsWeLJRxkKYcYYhv_a76OhKBXDESLkJiqPEt_F1iBh7Um0pQes0R1OlmP4lhfO4rvsrXQzhZcEdw, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1640813422, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.31.0.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.31.0.1, http-session-id=FCA8943C0BE9CA3C2A071DF182414EF3, http-session-last-accessed-time=1640813131672, kc-category-name=ACCESS, kc-iat=1640813122, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.31.0.1:62662 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2021-12-29 21:25:31.700  INFO 14 --- [nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Request context extracted
2021-12-29 21:25:31.702  INFO 14 --- [nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5777d74f
2021-12-29 21:25:31.703  INFO 14 --- [nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5777d74f
2021-12-29 21:25:31.747  INFO 14 --- [nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5777d74f
2021-12-29 21:25:31.748  INFO 14 --- [nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5777d74f
2021-12-29 21:25:31.850  INFO 14 --- [nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5777d74f
2021-12-29 21:25:31.852  WARN 14 --- [nio-7071-exec-8] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2021-12-29 21:25:31.853  WARN 14 --- [nio-7071-exec-8] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2021-12-29 21:25:31.857  INFO 14 --- [nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5777d74f
2021-12-29 21:25:31.859  INFO 14 --- [nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5777d74f
2021-12-29 21:25:31.868  WARN 14 --- [nio-7071-exec-8] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2021-12-29 21:25:31.869  WARN 14 --- [nio-7071-exec-8] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2021-12-29 21:25:31.869  INFO 14 --- [nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5777d74f
2021-12-29 21:25:31.921  INFO 14 --- [nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5777d74f
2021-12-29 21:25:31.923  INFO 14 --- [nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5777d74f
2021-12-29 21:25:31.985  INFO 14 --- [nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5777d74f
2021-12-29 21:25:31.985  INFO 14 --- [nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5777d74f
2021-12-29 21:25:32.083  INFO 14 --- [nio-7071-exec-8] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-7960352745140-325753, decision=PERMIT, pdp-result=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=PERMIT}})
2021-12-29 21:25:32.085  INFO 14 --- [nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=91764e05-47fd-47c7-9b6b-04cb6c013ebd, content=PERMIT, timestamp=1640813132084, pdpResult=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=PERMIT}}))
2021-12-29 21:25:32.236  INFO 14 --- [nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=c1208915-e194-4bbf-95f5-be896ecdb9af, content=null, timestamp=1640813132190, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=62664, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=b9c70ccf9dc9, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.31.0.1, kc-session-state=42e84600-4ff9-42d0-a5b1-0e4cd9272614, http-req-server-port=80, http-header-accept=*/*, kc-id=bab1a0fa-4144-4f54-9f8a-85d5c44be1bf, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1640813132181, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYczTbnNxAH4AEQAAAABhzNJCdAAkYmFiMWEwZmEtNDE0NC00ZjU0LTlmOGEtODVkNWM0NGJlMWJmdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkNDJlODQ2MDAtNGZmOS00MmQwLWE1YjEtMGU0Y2Q5MjcyNjE0cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJESFp6RXFmTnRfR3I5TEo1RnRqR3YyUTYwTlNKRnRYell0eVZMQTNjOHZVIn0.eyJleHAiOjE2NDA4MTM0MjIsImlhdCI6MTY0MDgxMzEyMiwianRpIjoiYmFiMWEwZmEtNDE0NC00ZjU0LTlmOGEtODVkNWM0NGJlMWJmIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiNDJlODQ2MDAtNGZmOS00MmQwLWE1YjEtMGU0Y2Q5MjcyNjE0IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Z7_e9m-UxUO3zV3LAQQ7NcaHgBb7ryCqYHgZlKD3WgTdxU5BRE82s3QfcW8YvCiqqFhYgLdg1Qxu-V6yq9NtTFxkrgWMV2TwCxVWgFnfaL6WKNGOvGpokV2IyOM_Ho-gVqPQgsSpS_Ikd1895B-zQUZ7oRe-JEL9o6Lv9Ons8UfrGBRNztTS5bylHynaKHCzp8PltDQrIEHzqLKJVSMlLYzPqoHVHtHj34_Qh3PYIl66Z7WovgI_MYCW_MbDMF5KdWOHZYZEH8qsWeLJRxkKYcYYhv_a76OhKBXDESLkJiqPEt_F1iBh7Um0pQes0R1OlmP4lhfO4rvsrXQzhZcEdw, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1640813422, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.31.0.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.31.0.1, http-session-id=C5130C0C70E826ADC680FE94453DB682, http-session-last-accessed-time=1640813132181, kc-category-name=ACCESS, kc-iat=1640813122, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.31.0.1:62664 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2021-12-29 21:25:32.237  INFO 14 --- [nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Request context extracted
2021-12-29 21:25:32.254  INFO 14 --- [nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4d555c0e
2021-12-29 21:25:32.255  INFO 14 --- [nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4d555c0e
2021-12-29 21:25:32.315  INFO 14 --- [nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4d555c0e
2021-12-29 21:25:32.319  INFO 14 --- [nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4d555c0e
2021-12-29 21:25:32.362  INFO 14 --- [nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4d555c0e
2021-12-29 21:25:32.363  WARN 14 --- [nio-7071-exec-9] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2021-12-29 21:25:32.363  WARN 14 --- [nio-7071-exec-9] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2021-12-29 21:25:32.364  INFO 14 --- [nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4d555c0e
2021-12-29 21:25:32.366  INFO 14 --- [nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4d555c0e
2021-12-29 21:25:32.367  WARN 14 --- [nio-7071-exec-9] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2021-12-29 21:25:32.368  WARN 14 --- [nio-7071-exec-9] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2021-12-29 21:25:32.369  INFO 14 --- [nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4d555c0e
2021-12-29 21:25:32.449  INFO 14 --- [nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4d555c0e
2021-12-29 21:25:32.450  INFO 14 --- [nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4d555c0e
2021-12-29 21:25:32.542  INFO 14 --- [nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4d555c0e
2021-12-29 21:25:32.550  INFO 14 --- [nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4d555c0e
2021-12-29 21:25:32.602  INFO 14 --- [nio-7071-exec-9] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-7960894122840-990125, decision=PERMIT, pdp-result=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=PERMIT}})
2021-12-29 21:25:32.602  INFO 14 --- [nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=c1208915-e194-4bbf-95f5-be896ecdb9af, content=PERMIT, timestamp=1640813132602, pdpResult=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=PERMIT}}))
2021-12-29 21:25:32.723  INFO 14 --- [io-7071-exec-10] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=620e497d-5df7-48fd-b82c-f7e8642446ba, content=null, timestamp=1640813132692, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=62666, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=b9c70ccf9dc9, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.31.0.1, kc-session-state=42e84600-4ff9-42d0-a5b1-0e4cd9272614, http-req-server-port=80, http-header-accept=*/*, kc-id=bab1a0fa-4144-4f54-9f8a-85d5c44be1bf, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1640813132681, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYczTbnNxAH4AEQAAAABhzNJCdAAkYmFiMWEwZmEtNDE0NC00ZjU0LTlmOGEtODVkNWM0NGJlMWJmdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkNDJlODQ2MDAtNGZmOS00MmQwLWE1YjEtMGU0Y2Q5MjcyNjE0cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJESFp6RXFmTnRfR3I5TEo1RnRqR3YyUTYwTlNKRnRYell0eVZMQTNjOHZVIn0.eyJleHAiOjE2NDA4MTM0MjIsImlhdCI6MTY0MDgxMzEyMiwianRpIjoiYmFiMWEwZmEtNDE0NC00ZjU0LTlmOGEtODVkNWM0NGJlMWJmIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiNDJlODQ2MDAtNGZmOS00MmQwLWE1YjEtMGU0Y2Q5MjcyNjE0IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Z7_e9m-UxUO3zV3LAQQ7NcaHgBb7ryCqYHgZlKD3WgTdxU5BRE82s3QfcW8YvCiqqFhYgLdg1Qxu-V6yq9NtTFxkrgWMV2TwCxVWgFnfaL6WKNGOvGpokV2IyOM_Ho-gVqPQgsSpS_Ikd1895B-zQUZ7oRe-JEL9o6Lv9Ons8UfrGBRNztTS5bylHynaKHCzp8PltDQrIEHzqLKJVSMlLYzPqoHVHtHj34_Qh3PYIl66Z7WovgI_MYCW_MbDMF5KdWOHZYZEH8qsWeLJRxkKYcYYhv_a76OhKBXDESLkJiqPEt_F1iBh7Um0pQes0R1OlmP4lhfO4rvsrXQzhZcEdw, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1640813422, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.31.0.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.31.0.1, http-session-id=1C6ACD24C485499B6CCBF15EB84FBAC9, http-session-last-accessed-time=1640813132681, kc-category-name=ACCESS, kc-iat=1640813122, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.31.0.1:62666 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2021-12-29 21:25:32.727  INFO 14 --- [io-7071-exec-10] e.a.a.abac.server.PdpServerController    : Request context extracted
2021-12-29 21:25:32.731  INFO 14 --- [io-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4a4b7aa3
2021-12-29 21:25:32.738  INFO 14 --- [io-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4a4b7aa3
2021-12-29 21:25:32.816  INFO 14 --- [io-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4a4b7aa3
2021-12-29 21:25:32.820  INFO 14 --- [io-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4a4b7aa3
2021-12-29 21:25:32.903  INFO 14 --- [io-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4a4b7aa3
2021-12-29 21:25:32.904  WARN 14 --- [io-7071-exec-10] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2021-12-29 21:25:32.904  WARN 14 --- [io-7071-exec-10] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2021-12-29 21:25:32.906  INFO 14 --- [io-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4a4b7aa3
2021-12-29 21:25:32.907  INFO 14 --- [io-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4a4b7aa3
2021-12-29 21:25:32.907  WARN 14 --- [io-7071-exec-10] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2021-12-29 21:25:32.909  WARN 14 --- [io-7071-exec-10] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2021-12-29 21:25:32.910  INFO 14 --- [io-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4a4b7aa3
2021-12-29 21:25:33.013  INFO 14 --- [io-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4a4b7aa3
2021-12-29 21:25:33.015  INFO 14 --- [io-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4a4b7aa3
2021-12-29 21:25:33.064  INFO 14 --- [io-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4a4b7aa3
2021-12-29 21:25:33.065  INFO 14 --- [io-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4a4b7aa3
2021-12-29 21:25:33.095  INFO 14 --- [io-7071-exec-10] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-7961381445740-303789, decision=PERMIT, pdp-result=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=PERMIT}})
2021-12-29 21:25:33.096  INFO 14 --- [io-7071-exec-10] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=620e497d-5df7-48fd-b82c-f7e8642446ba, content=PERMIT, timestamp=1640813133096, pdpResult=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=PERMIT}}))
2021-12-29 21:25:33.154  INFO 14 --- [nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=c69139cf-abfd-4e53-82f1-509192f22e1d, content=null, timestamp=1640813133145, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=62668, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=b9c70ccf9dc9, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.31.0.1, kc-session-state=42e84600-4ff9-42d0-a5b1-0e4cd9272614, http-req-server-port=80, http-header-accept=*/*, kc-id=bab1a0fa-4144-4f54-9f8a-85d5c44be1bf, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1640813133142, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYczTbnNxAH4AEQAAAABhzNJCdAAkYmFiMWEwZmEtNDE0NC00ZjU0LTlmOGEtODVkNWM0NGJlMWJmdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkNDJlODQ2MDAtNGZmOS00MmQwLWE1YjEtMGU0Y2Q5MjcyNjE0cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJESFp6RXFmTnRfR3I5TEo1RnRqR3YyUTYwTlNKRnRYell0eVZMQTNjOHZVIn0.eyJleHAiOjE2NDA4MTM0MjIsImlhdCI6MTY0MDgxMzEyMiwianRpIjoiYmFiMWEwZmEtNDE0NC00ZjU0LTlmOGEtODVkNWM0NGJlMWJmIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiNDJlODQ2MDAtNGZmOS00MmQwLWE1YjEtMGU0Y2Q5MjcyNjE0IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Z7_e9m-UxUO3zV3LAQQ7NcaHgBb7ryCqYHgZlKD3WgTdxU5BRE82s3QfcW8YvCiqqFhYgLdg1Qxu-V6yq9NtTFxkrgWMV2TwCxVWgFnfaL6WKNGOvGpokV2IyOM_Ho-gVqPQgsSpS_Ikd1895B-zQUZ7oRe-JEL9o6Lv9Ons8UfrGBRNztTS5bylHynaKHCzp8PltDQrIEHzqLKJVSMlLYzPqoHVHtHj34_Qh3PYIl66Z7WovgI_MYCW_MbDMF5KdWOHZYZEH8qsWeLJRxkKYcYYhv_a76OhKBXDESLkJiqPEt_F1iBh7Um0pQes0R1OlmP4lhfO4rvsrXQzhZcEdw, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1640813422, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.31.0.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.31.0.1, http-session-id=2DBC4EB8ABCE3D2E71D51B93C8AF8496, http-session-last-accessed-time=1640813133142, kc-category-name=ACCESS, kc-iat=1640813122, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.31.0.1:62668 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2021-12-29 21:25:33.156  INFO 14 --- [nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Request context extracted
2021-12-29 21:25:33.162  INFO 14 --- [nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2574508b
2021-12-29 21:25:33.167  INFO 14 --- [nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2574508b
2021-12-29 21:25:33.237  INFO 14 --- [nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2574508b
2021-12-29 21:25:33.238  INFO 14 --- [nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2574508b
2021-12-29 21:25:33.258  INFO 14 --- [nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2574508b
2021-12-29 21:25:33.259  WARN 14 --- [nio-7071-exec-1] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2021-12-29 21:25:33.260  WARN 14 --- [nio-7071-exec-1] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2021-12-29 21:25:33.260  INFO 14 --- [nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2574508b
2021-12-29 21:25:33.261  INFO 14 --- [nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2574508b
2021-12-29 21:25:33.261  WARN 14 --- [nio-7071-exec-1] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2021-12-29 21:25:33.262  WARN 14 --- [nio-7071-exec-1] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2021-12-29 21:25:33.262  INFO 14 --- [nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2574508b
2021-12-29 21:25:33.295  INFO 14 --- [nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2574508b
2021-12-29 21:25:33.296  INFO 14 --- [nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2574508b
2021-12-29 21:25:33.361  INFO 14 --- [nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2574508b
2021-12-29 21:25:33.362  INFO 14 --- [nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2574508b
2021-12-29 21:25:33.388  INFO 14 --- [nio-7071-exec-1] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-7961812733240-353915, decision=PERMIT, pdp-result=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=PERMIT}})
2021-12-29 21:25:33.388  INFO 14 --- [nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=c69139cf-abfd-4e53-82f1-509192f22e1d, content=PERMIT, timestamp=1640813133388, pdpResult=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=PERMIT}}))
2021-12-29 21:25:33.481  INFO 14 --- [nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=f7c1a798-76e5-42ff-8e11-26f6789e2ed8, content=null, timestamp=1640813133457, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=62670, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=b9c70ccf9dc9, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.31.0.1, kc-session-state=42e84600-4ff9-42d0-a5b1-0e4cd9272614, http-req-server-port=80, http-header-accept=*/*, kc-id=bab1a0fa-4144-4f54-9f8a-85d5c44be1bf, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1640813133449, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYczTbnNxAH4AEQAAAABhzNJCdAAkYmFiMWEwZmEtNDE0NC00ZjU0LTlmOGEtODVkNWM0NGJlMWJmdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkNDJlODQ2MDAtNGZmOS00MmQwLWE1YjEtMGU0Y2Q5MjcyNjE0cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJESFp6RXFmTnRfR3I5TEo1RnRqR3YyUTYwTlNKRnRYell0eVZMQTNjOHZVIn0.eyJleHAiOjE2NDA4MTM0MjIsImlhdCI6MTY0MDgxMzEyMiwianRpIjoiYmFiMWEwZmEtNDE0NC00ZjU0LTlmOGEtODVkNWM0NGJlMWJmIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiNDJlODQ2MDAtNGZmOS00MmQwLWE1YjEtMGU0Y2Q5MjcyNjE0IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Z7_e9m-UxUO3zV3LAQQ7NcaHgBb7ryCqYHgZlKD3WgTdxU5BRE82s3QfcW8YvCiqqFhYgLdg1Qxu-V6yq9NtTFxkrgWMV2TwCxVWgFnfaL6WKNGOvGpokV2IyOM_Ho-gVqPQgsSpS_Ikd1895B-zQUZ7oRe-JEL9o6Lv9Ons8UfrGBRNztTS5bylHynaKHCzp8PltDQrIEHzqLKJVSMlLYzPqoHVHtHj34_Qh3PYIl66Z7WovgI_MYCW_MbDMF5KdWOHZYZEH8qsWeLJRxkKYcYYhv_a76OhKBXDESLkJiqPEt_F1iBh7Um0pQes0R1OlmP4lhfO4rvsrXQzhZcEdw, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1640813422, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.31.0.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.31.0.1, http-session-id=A3931B78F89CDF3E1EFA8FB51E2C2963, http-session-last-accessed-time=1640813133449, kc-category-name=ACCESS, kc-iat=1640813122, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.31.0.1:62670 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2021-12-29 21:25:33.486  INFO 14 --- [nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Request context extracted
2021-12-29 21:25:33.509  INFO 14 --- [nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5040f56e
2021-12-29 21:25:33.510  INFO 14 --- [nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5040f56e
2021-12-29 21:25:33.553  INFO 14 --- [nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5040f56e
2021-12-29 21:25:33.554  INFO 14 --- [nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5040f56e
2021-12-29 21:25:33.584  INFO 14 --- [nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5040f56e
2021-12-29 21:25:33.584  WARN 14 --- [nio-7071-exec-2] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2021-12-29 21:25:33.584  WARN 14 --- [nio-7071-exec-2] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2021-12-29 21:25:33.585  INFO 14 --- [nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5040f56e
2021-12-29 21:25:33.586  INFO 14 --- [nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5040f56e
2021-12-29 21:25:33.588  WARN 14 --- [nio-7071-exec-2] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2021-12-29 21:25:33.589  WARN 14 --- [nio-7071-exec-2] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2021-12-29 21:25:33.589  INFO 14 --- [nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5040f56e
2021-12-29 21:25:33.669  INFO 14 --- [nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5040f56e
2021-12-29 21:25:33.670  INFO 14 --- [nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5040f56e
2021-12-29 21:25:33.719  INFO 14 --- [nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5040f56e
2021-12-29 21:25:33.720  INFO 14 --- [nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5040f56e
2021-12-29 21:25:33.765  INFO 14 --- [nio-7071-exec-2] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-7962144465740-6542, decision=PERMIT, pdp-result=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=PERMIT}})
2021-12-29 21:25:33.767  INFO 14 --- [nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=f7c1a798-76e5-42ff-8e11-26f6789e2ed8, content=PERMIT, timestamp=1640813133767, pdpResult=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=PERMIT}}))
2021-12-29 21:25:33.867  INFO 14 --- [nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=f625f53b-3261-4389-b728-e08255f139b8, content=null, timestamp=1640813133841, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=62672, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=b9c70ccf9dc9, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.31.0.1, kc-session-state=42e84600-4ff9-42d0-a5b1-0e4cd9272614, http-req-server-port=80, http-header-accept=*/*, kc-id=bab1a0fa-4144-4f54-9f8a-85d5c44be1bf, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1640813133827, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYczTbnNxAH4AEQAAAABhzNJCdAAkYmFiMWEwZmEtNDE0NC00ZjU0LTlmOGEtODVkNWM0NGJlMWJmdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkNDJlODQ2MDAtNGZmOS00MmQwLWE1YjEtMGU0Y2Q5MjcyNjE0cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJESFp6RXFmTnRfR3I5TEo1RnRqR3YyUTYwTlNKRnRYell0eVZMQTNjOHZVIn0.eyJleHAiOjE2NDA4MTM0MjIsImlhdCI6MTY0MDgxMzEyMiwianRpIjoiYmFiMWEwZmEtNDE0NC00ZjU0LTlmOGEtODVkNWM0NGJlMWJmIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiNDJlODQ2MDAtNGZmOS00MmQwLWE1YjEtMGU0Y2Q5MjcyNjE0IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Z7_e9m-UxUO3zV3LAQQ7NcaHgBb7ryCqYHgZlKD3WgTdxU5BRE82s3QfcW8YvCiqqFhYgLdg1Qxu-V6yq9NtTFxkrgWMV2TwCxVWgFnfaL6WKNGOvGpokV2IyOM_Ho-gVqPQgsSpS_Ikd1895B-zQUZ7oRe-JEL9o6Lv9Ons8UfrGBRNztTS5bylHynaKHCzp8PltDQrIEHzqLKJVSMlLYzPqoHVHtHj34_Qh3PYIl66Z7WovgI_MYCW_MbDMF5KdWOHZYZEH8qsWeLJRxkKYcYYhv_a76OhKBXDESLkJiqPEt_F1iBh7Um0pQes0R1OlmP4lhfO4rvsrXQzhZcEdw, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1640813422, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.31.0.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.31.0.1, http-session-id=4AE036701E6A6A9434A1F52C1F175E34, http-session-last-accessed-time=1640813133827, kc-category-name=ACCESS, kc-iat=1640813122, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.31.0.1:62672 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2021-12-29 21:25:33.868  INFO 14 --- [nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Request context extracted
2021-12-29 21:25:33.874  INFO 14 --- [nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1f694e99
2021-12-29 21:25:33.874  INFO 14 --- [nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1f694e99
2021-12-29 21:25:33.901  INFO 14 --- [nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1f694e99
2021-12-29 21:25:33.901  INFO 14 --- [nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1f694e99
2021-12-29 21:25:33.949  INFO 14 --- [nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1f694e99
2021-12-29 21:25:33.949  WARN 14 --- [nio-7071-exec-3] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2021-12-29 21:25:33.950  WARN 14 --- [nio-7071-exec-3] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2021-12-29 21:25:33.952  INFO 14 --- [nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1f694e99
2021-12-29 21:25:33.953  INFO 14 --- [nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1f694e99
2021-12-29 21:25:33.954  WARN 14 --- [nio-7071-exec-3] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2021-12-29 21:25:33.954  WARN 14 --- [nio-7071-exec-3] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2021-12-29 21:25:33.954  INFO 14 --- [nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1f694e99
2021-12-29 21:25:34.005  INFO 14 --- [nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1f694e99
2021-12-29 21:25:34.006  INFO 14 --- [nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1f694e99
2021-12-29 21:25:34.070  INFO 14 --- [nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1f694e99
2021-12-29 21:25:34.071  INFO 14 --- [nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1f694e99
2021-12-29 21:25:34.181  INFO 14 --- [nio-7071-exec-3] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-7962521798340-848213, decision=PERMIT, pdp-result=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=PERMIT}})
2021-12-29 21:25:34.183  INFO 14 --- [nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=f625f53b-3261-4389-b728-e08255f139b8, content=PERMIT, timestamp=1640813134183, pdpResult=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=PERMIT}}))
2021-12-29 21:25:34.283  INFO 14 --- [nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=c3c3be07-35fa-4f38-a380-1f248ad4fefb, content=null, timestamp=1640813134267, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=62674, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=b9c70ccf9dc9, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.31.0.1, kc-session-state=42e84600-4ff9-42d0-a5b1-0e4cd9272614, http-req-server-port=80, http-header-accept=*/*, kc-id=bab1a0fa-4144-4f54-9f8a-85d5c44be1bf, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1640813134260, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYczTbnNxAH4AEQAAAABhzNJCdAAkYmFiMWEwZmEtNDE0NC00ZjU0LTlmOGEtODVkNWM0NGJlMWJmdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkNDJlODQ2MDAtNGZmOS00MmQwLWE1YjEtMGU0Y2Q5MjcyNjE0cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJESFp6RXFmTnRfR3I5TEo1RnRqR3YyUTYwTlNKRnRYell0eVZMQTNjOHZVIn0.eyJleHAiOjE2NDA4MTM0MjIsImlhdCI6MTY0MDgxMzEyMiwianRpIjoiYmFiMWEwZmEtNDE0NC00ZjU0LTlmOGEtODVkNWM0NGJlMWJmIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiNDJlODQ2MDAtNGZmOS00MmQwLWE1YjEtMGU0Y2Q5MjcyNjE0IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Z7_e9m-UxUO3zV3LAQQ7NcaHgBb7ryCqYHgZlKD3WgTdxU5BRE82s3QfcW8YvCiqqFhYgLdg1Qxu-V6yq9NtTFxkrgWMV2TwCxVWgFnfaL6WKNGOvGpokV2IyOM_Ho-gVqPQgsSpS_Ikd1895B-zQUZ7oRe-JEL9o6Lv9Ons8UfrGBRNztTS5bylHynaKHCzp8PltDQrIEHzqLKJVSMlLYzPqoHVHtHj34_Qh3PYIl66Z7WovgI_MYCW_MbDMF5KdWOHZYZEH8qsWeLJRxkKYcYYhv_a76OhKBXDESLkJiqPEt_F1iBh7Um0pQes0R1OlmP4lhfO4rvsrXQzhZcEdw, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1640813422, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.31.0.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.31.0.1, http-session-id=110BCAD5FFE8BEB139A12148239B7F72, http-session-last-accessed-time=1640813134260, kc-category-name=ACCESS, kc-iat=1640813122, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.31.0.1:62674 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2021-12-29 21:25:34.284  INFO 14 --- [nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Request context extracted
2021-12-29 21:25:34.291  INFO 14 --- [nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@27c27976
2021-12-29 21:25:34.293  INFO 14 --- [nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@27c27976
2021-12-29 21:25:34.366  INFO 14 --- [nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@27c27976
2021-12-29 21:25:34.367  INFO 14 --- [nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@27c27976
2021-12-29 21:25:34.399  INFO 14 --- [nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@27c27976
2021-12-29 21:25:34.400  WARN 14 --- [nio-7071-exec-4] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2021-12-29 21:25:34.400  WARN 14 --- [nio-7071-exec-4] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2021-12-29 21:25:34.401  INFO 14 --- [nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@27c27976
2021-12-29 21:25:34.407  INFO 14 --- [nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@27c27976
2021-12-29 21:25:34.407  WARN 14 --- [nio-7071-exec-4] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2021-12-29 21:25:34.407  WARN 14 --- [nio-7071-exec-4] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2021-12-29 21:25:34.409  INFO 14 --- [nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@27c27976
2021-12-29 21:25:34.434  INFO 14 --- [nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@27c27976
2021-12-29 21:25:34.435  INFO 14 --- [nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@27c27976
2021-12-29 21:25:34.511  INFO 14 --- [nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@27c27976
2021-12-29 21:25:34.511  INFO 14 --- [nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@27c27976
2021-12-29 21:25:34.537  INFO 14 --- [nio-7071-exec-4] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-7962972076440-630006, decision=PERMIT, pdp-result=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=PERMIT}})
2021-12-29 21:25:34.537  INFO 14 --- [nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=c3c3be07-35fa-4f38-a380-1f248ad4fefb, content=PERMIT, timestamp=1640813134537, pdpResult=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=PERMIT}}))
2021-12-29 21:25:34.594  INFO 14 --- [nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=db437919-1bc4-4987-856f-e849cce078f2, content=null, timestamp=1640813134582, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=62676, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=b9c70ccf9dc9, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.31.0.1, kc-session-state=42e84600-4ff9-42d0-a5b1-0e4cd9272614, http-req-server-port=80, http-header-accept=*/*, kc-id=bab1a0fa-4144-4f54-9f8a-85d5c44be1bf, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1640813134580, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYczTbnNxAH4AEQAAAABhzNJCdAAkYmFiMWEwZmEtNDE0NC00ZjU0LTlmOGEtODVkNWM0NGJlMWJmdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkNDJlODQ2MDAtNGZmOS00MmQwLWE1YjEtMGU0Y2Q5MjcyNjE0cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJESFp6RXFmTnRfR3I5TEo1RnRqR3YyUTYwTlNKRnRYell0eVZMQTNjOHZVIn0.eyJleHAiOjE2NDA4MTM0MjIsImlhdCI6MTY0MDgxMzEyMiwianRpIjoiYmFiMWEwZmEtNDE0NC00ZjU0LTlmOGEtODVkNWM0NGJlMWJmIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiNDJlODQ2MDAtNGZmOS00MmQwLWE1YjEtMGU0Y2Q5MjcyNjE0IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Z7_e9m-UxUO3zV3LAQQ7NcaHgBb7ryCqYHgZlKD3WgTdxU5BRE82s3QfcW8YvCiqqFhYgLdg1Qxu-V6yq9NtTFxkrgWMV2TwCxVWgFnfaL6WKNGOvGpokV2IyOM_Ho-gVqPQgsSpS_Ikd1895B-zQUZ7oRe-JEL9o6Lv9Ons8UfrGBRNztTS5bylHynaKHCzp8PltDQrIEHzqLKJVSMlLYzPqoHVHtHj34_Qh3PYIl66Z7WovgI_MYCW_MbDMF5KdWOHZYZEH8qsWeLJRxkKYcYYhv_a76OhKBXDESLkJiqPEt_F1iBh7Um0pQes0R1OlmP4lhfO4rvsrXQzhZcEdw, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1640813422, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.31.0.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.31.0.1, http-session-id=C5771511E2742CEE1671502AB2DEC246, http-session-last-accessed-time=1640813134580, kc-category-name=ACCESS, kc-iat=1640813122, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.31.0.1:62676 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2021-12-29 21:25:34.594  INFO 14 --- [nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Request context extracted
2021-12-29 21:25:34.598  INFO 14 --- [nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5c6c619e
2021-12-29 21:25:34.609  INFO 14 --- [nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5c6c619e
2021-12-29 21:25:34.649  INFO 14 --- [nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5c6c619e
2021-12-29 21:25:34.652  INFO 14 --- [nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5c6c619e
2021-12-29 21:25:34.683  INFO 14 --- [nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5c6c619e
2021-12-29 21:25:34.683  WARN 14 --- [nio-7071-exec-5] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2021-12-29 21:25:34.683  WARN 14 --- [nio-7071-exec-5] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2021-12-29 21:25:34.685  INFO 14 --- [nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5c6c619e
2021-12-29 21:25:34.686  INFO 14 --- [nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5c6c619e
2021-12-29 21:25:34.687  WARN 14 --- [nio-7071-exec-5] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2021-12-29 21:25:34.688  WARN 14 --- [nio-7071-exec-5] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2021-12-29 21:25:34.688  INFO 14 --- [nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5c6c619e
2021-12-29 21:25:34.765  INFO 14 --- [nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5c6c619e
2021-12-29 21:25:34.765  INFO 14 --- [nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5c6c619e
2021-12-29 21:25:34.795  INFO 14 --- [nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5c6c619e
2021-12-29 21:25:34.796  INFO 14 --- [nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5c6c619e
2021-12-29 21:25:34.822  INFO 14 --- [nio-7071-exec-5] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-7963280936140-967743, decision=PERMIT, pdp-result=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=PERMIT}})
2021-12-29 21:25:34.822  INFO 14 --- [nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=db437919-1bc4-4987-856f-e849cce078f2, content=PERMIT, timestamp=1640813134822, pdpResult=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=PERMIT}}))
2021-12-29 21:25:34.918  INFO 14 --- [nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=89282d07-872f-43ee-8ae7-16958c277f54, content=null, timestamp=1640813134892, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=62678, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=b9c70ccf9dc9, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.31.0.1, kc-session-state=42e84600-4ff9-42d0-a5b1-0e4cd9272614, http-req-server-port=80, http-header-accept=*/*, kc-id=bab1a0fa-4144-4f54-9f8a-85d5c44be1bf, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1640813134884, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYczTbnNxAH4AEQAAAABhzNJCdAAkYmFiMWEwZmEtNDE0NC00ZjU0LTlmOGEtODVkNWM0NGJlMWJmdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkNDJlODQ2MDAtNGZmOS00MmQwLWE1YjEtMGU0Y2Q5MjcyNjE0cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJESFp6RXFmTnRfR3I5TEo1RnRqR3YyUTYwTlNKRnRYell0eVZMQTNjOHZVIn0.eyJleHAiOjE2NDA4MTM0MjIsImlhdCI6MTY0MDgxMzEyMiwianRpIjoiYmFiMWEwZmEtNDE0NC00ZjU0LTlmOGEtODVkNWM0NGJlMWJmIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiNDJlODQ2MDAtNGZmOS00MmQwLWE1YjEtMGU0Y2Q5MjcyNjE0IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Z7_e9m-UxUO3zV3LAQQ7NcaHgBb7ryCqYHgZlKD3WgTdxU5BRE82s3QfcW8YvCiqqFhYgLdg1Qxu-V6yq9NtTFxkrgWMV2TwCxVWgFnfaL6WKNGOvGpokV2IyOM_Ho-gVqPQgsSpS_Ikd1895B-zQUZ7oRe-JEL9o6Lv9Ons8UfrGBRNztTS5bylHynaKHCzp8PltDQrIEHzqLKJVSMlLYzPqoHVHtHj34_Qh3PYIl66Z7WovgI_MYCW_MbDMF5KdWOHZYZEH8qsWeLJRxkKYcYYhv_a76OhKBXDESLkJiqPEt_F1iBh7Um0pQes0R1OlmP4lhfO4rvsrXQzhZcEdw, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1640813422, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.31.0.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.31.0.1, http-session-id=2AB0F1F3966C6008FDCF2B02C8009E93, http-session-last-accessed-time=1640813134884, kc-category-name=ACCESS, kc-iat=1640813122, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.31.0.1:62678 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2021-12-29 21:25:34.919  INFO 14 --- [nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Request context extracted
2021-12-29 21:25:34.924  INFO 14 --- [nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@66739bd6
2021-12-29 21:25:34.934  INFO 14 --- [nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@66739bd6
2021-12-29 21:25:34.970  INFO 14 --- [nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@66739bd6
2021-12-29 21:25:34.982  INFO 14 --- [nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@66739bd6
2021-12-29 21:25:35.067  INFO 14 --- [nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@66739bd6
2021-12-29 21:25:35.067  WARN 14 --- [nio-7071-exec-6] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2021-12-29 21:25:35.068  WARN 14 --- [nio-7071-exec-6] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2021-12-29 21:25:35.071  INFO 14 --- [nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@66739bd6
2021-12-29 21:25:35.072  INFO 14 --- [nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@66739bd6
2021-12-29 21:25:35.072  WARN 14 --- [nio-7071-exec-6] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2021-12-29 21:25:35.075  WARN 14 --- [nio-7071-exec-6] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2021-12-29 21:25:35.075  INFO 14 --- [nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@66739bd6
2021-12-29 21:25:35.110  INFO 14 --- [nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@66739bd6
2021-12-29 21:25:35.110  INFO 14 --- [nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@66739bd6
2021-12-29 21:25:35.155  INFO 14 --- [nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@66739bd6
2021-12-29 21:25:35.160  INFO 14 --- [nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@66739bd6
2021-12-29 21:25:35.239  INFO 14 --- [nio-7071-exec-6] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-7963608659940-312831, decision=PERMIT, pdp-result=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=PERMIT}})
2021-12-29 21:25:35.239  INFO 14 --- [nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=89282d07-872f-43ee-8ae7-16958c277f54, content=PERMIT, timestamp=1640813135239, pdpResult=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=PERMIT}}))
2021-12-29 21:25:35.339  INFO 14 --- [nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=e47169bf-ed2a-44a0-a067-8e61940e736e, content=null, timestamp=1640813135306, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=62680, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=b9c70ccf9dc9, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.31.0.1, kc-session-state=42e84600-4ff9-42d0-a5b1-0e4cd9272614, http-req-server-port=80, http-header-accept=*/*, kc-id=bab1a0fa-4144-4f54-9f8a-85d5c44be1bf, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1640813135291, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYczTbnNxAH4AEQAAAABhzNJCdAAkYmFiMWEwZmEtNDE0NC00ZjU0LTlmOGEtODVkNWM0NGJlMWJmdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkNDJlODQ2MDAtNGZmOS00MmQwLWE1YjEtMGU0Y2Q5MjcyNjE0cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJESFp6RXFmTnRfR3I5TEo1RnRqR3YyUTYwTlNKRnRYell0eVZMQTNjOHZVIn0.eyJleHAiOjE2NDA4MTM0MjIsImlhdCI6MTY0MDgxMzEyMiwianRpIjoiYmFiMWEwZmEtNDE0NC00ZjU0LTlmOGEtODVkNWM0NGJlMWJmIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiNDJlODQ2MDAtNGZmOS00MmQwLWE1YjEtMGU0Y2Q5MjcyNjE0IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Z7_e9m-UxUO3zV3LAQQ7NcaHgBb7ryCqYHgZlKD3WgTdxU5BRE82s3QfcW8YvCiqqFhYgLdg1Qxu-V6yq9NtTFxkrgWMV2TwCxVWgFnfaL6WKNGOvGpokV2IyOM_Ho-gVqPQgsSpS_Ikd1895B-zQUZ7oRe-JEL9o6Lv9Ons8UfrGBRNztTS5bylHynaKHCzp8PltDQrIEHzqLKJVSMlLYzPqoHVHtHj34_Qh3PYIl66Z7WovgI_MYCW_MbDMF5KdWOHZYZEH8qsWeLJRxkKYcYYhv_a76OhKBXDESLkJiqPEt_F1iBh7Um0pQes0R1OlmP4lhfO4rvsrXQzhZcEdw, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1640813422, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.31.0.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.31.0.1, http-session-id=EB68A072252CFF4E785CD897BD42CE39, http-session-last-accessed-time=1640813135291, kc-category-name=ACCESS, kc-iat=1640813122, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.31.0.1:62680 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2021-12-29 21:25:35.340  INFO 14 --- [nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Request context extracted
2021-12-29 21:25:35.343  INFO 14 --- [nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2441ea66
2021-12-29 21:25:35.343  INFO 14 --- [nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2441ea66
2021-12-29 21:25:35.389  INFO 14 --- [nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2441ea66
2021-12-29 21:25:35.389  INFO 14 --- [nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2441ea66
2021-12-29 21:25:35.424  INFO 14 --- [nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2441ea66
2021-12-29 21:25:35.424  WARN 14 --- [nio-7071-exec-7] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2021-12-29 21:25:35.424  WARN 14 --- [nio-7071-exec-7] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2021-12-29 21:25:35.429  INFO 14 --- [nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2441ea66
2021-12-29 21:25:35.430  INFO 14 --- [nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2441ea66
2021-12-29 21:25:35.430  WARN 14 --- [nio-7071-exec-7] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2021-12-29 21:25:35.430  WARN 14 --- [nio-7071-exec-7] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2021-12-29 21:25:35.431  INFO 14 --- [nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2441ea66
2021-12-29 21:25:35.508  INFO 14 --- [nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2441ea66
2021-12-29 21:25:35.508  INFO 14 --- [nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2441ea66
2021-12-29 21:25:35.608  INFO 14 --- [nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2441ea66
2021-12-29 21:25:35.608  INFO 14 --- [nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@2441ea66
2021-12-29 21:25:35.701  INFO 14 --- [nio-7071-exec-7] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-7964026612640-623415, decision=PERMIT, pdp-result=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=PERMIT}})
2021-12-29 21:25:35.701  INFO 14 --- [nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=e47169bf-ed2a-44a0-a067-8e61940e736e, content=PERMIT, timestamp=1640813135701, pdpResult=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=PERMIT}}))
2021-12-29 21:25:35.805  INFO 14 --- [nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=39cd19de-e798-4c04-a059-5904ee58ff4a, content=null, timestamp=1640813135796, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=62682, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=b9c70ccf9dc9, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.31.0.1, kc-session-state=42e84600-4ff9-42d0-a5b1-0e4cd9272614, http-req-server-port=80, http-header-accept=*/*, kc-id=bab1a0fa-4144-4f54-9f8a-85d5c44be1bf, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1640813135794, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYczTbnNxAH4AEQAAAABhzNJCdAAkYmFiMWEwZmEtNDE0NC00ZjU0LTlmOGEtODVkNWM0NGJlMWJmdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkNDJlODQ2MDAtNGZmOS00MmQwLWE1YjEtMGU0Y2Q5MjcyNjE0cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJESFp6RXFmTnRfR3I5TEo1RnRqR3YyUTYwTlNKRnRYell0eVZMQTNjOHZVIn0.eyJleHAiOjE2NDA4MTM0MjIsImlhdCI6MTY0MDgxMzEyMiwianRpIjoiYmFiMWEwZmEtNDE0NC00ZjU0LTlmOGEtODVkNWM0NGJlMWJmIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiNDJlODQ2MDAtNGZmOS00MmQwLWE1YjEtMGU0Y2Q5MjcyNjE0IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Z7_e9m-UxUO3zV3LAQQ7NcaHgBb7ryCqYHgZlKD3WgTdxU5BRE82s3QfcW8YvCiqqFhYgLdg1Qxu-V6yq9NtTFxkrgWMV2TwCxVWgFnfaL6WKNGOvGpokV2IyOM_Ho-gVqPQgsSpS_Ikd1895B-zQUZ7oRe-JEL9o6Lv9Ons8UfrGBRNztTS5bylHynaKHCzp8PltDQrIEHzqLKJVSMlLYzPqoHVHtHj34_Qh3PYIl66Z7WovgI_MYCW_MbDMF5KdWOHZYZEH8qsWeLJRxkKYcYYhv_a76OhKBXDESLkJiqPEt_F1iBh7Um0pQes0R1OlmP4lhfO4rvsrXQzhZcEdw, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1640813422, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.31.0.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.31.0.1, http-session-id=5B887181122A7BBEEC62E938635B2A3C, http-session-last-accessed-time=1640813135794, kc-category-name=ACCESS, kc-iat=1640813122, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.31.0.1:62682 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2021-12-29 21:25:35.805  INFO 14 --- [nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Request context extracted
2021-12-29 21:25:35.809  INFO 14 --- [nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@70ccfca4
2021-12-29 21:25:35.809  INFO 14 --- [nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@70ccfca4
2021-12-29 21:25:35.876  INFO 14 --- [nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@70ccfca4
2021-12-29 21:25:35.876  INFO 14 --- [nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@70ccfca4
2021-12-29 21:25:35.913  INFO 14 --- [nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@70ccfca4
2021-12-29 21:25:35.913  WARN 14 --- [nio-7071-exec-8] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2021-12-29 21:25:35.914  WARN 14 --- [nio-7071-exec-8] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2021-12-29 21:25:35.915  INFO 14 --- [nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@70ccfca4
2021-12-29 21:25:35.916  INFO 14 --- [nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@70ccfca4
2021-12-29 21:25:35.916  WARN 14 --- [nio-7071-exec-8] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2021-12-29 21:25:35.919  WARN 14 --- [nio-7071-exec-8] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2021-12-29 21:25:35.920  INFO 14 --- [nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@70ccfca4
2021-12-29 21:25:35.995  INFO 14 --- [nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@70ccfca4
2021-12-29 21:25:35.996  INFO 14 --- [nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@70ccfca4
2021-12-29 21:25:36.035  INFO 14 --- [nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@70ccfca4
2021-12-29 21:25:36.035  INFO 14 --- [nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@70ccfca4
2021-12-29 21:25:36.067  INFO 14 --- [nio-7071-exec-8] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-7964492209240-937503, decision=PERMIT, pdp-result=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=PERMIT}})
2021-12-29 21:25:36.067  INFO 14 --- [nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=39cd19de-e798-4c04-a059-5904ee58ff4a, content=PERMIT, timestamp=1640813136067, pdpResult=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=PERMIT}}))
2021-12-29 21:25:36.153  INFO 14 --- [nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=0203fa05-584e-4b30-936f-3f36dff70854, content=null, timestamp=1640813136136, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=62684, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=b9c70ccf9dc9, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.31.0.1, kc-session-state=42e84600-4ff9-42d0-a5b1-0e4cd9272614, http-req-server-port=80, http-header-accept=*/*, kc-id=bab1a0fa-4144-4f54-9f8a-85d5c44be1bf, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1640813136134, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYczTbnNxAH4AEQAAAABhzNJCdAAkYmFiMWEwZmEtNDE0NC00ZjU0LTlmOGEtODVkNWM0NGJlMWJmdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkNDJlODQ2MDAtNGZmOS00MmQwLWE1YjEtMGU0Y2Q5MjcyNjE0cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJESFp6RXFmTnRfR3I5TEo1RnRqR3YyUTYwTlNKRnRYell0eVZMQTNjOHZVIn0.eyJleHAiOjE2NDA4MTM0MjIsImlhdCI6MTY0MDgxMzEyMiwianRpIjoiYmFiMWEwZmEtNDE0NC00ZjU0LTlmOGEtODVkNWM0NGJlMWJmIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiNDJlODQ2MDAtNGZmOS00MmQwLWE1YjEtMGU0Y2Q5MjcyNjE0IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Z7_e9m-UxUO3zV3LAQQ7NcaHgBb7ryCqYHgZlKD3WgTdxU5BRE82s3QfcW8YvCiqqFhYgLdg1Qxu-V6yq9NtTFxkrgWMV2TwCxVWgFnfaL6WKNGOvGpokV2IyOM_Ho-gVqPQgsSpS_Ikd1895B-zQUZ7oRe-JEL9o6Lv9Ons8UfrGBRNztTS5bylHynaKHCzp8PltDQrIEHzqLKJVSMlLYzPqoHVHtHj34_Qh3PYIl66Z7WovgI_MYCW_MbDMF5KdWOHZYZEH8qsWeLJRxkKYcYYhv_a76OhKBXDESLkJiqPEt_F1iBh7Um0pQes0R1OlmP4lhfO4rvsrXQzhZcEdw, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1640813422, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.31.0.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.31.0.1, http-session-id=6A2566E803FEC52EE617F8E2FB448491, http-session-last-accessed-time=1640813136134, kc-category-name=ACCESS, kc-iat=1640813122, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.31.0.1:62684 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2021-12-29 21:25:36.153  INFO 14 --- [nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Request context extracted
2021-12-29 21:25:36.159  INFO 14 --- [nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@b9602a9
2021-12-29 21:25:36.160  INFO 14 --- [nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@b9602a9
2021-12-29 21:25:36.199  INFO 14 --- [nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@b9602a9
2021-12-29 21:25:36.201  INFO 14 --- [nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@b9602a9
2021-12-29 21:25:36.265  INFO 14 --- [nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@b9602a9
2021-12-29 21:25:36.265  WARN 14 --- [nio-7071-exec-9] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2021-12-29 21:25:36.266  WARN 14 --- [nio-7071-exec-9] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2021-12-29 21:25:36.267  INFO 14 --- [nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@b9602a9
2021-12-29 21:25:36.269  INFO 14 --- [nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@b9602a9
2021-12-29 21:25:36.269  WARN 14 --- [nio-7071-exec-9] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2021-12-29 21:25:36.271  WARN 14 --- [nio-7071-exec-9] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2021-12-29 21:25:36.271  INFO 14 --- [nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@b9602a9
2021-12-29 21:25:36.301  INFO 14 --- [nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@b9602a9
2021-12-29 21:25:36.305  INFO 14 --- [nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@b9602a9
2021-12-29 21:25:36.344  INFO 14 --- [nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@b9602a9
2021-12-29 21:25:36.344  INFO 14 --- [nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@b9602a9
2021-12-29 21:25:36.431  INFO 14 --- [nio-7071-exec-9] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-7964840155440-618425, decision=PERMIT, pdp-result=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=PERMIT}})
2021-12-29 21:25:36.431  INFO 14 --- [nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=0203fa05-584e-4b30-936f-3f36dff70854, content=PERMIT, timestamp=1640813136431, pdpResult=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=PERMIT}}))
2021-12-29 21:25:36.493  INFO 14 --- [io-7071-exec-10] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=925eaa01-eaff-4c3f-84a8-1913af79124e, content=null, timestamp=1640813136477, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=62686, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=b9c70ccf9dc9, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=172.31.0.1, kc-session-state=42e84600-4ff9-42d0-a5b1-0e4cd9272614, http-req-server-port=80, http-header-accept=*/*, kc-id=bab1a0fa-4144-4f54-9f8a-85d5c44be1bf, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1640813136472, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYczTbnNxAH4AEQAAAABhzNJCdAAkYmFiMWEwZmEtNDE0NC00ZjU0LTlmOGEtODVkNWM0NGJlMWJmdAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkNDJlODQ2MDAtNGZmOS00MmQwLWE1YjEtMGU0Y2Q5MjcyNjE0cHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJESFp6RXFmTnRfR3I5TEo1RnRqR3YyUTYwTlNKRnRYell0eVZMQTNjOHZVIn0.eyJleHAiOjE2NDA4MTM0MjIsImlhdCI6MTY0MDgxMzEyMiwianRpIjoiYmFiMWEwZmEtNDE0NC00ZjU0LTlmOGEtODVkNWM0NGJlMWJmIiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiNDJlODQ2MDAtNGZmOS00MmQwLWE1YjEtMGU0Y2Q5MjcyNjE0IiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.Z7_e9m-UxUO3zV3LAQQ7NcaHgBb7ryCqYHgZlKD3WgTdxU5BRE82s3QfcW8YvCiqqFhYgLdg1Qxu-V6yq9NtTFxkrgWMV2TwCxVWgFnfaL6WKNGOvGpokV2IyOM_Ho-gVqPQgsSpS_Ikd1895B-zQUZ7oRe-JEL9o6Lv9Ons8UfrGBRNztTS5bylHynaKHCzp8PltDQrIEHzqLKJVSMlLYzPqoHVHtHj34_Qh3PYIl66Z7WovgI_MYCW_MbDMF5KdWOHZYZEH8qsWeLJRxkKYcYYhv_a76OhKBXDESLkJiqPEt_F1iBh7Um0pQes0R1OlmP4lhfO4rvsrXQzhZcEdw, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1640813422, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=172.31.0.11, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=172.31.0.1, http-session-id=7518C6D021DD101F7F3E9880FB98BC50, http-session-last-accessed-time=1640813136472, kc-category-name=ACCESS, kc-iat=1640813122, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=172.31.0.1:62686 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2021-12-29 21:25:36.493  INFO 14 --- [io-7071-exec-10] e.a.a.abac.server.PdpServerController    : Request context extracted
2021-12-29 21:25:36.507  INFO 14 --- [io-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3fcaecd9
2021-12-29 21:25:36.510  INFO 14 --- [io-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3fcaecd9
2021-12-29 21:25:36.548  INFO 14 --- [io-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3fcaecd9
2021-12-29 21:25:36.549  INFO 14 --- [io-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3fcaecd9
2021-12-29 21:25:36.586  INFO 14 --- [io-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3fcaecd9
2021-12-29 21:25:36.586  WARN 14 --- [io-7071-exec-10] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2021-12-29 21:25:36.586  WARN 14 --- [io-7071-exec-10] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2021-12-29 21:25:36.587  INFO 14 --- [io-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3fcaecd9
2021-12-29 21:25:36.590  INFO 14 --- [io-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3fcaecd9
2021-12-29 21:25:36.591  WARN 14 --- [io-7071-exec-10] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2021-12-29 21:25:36.592  WARN 14 --- [io-7071-exec-10] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2021-12-29 21:25:36.593  INFO 14 --- [io-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3fcaecd9
2021-12-29 21:25:36.635  INFO 14 --- [io-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3fcaecd9
2021-12-29 21:25:36.636  INFO 14 --- [io-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3fcaecd9
2021-12-29 21:25:36.720  INFO 14 --- [io-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3fcaecd9
2021-12-29 21:25:36.721  INFO 14 --- [io-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3fcaecd9
2021-12-29 21:25:36.744  INFO 14 --- [io-7071-exec-10] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-7965179791840-366663, decision=PERMIT, pdp-result=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=PERMIT}})
2021-12-29 21:25:36.744  INFO 14 --- [io-7071-exec-10] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=925eaa01-eaff-4c3f-84a8-1913af79124e, content=PERMIT, timestamp=1640813136744, pdpResult=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=PERMIT}}))
