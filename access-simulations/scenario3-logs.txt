*** ABAC Authorization Server ***

Config. Dir.: ./config
Policies Dir: ./policies

No configuration file found. Copying default configuration and keystores.
Any existing files will not be altered.
'samples/config/authorization-server.properties' -> './config/authorization-server.properties'
'samples/config/balana.cfg.xml' -> './config/balana.cfg.xml'

External Lib. path: /abac-server/ext/abac-example-context-handlers-1.0.0-SNAPSHOT-jar-with-dependencies.jar
Monitoring: ./policies/*.xml  Polling every 5s...

  .   ____          _            __ _ _
 /\\ / ___'_ __ _ _(_)_ __  __ _ \ \ \ \
( ( )\___ | '_ | '_| | '_ \/ _` | \ \ \ \
 \\/  ___)| |_)| | | | | || (_| |  ) ) ) )
  '  |____| .__|_| |_|_| |_\__, | / / / /
 =========|_|==============|___/=/_/_/_/
 :: Spring Boot ::                (v2.6.2)

2021-12-31 01:07:04.826  INFO 15 --- [           main] .a.a.a.s.AuthorizationServiceApplication : Starting AuthorizationServiceApplication v3.0.4 using Java 1.8.0_212 on 9b66b78c9568 with PID 15 (/abac-server/abac-authorization-server-exec.jar started by root in /abac-server)
2021-12-31 01:07:04.854  INFO 15 --- [           main] .a.a.a.s.AuthorizationServiceApplication : No active profile set, falling back to default profiles: default
2021-12-31 01:07:12.572  INFO 15 --- [           main] .s.d.r.c.RepositoryConfigurationDelegate : Bootstrapping Spring Data JPA repositories in DEFAULT mode.
2021-12-31 01:07:13.122  INFO 15 --- [           main] .s.d.r.c.RepositoryConfigurationDelegate : Finished Spring Data repository scanning in 459 ms. Found 3 JPA repository interfaces.
2021-12-31 01:07:18.720  INFO 15 --- [           main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat initialized with port(s): 7071 (https)
2021-12-31 01:07:18.910  INFO 15 --- [           main] o.apache.catalina.core.StandardService   : Starting service [Tomcat]
2021-12-31 01:07:18.920  INFO 15 --- [           main] org.apache.catalina.core.StandardEngine  : Starting Servlet engine: [Apache Tomcat/9.0.56]
2021-12-31 01:07:19.988  INFO 15 --- [           main] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring embedded WebApplicationContext
2021-12-31 01:07:19.995  INFO 15 --- [           main] w.s.c.ServletWebServerApplicationContext : Root WebApplicationContext: initialization completed in 14524 ms
2021-12-31 01:07:20.455  INFO 15 --- [           main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Starting...
2021-12-31 01:07:20.499  WARN 15 --- [           main] com.zaxxer.hikari.util.DriverDataSource  : Registered driver with driverClassName=com.mysql.jdbc.Driver was not found, trying direct instantiation.
2021-12-31 01:07:22.032  INFO 15 --- [           main] com.zaxxer.hikari.HikariDataSource       : HikariPool-1 - Start completed.
2021-12-31 01:07:22.113  INFO 15 --- [           main] o.s.b.a.h2.H2ConsoleAutoConfiguration    : H2 console available at '/h2-console'. Database available at 'jdbc:mysql://mysql:3306/apam_db?createDatabaseIfNotExist=true'
2021-12-31 01:07:23.703  INFO 15 --- [           main] o.hibernate.jpa.internal.util.LogHelper  : HHH000204: Processing PersistenceUnitInfo [name: default]
2021-12-31 01:07:24.143  INFO 15 --- [           main] org.hibernate.Version                    : HHH000412: Hibernate ORM core version 5.6.3.Final
2021-12-31 01:07:25.541  INFO 15 --- [           main] o.hibernate.annotations.common.Version   : HCANN000001: Hibernate Commons Annotations {5.1.2.Final}
2021-12-31 01:07:26.503  INFO 15 --- [           main] org.hibernate.dialect.Dialect            : HHH000400: Using dialect: org.hibernate.dialect.MySQL5InnoDBDialect
2021-12-31 01:07:30.350  INFO 15 --- [           main] o.h.e.t.j.p.i.JtaPlatformInitiator       : HHH000490: Using JtaPlatform implementation: [org.hibernate.engine.transaction.jta.platform.internal.NoJtaPlatform]
2021-12-31 01:07:30.384  INFO 15 --- [           main] j.LocalContainerEntityManagerFactoryBean : Initialized JPA EntityManagerFactory for persistence unit 'default'
2021-12-31 01:07:31.546  INFO 15 --- [           main] e.a.a.abac.server.pap.PapProperties      : ABAC Policies directory: ./config/../policies
2021-12-31 01:07:31.552  INFO 15 --- [           main] e.a.a.abac.server.pap.PapProperties      : ABE Policies directory: ./config/../policies
2021-12-31 01:07:34.599  INFO 15 --- [           main] e.a.a.abac.server.pdp.DirectoryWatcher   : Policy dir. watcher initialized
2021-12-31 01:07:34.603  INFO 15 --- [           main] e.a.a.a.s.pdp.AuthorizationServicePDP    : Initializing PDP...
2021-12-31 01:07:34.606  INFO 15 --- [           main] e.a.a.a.s.pdp.AuthorizationServicePDP    : Getting policy files from: ./config/../policies
2021-12-31 01:07:34.632  INFO 15 --- [           main] e.a.a.a.s.pdp.AuthorizationServicePDP    : Policy files found: 3
2021-12-31 01:07:36.059  INFO 15 --- [           main] org.wso2.balana.ConfigurationStore       : Loading runtime configuration
2021-12-31 01:07:36.646  INFO 15 --- [           main] e.a.a.a.s.pdp.AuthorizationServicePDP    : Configured attribute finder module classes: [eu.asclepios.authorization.abac.server.pdp.finder.LoggingAttributeFinderModule, eu.asclepios.authorization.abac.server.pdp.finder.WeekdayAttributeFinderModule, eu.asclepios.authorization.abac.server.pdp.finder.IpAddressAttributeFinderModule, eu.asclepios.authorization.abac.server.pdp.finder.DeviceAttributeFinderModule, eu.asclepios.authorization.abac.server.pdp.finder.GeolocationAttributeFinderModule, eu.asclepios.authorization.abac.server.pdp.finder.KeycloackAttributeFinderModule, eu.asclepios.authorization.abac.server.pdp.finder.NoopAttributeFinderModule, eu.asclepios.example.contexthandlers.CustomDbAttributeFinder, eu.asclepios.example.contexthandlers.CustomRestAttributeFinder]
2021-12-31 01:07:36.663  INFO 15 --- [           main] e.a.a.a.s.pdp.AuthorizationServicePDP    :   Instantiating attribute finder module: eu.asclepios.authorization.abac.server.pdp.finder.LoggingAttributeFinderModule@bff34c6
2021-12-31 01:07:36.672  INFO 15 --- [           main] e.a.a.a.s.pdp.AuthorizationServicePDP    :   Instantiating attribute finder module: eu.asclepios.authorization.abac.server.pdp.finder.WeekdayAttributeFinderModule@1522d8a0
2021-12-31 01:07:36.680  INFO 15 --- [           main] e.a.a.a.s.pdp.AuthorizationServicePDP    :   Instantiating attribute finder module: eu.asclepios.authorization.abac.server.pdp.finder.IpAddressAttributeFinderModule@312ab28e
2021-12-31 01:07:36.687  INFO 15 --- [           main] e.a.a.a.s.pdp.AuthorizationServicePDP    :   Instantiating attribute finder module: eu.asclepios.authorization.abac.server.pdp.finder.DeviceAttributeFinderModule@5644dc81
2021-12-31 01:07:36.771  INFO 15 --- [           main] e.a.a.a.s.pdp.AuthorizationServicePDP    :   Instantiating attribute finder module: eu.asclepios.authorization.abac.server.pdp.finder.GeolocationAttributeFinderModule@246f8b8b
2021-12-31 01:07:36.776  INFO 15 --- [           main] e.a.a.a.s.pdp.AuthorizationServicePDP    :   Instantiating attribute finder module: eu.asclepios.authorization.abac.server.pdp.finder.KeycloackAttributeFinderModule@278bb07e
2021-12-31 01:07:36.779  INFO 15 --- [           main] e.a.a.a.s.pdp.AuthorizationServicePDP    :   Instantiating attribute finder module: eu.asclepios.authorization.abac.server.pdp.finder.NoopAttributeFinderModule@4351c8c3
2021-12-31 01:07:36.789  INFO 15 --- [           main] e.a.e.c.CustomDbAttributeFinder          : CustomDbAttributeFinder: DB settings: url=jdbc:mysql://mysql:3306/keycloak, driver=com.mysql.jdbc.Driver, username=keycloak
2021-12-31 01:07:36.822  INFO 15 --- [           main] e.a.e.c.CustomDbAttributeFinder          : CustomDbAttributeFinder: Processing entry: 12345:600000:ambulance-crew-id-1234
2021-12-31 01:07:36.827  INFO 15 --- [           main] e.a.e.c.CustomDbAttributeFinder          : CustomDbAttributeFinder: Processing entry:  23456:600000:ambulance-crew-id-2345
2021-12-31 01:07:36.833  INFO 15 --- [           main] e.a.e.c.CustomDbAttributeFinder          : CustomDbAttributeFinder: Processing entry:  34567:600000:ambulance-crew-id-3456
2021-12-31 01:07:36.838  INFO 15 --- [           main] e.a.e.c.CustomDbAttributeFinder          : CustomDbAttributeFinder: Added 3 entries in DB
2021-12-31 01:07:36.840  INFO 15 --- [           main] e.a.a.a.s.pdp.AuthorizationServicePDP    :   Instantiating attribute finder module: eu.asclepios.example.contexthandlers.CustomDbAttributeFinder@5c42d2b7
2021-12-31 01:07:36.859  INFO 15 --- [           main] e.a.e.c.CustomRestAttributeFinder        : CustomRestAttributeFinder: REST URL template: http://django-rest:8000/attribute-provider/getinfov2?ES-ID={{es-id}}&format=json&patient-ID={{patient-id}}&user-ID={{user-id}}
2021-12-31 01:07:37.090  INFO 15 --- [           main] e.a.a.a.s.pdp.AuthorizationServicePDP    :   Instantiating attribute finder module: eu.asclepios.example.contexthandlers.CustomRestAttributeFinder@fd8294b
2021-12-31 01:07:37.277  INFO 15 --- [           main] e.a.a.a.s.pdp.AuthorizationServicePDP    : PDP initialized
2021-12-31 01:07:37.290  INFO 15 --- [           main] e.a.a.abac.server.PdpServerController    : Authorization Service configuration: AuthorizationServiceProperties(pdp=AuthorizationServiceProperties.PdpConfig(enable=true, balanaConfigFile=./config/balana.cfg.xml, policiesDir=./config/../policies, policiesExtension=.xml, restartPollingInterval=1000, accessKey=7235687126587231675321756752657236156321765723, attributeFinderClasses=[eu.asclepios.authorization.abac.server.pdp.finder.LoggingAttributeFinderModule, eu.asclepios.authorization.abac.server.pdp.finder.WeekdayAttributeFinderModule, eu.asclepios.authorization.abac.server.pdp.finder.IpAddressAttributeFinderModule, eu.asclepios.authorization.abac.server.pdp.finder.DeviceAttributeFinderModule, eu.asclepios.authorization.abac.server.pdp.finder.GeolocationAttributeFinderModule, eu.asclepios.authorization.abac.server.pdp.finder.KeycloackAttributeFinderModule, eu.asclepios.authorization.abac.server.pdp.finder.NoopAttributeFinderModule, eu.asclepios.example.contexthandlers.CustomDbAttributeFinder, eu.asclepios.example.contexthandlers.CustomRestAttributeFinder]), context=null, pip=[], requestContext=null)
2021-12-31 01:07:37.299  INFO 15 --- [           main] e.a.a.abac.server.PdpServerController    : Server-side request context extraction: false
2021-12-31 01:07:37.562  WARN 15 --- [           main] JpaBaseConfiguration$JpaWebConfiguration : spring.jpa.open-in-view is enabled by default. Therefore, database queries may be performed during view rendering. Explicitly configure spring.jpa.open-in-view to disable this warning
2021-12-31 01:07:38.519  INFO 15 --- [           main] e.a.a.abac.server.util.WebMvcConfig      : Using API Key authentication in PDP
2021-12-31 01:07:38.531  INFO 15 --- [           main] e.a.a.abac.server.util.WebMvcConfig      : Using API Key authentication in PAP
2021-12-31 01:07:41.386  INFO 15 --- [           main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port(s): 7071 (https) with context path ''
2021-12-31 01:07:41.454  INFO 15 --- [           main] .a.a.a.s.AuthorizationServiceApplication : Started AuthorizationServiceApplication in 40.973 seconds (JVM running for 47.706)
2021-12-31 01:08:43.432  INFO 15 --- [nio-7071-exec-6] o.a.c.c.C.[Tomcat].[localhost].[/]       : Initializing Spring DispatcherServlet 'dispatcherServlet'
2021-12-31 01:08:43.442  INFO 15 --- [nio-7071-exec-6] o.s.web.servlet.DispatcherServlet        : Initializing Servlet 'dispatcherServlet'
2021-12-31 01:08:43.464  INFO 15 --- [nio-7071-exec-6] o.s.web.servlet.DispatcherServlet        : Completed initialization in 19 ms
2021-12-31 01:08:43.798  INFO 15 --- [nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=16cbcfcd-757d-4290-a189-8281a585b925, content=null, timestamp=1640912922547, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=63702, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=dead5c752148, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=192.168.32.1, kc-session-state=58417beb-4cf4-40bd-a62c-cdd9145eb25d, http-req-server-port=80, http-header-accept=*/*, kc-id=f6381a5b-d232-4096-b3ab-1852d0293466, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1640912922474, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYc5ZRHNxAH4AEQAAAABhzlgYdAAkZjYzODFhNWItZDIzMi00MDk2LWIzYWItMTg1MmQwMjkzNDY2dAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkNTg0MTdiZWItNGNmNC00MGJkLWE2MmMtY2RkOTE0NWViMjVkcHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJQTENwRjRENXdVWC0wX19KWTU3REJaSEJsVFpxZU84bHdDTE9tVld0X293In0.eyJleHAiOjE2NDA5MTMyMjAsImlhdCI6MTY0MDkxMjkyMCwianRpIjoiZjYzODFhNWItZDIzMi00MDk2LWIzYWItMTg1MmQwMjkzNDY2IiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiNTg0MTdiZWItNGNmNC00MGJkLWE2MmMtY2RkOTE0NWViMjVkIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.e88ueWurbHlHqTi2XkB_K5O6bOtVZNVkN0SdtHMbZ56j1VGeINwyCEd-MKx0el10WDWLF3XiE4FnDtJoYGnU6c3CwBnfeIr5Oy2ndND2JQuOWWLxe-xvIzC3uGP-t0b7fP6o8UQfHoRJ-Nxo3PTcT_FF8MyhHubOIv42kbmdB4Ym3Buf7MxGEIDFv8ZeFabw2CXaaGjIeGT5qTyjgR3L385yVaHwW-UqbkZOEd8l_osIiCzt2RZDoscRD6pmUwnJP0tz45eGBP93ubui6kOKFpT1VtZmNlAM9UOsu-3TJTHMz7CLsqXYFHSCVZsL1g319eVeWCsZydrV7yeHEZS2qw, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1640913220, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.32.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=192.168.32.1, http-session-id=1226B99405C8AB7C8682FFE476B63B6B, http-session-last-accessed-time=1640912922474, kc-category-name=ACCESS, kc-iat=1640912920, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=192.168.32.1:63702 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2021-12-31 01:08:43.809  INFO 15 --- [nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Request context extracted
2021-12-31 01:08:43.832  INFO 15 --- [nio-7071-exec-6] e.a.a.abac.server.util.AttributeUtil     : XACML Attribute Categories:
{urn:oasis:names:tc:xacml:1.0:environment:current-date=urn:oasis:names:tc:xacml:3.0:attribute-category:environment, urn:oasis:names:tc:xacml:1.0:environment:current-dateTime=urn:oasis:names:tc:xacml:3.0:attribute-category:environment, actionId=urn:oasis:names:tc:xacml:3.0:attribute-category:action, user.identifier=urn:oasis:names:tc:xacml:1.0:subject-category:access-subject, urn:oasis:names:tc:xacml:1.0:environment:current-time=urn:oasis:names:tc:xacml:3.0:attribute-category:environment, request-id=urn:oasis:names:tc:xacml:3.0:attribute-category:environment, resource-id=urn:oasis:names:tc:xacml:3.0:attribute-category:resource}
2021-12-31 01:08:43.835  INFO 15 --- [nio-7071-exec-6] e.a.a.abac.server.util.AttributeUtil     : XACML Attribute Data Types:
{urn:oasis:names:tc:xacml:1.0:environment:current-date=http://www.w3.org/2001/XMLSchema#date, urn:oasis:names:tc:xacml:1.0:environment:current-dateTime=http://www.w3.org/2001/XMLSchema#dateTime, actionId=http://www.w3.org/2001/XMLSchema#string, user.identifier=http://www.w3.org/2001/XMLSchema#string, urn:oasis:names:tc:xacml:1.0:environment:current-time=http://www.w3.org/2001/XMLSchema#time, request-id=http://www.w3.org/2001/XMLSchema#string, resource-id=http://www.w3.org/2001/XMLSchema#string}
2021-12-31 01:08:43.903  INFO 15 --- [nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@57061d6
2021-12-31 01:08:43.919  INFO 15 --- [nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@57061d6
2021-12-31 01:08:44.528  INFO 15 --- [nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@57061d6
2021-12-31 01:08:44.541  INFO 15 --- [nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@57061d6
2021-12-31 01:08:44.574  INFO 15 --- [nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@57061d6
2021-12-31 01:08:44.577  WARN 15 --- [nio-7071-exec-6] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2021-12-31 01:08:44.582  WARN 15 --- [nio-7071-exec-6] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2021-12-31 01:08:44.591  INFO 15 --- [nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@57061d6
2021-12-31 01:08:44.605  INFO 15 --- [nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@57061d6
2021-12-31 01:08:44.609  WARN 15 --- [nio-7071-exec-6] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2021-12-31 01:08:44.612  WARN 15 --- [nio-7071-exec-6] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2021-12-31 01:08:44.618  INFO 15 --- [nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@57061d6
2021-12-31 01:08:44.662  INFO 15 --- [nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@57061d6
2021-12-31 01:08:44.714  INFO 15 --- [nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@57061d6
2021-12-31 01:08:44.748  INFO 15 --- [nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@57061d6
2021-12-31 01:08:44.760  INFO 15 --- [nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@57061d6
2021-12-31 01:08:44.811  INFO 15 --- [nio-7071-exec-6] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-3716663797235-99234, decision=PERMIT, pdp-result=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=PERMIT}})
2021-12-31 01:08:44.824  INFO 15 --- [nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=16cbcfcd-757d-4290-a189-8281a585b925, content=PERMIT, timestamp=1640912924824, pdpResult=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=PERMIT}}))
2021-12-31 01:08:44.843  INFO 15 --- [nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=1008ms, Total=1115ms
2021-12-31 01:08:45.338  INFO 15 --- [nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=6c58b80f-f02f-404c-8b12-62b0f41450a8, content=null, timestamp=1640912925272, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=63714, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=dead5c752148, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=192.168.32.1, kc-session-state=58417beb-4cf4-40bd-a62c-cdd9145eb25d, http-req-server-port=80, http-header-accept=*/*, kc-id=f6381a5b-d232-4096-b3ab-1852d0293466, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1640912925264, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYc5ZRHNxAH4AEQAAAABhzlgYdAAkZjYzODFhNWItZDIzMi00MDk2LWIzYWItMTg1MmQwMjkzNDY2dAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkNTg0MTdiZWItNGNmNC00MGJkLWE2MmMtY2RkOTE0NWViMjVkcHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJQTENwRjRENXdVWC0wX19KWTU3REJaSEJsVFpxZU84bHdDTE9tVld0X293In0.eyJleHAiOjE2NDA5MTMyMjAsImlhdCI6MTY0MDkxMjkyMCwianRpIjoiZjYzODFhNWItZDIzMi00MDk2LWIzYWItMTg1MmQwMjkzNDY2IiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiNTg0MTdiZWItNGNmNC00MGJkLWE2MmMtY2RkOTE0NWViMjVkIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.e88ueWurbHlHqTi2XkB_K5O6bOtVZNVkN0SdtHMbZ56j1VGeINwyCEd-MKx0el10WDWLF3XiE4FnDtJoYGnU6c3CwBnfeIr5Oy2ndND2JQuOWWLxe-xvIzC3uGP-t0b7fP6o8UQfHoRJ-Nxo3PTcT_FF8MyhHubOIv42kbmdB4Ym3Buf7MxGEIDFv8ZeFabw2CXaaGjIeGT5qTyjgR3L385yVaHwW-UqbkZOEd8l_osIiCzt2RZDoscRD6pmUwnJP0tz45eGBP93ubui6kOKFpT1VtZmNlAM9UOsu-3TJTHMz7CLsqXYFHSCVZsL1g319eVeWCsZydrV7yeHEZS2qw, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1640913220, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.32.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=192.168.32.1, http-session-id=D9AFA7A8453B87653C27BFA0A2E8B64E, http-session-last-accessed-time=1640912925264, kc-category-name=ACCESS, kc-iat=1640912920, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=192.168.32.1:63714 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2021-12-31 01:08:45.345  INFO 15 --- [nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Request context extracted
2021-12-31 01:08:45.356  INFO 15 --- [nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7cd4e0e8
2021-12-31 01:08:45.376  INFO 15 --- [nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7cd4e0e8
2021-12-31 01:08:45.493  INFO 15 --- [nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7cd4e0e8
2021-12-31 01:08:45.497  INFO 15 --- [nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7cd4e0e8
2021-12-31 01:08:45.537  INFO 15 --- [nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7cd4e0e8
2021-12-31 01:08:45.540  WARN 15 --- [nio-7071-exec-7] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2021-12-31 01:08:45.544  WARN 15 --- [nio-7071-exec-7] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2021-12-31 01:08:45.547  INFO 15 --- [nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7cd4e0e8
2021-12-31 01:08:45.551  INFO 15 --- [nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7cd4e0e8
2021-12-31 01:08:45.557  WARN 15 --- [nio-7071-exec-7] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2021-12-31 01:08:45.560  WARN 15 --- [nio-7071-exec-7] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2021-12-31 01:08:45.563  INFO 15 --- [nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7cd4e0e8
2021-12-31 01:08:45.641  INFO 15 --- [nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7cd4e0e8
2021-12-31 01:08:45.646  INFO 15 --- [nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7cd4e0e8
2021-12-31 01:08:45.694  INFO 15 --- [nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7cd4e0e8
2021-12-31 01:08:45.704  INFO 15 --- [nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@7cd4e0e8
2021-12-31 01:08:45.746  INFO 15 --- [nio-7071-exec-7] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-3718196583756-929073, decision=PERMIT, pdp-result=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=PERMIT}})
2021-12-31 01:08:45.753  INFO 15 --- [nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=6c58b80f-f02f-404c-8b12-62b0f41450a8, content=PERMIT, timestamp=1640912925753, pdpResult=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=PERMIT}}))
2021-12-31 01:08:45.759  INFO 15 --- [nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=406ms, Total=441ms
2021-12-31 01:08:45.970  INFO 15 --- [nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=b97ba9b9-9437-43a2-bba8-373c8ed55698, content=null, timestamp=1640912925894, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=63716, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=dead5c752148, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=192.168.32.1, kc-session-state=58417beb-4cf4-40bd-a62c-cdd9145eb25d, http-req-server-port=80, http-header-accept=*/*, kc-id=f6381a5b-d232-4096-b3ab-1852d0293466, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1640912925881, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYc5ZRHNxAH4AEQAAAABhzlgYdAAkZjYzODFhNWItZDIzMi00MDk2LWIzYWItMTg1MmQwMjkzNDY2dAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkNTg0MTdiZWItNGNmNC00MGJkLWE2MmMtY2RkOTE0NWViMjVkcHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJQTENwRjRENXdVWC0wX19KWTU3REJaSEJsVFpxZU84bHdDTE9tVld0X293In0.eyJleHAiOjE2NDA5MTMyMjAsImlhdCI6MTY0MDkxMjkyMCwianRpIjoiZjYzODFhNWItZDIzMi00MDk2LWIzYWItMTg1MmQwMjkzNDY2IiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiNTg0MTdiZWItNGNmNC00MGJkLWE2MmMtY2RkOTE0NWViMjVkIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.e88ueWurbHlHqTi2XkB_K5O6bOtVZNVkN0SdtHMbZ56j1VGeINwyCEd-MKx0el10WDWLF3XiE4FnDtJoYGnU6c3CwBnfeIr5Oy2ndND2JQuOWWLxe-xvIzC3uGP-t0b7fP6o8UQfHoRJ-Nxo3PTcT_FF8MyhHubOIv42kbmdB4Ym3Buf7MxGEIDFv8ZeFabw2CXaaGjIeGT5qTyjgR3L385yVaHwW-UqbkZOEd8l_osIiCzt2RZDoscRD6pmUwnJP0tz45eGBP93ubui6kOKFpT1VtZmNlAM9UOsu-3TJTHMz7CLsqXYFHSCVZsL1g319eVeWCsZydrV7yeHEZS2qw, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1640913220, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.32.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=192.168.32.1, http-session-id=E39A41936F42B359B34704A97B4DD086, http-session-last-accessed-time=1640912925881, kc-category-name=ACCESS, kc-iat=1640912920, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=192.168.32.1:63716 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2021-12-31 01:08:45.975  INFO 15 --- [nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Request context extracted
2021-12-31 01:08:45.983  INFO 15 --- [nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@9686550
2021-12-31 01:08:45.986  INFO 15 --- [nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@9686550
2021-12-31 01:08:46.018  INFO 15 --- [nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@9686550
2021-12-31 01:08:46.021  INFO 15 --- [nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@9686550
2021-12-31 01:08:46.092  INFO 15 --- [nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@9686550
2021-12-31 01:08:46.099  WARN 15 --- [nio-7071-exec-8] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2021-12-31 01:08:46.103  WARN 15 --- [nio-7071-exec-8] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2021-12-31 01:08:46.107  INFO 15 --- [nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@9686550
2021-12-31 01:08:46.109  INFO 15 --- [nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@9686550
2021-12-31 01:08:46.112  WARN 15 --- [nio-7071-exec-8] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2021-12-31 01:08:46.116  WARN 15 --- [nio-7071-exec-8] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2021-12-31 01:08:46.120  INFO 15 --- [nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@9686550
2021-12-31 01:08:46.140  INFO 15 --- [nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@9686550
2021-12-31 01:08:46.144  INFO 15 --- [nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@9686550
2021-12-31 01:08:46.177  INFO 15 --- [nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@9686550
2021-12-31 01:08:46.179  INFO 15 --- [nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@9686550
2021-12-31 01:08:46.244  INFO 15 --- [nio-7071-exec-8] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-3718826340287-591585, decision=PERMIT, pdp-result=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=PERMIT}})
2021-12-31 01:08:46.247  INFO 15 --- [nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=b97ba9b9-9437-43a2-bba8-373c8ed55698, content=PERMIT, timestamp=1640912926247, pdpResult=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=PERMIT}}))
2021-12-31 01:08:46.252  INFO 15 --- [nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=270ms, Total=287ms
2021-12-31 01:08:46.413  INFO 15 --- [nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=4fc9139b-82c4-426a-b0d0-2fe9a36d1a94, content=null, timestamp=1640912926363, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=63718, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=dead5c752148, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=192.168.32.1, kc-session-state=58417beb-4cf4-40bd-a62c-cdd9145eb25d, http-req-server-port=80, http-header-accept=*/*, kc-id=f6381a5b-d232-4096-b3ab-1852d0293466, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1640912926358, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYc5ZRHNxAH4AEQAAAABhzlgYdAAkZjYzODFhNWItZDIzMi00MDk2LWIzYWItMTg1MmQwMjkzNDY2dAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkNTg0MTdiZWItNGNmNC00MGJkLWE2MmMtY2RkOTE0NWViMjVkcHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJQTENwRjRENXdVWC0wX19KWTU3REJaSEJsVFpxZU84bHdDTE9tVld0X293In0.eyJleHAiOjE2NDA5MTMyMjAsImlhdCI6MTY0MDkxMjkyMCwianRpIjoiZjYzODFhNWItZDIzMi00MDk2LWIzYWItMTg1MmQwMjkzNDY2IiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiNTg0MTdiZWItNGNmNC00MGJkLWE2MmMtY2RkOTE0NWViMjVkIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.e88ueWurbHlHqTi2XkB_K5O6bOtVZNVkN0SdtHMbZ56j1VGeINwyCEd-MKx0el10WDWLF3XiE4FnDtJoYGnU6c3CwBnfeIr5Oy2ndND2JQuOWWLxe-xvIzC3uGP-t0b7fP6o8UQfHoRJ-Nxo3PTcT_FF8MyhHubOIv42kbmdB4Ym3Buf7MxGEIDFv8ZeFabw2CXaaGjIeGT5qTyjgR3L385yVaHwW-UqbkZOEd8l_osIiCzt2RZDoscRD6pmUwnJP0tz45eGBP93ubui6kOKFpT1VtZmNlAM9UOsu-3TJTHMz7CLsqXYFHSCVZsL1g319eVeWCsZydrV7yeHEZS2qw, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1640913220, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.32.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=192.168.32.1, http-session-id=0E688E62C7BA794F8FB00E2D111F8C4A, http-session-last-accessed-time=1640912926358, kc-category-name=ACCESS, kc-iat=1640912920, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=192.168.32.1:63718 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2021-12-31 01:08:46.424  INFO 15 --- [nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Request context extracted
2021-12-31 01:08:46.435  INFO 15 --- [nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1c95d8d9
2021-12-31 01:08:46.438  INFO 15 --- [nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1c95d8d9
2021-12-31 01:08:46.471  INFO 15 --- [nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1c95d8d9
2021-12-31 01:08:46.475  INFO 15 --- [nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1c95d8d9
2021-12-31 01:08:46.496  INFO 15 --- [nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1c95d8d9
2021-12-31 01:08:46.500  WARN 15 --- [nio-7071-exec-9] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2021-12-31 01:08:46.503  WARN 15 --- [nio-7071-exec-9] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2021-12-31 01:08:46.510  INFO 15 --- [nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1c95d8d9
2021-12-31 01:08:46.516  INFO 15 --- [nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1c95d8d9
2021-12-31 01:08:46.520  WARN 15 --- [nio-7071-exec-9] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2021-12-31 01:08:46.523  WARN 15 --- [nio-7071-exec-9] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2021-12-31 01:08:46.527  INFO 15 --- [nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1c95d8d9
2021-12-31 01:08:46.557  INFO 15 --- [nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1c95d8d9
2021-12-31 01:08:46.562  INFO 15 --- [nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1c95d8d9
2021-12-31 01:08:46.595  INFO 15 --- [nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1c95d8d9
2021-12-31 01:08:46.598  INFO 15 --- [nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1c95d8d9
2021-12-31 01:08:46.668  INFO 15 --- [nio-7071-exec-9] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-3719276233222-446515, decision=PERMIT, pdp-result=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=PERMIT}})
2021-12-31 01:08:46.670  INFO 15 --- [nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=4fc9139b-82c4-426a-b0d0-2fe9a36d1a94, content=PERMIT, timestamp=1640912926670, pdpResult=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=PERMIT}}))
2021-12-31 01:08:46.675  INFO 15 --- [nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=244ms, Total=271ms
2021-12-31 01:08:46.822  INFO 15 --- [io-7071-exec-10] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=19cc0944-7922-4c7f-91f9-0626625a4ca9, content=null, timestamp=1640912926762, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=63720, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=dead5c752148, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=192.168.32.1, kc-session-state=58417beb-4cf4-40bd-a62c-cdd9145eb25d, http-req-server-port=80, http-header-accept=*/*, kc-id=f6381a5b-d232-4096-b3ab-1852d0293466, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1640912926744, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYc5ZRHNxAH4AEQAAAABhzlgYdAAkZjYzODFhNWItZDIzMi00MDk2LWIzYWItMTg1MmQwMjkzNDY2dAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkNTg0MTdiZWItNGNmNC00MGJkLWE2MmMtY2RkOTE0NWViMjVkcHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJQTENwRjRENXdVWC0wX19KWTU3REJaSEJsVFpxZU84bHdDTE9tVld0X293In0.eyJleHAiOjE2NDA5MTMyMjAsImlhdCI6MTY0MDkxMjkyMCwianRpIjoiZjYzODFhNWItZDIzMi00MDk2LWIzYWItMTg1MmQwMjkzNDY2IiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiNTg0MTdiZWItNGNmNC00MGJkLWE2MmMtY2RkOTE0NWViMjVkIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.e88ueWurbHlHqTi2XkB_K5O6bOtVZNVkN0SdtHMbZ56j1VGeINwyCEd-MKx0el10WDWLF3XiE4FnDtJoYGnU6c3CwBnfeIr5Oy2ndND2JQuOWWLxe-xvIzC3uGP-t0b7fP6o8UQfHoRJ-Nxo3PTcT_FF8MyhHubOIv42kbmdB4Ym3Buf7MxGEIDFv8ZeFabw2CXaaGjIeGT5qTyjgR3L385yVaHwW-UqbkZOEd8l_osIiCzt2RZDoscRD6pmUwnJP0tz45eGBP93ubui6kOKFpT1VtZmNlAM9UOsu-3TJTHMz7CLsqXYFHSCVZsL1g319eVeWCsZydrV7yeHEZS2qw, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1640913220, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.32.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=192.168.32.1, http-session-id=DC501803527611F067BDC93DBBCDEBBF, http-session-last-accessed-time=1640912926744, kc-category-name=ACCESS, kc-iat=1640912920, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=192.168.32.1:63720 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2021-12-31 01:08:46.830  INFO 15 --- [io-7071-exec-10] e.a.a.abac.server.PdpServerController    : Request context extracted
2021-12-31 01:08:46.840  INFO 15 --- [io-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4135e4dc
2021-12-31 01:08:46.850  INFO 15 --- [io-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4135e4dc
2021-12-31 01:08:46.887  INFO 15 --- [io-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4135e4dc
2021-12-31 01:08:46.893  INFO 15 --- [io-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4135e4dc
2021-12-31 01:08:46.915  INFO 15 --- [io-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4135e4dc
2021-12-31 01:08:46.920  WARN 15 --- [io-7071-exec-10] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2021-12-31 01:08:46.927  WARN 15 --- [io-7071-exec-10] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2021-12-31 01:08:46.931  INFO 15 --- [io-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4135e4dc
2021-12-31 01:08:46.934  INFO 15 --- [io-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4135e4dc
2021-12-31 01:08:46.936  WARN 15 --- [io-7071-exec-10] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2021-12-31 01:08:46.939  WARN 15 --- [io-7071-exec-10] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2021-12-31 01:08:46.941  INFO 15 --- [io-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4135e4dc
2021-12-31 01:08:47.005  INFO 15 --- [io-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4135e4dc
2021-12-31 01:08:47.011  INFO 15 --- [io-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4135e4dc
2021-12-31 01:08:47.112  INFO 15 --- [io-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4135e4dc
2021-12-31 01:08:47.116  INFO 15 --- [io-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4135e4dc
2021-12-31 01:08:47.166  INFO 15 --- [io-7071-exec-10] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-3719682244604-594258, decision=PERMIT, pdp-result=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=PERMIT}})
2021-12-31 01:08:47.173  INFO 15 --- [io-7071-exec-10] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=19cc0944-7922-4c7f-91f9-0626625a4ca9, content=PERMIT, timestamp=1640912927173, pdpResult=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=PERMIT}}))
2021-12-31 01:08:47.177  INFO 15 --- [io-7071-exec-10] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=341ms, Total=370ms
2021-12-31 01:08:47.289  INFO 15 --- [nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=56e5055d-4730-4eb6-960b-2b664a494108, content=null, timestamp=1640912927256, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=63722, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=dead5c752148, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=192.168.32.1, kc-session-state=58417beb-4cf4-40bd-a62c-cdd9145eb25d, http-req-server-port=80, http-header-accept=*/*, kc-id=f6381a5b-d232-4096-b3ab-1852d0293466, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1640912927250, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYc5ZRHNxAH4AEQAAAABhzlgYdAAkZjYzODFhNWItZDIzMi00MDk2LWIzYWItMTg1MmQwMjkzNDY2dAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkNTg0MTdiZWItNGNmNC00MGJkLWE2MmMtY2RkOTE0NWViMjVkcHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJQTENwRjRENXdVWC0wX19KWTU3REJaSEJsVFpxZU84bHdDTE9tVld0X293In0.eyJleHAiOjE2NDA5MTMyMjAsImlhdCI6MTY0MDkxMjkyMCwianRpIjoiZjYzODFhNWItZDIzMi00MDk2LWIzYWItMTg1MmQwMjkzNDY2IiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiNTg0MTdiZWItNGNmNC00MGJkLWE2MmMtY2RkOTE0NWViMjVkIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.e88ueWurbHlHqTi2XkB_K5O6bOtVZNVkN0SdtHMbZ56j1VGeINwyCEd-MKx0el10WDWLF3XiE4FnDtJoYGnU6c3CwBnfeIr5Oy2ndND2JQuOWWLxe-xvIzC3uGP-t0b7fP6o8UQfHoRJ-Nxo3PTcT_FF8MyhHubOIv42kbmdB4Ym3Buf7MxGEIDFv8ZeFabw2CXaaGjIeGT5qTyjgR3L385yVaHwW-UqbkZOEd8l_osIiCzt2RZDoscRD6pmUwnJP0tz45eGBP93ubui6kOKFpT1VtZmNlAM9UOsu-3TJTHMz7CLsqXYFHSCVZsL1g319eVeWCsZydrV7yeHEZS2qw, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1640913220, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.32.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=192.168.32.1, http-session-id=F2F7323E2D988A80BD61EA47BCCE3182, http-session-last-accessed-time=1640912927250, kc-category-name=ACCESS, kc-iat=1640912920, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=192.168.32.1:63722 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2021-12-31 01:08:47.295  INFO 15 --- [nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Request context extracted
2021-12-31 01:08:47.302  INFO 15 --- [nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@47766eb5
2021-12-31 01:08:47.305  INFO 15 --- [nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@47766eb5
2021-12-31 01:08:47.343  INFO 15 --- [nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@47766eb5
2021-12-31 01:08:47.345  INFO 15 --- [nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@47766eb5
2021-12-31 01:08:47.375  INFO 15 --- [nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@47766eb5
2021-12-31 01:08:47.378  WARN 15 --- [nio-7071-exec-1] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2021-12-31 01:08:47.381  WARN 15 --- [nio-7071-exec-1] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2021-12-31 01:08:47.384  INFO 15 --- [nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@47766eb5
2021-12-31 01:08:47.387  INFO 15 --- [nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@47766eb5
2021-12-31 01:08:47.390  WARN 15 --- [nio-7071-exec-1] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2021-12-31 01:08:47.393  WARN 15 --- [nio-7071-exec-1] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2021-12-31 01:08:47.396  INFO 15 --- [nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@47766eb5
2021-12-31 01:08:47.481  INFO 15 --- [nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@47766eb5
2021-12-31 01:08:47.483  INFO 15 --- [nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@47766eb5
2021-12-31 01:08:47.509  INFO 15 --- [nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@47766eb5
2021-12-31 01:08:47.512  INFO 15 --- [nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@47766eb5
2021-12-31 01:08:47.540  INFO 15 --- [nio-7071-exec-1] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-3720149002482-207655, decision=PERMIT, pdp-result=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=PERMIT}})
2021-12-31 01:08:47.542  INFO 15 --- [nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=56e5055d-4730-4eb6-960b-2b664a494108, content=PERMIT, timestamp=1640912927542, pdpResult=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=PERMIT}}))
2021-12-31 01:08:47.549  INFO 15 --- [nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=243ms, Total=262ms
2021-12-31 01:08:47.637  INFO 15 --- [nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=46b9befe-be25-4b33-80e4-65e4dcbafa82, content=null, timestamp=1640912927611, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=63724, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=dead5c752148, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=192.168.32.1, kc-session-state=58417beb-4cf4-40bd-a62c-cdd9145eb25d, http-req-server-port=80, http-header-accept=*/*, kc-id=f6381a5b-d232-4096-b3ab-1852d0293466, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1640912927609, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYc5ZRHNxAH4AEQAAAABhzlgYdAAkZjYzODFhNWItZDIzMi00MDk2LWIzYWItMTg1MmQwMjkzNDY2dAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkNTg0MTdiZWItNGNmNC00MGJkLWE2MmMtY2RkOTE0NWViMjVkcHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJQTENwRjRENXdVWC0wX19KWTU3REJaSEJsVFpxZU84bHdDTE9tVld0X293In0.eyJleHAiOjE2NDA5MTMyMjAsImlhdCI6MTY0MDkxMjkyMCwianRpIjoiZjYzODFhNWItZDIzMi00MDk2LWIzYWItMTg1MmQwMjkzNDY2IiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiNTg0MTdiZWItNGNmNC00MGJkLWE2MmMtY2RkOTE0NWViMjVkIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.e88ueWurbHlHqTi2XkB_K5O6bOtVZNVkN0SdtHMbZ56j1VGeINwyCEd-MKx0el10WDWLF3XiE4FnDtJoYGnU6c3CwBnfeIr5Oy2ndND2JQuOWWLxe-xvIzC3uGP-t0b7fP6o8UQfHoRJ-Nxo3PTcT_FF8MyhHubOIv42kbmdB4Ym3Buf7MxGEIDFv8ZeFabw2CXaaGjIeGT5qTyjgR3L385yVaHwW-UqbkZOEd8l_osIiCzt2RZDoscRD6pmUwnJP0tz45eGBP93ubui6kOKFpT1VtZmNlAM9UOsu-3TJTHMz7CLsqXYFHSCVZsL1g319eVeWCsZydrV7yeHEZS2qw, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1640913220, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.32.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=192.168.32.1, http-session-id=A9DB318B134B0793D02510D5C83AA428, http-session-last-accessed-time=1640912927609, kc-category-name=ACCESS, kc-iat=1640912920, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=192.168.32.1:63724 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2021-12-31 01:08:47.641  INFO 15 --- [nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Request context extracted
2021-12-31 01:08:47.657  INFO 15 --- [nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@71d75835
2021-12-31 01:08:47.672  INFO 15 --- [nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@71d75835
2021-12-31 01:08:47.715  INFO 15 --- [nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@71d75835
2021-12-31 01:08:47.718  INFO 15 --- [nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@71d75835
2021-12-31 01:08:47.792  INFO 15 --- [nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@71d75835
2021-12-31 01:08:47.794  WARN 15 --- [nio-7071-exec-2] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2021-12-31 01:08:47.797  WARN 15 --- [nio-7071-exec-2] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2021-12-31 01:08:47.802  INFO 15 --- [nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@71d75835
2021-12-31 01:08:47.808  INFO 15 --- [nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@71d75835
2021-12-31 01:08:47.814  WARN 15 --- [nio-7071-exec-2] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2021-12-31 01:08:47.818  WARN 15 --- [nio-7071-exec-2] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2021-12-31 01:08:47.820  INFO 15 --- [nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@71d75835
2021-12-31 01:08:47.862  INFO 15 --- [nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@71d75835
2021-12-31 01:08:47.865  INFO 15 --- [nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@71d75835
2021-12-31 01:08:47.895  INFO 15 --- [nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@71d75835
2021-12-31 01:08:47.900  INFO 15 --- [nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@71d75835
2021-12-31 01:08:47.972  INFO 15 --- [nio-7071-exec-2] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-3720494902526-478658, decision=PERMIT, pdp-result=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=PERMIT}})
2021-12-31 01:08:47.974  INFO 15 --- [nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=46b9befe-be25-4b33-80e4-65e4dcbafa82, content=PERMIT, timestamp=1640912927974, pdpResult=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=PERMIT}}))
2021-12-31 01:08:47.978  INFO 15 --- [nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=329ms, Total=354ms
2021-12-31 01:08:48.054  INFO 15 --- [nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=6865b4cb-7ac5-49d2-a61c-cb6795beb1e5, content=null, timestamp=1640912928038, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=63726, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=dead5c752148, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=192.168.32.1, kc-session-state=58417beb-4cf4-40bd-a62c-cdd9145eb25d, http-req-server-port=80, http-header-accept=*/*, kc-id=f6381a5b-d232-4096-b3ab-1852d0293466, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1640912928030, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYc5ZRHNxAH4AEQAAAABhzlgYdAAkZjYzODFhNWItZDIzMi00MDk2LWIzYWItMTg1MmQwMjkzNDY2dAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkNTg0MTdiZWItNGNmNC00MGJkLWE2MmMtY2RkOTE0NWViMjVkcHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJQTENwRjRENXdVWC0wX19KWTU3REJaSEJsVFpxZU84bHdDTE9tVld0X293In0.eyJleHAiOjE2NDA5MTMyMjAsImlhdCI6MTY0MDkxMjkyMCwianRpIjoiZjYzODFhNWItZDIzMi00MDk2LWIzYWItMTg1MmQwMjkzNDY2IiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiNTg0MTdiZWItNGNmNC00MGJkLWE2MmMtY2RkOTE0NWViMjVkIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.e88ueWurbHlHqTi2XkB_K5O6bOtVZNVkN0SdtHMbZ56j1VGeINwyCEd-MKx0el10WDWLF3XiE4FnDtJoYGnU6c3CwBnfeIr5Oy2ndND2JQuOWWLxe-xvIzC3uGP-t0b7fP6o8UQfHoRJ-Nxo3PTcT_FF8MyhHubOIv42kbmdB4Ym3Buf7MxGEIDFv8ZeFabw2CXaaGjIeGT5qTyjgR3L385yVaHwW-UqbkZOEd8l_osIiCzt2RZDoscRD6pmUwnJP0tz45eGBP93ubui6kOKFpT1VtZmNlAM9UOsu-3TJTHMz7CLsqXYFHSCVZsL1g319eVeWCsZydrV7yeHEZS2qw, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1640913220, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.32.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=192.168.32.1, http-session-id=78A472C6D990F30820D6FB95B7565872, http-session-last-accessed-time=1640912928030, kc-category-name=ACCESS, kc-iat=1640912920, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=192.168.32.1:63726 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2021-12-31 01:08:48.059  INFO 15 --- [nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Request context extracted
2021-12-31 01:08:48.071  INFO 15 --- [nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1e716d12
2021-12-31 01:08:48.075  INFO 15 --- [nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1e716d12
2021-12-31 01:08:48.128  INFO 15 --- [nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1e716d12
2021-12-31 01:08:48.130  INFO 15 --- [nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1e716d12
2021-12-31 01:08:48.202  INFO 15 --- [nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1e716d12
2021-12-31 01:08:48.206  WARN 15 --- [nio-7071-exec-3] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2021-12-31 01:08:48.209  WARN 15 --- [nio-7071-exec-3] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2021-12-31 01:08:48.214  INFO 15 --- [nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1e716d12
2021-12-31 01:08:48.216  INFO 15 --- [nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1e716d12
2021-12-31 01:08:48.218  WARN 15 --- [nio-7071-exec-3] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2021-12-31 01:08:48.220  WARN 15 --- [nio-7071-exec-3] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2021-12-31 01:08:48.223  INFO 15 --- [nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1e716d12
2021-12-31 01:08:48.278  INFO 15 --- [nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1e716d12
2021-12-31 01:08:48.281  INFO 15 --- [nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1e716d12
2021-12-31 01:08:48.387  INFO 15 --- [nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1e716d12
2021-12-31 01:08:48.390  INFO 15 --- [nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1e716d12
2021-12-31 01:08:48.428  INFO 15 --- [nio-7071-exec-3] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-3720910921960-764891, decision=PERMIT, pdp-result=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=PERMIT}})
2021-12-31 01:08:48.432  INFO 15 --- [nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=6865b4cb-7ac5-49d2-a61c-cb6795beb1e5, content=PERMIT, timestamp=1640912928432, pdpResult=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=PERMIT}}))
2021-12-31 01:08:48.441  INFO 15 --- [nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=371ms, Total=389ms
2021-12-31 01:08:48.512  INFO 15 --- [nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=39924e8f-8f84-4f8d-a558-f6e4be91a86f, content=null, timestamp=1640912928495, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=63728, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=dead5c752148, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=192.168.32.1, kc-session-state=58417beb-4cf4-40bd-a62c-cdd9145eb25d, http-req-server-port=80, http-header-accept=*/*, kc-id=f6381a5b-d232-4096-b3ab-1852d0293466, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1640912928493, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYc5ZRHNxAH4AEQAAAABhzlgYdAAkZjYzODFhNWItZDIzMi00MDk2LWIzYWItMTg1MmQwMjkzNDY2dAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkNTg0MTdiZWItNGNmNC00MGJkLWE2MmMtY2RkOTE0NWViMjVkcHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJQTENwRjRENXdVWC0wX19KWTU3REJaSEJsVFpxZU84bHdDTE9tVld0X293In0.eyJleHAiOjE2NDA5MTMyMjAsImlhdCI6MTY0MDkxMjkyMCwianRpIjoiZjYzODFhNWItZDIzMi00MDk2LWIzYWItMTg1MmQwMjkzNDY2IiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiNTg0MTdiZWItNGNmNC00MGJkLWE2MmMtY2RkOTE0NWViMjVkIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.e88ueWurbHlHqTi2XkB_K5O6bOtVZNVkN0SdtHMbZ56j1VGeINwyCEd-MKx0el10WDWLF3XiE4FnDtJoYGnU6c3CwBnfeIr5Oy2ndND2JQuOWWLxe-xvIzC3uGP-t0b7fP6o8UQfHoRJ-Nxo3PTcT_FF8MyhHubOIv42kbmdB4Ym3Buf7MxGEIDFv8ZeFabw2CXaaGjIeGT5qTyjgR3L385yVaHwW-UqbkZOEd8l_osIiCzt2RZDoscRD6pmUwnJP0tz45eGBP93ubui6kOKFpT1VtZmNlAM9UOsu-3TJTHMz7CLsqXYFHSCVZsL1g319eVeWCsZydrV7yeHEZS2qw, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1640913220, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.32.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=192.168.32.1, http-session-id=062DDB99C89499D446FD4F256FFBC1D9, http-session-last-accessed-time=1640912928493, kc-category-name=ACCESS, kc-iat=1640912920, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=192.168.32.1:63728 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2021-12-31 01:08:48.523  INFO 15 --- [nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Request context extracted
2021-12-31 01:08:48.527  INFO 15 --- [nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@231c3ca6
2021-12-31 01:08:48.547  INFO 15 --- [nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@231c3ca6
2021-12-31 01:08:48.595  INFO 15 --- [nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@231c3ca6
2021-12-31 01:08:48.598  INFO 15 --- [nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@231c3ca6
2021-12-31 01:08:48.623  INFO 15 --- [nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@231c3ca6
2021-12-31 01:08:48.627  WARN 15 --- [nio-7071-exec-4] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2021-12-31 01:08:48.639  WARN 15 --- [nio-7071-exec-4] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2021-12-31 01:08:48.642  INFO 15 --- [nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@231c3ca6
2021-12-31 01:08:48.646  INFO 15 --- [nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@231c3ca6
2021-12-31 01:08:48.648  WARN 15 --- [nio-7071-exec-4] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2021-12-31 01:08:48.650  WARN 15 --- [nio-7071-exec-4] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2021-12-31 01:08:48.653  INFO 15 --- [nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@231c3ca6
2021-12-31 01:08:48.721  INFO 15 --- [nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@231c3ca6
2021-12-31 01:08:48.725  INFO 15 --- [nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@231c3ca6
2021-12-31 01:08:48.759  INFO 15 --- [nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@231c3ca6
2021-12-31 01:08:48.763  INFO 15 --- [nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@231c3ca6
2021-12-31 01:08:48.788  INFO 15 --- [nio-7071-exec-4] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-3721375447348-409259, decision=PERMIT, pdp-result=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=PERMIT}})
2021-12-31 01:08:48.791  INFO 15 --- [nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=39924e8f-8f84-4f8d-a558-f6e4be91a86f, content=PERMIT, timestamp=1640912928791, pdpResult=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=PERMIT}}))
2021-12-31 01:08:48.794  INFO 15 --- [nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=265ms, Total=286ms
2021-12-31 01:08:48.873  INFO 15 --- [nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=a8579d2b-a9e0-4279-ae94-443e3f6d3f34, content=null, timestamp=1640912928848, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=63730, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=dead5c752148, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=192.168.32.1, kc-session-state=58417beb-4cf4-40bd-a62c-cdd9145eb25d, http-req-server-port=80, http-header-accept=*/*, kc-id=f6381a5b-d232-4096-b3ab-1852d0293466, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1640912928846, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYc5ZRHNxAH4AEQAAAABhzlgYdAAkZjYzODFhNWItZDIzMi00MDk2LWIzYWItMTg1MmQwMjkzNDY2dAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkNTg0MTdiZWItNGNmNC00MGJkLWE2MmMtY2RkOTE0NWViMjVkcHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJQTENwRjRENXdVWC0wX19KWTU3REJaSEJsVFpxZU84bHdDTE9tVld0X293In0.eyJleHAiOjE2NDA5MTMyMjAsImlhdCI6MTY0MDkxMjkyMCwianRpIjoiZjYzODFhNWItZDIzMi00MDk2LWIzYWItMTg1MmQwMjkzNDY2IiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiNTg0MTdiZWItNGNmNC00MGJkLWE2MmMtY2RkOTE0NWViMjVkIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.e88ueWurbHlHqTi2XkB_K5O6bOtVZNVkN0SdtHMbZ56j1VGeINwyCEd-MKx0el10WDWLF3XiE4FnDtJoYGnU6c3CwBnfeIr5Oy2ndND2JQuOWWLxe-xvIzC3uGP-t0b7fP6o8UQfHoRJ-Nxo3PTcT_FF8MyhHubOIv42kbmdB4Ym3Buf7MxGEIDFv8ZeFabw2CXaaGjIeGT5qTyjgR3L385yVaHwW-UqbkZOEd8l_osIiCzt2RZDoscRD6pmUwnJP0tz45eGBP93ubui6kOKFpT1VtZmNlAM9UOsu-3TJTHMz7CLsqXYFHSCVZsL1g319eVeWCsZydrV7yeHEZS2qw, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1640913220, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.32.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=192.168.32.1, http-session-id=5BF429C5CC21C91B5E0CF6F048317338, http-session-last-accessed-time=1640912928846, kc-category-name=ACCESS, kc-iat=1640912920, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=192.168.32.1:63730 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2021-12-31 01:08:48.878  INFO 15 --- [nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Request context extracted
2021-12-31 01:08:48.894  INFO 15 --- [nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@55c78228
2021-12-31 01:08:48.901  INFO 15 --- [nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@55c78228
2021-12-31 01:08:48.931  INFO 15 --- [nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@55c78228
2021-12-31 01:08:48.937  INFO 15 --- [nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@55c78228
2021-12-31 01:08:49.001  INFO 15 --- [nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@55c78228
2021-12-31 01:08:49.003  WARN 15 --- [nio-7071-exec-5] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2021-12-31 01:08:49.005  WARN 15 --- [nio-7071-exec-5] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2021-12-31 01:08:49.008  INFO 15 --- [nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@55c78228
2021-12-31 01:08:49.011  INFO 15 --- [nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@55c78228
2021-12-31 01:08:49.014  WARN 15 --- [nio-7071-exec-5] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2021-12-31 01:08:49.018  WARN 15 --- [nio-7071-exec-5] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2021-12-31 01:08:49.021  INFO 15 --- [nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@55c78228
2021-12-31 01:08:49.054  INFO 15 --- [nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@55c78228
2021-12-31 01:08:49.057  INFO 15 --- [nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@55c78228
2021-12-31 01:08:49.084  INFO 15 --- [nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@55c78228
2021-12-31 01:08:49.086  INFO 15 --- [nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@55c78228
2021-12-31 01:08:49.166  INFO 15 --- [nio-7071-exec-5] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-3721730259607-756363, decision=PERMIT, pdp-result=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=PERMIT}})
2021-12-31 01:08:49.170  INFO 15 --- [nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=a8579d2b-a9e0-4279-ae94-443e3f6d3f34, content=PERMIT, timestamp=1640912929170, pdpResult=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=PERMIT}}))
2021-12-31 01:08:49.178  INFO 15 --- [nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=290ms, Total=319ms
2021-12-31 01:08:49.256  INFO 15 --- [nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=5769c862-6776-492a-a006-66737b40eff5, content=null, timestamp=1640912929245, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=63732, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=dead5c752148, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=192.168.32.1, kc-session-state=58417beb-4cf4-40bd-a62c-cdd9145eb25d, http-req-server-port=80, http-header-accept=*/*, kc-id=f6381a5b-d232-4096-b3ab-1852d0293466, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1640912929236, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYc5ZRHNxAH4AEQAAAABhzlgYdAAkZjYzODFhNWItZDIzMi00MDk2LWIzYWItMTg1MmQwMjkzNDY2dAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkNTg0MTdiZWItNGNmNC00MGJkLWE2MmMtY2RkOTE0NWViMjVkcHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJQTENwRjRENXdVWC0wX19KWTU3REJaSEJsVFpxZU84bHdDTE9tVld0X293In0.eyJleHAiOjE2NDA5MTMyMjAsImlhdCI6MTY0MDkxMjkyMCwianRpIjoiZjYzODFhNWItZDIzMi00MDk2LWIzYWItMTg1MmQwMjkzNDY2IiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiNTg0MTdiZWItNGNmNC00MGJkLWE2MmMtY2RkOTE0NWViMjVkIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.e88ueWurbHlHqTi2XkB_K5O6bOtVZNVkN0SdtHMbZ56j1VGeINwyCEd-MKx0el10WDWLF3XiE4FnDtJoYGnU6c3CwBnfeIr5Oy2ndND2JQuOWWLxe-xvIzC3uGP-t0b7fP6o8UQfHoRJ-Nxo3PTcT_FF8MyhHubOIv42kbmdB4Ym3Buf7MxGEIDFv8ZeFabw2CXaaGjIeGT5qTyjgR3L385yVaHwW-UqbkZOEd8l_osIiCzt2RZDoscRD6pmUwnJP0tz45eGBP93ubui6kOKFpT1VtZmNlAM9UOsu-3TJTHMz7CLsqXYFHSCVZsL1g319eVeWCsZydrV7yeHEZS2qw, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1640913220, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.32.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=192.168.32.1, http-session-id=8783A003BE8BC50741F62FA0D8CE3BC9, http-session-last-accessed-time=1640912929236, kc-category-name=ACCESS, kc-iat=1640912920, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=192.168.32.1:63732 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2021-12-31 01:08:49.261  INFO 15 --- [nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Request context extracted
2021-12-31 01:08:49.270  INFO 15 --- [nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@15b6452d
2021-12-31 01:08:49.276  INFO 15 --- [nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@15b6452d
2021-12-31 01:08:49.325  INFO 15 --- [nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@15b6452d
2021-12-31 01:08:49.327  INFO 15 --- [nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@15b6452d
2021-12-31 01:08:49.353  INFO 15 --- [nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@15b6452d
2021-12-31 01:08:49.365  WARN 15 --- [nio-7071-exec-6] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2021-12-31 01:08:49.369  WARN 15 --- [nio-7071-exec-6] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2021-12-31 01:08:49.373  INFO 15 --- [nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@15b6452d
2021-12-31 01:08:49.378  INFO 15 --- [nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@15b6452d
2021-12-31 01:08:49.381  WARN 15 --- [nio-7071-exec-6] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2021-12-31 01:08:49.384  WARN 15 --- [nio-7071-exec-6] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2021-12-31 01:08:49.387  INFO 15 --- [nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@15b6452d
2021-12-31 01:08:49.418  INFO 15 --- [nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@15b6452d
2021-12-31 01:08:49.421  INFO 15 --- [nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@15b6452d
2021-12-31 01:08:49.513  INFO 15 --- [nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@15b6452d
2021-12-31 01:08:49.517  INFO 15 --- [nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@15b6452d
2021-12-31 01:08:49.553  INFO 15 --- [nio-7071-exec-6] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-3722113906213-802273, decision=PERMIT, pdp-result=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=PERMIT}})
2021-12-31 01:08:49.555  INFO 15 --- [nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=5769c862-6776-492a-a006-66737b40eff5, content=PERMIT, timestamp=1640912929555, pdpResult=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=PERMIT}}))
2021-12-31 01:08:49.558  INFO 15 --- [nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=291ms, Total=304ms
2021-12-31 01:08:49.702  INFO 15 --- [nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=714ed3c2-1e41-467e-8330-0d22cecb2ce7, content=null, timestamp=1640912929684, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=63734, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=dead5c752148, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=192.168.32.1, kc-session-state=58417beb-4cf4-40bd-a62c-cdd9145eb25d, http-req-server-port=80, http-header-accept=*/*, kc-id=f6381a5b-d232-4096-b3ab-1852d0293466, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1640912929655, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYc5ZRHNxAH4AEQAAAABhzlgYdAAkZjYzODFhNWItZDIzMi00MDk2LWIzYWItMTg1MmQwMjkzNDY2dAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkNTg0MTdiZWItNGNmNC00MGJkLWE2MmMtY2RkOTE0NWViMjVkcHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJQTENwRjRENXdVWC0wX19KWTU3REJaSEJsVFpxZU84bHdDTE9tVld0X293In0.eyJleHAiOjE2NDA5MTMyMjAsImlhdCI6MTY0MDkxMjkyMCwianRpIjoiZjYzODFhNWItZDIzMi00MDk2LWIzYWItMTg1MmQwMjkzNDY2IiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiNTg0MTdiZWItNGNmNC00MGJkLWE2MmMtY2RkOTE0NWViMjVkIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.e88ueWurbHlHqTi2XkB_K5O6bOtVZNVkN0SdtHMbZ56j1VGeINwyCEd-MKx0el10WDWLF3XiE4FnDtJoYGnU6c3CwBnfeIr5Oy2ndND2JQuOWWLxe-xvIzC3uGP-t0b7fP6o8UQfHoRJ-Nxo3PTcT_FF8MyhHubOIv42kbmdB4Ym3Buf7MxGEIDFv8ZeFabw2CXaaGjIeGT5qTyjgR3L385yVaHwW-UqbkZOEd8l_osIiCzt2RZDoscRD6pmUwnJP0tz45eGBP93ubui6kOKFpT1VtZmNlAM9UOsu-3TJTHMz7CLsqXYFHSCVZsL1g319eVeWCsZydrV7yeHEZS2qw, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1640913220, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.32.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=192.168.32.1, http-session-id=D10E93E27683B35E4955B5CF43A08E6F, http-session-last-accessed-time=1640912929655, kc-category-name=ACCESS, kc-iat=1640912920, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=192.168.32.1:63734 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2021-12-31 01:08:49.707  INFO 15 --- [nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Request context extracted
2021-12-31 01:08:49.720  INFO 15 --- [nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@55573ad3
2021-12-31 01:08:49.729  INFO 15 --- [nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@55573ad3
2021-12-31 01:08:49.787  INFO 15 --- [nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@55573ad3
2021-12-31 01:08:49.790  INFO 15 --- [nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@55573ad3
2021-12-31 01:08:49.818  INFO 15 --- [nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@55573ad3
2021-12-31 01:08:49.822  WARN 15 --- [nio-7071-exec-7] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2021-12-31 01:08:49.825  WARN 15 --- [nio-7071-exec-7] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2021-12-31 01:08:49.830  INFO 15 --- [nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@55573ad3
2021-12-31 01:08:49.833  INFO 15 --- [nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@55573ad3
2021-12-31 01:08:49.836  WARN 15 --- [nio-7071-exec-7] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2021-12-31 01:08:49.838  WARN 15 --- [nio-7071-exec-7] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2021-12-31 01:08:49.840  INFO 15 --- [nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@55573ad3
2021-12-31 01:08:49.900  INFO 15 --- [nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@55573ad3
2021-12-31 01:08:49.902  INFO 15 --- [nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@55573ad3
2021-12-31 01:08:49.940  INFO 15 --- [nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@55573ad3
2021-12-31 01:08:49.944  INFO 15 --- [nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@55573ad3
2021-12-31 01:08:49.983  INFO 15 --- [nio-7071-exec-7] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-3722569208930-136361, decision=PERMIT, pdp-result=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=PERMIT}})
2021-12-31 01:08:49.985  INFO 15 --- [nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=714ed3c2-1e41-467e-8330-0d22cecb2ce7, content=PERMIT, timestamp=1640912929985, pdpResult=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=PERMIT}}))
2021-12-31 01:08:49.990  INFO 15 --- [nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=266ms, Total=300ms
2021-12-31 01:08:50.053  INFO 15 --- [nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=cfa2b7b7-564b-48a0-b11b-cfbc814b74fb, content=null, timestamp=1640912930039, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=63736, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=dead5c752148, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=192.168.32.1, kc-session-state=58417beb-4cf4-40bd-a62c-cdd9145eb25d, http-req-server-port=80, http-header-accept=*/*, kc-id=f6381a5b-d232-4096-b3ab-1852d0293466, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1640912930037, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYc5ZRHNxAH4AEQAAAABhzlgYdAAkZjYzODFhNWItZDIzMi00MDk2LWIzYWItMTg1MmQwMjkzNDY2dAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkNTg0MTdiZWItNGNmNC00MGJkLWE2MmMtY2RkOTE0NWViMjVkcHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJQTENwRjRENXdVWC0wX19KWTU3REJaSEJsVFpxZU84bHdDTE9tVld0X293In0.eyJleHAiOjE2NDA5MTMyMjAsImlhdCI6MTY0MDkxMjkyMCwianRpIjoiZjYzODFhNWItZDIzMi00MDk2LWIzYWItMTg1MmQwMjkzNDY2IiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiNTg0MTdiZWItNGNmNC00MGJkLWE2MmMtY2RkOTE0NWViMjVkIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.e88ueWurbHlHqTi2XkB_K5O6bOtVZNVkN0SdtHMbZ56j1VGeINwyCEd-MKx0el10WDWLF3XiE4FnDtJoYGnU6c3CwBnfeIr5Oy2ndND2JQuOWWLxe-xvIzC3uGP-t0b7fP6o8UQfHoRJ-Nxo3PTcT_FF8MyhHubOIv42kbmdB4Ym3Buf7MxGEIDFv8ZeFabw2CXaaGjIeGT5qTyjgR3L385yVaHwW-UqbkZOEd8l_osIiCzt2RZDoscRD6pmUwnJP0tz45eGBP93ubui6kOKFpT1VtZmNlAM9UOsu-3TJTHMz7CLsqXYFHSCVZsL1g319eVeWCsZydrV7yeHEZS2qw, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1640913220, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.32.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=192.168.32.1, http-session-id=5C998BD7C3ABE73259FA8D98B88E8034, http-session-last-accessed-time=1640912930037, kc-category-name=ACCESS, kc-iat=1640912920, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=192.168.32.1:63736 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2021-12-31 01:08:50.055  INFO 15 --- [nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Request context extracted
2021-12-31 01:08:50.059  INFO 15 --- [nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6f351dfa
2021-12-31 01:08:50.060  INFO 15 --- [nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6f351dfa
2021-12-31 01:08:50.084  INFO 15 --- [nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6f351dfa
2021-12-31 01:08:50.086  INFO 15 --- [nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6f351dfa
2021-12-31 01:08:50.149  INFO 15 --- [nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6f351dfa
2021-12-31 01:08:50.152  WARN 15 --- [nio-7071-exec-8] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2021-12-31 01:08:50.155  WARN 15 --- [nio-7071-exec-8] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2021-12-31 01:08:50.158  INFO 15 --- [nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6f351dfa
2021-12-31 01:08:50.160  INFO 15 --- [nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6f351dfa
2021-12-31 01:08:50.163  WARN 15 --- [nio-7071-exec-8] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2021-12-31 01:08:50.166  WARN 15 --- [nio-7071-exec-8] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2021-12-31 01:08:50.171  INFO 15 --- [nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6f351dfa
2021-12-31 01:08:50.199  INFO 15 --- [nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6f351dfa
2021-12-31 01:08:50.206  INFO 15 --- [nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6f351dfa
2021-12-31 01:08:50.231  INFO 15 --- [nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6f351dfa
2021-12-31 01:08:50.234  INFO 15 --- [nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6f351dfa
2021-12-31 01:08:50.305  INFO 15 --- [nio-7071-exec-8] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-3722906897163-402089, decision=PERMIT, pdp-result=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=PERMIT}})
2021-12-31 01:08:50.308  INFO 15 --- [nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=cfa2b7b7-564b-48a0-b11b-cfbc814b74fb, content=PERMIT, timestamp=1640912930308, pdpResult=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=PERMIT}}))
2021-12-31 01:08:50.313  INFO 15 --- [nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=251ms, Total=261ms
2021-12-31 01:08:50.396  INFO 15 --- [nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=86cc6432-1cbf-49be-9729-aba2ed76c93e, content=null, timestamp=1640912930379, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=63738, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=dead5c752148, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=192.168.32.1, kc-session-state=58417beb-4cf4-40bd-a62c-cdd9145eb25d, http-req-server-port=80, http-header-accept=*/*, kc-id=f6381a5b-d232-4096-b3ab-1852d0293466, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1640912930375, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYc5ZRHNxAH4AEQAAAABhzlgYdAAkZjYzODFhNWItZDIzMi00MDk2LWIzYWItMTg1MmQwMjkzNDY2dAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkNTg0MTdiZWItNGNmNC00MGJkLWE2MmMtY2RkOTE0NWViMjVkcHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJQTENwRjRENXdVWC0wX19KWTU3REJaSEJsVFpxZU84bHdDTE9tVld0X293In0.eyJleHAiOjE2NDA5MTMyMjAsImlhdCI6MTY0MDkxMjkyMCwianRpIjoiZjYzODFhNWItZDIzMi00MDk2LWIzYWItMTg1MmQwMjkzNDY2IiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiNTg0MTdiZWItNGNmNC00MGJkLWE2MmMtY2RkOTE0NWViMjVkIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.e88ueWurbHlHqTi2XkB_K5O6bOtVZNVkN0SdtHMbZ56j1VGeINwyCEd-MKx0el10WDWLF3XiE4FnDtJoYGnU6c3CwBnfeIr5Oy2ndND2JQuOWWLxe-xvIzC3uGP-t0b7fP6o8UQfHoRJ-Nxo3PTcT_FF8MyhHubOIv42kbmdB4Ym3Buf7MxGEIDFv8ZeFabw2CXaaGjIeGT5qTyjgR3L385yVaHwW-UqbkZOEd8l_osIiCzt2RZDoscRD6pmUwnJP0tz45eGBP93ubui6kOKFpT1VtZmNlAM9UOsu-3TJTHMz7CLsqXYFHSCVZsL1g319eVeWCsZydrV7yeHEZS2qw, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1640913220, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.32.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=192.168.32.1, http-session-id=C67F057483B6C3527999EEDD6F5CFC31, http-session-last-accessed-time=1640912930375, kc-category-name=ACCESS, kc-iat=1640912920, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=192.168.32.1:63738 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2021-12-31 01:08:50.411  INFO 15 --- [nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Request context extracted
2021-12-31 01:08:50.438  INFO 15 --- [nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@b87f68e
2021-12-31 01:08:50.450  INFO 15 --- [nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@b87f68e
2021-12-31 01:08:50.480  INFO 15 --- [nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@b87f68e
2021-12-31 01:08:50.487  INFO 15 --- [nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@b87f68e
2021-12-31 01:08:50.509  INFO 15 --- [nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@b87f68e
2021-12-31 01:08:50.512  WARN 15 --- [nio-7071-exec-9] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2021-12-31 01:08:50.516  WARN 15 --- [nio-7071-exec-9] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2021-12-31 01:08:50.518  INFO 15 --- [nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@b87f68e
2021-12-31 01:08:50.520  INFO 15 --- [nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@b87f68e
2021-12-31 01:08:50.522  WARN 15 --- [nio-7071-exec-9] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2021-12-31 01:08:50.525  WARN 15 --- [nio-7071-exec-9] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2021-12-31 01:08:50.527  INFO 15 --- [nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@b87f68e
2021-12-31 01:08:50.556  INFO 15 --- [nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@b87f68e
2021-12-31 01:08:50.558  INFO 15 --- [nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@b87f68e
2021-12-31 01:08:50.627  INFO 15 --- [nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@b87f68e
2021-12-31 01:08:50.629  INFO 15 --- [nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@b87f68e
2021-12-31 01:08:50.659  INFO 15 --- [nio-7071-exec-9] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-3723263229924-944459, decision=PERMIT, pdp-result=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=PERMIT}})
2021-12-31 01:08:50.663  INFO 15 --- [nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=86cc6432-1cbf-49be-9729-aba2ed76c93e, content=PERMIT, timestamp=1640912930663, pdpResult=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=PERMIT}}))
2021-12-31 01:08:50.666  INFO 15 --- [nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=250ms, Total=279ms
2021-12-31 01:08:50.710  INFO 15 --- [io-7071-exec-10] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=8842969f-8c4e-420b-9a60-eaaf9ad403e7, content=null, timestamp=1640912930704, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=63740, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=dead5c752148, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=192.168.32.1, kc-session-state=58417beb-4cf4-40bd-a62c-cdd9145eb25d, http-req-server-port=80, http-header-accept=*/*, kc-id=f6381a5b-d232-4096-b3ab-1852d0293466, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1640912930700, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYc5ZRHNxAH4AEQAAAABhzlgYdAAkZjYzODFhNWItZDIzMi00MDk2LWIzYWItMTg1MmQwMjkzNDY2dAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkNTg0MTdiZWItNGNmNC00MGJkLWE2MmMtY2RkOTE0NWViMjVkcHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJQTENwRjRENXdVWC0wX19KWTU3REJaSEJsVFpxZU84bHdDTE9tVld0X293In0.eyJleHAiOjE2NDA5MTMyMjAsImlhdCI6MTY0MDkxMjkyMCwianRpIjoiZjYzODFhNWItZDIzMi00MDk2LWIzYWItMTg1MmQwMjkzNDY2IiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiNTg0MTdiZWItNGNmNC00MGJkLWE2MmMtY2RkOTE0NWViMjVkIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.e88ueWurbHlHqTi2XkB_K5O6bOtVZNVkN0SdtHMbZ56j1VGeINwyCEd-MKx0el10WDWLF3XiE4FnDtJoYGnU6c3CwBnfeIr5Oy2ndND2JQuOWWLxe-xvIzC3uGP-t0b7fP6o8UQfHoRJ-Nxo3PTcT_FF8MyhHubOIv42kbmdB4Ym3Buf7MxGEIDFv8ZeFabw2CXaaGjIeGT5qTyjgR3L385yVaHwW-UqbkZOEd8l_osIiCzt2RZDoscRD6pmUwnJP0tz45eGBP93ubui6kOKFpT1VtZmNlAM9UOsu-3TJTHMz7CLsqXYFHSCVZsL1g319eVeWCsZydrV7yeHEZS2qw, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1640913220, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.32.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=192.168.32.1, http-session-id=28089E4E587078E6295CC1AD80E708DD, http-session-last-accessed-time=1640912930700, kc-category-name=ACCESS, kc-iat=1640912920, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=192.168.32.1:63740 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2021-12-31 01:08:50.715  INFO 15 --- [io-7071-exec-10] e.a.a.abac.server.PdpServerController    : Request context extracted
2021-12-31 01:08:50.726  INFO 15 --- [io-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@643a4971
2021-12-31 01:08:50.735  INFO 15 --- [io-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@643a4971
2021-12-31 01:08:50.806  INFO 15 --- [io-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@643a4971
2021-12-31 01:08:50.809  INFO 15 --- [io-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@643a4971
2021-12-31 01:08:50.861  INFO 15 --- [io-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@643a4971
2021-12-31 01:08:50.864  WARN 15 --- [io-7071-exec-10] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2021-12-31 01:08:50.866  WARN 15 --- [io-7071-exec-10] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2021-12-31 01:08:50.868  INFO 15 --- [io-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@643a4971
2021-12-31 01:08:50.872  INFO 15 --- [io-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@643a4971
2021-12-31 01:08:50.875  WARN 15 --- [io-7071-exec-10] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2021-12-31 01:08:50.877  WARN 15 --- [io-7071-exec-10] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2021-12-31 01:08:50.880  INFO 15 --- [io-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@643a4971
2021-12-31 01:08:50.953  INFO 15 --- [io-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@643a4971
2021-12-31 01:08:50.958  INFO 15 --- [io-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@643a4971
2021-12-31 01:08:50.998  INFO 15 --- [io-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@643a4971
2021-12-31 01:08:51.004  INFO 15 --- [io-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@643a4971
2021-12-31 01:08:51.039  INFO 15 --- [io-7071-exec-10] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-3723568032271-996102, decision=PERMIT, pdp-result=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=PERMIT}})
2021-12-31 01:08:51.043  INFO 15 --- [io-7071-exec-10] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=8842969f-8c4e-420b-9a60-eaaf9ad403e7, content=PERMIT, timestamp=1640912931043, pdpResult=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=PERMIT}}))
2021-12-31 01:08:51.049  INFO 15 --- [io-7071-exec-10] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=325ms, Total=341ms
2021-12-31 01:08:51.101  INFO 15 --- [nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=6232cfc9-e1d0-4a26-ad46-daf341d56e9a, content=null, timestamp=1640912931085, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=63742, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=dead5c752148, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=192.168.32.1, kc-session-state=58417beb-4cf4-40bd-a62c-cdd9145eb25d, http-req-server-port=80, http-header-accept=*/*, kc-id=f6381a5b-d232-4096-b3ab-1852d0293466, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1640912931083, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYc5ZRHNxAH4AEQAAAABhzlgYdAAkZjYzODFhNWItZDIzMi00MDk2LWIzYWItMTg1MmQwMjkzNDY2dAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkNTg0MTdiZWItNGNmNC00MGJkLWE2MmMtY2RkOTE0NWViMjVkcHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJQTENwRjRENXdVWC0wX19KWTU3REJaSEJsVFpxZU84bHdDTE9tVld0X293In0.eyJleHAiOjE2NDA5MTMyMjAsImlhdCI6MTY0MDkxMjkyMCwianRpIjoiZjYzODFhNWItZDIzMi00MDk2LWIzYWItMTg1MmQwMjkzNDY2IiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiNTg0MTdiZWItNGNmNC00MGJkLWE2MmMtY2RkOTE0NWViMjVkIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.e88ueWurbHlHqTi2XkB_K5O6bOtVZNVkN0SdtHMbZ56j1VGeINwyCEd-MKx0el10WDWLF3XiE4FnDtJoYGnU6c3CwBnfeIr5Oy2ndND2JQuOWWLxe-xvIzC3uGP-t0b7fP6o8UQfHoRJ-Nxo3PTcT_FF8MyhHubOIv42kbmdB4Ym3Buf7MxGEIDFv8ZeFabw2CXaaGjIeGT5qTyjgR3L385yVaHwW-UqbkZOEd8l_osIiCzt2RZDoscRD6pmUwnJP0tz45eGBP93ubui6kOKFpT1VtZmNlAM9UOsu-3TJTHMz7CLsqXYFHSCVZsL1g319eVeWCsZydrV7yeHEZS2qw, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1640913220, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.32.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=192.168.32.1, http-session-id=2E26C8AC5475A4A663743E3B9E8F75EC, http-session-last-accessed-time=1640912931083, kc-category-name=ACCESS, kc-iat=1640912920, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=192.168.32.1:63742 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2021-12-31 01:08:51.115  INFO 15 --- [nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Request context extracted
2021-12-31 01:08:51.124  INFO 15 --- [nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@cac1185
2021-12-31 01:08:51.128  INFO 15 --- [nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@cac1185
2021-12-31 01:08:51.160  INFO 15 --- [nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@cac1185
2021-12-31 01:08:51.162  INFO 15 --- [nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@cac1185
2021-12-31 01:08:51.226  INFO 15 --- [nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@cac1185
2021-12-31 01:08:51.228  WARN 15 --- [nio-7071-exec-1] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2021-12-31 01:08:51.230  WARN 15 --- [nio-7071-exec-1] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2021-12-31 01:08:51.232  INFO 15 --- [nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@cac1185
2021-12-31 01:08:51.234  INFO 15 --- [nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@cac1185
2021-12-31 01:08:51.236  WARN 15 --- [nio-7071-exec-1] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2021-12-31 01:08:51.238  WARN 15 --- [nio-7071-exec-1] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2021-12-31 01:08:51.240  INFO 15 --- [nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@cac1185
2021-12-31 01:08:51.270  INFO 15 --- [nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@cac1185
2021-12-31 01:08:51.281  INFO 15 --- [nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@cac1185
2021-12-31 01:08:51.313  INFO 15 --- [nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@cac1185
2021-12-31 01:08:51.316  INFO 15 --- [nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@cac1185
2021-12-31 01:08:51.402  INFO 15 --- [nio-7071-exec-1] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-3723966892698-130736, decision=PERMIT, pdp-result=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=PERMIT}})
2021-12-31 01:08:51.406  INFO 15 --- [nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=6232cfc9-e1d0-4a26-ad46-daf341d56e9a, content=PERMIT, timestamp=1640912931406, pdpResult=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=PERMIT}}))
2021-12-31 01:08:51.411  INFO 15 --- [nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=289ms, Total=313ms
2021-12-31 01:08:51.505  INFO 15 --- [nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=50aade4b-0927-4c6a-8c54-3a79a2e569e5, content=null, timestamp=1640912931489, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=63744, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=dead5c752148, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=192.168.32.1, kc-session-state=58417beb-4cf4-40bd-a62c-cdd9145eb25d, http-req-server-port=80, http-header-accept=*/*, kc-id=f6381a5b-d232-4096-b3ab-1852d0293466, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1640912931484, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYc5ZRHNxAH4AEQAAAABhzlgYdAAkZjYzODFhNWItZDIzMi00MDk2LWIzYWItMTg1MmQwMjkzNDY2dAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkNTg0MTdiZWItNGNmNC00MGJkLWE2MmMtY2RkOTE0NWViMjVkcHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJQTENwRjRENXdVWC0wX19KWTU3REJaSEJsVFpxZU84bHdDTE9tVld0X293In0.eyJleHAiOjE2NDA5MTMyMjAsImlhdCI6MTY0MDkxMjkyMCwianRpIjoiZjYzODFhNWItZDIzMi00MDk2LWIzYWItMTg1MmQwMjkzNDY2IiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiNTg0MTdiZWItNGNmNC00MGJkLWE2MmMtY2RkOTE0NWViMjVkIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.e88ueWurbHlHqTi2XkB_K5O6bOtVZNVkN0SdtHMbZ56j1VGeINwyCEd-MKx0el10WDWLF3XiE4FnDtJoYGnU6c3CwBnfeIr5Oy2ndND2JQuOWWLxe-xvIzC3uGP-t0b7fP6o8UQfHoRJ-Nxo3PTcT_FF8MyhHubOIv42kbmdB4Ym3Buf7MxGEIDFv8ZeFabw2CXaaGjIeGT5qTyjgR3L385yVaHwW-UqbkZOEd8l_osIiCzt2RZDoscRD6pmUwnJP0tz45eGBP93ubui6kOKFpT1VtZmNlAM9UOsu-3TJTHMz7CLsqXYFHSCVZsL1g319eVeWCsZydrV7yeHEZS2qw, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1640913220, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.32.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=192.168.32.1, http-session-id=234B3E3E10E58B4033A04422775D0240, http-session-last-accessed-time=1640912931484, kc-category-name=ACCESS, kc-iat=1640912920, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=192.168.32.1:63744 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2021-12-31 01:08:51.511  INFO 15 --- [nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Request context extracted
2021-12-31 01:08:51.514  INFO 15 --- [nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3a7003b9
2021-12-31 01:08:51.516  INFO 15 --- [nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3a7003b9
2021-12-31 01:08:51.550  INFO 15 --- [nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3a7003b9
2021-12-31 01:08:51.552  INFO 15 --- [nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3a7003b9
2021-12-31 01:08:51.588  INFO 15 --- [nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3a7003b9
2021-12-31 01:08:51.592  WARN 15 --- [nio-7071-exec-2] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2021-12-31 01:08:51.594  WARN 15 --- [nio-7071-exec-2] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2021-12-31 01:08:51.598  INFO 15 --- [nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3a7003b9
2021-12-31 01:08:51.600  INFO 15 --- [nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3a7003b9
2021-12-31 01:08:51.603  WARN 15 --- [nio-7071-exec-2] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2021-12-31 01:08:51.604  WARN 15 --- [nio-7071-exec-2] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2021-12-31 01:08:51.607  INFO 15 --- [nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3a7003b9
2021-12-31 01:08:51.636  INFO 15 --- [nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3a7003b9
2021-12-31 01:08:51.639  INFO 15 --- [nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3a7003b9
2021-12-31 01:08:51.707  INFO 15 --- [nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3a7003b9
2021-12-31 01:08:51.710  INFO 15 --- [nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3a7003b9
2021-12-31 01:08:51.737  INFO 15 --- [nio-7071-exec-2] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-3724362311210-128853, decision=PERMIT, pdp-result=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=PERMIT}})
2021-12-31 01:08:51.740  INFO 15 --- [nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=50aade4b-0927-4c6a-8c54-3a79a2e569e5, content=PERMIT, timestamp=1640912931740, pdpResult=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=PERMIT}}))
2021-12-31 01:08:51.742  INFO 15 --- [nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=228ms, Total=239ms
2021-12-31 01:08:51.818  INFO 15 --- [nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=bd2ee9a6-65f2-41fa-8460-17ea7360883a, content=null, timestamp=1640912931797, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=63746, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=dead5c752148, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=192.168.32.1, kc-session-state=58417beb-4cf4-40bd-a62c-cdd9145eb25d, http-req-server-port=80, http-header-accept=*/*, kc-id=f6381a5b-d232-4096-b3ab-1852d0293466, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1640912931795, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYc5ZRHNxAH4AEQAAAABhzlgYdAAkZjYzODFhNWItZDIzMi00MDk2LWIzYWItMTg1MmQwMjkzNDY2dAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkNTg0MTdiZWItNGNmNC00MGJkLWE2MmMtY2RkOTE0NWViMjVkcHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJQTENwRjRENXdVWC0wX19KWTU3REJaSEJsVFpxZU84bHdDTE9tVld0X293In0.eyJleHAiOjE2NDA5MTMyMjAsImlhdCI6MTY0MDkxMjkyMCwianRpIjoiZjYzODFhNWItZDIzMi00MDk2LWIzYWItMTg1MmQwMjkzNDY2IiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiNTg0MTdiZWItNGNmNC00MGJkLWE2MmMtY2RkOTE0NWViMjVkIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.e88ueWurbHlHqTi2XkB_K5O6bOtVZNVkN0SdtHMbZ56j1VGeINwyCEd-MKx0el10WDWLF3XiE4FnDtJoYGnU6c3CwBnfeIr5Oy2ndND2JQuOWWLxe-xvIzC3uGP-t0b7fP6o8UQfHoRJ-Nxo3PTcT_FF8MyhHubOIv42kbmdB4Ym3Buf7MxGEIDFv8ZeFabw2CXaaGjIeGT5qTyjgR3L385yVaHwW-UqbkZOEd8l_osIiCzt2RZDoscRD6pmUwnJP0tz45eGBP93ubui6kOKFpT1VtZmNlAM9UOsu-3TJTHMz7CLsqXYFHSCVZsL1g319eVeWCsZydrV7yeHEZS2qw, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1640913220, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.32.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=192.168.32.1, http-session-id=5B83502E237BC1460A01DC8003D29730, http-session-last-accessed-time=1640912931795, kc-category-name=ACCESS, kc-iat=1640912920, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=192.168.32.1:63746 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2021-12-31 01:08:51.833  INFO 15 --- [nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Request context extracted
2021-12-31 01:08:51.839  INFO 15 --- [nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@677254ca
2021-12-31 01:08:51.840  INFO 15 --- [nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@677254ca
2021-12-31 01:08:51.870  INFO 15 --- [nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@677254ca
2021-12-31 01:08:51.872  INFO 15 --- [nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@677254ca
2021-12-31 01:08:51.903  INFO 15 --- [nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@677254ca
2021-12-31 01:08:51.906  WARN 15 --- [nio-7071-exec-3] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2021-12-31 01:08:51.909  WARN 15 --- [nio-7071-exec-3] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2021-12-31 01:08:51.911  INFO 15 --- [nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@677254ca
2021-12-31 01:08:51.914  INFO 15 --- [nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@677254ca
2021-12-31 01:08:51.919  WARN 15 --- [nio-7071-exec-3] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2021-12-31 01:08:51.923  WARN 15 --- [nio-7071-exec-3] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2021-12-31 01:08:51.926  INFO 15 --- [nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@677254ca
2021-12-31 01:08:51.991  INFO 15 --- [nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@677254ca
2021-12-31 01:08:51.994  INFO 15 --- [nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@677254ca
2021-12-31 01:08:52.017  INFO 15 --- [nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@677254ca
2021-12-31 01:08:52.019  INFO 15 --- [nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@677254ca
2021-12-31 01:08:52.053  INFO 15 --- [nio-7071-exec-3] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-3724687546955-746233, decision=PERMIT, pdp-result=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=PERMIT}})
2021-12-31 01:08:52.056  INFO 15 --- [nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=bd2ee9a6-65f2-41fa-8460-17ea7360883a, content=PERMIT, timestamp=1640912932056, pdpResult=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=PERMIT}}))
2021-12-31 01:08:52.061  INFO 15 --- [nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=218ms, Total=249ms
2021-12-31 01:08:52.178  INFO 15 --- [nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=441a042c-44c2-49b3-9623-07c0aac439d2, content=null, timestamp=1640912932129, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=63748, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=dead5c752148, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=192.168.32.1, kc-session-state=58417beb-4cf4-40bd-a62c-cdd9145eb25d, http-req-server-port=80, http-header-accept=*/*, kc-id=f6381a5b-d232-4096-b3ab-1852d0293466, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1640912932127, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYc5ZRHNxAH4AEQAAAABhzlgYdAAkZjYzODFhNWItZDIzMi00MDk2LWIzYWItMTg1MmQwMjkzNDY2dAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkNTg0MTdiZWItNGNmNC00MGJkLWE2MmMtY2RkOTE0NWViMjVkcHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJQTENwRjRENXdVWC0wX19KWTU3REJaSEJsVFpxZU84bHdDTE9tVld0X293In0.eyJleHAiOjE2NDA5MTMyMjAsImlhdCI6MTY0MDkxMjkyMCwianRpIjoiZjYzODFhNWItZDIzMi00MDk2LWIzYWItMTg1MmQwMjkzNDY2IiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiNTg0MTdiZWItNGNmNC00MGJkLWE2MmMtY2RkOTE0NWViMjVkIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.e88ueWurbHlHqTi2XkB_K5O6bOtVZNVkN0SdtHMbZ56j1VGeINwyCEd-MKx0el10WDWLF3XiE4FnDtJoYGnU6c3CwBnfeIr5Oy2ndND2JQuOWWLxe-xvIzC3uGP-t0b7fP6o8UQfHoRJ-Nxo3PTcT_FF8MyhHubOIv42kbmdB4Ym3Buf7MxGEIDFv8ZeFabw2CXaaGjIeGT5qTyjgR3L385yVaHwW-UqbkZOEd8l_osIiCzt2RZDoscRD6pmUwnJP0tz45eGBP93ubui6kOKFpT1VtZmNlAM9UOsu-3TJTHMz7CLsqXYFHSCVZsL1g319eVeWCsZydrV7yeHEZS2qw, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1640913220, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.32.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=192.168.32.1, http-session-id=19272295117FA21656B7EAC71716702B, http-session-last-accessed-time=1640912932127, kc-category-name=ACCESS, kc-iat=1640912920, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=192.168.32.1:63748 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2021-12-31 01:08:52.184  INFO 15 --- [nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Request context extracted
2021-12-31 01:08:52.196  INFO 15 --- [nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@31b88717
2021-12-31 01:08:52.199  INFO 15 --- [nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@31b88717
2021-12-31 01:08:52.236  INFO 15 --- [nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@31b88717
2021-12-31 01:08:52.242  INFO 15 --- [nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@31b88717
2021-12-31 01:08:52.305  INFO 15 --- [nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@31b88717
2021-12-31 01:08:52.307  WARN 15 --- [nio-7071-exec-4] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2021-12-31 01:08:52.309  WARN 15 --- [nio-7071-exec-4] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2021-12-31 01:08:52.311  INFO 15 --- [nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@31b88717
2021-12-31 01:08:52.313  INFO 15 --- [nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@31b88717
2021-12-31 01:08:52.315  WARN 15 --- [nio-7071-exec-4] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2021-12-31 01:08:52.317  WARN 15 --- [nio-7071-exec-4] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2021-12-31 01:08:52.319  INFO 15 --- [nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@31b88717
2021-12-31 01:08:52.344  INFO 15 --- [nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@31b88717
2021-12-31 01:08:52.349  INFO 15 --- [nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@31b88717
2021-12-31 01:08:52.378  INFO 15 --- [nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@31b88717
2021-12-31 01:08:52.381  INFO 15 --- [nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@31b88717
2021-12-31 01:08:52.445  INFO 15 --- [nio-7071-exec-4] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-3725036255683-73089, decision=PERMIT, pdp-result=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=PERMIT}})
2021-12-31 01:08:52.449  INFO 15 --- [nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=441a042c-44c2-49b3-9623-07c0aac439d2, content=PERMIT, timestamp=1640912932449, pdpResult=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=PERMIT}}))
2021-12-31 01:08:52.454  INFO 15 --- [nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=263ms, Total=307ms
2021-12-31 01:08:52.528  INFO 15 --- [nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=5f0a2819-b85c-49d5-a0e0-b2382b116f2e, content=null, timestamp=1640912932517, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=63750, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=dead5c752148, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=192.168.32.1, kc-session-state=58417beb-4cf4-40bd-a62c-cdd9145eb25d, http-req-server-port=80, http-header-accept=*/*, kc-id=f6381a5b-d232-4096-b3ab-1852d0293466, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1640912932514, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYc5ZRHNxAH4AEQAAAABhzlgYdAAkZjYzODFhNWItZDIzMi00MDk2LWIzYWItMTg1MmQwMjkzNDY2dAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkNTg0MTdiZWItNGNmNC00MGJkLWE2MmMtY2RkOTE0NWViMjVkcHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJQTENwRjRENXdVWC0wX19KWTU3REJaSEJsVFpxZU84bHdDTE9tVld0X293In0.eyJleHAiOjE2NDA5MTMyMjAsImlhdCI6MTY0MDkxMjkyMCwianRpIjoiZjYzODFhNWItZDIzMi00MDk2LWIzYWItMTg1MmQwMjkzNDY2IiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiNTg0MTdiZWItNGNmNC00MGJkLWE2MmMtY2RkOTE0NWViMjVkIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.e88ueWurbHlHqTi2XkB_K5O6bOtVZNVkN0SdtHMbZ56j1VGeINwyCEd-MKx0el10WDWLF3XiE4FnDtJoYGnU6c3CwBnfeIr5Oy2ndND2JQuOWWLxe-xvIzC3uGP-t0b7fP6o8UQfHoRJ-Nxo3PTcT_FF8MyhHubOIv42kbmdB4Ym3Buf7MxGEIDFv8ZeFabw2CXaaGjIeGT5qTyjgR3L385yVaHwW-UqbkZOEd8l_osIiCzt2RZDoscRD6pmUwnJP0tz45eGBP93ubui6kOKFpT1VtZmNlAM9UOsu-3TJTHMz7CLsqXYFHSCVZsL1g319eVeWCsZydrV7yeHEZS2qw, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1640913220, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.32.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=192.168.32.1, http-session-id=17E110EE88C126296864CF6ACBBB8B4E, http-session-last-accessed-time=1640912932514, kc-category-name=ACCESS, kc-iat=1640912920, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=192.168.32.1:63750 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2021-12-31 01:08:52.537  INFO 15 --- [nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Request context extracted
2021-12-31 01:08:52.540  INFO 15 --- [nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3a4bb472
2021-12-31 01:08:52.542  INFO 15 --- [nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3a4bb472
2021-12-31 01:08:52.572  INFO 15 --- [nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3a4bb472
2021-12-31 01:08:52.576  INFO 15 --- [nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3a4bb472
2021-12-31 01:08:52.605  INFO 15 --- [nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3a4bb472
2021-12-31 01:08:52.612  WARN 15 --- [nio-7071-exec-5] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2021-12-31 01:08:52.615  WARN 15 --- [nio-7071-exec-5] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2021-12-31 01:08:52.618  INFO 15 --- [nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3a4bb472
2021-12-31 01:08:52.622  INFO 15 --- [nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3a4bb472
2021-12-31 01:08:52.624  WARN 15 --- [nio-7071-exec-5] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2021-12-31 01:08:52.625  WARN 15 --- [nio-7071-exec-5] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2021-12-31 01:08:52.627  INFO 15 --- [nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3a4bb472
2021-12-31 01:08:52.650  INFO 15 --- [nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3a4bb472
2021-12-31 01:08:52.653  INFO 15 --- [nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3a4bb472
2021-12-31 01:08:52.717  INFO 15 --- [nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3a4bb472
2021-12-31 01:08:52.719  INFO 15 --- [nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@3a4bb472
2021-12-31 01:08:52.737  INFO 15 --- [nio-7071-exec-5] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-3725388010450-558698, decision=PERMIT, pdp-result=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=PERMIT}})
2021-12-31 01:08:52.742  INFO 15 --- [nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=5f0a2819-b85c-49d5-a0e0-b2382b116f2e, content=PERMIT, timestamp=1640912932742, pdpResult=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=PERMIT}}))
2021-12-31 01:08:52.745  INFO 15 --- [nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=204ms, Total=223ms
2021-12-31 01:08:52.821  INFO 15 --- [nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=69c417e6-fe47-4fc8-945c-db0ad767a178, content=null, timestamp=1640912932793, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=63752, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=dead5c752148, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=192.168.32.1, kc-session-state=58417beb-4cf4-40bd-a62c-cdd9145eb25d, http-req-server-port=80, http-header-accept=*/*, kc-id=f6381a5b-d232-4096-b3ab-1852d0293466, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1640912932791, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYc5ZRHNxAH4AEQAAAABhzlgYdAAkZjYzODFhNWItZDIzMi00MDk2LWIzYWItMTg1MmQwMjkzNDY2dAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkNTg0MTdiZWItNGNmNC00MGJkLWE2MmMtY2RkOTE0NWViMjVkcHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJQTENwRjRENXdVWC0wX19KWTU3REJaSEJsVFpxZU84bHdDTE9tVld0X293In0.eyJleHAiOjE2NDA5MTMyMjAsImlhdCI6MTY0MDkxMjkyMCwianRpIjoiZjYzODFhNWItZDIzMi00MDk2LWIzYWItMTg1MmQwMjkzNDY2IiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiNTg0MTdiZWItNGNmNC00MGJkLWE2MmMtY2RkOTE0NWViMjVkIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.e88ueWurbHlHqTi2XkB_K5O6bOtVZNVkN0SdtHMbZ56j1VGeINwyCEd-MKx0el10WDWLF3XiE4FnDtJoYGnU6c3CwBnfeIr5Oy2ndND2JQuOWWLxe-xvIzC3uGP-t0b7fP6o8UQfHoRJ-Nxo3PTcT_FF8MyhHubOIv42kbmdB4Ym3Buf7MxGEIDFv8ZeFabw2CXaaGjIeGT5qTyjgR3L385yVaHwW-UqbkZOEd8l_osIiCzt2RZDoscRD6pmUwnJP0tz45eGBP93ubui6kOKFpT1VtZmNlAM9UOsu-3TJTHMz7CLsqXYFHSCVZsL1g319eVeWCsZydrV7yeHEZS2qw, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1640913220, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.32.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=192.168.32.1, http-session-id=716EA111A826055A5084A7448B8D3804, http-session-last-accessed-time=1640912932791, kc-category-name=ACCESS, kc-iat=1640912920, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=192.168.32.1:63752 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2021-12-31 01:08:52.828  INFO 15 --- [nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Request context extracted
2021-12-31 01:08:52.831  INFO 15 --- [nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6decb404
2021-12-31 01:08:52.833  INFO 15 --- [nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6decb404
2021-12-31 01:08:52.851  INFO 15 --- [nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6decb404
2021-12-31 01:08:52.855  INFO 15 --- [nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6decb404
2021-12-31 01:08:52.877  INFO 15 --- [nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6decb404
2021-12-31 01:08:52.880  WARN 15 --- [nio-7071-exec-6] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2021-12-31 01:08:52.881  WARN 15 --- [nio-7071-exec-6] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2021-12-31 01:08:52.884  INFO 15 --- [nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6decb404
2021-12-31 01:08:52.886  INFO 15 --- [nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6decb404
2021-12-31 01:08:52.889  WARN 15 --- [nio-7071-exec-6] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2021-12-31 01:08:52.893  WARN 15 --- [nio-7071-exec-6] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2021-12-31 01:08:52.895  INFO 15 --- [nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6decb404
2021-12-31 01:08:52.951  INFO 15 --- [nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6decb404
2021-12-31 01:08:52.954  INFO 15 --- [nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6decb404
2021-12-31 01:08:52.986  INFO 15 --- [nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6decb404
2021-12-31 01:08:52.989  INFO 15 --- [nio-7071-exec-6] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@6decb404
2021-12-31 01:08:53.015  INFO 15 --- [nio-7071-exec-6] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-3725679596783-718747, decision=PERMIT, pdp-result=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=PERMIT}})
2021-12-31 01:08:53.019  INFO 15 --- [nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=69c417e6-fe47-4fc8-945c-db0ad767a178, content=PERMIT, timestamp=1640912933019, pdpResult=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=PERMIT}}))
2021-12-31 01:08:53.025  INFO 15 --- [nio-7071-exec-6] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=189ms, Total=209ms
2021-12-31 01:08:53.092  INFO 15 --- [nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=0068a8d4-bde5-48b5-8772-8c6373ff2739, content=null, timestamp=1640912933080, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=63754, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=dead5c752148, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=192.168.32.1, kc-session-state=58417beb-4cf4-40bd-a62c-cdd9145eb25d, http-req-server-port=80, http-header-accept=*/*, kc-id=f6381a5b-d232-4096-b3ab-1852d0293466, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1640912933068, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYc5ZRHNxAH4AEQAAAABhzlgYdAAkZjYzODFhNWItZDIzMi00MDk2LWIzYWItMTg1MmQwMjkzNDY2dAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkNTg0MTdiZWItNGNmNC00MGJkLWE2MmMtY2RkOTE0NWViMjVkcHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJQTENwRjRENXdVWC0wX19KWTU3REJaSEJsVFpxZU84bHdDTE9tVld0X293In0.eyJleHAiOjE2NDA5MTMyMjAsImlhdCI6MTY0MDkxMjkyMCwianRpIjoiZjYzODFhNWItZDIzMi00MDk2LWIzYWItMTg1MmQwMjkzNDY2IiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiNTg0MTdiZWItNGNmNC00MGJkLWE2MmMtY2RkOTE0NWViMjVkIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.e88ueWurbHlHqTi2XkB_K5O6bOtVZNVkN0SdtHMbZ56j1VGeINwyCEd-MKx0el10WDWLF3XiE4FnDtJoYGnU6c3CwBnfeIr5Oy2ndND2JQuOWWLxe-xvIzC3uGP-t0b7fP6o8UQfHoRJ-Nxo3PTcT_FF8MyhHubOIv42kbmdB4Ym3Buf7MxGEIDFv8ZeFabw2CXaaGjIeGT5qTyjgR3L385yVaHwW-UqbkZOEd8l_osIiCzt2RZDoscRD6pmUwnJP0tz45eGBP93ubui6kOKFpT1VtZmNlAM9UOsu-3TJTHMz7CLsqXYFHSCVZsL1g319eVeWCsZydrV7yeHEZS2qw, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1640913220, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.32.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=192.168.32.1, http-session-id=1AD00671247DB44309333B4BD814A432, http-session-last-accessed-time=1640912933068, kc-category-name=ACCESS, kc-iat=1640912920, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=192.168.32.1:63754 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2021-12-31 01:08:53.096  INFO 15 --- [nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Request context extracted
2021-12-31 01:08:53.100  INFO 15 --- [nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@215dae2a
2021-12-31 01:08:53.103  INFO 15 --- [nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@215dae2a
2021-12-31 01:08:53.132  INFO 15 --- [nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@215dae2a
2021-12-31 01:08:53.136  INFO 15 --- [nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@215dae2a
2021-12-31 01:08:53.198  INFO 15 --- [nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@215dae2a
2021-12-31 01:08:53.201  WARN 15 --- [nio-7071-exec-7] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2021-12-31 01:08:53.203  WARN 15 --- [nio-7071-exec-7] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2021-12-31 01:08:53.205  INFO 15 --- [nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@215dae2a
2021-12-31 01:08:53.207  INFO 15 --- [nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@215dae2a
2021-12-31 01:08:53.209  WARN 15 --- [nio-7071-exec-7] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2021-12-31 01:08:53.211  WARN 15 --- [nio-7071-exec-7] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2021-12-31 01:08:53.220  INFO 15 --- [nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@215dae2a
2021-12-31 01:08:53.256  INFO 15 --- [nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@215dae2a
2021-12-31 01:08:53.259  INFO 15 --- [nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@215dae2a
2021-12-31 01:08:53.339  INFO 15 --- [nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@215dae2a
2021-12-31 01:08:53.344  INFO 15 --- [nio-7071-exec-7] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@215dae2a
2021-12-31 01:08:53.450  INFO 15 --- [nio-7071-exec-7] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-3725948236968-134544, decision=PERMIT, pdp-result=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=PERMIT}})
2021-12-31 01:08:53.452  INFO 15 --- [nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=0068a8d4-bde5-48b5-8772-8c6373ff2739, content=PERMIT, timestamp=1640912933452, pdpResult=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=PERMIT}}))
2021-12-31 01:08:53.456  INFO 15 --- [nio-7071-exec-7] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=354ms, Total=366ms
2021-12-31 01:08:53.552  INFO 15 --- [nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=87995762-d4ec-4296-a706-47be4c37fddf, content=null, timestamp=1640912933522, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=63756, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=dead5c752148, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=192.168.32.1, kc-session-state=58417beb-4cf4-40bd-a62c-cdd9145eb25d, http-req-server-port=80, http-header-accept=*/*, kc-id=f6381a5b-d232-4096-b3ab-1852d0293466, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1640912933518, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYc5ZRHNxAH4AEQAAAABhzlgYdAAkZjYzODFhNWItZDIzMi00MDk2LWIzYWItMTg1MmQwMjkzNDY2dAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkNTg0MTdiZWItNGNmNC00MGJkLWE2MmMtY2RkOTE0NWViMjVkcHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJQTENwRjRENXdVWC0wX19KWTU3REJaSEJsVFpxZU84bHdDTE9tVld0X293In0.eyJleHAiOjE2NDA5MTMyMjAsImlhdCI6MTY0MDkxMjkyMCwianRpIjoiZjYzODFhNWItZDIzMi00MDk2LWIzYWItMTg1MmQwMjkzNDY2IiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiNTg0MTdiZWItNGNmNC00MGJkLWE2MmMtY2RkOTE0NWViMjVkIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.e88ueWurbHlHqTi2XkB_K5O6bOtVZNVkN0SdtHMbZ56j1VGeINwyCEd-MKx0el10WDWLF3XiE4FnDtJoYGnU6c3CwBnfeIr5Oy2ndND2JQuOWWLxe-xvIzC3uGP-t0b7fP6o8UQfHoRJ-Nxo3PTcT_FF8MyhHubOIv42kbmdB4Ym3Buf7MxGEIDFv8ZeFabw2CXaaGjIeGT5qTyjgR3L385yVaHwW-UqbkZOEd8l_osIiCzt2RZDoscRD6pmUwnJP0tz45eGBP93ubui6kOKFpT1VtZmNlAM9UOsu-3TJTHMz7CLsqXYFHSCVZsL1g319eVeWCsZydrV7yeHEZS2qw, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1640913220, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.32.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=192.168.32.1, http-session-id=ACC80A306641B72D51606EA8A510F437, http-session-last-accessed-time=1640912933518, kc-category-name=ACCESS, kc-iat=1640912920, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=192.168.32.1:63756 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2021-12-31 01:08:53.556  INFO 15 --- [nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Request context extracted
2021-12-31 01:08:53.568  INFO 15 --- [nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4ffaadbf
2021-12-31 01:08:53.574  INFO 15 --- [nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4ffaadbf
2021-12-31 01:08:53.637  INFO 15 --- [nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4ffaadbf
2021-12-31 01:08:53.638  INFO 15 --- [nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4ffaadbf
2021-12-31 01:08:53.686  INFO 15 --- [nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4ffaadbf
2021-12-31 01:08:53.688  WARN 15 --- [nio-7071-exec-8] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2021-12-31 01:08:53.690  WARN 15 --- [nio-7071-exec-8] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2021-12-31 01:08:53.692  INFO 15 --- [nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4ffaadbf
2021-12-31 01:08:53.694  INFO 15 --- [nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4ffaadbf
2021-12-31 01:08:53.699  WARN 15 --- [nio-7071-exec-8] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2021-12-31 01:08:53.700  WARN 15 --- [nio-7071-exec-8] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2021-12-31 01:08:53.702  INFO 15 --- [nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4ffaadbf
2021-12-31 01:08:53.731  INFO 15 --- [nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4ffaadbf
2021-12-31 01:08:53.734  INFO 15 --- [nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4ffaadbf
2021-12-31 01:08:53.812  INFO 15 --- [nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4ffaadbf
2021-12-31 01:08:53.815  INFO 15 --- [nio-7071-exec-8] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@4ffaadbf
2021-12-31 01:08:53.853  INFO 15 --- [nio-7071-exec-8] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-3726410465514-854181, decision=PERMIT, pdp-result=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=PERMIT}})
2021-12-31 01:08:53.857  INFO 15 --- [nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=87995762-d4ec-4296-a706-47be4c37fddf, content=PERMIT, timestamp=1640912933857, pdpResult=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=PERMIT}}))
2021-12-31 01:08:53.863  INFO 15 --- [nio-7071-exec-8] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=296ms, Total=325ms
2021-12-31 01:08:53.933  INFO 15 --- [nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=7f8fe4ad-0ae0-4f8c-aa56-afc738d3f349, content=null, timestamp=1640912933915, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=63758, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=dead5c752148, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=192.168.32.1, kc-session-state=58417beb-4cf4-40bd-a62c-cdd9145eb25d, http-req-server-port=80, http-header-accept=*/*, kc-id=f6381a5b-d232-4096-b3ab-1852d0293466, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1640912933906, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYc5ZRHNxAH4AEQAAAABhzlgYdAAkZjYzODFhNWItZDIzMi00MDk2LWIzYWItMTg1MmQwMjkzNDY2dAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkNTg0MTdiZWItNGNmNC00MGJkLWE2MmMtY2RkOTE0NWViMjVkcHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJQTENwRjRENXdVWC0wX19KWTU3REJaSEJsVFpxZU84bHdDTE9tVld0X293In0.eyJleHAiOjE2NDA5MTMyMjAsImlhdCI6MTY0MDkxMjkyMCwianRpIjoiZjYzODFhNWItZDIzMi00MDk2LWIzYWItMTg1MmQwMjkzNDY2IiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiNTg0MTdiZWItNGNmNC00MGJkLWE2MmMtY2RkOTE0NWViMjVkIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.e88ueWurbHlHqTi2XkB_K5O6bOtVZNVkN0SdtHMbZ56j1VGeINwyCEd-MKx0el10WDWLF3XiE4FnDtJoYGnU6c3CwBnfeIr5Oy2ndND2JQuOWWLxe-xvIzC3uGP-t0b7fP6o8UQfHoRJ-Nxo3PTcT_FF8MyhHubOIv42kbmdB4Ym3Buf7MxGEIDFv8ZeFabw2CXaaGjIeGT5qTyjgR3L385yVaHwW-UqbkZOEd8l_osIiCzt2RZDoscRD6pmUwnJP0tz45eGBP93ubui6kOKFpT1VtZmNlAM9UOsu-3TJTHMz7CLsqXYFHSCVZsL1g319eVeWCsZydrV7yeHEZS2qw, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1640913220, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.32.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=192.168.32.1, http-session-id=B9614B4D5AB96615737617FC239421F1, http-session-last-accessed-time=1640912933906, kc-category-name=ACCESS, kc-iat=1640912920, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=192.168.32.1:63758 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2021-12-31 01:08:53.949  INFO 15 --- [nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Request context extracted
2021-12-31 01:08:53.958  INFO 15 --- [nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@e17a1f2
2021-12-31 01:08:53.960  INFO 15 --- [nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@e17a1f2
2021-12-31 01:08:53.989  INFO 15 --- [nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@e17a1f2
2021-12-31 01:08:53.991  INFO 15 --- [nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@e17a1f2
2021-12-31 01:08:54.026  INFO 15 --- [nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@e17a1f2
2021-12-31 01:08:54.028  WARN 15 --- [nio-7071-exec-9] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2021-12-31 01:08:54.030  WARN 15 --- [nio-7071-exec-9] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2021-12-31 01:08:54.032  INFO 15 --- [nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@e17a1f2
2021-12-31 01:08:54.035  INFO 15 --- [nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@e17a1f2
2021-12-31 01:08:54.038  WARN 15 --- [nio-7071-exec-9] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2021-12-31 01:08:54.041  WARN 15 --- [nio-7071-exec-9] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2021-12-31 01:08:54.044  INFO 15 --- [nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@e17a1f2
2021-12-31 01:08:54.111  INFO 15 --- [nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@e17a1f2
2021-12-31 01:08:54.113  INFO 15 --- [nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@e17a1f2
2021-12-31 01:08:54.142  INFO 15 --- [nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@e17a1f2
2021-12-31 01:08:54.144  INFO 15 --- [nio-7071-exec-9] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@e17a1f2
2021-12-31 01:08:54.172  INFO 15 --- [nio-7071-exec-9] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-3726803719151-987119, decision=PERMIT, pdp-result=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=PERMIT}})
2021-12-31 01:08:54.174  INFO 15 --- [nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=7f8fe4ad-0ae0-4f8c-aa56-afc738d3f349, content=PERMIT, timestamp=1640912934174, pdpResult=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=PERMIT}}))
2021-12-31 01:08:54.178  INFO 15 --- [nio-7071-exec-9] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=220ms, Total=249ms
2021-12-31 01:08:54.257  INFO 15 --- [io-7071-exec-10] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=3c2b95ad-d1b4-454d-bcb0-06ca8d4b5425, content=null, timestamp=1640912934233, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=63760, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=dead5c752148, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=192.168.32.1, kc-session-state=58417beb-4cf4-40bd-a62c-cdd9145eb25d, http-req-server-port=80, http-header-accept=*/*, kc-id=f6381a5b-d232-4096-b3ab-1852d0293466, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1640912934230, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYc5ZRHNxAH4AEQAAAABhzlgYdAAkZjYzODFhNWItZDIzMi00MDk2LWIzYWItMTg1MmQwMjkzNDY2dAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkNTg0MTdiZWItNGNmNC00MGJkLWE2MmMtY2RkOTE0NWViMjVkcHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJQTENwRjRENXdVWC0wX19KWTU3REJaSEJsVFpxZU84bHdDTE9tVld0X293In0.eyJleHAiOjE2NDA5MTMyMjAsImlhdCI6MTY0MDkxMjkyMCwianRpIjoiZjYzODFhNWItZDIzMi00MDk2LWIzYWItMTg1MmQwMjkzNDY2IiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiNTg0MTdiZWItNGNmNC00MGJkLWE2MmMtY2RkOTE0NWViMjVkIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.e88ueWurbHlHqTi2XkB_K5O6bOtVZNVkN0SdtHMbZ56j1VGeINwyCEd-MKx0el10WDWLF3XiE4FnDtJoYGnU6c3CwBnfeIr5Oy2ndND2JQuOWWLxe-xvIzC3uGP-t0b7fP6o8UQfHoRJ-Nxo3PTcT_FF8MyhHubOIv42kbmdB4Ym3Buf7MxGEIDFv8ZeFabw2CXaaGjIeGT5qTyjgR3L385yVaHwW-UqbkZOEd8l_osIiCzt2RZDoscRD6pmUwnJP0tz45eGBP93ubui6kOKFpT1VtZmNlAM9UOsu-3TJTHMz7CLsqXYFHSCVZsL1g319eVeWCsZydrV7yeHEZS2qw, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1640913220, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.32.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=192.168.32.1, http-session-id=9EF159003813A41512E4D7DC3A323BED, http-session-last-accessed-time=1640912934230, kc-category-name=ACCESS, kc-iat=1640912920, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=192.168.32.1:63760 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2021-12-31 01:08:54.271  INFO 15 --- [io-7071-exec-10] e.a.a.abac.server.PdpServerController    : Request context extracted
2021-12-31 01:08:54.289  INFO 15 --- [io-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1298e359
2021-12-31 01:08:54.292  INFO 15 --- [io-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1298e359
2021-12-31 01:08:54.325  INFO 15 --- [io-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1298e359
2021-12-31 01:08:54.327  INFO 15 --- [io-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1298e359
2021-12-31 01:08:54.410  INFO 15 --- [io-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1298e359
2021-12-31 01:08:54.412  WARN 15 --- [io-7071-exec-10] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2021-12-31 01:08:54.416  WARN 15 --- [io-7071-exec-10] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2021-12-31 01:08:54.419  INFO 15 --- [io-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1298e359
2021-12-31 01:08:54.424  INFO 15 --- [io-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1298e359
2021-12-31 01:08:54.426  WARN 15 --- [io-7071-exec-10] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2021-12-31 01:08:54.429  WARN 15 --- [io-7071-exec-10] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2021-12-31 01:08:54.431  INFO 15 --- [io-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1298e359
2021-12-31 01:08:54.454  INFO 15 --- [io-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1298e359
2021-12-31 01:08:54.457  INFO 15 --- [io-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1298e359
2021-12-31 01:08:54.493  INFO 15 --- [io-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1298e359
2021-12-31 01:08:54.497  INFO 15 --- [io-7071-exec-10] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1298e359
2021-12-31 01:08:54.575  INFO 15 --- [io-7071-exec-10] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-3727123810248-643740, decision=PERMIT, pdp-result=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=PERMIT}})
2021-12-31 01:08:54.577  INFO 15 --- [io-7071-exec-10] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=3c2b95ad-d1b4-454d-bcb0-06ca8d4b5425, content=PERMIT, timestamp=1640912934577, pdpResult=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=PERMIT}}))
2021-12-31 01:08:54.580  INFO 15 --- [io-7071-exec-10] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=303ms, Total=338ms
2021-12-31 01:08:54.671  INFO 15 --- [nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=998468f4-39ef-4da6-a093-dcc3708343b0, content=null, timestamp=1640912934651, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=63762, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=dead5c752148, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=192.168.32.1, kc-session-state=58417beb-4cf4-40bd-a62c-cdd9145eb25d, http-req-server-port=80, http-header-accept=*/*, kc-id=f6381a5b-d232-4096-b3ab-1852d0293466, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1640912934639, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYc5ZRHNxAH4AEQAAAABhzlgYdAAkZjYzODFhNWItZDIzMi00MDk2LWIzYWItMTg1MmQwMjkzNDY2dAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkNTg0MTdiZWItNGNmNC00MGJkLWE2MmMtY2RkOTE0NWViMjVkcHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJQTENwRjRENXdVWC0wX19KWTU3REJaSEJsVFpxZU84bHdDTE9tVld0X293In0.eyJleHAiOjE2NDA5MTMyMjAsImlhdCI6MTY0MDkxMjkyMCwianRpIjoiZjYzODFhNWItZDIzMi00MDk2LWIzYWItMTg1MmQwMjkzNDY2IiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiNTg0MTdiZWItNGNmNC00MGJkLWE2MmMtY2RkOTE0NWViMjVkIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.e88ueWurbHlHqTi2XkB_K5O6bOtVZNVkN0SdtHMbZ56j1VGeINwyCEd-MKx0el10WDWLF3XiE4FnDtJoYGnU6c3CwBnfeIr5Oy2ndND2JQuOWWLxe-xvIzC3uGP-t0b7fP6o8UQfHoRJ-Nxo3PTcT_FF8MyhHubOIv42kbmdB4Ym3Buf7MxGEIDFv8ZeFabw2CXaaGjIeGT5qTyjgR3L385yVaHwW-UqbkZOEd8l_osIiCzt2RZDoscRD6pmUwnJP0tz45eGBP93ubui6kOKFpT1VtZmNlAM9UOsu-3TJTHMz7CLsqXYFHSCVZsL1g319eVeWCsZydrV7yeHEZS2qw, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1640913220, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.32.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=192.168.32.1, http-session-id=F5A4EE10A6EF1E3E1FDBA98366E174A8, http-session-last-accessed-time=1640912934639, kc-category-name=ACCESS, kc-iat=1640912920, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=192.168.32.1:63762 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2021-12-31 01:08:54.677  INFO 15 --- [nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Request context extracted
2021-12-31 01:08:54.680  INFO 15 --- [nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@362fc4bb
2021-12-31 01:08:54.683  INFO 15 --- [nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@362fc4bb
2021-12-31 01:08:54.740  INFO 15 --- [nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@362fc4bb
2021-12-31 01:08:54.743  INFO 15 --- [nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@362fc4bb
2021-12-31 01:08:54.801  INFO 15 --- [nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@362fc4bb
2021-12-31 01:08:54.804  WARN 15 --- [nio-7071-exec-1] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2021-12-31 01:08:54.806  WARN 15 --- [nio-7071-exec-1] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2021-12-31 01:08:54.808  INFO 15 --- [nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@362fc4bb
2021-12-31 01:08:54.810  INFO 15 --- [nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@362fc4bb
2021-12-31 01:08:54.812  WARN 15 --- [nio-7071-exec-1] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2021-12-31 01:08:54.815  WARN 15 --- [nio-7071-exec-1] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2021-12-31 01:08:54.817  INFO 15 --- [nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@362fc4bb
2021-12-31 01:08:54.862  INFO 15 --- [nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@362fc4bb
2021-12-31 01:08:54.864  INFO 15 --- [nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@362fc4bb
2021-12-31 01:08:54.946  INFO 15 --- [nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@362fc4bb
2021-12-31 01:08:54.950  INFO 15 --- [nio-7071-exec-1] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@362fc4bb
2021-12-31 01:08:54.986  INFO 15 --- [nio-7071-exec-1] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-3727528620585-205811, decision=PERMIT, pdp-result=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=PERMIT}})
2021-12-31 01:08:54.988  INFO 15 --- [nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=998468f4-39ef-4da6-a093-dcc3708343b0, content=PERMIT, timestamp=1640912934988, pdpResult=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=PERMIT}}))
2021-12-31 01:08:54.991  INFO 15 --- [nio-7071-exec-1] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=309ms, Total=322ms
2021-12-31 01:08:55.070  INFO 15 --- [nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=f8197061-d3ab-4f1f-a625-f6c92796dbfe, content=null, timestamp=1640912935051, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=63764, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=dead5c752148, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=192.168.32.1, kc-session-state=58417beb-4cf4-40bd-a62c-cdd9145eb25d, http-req-server-port=80, http-header-accept=*/*, kc-id=f6381a5b-d232-4096-b3ab-1852d0293466, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1640912935049, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYc5ZRHNxAH4AEQAAAABhzlgYdAAkZjYzODFhNWItZDIzMi00MDk2LWIzYWItMTg1MmQwMjkzNDY2dAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkNTg0MTdiZWItNGNmNC00MGJkLWE2MmMtY2RkOTE0NWViMjVkcHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJQTENwRjRENXdVWC0wX19KWTU3REJaSEJsVFpxZU84bHdDTE9tVld0X293In0.eyJleHAiOjE2NDA5MTMyMjAsImlhdCI6MTY0MDkxMjkyMCwianRpIjoiZjYzODFhNWItZDIzMi00MDk2LWIzYWItMTg1MmQwMjkzNDY2IiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiNTg0MTdiZWItNGNmNC00MGJkLWE2MmMtY2RkOTE0NWViMjVkIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.e88ueWurbHlHqTi2XkB_K5O6bOtVZNVkN0SdtHMbZ56j1VGeINwyCEd-MKx0el10WDWLF3XiE4FnDtJoYGnU6c3CwBnfeIr5Oy2ndND2JQuOWWLxe-xvIzC3uGP-t0b7fP6o8UQfHoRJ-Nxo3PTcT_FF8MyhHubOIv42kbmdB4Ym3Buf7MxGEIDFv8ZeFabw2CXaaGjIeGT5qTyjgR3L385yVaHwW-UqbkZOEd8l_osIiCzt2RZDoscRD6pmUwnJP0tz45eGBP93ubui6kOKFpT1VtZmNlAM9UOsu-3TJTHMz7CLsqXYFHSCVZsL1g319eVeWCsZydrV7yeHEZS2qw, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1640913220, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.32.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=192.168.32.1, http-session-id=34F4F63FABB7AC28EC9A578590B9D3CA, http-session-last-accessed-time=1640912935049, kc-category-name=ACCESS, kc-iat=1640912920, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=192.168.32.1:63764 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2021-12-31 01:08:55.074  INFO 15 --- [nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Request context extracted
2021-12-31 01:08:55.076  INFO 15 --- [nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@57838e24
2021-12-31 01:08:55.078  INFO 15 --- [nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@57838e24
2021-12-31 01:08:55.104  INFO 15 --- [nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@57838e24
2021-12-31 01:08:55.106  INFO 15 --- [nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@57838e24
2021-12-31 01:08:55.130  INFO 15 --- [nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@57838e24
2021-12-31 01:08:55.134  WARN 15 --- [nio-7071-exec-2] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2021-12-31 01:08:55.136  WARN 15 --- [nio-7071-exec-2] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2021-12-31 01:08:55.140  INFO 15 --- [nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@57838e24
2021-12-31 01:08:55.142  INFO 15 --- [nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@57838e24
2021-12-31 01:08:55.144  WARN 15 --- [nio-7071-exec-2] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2021-12-31 01:08:55.145  WARN 15 --- [nio-7071-exec-2] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2021-12-31 01:08:55.148  INFO 15 --- [nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@57838e24
2021-12-31 01:08:55.218  INFO 15 --- [nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@57838e24
2021-12-31 01:08:55.221  INFO 15 --- [nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@57838e24
2021-12-31 01:08:55.240  INFO 15 --- [nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@57838e24
2021-12-31 01:08:55.243  INFO 15 --- [nio-7071-exec-2] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@57838e24
2021-12-31 01:08:55.272  INFO 15 --- [nio-7071-exec-2] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-3727924720632-511535, decision=PERMIT, pdp-result=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=PERMIT}})
2021-12-31 01:08:55.274  INFO 15 --- [nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=f8197061-d3ab-4f1f-a625-f6c92796dbfe, content=PERMIT, timestamp=1640912935274, pdpResult=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=PERMIT}}))
2021-12-31 01:08:55.280  INFO 15 --- [nio-7071-exec-2] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=199ms, Total=212ms
2021-12-31 01:08:55.344  INFO 15 --- [nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=459b40db-a720-41a5-a9e9-192cf9edfc69, content=null, timestamp=1640912935328, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=63766, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=dead5c752148, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=192.168.32.1, kc-session-state=58417beb-4cf4-40bd-a62c-cdd9145eb25d, http-req-server-port=80, http-header-accept=*/*, kc-id=f6381a5b-d232-4096-b3ab-1852d0293466, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1640912935324, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYc5ZRHNxAH4AEQAAAABhzlgYdAAkZjYzODFhNWItZDIzMi00MDk2LWIzYWItMTg1MmQwMjkzNDY2dAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkNTg0MTdiZWItNGNmNC00MGJkLWE2MmMtY2RkOTE0NWViMjVkcHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJQTENwRjRENXdVWC0wX19KWTU3REJaSEJsVFpxZU84bHdDTE9tVld0X293In0.eyJleHAiOjE2NDA5MTMyMjAsImlhdCI6MTY0MDkxMjkyMCwianRpIjoiZjYzODFhNWItZDIzMi00MDk2LWIzYWItMTg1MmQwMjkzNDY2IiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiNTg0MTdiZWItNGNmNC00MGJkLWE2MmMtY2RkOTE0NWViMjVkIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.e88ueWurbHlHqTi2XkB_K5O6bOtVZNVkN0SdtHMbZ56j1VGeINwyCEd-MKx0el10WDWLF3XiE4FnDtJoYGnU6c3CwBnfeIr5Oy2ndND2JQuOWWLxe-xvIzC3uGP-t0b7fP6o8UQfHoRJ-Nxo3PTcT_FF8MyhHubOIv42kbmdB4Ym3Buf7MxGEIDFv8ZeFabw2CXaaGjIeGT5qTyjgR3L385yVaHwW-UqbkZOEd8l_osIiCzt2RZDoscRD6pmUwnJP0tz45eGBP93ubui6kOKFpT1VtZmNlAM9UOsu-3TJTHMz7CLsqXYFHSCVZsL1g319eVeWCsZydrV7yeHEZS2qw, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1640913220, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.32.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=192.168.32.1, http-session-id=FE19FD3ED539BCFDE2B970ABCAD64C04, http-session-last-accessed-time=1640912935324, kc-category-name=ACCESS, kc-iat=1640912920, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=192.168.32.1:63766 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2021-12-31 01:08:55.348  INFO 15 --- [nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Request context extracted
2021-12-31 01:08:55.354  INFO 15 --- [nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1b6510ec
2021-12-31 01:08:55.358  INFO 15 --- [nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1b6510ec
2021-12-31 01:08:55.396  INFO 15 --- [nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1b6510ec
2021-12-31 01:08:55.401  INFO 15 --- [nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1b6510ec
2021-12-31 01:08:55.473  INFO 15 --- [nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1b6510ec
2021-12-31 01:08:55.475  WARN 15 --- [nio-7071-exec-3] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2021-12-31 01:08:55.477  WARN 15 --- [nio-7071-exec-3] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2021-12-31 01:08:55.479  INFO 15 --- [nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1b6510ec
2021-12-31 01:08:55.481  INFO 15 --- [nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1b6510ec
2021-12-31 01:08:55.483  WARN 15 --- [nio-7071-exec-3] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2021-12-31 01:08:55.485  WARN 15 --- [nio-7071-exec-3] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2021-12-31 01:08:55.487  INFO 15 --- [nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1b6510ec
2021-12-31 01:08:55.516  INFO 15 --- [nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1b6510ec
2021-12-31 01:08:55.519  INFO 15 --- [nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1b6510ec
2021-12-31 01:08:55.546  INFO 15 --- [nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1b6510ec
2021-12-31 01:08:55.549  INFO 15 --- [nio-7071-exec-3] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@1b6510ec
2021-12-31 01:08:55.617  INFO 15 --- [nio-7071-exec-3] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-3728201096024-305005, decision=PERMIT, pdp-result=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=PERMIT}})
2021-12-31 01:08:55.619  INFO 15 --- [nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=459b40db-a720-41a5-a9e9-192cf9edfc69, content=PERMIT, timestamp=1640912935619, pdpResult=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=PERMIT}}))
2021-12-31 01:08:55.625  INFO 15 --- [nio-7071-exec-3] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=268ms, Total=288ms
2021-12-31 01:08:55.687  INFO 15 --- [nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=02f73d15-fdfc-480d-994d-c05464fc23bd, content=null, timestamp=1640912935672, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=63768, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=dead5c752148, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=192.168.32.1, kc-session-state=58417beb-4cf4-40bd-a62c-cdd9145eb25d, http-req-server-port=80, http-header-accept=*/*, kc-id=f6381a5b-d232-4096-b3ab-1852d0293466, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1640912935664, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYc5ZRHNxAH4AEQAAAABhzlgYdAAkZjYzODFhNWItZDIzMi00MDk2LWIzYWItMTg1MmQwMjkzNDY2dAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkNTg0MTdiZWItNGNmNC00MGJkLWE2MmMtY2RkOTE0NWViMjVkcHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJQTENwRjRENXdVWC0wX19KWTU3REJaSEJsVFpxZU84bHdDTE9tVld0X293In0.eyJleHAiOjE2NDA5MTMyMjAsImlhdCI6MTY0MDkxMjkyMCwianRpIjoiZjYzODFhNWItZDIzMi00MDk2LWIzYWItMTg1MmQwMjkzNDY2IiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiNTg0MTdiZWItNGNmNC00MGJkLWE2MmMtY2RkOTE0NWViMjVkIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.e88ueWurbHlHqTi2XkB_K5O6bOtVZNVkN0SdtHMbZ56j1VGeINwyCEd-MKx0el10WDWLF3XiE4FnDtJoYGnU6c3CwBnfeIr5Oy2ndND2JQuOWWLxe-xvIzC3uGP-t0b7fP6o8UQfHoRJ-Nxo3PTcT_FF8MyhHubOIv42kbmdB4Ym3Buf7MxGEIDFv8ZeFabw2CXaaGjIeGT5qTyjgR3L385yVaHwW-UqbkZOEd8l_osIiCzt2RZDoscRD6pmUwnJP0tz45eGBP93ubui6kOKFpT1VtZmNlAM9UOsu-3TJTHMz7CLsqXYFHSCVZsL1g319eVeWCsZydrV7yeHEZS2qw, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1640913220, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.32.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=192.168.32.1, http-session-id=4972733B714CD60CD30C318EEE2C04A3, http-session-last-accessed-time=1640912935664, kc-category-name=ACCESS, kc-iat=1640912920, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=192.168.32.1:63768 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2021-12-31 01:08:55.690  INFO 15 --- [nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Request context extracted
2021-12-31 01:08:55.694  INFO 15 --- [nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@75bcfb8d
2021-12-31 01:08:55.696  INFO 15 --- [nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@75bcfb8d
2021-12-31 01:08:55.723  INFO 15 --- [nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@75bcfb8d
2021-12-31 01:08:55.727  INFO 15 --- [nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@75bcfb8d
2021-12-31 01:08:55.760  INFO 15 --- [nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@75bcfb8d
2021-12-31 01:08:55.763  WARN 15 --- [nio-7071-exec-4] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2021-12-31 01:08:55.766  WARN 15 --- [nio-7071-exec-4] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2021-12-31 01:08:55.768  INFO 15 --- [nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@75bcfb8d
2021-12-31 01:08:55.772  INFO 15 --- [nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@75bcfb8d
2021-12-31 01:08:55.774  WARN 15 --- [nio-7071-exec-4] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2021-12-31 01:08:55.776  WARN 15 --- [nio-7071-exec-4] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2021-12-31 01:08:55.779  INFO 15 --- [nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@75bcfb8d
2021-12-31 01:08:55.800  INFO 15 --- [nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@75bcfb8d
2021-12-31 01:08:55.801  INFO 15 --- [nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@75bcfb8d
2021-12-31 01:08:55.870  INFO 15 --- [nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@75bcfb8d
2021-12-31 01:08:55.873  INFO 15 --- [nio-7071-exec-4] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@75bcfb8d
2021-12-31 01:08:55.891  INFO 15 --- [nio-7071-exec-4] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-3728541809909-385678, decision=PERMIT, pdp-result=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=PERMIT}})
2021-12-31 01:08:55.896  INFO 15 --- [nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=02f73d15-fdfc-480d-994d-c05464fc23bd, content=PERMIT, timestamp=1640912935895, pdpResult=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=PERMIT}}))
2021-12-31 01:08:55.898  INFO 15 --- [nio-7071-exec-4] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=203ms, Total=217ms
2021-12-31 01:08:55.969  INFO 15 --- [nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Received Access Request (JSON): CheckAccessRequest(id=8f292b0e-8dfb-4d97-b4b6-72026dd5c861, content=null, timestamp=1640912935949, xacmlRequest={http-header-accept-encoding=gzip, deflate, kc-acr=1, kc-is-expired=false, http-param-user-id=10, http-session-max-inactive-interval=1800, http-param-format=json, http-req-requested-session-id=null, http-req-remote-port=63770, kc-cc--ambulance-crew-id=ambulance-crew-id-1234, http-req-local-name=dead5c752148, kc-issuer=http://192.168.1.83:8181/auth/realms/ambulance-example, http-req-method=POST, http-session-valid=false, http-req-content-length=0, kc-cc--medical-roles=xxx,ambulance-crew, http-req-remote-address=192.168.32.1, kc-session-state=58417beb-4cf4-40bd-a62c-cdd9145eb25d, http-req-server-port=80, http-header-accept=*/*, kc-id=f6381a5b-d232-4096-b3ab-1852d0293466, http-req-local-port=80, http-req-auth-type=KEYCLOAK, http-req-content-type=null, http-header-host=192.168.1.83, http-session-creation-time=1640912935944, kc-id-token=rO0ABXNyAChvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkFjY2Vzc1Rva2Vu9bZiZWJS2WYCAAdMAA5hbGxvd2VkT3JpZ2luc3QAD0xqYXZhL3V0aWwvU2V0O0wADWF1dGhvcml6YXRpb250ADhMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBdXRob3JpemF0aW9uO0wACGNlcnRDb25mdAAzTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWNjZXNzVG9rZW4kQ2VydENvbmY7TAALcmVhbG1BY2Nlc3N0ADFMb3JnL2tleWNsb2FrL3JlcHJlc2VudGF0aW9ucy9BY2Nlc3NUb2tlbiRBY2Nlc3M7TAAOcmVzb3VyY2VBY2Nlc3N0AA9MamF2YS91dGlsL01hcDtMAAVzY29wZXQAEkxqYXZhL2xhbmcvU3RyaW5nO0wAE3RydXN0ZWRDZXJ0aWZpY2F0ZXNxAH4AAXhyACRvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLklEVG9rZW57YxgoTVjWUAIAG0wAD2FjY2Vzc1Rva2VuSGFzaHEAfgAGTAADYWNycQB+AAZMAAdhZGRyZXNzdAAuTG9yZy9rZXljbG9hay9yZXByZXNlbnRhdGlvbnMvQWRkcmVzc0NsYWltU2V0O0wACWF1dGhfdGltZXQAEExqYXZhL2xhbmcvTG9uZztMAAliaXJ0aGRhdGVxAH4ABkwADWNsYWltc0xvY2FsZXNxAH4ABkwACGNvZGVIYXNocQB+AAZMAAVlbWFpbHEAfgAGTAANZW1haWxWZXJpZmllZHQAE0xqYXZhL2xhbmcvQm9vbGVhbjtMAApmYW1pbHlOYW1lcQB+AAZMAAZnZW5kZXJxAH4ABkwACWdpdmVuTmFtZXEAfgAGTAAGbG9jYWxlcQB+AAZMAAptaWRkbGVOYW1lcQB+AAZMAARuYW1lcQB+AAZMAAhuaWNrTmFtZXEAfgAGTAAFbm9uY2VxAH4ABkwAC3Bob25lTnVtYmVycQB+AAZMABNwaG9uZU51bWJlclZlcmlmaWVkcQB+AApMAAdwaWN0dXJlcQB+AAZMABFwcmVmZXJyZWRVc2VybmFtZXEAfgAGTAAHcHJvZmlsZXEAfgAGTAAMc2Vzc2lvblN0YXRlcQB+AAZMAAlzdGF0ZUhhc2hxAH4ABkwACXVwZGF0ZWRBdHEAfgAJTAAHd2Vic2l0ZXEAfgAGTAAIem9uZWluZm9xAH4ABnhyAClvcmcua2V5Y2xvYWsucmVwcmVzZW50YXRpb25zLkpzb25XZWJUb2tlboJzQJBk1uDqAgAKWwAIYXVkaWVuY2V0ABNbTGphdmEvbGFuZy9TdHJpbmc7TAADZXhwcQB+AAlMAANpYXRxAH4ACUwAAmlkcQB+AAZMAAlpc3N1ZWRGb3JxAH4ABkwABmlzc3VlcnEAfgAGTAADbmJmcQB+AAlMAAtvdGhlckNsYWltc3EAfgAFTAAHc3ViamVjdHEAfgAGTAAEdHlwZXEAfgAGeHB1cgATW0xqYXZhLmxhbmcuU3RyaW5nO63SVufpHXtHAgAAeHAAAAABdAAHYWNjb3VudHNyAA5qYXZhLmxhbmcuTG9uZzuL5JDMjyPfAgABSgAFdmFsdWV4cgAQamF2YS5sYW5nLk51bWJlcoaslR0LlOCLAgAAeHAAAAAAYc5ZRHNxAH4AEQAAAABhzlgYdAAkZjYzODFhNWItZDIzMi00MDk2LWIzYWItMTg1MmQwMjkzNDY2dAANY2FsbHMtZ2F0ZXdheXQANmh0dHA6Ly8xOTIuMTY4LjEuODM6ODE4MS9hdXRoL3JlYWxtcy9hbWJ1bGFuY2UtZXhhbXBsZXBzcgARamF2YS51dGlsLkhhc2hNYXAFB9rBwxZg0QMAAkYACmxvYWRGYWN0b3JJAAl0aHJlc2hvbGR4cD9AAAAAAAAMdwgAAAAQAAAABXQADW1lZGljYWwtcm9sZXN0ABJ4eHgsYW1idWxhbmNlLWNyZXd0ABFhbWJ1bGFuY2UtY3Jldy1pZHQAFmFtYnVsYW5jZS1jcmV3LWlkLTEyMzR0AANET0J0AAoxOTgwLTA0LTA1dAAHdXNlci1JRHQAAjEwdAAHdGVhbS1JRHQAAjEweHQAJDNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZHQABkJlYXJlcnB0AAExcHBwcHBwc3IAEWphdmEubGFuZy5Cb29sZWFuzSBygNWc+u4CAAFaAAV2YWx1ZXhwAHBwcHBwcHBwcHBwdAAFdXNlcjFwdAAkNTg0MTdiZWItNGNmNC00MGJkLWE2MmMtY2RkOTE0NWViMjVkcHBwcHNyABFqYXZhLnV0aWwuSGFzaFNldLpEhZWWuLc0AwAAeHB3DAAAABA/QAAAAAAAAXQAE2h0dHA6Ly8xOTIuMTY4LjEuODN4cHBzcgAvb3JnLmtleWNsb2FrLnJlcHJlc2VudGF0aW9ucy5BY2Nlc3NUb2tlbiRBY2Nlc3MHsHEP5XpFCwIAAkwABXJvbGVzcQB+AAFMAAx2ZXJpZnlDYWxsZXJxAH4ACnhwc3EAfgArdwwAAAAQP0AAAAAAAAR0AA5vZmZsaW5lX2FjY2Vzc3QABm1lbWJlcnQABWFkbWludAARdW1hX2F1dGhvcml6YXRpb254cHNyABdqYXZhLnV0aWwuTGlua2VkSGFzaE1hcDTATlwQbMD7AgABWgALYWNjZXNzT3JkZXJ4cQB+ABg/QAAAAAAADHcIAAAAEAAAAAF0AAdhY2NvdW50c3EAfgAuc3EAfgArdwwAAAAQP0AAAAAAAAN0AA5tYW5hZ2UtYWNjb3VudHQAFG1hbmFnZS1hY2NvdW50LWxpbmtzdAAMdmlldy1wcm9maWxleHB4AHQADXByb2ZpbGUgZW1haWxw, http-header-authorization=Bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJQTENwRjRENXdVWC0wX19KWTU3REJaSEJsVFpxZU84bHdDTE9tVld0X293In0.eyJleHAiOjE2NDA5MTMyMjAsImlhdCI6MTY0MDkxMjkyMCwianRpIjoiZjYzODFhNWItZDIzMi00MDk2LWIzYWItMTg1MmQwMjkzNDY2IiwiaXNzIjoiaHR0cDovLzE5Mi4xNjguMS44Mzo4MTgxL2F1dGgvcmVhbG1zL2FtYnVsYW5jZS1leGFtcGxlIiwiYXVkIjoiYWNjb3VudCIsInN1YiI6IjNmMGIzOWNiLTBhMWItNDQyOC1iMzZmLWI4YzA5ODEyNmRiZCIsInR5cCI6IkJlYXJlciIsImF6cCI6ImNhbGxzLWdhdGV3YXkiLCJzZXNzaW9uX3N0YXRlIjoiNTg0MTdiZWItNGNmNC00MGJkLWE2MmMtY2RkOTE0NWViMjVkIiwiYWNyIjoiMSIsImFsbG93ZWQtb3JpZ2lucyI6WyJodHRwOi8vMTkyLjE2OC4xLjgzIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJvZmZsaW5lX2FjY2VzcyIsIm1lbWJlciIsImFkbWluIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJhY2NvdW50Ijp7InJvbGVzIjpbIm1hbmFnZS1hY2NvdW50IiwibWFuYWdlLWFjY291bnQtbGlua3MiLCJ2aWV3LXByb2ZpbGUiXX19LCJzY29wZSI6InByb2ZpbGUgZW1haWwiLCJtZWRpY2FsLXJvbGVzIjoieHh4LGFtYnVsYW5jZS1jcmV3IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJhbWJ1bGFuY2UtY3Jldy1pZCI6ImFtYnVsYW5jZS1jcmV3LWlkLTEyMzQiLCJET0IiOiIxOTgwLTA0LTA1IiwidXNlci1JRCI6IjEwIiwicHJlZmVycmVkX3VzZXJuYW1lIjoidXNlcjEiLCJ0ZWFtLUlEIjoiMTAifQ.e88ueWurbHlHqTi2XkB_K5O6bOtVZNVkN0SdtHMbZ56j1VGeINwyCEd-MKx0el10WDWLF3XiE4FnDtJoYGnU6c3CwBnfeIr5Oy2ndND2JQuOWWLxe-xvIzC3uGP-t0b7fP6o8UQfHoRJ-Nxo3PTcT_FF8MyhHubOIv42kbmdB4Ym3Buf7MxGEIDFv8ZeFabw2CXaaGjIeGT5qTyjgR3L385yVaHwW-UqbkZOEd8l_osIiCzt2RZDoscRD6pmUwnJP0tz45eGBP93ubui6kOKFpT1VtZmNlAM9UOsu-3TJTHMz7CLsqXYFHSCVZsL1g319eVeWCsZydrV7yeHEZS2qw, http-req-servlet-path=/rest/acute-care-demo/call-centre, kc-is-active=true, resource-id=http://192.168.1.83/rest/acute-care-demo/call-centre, http-req-server-name=192.168.1.83, kc-cc--user-ID=10, kc-exp=1640913220, actionId=POST, http-req-url=/rest/acute-care-demo/call-centre, http-req-uri=/rest/acute-care-demo/call-centre, http-req-is-secure=false, http-req-remote-user=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-header-user-agent=python-requests/2.24.0, http-req-query-string=ES-ID=10&format=json&patient-ID=100&user-ID=10, http-req-scheme=http, kc-preferred-username=user1, http-header-content-length=0, http-req-local-address=192.168.32.12, kc-type=Bearer, kc-cc--team-ID=10, http-req-context-path=, http-header-connection=keep-alive, kc-subject=3f0b39cb-0a1b-4428-b36f-b8c098126dbd, http-req-character-encoding=UTF-8, kc-issued-for=calls-gateway, kc-cc--DOB=1980-04-05, http-req-protocol=HTTP/1.1, http-param-es-id=10, kc-email-verified=false, http-req-remote-host=192.168.32.1, http-session-id=9C4B587363BB2D1AA1ABA5A171184308, http-session-last-accessed-time=1640912935944, kc-category-name=ACCESS, kc-iat=1640912920, kc-category-ordinal=1, http-param-patient-id=100, user.identifier=192.168.32.1:63770 [3f0b39cb-0a1b-4428-b36f-b8c098126dbd]})
2021-12-31 01:08:55.975  INFO 15 --- [nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Request context extracted
2021-12-31 01:08:55.992  INFO 15 --- [nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5b31c547
2021-12-31 01:08:55.995  INFO 15 --- [nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-start, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5b31c547
2021-12-31 01:08:56.046  INFO 15 --- [nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5b31c547
2021-12-31 01:08:56.048  INFO 15 --- [nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-shift-end, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5b31c547
2021-12-31 01:08:56.091  INFO 15 --- [nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5b31c547
2021-12-31 01:08:56.102  WARN 15 --- [nio-7071-exec-5] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2021-12-31 01:08:56.106  WARN 15 --- [nio-7071-exec-5] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2021-12-31 01:08:56.113  INFO 15 --- [nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: patient-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5b31c547
2021-12-31 01:08:56.120  INFO 15 --- [nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5b31c547
2021-12-31 01:08:56.125  WARN 15 --- [nio-7071-exec-5] e.a.e.c.CustomRestAttributeFinder        : --------    getUserteamID: return: 10
2021-12-31 01:08:56.131  WARN 15 --- [nio-7071-exec-5] e.a.e.c.CustomRestAttributeFinder        : --------    Found team id: 10
2021-12-31 01:08:56.137  INFO 15 --- [nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#string, attr-id: active-emergency-team-id, issuer: null, category: urn:eu:asclepios-project:casm:1.0, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5b31c547
2021-12-31 01:08:56.178  INFO 15 --- [nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5b31c547
2021-12-31 01:08:56.184  INFO 15 --- [nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5b31c547
2021-12-31 01:08:56.265  INFO 15 --- [nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: urn:oasis:names:tc:xacml:1.0:environment:current-dateTime, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5b31c547
2021-12-31 01:08:56.267  INFO 15 --- [nio-7071-exec-5] a.a.a.s.p.f.LoggingAttributeFinderModule : Arguments: attr-type: http://www.w3.org/2001/XMLSchema#dateTime, attr-id: timestamp-treat, issuer: null, category: urn:oasis:names:tc:xacml:3.0:attribute-category:environment, context: org.wso2.balana.ctx.xacml3.XACML3EvaluationCtx@5b31c547
2021-12-31 01:08:56.294  INFO 15 --- [nio-7071-exec-5] e.a.a.a.s.pdp.AuthorizationServicePDP    : >>> RESULT: request-id=0-3728827688163-949452, decision=PERMIT, pdp-result=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=PERMIT}})
2021-12-31 01:08:56.296  INFO 15 --- [nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Result for Access Request evaluation: CheckAccessResponse(id=8f292b0e-8dfb-4d97-b4b6-72026dd5c861, content=PERMIT, timestamp=1640912936296, pdpResult=PdpResult(decision=PERMIT, statusCodes=OK, statusDetails=null, statusMessage=null, obligations={TrackingObligation:2597f703-0402-4e7b-8810-2de1d4c82a5c:permit={asclepios:obligation:type=Policy, asclepios:obligation:id=2597f703-0402-4e7b-8810-2de1d4c82a5c, asclepios:obligation:name=Update-AC-ABAC-policy, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:87439efa-3f73-43b7-b1c0-e0e34ec796e5:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=87439efa-3f73-43b7-b1c0-e0e34ec796e5, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule - Base URL, asclepios:obligation:decision=PERMIT}, TrackingObligation:c4a8462d-f90b-41f5-a1a5-e1d3bba39f7d:98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1:permit={asclepios:obligation:type=Rule, asclepios:obligation:id=98f0d019-5f0e-45ae-b7b7-4c51cb3ecdf1, asclepios:obligation:parent=Update-AC-ABAC-policy, asclepios:obligation:name=Rule 7 - Current Time less than or equal Time Revoke Extra, asclepios:obligation:decision=PERMIT}}))
2021-12-31 01:08:56.299  INFO 15 --- [nio-7071-exec-5] e.a.a.abac.server.PdpServerController    : Durations for: Evaluation=318ms, Total=334ms
